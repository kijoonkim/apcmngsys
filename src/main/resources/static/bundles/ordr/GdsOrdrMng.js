function gH(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}function Mf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var NC={exports:{}},mh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OT;function pH(){if(OT)return mh;OT=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,i,s){var o=null;if(s!==void 0&&(o=""+s),i.key!==void 0&&(o=""+i.key),"key"in i){s={};for(var a in i)a!=="key"&&(s[a]=i[a])}else s=i;return i=s.ref,{$$typeof:e,type:n,key:o,ref:i!==void 0?i:null,props:s}}return mh.Fragment=t,mh.jsx=r,mh.jsxs=r,mh}var NT;function mH(){return NT||(NT=1,NC.exports=pH()),NC.exports}var Z=mH(),BC={exports:{}},wt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BT;function vH(){if(BT)return wt;BT=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),m=Symbol.iterator;function v(N){return N===null||typeof N!="object"?null:(N=m&&N[m]||N["@@iterator"],typeof N=="function"?N:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,b={};function x(N,P,V){this.props=N,this.context=P,this.refs=b,this.updater=V||w}x.prototype.isReactComponent={},x.prototype.setState=function(N,P){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,P,"setState")},x.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function R(){}R.prototype=x.prototype;function E(N,P,V){this.props=N,this.context=P,this.refs=b,this.updater=V||w}var A=E.prototype=new R;A.constructor=E,C(A,x.prototype),A.isPureReactComponent=!0;var D=Array.isArray;function M(){}var F={H:null,A:null,T:null,S:null},O=Object.prototype.hasOwnProperty;function L(N,P,V){var H=V.ref;return{$$typeof:e,type:N,key:P,ref:H!==void 0?H:null,props:V}}function W(N,P){return L(N.type,P,N.props)}function I(N){return typeof N=="object"&&N!==null&&N.$$typeof===e}function G(N){var P={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(V){return P[V]})}var ne=/\/+/g;function ie(N,P){return typeof N=="object"&&N!==null&&N.key!=null?G(""+N.key):P.toString(36)}function J(N){switch(N.status){case"fulfilled":return N.value;case"rejected":throw N.reason;default:switch(typeof N.status=="string"?N.then(M,M):(N.status="pending",N.then(function(P){N.status==="pending"&&(N.status="fulfilled",N.value=P)},function(P){N.status==="pending"&&(N.status="rejected",N.reason=P)})),N.status){case"fulfilled":return N.value;case"rejected":throw N.reason}}throw N}function _(N,P,V,H,j){var ae=typeof N;(ae==="undefined"||ae==="boolean")&&(N=null);var fe=!1;if(N===null)fe=!0;else switch(ae){case"bigint":case"string":case"number":fe=!0;break;case"object":switch(N.$$typeof){case e:case t:fe=!0;break;case h:return fe=N._init,_(fe(N._payload),P,V,H,j)}}if(fe)return j=j(N),fe=H===""?"."+ie(N,0):H,D(j)?(V="",fe!=null&&(V=fe.replace(ne,"$&/")+"/"),_(j,P,V,"",function(ue){return ue})):j!=null&&(I(j)&&(j=W(j,V+(j.key==null||N&&N.key===j.key?"":(""+j.key).replace(ne,"$&/")+"/")+fe)),P.push(j)),1;fe=0;var le=H===""?".":H+":";if(D(N))for(var de=0;de<N.length;de++)H=N[de],ae=le+ie(H,de),fe+=_(H,P,V,ae,j);else if(de=v(N),typeof de=="function")for(N=de.call(N),de=0;!(H=N.next()).done;)H=H.value,ae=le+ie(H,de++),fe+=_(H,P,V,ae,j);else if(ae==="object"){if(typeof N.then=="function")return _(J(N),P,V,H,j);throw P=String(N),Error("Objects are not valid as a React child (found: "+(P==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":P)+"). If you meant to render a collection of children, use an array instead.")}return fe}function Y(N,P,V){if(N==null)return N;var H=[],j=0;return _(N,H,"","",function(ae){return P.call(V,ae,j++)}),H}function Q(N){if(N._status===-1){var P=N._result;P=P(),P.then(function(V){(N._status===0||N._status===-1)&&(N._status=1,N._result=V)},function(V){(N._status===0||N._status===-1)&&(N._status=2,N._result=V)}),N._status===-1&&(N._status=0,N._result=P)}if(N._status===1)return N._result.default;throw N._result}var U=typeof reportError=="function"?reportError:function(N){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var P=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof N=="object"&&N!==null&&typeof N.message=="string"?String(N.message):String(N),error:N});if(!window.dispatchEvent(P))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",N);return}console.error(N)},se={map:Y,forEach:function(N,P,V){Y(N,function(){P.apply(this,arguments)},V)},count:function(N){var P=0;return Y(N,function(){P++}),P},toArray:function(N){return Y(N,function(P){return P})||[]},only:function(N){if(!I(N))throw Error("React.Children.only expected to receive a single React element child.");return N}};return wt.Activity=g,wt.Children=se,wt.Component=x,wt.Fragment=r,wt.Profiler=i,wt.PureComponent=E,wt.StrictMode=n,wt.Suspense=u,wt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,wt.__COMPILER_RUNTIME={__proto__:null,c:function(N){return F.H.useMemoCache(N)}},wt.cache=function(N){return function(){return N.apply(null,arguments)}},wt.cacheSignal=function(){return null},wt.cloneElement=function(N,P,V){if(N==null)throw Error("The argument must be a React element, but you passed "+N+".");var H=C({},N.props),j=N.key;if(P!=null)for(ae in P.key!==void 0&&(j=""+P.key),P)!O.call(P,ae)||ae==="key"||ae==="__self"||ae==="__source"||ae==="ref"&&P.ref===void 0||(H[ae]=P[ae]);var ae=arguments.length-2;if(ae===1)H.children=V;else if(1<ae){for(var fe=Array(ae),le=0;le<ae;le++)fe[le]=arguments[le+2];H.children=fe}return L(N.type,j,H)},wt.createContext=function(N){return N={$$typeof:o,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null},N.Provider=N,N.Consumer={$$typeof:s,_context:N},N},wt.createElement=function(N,P,V){var H,j={},ae=null;if(P!=null)for(H in P.key!==void 0&&(ae=""+P.key),P)O.call(P,H)&&H!=="key"&&H!=="__self"&&H!=="__source"&&(j[H]=P[H]);var fe=arguments.length-2;if(fe===1)j.children=V;else if(1<fe){for(var le=Array(fe),de=0;de<fe;de++)le[de]=arguments[de+2];j.children=le}if(N&&N.defaultProps)for(H in fe=N.defaultProps,fe)j[H]===void 0&&(j[H]=fe[H]);return L(N,ae,j)},wt.createRef=function(){return{current:null}},wt.forwardRef=function(N){return{$$typeof:a,render:N}},wt.isValidElement=I,wt.lazy=function(N){return{$$typeof:h,_payload:{_status:-1,_result:N},_init:Q}},wt.memo=function(N,P){return{$$typeof:d,type:N,compare:P===void 0?null:P}},wt.startTransition=function(N){var P=F.T,V={};F.T=V;try{var H=N(),j=F.S;j!==null&&j(V,H),typeof H=="object"&&H!==null&&typeof H.then=="function"&&H.then(M,U)}catch(ae){U(ae)}finally{P!==null&&V.types!==null&&(P.types=V.types),F.T=P}},wt.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},wt.use=function(N){return F.H.use(N)},wt.useActionState=function(N,P,V){return F.H.useActionState(N,P,V)},wt.useCallback=function(N,P){return F.H.useCallback(N,P)},wt.useContext=function(N){return F.H.useContext(N)},wt.useDebugValue=function(){},wt.useDeferredValue=function(N,P){return F.H.useDeferredValue(N,P)},wt.useEffect=function(N,P){return F.H.useEffect(N,P)},wt.useEffectEvent=function(N){return F.H.useEffectEvent(N)},wt.useId=function(){return F.H.useId()},wt.useImperativeHandle=function(N,P,V){return F.H.useImperativeHandle(N,P,V)},wt.useInsertionEffect=function(N,P){return F.H.useInsertionEffect(N,P)},wt.useLayoutEffect=function(N,P){return F.H.useLayoutEffect(N,P)},wt.useMemo=function(N,P){return F.H.useMemo(N,P)},wt.useOptimistic=function(N,P){return F.H.useOptimistic(N,P)},wt.useReducer=function(N,P,V){return F.H.useReducer(N,P,V)},wt.useRef=function(N){return F.H.useRef(N)},wt.useState=function(N){return F.H.useState(N)},wt.useSyncExternalStore=function(N,P,V){return F.H.useSyncExternalStore(N,P,V)},wt.useTransition=function(){return F.H.useTransition()},wt.version="19.2.0",wt}var HT;function fS(){return HT||(HT=1,BC.exports=vH()),BC.exports}var T=fS();const Oe=Mf(T),Gk=gH({__proto__:null,default:Oe},[T]);var HC={exports:{}},vh={},GC={exports:{}},VC={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GT;function wH(){return GT||(GT=1,(function(e){function t(_,Y){var Q=_.length;_.push(Y);e:for(;0<Q;){var U=Q-1>>>1,se=_[U];if(0<i(se,Y))_[U]=Y,_[Q]=se,Q=U;else break e}}function r(_){return _.length===0?null:_[0]}function n(_){if(_.length===0)return null;var Y=_[0],Q=_.pop();if(Q!==Y){_[0]=Q;e:for(var U=0,se=_.length,N=se>>>1;U<N;){var P=2*(U+1)-1,V=_[P],H=P+1,j=_[H];if(0>i(V,Q))H<se&&0>i(j,V)?(_[U]=j,_[H]=Q,U=H):(_[U]=V,_[P]=Q,U=P);else if(H<se&&0>i(j,Q))_[U]=j,_[H]=Q,U=H;else break e}}return Y}function i(_,Y){var Q=_.sortIndex-Y.sortIndex;return Q!==0?Q:_.id-Y.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var u=[],d=[],h=1,g=null,m=3,v=!1,w=!1,C=!1,b=!1,x=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function A(_){for(var Y=r(d);Y!==null;){if(Y.callback===null)n(d);else if(Y.startTime<=_)n(d),Y.sortIndex=Y.expirationTime,t(u,Y);else break;Y=r(d)}}function D(_){if(C=!1,A(_),!w)if(r(u)!==null)w=!0,M||(M=!0,G());else{var Y=r(d);Y!==null&&J(D,Y.startTime-_)}}var M=!1,F=-1,O=5,L=-1;function W(){return b?!0:!(e.unstable_now()-L<O)}function I(){if(b=!1,M){var _=e.unstable_now();L=_;var Y=!0;try{e:{w=!1,C&&(C=!1,R(F),F=-1),v=!0;var Q=m;try{t:{for(A(_),g=r(u);g!==null&&!(g.expirationTime>_&&W());){var U=g.callback;if(typeof U=="function"){g.callback=null,m=g.priorityLevel;var se=U(g.expirationTime<=_);if(_=e.unstable_now(),typeof se=="function"){g.callback=se,A(_),Y=!0;break t}g===r(u)&&n(u),A(_)}else n(u);g=r(u)}if(g!==null)Y=!0;else{var N=r(d);N!==null&&J(D,N.startTime-_),Y=!1}}break e}finally{g=null,m=Q,v=!1}Y=void 0}}finally{Y?G():M=!1}}}var G;if(typeof E=="function")G=function(){E(I)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,ie=ne.port2;ne.port1.onmessage=I,G=function(){ie.postMessage(null)}}else G=function(){x(I,0)};function J(_,Y){F=x(function(){_(e.unstable_now())},Y)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(_){_.callback=null},e.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<_?Math.floor(1e3/_):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_next=function(_){switch(m){case 1:case 2:case 3:var Y=3;break;default:Y=m}var Q=m;m=Y;try{return _()}finally{m=Q}},e.unstable_requestPaint=function(){b=!0},e.unstable_runWithPriority=function(_,Y){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var Q=m;m=_;try{return Y()}finally{m=Q}},e.unstable_scheduleCallback=function(_,Y,Q){var U=e.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?U+Q:U):Q=U,_){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=Q+se,_={id:h++,callback:Y,priorityLevel:_,startTime:Q,expirationTime:se,sortIndex:-1},Q>U?(_.sortIndex=Q,t(d,_),r(u)===null&&_===r(d)&&(C?(R(F),F=-1):C=!0,J(D,Q-U))):(_.sortIndex=se,t(u,_),w||v||(w=!0,M||(M=!0,G()))),_},e.unstable_shouldYield=W,e.unstable_wrapCallback=function(_){var Y=m;return function(){var Q=m;m=Y;try{return _.apply(this,arguments)}finally{m=Q}}}})(VC)),VC}var VT;function CH(){return VT||(VT=1,GC.exports=wH()),GC.exports}var zC={exports:{}},xn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zT;function yH(){if(zT)return xn;zT=1;var e=fS();function t(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)d+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},i=Symbol.for("react.portal");function s(u,d,h){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:g==null?null:""+g,children:u,containerInfo:d,implementation:h}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function a(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return xn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,xn.createPortal=function(u,d){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return s(u,d,null,h)},xn.flushSync=function(u){var d=o.T,h=n.p;try{if(o.T=null,n.p=2,u)return u()}finally{o.T=d,n.p=h,n.d.f()}},xn.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(u,d))},xn.prefetchDNS=function(u){typeof u=="string"&&n.d.D(u)},xn.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var h=d.as,g=a(h,d.crossOrigin),m=typeof d.integrity=="string"?d.integrity:void 0,v=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;h==="style"?n.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:g,integrity:m,fetchPriority:v}):h==="script"&&n.d.X(u,{crossOrigin:g,integrity:m,fetchPriority:v,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},xn.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var h=a(d.as,d.crossOrigin);n.d.M(u,{crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(u)},xn.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var h=d.as,g=a(h,d.crossOrigin);n.d.L(u,h,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},xn.preloadModule=function(u,d){if(typeof u=="string")if(d){var h=a(d.as,d.crossOrigin);n.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(u)},xn.requestFormReset=function(u){n.d.r(u)},xn.unstable_batchedUpdates=function(u,d){return u(d)},xn.useFormState=function(u,d,h){return o.H.useFormState(u,d,h)},xn.useFormStatus=function(){return o.H.useHostTransitionStatus()},xn.version="19.2.0",xn}var WT;function Vk(){if(WT)return zC.exports;WT=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),zC.exports=yH(),zC.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UT;function bH(){if(UT)return vh;UT=1;var e=CH(),t=fS(),r=Vk();function n(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function s(l){var c=l,f=l;if(l.alternate)for(;c.return;)c=c.return;else{l=c;do c=l,(c.flags&4098)!==0&&(f=c.return),l=c.return;while(l)}return c.tag===3?f:null}function o(l){if(l.tag===13){var c=l.memoizedState;if(c===null&&(l=l.alternate,l!==null&&(c=l.memoizedState)),c!==null)return c.dehydrated}return null}function a(l){if(l.tag===31){var c=l.memoizedState;if(c===null&&(l=l.alternate,l!==null&&(c=l.memoizedState)),c!==null)return c.dehydrated}return null}function u(l){if(s(l)!==l)throw Error(n(188))}function d(l){var c=l.alternate;if(!c){if(c=s(l),c===null)throw Error(n(188));return c!==l?null:l}for(var f=l,p=c;;){var y=f.return;if(y===null)break;var S=y.alternate;if(S===null){if(p=y.return,p!==null){f=p;continue}break}if(y.child===S.child){for(S=y.child;S;){if(S===f)return u(y),l;if(S===p)return u(y),c;S=S.sibling}throw Error(n(188))}if(f.return!==p.return)f=y,p=S;else{for(var k=!1,z=y.child;z;){if(z===f){k=!0,f=y,p=S;break}if(z===p){k=!0,p=y,f=S;break}z=z.sibling}if(!k){for(z=S.child;z;){if(z===f){k=!0,f=S,p=y;break}if(z===p){k=!0,p=S,f=y;break}z=z.sibling}if(!k)throw Error(n(189))}}if(f.alternate!==p)throw Error(n(190))}if(f.tag!==3)throw Error(n(188));return f.stateNode.current===f?l:c}function h(l){var c=l.tag;if(c===5||c===26||c===27||c===6)return l;for(l=l.child;l!==null;){if(c=h(l),c!==null)return c;l=l.sibling}return null}var g=Object.assign,m=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),E=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),W=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function G(l){return l===null||typeof l!="object"?null:(l=I&&l[I]||l["@@iterator"],typeof l=="function"?l:null)}var ne=Symbol.for("react.client.reference");function ie(l){if(l==null)return null;if(typeof l=="function")return l.$$typeof===ne?null:l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case C:return"Fragment";case x:return"Profiler";case b:return"StrictMode";case D:return"Suspense";case M:return"SuspenseList";case L:return"Activity"}if(typeof l=="object")switch(l.$$typeof){case w:return"Portal";case E:return l.displayName||"Context";case R:return(l._context.displayName||"Context")+".Consumer";case A:var c=l.render;return l=l.displayName,l||(l=c.displayName||c.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case F:return c=l.displayName||null,c!==null?c:ie(l.type)||"Memo";case O:c=l._payload,l=l._init;try{return ie(l(c))}catch{}}return null}var J=Array.isArray,_=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q={pending:!1,data:null,method:null,action:null},U=[],se=-1;function N(l){return{current:l}}function P(l){0>se||(l.current=U[se],U[se]=null,se--)}function V(l,c){se++,U[se]=l.current,l.current=c}var H=N(null),j=N(null),ae=N(null),fe=N(null);function le(l,c){switch(V(ae,c),V(j,l),V(H,null),c.nodeType){case 9:case 11:l=(l=c.documentElement)&&(l=l.namespaceURI)?sT(l):0;break;default:if(l=c.tagName,c=c.namespaceURI)c=sT(c),l=oT(c,l);else switch(l){case"svg":l=1;break;case"math":l=2;break;default:l=0}}P(H),V(H,l)}function de(){P(H),P(j),P(ae)}function ue(l){l.memoizedState!==null&&V(fe,l);var c=H.current,f=oT(c,l.type);c!==f&&(V(j,l),V(H,f))}function Ie(l){j.current===l&&(P(H),P(j)),fe.current===l&&(P(fe),hh._currentValue=Q)}var q,Ge;function Ye(l){if(q===void 0)try{throw Error()}catch(f){var c=f.stack.trim().match(/\n( *(at )?)/);q=c&&c[1]||"",Ge=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+q+l+Ge}var Ze=!1;function ke(l,c){if(!l||Ze)return"";Ze=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(c){var Pe=function(){throw Error()};if(Object.defineProperty(Pe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Pe,[])}catch(Se){var ye=Se}Reflect.construct(l,[],Pe)}else{try{Pe.call()}catch(Se){ye=Se}l.call(Pe.prototype)}}else{try{throw Error()}catch(Se){ye=Se}(Pe=l())&&typeof Pe.catch=="function"&&Pe.catch(function(){})}}catch(Se){if(Se&&ye&&typeof Se.stack=="string")return[Se.stack,ye.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=p.DetermineComponentFrameRoot(),k=S[0],z=S[1];if(k&&z){var oe=k.split(`
`),pe=z.split(`
`);for(y=p=0;p<oe.length&&!oe[p].includes("DetermineComponentFrameRoot");)p++;for(;y<pe.length&&!pe[y].includes("DetermineComponentFrameRoot");)y++;if(p===oe.length||y===pe.length)for(p=oe.length-1,y=pe.length-1;1<=p&&0<=y&&oe[p]!==pe[y];)y--;for(;1<=p&&0<=y;p--,y--)if(oe[p]!==pe[y]){if(p!==1||y!==1)do if(p--,y--,0>y||oe[p]!==pe[y]){var Te=`
`+oe[p].replace(" at new "," at ");return l.displayName&&Te.includes("<anonymous>")&&(Te=Te.replace("<anonymous>",l.displayName)),Te}while(1<=p&&0<=y);break}}}finally{Ze=!1,Error.prepareStackTrace=f}return(f=l?l.displayName||l.name:"")?Ye(f):""}function De(l,c){switch(l.tag){case 26:case 27:case 5:return Ye(l.type);case 16:return Ye("Lazy");case 13:return l.child!==c&&c!==null?Ye("Suspense Fallback"):Ye("Suspense");case 19:return Ye("SuspenseList");case 0:case 15:return ke(l.type,!1);case 11:return ke(l.type.render,!1);case 1:return ke(l.type,!0);case 31:return Ye("Activity");default:return""}}function nt(l){try{var c="",f=null;do c+=De(l,f),f=l,l=l.return;while(l);return c}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var vt=Object.prototype.hasOwnProperty,Xe=e.unstable_scheduleCallback,st=e.unstable_cancelCallback,Ct=e.unstable_shouldYield,ar=e.unstable_requestPaint,qe=e.unstable_now,hr=e.unstable_getCurrentPriorityLevel,Or=e.unstable_ImmediatePriority,Et=e.unstable_UserBlockingPriority,dt=e.unstable_NormalPriority,At=e.unstable_LowPriority,ht=e.unstable_IdlePriority,jt=e.log,Tt=e.unstable_setDisableYieldValue,It=null,lr=null;function $r(l){if(typeof jt=="function"&&Tt(l),lr&&typeof lr.setStrictMode=="function")try{lr.setStrictMode(It,l)}catch{}}var Cr=Math.clz32?Math.clz32:Sn,dl=Math.log,Yt=Math.LN2;function Sn(l){return l>>>=0,l===0?32:31-(dl(l)/Yt|0)|0}var nn=256,uo=262144,ia=4194304;function Ar(l){var c=l&42;if(c!==0)return c;switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return l&261888;case 262144:case 524288:case 1048576:case 2097152:return l&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return l&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return l}}function sa(l,c,f){var p=l.pendingLanes;if(p===0)return 0;var y=0,S=l.suspendedLanes,k=l.pingedLanes;l=l.warmLanes;var z=p&134217727;return z!==0?(p=z&~S,p!==0?y=Ar(p):(k&=z,k!==0?y=Ar(k):f||(f=z&~l,f!==0&&(y=Ar(f))))):(z=p&~S,z!==0?y=Ar(z):k!==0?y=Ar(k):f||(f=p&~l,f!==0&&(y=Ar(f)))),y===0?0:c!==0&&c!==y&&(c&S)===0&&(S=y&-y,f=c&-c,S>=f||S===32&&(f&4194048)!==0)?c:y}function ho(l,c){return(l.pendingLanes&~(l.suspendedLanes&~l.pingedLanes)&c)===0}function hl(l,c){switch(l){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oa(){var l=ia;return ia<<=1,(ia&62914560)===0&&(ia=4194304),l}function fo(l){for(var c=[],f=0;31>f;f++)c.push(l);return c}function hs(l,c){l.pendingLanes|=c,c!==268435456&&(l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0)}function Fc(l,c,f,p,y,S){var k=l.pendingLanes;l.pendingLanes=f,l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0,l.expiredLanes&=f,l.entangledLanes&=f,l.errorRecoveryDisabledLanes&=f,l.shellSuspendCounter=0;var z=l.entanglements,oe=l.expirationTimes,pe=l.hiddenUpdates;for(f=k&~f;0<f;){var Te=31-Cr(f),Pe=1<<Te;z[Te]=0,oe[Te]=-1;var ye=pe[Te];if(ye!==null)for(pe[Te]=null,Te=0;Te<ye.length;Te++){var Se=ye[Te];Se!==null&&(Se.lane&=-536870913)}f&=~Pe}p!==0&&Dc(l,p,0),S!==0&&y===0&&l.tag!==0&&(l.suspendedLanes|=S&~(k&~c))}function Dc(l,c,f){l.pendingLanes|=c,l.suspendedLanes&=~c;var p=31-Cr(c);l.entangledLanes|=c,l.entanglements[p]=l.entanglements[p]|1073741824|f&261930}function kt(l,c){var f=l.entangledLanes|=c;for(l=l.entanglements;f;){var p=31-Cr(f),y=1<<p;y&c|l[p]&c&&(l[p]|=c),f&=~y}}function jr(l,c){var f=c&-c;return f=(f&42)!==0?1:Ms(f),(f&(l.suspendedLanes|c))!==0?0:f}function Ms(l){switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=128;break;case 268435456:l=134217728;break;default:l=0}return l}function aa(l){return l&=-l,2<l?8<l?(l&134217727)!==0?32:268435456:8:2}function B(){var l=Y.p;return l!==0?l:(l=window.event,l===void 0?32:AT(l.type))}function te(l,c){var f=Y.p;try{return Y.p=l,c()}finally{Y.p=f}}var K=Math.random().toString(36).slice(2),X="__reactFiber$"+K,ee="__reactProps$"+K,re="__reactContainer$"+K,ve="__reactEvents$"+K,Fe="__reactListeners$"+K,we="__reactHandles$"+K,Ce="__reactResources$"+K,be="__reactMarker$"+K;function Ne(l){delete l[X],delete l[ee],delete l[ve],delete l[Fe],delete l[we]}function Ve(l){var c=l[X];if(c)return c;for(var f=l.parentNode;f;){if(c=f[re]||f[X]){if(f=c.alternate,c.child!==null||f!==null&&f.child!==null)for(l=fT(l);l!==null;){if(f=l[X])return f;l=fT(l)}return c}l=f,f=l.parentNode}return null}function Ke(l){if(l=l[X]||l[re]){var c=l.tag;if(c===5||c===6||c===13||c===31||c===26||c===27||c===3)return l}return null}function Be(l){var c=l.tag;if(c===5||c===26||c===27||c===6)return l.stateNode;throw Error(n(33))}function je(l){var c=l[Ce];return c||(c=l[Ce]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function Je(l){l[be]=!0}var cr=new Set,ur={};function yr(l,c){Li(l,c),Li(l+"Capture",c)}function Li(l,c){for(ur[l]=c,l=0;l<c.length;l++)cr.add(c[l])}var fl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),la={},_s={};function Dd(l){return vt.call(_s,l)?!0:vt.call(la,l)?!1:fl.test(l)?_s[l]=!0:(la[l]=!0,!1)}function qn(l,c,f){if(Dd(c))if(f===null)l.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":l.removeAttribute(c);return;case"boolean":var p=c.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){l.removeAttribute(c);return}}l.setAttribute(c,""+f)}}function ag(l,c,f){if(f===null)l.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(c);return}l.setAttribute(c,""+f)}}function go(l,c,f,p){if(p===null)l.removeAttribute(f);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(f);return}l.setAttributeNS(c,f,""+p)}}function Ii(l){switch(typeof l){case"bigint":case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function Q1(l){var c=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function aB(l,c,f){var p=Object.getOwnPropertyDescriptor(l.constructor.prototype,c);if(!l.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var y=p.get,S=p.set;return Object.defineProperty(l,c,{configurable:!0,get:function(){return y.call(this)},set:function(k){f=""+k,S.call(this,k)}}),Object.defineProperty(l,c,{enumerable:p.enumerable}),{getValue:function(){return f},setValue:function(k){f=""+k},stopTracking:function(){l._valueTracker=null,delete l[c]}}}}function kv(l){if(!l._valueTracker){var c=Q1(l)?"checked":"value";l._valueTracker=aB(l,c,""+l[c])}}function Z1(l){if(!l)return!1;var c=l._valueTracker;if(!c)return!0;var f=c.getValue(),p="";return l&&(p=Q1(l)?l.checked?"true":"false":l.value),l=p,l!==f?(c.setValue(l),!0):!1}function lg(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}var lB=/[\n"\\]/g;function Oi(l){return l.replace(lB,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function Pv(l,c,f,p,y,S,k,z){l.name="",k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?l.type=k:l.removeAttribute("type"),c!=null?k==="number"?(c===0&&l.value===""||l.value!=c)&&(l.value=""+Ii(c)):l.value!==""+Ii(c)&&(l.value=""+Ii(c)):k!=="submit"&&k!=="reset"||l.removeAttribute("value"),c!=null?Mv(l,k,Ii(c)):f!=null?Mv(l,k,Ii(f)):p!=null&&l.removeAttribute("value"),y==null&&S!=null&&(l.defaultChecked=!!S),y!=null&&(l.checked=y&&typeof y!="function"&&typeof y!="symbol"),z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?l.name=""+Ii(z):l.removeAttribute("name")}function J1(l,c,f,p,y,S,k,z){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(l.type=S),c!=null||f!=null){if(!(S!=="submit"&&S!=="reset"||c!=null)){kv(l);return}f=f!=null?""+Ii(f):"",c=c!=null?""+Ii(c):f,z||c===l.value||(l.value=c),l.defaultValue=c}p=p??y,p=typeof p!="function"&&typeof p!="symbol"&&!!p,l.checked=z?l.checked:!!p,l.defaultChecked=!!p,k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(l.name=k),kv(l)}function Mv(l,c,f){c==="number"&&lg(l.ownerDocument)===l||l.defaultValue===""+f||(l.defaultValue=""+f)}function Ac(l,c,f,p){if(l=l.options,c){c={};for(var y=0;y<f.length;y++)c["$"+f[y]]=!0;for(f=0;f<l.length;f++)y=c.hasOwnProperty("$"+l[f].value),l[f].selected!==y&&(l[f].selected=y),y&&p&&(l[f].defaultSelected=!0)}else{for(f=""+Ii(f),c=null,y=0;y<l.length;y++){if(l[y].value===f){l[y].selected=!0,p&&(l[y].defaultSelected=!0);return}c!==null||l[y].disabled||(c=l[y])}c!==null&&(c.selected=!0)}}function eE(l,c,f){if(c!=null&&(c=""+Ii(c),c!==l.value&&(l.value=c),f==null)){l.defaultValue!==c&&(l.defaultValue=c);return}l.defaultValue=f!=null?""+Ii(f):""}function tE(l,c,f,p){if(c==null){if(p!=null){if(f!=null)throw Error(n(92));if(J(p)){if(1<p.length)throw Error(n(93));p=p[0]}f=p}f==null&&(f=""),c=f}f=Ii(c),l.defaultValue=f,p=l.textContent,p===f&&p!==""&&p!==null&&(l.value=p),kv(l)}function kc(l,c){if(c){var f=l.firstChild;if(f&&f===l.lastChild&&f.nodeType===3){f.nodeValue=c;return}}l.textContent=c}var cB=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function rE(l,c,f){var p=c.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?p?l.setProperty(c,""):c==="float"?l.cssFloat="":l[c]="":p?l.setProperty(c,f):typeof f!="number"||f===0||cB.has(c)?c==="float"?l.cssFloat=f:l[c]=(""+f).trim():l[c]=f+"px"}function nE(l,c,f){if(c!=null&&typeof c!="object")throw Error(n(62));if(l=l.style,f!=null){for(var p in f)!f.hasOwnProperty(p)||c!=null&&c.hasOwnProperty(p)||(p.indexOf("--")===0?l.setProperty(p,""):p==="float"?l.cssFloat="":l[p]="");for(var y in c)p=c[y],c.hasOwnProperty(y)&&f[y]!==p&&rE(l,y,p)}else for(var S in c)c.hasOwnProperty(S)&&rE(l,S,c[S])}function _v(l){if(l.indexOf("-")===-1)return!1;switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var uB=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),dB=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function cg(l){return dB.test(""+l)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":l}function po(){}var Lv=null;function Iv(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var Pc=null,Mc=null;function iE(l){var c=Ke(l);if(c&&(l=c.stateNode)){var f=l[ee]||null;e:switch(l=c.stateNode,c.type){case"input":if(Pv(l,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),c=f.name,f.type==="radio"&&c!=null){for(f=l;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Oi(""+c)+'"][type="radio"]'),c=0;c<f.length;c++){var p=f[c];if(p!==l&&p.form===l.form){var y=p[ee]||null;if(!y)throw Error(n(90));Pv(p,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(c=0;c<f.length;c++)p=f[c],p.form===l.form&&Z1(p)}break e;case"textarea":eE(l,f.value,f.defaultValue);break e;case"select":c=f.value,c!=null&&Ac(l,!!f.multiple,c,!1)}}}var Ov=!1;function sE(l,c,f){if(Ov)return l(c,f);Ov=!0;try{var p=l(c);return p}finally{if(Ov=!1,(Pc!==null||Mc!==null)&&(Xg(),Pc&&(c=Pc,l=Mc,Mc=Pc=null,iE(c),l)))for(c=0;c<l.length;c++)iE(l[c])}}function Ad(l,c){var f=l.stateNode;if(f===null)return null;var p=f[ee]||null;if(p===null)return null;f=p[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(l=l.type,p=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!p;break e;default:l=!1}if(l)return null;if(f&&typeof f!="function")throw Error(n(231,c,typeof f));return f}var mo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Nv=!1;if(mo)try{var kd={};Object.defineProperty(kd,"passive",{get:function(){Nv=!0}}),window.addEventListener("test",kd,kd),window.removeEventListener("test",kd,kd)}catch{Nv=!1}var ca=null,Bv=null,ug=null;function oE(){if(ug)return ug;var l,c=Bv,f=c.length,p,y="value"in ca?ca.value:ca.textContent,S=y.length;for(l=0;l<f&&c[l]===y[l];l++);var k=f-l;for(p=1;p<=k&&c[f-p]===y[S-p];p++);return ug=y.slice(l,1<p?1-p:void 0)}function dg(l){var c=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&c===13&&(l=13)):l=c,l===10&&(l=13),32<=l||l===13?l:0}function hg(){return!0}function aE(){return!1}function Xn(l){function c(f,p,y,S,k){this._reactName=f,this._targetInst=y,this.type=p,this.nativeEvent=S,this.target=k,this.currentTarget=null;for(var z in l)l.hasOwnProperty(z)&&(f=l[z],this[z]=f?f(S):S[z]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?hg:aE,this.isPropagationStopped=aE,this}return g(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=hg)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=hg)},persist:function(){},isPersistent:hg}),c}var gl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fg=Xn(gl),Pd=g({},gl,{view:0,detail:0}),hB=Xn(Pd),Hv,Gv,Md,gg=g({},Pd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zv,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Md&&(Md&&l.type==="mousemove"?(Hv=l.screenX-Md.screenX,Gv=l.screenY-Md.screenY):Gv=Hv=0,Md=l),Hv)},movementY:function(l){return"movementY"in l?l.movementY:Gv}}),lE=Xn(gg),fB=g({},gg,{dataTransfer:0}),gB=Xn(fB),pB=g({},Pd,{relatedTarget:0}),Vv=Xn(pB),mB=g({},gl,{animationName:0,elapsedTime:0,pseudoElement:0}),vB=Xn(mB),wB=g({},gl,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),CB=Xn(wB),yB=g({},gl,{data:0}),cE=Xn(yB),bB={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},SB={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xB={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function EB(l){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(l):(l=xB[l])?!!c[l]:!1}function zv(){return EB}var RB=g({},Pd,{key:function(l){if(l.key){var c=bB[l.key]||l.key;if(c!=="Unidentified")return c}return l.type==="keypress"?(l=dg(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?SB[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zv,charCode:function(l){return l.type==="keypress"?dg(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?dg(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),TB=Xn(RB),FB=g({},gg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),uE=Xn(FB),DB=g({},Pd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zv}),AB=Xn(DB),kB=g({},gl,{propertyName:0,elapsedTime:0,pseudoElement:0}),PB=Xn(kB),MB=g({},gg,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),_B=Xn(MB),LB=g({},gl,{newState:0,oldState:0}),IB=Xn(LB),OB=[9,13,27,32],Wv=mo&&"CompositionEvent"in window,_d=null;mo&&"documentMode"in document&&(_d=document.documentMode);var NB=mo&&"TextEvent"in window&&!_d,dE=mo&&(!Wv||_d&&8<_d&&11>=_d),hE=" ",fE=!1;function gE(l,c){switch(l){case"keyup":return OB.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function pE(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var _c=!1;function BB(l,c){switch(l){case"compositionend":return pE(c);case"keypress":return c.which!==32?null:(fE=!0,hE);case"textInput":return l=c.data,l===hE&&fE?null:l;default:return null}}function HB(l,c){if(_c)return l==="compositionend"||!Wv&&gE(l,c)?(l=oE(),ug=Bv=ca=null,_c=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return dE&&c.locale!=="ko"?null:c.data;default:return null}}var GB={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mE(l){var c=l&&l.nodeName&&l.nodeName.toLowerCase();return c==="input"?!!GB[l.type]:c==="textarea"}function vE(l,c,f,p){Pc?Mc?Mc.push(p):Mc=[p]:Pc=p,c=np(c,"onChange"),0<c.length&&(f=new fg("onChange","change",null,f,p),l.push({event:f,listeners:c}))}var Ld=null,Id=null;function VB(l){J2(l,0)}function pg(l){var c=Be(l);if(Z1(c))return l}function wE(l,c){if(l==="change")return c}var CE=!1;if(mo){var Uv;if(mo){var $v="oninput"in document;if(!$v){var yE=document.createElement("div");yE.setAttribute("oninput","return;"),$v=typeof yE.oninput=="function"}Uv=$v}else Uv=!1;CE=Uv&&(!document.documentMode||9<document.documentMode)}function bE(){Ld&&(Ld.detachEvent("onpropertychange",SE),Id=Ld=null)}function SE(l){if(l.propertyName==="value"&&pg(Id)){var c=[];vE(c,Id,l,Iv(l)),sE(VB,c)}}function zB(l,c,f){l==="focusin"?(bE(),Ld=c,Id=f,Ld.attachEvent("onpropertychange",SE)):l==="focusout"&&bE()}function WB(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return pg(Id)}function UB(l,c){if(l==="click")return pg(c)}function $B(l,c){if(l==="input"||l==="change")return pg(c)}function jB(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var hi=typeof Object.is=="function"?Object.is:jB;function Od(l,c){if(hi(l,c))return!0;if(typeof l!="object"||l===null||typeof c!="object"||c===null)return!1;var f=Object.keys(l),p=Object.keys(c);if(f.length!==p.length)return!1;for(p=0;p<f.length;p++){var y=f[p];if(!vt.call(c,y)||!hi(l[y],c[y]))return!1}return!0}function xE(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function EE(l,c){var f=xE(l);l=0;for(var p;f;){if(f.nodeType===3){if(p=l+f.textContent.length,l<=c&&p>=c)return{node:f,offset:c-l};l=p}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=xE(f)}}function RE(l,c){return l&&c?l===c?!0:l&&l.nodeType===3?!1:c&&c.nodeType===3?RE(l,c.parentNode):"contains"in l?l.contains(c):l.compareDocumentPosition?!!(l.compareDocumentPosition(c)&16):!1:!1}function TE(l){l=l!=null&&l.ownerDocument!=null&&l.ownerDocument.defaultView!=null?l.ownerDocument.defaultView:window;for(var c=lg(l.document);c instanceof l.HTMLIFrameElement;){try{var f=typeof c.contentWindow.location.href=="string"}catch{f=!1}if(f)l=c.contentWindow;else break;c=lg(l.document)}return c}function jv(l){var c=l&&l.nodeName&&l.nodeName.toLowerCase();return c&&(c==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||c==="textarea"||l.contentEditable==="true")}var YB=mo&&"documentMode"in document&&11>=document.documentMode,Lc=null,Yv=null,Nd=null,Kv=!1;function FE(l,c,f){var p=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Kv||Lc==null||Lc!==lg(p)||(p=Lc,"selectionStart"in p&&jv(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Nd&&Od(Nd,p)||(Nd=p,p=np(Yv,"onSelect"),0<p.length&&(c=new fg("onSelect","select",null,c,f),l.push({event:c,listeners:p}),c.target=Lc)))}function pl(l,c){var f={};return f[l.toLowerCase()]=c.toLowerCase(),f["Webkit"+l]="webkit"+c,f["Moz"+l]="moz"+c,f}var Ic={animationend:pl("Animation","AnimationEnd"),animationiteration:pl("Animation","AnimationIteration"),animationstart:pl("Animation","AnimationStart"),transitionrun:pl("Transition","TransitionRun"),transitionstart:pl("Transition","TransitionStart"),transitioncancel:pl("Transition","TransitionCancel"),transitionend:pl("Transition","TransitionEnd")},qv={},DE={};mo&&(DE=document.createElement("div").style,"AnimationEvent"in window||(delete Ic.animationend.animation,delete Ic.animationiteration.animation,delete Ic.animationstart.animation),"TransitionEvent"in window||delete Ic.transitionend.transition);function ml(l){if(qv[l])return qv[l];if(!Ic[l])return l;var c=Ic[l],f;for(f in c)if(c.hasOwnProperty(f)&&f in DE)return qv[l]=c[f];return l}var AE=ml("animationend"),kE=ml("animationiteration"),PE=ml("animationstart"),KB=ml("transitionrun"),qB=ml("transitionstart"),XB=ml("transitioncancel"),ME=ml("transitionend"),_E=new Map,Xv="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Xv.push("scrollEnd");function fs(l,c){_E.set(l,c),yr(c,[l])}var mg=typeof reportError=="function"?reportError:function(l){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof l=="object"&&l!==null&&typeof l.message=="string"?String(l.message):String(l),error:l});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",l);return}console.error(l)},Ni=[],Oc=0,Qv=0;function vg(){for(var l=Oc,c=Qv=Oc=0;c<l;){var f=Ni[c];Ni[c++]=null;var p=Ni[c];Ni[c++]=null;var y=Ni[c];Ni[c++]=null;var S=Ni[c];if(Ni[c++]=null,p!==null&&y!==null){var k=p.pending;k===null?y.next=y:(y.next=k.next,k.next=y),p.pending=y}S!==0&&LE(f,y,S)}}function wg(l,c,f,p){Ni[Oc++]=l,Ni[Oc++]=c,Ni[Oc++]=f,Ni[Oc++]=p,Qv|=p,l.lanes|=p,l=l.alternate,l!==null&&(l.lanes|=p)}function Zv(l,c,f,p){return wg(l,c,f,p),Cg(l)}function vl(l,c){return wg(l,null,null,c),Cg(l)}function LE(l,c,f){l.lanes|=f;var p=l.alternate;p!==null&&(p.lanes|=f);for(var y=!1,S=l.return;S!==null;)S.childLanes|=f,p=S.alternate,p!==null&&(p.childLanes|=f),S.tag===22&&(l=S.stateNode,l===null||l._visibility&1||(y=!0)),l=S,S=S.return;return l.tag===3?(S=l.stateNode,y&&c!==null&&(y=31-Cr(f),l=S.hiddenUpdates,p=l[y],p===null?l[y]=[c]:p.push(c),c.lane=f|536870912),S):null}function Cg(l){if(50<sh)throw sh=0,aC=null,Error(n(185));for(var c=l.return;c!==null;)l=c,c=l.return;return l.tag===3?l.stateNode:null}var Nc={};function QB(l,c,f,p){this.tag=l,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fi(l,c,f,p){return new QB(l,c,f,p)}function Jv(l){return l=l.prototype,!(!l||!l.isReactComponent)}function vo(l,c){var f=l.alternate;return f===null?(f=fi(l.tag,c,l.key,l.mode),f.elementType=l.elementType,f.type=l.type,f.stateNode=l.stateNode,f.alternate=l,l.alternate=f):(f.pendingProps=c,f.type=l.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=l.flags&65011712,f.childLanes=l.childLanes,f.lanes=l.lanes,f.child=l.child,f.memoizedProps=l.memoizedProps,f.memoizedState=l.memoizedState,f.updateQueue=l.updateQueue,c=l.dependencies,f.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},f.sibling=l.sibling,f.index=l.index,f.ref=l.ref,f.refCleanup=l.refCleanup,f}function IE(l,c){l.flags&=65011714;var f=l.alternate;return f===null?(l.childLanes=0,l.lanes=c,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=f.childLanes,l.lanes=f.lanes,l.child=f.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=f.memoizedProps,l.memoizedState=f.memoizedState,l.updateQueue=f.updateQueue,l.type=f.type,c=f.dependencies,l.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),l}function yg(l,c,f,p,y,S){var k=0;if(p=l,typeof l=="function")Jv(l)&&(k=1);else if(typeof l=="string")k=rH(l,f,H.current)?26:l==="html"||l==="head"||l==="body"?27:5;else e:switch(l){case L:return l=fi(31,f,c,y),l.elementType=L,l.lanes=S,l;case C:return wl(f.children,y,S,c);case b:k=8,y|=24;break;case x:return l=fi(12,f,c,y|2),l.elementType=x,l.lanes=S,l;case D:return l=fi(13,f,c,y),l.elementType=D,l.lanes=S,l;case M:return l=fi(19,f,c,y),l.elementType=M,l.lanes=S,l;default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case E:k=10;break e;case R:k=9;break e;case A:k=11;break e;case F:k=14;break e;case O:k=16,p=null;break e}k=29,f=Error(n(130,l===null?"null":typeof l,"")),p=null}return c=fi(k,f,c,y),c.elementType=l,c.type=p,c.lanes=S,c}function wl(l,c,f,p){return l=fi(7,l,p,c),l.lanes=f,l}function ew(l,c,f){return l=fi(6,l,null,c),l.lanes=f,l}function OE(l){var c=fi(18,null,null,0);return c.stateNode=l,c}function tw(l,c,f){return c=fi(4,l.children!==null?l.children:[],l.key,c),c.lanes=f,c.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},c}var NE=new WeakMap;function Bi(l,c){if(typeof l=="object"&&l!==null){var f=NE.get(l);return f!==void 0?f:(c={value:l,source:c,stack:nt(c)},NE.set(l,c),c)}return{value:l,source:c,stack:nt(c)}}var Bc=[],Hc=0,bg=null,Bd=0,Hi=[],Gi=0,ua=null,Ls=1,Is="";function wo(l,c){Bc[Hc++]=Bd,Bc[Hc++]=bg,bg=l,Bd=c}function BE(l,c,f){Hi[Gi++]=Ls,Hi[Gi++]=Is,Hi[Gi++]=ua,ua=l;var p=Ls;l=Is;var y=32-Cr(p)-1;p&=~(1<<y),f+=1;var S=32-Cr(c)+y;if(30<S){var k=y-y%5;S=(p&(1<<k)-1).toString(32),p>>=k,y-=k,Ls=1<<32-Cr(c)+y|f<<y|p,Is=S+l}else Ls=1<<S|f<<y|p,Is=l}function rw(l){l.return!==null&&(wo(l,1),BE(l,1,0))}function nw(l){for(;l===bg;)bg=Bc[--Hc],Bc[Hc]=null,Bd=Bc[--Hc],Bc[Hc]=null;for(;l===ua;)ua=Hi[--Gi],Hi[Gi]=null,Is=Hi[--Gi],Hi[Gi]=null,Ls=Hi[--Gi],Hi[Gi]=null}function HE(l,c){Hi[Gi++]=Ls,Hi[Gi++]=Is,Hi[Gi++]=ua,Ls=c.id,Is=c.overflow,ua=l}var fn=null,fr=null,Ot=!1,da=null,Vi=!1,iw=Error(n(519));function ha(l){var c=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Hd(Bi(c,l)),iw}function GE(l){var c=l.stateNode,f=l.type,p=l.memoizedProps;switch(c[X]=l,c[ee]=p,f){case"dialog":Mt("cancel",c),Mt("close",c);break;case"iframe":case"object":case"embed":Mt("load",c);break;case"video":case"audio":for(f=0;f<ah.length;f++)Mt(ah[f],c);break;case"source":Mt("error",c);break;case"img":case"image":case"link":Mt("error",c),Mt("load",c);break;case"details":Mt("toggle",c);break;case"input":Mt("invalid",c),J1(c,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":Mt("invalid",c);break;case"textarea":Mt("invalid",c),tE(c,p.value,p.defaultValue,p.children)}f=p.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||c.textContent===""+f||p.suppressHydrationWarning===!0||nT(c.textContent,f)?(p.popover!=null&&(Mt("beforetoggle",c),Mt("toggle",c)),p.onScroll!=null&&Mt("scroll",c),p.onScrollEnd!=null&&Mt("scrollend",c),p.onClick!=null&&(c.onclick=po),c=!0):c=!1,c||ha(l,!0)}function VE(l){for(fn=l.return;fn;)switch(fn.tag){case 5:case 31:case 13:Vi=!1;return;case 27:case 3:Vi=!0;return;default:fn=fn.return}}function Gc(l){if(l!==fn)return!1;if(!Ot)return VE(l),Ot=!0,!1;var c=l.tag,f;if((f=c!==3&&c!==27)&&((f=c===5)&&(f=l.type,f=!(f!=="form"&&f!=="button")||SC(l.type,l.memoizedProps)),f=!f),f&&fr&&ha(l),VE(l),c===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(317));fr=hT(l)}else if(c===31){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(317));fr=hT(l)}else c===27?(c=fr,Ta(l.type)?(l=FC,FC=null,fr=l):fr=c):fr=fn?Wi(l.stateNode.nextSibling):null;return!0}function Cl(){fr=fn=null,Ot=!1}function sw(){var l=da;return l!==null&&(ei===null?ei=l:ei.push.apply(ei,l),da=null),l}function Hd(l){da===null?da=[l]:da.push(l)}var ow=N(null),yl=null,Co=null;function fa(l,c,f){V(ow,c._currentValue),c._currentValue=f}function yo(l){l._currentValue=ow.current,P(ow)}function aw(l,c,f){for(;l!==null;){var p=l.alternate;if((l.childLanes&c)!==c?(l.childLanes|=c,p!==null&&(p.childLanes|=c)):p!==null&&(p.childLanes&c)!==c&&(p.childLanes|=c),l===f)break;l=l.return}}function lw(l,c,f,p){var y=l.child;for(y!==null&&(y.return=l);y!==null;){var S=y.dependencies;if(S!==null){var k=y.child;S=S.firstContext;e:for(;S!==null;){var z=S;S=y;for(var oe=0;oe<c.length;oe++)if(z.context===c[oe]){S.lanes|=f,z=S.alternate,z!==null&&(z.lanes|=f),aw(S.return,f,l),p||(k=null);break e}S=z.next}}else if(y.tag===18){if(k=y.return,k===null)throw Error(n(341));k.lanes|=f,S=k.alternate,S!==null&&(S.lanes|=f),aw(k,f,l),k=null}else k=y.child;if(k!==null)k.return=y;else for(k=y;k!==null;){if(k===l){k=null;break}if(y=k.sibling,y!==null){y.return=k.return,k=y;break}k=k.return}y=k}}function Vc(l,c,f,p){l=null;for(var y=c,S=!1;y!==null;){if(!S){if((y.flags&524288)!==0)S=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var k=y.alternate;if(k===null)throw Error(n(387));if(k=k.memoizedProps,k!==null){var z=y.type;hi(y.pendingProps.value,k.value)||(l!==null?l.push(z):l=[z])}}else if(y===fe.current){if(k=y.alternate,k===null)throw Error(n(387));k.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(l!==null?l.push(hh):l=[hh])}y=y.return}l!==null&&lw(c,l,f,p),c.flags|=262144}function Sg(l){for(l=l.firstContext;l!==null;){if(!hi(l.context._currentValue,l.memoizedValue))return!0;l=l.next}return!1}function bl(l){yl=l,Co=null,l=l.dependencies,l!==null&&(l.firstContext=null)}function gn(l){return zE(yl,l)}function xg(l,c){return yl===null&&bl(l),zE(l,c)}function zE(l,c){var f=c._currentValue;if(c={context:c,memoizedValue:f,next:null},Co===null){if(l===null)throw Error(n(308));Co=c,l.dependencies={lanes:0,firstContext:c},l.flags|=524288}else Co=Co.next=c;return f}var ZB=typeof AbortController<"u"?AbortController:function(){var l=[],c=this.signal={aborted:!1,addEventListener:function(f,p){l.push(p)}};this.abort=function(){c.aborted=!0,l.forEach(function(f){return f()})}},JB=e.unstable_scheduleCallback,e3=e.unstable_NormalPriority,Yr={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function cw(){return{controller:new ZB,data:new Map,refCount:0}}function Gd(l){l.refCount--,l.refCount===0&&JB(e3,function(){l.controller.abort()})}var Vd=null,uw=0,zc=0,Wc=null;function t3(l,c){if(Vd===null){var f=Vd=[];uw=0,zc=fC(),Wc={status:"pending",value:void 0,then:function(p){f.push(p)}}}return uw++,c.then(WE,WE),c}function WE(){if(--uw===0&&Vd!==null){Wc!==null&&(Wc.status="fulfilled");var l=Vd;Vd=null,zc=0,Wc=null;for(var c=0;c<l.length;c++)(0,l[c])()}}function r3(l,c){var f=[],p={status:"pending",value:null,reason:null,then:function(y){f.push(y)}};return l.then(function(){p.status="fulfilled",p.value=c;for(var y=0;y<f.length;y++)(0,f[y])(c)},function(y){for(p.status="rejected",p.reason=y,y=0;y<f.length;y++)(0,f[y])(void 0)}),p}var UE=_.S;_.S=function(l,c){F2=qe(),typeof c=="object"&&c!==null&&typeof c.then=="function"&&t3(l,c),UE!==null&&UE(l,c)};var Sl=N(null);function dw(){var l=Sl.current;return l!==null?l:or.pooledCache}function Eg(l,c){c===null?V(Sl,Sl.current):V(Sl,c.pool)}function $E(){var l=dw();return l===null?null:{parent:Yr._currentValue,pool:l}}var Uc=Error(n(460)),hw=Error(n(474)),Rg=Error(n(542)),Tg={then:function(){}};function jE(l){return l=l.status,l==="fulfilled"||l==="rejected"}function YE(l,c,f){switch(f=l[f],f===void 0?l.push(c):f!==c&&(c.then(po,po),c=f),c.status){case"fulfilled":return c.value;case"rejected":throw l=c.reason,qE(l),l;default:if(typeof c.status=="string")c.then(po,po);else{if(l=or,l!==null&&100<l.shellSuspendCounter)throw Error(n(482));l=c,l.status="pending",l.then(function(p){if(c.status==="pending"){var y=c;y.status="fulfilled",y.value=p}},function(p){if(c.status==="pending"){var y=c;y.status="rejected",y.reason=p}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw l=c.reason,qE(l),l}throw El=c,Uc}}function xl(l){try{var c=l._init;return c(l._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(El=f,Uc):f}}var El=null;function KE(){if(El===null)throw Error(n(459));var l=El;return El=null,l}function qE(l){if(l===Uc||l===Rg)throw Error(n(483))}var $c=null,zd=0;function Fg(l){var c=zd;return zd+=1,$c===null&&($c=[]),YE($c,l,c)}function Wd(l,c){c=c.props.ref,l.ref=c!==void 0?c:null}function Dg(l,c){throw c.$$typeof===m?Error(n(525)):(l=Object.prototype.toString.call(c),Error(n(31,l==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":l)))}function XE(l){function c(he,ce){if(l){var ge=he.deletions;ge===null?(he.deletions=[ce],he.flags|=16):ge.push(ce)}}function f(he,ce){if(!l)return null;for(;ce!==null;)c(he,ce),ce=ce.sibling;return null}function p(he){for(var ce=new Map;he!==null;)he.key!==null?ce.set(he.key,he):ce.set(he.index,he),he=he.sibling;return ce}function y(he,ce){return he=vo(he,ce),he.index=0,he.sibling=null,he}function S(he,ce,ge){return he.index=ge,l?(ge=he.alternate,ge!==null?(ge=ge.index,ge<ce?(he.flags|=67108866,ce):ge):(he.flags|=67108866,ce)):(he.flags|=1048576,ce)}function k(he){return l&&he.alternate===null&&(he.flags|=67108866),he}function z(he,ce,ge,Ae){return ce===null||ce.tag!==6?(ce=ew(ge,he.mode,Ae),ce.return=he,ce):(ce=y(ce,ge),ce.return=he,ce)}function oe(he,ce,ge,Ae){var ot=ge.type;return ot===C?Te(he,ce,ge.props.children,Ae,ge.key):ce!==null&&(ce.elementType===ot||typeof ot=="object"&&ot!==null&&ot.$$typeof===O&&xl(ot)===ce.type)?(ce=y(ce,ge.props),Wd(ce,ge),ce.return=he,ce):(ce=yg(ge.type,ge.key,ge.props,null,he.mode,Ae),Wd(ce,ge),ce.return=he,ce)}function pe(he,ce,ge,Ae){return ce===null||ce.tag!==4||ce.stateNode.containerInfo!==ge.containerInfo||ce.stateNode.implementation!==ge.implementation?(ce=tw(ge,he.mode,Ae),ce.return=he,ce):(ce=y(ce,ge.children||[]),ce.return=he,ce)}function Te(he,ce,ge,Ae,ot){return ce===null||ce.tag!==7?(ce=wl(ge,he.mode,Ae,ot),ce.return=he,ce):(ce=y(ce,ge),ce.return=he,ce)}function Pe(he,ce,ge){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return ce=ew(""+ce,he.mode,ge),ce.return=he,ce;if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case v:return ge=yg(ce.type,ce.key,ce.props,null,he.mode,ge),Wd(ge,ce),ge.return=he,ge;case w:return ce=tw(ce,he.mode,ge),ce.return=he,ce;case O:return ce=xl(ce),Pe(he,ce,ge)}if(J(ce)||G(ce))return ce=wl(ce,he.mode,ge,null),ce.return=he,ce;if(typeof ce.then=="function")return Pe(he,Fg(ce),ge);if(ce.$$typeof===E)return Pe(he,xg(he,ce),ge);Dg(he,ce)}return null}function ye(he,ce,ge,Ae){var ot=ce!==null?ce.key:null;if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return ot!==null?null:z(he,ce,""+ge,Ae);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case v:return ge.key===ot?oe(he,ce,ge,Ae):null;case w:return ge.key===ot?pe(he,ce,ge,Ae):null;case O:return ge=xl(ge),ye(he,ce,ge,Ae)}if(J(ge)||G(ge))return ot!==null?null:Te(he,ce,ge,Ae,null);if(typeof ge.then=="function")return ye(he,ce,Fg(ge),Ae);if(ge.$$typeof===E)return ye(he,ce,xg(he,ge),Ae);Dg(he,ge)}return null}function Se(he,ce,ge,Ae,ot){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint")return he=he.get(ge)||null,z(ce,he,""+Ae,ot);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case v:return he=he.get(Ae.key===null?ge:Ae.key)||null,oe(ce,he,Ae,ot);case w:return he=he.get(Ae.key===null?ge:Ae.key)||null,pe(ce,he,Ae,ot);case O:return Ae=xl(Ae),Se(he,ce,ge,Ae,ot)}if(J(Ae)||G(Ae))return he=he.get(ge)||null,Te(ce,he,Ae,ot,null);if(typeof Ae.then=="function")return Se(he,ce,ge,Fg(Ae),ot);if(Ae.$$typeof===E)return Se(he,ce,ge,xg(ce,Ae),ot);Dg(ce,Ae)}return null}function Qe(he,ce,ge,Ae){for(var ot=null,Gt=null,et=ce,St=ce=0,Lt=null;et!==null&&St<ge.length;St++){et.index>St?(Lt=et,et=null):Lt=et.sibling;var Vt=ye(he,et,ge[St],Ae);if(Vt===null){et===null&&(et=Lt);break}l&&et&&Vt.alternate===null&&c(he,et),ce=S(Vt,ce,St),Gt===null?ot=Vt:Gt.sibling=Vt,Gt=Vt,et=Lt}if(St===ge.length)return f(he,et),Ot&&wo(he,St),ot;if(et===null){for(;St<ge.length;St++)et=Pe(he,ge[St],Ae),et!==null&&(ce=S(et,ce,St),Gt===null?ot=et:Gt.sibling=et,Gt=et);return Ot&&wo(he,St),ot}for(et=p(et);St<ge.length;St++)Lt=Se(et,he,St,ge[St],Ae),Lt!==null&&(l&&Lt.alternate!==null&&et.delete(Lt.key===null?St:Lt.key),ce=S(Lt,ce,St),Gt===null?ot=Lt:Gt.sibling=Lt,Gt=Lt);return l&&et.forEach(function(Pa){return c(he,Pa)}),Ot&&wo(he,St),ot}function ut(he,ce,ge,Ae){if(ge==null)throw Error(n(151));for(var ot=null,Gt=null,et=ce,St=ce=0,Lt=null,Vt=ge.next();et!==null&&!Vt.done;St++,Vt=ge.next()){et.index>St?(Lt=et,et=null):Lt=et.sibling;var Pa=ye(he,et,Vt.value,Ae);if(Pa===null){et===null&&(et=Lt);break}l&&et&&Pa.alternate===null&&c(he,et),ce=S(Pa,ce,St),Gt===null?ot=Pa:Gt.sibling=Pa,Gt=Pa,et=Lt}if(Vt.done)return f(he,et),Ot&&wo(he,St),ot;if(et===null){for(;!Vt.done;St++,Vt=ge.next())Vt=Pe(he,Vt.value,Ae),Vt!==null&&(ce=S(Vt,ce,St),Gt===null?ot=Vt:Gt.sibling=Vt,Gt=Vt);return Ot&&wo(he,St),ot}for(et=p(et);!Vt.done;St++,Vt=ge.next())Vt=Se(et,he,St,Vt.value,Ae),Vt!==null&&(l&&Vt.alternate!==null&&et.delete(Vt.key===null?St:Vt.key),ce=S(Vt,ce,St),Gt===null?ot=Vt:Gt.sibling=Vt,Gt=Vt);return l&&et.forEach(function(fH){return c(he,fH)}),Ot&&wo(he,St),ot}function rr(he,ce,ge,Ae){if(typeof ge=="object"&&ge!==null&&ge.type===C&&ge.key===null&&(ge=ge.props.children),typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case v:e:{for(var ot=ge.key;ce!==null;){if(ce.key===ot){if(ot=ge.type,ot===C){if(ce.tag===7){f(he,ce.sibling),Ae=y(ce,ge.props.children),Ae.return=he,he=Ae;break e}}else if(ce.elementType===ot||typeof ot=="object"&&ot!==null&&ot.$$typeof===O&&xl(ot)===ce.type){f(he,ce.sibling),Ae=y(ce,ge.props),Wd(Ae,ge),Ae.return=he,he=Ae;break e}f(he,ce);break}else c(he,ce);ce=ce.sibling}ge.type===C?(Ae=wl(ge.props.children,he.mode,Ae,ge.key),Ae.return=he,he=Ae):(Ae=yg(ge.type,ge.key,ge.props,null,he.mode,Ae),Wd(Ae,ge),Ae.return=he,he=Ae)}return k(he);case w:e:{for(ot=ge.key;ce!==null;){if(ce.key===ot)if(ce.tag===4&&ce.stateNode.containerInfo===ge.containerInfo&&ce.stateNode.implementation===ge.implementation){f(he,ce.sibling),Ae=y(ce,ge.children||[]),Ae.return=he,he=Ae;break e}else{f(he,ce);break}else c(he,ce);ce=ce.sibling}Ae=tw(ge,he.mode,Ae),Ae.return=he,he=Ae}return k(he);case O:return ge=xl(ge),rr(he,ce,ge,Ae)}if(J(ge))return Qe(he,ce,ge,Ae);if(G(ge)){if(ot=G(ge),typeof ot!="function")throw Error(n(150));return ge=ot.call(ge),ut(he,ce,ge,Ae)}if(typeof ge.then=="function")return rr(he,ce,Fg(ge),Ae);if(ge.$$typeof===E)return rr(he,ce,xg(he,ge),Ae);Dg(he,ge)}return typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint"?(ge=""+ge,ce!==null&&ce.tag===6?(f(he,ce.sibling),Ae=y(ce,ge),Ae.return=he,he=Ae):(f(he,ce),Ae=ew(ge,he.mode,Ae),Ae.return=he,he=Ae),k(he)):f(he,ce)}return function(he,ce,ge,Ae){try{zd=0;var ot=rr(he,ce,ge,Ae);return $c=null,ot}catch(et){if(et===Uc||et===Rg)throw et;var Gt=fi(29,et,null,he.mode);return Gt.lanes=Ae,Gt.return=he,Gt}finally{}}}var Rl=XE(!0),QE=XE(!1),ga=!1;function fw(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function gw(l,c){l=l.updateQueue,c.updateQueue===l&&(c.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,callbacks:null})}function pa(l){return{lane:l,tag:0,payload:null,callback:null,next:null}}function ma(l,c,f){var p=l.updateQueue;if(p===null)return null;if(p=p.shared,(Ut&2)!==0){var y=p.pending;return y===null?c.next=c:(c.next=y.next,y.next=c),p.pending=c,c=Cg(l),LE(l,null,f),c}return wg(l,p,c,f),Cg(l)}function Ud(l,c,f){if(c=c.updateQueue,c!==null&&(c=c.shared,(f&4194048)!==0)){var p=c.lanes;p&=l.pendingLanes,f|=p,c.lanes=f,kt(l,f)}}function pw(l,c){var f=l.updateQueue,p=l.alternate;if(p!==null&&(p=p.updateQueue,f===p)){var y=null,S=null;if(f=f.firstBaseUpdate,f!==null){do{var k={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};S===null?y=S=k:S=S.next=k,f=f.next}while(f!==null);S===null?y=S=c:S=S.next=c}else y=S=c;f={baseState:p.baseState,firstBaseUpdate:y,lastBaseUpdate:S,shared:p.shared,callbacks:p.callbacks},l.updateQueue=f;return}l=f.lastBaseUpdate,l===null?f.firstBaseUpdate=c:l.next=c,f.lastBaseUpdate=c}var mw=!1;function $d(){if(mw){var l=Wc;if(l!==null)throw l}}function jd(l,c,f,p){mw=!1;var y=l.updateQueue;ga=!1;var S=y.firstBaseUpdate,k=y.lastBaseUpdate,z=y.shared.pending;if(z!==null){y.shared.pending=null;var oe=z,pe=oe.next;oe.next=null,k===null?S=pe:k.next=pe,k=oe;var Te=l.alternate;Te!==null&&(Te=Te.updateQueue,z=Te.lastBaseUpdate,z!==k&&(z===null?Te.firstBaseUpdate=pe:z.next=pe,Te.lastBaseUpdate=oe))}if(S!==null){var Pe=y.baseState;k=0,Te=pe=oe=null,z=S;do{var ye=z.lane&-536870913,Se=ye!==z.lane;if(Se?(_t&ye)===ye:(p&ye)===ye){ye!==0&&ye===zc&&(mw=!0),Te!==null&&(Te=Te.next={lane:0,tag:z.tag,payload:z.payload,callback:null,next:null});e:{var Qe=l,ut=z;ye=c;var rr=f;switch(ut.tag){case 1:if(Qe=ut.payload,typeof Qe=="function"){Pe=Qe.call(rr,Pe,ye);break e}Pe=Qe;break e;case 3:Qe.flags=Qe.flags&-65537|128;case 0:if(Qe=ut.payload,ye=typeof Qe=="function"?Qe.call(rr,Pe,ye):Qe,ye==null)break e;Pe=g({},Pe,ye);break e;case 2:ga=!0}}ye=z.callback,ye!==null&&(l.flags|=64,Se&&(l.flags|=8192),Se=y.callbacks,Se===null?y.callbacks=[ye]:Se.push(ye))}else Se={lane:ye,tag:z.tag,payload:z.payload,callback:z.callback,next:null},Te===null?(pe=Te=Se,oe=Pe):Te=Te.next=Se,k|=ye;if(z=z.next,z===null){if(z=y.shared.pending,z===null)break;Se=z,z=Se.next,Se.next=null,y.lastBaseUpdate=Se,y.shared.pending=null}}while(!0);Te===null&&(oe=Pe),y.baseState=oe,y.firstBaseUpdate=pe,y.lastBaseUpdate=Te,S===null&&(y.shared.lanes=0),ba|=k,l.lanes=k,l.memoizedState=Pe}}function ZE(l,c){if(typeof l!="function")throw Error(n(191,l));l.call(c)}function JE(l,c){var f=l.callbacks;if(f!==null)for(l.callbacks=null,l=0;l<f.length;l++)ZE(f[l],c)}var jc=N(null),Ag=N(0);function eR(l,c){l=Ao,V(Ag,l),V(jc,c),Ao=l|c.baseLanes}function vw(){V(Ag,Ao),V(jc,jc.current)}function ww(){Ao=Ag.current,P(jc),P(Ag)}var gi=N(null),zi=null;function va(l){var c=l.alternate;V(Nr,Nr.current&1),V(gi,l),zi===null&&(c===null||jc.current!==null||c.memoizedState!==null)&&(zi=l)}function Cw(l){V(Nr,Nr.current),V(gi,l),zi===null&&(zi=l)}function tR(l){l.tag===22?(V(Nr,Nr.current),V(gi,l),zi===null&&(zi=l)):wa()}function wa(){V(Nr,Nr.current),V(gi,gi.current)}function pi(l){P(gi),zi===l&&(zi=null),P(Nr)}var Nr=N(0);function kg(l){for(var c=l;c!==null;){if(c.tag===13){var f=c.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||RC(f)||TC(f)))return c}else if(c.tag===19&&(c.memoizedProps.revealOrder==="forwards"||c.memoizedProps.revealOrder==="backwards"||c.memoizedProps.revealOrder==="unstable_legacy-backwards"||c.memoizedProps.revealOrder==="together")){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var bo=0,yt=null,er=null,Kr=null,Pg=!1,Yc=!1,Tl=!1,Mg=0,Yd=0,Kc=null,n3=0;function kr(){throw Error(n(321))}function yw(l,c){if(c===null)return!1;for(var f=0;f<c.length&&f<l.length;f++)if(!hi(l[f],c[f]))return!1;return!0}function bw(l,c,f,p,y,S){return bo=S,yt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,_.H=l===null||l.memoizedState===null?BR:Ow,Tl=!1,S=f(p,y),Tl=!1,Yc&&(S=nR(c,f,p,y)),rR(l),S}function rR(l){_.H=Xd;var c=er!==null&&er.next!==null;if(bo=0,Kr=er=yt=null,Pg=!1,Yd=0,Kc=null,c)throw Error(n(300));l===null||qr||(l=l.dependencies,l!==null&&Sg(l)&&(qr=!0))}function nR(l,c,f,p){yt=l;var y=0;do{if(Yc&&(Kc=null),Yd=0,Yc=!1,25<=y)throw Error(n(301));if(y+=1,Kr=er=null,l.updateQueue!=null){var S=l.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}_.H=HR,S=c(f,p)}while(Yc);return S}function i3(){var l=_.H,c=l.useState()[0];return c=typeof c.then=="function"?Kd(c):c,l=l.useState()[0],(er!==null?er.memoizedState:null)!==l&&(yt.flags|=1024),c}function Sw(){var l=Mg!==0;return Mg=0,l}function xw(l,c,f){c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~f}function Ew(l){if(Pg){for(l=l.memoizedState;l!==null;){var c=l.queue;c!==null&&(c.pending=null),l=l.next}Pg=!1}bo=0,Kr=er=yt=null,Yc=!1,Yd=Mg=0,Kc=null}function Bn(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kr===null?yt.memoizedState=Kr=l:Kr=Kr.next=l,Kr}function Br(){if(er===null){var l=yt.alternate;l=l!==null?l.memoizedState:null}else l=er.next;var c=Kr===null?yt.memoizedState:Kr.next;if(c!==null)Kr=c,er=l;else{if(l===null)throw yt.alternate===null?Error(n(467)):Error(n(310));er=l,l={memoizedState:er.memoizedState,baseState:er.baseState,baseQueue:er.baseQueue,queue:er.queue,next:null},Kr===null?yt.memoizedState=Kr=l:Kr=Kr.next=l}return Kr}function _g(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Kd(l){var c=Yd;return Yd+=1,Kc===null&&(Kc=[]),l=YE(Kc,l,c),c=yt,(Kr===null?c.memoizedState:Kr.next)===null&&(c=c.alternate,_.H=c===null||c.memoizedState===null?BR:Ow),l}function Lg(l){if(l!==null&&typeof l=="object"){if(typeof l.then=="function")return Kd(l);if(l.$$typeof===E)return gn(l)}throw Error(n(438,String(l)))}function Rw(l){var c=null,f=yt.updateQueue;if(f!==null&&(c=f.memoCache),c==null){var p=yt.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(c={data:p.data.map(function(y){return y.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),f===null&&(f=_g(),yt.updateQueue=f),f.memoCache=c,f=c.data[c.index],f===void 0)for(f=c.data[c.index]=Array(l),p=0;p<l;p++)f[p]=W;return c.index++,f}function So(l,c){return typeof c=="function"?c(l):c}function Ig(l){var c=Br();return Tw(c,er,l)}function Tw(l,c,f){var p=l.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=f;var y=l.baseQueue,S=p.pending;if(S!==null){if(y!==null){var k=y.next;y.next=S.next,S.next=k}c.baseQueue=y=S,p.pending=null}if(S=l.baseState,y===null)l.memoizedState=S;else{c=y.next;var z=k=null,oe=null,pe=c,Te=!1;do{var Pe=pe.lane&-536870913;if(Pe!==pe.lane?(_t&Pe)===Pe:(bo&Pe)===Pe){var ye=pe.revertLane;if(ye===0)oe!==null&&(oe=oe.next={lane:0,revertLane:0,gesture:null,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),Pe===zc&&(Te=!0);else if((bo&ye)===ye){pe=pe.next,ye===zc&&(Te=!0);continue}else Pe={lane:0,revertLane:pe.revertLane,gesture:null,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},oe===null?(z=oe=Pe,k=S):oe=oe.next=Pe,yt.lanes|=ye,ba|=ye;Pe=pe.action,Tl&&f(S,Pe),S=pe.hasEagerState?pe.eagerState:f(S,Pe)}else ye={lane:Pe,revertLane:pe.revertLane,gesture:pe.gesture,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},oe===null?(z=oe=ye,k=S):oe=oe.next=ye,yt.lanes|=Pe,ba|=Pe;pe=pe.next}while(pe!==null&&pe!==c);if(oe===null?k=S:oe.next=z,!hi(S,l.memoizedState)&&(qr=!0,Te&&(f=Wc,f!==null)))throw f;l.memoizedState=S,l.baseState=k,l.baseQueue=oe,p.lastRenderedState=S}return y===null&&(p.lanes=0),[l.memoizedState,p.dispatch]}function Fw(l){var c=Br(),f=c.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=l;var p=f.dispatch,y=f.pending,S=c.memoizedState;if(y!==null){f.pending=null;var k=y=y.next;do S=l(S,k.action),k=k.next;while(k!==y);hi(S,c.memoizedState)||(qr=!0),c.memoizedState=S,c.baseQueue===null&&(c.baseState=S),f.lastRenderedState=S}return[S,p]}function iR(l,c,f){var p=yt,y=Br(),S=Ot;if(S){if(f===void 0)throw Error(n(407));f=f()}else f=c();var k=!hi((er||y).memoizedState,f);if(k&&(y.memoizedState=f,qr=!0),y=y.queue,kw(aR.bind(null,p,y,l),[l]),y.getSnapshot!==c||k||Kr!==null&&Kr.memoizedState.tag&1){if(p.flags|=2048,qc(9,{destroy:void 0},oR.bind(null,p,y,f,c),null),or===null)throw Error(n(349));S||(bo&127)!==0||sR(p,c,f)}return f}function sR(l,c,f){l.flags|=16384,l={getSnapshot:c,value:f},c=yt.updateQueue,c===null?(c=_g(),yt.updateQueue=c,c.stores=[l]):(f=c.stores,f===null?c.stores=[l]:f.push(l))}function oR(l,c,f,p){c.value=f,c.getSnapshot=p,lR(c)&&cR(l)}function aR(l,c,f){return f(function(){lR(c)&&cR(l)})}function lR(l){var c=l.getSnapshot;l=l.value;try{var f=c();return!hi(l,f)}catch{return!0}}function cR(l){var c=vl(l,2);c!==null&&ti(c,l,2)}function Dw(l){var c=Bn();if(typeof l=="function"){var f=l;if(l=f(),Tl){$r(!0);try{f()}finally{$r(!1)}}}return c.memoizedState=c.baseState=l,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:So,lastRenderedState:l},c}function uR(l,c,f,p){return l.baseState=f,Tw(l,er,typeof p=="function"?p:So)}function s3(l,c,f,p,y){if(Bg(l))throw Error(n(485));if(l=c.action,l!==null){var S={payload:y,action:l,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(k){S.listeners.push(k)}};_.T!==null?f(!0):S.isTransition=!1,p(S),f=c.pending,f===null?(S.next=c.pending=S,dR(c,S)):(S.next=f.next,c.pending=f.next=S)}}function dR(l,c){var f=c.action,p=c.payload,y=l.state;if(c.isTransition){var S=_.T,k={};_.T=k;try{var z=f(y,p),oe=_.S;oe!==null&&oe(k,z),hR(l,c,z)}catch(pe){Aw(l,c,pe)}finally{S!==null&&k.types!==null&&(S.types=k.types),_.T=S}}else try{S=f(y,p),hR(l,c,S)}catch(pe){Aw(l,c,pe)}}function hR(l,c,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(p){fR(l,c,p)},function(p){return Aw(l,c,p)}):fR(l,c,f)}function fR(l,c,f){c.status="fulfilled",c.value=f,gR(c),l.state=f,c=l.pending,c!==null&&(f=c.next,f===c?l.pending=null:(f=f.next,c.next=f,dR(l,f)))}function Aw(l,c,f){var p=l.pending;if(l.pending=null,p!==null){p=p.next;do c.status="rejected",c.reason=f,gR(c),c=c.next;while(c!==p)}l.action=null}function gR(l){l=l.listeners;for(var c=0;c<l.length;c++)(0,l[c])()}function pR(l,c){return c}function mR(l,c){if(Ot){var f=or.formState;if(f!==null){e:{var p=yt;if(Ot){if(fr){t:{for(var y=fr,S=Vi;y.nodeType!==8;){if(!S){y=null;break t}if(y=Wi(y.nextSibling),y===null){y=null;break t}}S=y.data,y=S==="F!"||S==="F"?y:null}if(y){fr=Wi(y.nextSibling),p=y.data==="F!";break e}}ha(p)}p=!1}p&&(c=f[0])}}return f=Bn(),f.memoizedState=f.baseState=c,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:pR,lastRenderedState:c},f.queue=p,f=IR.bind(null,yt,p),p.dispatch=f,p=Dw(!1),S=Iw.bind(null,yt,!1,p.queue),p=Bn(),y={state:c,dispatch:null,action:l,pending:null},p.queue=y,f=s3.bind(null,yt,y,S,f),y.dispatch=f,p.memoizedState=l,[c,f,!1]}function vR(l){var c=Br();return wR(c,er,l)}function wR(l,c,f){if(c=Tw(l,c,pR)[0],l=Ig(So)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var p=Kd(c)}catch(k){throw k===Uc?Rg:k}else p=c;c=Br();var y=c.queue,S=y.dispatch;return f!==c.memoizedState&&(yt.flags|=2048,qc(9,{destroy:void 0},o3.bind(null,y,f),null)),[p,S,l]}function o3(l,c){l.action=c}function CR(l){var c=Br(),f=er;if(f!==null)return wR(c,f,l);Br(),c=c.memoizedState,f=Br();var p=f.queue.dispatch;return f.memoizedState=l,[c,p,!1]}function qc(l,c,f,p){return l={tag:l,create:f,deps:p,inst:c,next:null},c=yt.updateQueue,c===null&&(c=_g(),yt.updateQueue=c),f=c.lastEffect,f===null?c.lastEffect=l.next=l:(p=f.next,f.next=l,l.next=p,c.lastEffect=l),l}function yR(){return Br().memoizedState}function Og(l,c,f,p){var y=Bn();yt.flags|=l,y.memoizedState=qc(1|c,{destroy:void 0},f,p===void 0?null:p)}function Ng(l,c,f,p){var y=Br();p=p===void 0?null:p;var S=y.memoizedState.inst;er!==null&&p!==null&&yw(p,er.memoizedState.deps)?y.memoizedState=qc(c,S,f,p):(yt.flags|=l,y.memoizedState=qc(1|c,S,f,p))}function bR(l,c){Og(8390656,8,l,c)}function kw(l,c){Ng(2048,8,l,c)}function a3(l){yt.flags|=4;var c=yt.updateQueue;if(c===null)c=_g(),yt.updateQueue=c,c.events=[l];else{var f=c.events;f===null?c.events=[l]:f.push(l)}}function SR(l){var c=Br().memoizedState;return a3({ref:c,nextImpl:l}),function(){if((Ut&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}function xR(l,c){return Ng(4,2,l,c)}function ER(l,c){return Ng(4,4,l,c)}function RR(l,c){if(typeof c=="function"){l=l();var f=c(l);return function(){typeof f=="function"?f():c(null)}}if(c!=null)return l=l(),c.current=l,function(){c.current=null}}function TR(l,c,f){f=f!=null?f.concat([l]):null,Ng(4,4,RR.bind(null,c,l),f)}function Pw(){}function FR(l,c){var f=Br();c=c===void 0?null:c;var p=f.memoizedState;return c!==null&&yw(c,p[1])?p[0]:(f.memoizedState=[l,c],l)}function DR(l,c){var f=Br();c=c===void 0?null:c;var p=f.memoizedState;if(c!==null&&yw(c,p[1]))return p[0];if(p=l(),Tl){$r(!0);try{l()}finally{$r(!1)}}return f.memoizedState=[p,c],p}function Mw(l,c,f){return f===void 0||(bo&1073741824)!==0&&(_t&261930)===0?l.memoizedState=c:(l.memoizedState=f,l=A2(),yt.lanes|=l,ba|=l,f)}function AR(l,c,f,p){return hi(f,c)?f:jc.current!==null?(l=Mw(l,f,p),hi(l,c)||(qr=!0),l):(bo&42)===0||(bo&1073741824)!==0&&(_t&261930)===0?(qr=!0,l.memoizedState=f):(l=A2(),yt.lanes|=l,ba|=l,c)}function kR(l,c,f,p,y){var S=Y.p;Y.p=S!==0&&8>S?S:8;var k=_.T,z={};_.T=z,Iw(l,!1,c,f);try{var oe=y(),pe=_.S;if(pe!==null&&pe(z,oe),oe!==null&&typeof oe=="object"&&typeof oe.then=="function"){var Te=r3(oe,p);qd(l,c,Te,wi(l))}else qd(l,c,p,wi(l))}catch(Pe){qd(l,c,{then:function(){},status:"rejected",reason:Pe},wi())}finally{Y.p=S,k!==null&&z.types!==null&&(k.types=z.types),_.T=k}}function l3(){}function _w(l,c,f,p){if(l.tag!==5)throw Error(n(476));var y=PR(l).queue;kR(l,y,c,Q,f===null?l3:function(){return MR(l),f(p)})}function PR(l){var c=l.memoizedState;if(c!==null)return c;c={memoizedState:Q,baseState:Q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:So,lastRenderedState:Q},next:null};var f={};return c.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:So,lastRenderedState:f},next:null},l.memoizedState=c,l=l.alternate,l!==null&&(l.memoizedState=c),c}function MR(l){var c=PR(l);c.next===null&&(c=l.alternate.memoizedState),qd(l,c.next.queue,{},wi())}function Lw(){return gn(hh)}function _R(){return Br().memoizedState}function LR(){return Br().memoizedState}function c3(l){for(var c=l.return;c!==null;){switch(c.tag){case 24:case 3:var f=wi();l=pa(f);var p=ma(c,l,f);p!==null&&(ti(p,c,f),Ud(p,c,f)),c={cache:cw()},l.payload=c;return}c=c.return}}function u3(l,c,f){var p=wi();f={lane:p,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Bg(l)?OR(c,f):(f=Zv(l,c,f,p),f!==null&&(ti(f,l,p),NR(f,c,p)))}function IR(l,c,f){var p=wi();qd(l,c,f,p)}function qd(l,c,f,p){var y={lane:p,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Bg(l))OR(c,y);else{var S=l.alternate;if(l.lanes===0&&(S===null||S.lanes===0)&&(S=c.lastRenderedReducer,S!==null))try{var k=c.lastRenderedState,z=S(k,f);if(y.hasEagerState=!0,y.eagerState=z,hi(z,k))return wg(l,c,y,0),or===null&&vg(),!1}catch{}finally{}if(f=Zv(l,c,y,p),f!==null)return ti(f,l,p),NR(f,c,p),!0}return!1}function Iw(l,c,f,p){if(p={lane:2,revertLane:fC(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Bg(l)){if(c)throw Error(n(479))}else c=Zv(l,f,p,2),c!==null&&ti(c,l,2)}function Bg(l){var c=l.alternate;return l===yt||c!==null&&c===yt}function OR(l,c){Yc=Pg=!0;var f=l.pending;f===null?c.next=c:(c.next=f.next,f.next=c),l.pending=c}function NR(l,c,f){if((f&4194048)!==0){var p=c.lanes;p&=l.pendingLanes,f|=p,c.lanes=f,kt(l,f)}}var Xd={readContext:gn,use:Lg,useCallback:kr,useContext:kr,useEffect:kr,useImperativeHandle:kr,useLayoutEffect:kr,useInsertionEffect:kr,useMemo:kr,useReducer:kr,useRef:kr,useState:kr,useDebugValue:kr,useDeferredValue:kr,useTransition:kr,useSyncExternalStore:kr,useId:kr,useHostTransitionStatus:kr,useFormState:kr,useActionState:kr,useOptimistic:kr,useMemoCache:kr,useCacheRefresh:kr};Xd.useEffectEvent=kr;var BR={readContext:gn,use:Lg,useCallback:function(l,c){return Bn().memoizedState=[l,c===void 0?null:c],l},useContext:gn,useEffect:bR,useImperativeHandle:function(l,c,f){f=f!=null?f.concat([l]):null,Og(4194308,4,RR.bind(null,c,l),f)},useLayoutEffect:function(l,c){return Og(4194308,4,l,c)},useInsertionEffect:function(l,c){Og(4,2,l,c)},useMemo:function(l,c){var f=Bn();c=c===void 0?null:c;var p=l();if(Tl){$r(!0);try{l()}finally{$r(!1)}}return f.memoizedState=[p,c],p},useReducer:function(l,c,f){var p=Bn();if(f!==void 0){var y=f(c);if(Tl){$r(!0);try{f(c)}finally{$r(!1)}}}else y=c;return p.memoizedState=p.baseState=y,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:y},p.queue=l,l=l.dispatch=u3.bind(null,yt,l),[p.memoizedState,l]},useRef:function(l){var c=Bn();return l={current:l},c.memoizedState=l},useState:function(l){l=Dw(l);var c=l.queue,f=IR.bind(null,yt,c);return c.dispatch=f,[l.memoizedState,f]},useDebugValue:Pw,useDeferredValue:function(l,c){var f=Bn();return Mw(f,l,c)},useTransition:function(){var l=Dw(!1);return l=kR.bind(null,yt,l.queue,!0,!1),Bn().memoizedState=l,[!1,l]},useSyncExternalStore:function(l,c,f){var p=yt,y=Bn();if(Ot){if(f===void 0)throw Error(n(407));f=f()}else{if(f=c(),or===null)throw Error(n(349));(_t&127)!==0||sR(p,c,f)}y.memoizedState=f;var S={value:f,getSnapshot:c};return y.queue=S,bR(aR.bind(null,p,S,l),[l]),p.flags|=2048,qc(9,{destroy:void 0},oR.bind(null,p,S,f,c),null),f},useId:function(){var l=Bn(),c=or.identifierPrefix;if(Ot){var f=Is,p=Ls;f=(p&~(1<<32-Cr(p)-1)).toString(32)+f,c="_"+c+"R_"+f,f=Mg++,0<f&&(c+="H"+f.toString(32)),c+="_"}else f=n3++,c="_"+c+"r_"+f.toString(32)+"_";return l.memoizedState=c},useHostTransitionStatus:Lw,useFormState:mR,useActionState:mR,useOptimistic:function(l){var c=Bn();c.memoizedState=c.baseState=l;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=f,c=Iw.bind(null,yt,!0,f),f.dispatch=c,[l,c]},useMemoCache:Rw,useCacheRefresh:function(){return Bn().memoizedState=c3.bind(null,yt)},useEffectEvent:function(l){var c=Bn(),f={impl:l};return c.memoizedState=f,function(){if((Ut&2)!==0)throw Error(n(440));return f.impl.apply(void 0,arguments)}}},Ow={readContext:gn,use:Lg,useCallback:FR,useContext:gn,useEffect:kw,useImperativeHandle:TR,useInsertionEffect:xR,useLayoutEffect:ER,useMemo:DR,useReducer:Ig,useRef:yR,useState:function(){return Ig(So)},useDebugValue:Pw,useDeferredValue:function(l,c){var f=Br();return AR(f,er.memoizedState,l,c)},useTransition:function(){var l=Ig(So)[0],c=Br().memoizedState;return[typeof l=="boolean"?l:Kd(l),c]},useSyncExternalStore:iR,useId:_R,useHostTransitionStatus:Lw,useFormState:vR,useActionState:vR,useOptimistic:function(l,c){var f=Br();return uR(f,er,l,c)},useMemoCache:Rw,useCacheRefresh:LR};Ow.useEffectEvent=SR;var HR={readContext:gn,use:Lg,useCallback:FR,useContext:gn,useEffect:kw,useImperativeHandle:TR,useInsertionEffect:xR,useLayoutEffect:ER,useMemo:DR,useReducer:Fw,useRef:yR,useState:function(){return Fw(So)},useDebugValue:Pw,useDeferredValue:function(l,c){var f=Br();return er===null?Mw(f,l,c):AR(f,er.memoizedState,l,c)},useTransition:function(){var l=Fw(So)[0],c=Br().memoizedState;return[typeof l=="boolean"?l:Kd(l),c]},useSyncExternalStore:iR,useId:_R,useHostTransitionStatus:Lw,useFormState:CR,useActionState:CR,useOptimistic:function(l,c){var f=Br();return er!==null?uR(f,er,l,c):(f.baseState=l,[l,f.queue.dispatch])},useMemoCache:Rw,useCacheRefresh:LR};HR.useEffectEvent=SR;function Nw(l,c,f,p){c=l.memoizedState,f=f(p,c),f=f==null?c:g({},c,f),l.memoizedState=f,l.lanes===0&&(l.updateQueue.baseState=f)}var Bw={enqueueSetState:function(l,c,f){l=l._reactInternals;var p=wi(),y=pa(p);y.payload=c,f!=null&&(y.callback=f),c=ma(l,y,p),c!==null&&(ti(c,l,p),Ud(c,l,p))},enqueueReplaceState:function(l,c,f){l=l._reactInternals;var p=wi(),y=pa(p);y.tag=1,y.payload=c,f!=null&&(y.callback=f),c=ma(l,y,p),c!==null&&(ti(c,l,p),Ud(c,l,p))},enqueueForceUpdate:function(l,c){l=l._reactInternals;var f=wi(),p=pa(f);p.tag=2,c!=null&&(p.callback=c),c=ma(l,p,f),c!==null&&(ti(c,l,f),Ud(c,l,f))}};function GR(l,c,f,p,y,S,k){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(p,S,k):c.prototype&&c.prototype.isPureReactComponent?!Od(f,p)||!Od(y,S):!0}function VR(l,c,f,p){l=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(f,p),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(f,p),c.state!==l&&Bw.enqueueReplaceState(c,c.state,null)}function Fl(l,c){var f=c;if("ref"in c){f={};for(var p in c)p!=="ref"&&(f[p]=c[p])}if(l=l.defaultProps){f===c&&(f=g({},f));for(var y in l)f[y]===void 0&&(f[y]=l[y])}return f}function zR(l){mg(l)}function WR(l){console.error(l)}function UR(l){mg(l)}function Hg(l,c){try{var f=l.onUncaughtError;f(c.value,{componentStack:c.stack})}catch(p){setTimeout(function(){throw p})}}function $R(l,c,f){try{var p=l.onCaughtError;p(f.value,{componentStack:f.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Hw(l,c,f){return f=pa(f),f.tag=3,f.payload={element:null},f.callback=function(){Hg(l,c)},f}function jR(l){return l=pa(l),l.tag=3,l}function YR(l,c,f,p){var y=f.type.getDerivedStateFromError;if(typeof y=="function"){var S=p.value;l.payload=function(){return y(S)},l.callback=function(){$R(c,f,p)}}var k=f.stateNode;k!==null&&typeof k.componentDidCatch=="function"&&(l.callback=function(){$R(c,f,p),typeof y!="function"&&(Sa===null?Sa=new Set([this]):Sa.add(this));var z=p.stack;this.componentDidCatch(p.value,{componentStack:z!==null?z:""})})}function d3(l,c,f,p,y){if(f.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(c=f.alternate,c!==null&&Vc(c,f,y,!0),f=gi.current,f!==null){switch(f.tag){case 31:case 13:return zi===null?Qg():f.alternate===null&&Pr===0&&(Pr=3),f.flags&=-257,f.flags|=65536,f.lanes=y,p===Tg?f.flags|=16384:(c=f.updateQueue,c===null?f.updateQueue=new Set([p]):c.add(p),uC(l,p,y)),!1;case 22:return f.flags|=65536,p===Tg?f.flags|=16384:(c=f.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([p])},f.updateQueue=c):(f=c.retryQueue,f===null?c.retryQueue=new Set([p]):f.add(p)),uC(l,p,y)),!1}throw Error(n(435,f.tag))}return uC(l,p,y),Qg(),!1}if(Ot)return c=gi.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=y,p!==iw&&(l=Error(n(422),{cause:p}),Hd(Bi(l,f)))):(p!==iw&&(c=Error(n(423),{cause:p}),Hd(Bi(c,f))),l=l.current.alternate,l.flags|=65536,y&=-y,l.lanes|=y,p=Bi(p,f),y=Hw(l.stateNode,p,y),pw(l,y),Pr!==4&&(Pr=2)),!1;var S=Error(n(520),{cause:p});if(S=Bi(S,f),ih===null?ih=[S]:ih.push(S),Pr!==4&&(Pr=2),c===null)return!0;p=Bi(p,f),f=c;do{switch(f.tag){case 3:return f.flags|=65536,l=y&-y,f.lanes|=l,l=Hw(f.stateNode,p,l),pw(f,l),!1;case 1:if(c=f.type,S=f.stateNode,(f.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Sa===null||!Sa.has(S))))return f.flags|=65536,y&=-y,f.lanes|=y,y=jR(y),YR(y,l,f,p),pw(f,y),!1}f=f.return}while(f!==null);return!1}var Gw=Error(n(461)),qr=!1;function pn(l,c,f,p){c.child=l===null?QE(c,null,f,p):Rl(c,l.child,f,p)}function KR(l,c,f,p,y){f=f.render;var S=c.ref;if("ref"in p){var k={};for(var z in p)z!=="ref"&&(k[z]=p[z])}else k=p;return bl(c),p=bw(l,c,f,k,S,y),z=Sw(),l!==null&&!qr?(xw(l,c,y),xo(l,c,y)):(Ot&&z&&rw(c),c.flags|=1,pn(l,c,p,y),c.child)}function qR(l,c,f,p,y){if(l===null){var S=f.type;return typeof S=="function"&&!Jv(S)&&S.defaultProps===void 0&&f.compare===null?(c.tag=15,c.type=S,XR(l,c,S,p,y)):(l=yg(f.type,null,p,c,c.mode,y),l.ref=c.ref,l.return=c,c.child=l)}if(S=l.child,!Kw(l,y)){var k=S.memoizedProps;if(f=f.compare,f=f!==null?f:Od,f(k,p)&&l.ref===c.ref)return xo(l,c,y)}return c.flags|=1,l=vo(S,p),l.ref=c.ref,l.return=c,c.child=l}function XR(l,c,f,p,y){if(l!==null){var S=l.memoizedProps;if(Od(S,p)&&l.ref===c.ref)if(qr=!1,c.pendingProps=p=S,Kw(l,y))(l.flags&131072)!==0&&(qr=!0);else return c.lanes=l.lanes,xo(l,c,y)}return Vw(l,c,f,p,y)}function QR(l,c,f,p){var y=p.children,S=l!==null?l.memoizedState:null;if(l===null&&c.stateNode===null&&(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((c.flags&128)!==0){if(S=S!==null?S.baseLanes|f:f,l!==null){for(p=c.child=l.child,y=0;p!==null;)y=y|p.lanes|p.childLanes,p=p.sibling;p=y&~S}else p=0,c.child=null;return ZR(l,c,S,f,p)}if((f&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},l!==null&&Eg(c,S!==null?S.cachePool:null),S!==null?eR(c,S):vw(),tR(c);else return p=c.lanes=536870912,ZR(l,c,S!==null?S.baseLanes|f:f,f,p)}else S!==null?(Eg(c,S.cachePool),eR(c,S),wa(),c.memoizedState=null):(l!==null&&Eg(c,null),vw(),wa());return pn(l,c,y,f),c.child}function Qd(l,c){return l!==null&&l.tag===22||c.stateNode!==null||(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.sibling}function ZR(l,c,f,p,y){var S=dw();return S=S===null?null:{parent:Yr._currentValue,pool:S},c.memoizedState={baseLanes:f,cachePool:S},l!==null&&Eg(c,null),vw(),tR(c),l!==null&&Vc(l,c,p,!0),c.childLanes=y,null}function Gg(l,c){return c=zg({mode:c.mode,children:c.children},l.mode),c.ref=l.ref,l.child=c,c.return=l,c}function JR(l,c,f){return Rl(c,l.child,null,f),l=Gg(c,c.pendingProps),l.flags|=2,pi(c),c.memoizedState=null,l}function h3(l,c,f){var p=c.pendingProps,y=(c.flags&128)!==0;if(c.flags&=-129,l===null){if(Ot){if(p.mode==="hidden")return l=Gg(c,p),c.lanes=536870912,Qd(null,l);if(Cw(c),(l=fr)?(l=dT(l,Vi),l=l!==null&&l.data==="&"?l:null,l!==null&&(c.memoizedState={dehydrated:l,treeContext:ua!==null?{id:Ls,overflow:Is}:null,retryLane:536870912,hydrationErrors:null},f=OE(l),f.return=c,c.child=f,fn=c,fr=null)):l=null,l===null)throw ha(c);return c.lanes=536870912,null}return Gg(c,p)}var S=l.memoizedState;if(S!==null){var k=S.dehydrated;if(Cw(c),y)if(c.flags&256)c.flags&=-257,c=JR(l,c,f);else if(c.memoizedState!==null)c.child=l.child,c.flags|=128,c=null;else throw Error(n(558));else if(qr||Vc(l,c,f,!1),y=(f&l.childLanes)!==0,qr||y){if(p=or,p!==null&&(k=jr(p,f),k!==0&&k!==S.retryLane))throw S.retryLane=k,vl(l,k),ti(p,l,k),Gw;Qg(),c=JR(l,c,f)}else l=S.treeContext,fr=Wi(k.nextSibling),fn=c,Ot=!0,da=null,Vi=!1,l!==null&&HE(c,l),c=Gg(c,p),c.flags|=4096;return c}return l=vo(l.child,{mode:p.mode,children:p.children}),l.ref=c.ref,c.child=l,l.return=c,l}function Vg(l,c){var f=c.ref;if(f===null)l!==null&&l.ref!==null&&(c.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(n(284));(l===null||l.ref!==f)&&(c.flags|=4194816)}}function Vw(l,c,f,p,y){return bl(c),f=bw(l,c,f,p,void 0,y),p=Sw(),l!==null&&!qr?(xw(l,c,y),xo(l,c,y)):(Ot&&p&&rw(c),c.flags|=1,pn(l,c,f,y),c.child)}function e2(l,c,f,p,y,S){return bl(c),c.updateQueue=null,f=nR(c,p,f,y),rR(l),p=Sw(),l!==null&&!qr?(xw(l,c,S),xo(l,c,S)):(Ot&&p&&rw(c),c.flags|=1,pn(l,c,f,S),c.child)}function t2(l,c,f,p,y){if(bl(c),c.stateNode===null){var S=Nc,k=f.contextType;typeof k=="object"&&k!==null&&(S=gn(k)),S=new f(p,S),c.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=Bw,c.stateNode=S,S._reactInternals=c,S=c.stateNode,S.props=p,S.state=c.memoizedState,S.refs={},fw(c),k=f.contextType,S.context=typeof k=="object"&&k!==null?gn(k):Nc,S.state=c.memoizedState,k=f.getDerivedStateFromProps,typeof k=="function"&&(Nw(c,f,k,p),S.state=c.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(k=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),k!==S.state&&Bw.enqueueReplaceState(S,S.state,null),jd(c,p,S,y),$d(),S.state=c.memoizedState),typeof S.componentDidMount=="function"&&(c.flags|=4194308),p=!0}else if(l===null){S=c.stateNode;var z=c.memoizedProps,oe=Fl(f,z);S.props=oe;var pe=S.context,Te=f.contextType;k=Nc,typeof Te=="object"&&Te!==null&&(k=gn(Te));var Pe=f.getDerivedStateFromProps;Te=typeof Pe=="function"||typeof S.getSnapshotBeforeUpdate=="function",z=c.pendingProps!==z,Te||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(z||pe!==k)&&VR(c,S,p,k),ga=!1;var ye=c.memoizedState;S.state=ye,jd(c,p,S,y),$d(),pe=c.memoizedState,z||ye!==pe||ga?(typeof Pe=="function"&&(Nw(c,f,Pe,p),pe=c.memoizedState),(oe=ga||GR(c,f,oe,p,ye,pe,k))?(Te||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(c.flags|=4194308)):(typeof S.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=p,c.memoizedState=pe),S.props=p,S.state=pe,S.context=k,p=oe):(typeof S.componentDidMount=="function"&&(c.flags|=4194308),p=!1)}else{S=c.stateNode,gw(l,c),k=c.memoizedProps,Te=Fl(f,k),S.props=Te,Pe=c.pendingProps,ye=S.context,pe=f.contextType,oe=Nc,typeof pe=="object"&&pe!==null&&(oe=gn(pe)),z=f.getDerivedStateFromProps,(pe=typeof z=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(k!==Pe||ye!==oe)&&VR(c,S,p,oe),ga=!1,ye=c.memoizedState,S.state=ye,jd(c,p,S,y),$d();var Se=c.memoizedState;k!==Pe||ye!==Se||ga||l!==null&&l.dependencies!==null&&Sg(l.dependencies)?(typeof z=="function"&&(Nw(c,f,z,p),Se=c.memoizedState),(Te=ga||GR(c,f,Te,p,ye,Se,oe)||l!==null&&l.dependencies!==null&&Sg(l.dependencies))?(pe||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(p,Se,oe),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(p,Se,oe)),typeof S.componentDidUpdate=="function"&&(c.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof S.componentDidUpdate!="function"||k===l.memoizedProps&&ye===l.memoizedState||(c.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||k===l.memoizedProps&&ye===l.memoizedState||(c.flags|=1024),c.memoizedProps=p,c.memoizedState=Se),S.props=p,S.state=Se,S.context=oe,p=Te):(typeof S.componentDidUpdate!="function"||k===l.memoizedProps&&ye===l.memoizedState||(c.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||k===l.memoizedProps&&ye===l.memoizedState||(c.flags|=1024),p=!1)}return S=p,Vg(l,c),p=(c.flags&128)!==0,S||p?(S=c.stateNode,f=p&&typeof f.getDerivedStateFromError!="function"?null:S.render(),c.flags|=1,l!==null&&p?(c.child=Rl(c,l.child,null,y),c.child=Rl(c,null,f,y)):pn(l,c,f,y),c.memoizedState=S.state,l=c.child):l=xo(l,c,y),l}function r2(l,c,f,p){return Cl(),c.flags|=256,pn(l,c,f,p),c.child}var zw={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ww(l){return{baseLanes:l,cachePool:$E()}}function Uw(l,c,f){return l=l!==null?l.childLanes&~f:0,c&&(l|=vi),l}function n2(l,c,f){var p=c.pendingProps,y=!1,S=(c.flags&128)!==0,k;if((k=S)||(k=l!==null&&l.memoizedState===null?!1:(Nr.current&2)!==0),k&&(y=!0,c.flags&=-129),k=(c.flags&32)!==0,c.flags&=-33,l===null){if(Ot){if(y?va(c):wa(),(l=fr)?(l=dT(l,Vi),l=l!==null&&l.data!=="&"?l:null,l!==null&&(c.memoizedState={dehydrated:l,treeContext:ua!==null?{id:Ls,overflow:Is}:null,retryLane:536870912,hydrationErrors:null},f=OE(l),f.return=c,c.child=f,fn=c,fr=null)):l=null,l===null)throw ha(c);return TC(l)?c.lanes=32:c.lanes=536870912,null}var z=p.children;return p=p.fallback,y?(wa(),y=c.mode,z=zg({mode:"hidden",children:z},y),p=wl(p,y,f,null),z.return=c,p.return=c,z.sibling=p,c.child=z,p=c.child,p.memoizedState=Ww(f),p.childLanes=Uw(l,k,f),c.memoizedState=zw,Qd(null,p)):(va(c),$w(c,z))}var oe=l.memoizedState;if(oe!==null&&(z=oe.dehydrated,z!==null)){if(S)c.flags&256?(va(c),c.flags&=-257,c=jw(l,c,f)):c.memoizedState!==null?(wa(),c.child=l.child,c.flags|=128,c=null):(wa(),z=p.fallback,y=c.mode,p=zg({mode:"visible",children:p.children},y),z=wl(z,y,f,null),z.flags|=2,p.return=c,z.return=c,p.sibling=z,c.child=p,Rl(c,l.child,null,f),p=c.child,p.memoizedState=Ww(f),p.childLanes=Uw(l,k,f),c.memoizedState=zw,c=Qd(null,p));else if(va(c),TC(z)){if(k=z.nextSibling&&z.nextSibling.dataset,k)var pe=k.dgst;k=pe,p=Error(n(419)),p.stack="",p.digest=k,Hd({value:p,source:null,stack:null}),c=jw(l,c,f)}else if(qr||Vc(l,c,f,!1),k=(f&l.childLanes)!==0,qr||k){if(k=or,k!==null&&(p=jr(k,f),p!==0&&p!==oe.retryLane))throw oe.retryLane=p,vl(l,p),ti(k,l,p),Gw;RC(z)||Qg(),c=jw(l,c,f)}else RC(z)?(c.flags|=192,c.child=l.child,c=null):(l=oe.treeContext,fr=Wi(z.nextSibling),fn=c,Ot=!0,da=null,Vi=!1,l!==null&&HE(c,l),c=$w(c,p.children),c.flags|=4096);return c}return y?(wa(),z=p.fallback,y=c.mode,oe=l.child,pe=oe.sibling,p=vo(oe,{mode:"hidden",children:p.children}),p.subtreeFlags=oe.subtreeFlags&65011712,pe!==null?z=vo(pe,z):(z=wl(z,y,f,null),z.flags|=2),z.return=c,p.return=c,p.sibling=z,c.child=p,Qd(null,p),p=c.child,z=l.child.memoizedState,z===null?z=Ww(f):(y=z.cachePool,y!==null?(oe=Yr._currentValue,y=y.parent!==oe?{parent:oe,pool:oe}:y):y=$E(),z={baseLanes:z.baseLanes|f,cachePool:y}),p.memoizedState=z,p.childLanes=Uw(l,k,f),c.memoizedState=zw,Qd(l.child,p)):(va(c),f=l.child,l=f.sibling,f=vo(f,{mode:"visible",children:p.children}),f.return=c,f.sibling=null,l!==null&&(k=c.deletions,k===null?(c.deletions=[l],c.flags|=16):k.push(l)),c.child=f,c.memoizedState=null,f)}function $w(l,c){return c=zg({mode:"visible",children:c},l.mode),c.return=l,l.child=c}function zg(l,c){return l=fi(22,l,null,c),l.lanes=0,l}function jw(l,c,f){return Rl(c,l.child,null,f),l=$w(c,c.pendingProps.children),l.flags|=2,c.memoizedState=null,l}function i2(l,c,f){l.lanes|=c;var p=l.alternate;p!==null&&(p.lanes|=c),aw(l.return,c,f)}function Yw(l,c,f,p,y,S){var k=l.memoizedState;k===null?l.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:p,tail:f,tailMode:y,treeForkCount:S}:(k.isBackwards=c,k.rendering=null,k.renderingStartTime=0,k.last=p,k.tail=f,k.tailMode=y,k.treeForkCount=S)}function s2(l,c,f){var p=c.pendingProps,y=p.revealOrder,S=p.tail;p=p.children;var k=Nr.current,z=(k&2)!==0;if(z?(k=k&1|2,c.flags|=128):k&=1,V(Nr,k),pn(l,c,p,f),p=Ot?Bd:0,!z&&l!==null&&(l.flags&128)!==0)e:for(l=c.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&i2(l,f,c);else if(l.tag===19)i2(l,f,c);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===c)break e;for(;l.sibling===null;){if(l.return===null||l.return===c)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}switch(y){case"forwards":for(f=c.child,y=null;f!==null;)l=f.alternate,l!==null&&kg(l)===null&&(y=f),f=f.sibling;f=y,f===null?(y=c.child,c.child=null):(y=f.sibling,f.sibling=null),Yw(c,!1,y,f,S,p);break;case"backwards":case"unstable_legacy-backwards":for(f=null,y=c.child,c.child=null;y!==null;){if(l=y.alternate,l!==null&&kg(l)===null){c.child=y;break}l=y.sibling,y.sibling=f,f=y,y=l}Yw(c,!0,f,null,S,p);break;case"together":Yw(c,!1,null,null,void 0,p);break;default:c.memoizedState=null}return c.child}function xo(l,c,f){if(l!==null&&(c.dependencies=l.dependencies),ba|=c.lanes,(f&c.childLanes)===0)if(l!==null){if(Vc(l,c,f,!1),(f&c.childLanes)===0)return null}else return null;if(l!==null&&c.child!==l.child)throw Error(n(153));if(c.child!==null){for(l=c.child,f=vo(l,l.pendingProps),c.child=f,f.return=c;l.sibling!==null;)l=l.sibling,f=f.sibling=vo(l,l.pendingProps),f.return=c;f.sibling=null}return c.child}function Kw(l,c){return(l.lanes&c)!==0?!0:(l=l.dependencies,!!(l!==null&&Sg(l)))}function f3(l,c,f){switch(c.tag){case 3:le(c,c.stateNode.containerInfo),fa(c,Yr,l.memoizedState.cache),Cl();break;case 27:case 5:ue(c);break;case 4:le(c,c.stateNode.containerInfo);break;case 10:fa(c,c.type,c.memoizedProps.value);break;case 31:if(c.memoizedState!==null)return c.flags|=128,Cw(c),null;break;case 13:var p=c.memoizedState;if(p!==null)return p.dehydrated!==null?(va(c),c.flags|=128,null):(f&c.child.childLanes)!==0?n2(l,c,f):(va(c),l=xo(l,c,f),l!==null?l.sibling:null);va(c);break;case 19:var y=(l.flags&128)!==0;if(p=(f&c.childLanes)!==0,p||(Vc(l,c,f,!1),p=(f&c.childLanes)!==0),y){if(p)return s2(l,c,f);c.flags|=128}if(y=c.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),V(Nr,Nr.current),p)break;return null;case 22:return c.lanes=0,QR(l,c,f,c.pendingProps);case 24:fa(c,Yr,l.memoizedState.cache)}return xo(l,c,f)}function o2(l,c,f){if(l!==null)if(l.memoizedProps!==c.pendingProps)qr=!0;else{if(!Kw(l,f)&&(c.flags&128)===0)return qr=!1,f3(l,c,f);qr=(l.flags&131072)!==0}else qr=!1,Ot&&(c.flags&1048576)!==0&&BE(c,Bd,c.index);switch(c.lanes=0,c.tag){case 16:e:{var p=c.pendingProps;if(l=xl(c.elementType),c.type=l,typeof l=="function")Jv(l)?(p=Fl(l,p),c.tag=1,c=t2(null,c,l,p,f)):(c.tag=0,c=Vw(null,c,l,p,f));else{if(l!=null){var y=l.$$typeof;if(y===A){c.tag=11,c=KR(null,c,l,p,f);break e}else if(y===F){c.tag=14,c=qR(null,c,l,p,f);break e}}throw c=ie(l)||l,Error(n(306,c,""))}}return c;case 0:return Vw(l,c,c.type,c.pendingProps,f);case 1:return p=c.type,y=Fl(p,c.pendingProps),t2(l,c,p,y,f);case 3:e:{if(le(c,c.stateNode.containerInfo),l===null)throw Error(n(387));p=c.pendingProps;var S=c.memoizedState;y=S.element,gw(l,c),jd(c,p,null,f);var k=c.memoizedState;if(p=k.cache,fa(c,Yr,p),p!==S.cache&&lw(c,[Yr],f,!0),$d(),p=k.element,S.isDehydrated)if(S={element:p,isDehydrated:!1,cache:k.cache},c.updateQueue.baseState=S,c.memoizedState=S,c.flags&256){c=r2(l,c,p,f);break e}else if(p!==y){y=Bi(Error(n(424)),c),Hd(y),c=r2(l,c,p,f);break e}else{switch(l=c.stateNode.containerInfo,l.nodeType){case 9:l=l.body;break;default:l=l.nodeName==="HTML"?l.ownerDocument.body:l}for(fr=Wi(l.firstChild),fn=c,Ot=!0,da=null,Vi=!0,f=QE(c,null,p,f),c.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(Cl(),p===y){c=xo(l,c,f);break e}pn(l,c,p,f)}c=c.child}return c;case 26:return Vg(l,c),l===null?(f=vT(c.type,null,c.pendingProps,null))?c.memoizedState=f:Ot||(f=c.type,l=c.pendingProps,p=ip(ae.current).createElement(f),p[X]=c,p[ee]=l,mn(p,f,l),Je(p),c.stateNode=p):c.memoizedState=vT(c.type,l.memoizedProps,c.pendingProps,l.memoizedState),null;case 27:return ue(c),l===null&&Ot&&(p=c.stateNode=gT(c.type,c.pendingProps,ae.current),fn=c,Vi=!0,y=fr,Ta(c.type)?(FC=y,fr=Wi(p.firstChild)):fr=y),pn(l,c,c.pendingProps.children,f),Vg(l,c),l===null&&(c.flags|=4194304),c.child;case 5:return l===null&&Ot&&((y=p=fr)&&(p=W3(p,c.type,c.pendingProps,Vi),p!==null?(c.stateNode=p,fn=c,fr=Wi(p.firstChild),Vi=!1,y=!0):y=!1),y||ha(c)),ue(c),y=c.type,S=c.pendingProps,k=l!==null?l.memoizedProps:null,p=S.children,SC(y,S)?p=null:k!==null&&SC(y,k)&&(c.flags|=32),c.memoizedState!==null&&(y=bw(l,c,i3,null,null,f),hh._currentValue=y),Vg(l,c),pn(l,c,p,f),c.child;case 6:return l===null&&Ot&&((l=f=fr)&&(f=U3(f,c.pendingProps,Vi),f!==null?(c.stateNode=f,fn=c,fr=null,l=!0):l=!1),l||ha(c)),null;case 13:return n2(l,c,f);case 4:return le(c,c.stateNode.containerInfo),p=c.pendingProps,l===null?c.child=Rl(c,null,p,f):pn(l,c,p,f),c.child;case 11:return KR(l,c,c.type,c.pendingProps,f);case 7:return pn(l,c,c.pendingProps,f),c.child;case 8:return pn(l,c,c.pendingProps.children,f),c.child;case 12:return pn(l,c,c.pendingProps.children,f),c.child;case 10:return p=c.pendingProps,fa(c,c.type,p.value),pn(l,c,p.children,f),c.child;case 9:return y=c.type._context,p=c.pendingProps.children,bl(c),y=gn(y),p=p(y),c.flags|=1,pn(l,c,p,f),c.child;case 14:return qR(l,c,c.type,c.pendingProps,f);case 15:return XR(l,c,c.type,c.pendingProps,f);case 19:return s2(l,c,f);case 31:return h3(l,c,f);case 22:return QR(l,c,f,c.pendingProps);case 24:return bl(c),p=gn(Yr),l===null?(y=dw(),y===null&&(y=or,S=cw(),y.pooledCache=S,S.refCount++,S!==null&&(y.pooledCacheLanes|=f),y=S),c.memoizedState={parent:p,cache:y},fw(c),fa(c,Yr,y)):((l.lanes&f)!==0&&(gw(l,c),jd(c,null,null,f),$d()),y=l.memoizedState,S=c.memoizedState,y.parent!==p?(y={parent:p,cache:p},c.memoizedState=y,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=y),fa(c,Yr,p)):(p=S.cache,fa(c,Yr,p),p!==y.cache&&lw(c,[Yr],f,!0))),pn(l,c,c.pendingProps.children,f),c.child;case 29:throw c.pendingProps}throw Error(n(156,c.tag))}function Eo(l){l.flags|=4}function qw(l,c,f,p,y){if((c=(l.mode&32)!==0)&&(c=!1),c){if(l.flags|=16777216,(y&335544128)===y)if(l.stateNode.complete)l.flags|=8192;else if(_2())l.flags|=8192;else throw El=Tg,hw}else l.flags&=-16777217}function a2(l,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)l.flags&=-16777217;else if(l.flags|=16777216,!ST(c))if(_2())l.flags|=8192;else throw El=Tg,hw}function Wg(l,c){c!==null&&(l.flags|=4),l.flags&16384&&(c=l.tag!==22?oa():536870912,l.lanes|=c,Jc|=c)}function Zd(l,c){if(!Ot)switch(l.tailMode){case"hidden":c=l.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?l.tail=null:f.sibling=null;break;case"collapsed":f=l.tail;for(var p=null;f!==null;)f.alternate!==null&&(p=f),f=f.sibling;p===null?c||l.tail===null?l.tail=null:l.tail.sibling=null:p.sibling=null}}function gr(l){var c=l.alternate!==null&&l.alternate.child===l.child,f=0,p=0;if(c)for(var y=l.child;y!==null;)f|=y.lanes|y.childLanes,p|=y.subtreeFlags&65011712,p|=y.flags&65011712,y.return=l,y=y.sibling;else for(y=l.child;y!==null;)f|=y.lanes|y.childLanes,p|=y.subtreeFlags,p|=y.flags,y.return=l,y=y.sibling;return l.subtreeFlags|=p,l.childLanes=f,c}function g3(l,c,f){var p=c.pendingProps;switch(nw(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gr(c),null;case 1:return gr(c),null;case 3:return f=c.stateNode,p=null,l!==null&&(p=l.memoizedState.cache),c.memoizedState.cache!==p&&(c.flags|=2048),yo(Yr),de(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(l===null||l.child===null)&&(Gc(c)?Eo(c):l===null||l.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,sw())),gr(c),null;case 26:var y=c.type,S=c.memoizedState;return l===null?(Eo(c),S!==null?(gr(c),a2(c,S)):(gr(c),qw(c,y,null,p,f))):S?S!==l.memoizedState?(Eo(c),gr(c),a2(c,S)):(gr(c),c.flags&=-16777217):(l=l.memoizedProps,l!==p&&Eo(c),gr(c),qw(c,y,l,p,f)),null;case 27:if(Ie(c),f=ae.current,y=c.type,l!==null&&c.stateNode!=null)l.memoizedProps!==p&&Eo(c);else{if(!p){if(c.stateNode===null)throw Error(n(166));return gr(c),null}l=H.current,Gc(c)?GE(c):(l=gT(y,p,f),c.stateNode=l,Eo(c))}return gr(c),null;case 5:if(Ie(c),y=c.type,l!==null&&c.stateNode!=null)l.memoizedProps!==p&&Eo(c);else{if(!p){if(c.stateNode===null)throw Error(n(166));return gr(c),null}if(S=H.current,Gc(c))GE(c);else{var k=ip(ae.current);switch(S){case 1:S=k.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:S=k.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":S=k.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":S=k.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":S=k.createElement("div"),S.innerHTML="<script><\/script>",S=S.removeChild(S.firstChild);break;case"select":S=typeof p.is=="string"?k.createElement("select",{is:p.is}):k.createElement("select"),p.multiple?S.multiple=!0:p.size&&(S.size=p.size);break;default:S=typeof p.is=="string"?k.createElement(y,{is:p.is}):k.createElement(y)}}S[X]=c,S[ee]=p;e:for(k=c.child;k!==null;){if(k.tag===5||k.tag===6)S.appendChild(k.stateNode);else if(k.tag!==4&&k.tag!==27&&k.child!==null){k.child.return=k,k=k.child;continue}if(k===c)break e;for(;k.sibling===null;){if(k.return===null||k.return===c)break e;k=k.return}k.sibling.return=k.return,k=k.sibling}c.stateNode=S;e:switch(mn(S,y,p),y){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&Eo(c)}}return gr(c),qw(c,c.type,l===null?null:l.memoizedProps,c.pendingProps,f),null;case 6:if(l&&c.stateNode!=null)l.memoizedProps!==p&&Eo(c);else{if(typeof p!="string"&&c.stateNode===null)throw Error(n(166));if(l=ae.current,Gc(c)){if(l=c.stateNode,f=c.memoizedProps,p=null,y=fn,y!==null)switch(y.tag){case 27:case 5:p=y.memoizedProps}l[X]=c,l=!!(l.nodeValue===f||p!==null&&p.suppressHydrationWarning===!0||nT(l.nodeValue,f)),l||ha(c,!0)}else l=ip(l).createTextNode(p),l[X]=c,c.stateNode=l}return gr(c),null;case 31:if(f=c.memoizedState,l===null||l.memoizedState!==null){if(p=Gc(c),f!==null){if(l===null){if(!p)throw Error(n(318));if(l=c.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(557));l[X]=c}else Cl(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;gr(c),l=!1}else f=sw(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=f),l=!0;if(!l)return c.flags&256?(pi(c),c):(pi(c),null);if((c.flags&128)!==0)throw Error(n(558))}return gr(c),null;case 13:if(p=c.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(y=Gc(c),p!==null&&p.dehydrated!==null){if(l===null){if(!y)throw Error(n(318));if(y=c.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(n(317));y[X]=c}else Cl(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;gr(c),y=!1}else y=sw(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=y),y=!0;if(!y)return c.flags&256?(pi(c),c):(pi(c),null)}return pi(c),(c.flags&128)!==0?(c.lanes=f,c):(f=p!==null,l=l!==null&&l.memoizedState!==null,f&&(p=c.child,y=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(y=p.alternate.memoizedState.cachePool.pool),S=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(S=p.memoizedState.cachePool.pool),S!==y&&(p.flags|=2048)),f!==l&&f&&(c.child.flags|=8192),Wg(c,c.updateQueue),gr(c),null);case 4:return de(),l===null&&vC(c.stateNode.containerInfo),gr(c),null;case 10:return yo(c.type),gr(c),null;case 19:if(P(Nr),p=c.memoizedState,p===null)return gr(c),null;if(y=(c.flags&128)!==0,S=p.rendering,S===null)if(y)Zd(p,!1);else{if(Pr!==0||l!==null&&(l.flags&128)!==0)for(l=c.child;l!==null;){if(S=kg(l),S!==null){for(c.flags|=128,Zd(p,!1),l=S.updateQueue,c.updateQueue=l,Wg(c,l),c.subtreeFlags=0,l=f,f=c.child;f!==null;)IE(f,l),f=f.sibling;return V(Nr,Nr.current&1|2),Ot&&wo(c,p.treeForkCount),c.child}l=l.sibling}p.tail!==null&&qe()>Kg&&(c.flags|=128,y=!0,Zd(p,!1),c.lanes=4194304)}else{if(!y)if(l=kg(S),l!==null){if(c.flags|=128,y=!0,l=l.updateQueue,c.updateQueue=l,Wg(c,l),Zd(p,!0),p.tail===null&&p.tailMode==="hidden"&&!S.alternate&&!Ot)return gr(c),null}else 2*qe()-p.renderingStartTime>Kg&&f!==536870912&&(c.flags|=128,y=!0,Zd(p,!1),c.lanes=4194304);p.isBackwards?(S.sibling=c.child,c.child=S):(l=p.last,l!==null?l.sibling=S:c.child=S,p.last=S)}return p.tail!==null?(l=p.tail,p.rendering=l,p.tail=l.sibling,p.renderingStartTime=qe(),l.sibling=null,f=Nr.current,V(Nr,y?f&1|2:f&1),Ot&&wo(c,p.treeForkCount),l):(gr(c),null);case 22:case 23:return pi(c),ww(),p=c.memoizedState!==null,l!==null?l.memoizedState!==null!==p&&(c.flags|=8192):p&&(c.flags|=8192),p?(f&536870912)!==0&&(c.flags&128)===0&&(gr(c),c.subtreeFlags&6&&(c.flags|=8192)):gr(c),f=c.updateQueue,f!==null&&Wg(c,f.retryQueue),f=null,l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),p=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==f&&(c.flags|=2048),l!==null&&P(Sl),null;case 24:return f=null,l!==null&&(f=l.memoizedState.cache),c.memoizedState.cache!==f&&(c.flags|=2048),yo(Yr),gr(c),null;case 25:return null;case 30:return null}throw Error(n(156,c.tag))}function p3(l,c){switch(nw(c),c.tag){case 1:return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 3:return yo(Yr),de(),l=c.flags,(l&65536)!==0&&(l&128)===0?(c.flags=l&-65537|128,c):null;case 26:case 27:case 5:return Ie(c),null;case 31:if(c.memoizedState!==null){if(pi(c),c.alternate===null)throw Error(n(340));Cl()}return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 13:if(pi(c),l=c.memoizedState,l!==null&&l.dehydrated!==null){if(c.alternate===null)throw Error(n(340));Cl()}return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 19:return P(Nr),null;case 4:return de(),null;case 10:return yo(c.type),null;case 22:case 23:return pi(c),ww(),l!==null&&P(Sl),l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 24:return yo(Yr),null;case 25:return null;default:return null}}function l2(l,c){switch(nw(c),c.tag){case 3:yo(Yr),de();break;case 26:case 27:case 5:Ie(c);break;case 4:de();break;case 31:c.memoizedState!==null&&pi(c);break;case 13:pi(c);break;case 19:P(Nr);break;case 10:yo(c.type);break;case 22:case 23:pi(c),ww(),l!==null&&P(Sl);break;case 24:yo(Yr)}}function Jd(l,c){try{var f=c.updateQueue,p=f!==null?f.lastEffect:null;if(p!==null){var y=p.next;f=y;do{if((f.tag&l)===l){p=void 0;var S=f.create,k=f.inst;p=S(),k.destroy=p}f=f.next}while(f!==y)}}catch(z){qt(c,c.return,z)}}function Ca(l,c,f){try{var p=c.updateQueue,y=p!==null?p.lastEffect:null;if(y!==null){var S=y.next;p=S;do{if((p.tag&l)===l){var k=p.inst,z=k.destroy;if(z!==void 0){k.destroy=void 0,y=c;var oe=f,pe=z;try{pe()}catch(Te){qt(y,oe,Te)}}}p=p.next}while(p!==S)}}catch(Te){qt(c,c.return,Te)}}function c2(l){var c=l.updateQueue;if(c!==null){var f=l.stateNode;try{JE(c,f)}catch(p){qt(l,l.return,p)}}}function u2(l,c,f){f.props=Fl(l.type,l.memoizedProps),f.state=l.memoizedState;try{f.componentWillUnmount()}catch(p){qt(l,c,p)}}function eh(l,c){try{var f=l.ref;if(f!==null){switch(l.tag){case 26:case 27:case 5:var p=l.stateNode;break;case 30:p=l.stateNode;break;default:p=l.stateNode}typeof f=="function"?l.refCleanup=f(p):f.current=p}}catch(y){qt(l,c,y)}}function Os(l,c){var f=l.ref,p=l.refCleanup;if(f!==null)if(typeof p=="function")try{p()}catch(y){qt(l,c,y)}finally{l.refCleanup=null,l=l.alternate,l!=null&&(l.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(y){qt(l,c,y)}else f.current=null}function d2(l){var c=l.type,f=l.memoizedProps,p=l.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":f.autoFocus&&p.focus();break e;case"img":f.src?p.src=f.src:f.srcSet&&(p.srcset=f.srcSet)}}catch(y){qt(l,l.return,y)}}function Xw(l,c,f){try{var p=l.stateNode;N3(p,l.type,f,c),p[ee]=c}catch(y){qt(l,l.return,y)}}function h2(l){return l.tag===5||l.tag===3||l.tag===26||l.tag===27&&Ta(l.type)||l.tag===4}function Qw(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||h2(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.tag===27&&Ta(l.type)||l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function Zw(l,c,f){var p=l.tag;if(p===5||p===6)l=l.stateNode,c?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(l,c):(c=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,c.appendChild(l),f=f._reactRootContainer,f!=null||c.onclick!==null||(c.onclick=po));else if(p!==4&&(p===27&&Ta(l.type)&&(f=l.stateNode,c=null),l=l.child,l!==null))for(Zw(l,c,f),l=l.sibling;l!==null;)Zw(l,c,f),l=l.sibling}function Ug(l,c,f){var p=l.tag;if(p===5||p===6)l=l.stateNode,c?f.insertBefore(l,c):f.appendChild(l);else if(p!==4&&(p===27&&Ta(l.type)&&(f=l.stateNode),l=l.child,l!==null))for(Ug(l,c,f),l=l.sibling;l!==null;)Ug(l,c,f),l=l.sibling}function f2(l){var c=l.stateNode,f=l.memoizedProps;try{for(var p=l.type,y=c.attributes;y.length;)c.removeAttributeNode(y[0]);mn(c,p,f),c[X]=l,c[ee]=f}catch(S){qt(l,l.return,S)}}var Ro=!1,Xr=!1,Jw=!1,g2=typeof WeakSet=="function"?WeakSet:Set,sn=null;function m3(l,c){if(l=l.containerInfo,yC=dp,l=TE(l),jv(l)){if("selectionStart"in l)var f={start:l.selectionStart,end:l.selectionEnd};else e:{f=(f=l.ownerDocument)&&f.defaultView||window;var p=f.getSelection&&f.getSelection();if(p&&p.rangeCount!==0){f=p.anchorNode;var y=p.anchorOffset,S=p.focusNode;p=p.focusOffset;try{f.nodeType,S.nodeType}catch{f=null;break e}var k=0,z=-1,oe=-1,pe=0,Te=0,Pe=l,ye=null;t:for(;;){for(var Se;Pe!==f||y!==0&&Pe.nodeType!==3||(z=k+y),Pe!==S||p!==0&&Pe.nodeType!==3||(oe=k+p),Pe.nodeType===3&&(k+=Pe.nodeValue.length),(Se=Pe.firstChild)!==null;)ye=Pe,Pe=Se;for(;;){if(Pe===l)break t;if(ye===f&&++pe===y&&(z=k),ye===S&&++Te===p&&(oe=k),(Se=Pe.nextSibling)!==null)break;Pe=ye,ye=Pe.parentNode}Pe=Se}f=z===-1||oe===-1?null:{start:z,end:oe}}else f=null}f=f||{start:0,end:0}}else f=null;for(bC={focusedElem:l,selectionRange:f},dp=!1,sn=c;sn!==null;)if(c=sn,l=c.child,(c.subtreeFlags&1028)!==0&&l!==null)l.return=c,sn=l;else for(;sn!==null;){switch(c=sn,S=c.alternate,l=c.flags,c.tag){case 0:if((l&4)!==0&&(l=c.updateQueue,l=l!==null?l.events:null,l!==null))for(f=0;f<l.length;f++)y=l[f],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((l&1024)!==0&&S!==null){l=void 0,f=c,y=S.memoizedProps,S=S.memoizedState,p=f.stateNode;try{var Qe=Fl(f.type,y);l=p.getSnapshotBeforeUpdate(Qe,S),p.__reactInternalSnapshotBeforeUpdate=l}catch(ut){qt(f,f.return,ut)}}break;case 3:if((l&1024)!==0){if(l=c.stateNode.containerInfo,f=l.nodeType,f===9)EC(l);else if(f===1)switch(l.nodeName){case"HEAD":case"HTML":case"BODY":EC(l);break;default:l.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((l&1024)!==0)throw Error(n(163))}if(l=c.sibling,l!==null){l.return=c.return,sn=l;break}sn=c.return}}function p2(l,c,f){var p=f.flags;switch(f.tag){case 0:case 11:case 15:Fo(l,f),p&4&&Jd(5,f);break;case 1:if(Fo(l,f),p&4)if(l=f.stateNode,c===null)try{l.componentDidMount()}catch(k){qt(f,f.return,k)}else{var y=Fl(f.type,c.memoizedProps);c=c.memoizedState;try{l.componentDidUpdate(y,c,l.__reactInternalSnapshotBeforeUpdate)}catch(k){qt(f,f.return,k)}}p&64&&c2(f),p&512&&eh(f,f.return);break;case 3:if(Fo(l,f),p&64&&(l=f.updateQueue,l!==null)){if(c=null,f.child!==null)switch(f.child.tag){case 27:case 5:c=f.child.stateNode;break;case 1:c=f.child.stateNode}try{JE(l,c)}catch(k){qt(f,f.return,k)}}break;case 27:c===null&&p&4&&f2(f);case 26:case 5:Fo(l,f),c===null&&p&4&&d2(f),p&512&&eh(f,f.return);break;case 12:Fo(l,f);break;case 31:Fo(l,f),p&4&&w2(l,f);break;case 13:Fo(l,f),p&4&&C2(l,f),p&64&&(l=f.memoizedState,l!==null&&(l=l.dehydrated,l!==null&&(f=R3.bind(null,f),$3(l,f))));break;case 22:if(p=f.memoizedState!==null||Ro,!p){c=c!==null&&c.memoizedState!==null||Xr,y=Ro;var S=Xr;Ro=p,(Xr=c)&&!S?Do(l,f,(f.subtreeFlags&8772)!==0):Fo(l,f),Ro=y,Xr=S}break;case 30:break;default:Fo(l,f)}}function m2(l){var c=l.alternate;c!==null&&(l.alternate=null,m2(c)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(c=l.stateNode,c!==null&&Ne(c)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}var br=null,Qn=!1;function To(l,c,f){for(f=f.child;f!==null;)v2(l,c,f),f=f.sibling}function v2(l,c,f){if(lr&&typeof lr.onCommitFiberUnmount=="function")try{lr.onCommitFiberUnmount(It,f)}catch{}switch(f.tag){case 26:Xr||Os(f,c),To(l,c,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:Xr||Os(f,c);var p=br,y=Qn;Ta(f.type)&&(br=f.stateNode,Qn=!1),To(l,c,f),ch(f.stateNode),br=p,Qn=y;break;case 5:Xr||Os(f,c);case 6:if(p=br,y=Qn,br=null,To(l,c,f),br=p,Qn=y,br!==null)if(Qn)try{(br.nodeType===9?br.body:br.nodeName==="HTML"?br.ownerDocument.body:br).removeChild(f.stateNode)}catch(S){qt(f,c,S)}else try{br.removeChild(f.stateNode)}catch(S){qt(f,c,S)}break;case 18:br!==null&&(Qn?(l=br,cT(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,f.stateNode),au(l)):cT(br,f.stateNode));break;case 4:p=br,y=Qn,br=f.stateNode.containerInfo,Qn=!0,To(l,c,f),br=p,Qn=y;break;case 0:case 11:case 14:case 15:Ca(2,f,c),Xr||Ca(4,f,c),To(l,c,f);break;case 1:Xr||(Os(f,c),p=f.stateNode,typeof p.componentWillUnmount=="function"&&u2(f,c,p)),To(l,c,f);break;case 21:To(l,c,f);break;case 22:Xr=(p=Xr)||f.memoizedState!==null,To(l,c,f),Xr=p;break;default:To(l,c,f)}}function w2(l,c){if(c.memoizedState===null&&(l=c.alternate,l!==null&&(l=l.memoizedState,l!==null))){l=l.dehydrated;try{au(l)}catch(f){qt(c,c.return,f)}}}function C2(l,c){if(c.memoizedState===null&&(l=c.alternate,l!==null&&(l=l.memoizedState,l!==null&&(l=l.dehydrated,l!==null))))try{au(l)}catch(f){qt(c,c.return,f)}}function v3(l){switch(l.tag){case 31:case 13:case 19:var c=l.stateNode;return c===null&&(c=l.stateNode=new g2),c;case 22:return l=l.stateNode,c=l._retryCache,c===null&&(c=l._retryCache=new g2),c;default:throw Error(n(435,l.tag))}}function $g(l,c){var f=v3(l);c.forEach(function(p){if(!f.has(p)){f.add(p);var y=T3.bind(null,l,p);p.then(y,y)}})}function Zn(l,c){var f=c.deletions;if(f!==null)for(var p=0;p<f.length;p++){var y=f[p],S=l,k=c,z=k;e:for(;z!==null;){switch(z.tag){case 27:if(Ta(z.type)){br=z.stateNode,Qn=!1;break e}break;case 5:br=z.stateNode,Qn=!1;break e;case 3:case 4:br=z.stateNode.containerInfo,Qn=!0;break e}z=z.return}if(br===null)throw Error(n(160));v2(S,k,y),br=null,Qn=!1,S=y.alternate,S!==null&&(S.return=null),y.return=null}if(c.subtreeFlags&13886)for(c=c.child;c!==null;)y2(c,l),c=c.sibling}var gs=null;function y2(l,c){var f=l.alternate,p=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:Zn(c,l),Jn(l),p&4&&(Ca(3,l,l.return),Jd(3,l),Ca(5,l,l.return));break;case 1:Zn(c,l),Jn(l),p&512&&(Xr||f===null||Os(f,f.return)),p&64&&Ro&&(l=l.updateQueue,l!==null&&(p=l.callbacks,p!==null&&(f=l.shared.hiddenCallbacks,l.shared.hiddenCallbacks=f===null?p:f.concat(p))));break;case 26:var y=gs;if(Zn(c,l),Jn(l),p&512&&(Xr||f===null||Os(f,f.return)),p&4){var S=f!==null?f.memoizedState:null;if(p=l.memoizedState,f===null)if(p===null)if(l.stateNode===null){e:{p=l.type,f=l.memoizedProps,y=y.ownerDocument||y;t:switch(p){case"title":S=y.getElementsByTagName("title")[0],(!S||S[be]||S[X]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=y.createElement(p),y.head.insertBefore(S,y.querySelector("head > title"))),mn(S,p,f),S[X]=l,Je(S),p=S;break e;case"link":var k=yT("link","href",y).get(p+(f.href||""));if(k){for(var z=0;z<k.length;z++)if(S=k[z],S.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&S.getAttribute("rel")===(f.rel==null?null:f.rel)&&S.getAttribute("title")===(f.title==null?null:f.title)&&S.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){k.splice(z,1);break t}}S=y.createElement(p),mn(S,p,f),y.head.appendChild(S);break;case"meta":if(k=yT("meta","content",y).get(p+(f.content||""))){for(z=0;z<k.length;z++)if(S=k[z],S.getAttribute("content")===(f.content==null?null:""+f.content)&&S.getAttribute("name")===(f.name==null?null:f.name)&&S.getAttribute("property")===(f.property==null?null:f.property)&&S.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&S.getAttribute("charset")===(f.charSet==null?null:f.charSet)){k.splice(z,1);break t}}S=y.createElement(p),mn(S,p,f),y.head.appendChild(S);break;default:throw Error(n(468,p))}S[X]=l,Je(S),p=S}l.stateNode=p}else bT(y,l.type,l.stateNode);else l.stateNode=CT(y,p,l.memoizedProps);else S!==p?(S===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):S.count--,p===null?bT(y,l.type,l.stateNode):CT(y,p,l.memoizedProps)):p===null&&l.stateNode!==null&&Xw(l,l.memoizedProps,f.memoizedProps)}break;case 27:Zn(c,l),Jn(l),p&512&&(Xr||f===null||Os(f,f.return)),f!==null&&p&4&&Xw(l,l.memoizedProps,f.memoizedProps);break;case 5:if(Zn(c,l),Jn(l),p&512&&(Xr||f===null||Os(f,f.return)),l.flags&32){y=l.stateNode;try{kc(y,"")}catch(Qe){qt(l,l.return,Qe)}}p&4&&l.stateNode!=null&&(y=l.memoizedProps,Xw(l,y,f!==null?f.memoizedProps:y)),p&1024&&(Jw=!0);break;case 6:if(Zn(c,l),Jn(l),p&4){if(l.stateNode===null)throw Error(n(162));p=l.memoizedProps,f=l.stateNode;try{f.nodeValue=p}catch(Qe){qt(l,l.return,Qe)}}break;case 3:if(ap=null,y=gs,gs=sp(c.containerInfo),Zn(c,l),gs=y,Jn(l),p&4&&f!==null&&f.memoizedState.isDehydrated)try{au(c.containerInfo)}catch(Qe){qt(l,l.return,Qe)}Jw&&(Jw=!1,b2(l));break;case 4:p=gs,gs=sp(l.stateNode.containerInfo),Zn(c,l),Jn(l),gs=p;break;case 12:Zn(c,l),Jn(l);break;case 31:Zn(c,l),Jn(l),p&4&&(p=l.updateQueue,p!==null&&(l.updateQueue=null,$g(l,p)));break;case 13:Zn(c,l),Jn(l),l.child.flags&8192&&l.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Yg=qe()),p&4&&(p=l.updateQueue,p!==null&&(l.updateQueue=null,$g(l,p)));break;case 22:y=l.memoizedState!==null;var oe=f!==null&&f.memoizedState!==null,pe=Ro,Te=Xr;if(Ro=pe||y,Xr=Te||oe,Zn(c,l),Xr=Te,Ro=pe,Jn(l),p&8192)e:for(c=l.stateNode,c._visibility=y?c._visibility&-2:c._visibility|1,y&&(f===null||oe||Ro||Xr||Dl(l)),f=null,c=l;;){if(c.tag===5||c.tag===26){if(f===null){oe=f=c;try{if(S=oe.stateNode,y)k=S.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none";else{z=oe.stateNode;var Pe=oe.memoizedProps.style,ye=Pe!=null&&Pe.hasOwnProperty("display")?Pe.display:null;z.style.display=ye==null||typeof ye=="boolean"?"":(""+ye).trim()}}catch(Qe){qt(oe,oe.return,Qe)}}}else if(c.tag===6){if(f===null){oe=c;try{oe.stateNode.nodeValue=y?"":oe.memoizedProps}catch(Qe){qt(oe,oe.return,Qe)}}}else if(c.tag===18){if(f===null){oe=c;try{var Se=oe.stateNode;y?uT(Se,!0):uT(oe.stateNode,!1)}catch(Qe){qt(oe,oe.return,Qe)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===l)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break e;for(;c.sibling===null;){if(c.return===null||c.return===l)break e;f===c&&(f=null),c=c.return}f===c&&(f=null),c.sibling.return=c.return,c=c.sibling}p&4&&(p=l.updateQueue,p!==null&&(f=p.retryQueue,f!==null&&(p.retryQueue=null,$g(l,f))));break;case 19:Zn(c,l),Jn(l),p&4&&(p=l.updateQueue,p!==null&&(l.updateQueue=null,$g(l,p)));break;case 30:break;case 21:break;default:Zn(c,l),Jn(l)}}function Jn(l){var c=l.flags;if(c&2){try{for(var f,p=l.return;p!==null;){if(h2(p)){f=p;break}p=p.return}if(f==null)throw Error(n(160));switch(f.tag){case 27:var y=f.stateNode,S=Qw(l);Ug(l,S,y);break;case 5:var k=f.stateNode;f.flags&32&&(kc(k,""),f.flags&=-33);var z=Qw(l);Ug(l,z,k);break;case 3:case 4:var oe=f.stateNode.containerInfo,pe=Qw(l);Zw(l,pe,oe);break;default:throw Error(n(161))}}catch(Te){qt(l,l.return,Te)}l.flags&=-3}c&4096&&(l.flags&=-4097)}function b2(l){if(l.subtreeFlags&1024)for(l=l.child;l!==null;){var c=l;b2(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),l=l.sibling}}function Fo(l,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)p2(l,c.alternate,c),c=c.sibling}function Dl(l){for(l=l.child;l!==null;){var c=l;switch(c.tag){case 0:case 11:case 14:case 15:Ca(4,c,c.return),Dl(c);break;case 1:Os(c,c.return);var f=c.stateNode;typeof f.componentWillUnmount=="function"&&u2(c,c.return,f),Dl(c);break;case 27:ch(c.stateNode);case 26:case 5:Os(c,c.return),Dl(c);break;case 22:c.memoizedState===null&&Dl(c);break;case 30:Dl(c);break;default:Dl(c)}l=l.sibling}}function Do(l,c,f){for(f=f&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var p=c.alternate,y=l,S=c,k=S.flags;switch(S.tag){case 0:case 11:case 15:Do(y,S,f),Jd(4,S);break;case 1:if(Do(y,S,f),p=S,y=p.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(pe){qt(p,p.return,pe)}if(p=S,y=p.updateQueue,y!==null){var z=p.stateNode;try{var oe=y.shared.hiddenCallbacks;if(oe!==null)for(y.shared.hiddenCallbacks=null,y=0;y<oe.length;y++)ZE(oe[y],z)}catch(pe){qt(p,p.return,pe)}}f&&k&64&&c2(S),eh(S,S.return);break;case 27:f2(S);case 26:case 5:Do(y,S,f),f&&p===null&&k&4&&d2(S),eh(S,S.return);break;case 12:Do(y,S,f);break;case 31:Do(y,S,f),f&&k&4&&w2(y,S);break;case 13:Do(y,S,f),f&&k&4&&C2(y,S);break;case 22:S.memoizedState===null&&Do(y,S,f),eh(S,S.return);break;case 30:break;default:Do(y,S,f)}c=c.sibling}}function eC(l,c){var f=null;l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),l=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(l=c.memoizedState.cachePool.pool),l!==f&&(l!=null&&l.refCount++,f!=null&&Gd(f))}function tC(l,c){l=null,c.alternate!==null&&(l=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==l&&(c.refCount++,l!=null&&Gd(l))}function ps(l,c,f,p){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)S2(l,c,f,p),c=c.sibling}function S2(l,c,f,p){var y=c.flags;switch(c.tag){case 0:case 11:case 15:ps(l,c,f,p),y&2048&&Jd(9,c);break;case 1:ps(l,c,f,p);break;case 3:ps(l,c,f,p),y&2048&&(l=null,c.alternate!==null&&(l=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==l&&(c.refCount++,l!=null&&Gd(l)));break;case 12:if(y&2048){ps(l,c,f,p),l=c.stateNode;try{var S=c.memoizedProps,k=S.id,z=S.onPostCommit;typeof z=="function"&&z(k,c.alternate===null?"mount":"update",l.passiveEffectDuration,-0)}catch(oe){qt(c,c.return,oe)}}else ps(l,c,f,p);break;case 31:ps(l,c,f,p);break;case 13:ps(l,c,f,p);break;case 23:break;case 22:S=c.stateNode,k=c.alternate,c.memoizedState!==null?S._visibility&2?ps(l,c,f,p):th(l,c):S._visibility&2?ps(l,c,f,p):(S._visibility|=2,Xc(l,c,f,p,(c.subtreeFlags&10256)!==0||!1)),y&2048&&eC(k,c);break;case 24:ps(l,c,f,p),y&2048&&tC(c.alternate,c);break;default:ps(l,c,f,p)}}function Xc(l,c,f,p,y){for(y=y&&((c.subtreeFlags&10256)!==0||!1),c=c.child;c!==null;){var S=l,k=c,z=f,oe=p,pe=k.flags;switch(k.tag){case 0:case 11:case 15:Xc(S,k,z,oe,y),Jd(8,k);break;case 23:break;case 22:var Te=k.stateNode;k.memoizedState!==null?Te._visibility&2?Xc(S,k,z,oe,y):th(S,k):(Te._visibility|=2,Xc(S,k,z,oe,y)),y&&pe&2048&&eC(k.alternate,k);break;case 24:Xc(S,k,z,oe,y),y&&pe&2048&&tC(k.alternate,k);break;default:Xc(S,k,z,oe,y)}c=c.sibling}}function th(l,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var f=l,p=c,y=p.flags;switch(p.tag){case 22:th(f,p),y&2048&&eC(p.alternate,p);break;case 24:th(f,p),y&2048&&tC(p.alternate,p);break;default:th(f,p)}c=c.sibling}}var rh=8192;function Qc(l,c,f){if(l.subtreeFlags&rh)for(l=l.child;l!==null;)x2(l,c,f),l=l.sibling}function x2(l,c,f){switch(l.tag){case 26:Qc(l,c,f),l.flags&rh&&l.memoizedState!==null&&nH(f,gs,l.memoizedState,l.memoizedProps);break;case 5:Qc(l,c,f);break;case 3:case 4:var p=gs;gs=sp(l.stateNode.containerInfo),Qc(l,c,f),gs=p;break;case 22:l.memoizedState===null&&(p=l.alternate,p!==null&&p.memoizedState!==null?(p=rh,rh=16777216,Qc(l,c,f),rh=p):Qc(l,c,f));break;default:Qc(l,c,f)}}function E2(l){var c=l.alternate;if(c!==null&&(l=c.child,l!==null)){c.child=null;do c=l.sibling,l.sibling=null,l=c;while(l!==null)}}function nh(l){var c=l.deletions;if((l.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var p=c[f];sn=p,T2(p,l)}E2(l)}if(l.subtreeFlags&10256)for(l=l.child;l!==null;)R2(l),l=l.sibling}function R2(l){switch(l.tag){case 0:case 11:case 15:nh(l),l.flags&2048&&Ca(9,l,l.return);break;case 3:nh(l);break;case 12:nh(l);break;case 22:var c=l.stateNode;l.memoizedState!==null&&c._visibility&2&&(l.return===null||l.return.tag!==13)?(c._visibility&=-3,jg(l)):nh(l);break;default:nh(l)}}function jg(l){var c=l.deletions;if((l.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var p=c[f];sn=p,T2(p,l)}E2(l)}for(l=l.child;l!==null;){switch(c=l,c.tag){case 0:case 11:case 15:Ca(8,c,c.return),jg(c);break;case 22:f=c.stateNode,f._visibility&2&&(f._visibility&=-3,jg(c));break;default:jg(c)}l=l.sibling}}function T2(l,c){for(;sn!==null;){var f=sn;switch(f.tag){case 0:case 11:case 15:Ca(8,f,c);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var p=f.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Gd(f.memoizedState.cache)}if(p=f.child,p!==null)p.return=f,sn=p;else e:for(f=l;sn!==null;){p=sn;var y=p.sibling,S=p.return;if(m2(p),p===f){sn=null;break e}if(y!==null){y.return=S,sn=y;break e}sn=S}}}var w3={getCacheForType:function(l){var c=gn(Yr),f=c.data.get(l);return f===void 0&&(f=l(),c.data.set(l,f)),f},cacheSignal:function(){return gn(Yr).controller.signal}},C3=typeof WeakMap=="function"?WeakMap:Map,Ut=0,or=null,Pt=null,_t=0,Kt=0,mi=null,ya=!1,Zc=!1,rC=!1,Ao=0,Pr=0,ba=0,Al=0,nC=0,vi=0,Jc=0,ih=null,ei=null,iC=!1,Yg=0,F2=0,Kg=1/0,qg=null,Sa=null,en=0,xa=null,eu=null,ko=0,sC=0,oC=null,D2=null,sh=0,aC=null;function wi(){return(Ut&2)!==0&&_t!==0?_t&-_t:_.T!==null?fC():B()}function A2(){if(vi===0)if((_t&536870912)===0||Ot){var l=uo;uo<<=1,(uo&3932160)===0&&(uo=262144),vi=l}else vi=536870912;return l=gi.current,l!==null&&(l.flags|=32),vi}function ti(l,c,f){(l===or&&(Kt===2||Kt===9)||l.cancelPendingCommit!==null)&&(tu(l,0),Ea(l,_t,vi,!1)),hs(l,f),((Ut&2)===0||l!==or)&&(l===or&&((Ut&2)===0&&(Al|=f),Pr===4&&Ea(l,_t,vi,!1)),Ns(l))}function k2(l,c,f){if((Ut&6)!==0)throw Error(n(327));var p=!f&&(c&127)===0&&(c&l.expiredLanes)===0||ho(l,c),y=p?S3(l,c):cC(l,c,!0),S=p;do{if(y===0){Zc&&!p&&Ea(l,c,0,!1);break}else{if(f=l.current.alternate,S&&!y3(f)){y=cC(l,c,!1),S=!1;continue}if(y===2){if(S=c,l.errorRecoveryDisabledLanes&S)var k=0;else k=l.pendingLanes&-536870913,k=k!==0?k:k&536870912?536870912:0;if(k!==0){c=k;e:{var z=l;y=ih;var oe=z.current.memoizedState.isDehydrated;if(oe&&(tu(z,k).flags|=256),k=cC(z,k,!1),k!==2){if(rC&&!oe){z.errorRecoveryDisabledLanes|=S,Al|=S,y=4;break e}S=ei,ei=y,S!==null&&(ei===null?ei=S:ei.push.apply(ei,S))}y=k}if(S=!1,y!==2)continue}}if(y===1){tu(l,0),Ea(l,c,0,!0);break}e:{switch(p=l,S=y,S){case 0:case 1:throw Error(n(345));case 4:if((c&4194048)!==c)break;case 6:Ea(p,c,vi,!ya);break e;case 2:ei=null;break;case 3:case 5:break;default:throw Error(n(329))}if((c&62914560)===c&&(y=Yg+300-qe(),10<y)){if(Ea(p,c,vi,!ya),sa(p,0,!0)!==0)break e;ko=c,p.timeoutHandle=aT(P2.bind(null,p,f,ei,qg,iC,c,vi,Al,Jc,ya,S,"Throttled",-0,0),y);break e}P2(p,f,ei,qg,iC,c,vi,Al,Jc,ya,S,null,-0,0)}}break}while(!0);Ns(l)}function P2(l,c,f,p,y,S,k,z,oe,pe,Te,Pe,ye,Se){if(l.timeoutHandle=-1,Pe=c.subtreeFlags,Pe&8192||(Pe&16785408)===16785408){Pe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:po},x2(c,S,Pe);var Qe=(S&62914560)===S?Yg-qe():(S&4194048)===S?F2-qe():0;if(Qe=iH(Pe,Qe),Qe!==null){ko=S,l.cancelPendingCommit=Qe(H2.bind(null,l,c,S,f,p,y,k,z,oe,Te,Pe,null,ye,Se)),Ea(l,S,k,!pe);return}}H2(l,c,S,f,p,y,k,z,oe)}function y3(l){for(var c=l;;){var f=c.tag;if((f===0||f===11||f===15)&&c.flags&16384&&(f=c.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var p=0;p<f.length;p++){var y=f[p],S=y.getSnapshot;y=y.value;try{if(!hi(S(),y))return!1}catch{return!1}}if(f=c.child,c.subtreeFlags&16384&&f!==null)f.return=c,c=f;else{if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Ea(l,c,f,p){c&=~nC,c&=~Al,l.suspendedLanes|=c,l.pingedLanes&=~c,p&&(l.warmLanes|=c),p=l.expirationTimes;for(var y=c;0<y;){var S=31-Cr(y),k=1<<S;p[S]=-1,y&=~k}f!==0&&Dc(l,f,c)}function Xg(){return(Ut&6)===0?(oh(0),!1):!0}function lC(){if(Pt!==null){if(Kt===0)var l=Pt.return;else l=Pt,Co=yl=null,Ew(l),$c=null,zd=0,l=Pt;for(;l!==null;)l2(l.alternate,l),l=l.return;Pt=null}}function tu(l,c){var f=l.timeoutHandle;f!==-1&&(l.timeoutHandle=-1,G3(f)),f=l.cancelPendingCommit,f!==null&&(l.cancelPendingCommit=null,f()),ko=0,lC(),or=l,Pt=f=vo(l.current,null),_t=c,Kt=0,mi=null,ya=!1,Zc=ho(l,c),rC=!1,Jc=vi=nC=Al=ba=Pr=0,ei=ih=null,iC=!1,(c&8)!==0&&(c|=c&32);var p=l.entangledLanes;if(p!==0)for(l=l.entanglements,p&=c;0<p;){var y=31-Cr(p),S=1<<y;c|=l[y],p&=~S}return Ao=c,vg(),f}function M2(l,c){yt=null,_.H=Xd,c===Uc||c===Rg?(c=KE(),Kt=3):c===hw?(c=KE(),Kt=4):Kt=c===Gw?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,mi=c,Pt===null&&(Pr=1,Hg(l,Bi(c,l.current)))}function _2(){var l=gi.current;return l===null?!0:(_t&4194048)===_t?zi===null:(_t&62914560)===_t||(_t&536870912)!==0?l===zi:!1}function L2(){var l=_.H;return _.H=Xd,l===null?Xd:l}function I2(){var l=_.A;return _.A=w3,l}function Qg(){Pr=4,ya||(_t&4194048)!==_t&&gi.current!==null||(Zc=!0),(ba&134217727)===0&&(Al&134217727)===0||or===null||Ea(or,_t,vi,!1)}function cC(l,c,f){var p=Ut;Ut|=2;var y=L2(),S=I2();(or!==l||_t!==c)&&(qg=null,tu(l,c)),c=!1;var k=Pr;e:do try{if(Kt!==0&&Pt!==null){var z=Pt,oe=mi;switch(Kt){case 8:lC(),k=6;break e;case 3:case 2:case 9:case 6:gi.current===null&&(c=!0);var pe=Kt;if(Kt=0,mi=null,ru(l,z,oe,pe),f&&Zc){k=0;break e}break;default:pe=Kt,Kt=0,mi=null,ru(l,z,oe,pe)}}b3(),k=Pr;break}catch(Te){M2(l,Te)}while(!0);return c&&l.shellSuspendCounter++,Co=yl=null,Ut=p,_.H=y,_.A=S,Pt===null&&(or=null,_t=0,vg()),k}function b3(){for(;Pt!==null;)O2(Pt)}function S3(l,c){var f=Ut;Ut|=2;var p=L2(),y=I2();or!==l||_t!==c?(qg=null,Kg=qe()+500,tu(l,c)):Zc=ho(l,c);e:do try{if(Kt!==0&&Pt!==null){c=Pt;var S=mi;t:switch(Kt){case 1:Kt=0,mi=null,ru(l,c,S,1);break;case 2:case 9:if(jE(S)){Kt=0,mi=null,N2(c);break}c=function(){Kt!==2&&Kt!==9||or!==l||(Kt=7),Ns(l)},S.then(c,c);break e;case 3:Kt=7;break e;case 4:Kt=5;break e;case 7:jE(S)?(Kt=0,mi=null,N2(c)):(Kt=0,mi=null,ru(l,c,S,7));break;case 5:var k=null;switch(Pt.tag){case 26:k=Pt.memoizedState;case 5:case 27:var z=Pt;if(k?ST(k):z.stateNode.complete){Kt=0,mi=null;var oe=z.sibling;if(oe!==null)Pt=oe;else{var pe=z.return;pe!==null?(Pt=pe,Zg(pe)):Pt=null}break t}}Kt=0,mi=null,ru(l,c,S,5);break;case 6:Kt=0,mi=null,ru(l,c,S,6);break;case 8:lC(),Pr=6;break e;default:throw Error(n(462))}}x3();break}catch(Te){M2(l,Te)}while(!0);return Co=yl=null,_.H=p,_.A=y,Ut=f,Pt!==null?0:(or=null,_t=0,vg(),Pr)}function x3(){for(;Pt!==null&&!Ct();)O2(Pt)}function O2(l){var c=o2(l.alternate,l,Ao);l.memoizedProps=l.pendingProps,c===null?Zg(l):Pt=c}function N2(l){var c=l,f=c.alternate;switch(c.tag){case 15:case 0:c=e2(f,c,c.pendingProps,c.type,void 0,_t);break;case 11:c=e2(f,c,c.pendingProps,c.type.render,c.ref,_t);break;case 5:Ew(c);default:l2(f,c),c=Pt=IE(c,Ao),c=o2(f,c,Ao)}l.memoizedProps=l.pendingProps,c===null?Zg(l):Pt=c}function ru(l,c,f,p){Co=yl=null,Ew(c),$c=null,zd=0;var y=c.return;try{if(d3(l,y,c,f,_t)){Pr=1,Hg(l,Bi(f,l.current)),Pt=null;return}}catch(S){if(y!==null)throw Pt=y,S;Pr=1,Hg(l,Bi(f,l.current)),Pt=null;return}c.flags&32768?(Ot||p===1?l=!0:Zc||(_t&536870912)!==0?l=!1:(ya=l=!0,(p===2||p===9||p===3||p===6)&&(p=gi.current,p!==null&&p.tag===13&&(p.flags|=16384))),B2(c,l)):Zg(c)}function Zg(l){var c=l;do{if((c.flags&32768)!==0){B2(c,ya);return}l=c.return;var f=g3(c.alternate,c,Ao);if(f!==null){Pt=f;return}if(c=c.sibling,c!==null){Pt=c;return}Pt=c=l}while(c!==null);Pr===0&&(Pr=5)}function B2(l,c){do{var f=p3(l.alternate,l);if(f!==null){f.flags&=32767,Pt=f;return}if(f=l.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!c&&(l=l.sibling,l!==null)){Pt=l;return}Pt=l=f}while(l!==null);Pr=6,Pt=null}function H2(l,c,f,p,y,S,k,z,oe){l.cancelPendingCommit=null;do Jg();while(en!==0);if((Ut&6)!==0)throw Error(n(327));if(c!==null){if(c===l.current)throw Error(n(177));if(S=c.lanes|c.childLanes,S|=Qv,Fc(l,f,S,k,z,oe),l===or&&(Pt=or=null,_t=0),eu=c,xa=l,ko=f,sC=S,oC=y,D2=p,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(l.callbackNode=null,l.callbackPriority=0,F3(dt,function(){return U2(),null})):(l.callbackNode=null,l.callbackPriority=0),p=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||p){p=_.T,_.T=null,y=Y.p,Y.p=2,k=Ut,Ut|=4;try{m3(l,c,f)}finally{Ut=k,Y.p=y,_.T=p}}en=1,G2(),V2(),z2()}}function G2(){if(en===1){en=0;var l=xa,c=eu,f=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||f){f=_.T,_.T=null;var p=Y.p;Y.p=2;var y=Ut;Ut|=4;try{y2(c,l);var S=bC,k=TE(l.containerInfo),z=S.focusedElem,oe=S.selectionRange;if(k!==z&&z&&z.ownerDocument&&RE(z.ownerDocument.documentElement,z)){if(oe!==null&&jv(z)){var pe=oe.start,Te=oe.end;if(Te===void 0&&(Te=pe),"selectionStart"in z)z.selectionStart=pe,z.selectionEnd=Math.min(Te,z.value.length);else{var Pe=z.ownerDocument||document,ye=Pe&&Pe.defaultView||window;if(ye.getSelection){var Se=ye.getSelection(),Qe=z.textContent.length,ut=Math.min(oe.start,Qe),rr=oe.end===void 0?ut:Math.min(oe.end,Qe);!Se.extend&&ut>rr&&(k=rr,rr=ut,ut=k);var he=EE(z,ut),ce=EE(z,rr);if(he&&ce&&(Se.rangeCount!==1||Se.anchorNode!==he.node||Se.anchorOffset!==he.offset||Se.focusNode!==ce.node||Se.focusOffset!==ce.offset)){var ge=Pe.createRange();ge.setStart(he.node,he.offset),Se.removeAllRanges(),ut>rr?(Se.addRange(ge),Se.extend(ce.node,ce.offset)):(ge.setEnd(ce.node,ce.offset),Se.addRange(ge))}}}}for(Pe=[],Se=z;Se=Se.parentNode;)Se.nodeType===1&&Pe.push({element:Se,left:Se.scrollLeft,top:Se.scrollTop});for(typeof z.focus=="function"&&z.focus(),z=0;z<Pe.length;z++){var Ae=Pe[z];Ae.element.scrollLeft=Ae.left,Ae.element.scrollTop=Ae.top}}dp=!!yC,bC=yC=null}finally{Ut=y,Y.p=p,_.T=f}}l.current=c,en=2}}function V2(){if(en===2){en=0;var l=xa,c=eu,f=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||f){f=_.T,_.T=null;var p=Y.p;Y.p=2;var y=Ut;Ut|=4;try{p2(l,c.alternate,c)}finally{Ut=y,Y.p=p,_.T=f}}en=3}}function z2(){if(en===4||en===3){en=0,ar();var l=xa,c=eu,f=ko,p=D2;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?en=5:(en=0,eu=xa=null,W2(l,l.pendingLanes));var y=l.pendingLanes;if(y===0&&(Sa=null),aa(f),c=c.stateNode,lr&&typeof lr.onCommitFiberRoot=="function")try{lr.onCommitFiberRoot(It,c,void 0,(c.current.flags&128)===128)}catch{}if(p!==null){c=_.T,y=Y.p,Y.p=2,_.T=null;try{for(var S=l.onRecoverableError,k=0;k<p.length;k++){var z=p[k];S(z.value,{componentStack:z.stack})}}finally{_.T=c,Y.p=y}}(ko&3)!==0&&Jg(),Ns(l),y=l.pendingLanes,(f&261930)!==0&&(y&42)!==0?l===aC?sh++:(sh=0,aC=l):sh=0,oh(0)}}function W2(l,c){(l.pooledCacheLanes&=c)===0&&(c=l.pooledCache,c!=null&&(l.pooledCache=null,Gd(c)))}function Jg(){return G2(),V2(),z2(),U2()}function U2(){if(en!==5)return!1;var l=xa,c=sC;sC=0;var f=aa(ko),p=_.T,y=Y.p;try{Y.p=32>f?32:f,_.T=null,f=oC,oC=null;var S=xa,k=ko;if(en=0,eu=xa=null,ko=0,(Ut&6)!==0)throw Error(n(331));var z=Ut;if(Ut|=4,R2(S.current),S2(S,S.current,k,f),Ut=z,oh(0,!1),lr&&typeof lr.onPostCommitFiberRoot=="function")try{lr.onPostCommitFiberRoot(It,S)}catch{}return!0}finally{Y.p=y,_.T=p,W2(l,c)}}function $2(l,c,f){c=Bi(f,c),c=Hw(l.stateNode,c,2),l=ma(l,c,2),l!==null&&(hs(l,2),Ns(l))}function qt(l,c,f){if(l.tag===3)$2(l,l,f);else for(;c!==null;){if(c.tag===3){$2(c,l,f);break}else if(c.tag===1){var p=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Sa===null||!Sa.has(p))){l=Bi(f,l),f=jR(2),p=ma(c,f,2),p!==null&&(YR(f,p,c,l),hs(p,2),Ns(p));break}}c=c.return}}function uC(l,c,f){var p=l.pingCache;if(p===null){p=l.pingCache=new C3;var y=new Set;p.set(c,y)}else y=p.get(c),y===void 0&&(y=new Set,p.set(c,y));y.has(f)||(rC=!0,y.add(f),l=E3.bind(null,l,c,f),c.then(l,l))}function E3(l,c,f){var p=l.pingCache;p!==null&&p.delete(c),l.pingedLanes|=l.suspendedLanes&f,l.warmLanes&=~f,or===l&&(_t&f)===f&&(Pr===4||Pr===3&&(_t&62914560)===_t&&300>qe()-Yg?(Ut&2)===0&&tu(l,0):nC|=f,Jc===_t&&(Jc=0)),Ns(l)}function j2(l,c){c===0&&(c=oa()),l=vl(l,c),l!==null&&(hs(l,c),Ns(l))}function R3(l){var c=l.memoizedState,f=0;c!==null&&(f=c.retryLane),j2(l,f)}function T3(l,c){var f=0;switch(l.tag){case 31:case 13:var p=l.stateNode,y=l.memoizedState;y!==null&&(f=y.retryLane);break;case 19:p=l.stateNode;break;case 22:p=l.stateNode._retryCache;break;default:throw Error(n(314))}p!==null&&p.delete(c),j2(l,f)}function F3(l,c){return Xe(l,c)}var ep=null,nu=null,dC=!1,tp=!1,hC=!1,Ra=0;function Ns(l){l!==nu&&l.next===null&&(nu===null?ep=nu=l:nu=nu.next=l),tp=!0,dC||(dC=!0,A3())}function oh(l,c){if(!hC&&tp){hC=!0;do for(var f=!1,p=ep;p!==null;){if(l!==0){var y=p.pendingLanes;if(y===0)var S=0;else{var k=p.suspendedLanes,z=p.pingedLanes;S=(1<<31-Cr(42|l)+1)-1,S&=y&~(k&~z),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(f=!0,X2(p,S))}else S=_t,S=sa(p,p===or?S:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(S&3)===0||ho(p,S)||(f=!0,X2(p,S));p=p.next}while(f);hC=!1}}function D3(){Y2()}function Y2(){tp=dC=!1;var l=0;Ra!==0&&H3()&&(l=Ra);for(var c=qe(),f=null,p=ep;p!==null;){var y=p.next,S=K2(p,c);S===0?(p.next=null,f===null?ep=y:f.next=y,y===null&&(nu=f)):(f=p,(l!==0||(S&3)!==0)&&(tp=!0)),p=y}en!==0&&en!==5||oh(l),Ra!==0&&(Ra=0)}function K2(l,c){for(var f=l.suspendedLanes,p=l.pingedLanes,y=l.expirationTimes,S=l.pendingLanes&-62914561;0<S;){var k=31-Cr(S),z=1<<k,oe=y[k];oe===-1?((z&f)===0||(z&p)!==0)&&(y[k]=hl(z,c)):oe<=c&&(l.expiredLanes|=z),S&=~z}if(c=or,f=_t,f=sa(l,l===c?f:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),p=l.callbackNode,f===0||l===c&&(Kt===2||Kt===9)||l.cancelPendingCommit!==null)return p!==null&&p!==null&&st(p),l.callbackNode=null,l.callbackPriority=0;if((f&3)===0||ho(l,f)){if(c=f&-f,c===l.callbackPriority)return c;switch(p!==null&&st(p),aa(f)){case 2:case 8:f=Et;break;case 32:f=dt;break;case 268435456:f=ht;break;default:f=dt}return p=q2.bind(null,l),f=Xe(f,p),l.callbackPriority=c,l.callbackNode=f,c}return p!==null&&p!==null&&st(p),l.callbackPriority=2,l.callbackNode=null,2}function q2(l,c){if(en!==0&&en!==5)return l.callbackNode=null,l.callbackPriority=0,null;var f=l.callbackNode;if(Jg()&&l.callbackNode!==f)return null;var p=_t;return p=sa(l,l===or?p:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),p===0?null:(k2(l,p,c),K2(l,qe()),l.callbackNode!=null&&l.callbackNode===f?q2.bind(null,l):null)}function X2(l,c){if(Jg())return null;k2(l,c,!0)}function A3(){V3(function(){(Ut&6)!==0?Xe(Or,D3):Y2()})}function fC(){if(Ra===0){var l=zc;l===0&&(l=nn,nn<<=1,(nn&261888)===0&&(nn=256)),Ra=l}return Ra}function Q2(l){return l==null||typeof l=="symbol"||typeof l=="boolean"?null:typeof l=="function"?l:cg(""+l)}function Z2(l,c){var f=c.ownerDocument.createElement("input");return f.name=c.name,f.value=c.value,l.id&&f.setAttribute("form",l.id),c.parentNode.insertBefore(f,c),l=new FormData(l),f.parentNode.removeChild(f),l}function k3(l,c,f,p,y){if(c==="submit"&&f&&f.stateNode===y){var S=Q2((y[ee]||null).action),k=p.submitter;k&&(c=(c=k[ee]||null)?Q2(c.formAction):k.getAttribute("formAction"),c!==null&&(S=c,k=null));var z=new fg("action","action",null,p,y);l.push({event:z,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Ra!==0){var oe=k?Z2(y,k):new FormData(y);_w(f,{pending:!0,data:oe,method:y.method,action:S},null,oe)}}else typeof S=="function"&&(z.preventDefault(),oe=k?Z2(y,k):new FormData(y),_w(f,{pending:!0,data:oe,method:y.method,action:S},S,oe))},currentTarget:y}]})}}for(var gC=0;gC<Xv.length;gC++){var pC=Xv[gC],P3=pC.toLowerCase(),M3=pC[0].toUpperCase()+pC.slice(1);fs(P3,"on"+M3)}fs(AE,"onAnimationEnd"),fs(kE,"onAnimationIteration"),fs(PE,"onAnimationStart"),fs("dblclick","onDoubleClick"),fs("focusin","onFocus"),fs("focusout","onBlur"),fs(KB,"onTransitionRun"),fs(qB,"onTransitionStart"),fs(XB,"onTransitionCancel"),fs(ME,"onTransitionEnd"),Li("onMouseEnter",["mouseout","mouseover"]),Li("onMouseLeave",["mouseout","mouseover"]),Li("onPointerEnter",["pointerout","pointerover"]),Li("onPointerLeave",["pointerout","pointerover"]),yr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),yr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),yr("onBeforeInput",["compositionend","keypress","textInput","paste"]),yr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),yr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),yr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ah="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_3=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ah));function J2(l,c){c=(c&4)!==0;for(var f=0;f<l.length;f++){var p=l[f],y=p.event;p=p.listeners;e:{var S=void 0;if(c)for(var k=p.length-1;0<=k;k--){var z=p[k],oe=z.instance,pe=z.currentTarget;if(z=z.listener,oe!==S&&y.isPropagationStopped())break e;S=z,y.currentTarget=pe;try{S(y)}catch(Te){mg(Te)}y.currentTarget=null,S=oe}else for(k=0;k<p.length;k++){if(z=p[k],oe=z.instance,pe=z.currentTarget,z=z.listener,oe!==S&&y.isPropagationStopped())break e;S=z,y.currentTarget=pe;try{S(y)}catch(Te){mg(Te)}y.currentTarget=null,S=oe}}}}function Mt(l,c){var f=c[ve];f===void 0&&(f=c[ve]=new Set);var p=l+"__bubble";f.has(p)||(eT(c,l,2,!1),f.add(p))}function mC(l,c,f){var p=0;c&&(p|=4),eT(f,l,p,c)}var rp="_reactListening"+Math.random().toString(36).slice(2);function vC(l){if(!l[rp]){l[rp]=!0,cr.forEach(function(f){f!=="selectionchange"&&(_3.has(f)||mC(f,!1,l),mC(f,!0,l))});var c=l.nodeType===9?l:l.ownerDocument;c===null||c[rp]||(c[rp]=!0,mC("selectionchange",!1,c))}}function eT(l,c,f,p){switch(AT(c)){case 2:var y=aH;break;case 8:y=lH;break;default:y=MC}f=y.bind(null,c,f,l),y=void 0,!Nv||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(y=!0),p?y!==void 0?l.addEventListener(c,f,{capture:!0,passive:y}):l.addEventListener(c,f,!0):y!==void 0?l.addEventListener(c,f,{passive:y}):l.addEventListener(c,f,!1)}function wC(l,c,f,p,y){var S=p;if((c&1)===0&&(c&2)===0&&p!==null)e:for(;;){if(p===null)return;var k=p.tag;if(k===3||k===4){var z=p.stateNode.containerInfo;if(z===y)break;if(k===4)for(k=p.return;k!==null;){var oe=k.tag;if((oe===3||oe===4)&&k.stateNode.containerInfo===y)return;k=k.return}for(;z!==null;){if(k=Ve(z),k===null)return;if(oe=k.tag,oe===5||oe===6||oe===26||oe===27){p=S=k;continue e}z=z.parentNode}}p=p.return}sE(function(){var pe=S,Te=Iv(f),Pe=[];e:{var ye=_E.get(l);if(ye!==void 0){var Se=fg,Qe=l;switch(l){case"keypress":if(dg(f)===0)break e;case"keydown":case"keyup":Se=TB;break;case"focusin":Qe="focus",Se=Vv;break;case"focusout":Qe="blur",Se=Vv;break;case"beforeblur":case"afterblur":Se=Vv;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Se=lE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Se=gB;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Se=AB;break;case AE:case kE:case PE:Se=vB;break;case ME:Se=PB;break;case"scroll":case"scrollend":Se=hB;break;case"wheel":Se=_B;break;case"copy":case"cut":case"paste":Se=CB;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Se=uE;break;case"toggle":case"beforetoggle":Se=IB}var ut=(c&4)!==0,rr=!ut&&(l==="scroll"||l==="scrollend"),he=ut?ye!==null?ye+"Capture":null:ye;ut=[];for(var ce=pe,ge;ce!==null;){var Ae=ce;if(ge=Ae.stateNode,Ae=Ae.tag,Ae!==5&&Ae!==26&&Ae!==27||ge===null||he===null||(Ae=Ad(ce,he),Ae!=null&&ut.push(lh(ce,Ae,ge))),rr)break;ce=ce.return}0<ut.length&&(ye=new Se(ye,Qe,null,f,Te),Pe.push({event:ye,listeners:ut}))}}if((c&7)===0){e:{if(ye=l==="mouseover"||l==="pointerover",Se=l==="mouseout"||l==="pointerout",ye&&f!==Lv&&(Qe=f.relatedTarget||f.fromElement)&&(Ve(Qe)||Qe[re]))break e;if((Se||ye)&&(ye=Te.window===Te?Te:(ye=Te.ownerDocument)?ye.defaultView||ye.parentWindow:window,Se?(Qe=f.relatedTarget||f.toElement,Se=pe,Qe=Qe?Ve(Qe):null,Qe!==null&&(rr=s(Qe),ut=Qe.tag,Qe!==rr||ut!==5&&ut!==27&&ut!==6)&&(Qe=null)):(Se=null,Qe=pe),Se!==Qe)){if(ut=lE,Ae="onMouseLeave",he="onMouseEnter",ce="mouse",(l==="pointerout"||l==="pointerover")&&(ut=uE,Ae="onPointerLeave",he="onPointerEnter",ce="pointer"),rr=Se==null?ye:Be(Se),ge=Qe==null?ye:Be(Qe),ye=new ut(Ae,ce+"leave",Se,f,Te),ye.target=rr,ye.relatedTarget=ge,Ae=null,Ve(Te)===pe&&(ut=new ut(he,ce+"enter",Qe,f,Te),ut.target=ge,ut.relatedTarget=rr,Ae=ut),rr=Ae,Se&&Qe)t:{for(ut=L3,he=Se,ce=Qe,ge=0,Ae=he;Ae;Ae=ut(Ae))ge++;Ae=0;for(var ot=ce;ot;ot=ut(ot))Ae++;for(;0<ge-Ae;)he=ut(he),ge--;for(;0<Ae-ge;)ce=ut(ce),Ae--;for(;ge--;){if(he===ce||ce!==null&&he===ce.alternate){ut=he;break t}he=ut(he),ce=ut(ce)}ut=null}else ut=null;Se!==null&&tT(Pe,ye,Se,ut,!1),Qe!==null&&rr!==null&&tT(Pe,rr,Qe,ut,!0)}}e:{if(ye=pe?Be(pe):window,Se=ye.nodeName&&ye.nodeName.toLowerCase(),Se==="select"||Se==="input"&&ye.type==="file")var Gt=wE;else if(mE(ye))if(CE)Gt=$B;else{Gt=WB;var et=zB}else Se=ye.nodeName,!Se||Se.toLowerCase()!=="input"||ye.type!=="checkbox"&&ye.type!=="radio"?pe&&_v(pe.elementType)&&(Gt=wE):Gt=UB;if(Gt&&(Gt=Gt(l,pe))){vE(Pe,Gt,f,Te);break e}et&&et(l,ye,pe),l==="focusout"&&pe&&ye.type==="number"&&pe.memoizedProps.value!=null&&Mv(ye,"number",ye.value)}switch(et=pe?Be(pe):window,l){case"focusin":(mE(et)||et.contentEditable==="true")&&(Lc=et,Yv=pe,Nd=null);break;case"focusout":Nd=Yv=Lc=null;break;case"mousedown":Kv=!0;break;case"contextmenu":case"mouseup":case"dragend":Kv=!1,FE(Pe,f,Te);break;case"selectionchange":if(YB)break;case"keydown":case"keyup":FE(Pe,f,Te)}var St;if(Wv)e:{switch(l){case"compositionstart":var Lt="onCompositionStart";break e;case"compositionend":Lt="onCompositionEnd";break e;case"compositionupdate":Lt="onCompositionUpdate";break e}Lt=void 0}else _c?gE(l,f)&&(Lt="onCompositionEnd"):l==="keydown"&&f.keyCode===229&&(Lt="onCompositionStart");Lt&&(dE&&f.locale!=="ko"&&(_c||Lt!=="onCompositionStart"?Lt==="onCompositionEnd"&&_c&&(St=oE()):(ca=Te,Bv="value"in ca?ca.value:ca.textContent,_c=!0)),et=np(pe,Lt),0<et.length&&(Lt=new cE(Lt,l,null,f,Te),Pe.push({event:Lt,listeners:et}),St?Lt.data=St:(St=pE(f),St!==null&&(Lt.data=St)))),(St=NB?BB(l,f):HB(l,f))&&(Lt=np(pe,"onBeforeInput"),0<Lt.length&&(et=new cE("onBeforeInput","beforeinput",null,f,Te),Pe.push({event:et,listeners:Lt}),et.data=St)),k3(Pe,l,pe,f,Te)}J2(Pe,c)})}function lh(l,c,f){return{instance:l,listener:c,currentTarget:f}}function np(l,c){for(var f=c+"Capture",p=[];l!==null;){var y=l,S=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||S===null||(y=Ad(l,f),y!=null&&p.unshift(lh(l,y,S)),y=Ad(l,c),y!=null&&p.push(lh(l,y,S))),l.tag===3)return p;l=l.return}return[]}function L3(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5&&l.tag!==27);return l||null}function tT(l,c,f,p,y){for(var S=c._reactName,k=[];f!==null&&f!==p;){var z=f,oe=z.alternate,pe=z.stateNode;if(z=z.tag,oe!==null&&oe===p)break;z!==5&&z!==26&&z!==27||pe===null||(oe=pe,y?(pe=Ad(f,S),pe!=null&&k.unshift(lh(f,pe,oe))):y||(pe=Ad(f,S),pe!=null&&k.push(lh(f,pe,oe)))),f=f.return}k.length!==0&&l.push({event:c,listeners:k})}var I3=/\r\n?/g,O3=/\u0000|\uFFFD/g;function rT(l){return(typeof l=="string"?l:""+l).replace(I3,`
`).replace(O3,"")}function nT(l,c){return c=rT(c),rT(l)===c}function tr(l,c,f,p,y,S){switch(f){case"children":typeof p=="string"?c==="body"||c==="textarea"&&p===""||kc(l,p):(typeof p=="number"||typeof p=="bigint")&&c!=="body"&&kc(l,""+p);break;case"className":ag(l,"class",p);break;case"tabIndex":ag(l,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":ag(l,f,p);break;case"style":nE(l,p,S);break;case"data":if(c!=="object"){ag(l,"data",p);break}case"src":case"href":if(p===""&&(c!=="a"||f!=="href")){l.removeAttribute(f);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){l.removeAttribute(f);break}p=cg(""+p),l.setAttribute(f,p);break;case"action":case"formAction":if(typeof p=="function"){l.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(f==="formAction"?(c!=="input"&&tr(l,c,"name",y.name,y,null),tr(l,c,"formEncType",y.formEncType,y,null),tr(l,c,"formMethod",y.formMethod,y,null),tr(l,c,"formTarget",y.formTarget,y,null)):(tr(l,c,"encType",y.encType,y,null),tr(l,c,"method",y.method,y,null),tr(l,c,"target",y.target,y,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){l.removeAttribute(f);break}p=cg(""+p),l.setAttribute(f,p);break;case"onClick":p!=null&&(l.onclick=po);break;case"onScroll":p!=null&&Mt("scroll",l);break;case"onScrollEnd":p!=null&&Mt("scrollend",l);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(f=p.__html,f!=null){if(y.children!=null)throw Error(n(60));l.innerHTML=f}}break;case"multiple":l.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":l.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){l.removeAttribute("xlink:href");break}f=cg(""+p),l.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?l.setAttribute(f,""+p):l.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?l.setAttribute(f,""):l.removeAttribute(f);break;case"capture":case"download":p===!0?l.setAttribute(f,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?l.setAttribute(f,p):l.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?l.setAttribute(f,p):l.removeAttribute(f);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?l.removeAttribute(f):l.setAttribute(f,p);break;case"popover":Mt("beforetoggle",l),Mt("toggle",l),qn(l,"popover",p);break;case"xlinkActuate":go(l,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":go(l,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":go(l,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":go(l,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":go(l,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":go(l,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":go(l,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":go(l,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":go(l,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":qn(l,"is",p);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=uB.get(f)||f,qn(l,f,p))}}function CC(l,c,f,p,y,S){switch(f){case"style":nE(l,p,S);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(f=p.__html,f!=null){if(y.children!=null)throw Error(n(60));l.innerHTML=f}}break;case"children":typeof p=="string"?kc(l,p):(typeof p=="number"||typeof p=="bigint")&&kc(l,""+p);break;case"onScroll":p!=null&&Mt("scroll",l);break;case"onScrollEnd":p!=null&&Mt("scrollend",l);break;case"onClick":p!=null&&(l.onclick=po);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ur.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(y=f.endsWith("Capture"),c=f.slice(2,y?f.length-7:void 0),S=l[ee]||null,S=S!=null?S[f]:null,typeof S=="function"&&l.removeEventListener(c,S,y),typeof p=="function")){typeof S!="function"&&S!==null&&(f in l?l[f]=null:l.hasAttribute(f)&&l.removeAttribute(f)),l.addEventListener(c,p,y);break e}f in l?l[f]=p:p===!0?l.setAttribute(f,""):qn(l,f,p)}}}function mn(l,c,f){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Mt("error",l),Mt("load",l);var p=!1,y=!1,S;for(S in f)if(f.hasOwnProperty(S)){var k=f[S];if(k!=null)switch(S){case"src":p=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,c));default:tr(l,c,S,k,f,null)}}y&&tr(l,c,"srcSet",f.srcSet,f,null),p&&tr(l,c,"src",f.src,f,null);return;case"input":Mt("invalid",l);var z=S=k=y=null,oe=null,pe=null;for(p in f)if(f.hasOwnProperty(p)){var Te=f[p];if(Te!=null)switch(p){case"name":y=Te;break;case"type":k=Te;break;case"checked":oe=Te;break;case"defaultChecked":pe=Te;break;case"value":S=Te;break;case"defaultValue":z=Te;break;case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(n(137,c));break;default:tr(l,c,p,Te,f,null)}}J1(l,S,z,oe,pe,k,y,!1);return;case"select":Mt("invalid",l),p=k=S=null;for(y in f)if(f.hasOwnProperty(y)&&(z=f[y],z!=null))switch(y){case"value":S=z;break;case"defaultValue":k=z;break;case"multiple":p=z;default:tr(l,c,y,z,f,null)}c=S,f=k,l.multiple=!!p,c!=null?Ac(l,!!p,c,!1):f!=null&&Ac(l,!!p,f,!0);return;case"textarea":Mt("invalid",l),S=y=p=null;for(k in f)if(f.hasOwnProperty(k)&&(z=f[k],z!=null))switch(k){case"value":p=z;break;case"defaultValue":y=z;break;case"children":S=z;break;case"dangerouslySetInnerHTML":if(z!=null)throw Error(n(91));break;default:tr(l,c,k,z,f,null)}tE(l,p,y,S);return;case"option":for(oe in f)if(f.hasOwnProperty(oe)&&(p=f[oe],p!=null))switch(oe){case"selected":l.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:tr(l,c,oe,p,f,null)}return;case"dialog":Mt("beforetoggle",l),Mt("toggle",l),Mt("cancel",l),Mt("close",l);break;case"iframe":case"object":Mt("load",l);break;case"video":case"audio":for(p=0;p<ah.length;p++)Mt(ah[p],l);break;case"image":Mt("error",l),Mt("load",l);break;case"details":Mt("toggle",l);break;case"embed":case"source":case"link":Mt("error",l),Mt("load",l);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(pe in f)if(f.hasOwnProperty(pe)&&(p=f[pe],p!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,c));default:tr(l,c,pe,p,f,null)}return;default:if(_v(c)){for(Te in f)f.hasOwnProperty(Te)&&(p=f[Te],p!==void 0&&CC(l,c,Te,p,f,void 0));return}}for(z in f)f.hasOwnProperty(z)&&(p=f[z],p!=null&&tr(l,c,z,p,f,null))}function N3(l,c,f,p){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,S=null,k=null,z=null,oe=null,pe=null,Te=null;for(Se in f){var Pe=f[Se];if(f.hasOwnProperty(Se)&&Pe!=null)switch(Se){case"checked":break;case"value":break;case"defaultValue":oe=Pe;default:p.hasOwnProperty(Se)||tr(l,c,Se,null,p,Pe)}}for(var ye in p){var Se=p[ye];if(Pe=f[ye],p.hasOwnProperty(ye)&&(Se!=null||Pe!=null))switch(ye){case"type":S=Se;break;case"name":y=Se;break;case"checked":pe=Se;break;case"defaultChecked":Te=Se;break;case"value":k=Se;break;case"defaultValue":z=Se;break;case"children":case"dangerouslySetInnerHTML":if(Se!=null)throw Error(n(137,c));break;default:Se!==Pe&&tr(l,c,ye,Se,p,Pe)}}Pv(l,k,z,oe,pe,Te,S,y);return;case"select":Se=k=z=ye=null;for(S in f)if(oe=f[S],f.hasOwnProperty(S)&&oe!=null)switch(S){case"value":break;case"multiple":Se=oe;default:p.hasOwnProperty(S)||tr(l,c,S,null,p,oe)}for(y in p)if(S=p[y],oe=f[y],p.hasOwnProperty(y)&&(S!=null||oe!=null))switch(y){case"value":ye=S;break;case"defaultValue":z=S;break;case"multiple":k=S;default:S!==oe&&tr(l,c,y,S,p,oe)}c=z,f=k,p=Se,ye!=null?Ac(l,!!f,ye,!1):!!p!=!!f&&(c!=null?Ac(l,!!f,c,!0):Ac(l,!!f,f?[]:"",!1));return;case"textarea":Se=ye=null;for(z in f)if(y=f[z],f.hasOwnProperty(z)&&y!=null&&!p.hasOwnProperty(z))switch(z){case"value":break;case"children":break;default:tr(l,c,z,null,p,y)}for(k in p)if(y=p[k],S=f[k],p.hasOwnProperty(k)&&(y!=null||S!=null))switch(k){case"value":ye=y;break;case"defaultValue":Se=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(n(91));break;default:y!==S&&tr(l,c,k,y,p,S)}eE(l,ye,Se);return;case"option":for(var Qe in f)if(ye=f[Qe],f.hasOwnProperty(Qe)&&ye!=null&&!p.hasOwnProperty(Qe))switch(Qe){case"selected":l.selected=!1;break;default:tr(l,c,Qe,null,p,ye)}for(oe in p)if(ye=p[oe],Se=f[oe],p.hasOwnProperty(oe)&&ye!==Se&&(ye!=null||Se!=null))switch(oe){case"selected":l.selected=ye&&typeof ye!="function"&&typeof ye!="symbol";break;default:tr(l,c,oe,ye,p,Se)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ut in f)ye=f[ut],f.hasOwnProperty(ut)&&ye!=null&&!p.hasOwnProperty(ut)&&tr(l,c,ut,null,p,ye);for(pe in p)if(ye=p[pe],Se=f[pe],p.hasOwnProperty(pe)&&ye!==Se&&(ye!=null||Se!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(n(137,c));break;default:tr(l,c,pe,ye,p,Se)}return;default:if(_v(c)){for(var rr in f)ye=f[rr],f.hasOwnProperty(rr)&&ye!==void 0&&!p.hasOwnProperty(rr)&&CC(l,c,rr,void 0,p,ye);for(Te in p)ye=p[Te],Se=f[Te],!p.hasOwnProperty(Te)||ye===Se||ye===void 0&&Se===void 0||CC(l,c,Te,ye,p,Se);return}}for(var he in f)ye=f[he],f.hasOwnProperty(he)&&ye!=null&&!p.hasOwnProperty(he)&&tr(l,c,he,null,p,ye);for(Pe in p)ye=p[Pe],Se=f[Pe],!p.hasOwnProperty(Pe)||ye===Se||ye==null&&Se==null||tr(l,c,Pe,ye,p,Se)}function iT(l){switch(l){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function B3(){if(typeof performance.getEntriesByType=="function"){for(var l=0,c=0,f=performance.getEntriesByType("resource"),p=0;p<f.length;p++){var y=f[p],S=y.transferSize,k=y.initiatorType,z=y.duration;if(S&&z&&iT(k)){for(k=0,z=y.responseEnd,p+=1;p<f.length;p++){var oe=f[p],pe=oe.startTime;if(pe>z)break;var Te=oe.transferSize,Pe=oe.initiatorType;Te&&iT(Pe)&&(oe=oe.responseEnd,k+=Te*(oe<z?1:(z-pe)/(oe-pe)))}if(--p,c+=8*(S+k)/(y.duration/1e3),l++,10<l)break}}if(0<l)return c/l/1e6}return navigator.connection&&(l=navigator.connection.downlink,typeof l=="number")?l:5}var yC=null,bC=null;function ip(l){return l.nodeType===9?l:l.ownerDocument}function sT(l){switch(l){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function oT(l,c){if(l===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return l===1&&c==="foreignObject"?0:l}function SC(l,c){return l==="textarea"||l==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var xC=null;function H3(){var l=window.event;return l&&l.type==="popstate"?l===xC?!1:(xC=l,!0):(xC=null,!1)}var aT=typeof setTimeout=="function"?setTimeout:void 0,G3=typeof clearTimeout=="function"?clearTimeout:void 0,lT=typeof Promise=="function"?Promise:void 0,V3=typeof queueMicrotask=="function"?queueMicrotask:typeof lT<"u"?function(l){return lT.resolve(null).then(l).catch(z3)}:aT;function z3(l){setTimeout(function(){throw l})}function Ta(l){return l==="head"}function cT(l,c){var f=c,p=0;do{var y=f.nextSibling;if(l.removeChild(f),y&&y.nodeType===8)if(f=y.data,f==="/$"||f==="/&"){if(p===0){l.removeChild(y),au(c);return}p--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")p++;else if(f==="html")ch(l.ownerDocument.documentElement);else if(f==="head"){f=l.ownerDocument.head,ch(f);for(var S=f.firstChild;S;){var k=S.nextSibling,z=S.nodeName;S[be]||z==="SCRIPT"||z==="STYLE"||z==="LINK"&&S.rel.toLowerCase()==="stylesheet"||f.removeChild(S),S=k}}else f==="body"&&ch(l.ownerDocument.body);f=y}while(f);au(c)}function uT(l,c){var f=l;l=0;do{var p=f.nextSibling;if(f.nodeType===1?c?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(c?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),p&&p.nodeType===8)if(f=p.data,f==="/$"){if(l===0)break;l--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||l++;f=p}while(f)}function EC(l){var c=l.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var f=c;switch(c=c.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":EC(f),Ne(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}l.removeChild(f)}}function W3(l,c,f,p){for(;l.nodeType===1;){var y=f;if(l.nodeName.toLowerCase()!==c.toLowerCase()){if(!p&&(l.nodeName!=="INPUT"||l.type!=="hidden"))break}else if(p){if(!l[be])switch(c){case"meta":if(!l.hasAttribute("itemprop"))break;return l;case"link":if(S=l.getAttribute("rel"),S==="stylesheet"&&l.hasAttribute("data-precedence"))break;if(S!==y.rel||l.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||l.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||l.getAttribute("title")!==(y.title==null?null:y.title))break;return l;case"style":if(l.hasAttribute("data-precedence"))break;return l;case"script":if(S=l.getAttribute("src"),(S!==(y.src==null?null:y.src)||l.getAttribute("type")!==(y.type==null?null:y.type)||l.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&S&&l.hasAttribute("async")&&!l.hasAttribute("itemprop"))break;return l;default:return l}}else if(c==="input"&&l.type==="hidden"){var S=y.name==null?null:""+y.name;if(y.type==="hidden"&&l.getAttribute("name")===S)return l}else return l;if(l=Wi(l.nextSibling),l===null)break}return null}function U3(l,c,f){if(c==="")return null;for(;l.nodeType!==3;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!f||(l=Wi(l.nextSibling),l===null))return null;return l}function dT(l,c){for(;l.nodeType!==8;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!c||(l=Wi(l.nextSibling),l===null))return null;return l}function RC(l){return l.data==="$?"||l.data==="$~"}function TC(l){return l.data==="$!"||l.data==="$?"&&l.ownerDocument.readyState!=="loading"}function $3(l,c){var f=l.ownerDocument;if(l.data==="$~")l._reactRetry=c;else if(l.data!=="$?"||f.readyState!=="loading")c();else{var p=function(){c(),f.removeEventListener("DOMContentLoaded",p)};f.addEventListener("DOMContentLoaded",p),l._reactRetry=p}}function Wi(l){for(;l!=null;l=l.nextSibling){var c=l.nodeType;if(c===1||c===3)break;if(c===8){if(c=l.data,c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"||c==="F!"||c==="F")break;if(c==="/$"||c==="/&")return null}}return l}var FC=null;function hT(l){l=l.nextSibling;for(var c=0;l;){if(l.nodeType===8){var f=l.data;if(f==="/$"||f==="/&"){if(c===0)return Wi(l.nextSibling);c--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||c++}l=l.nextSibling}return null}function fT(l){l=l.previousSibling;for(var c=0;l;){if(l.nodeType===8){var f=l.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(c===0)return l;c--}else f!=="/$"&&f!=="/&"||c++}l=l.previousSibling}return null}function gT(l,c,f){switch(c=ip(f),l){case"html":if(l=c.documentElement,!l)throw Error(n(452));return l;case"head":if(l=c.head,!l)throw Error(n(453));return l;case"body":if(l=c.body,!l)throw Error(n(454));return l;default:throw Error(n(451))}}function ch(l){for(var c=l.attributes;c.length;)l.removeAttributeNode(c[0]);Ne(l)}var Ui=new Map,pT=new Set;function sp(l){return typeof l.getRootNode=="function"?l.getRootNode():l.nodeType===9?l:l.ownerDocument}var Po=Y.d;Y.d={f:j3,r:Y3,D:K3,C:q3,L:X3,m:Q3,X:J3,S:Z3,M:eH};function j3(){var l=Po.f(),c=Xg();return l||c}function Y3(l){var c=Ke(l);c!==null&&c.tag===5&&c.type==="form"?MR(c):Po.r(l)}var iu=typeof document>"u"?null:document;function mT(l,c,f){var p=iu;if(p&&typeof c=="string"&&c){var y=Oi(c);y='link[rel="'+l+'"][href="'+y+'"]',typeof f=="string"&&(y+='[crossorigin="'+f+'"]'),pT.has(y)||(pT.add(y),l={rel:l,crossOrigin:f,href:c},p.querySelector(y)===null&&(c=p.createElement("link"),mn(c,"link",l),Je(c),p.head.appendChild(c)))}}function K3(l){Po.D(l),mT("dns-prefetch",l,null)}function q3(l,c){Po.C(l,c),mT("preconnect",l,c)}function X3(l,c,f){Po.L(l,c,f);var p=iu;if(p&&l&&c){var y='link[rel="preload"][as="'+Oi(c)+'"]';c==="image"&&f&&f.imageSrcSet?(y+='[imagesrcset="'+Oi(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(y+='[imagesizes="'+Oi(f.imageSizes)+'"]')):y+='[href="'+Oi(l)+'"]';var S=y;switch(c){case"style":S=su(l);break;case"script":S=ou(l)}Ui.has(S)||(l=g({rel:"preload",href:c==="image"&&f&&f.imageSrcSet?void 0:l,as:c},f),Ui.set(S,l),p.querySelector(y)!==null||c==="style"&&p.querySelector(uh(S))||c==="script"&&p.querySelector(dh(S))||(c=p.createElement("link"),mn(c,"link",l),Je(c),p.head.appendChild(c)))}}function Q3(l,c){Po.m(l,c);var f=iu;if(f&&l){var p=c&&typeof c.as=="string"?c.as:"script",y='link[rel="modulepreload"][as="'+Oi(p)+'"][href="'+Oi(l)+'"]',S=y;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=ou(l)}if(!Ui.has(S)&&(l=g({rel:"modulepreload",href:l},c),Ui.set(S,l),f.querySelector(y)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(dh(S)))return}p=f.createElement("link"),mn(p,"link",l),Je(p),f.head.appendChild(p)}}}function Z3(l,c,f){Po.S(l,c,f);var p=iu;if(p&&l){var y=je(p).hoistableStyles,S=su(l);c=c||"default";var k=y.get(S);if(!k){var z={loading:0,preload:null};if(k=p.querySelector(uh(S)))z.loading=5;else{l=g({rel:"stylesheet",href:l,"data-precedence":c},f),(f=Ui.get(S))&&DC(l,f);var oe=k=p.createElement("link");Je(oe),mn(oe,"link",l),oe._p=new Promise(function(pe,Te){oe.onload=pe,oe.onerror=Te}),oe.addEventListener("load",function(){z.loading|=1}),oe.addEventListener("error",function(){z.loading|=2}),z.loading|=4,op(k,c,p)}k={type:"stylesheet",instance:k,count:1,state:z},y.set(S,k)}}}function J3(l,c){Po.X(l,c);var f=iu;if(f&&l){var p=je(f).hoistableScripts,y=ou(l),S=p.get(y);S||(S=f.querySelector(dh(y)),S||(l=g({src:l,async:!0},c),(c=Ui.get(y))&&AC(l,c),S=f.createElement("script"),Je(S),mn(S,"link",l),f.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},p.set(y,S))}}function eH(l,c){Po.M(l,c);var f=iu;if(f&&l){var p=je(f).hoistableScripts,y=ou(l),S=p.get(y);S||(S=f.querySelector(dh(y)),S||(l=g({src:l,async:!0,type:"module"},c),(c=Ui.get(y))&&AC(l,c),S=f.createElement("script"),Je(S),mn(S,"link",l),f.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},p.set(y,S))}}function vT(l,c,f,p){var y=(y=ae.current)?sp(y):null;if(!y)throw Error(n(446));switch(l){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(c=su(f.href),f=je(y).hoistableStyles,p=f.get(c),p||(p={type:"style",instance:null,count:0,state:null},f.set(c,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){l=su(f.href);var S=je(y).hoistableStyles,k=S.get(l);if(k||(y=y.ownerDocument||y,k={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(l,k),(S=y.querySelector(uh(l)))&&!S._p&&(k.instance=S,k.state.loading=5),Ui.has(l)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},Ui.set(l,f),S||tH(y,l,f,k.state))),c&&p===null)throw Error(n(528,""));return k}if(c&&p!==null)throw Error(n(529,""));return null;case"script":return c=f.async,f=f.src,typeof f=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=ou(f),f=je(y).hoistableScripts,p=f.get(c),p||(p={type:"script",instance:null,count:0,state:null},f.set(c,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,l))}}function su(l){return'href="'+Oi(l)+'"'}function uh(l){return'link[rel="stylesheet"]['+l+"]"}function wT(l){return g({},l,{"data-precedence":l.precedence,precedence:null})}function tH(l,c,f,p){l.querySelector('link[rel="preload"][as="style"]['+c+"]")?p.loading=1:(c=l.createElement("link"),p.preload=c,c.addEventListener("load",function(){return p.loading|=1}),c.addEventListener("error",function(){return p.loading|=2}),mn(c,"link",f),Je(c),l.head.appendChild(c))}function ou(l){return'[src="'+Oi(l)+'"]'}function dh(l){return"script[async]"+l}function CT(l,c,f){if(c.count++,c.instance===null)switch(c.type){case"style":var p=l.querySelector('style[data-href~="'+Oi(f.href)+'"]');if(p)return c.instance=p,Je(p),p;var y=g({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return p=(l.ownerDocument||l).createElement("style"),Je(p),mn(p,"style",y),op(p,f.precedence,l),c.instance=p;case"stylesheet":y=su(f.href);var S=l.querySelector(uh(y));if(S)return c.state.loading|=4,c.instance=S,Je(S),S;p=wT(f),(y=Ui.get(y))&&DC(p,y),S=(l.ownerDocument||l).createElement("link"),Je(S);var k=S;return k._p=new Promise(function(z,oe){k.onload=z,k.onerror=oe}),mn(S,"link",p),c.state.loading|=4,op(S,f.precedence,l),c.instance=S;case"script":return S=ou(f.src),(y=l.querySelector(dh(S)))?(c.instance=y,Je(y),y):(p=f,(y=Ui.get(S))&&(p=g({},f),AC(p,y)),l=l.ownerDocument||l,y=l.createElement("script"),Je(y),mn(y,"link",p),l.head.appendChild(y),c.instance=y);case"void":return null;default:throw Error(n(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(p=c.instance,c.state.loading|=4,op(p,f.precedence,l));return c.instance}function op(l,c,f){for(var p=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=p.length?p[p.length-1]:null,S=y,k=0;k<p.length;k++){var z=p[k];if(z.dataset.precedence===c)S=z;else if(S!==y)break}S?S.parentNode.insertBefore(l,S.nextSibling):(c=f.nodeType===9?f.head:f,c.insertBefore(l,c.firstChild))}function DC(l,c){l.crossOrigin==null&&(l.crossOrigin=c.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=c.referrerPolicy),l.title==null&&(l.title=c.title)}function AC(l,c){l.crossOrigin==null&&(l.crossOrigin=c.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=c.referrerPolicy),l.integrity==null&&(l.integrity=c.integrity)}var ap=null;function yT(l,c,f){if(ap===null){var p=new Map,y=ap=new Map;y.set(f,p)}else y=ap,p=y.get(f),p||(p=new Map,y.set(f,p));if(p.has(l))return p;for(p.set(l,null),f=f.getElementsByTagName(l),y=0;y<f.length;y++){var S=f[y];if(!(S[be]||S[X]||l==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var k=S.getAttribute(c)||"";k=l+k;var z=p.get(k);z?z.push(S):p.set(k,[S])}}return p}function bT(l,c,f){l=l.ownerDocument||l,l.head.insertBefore(f,c==="title"?l.querySelector("head > title"):null)}function rH(l,c,f){if(f===1||c.itemProp!=null)return!1;switch(l){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return l=c.disabled,typeof c.precedence=="string"&&l==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function ST(l){return!(l.type==="stylesheet"&&(l.state.loading&3)===0)}function nH(l,c,f,p){if(f.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var y=su(p.href),S=c.querySelector(uh(y));if(S){c=S._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(l.count++,l=lp.bind(l),c.then(l,l)),f.state.loading|=4,f.instance=S,Je(S);return}S=c.ownerDocument||c,p=wT(p),(y=Ui.get(y))&&DC(p,y),S=S.createElement("link"),Je(S);var k=S;k._p=new Promise(function(z,oe){k.onload=z,k.onerror=oe}),mn(S,"link",p),f.instance=S}l.stylesheets===null&&(l.stylesheets=new Map),l.stylesheets.set(f,c),(c=f.state.preload)&&(f.state.loading&3)===0&&(l.count++,f=lp.bind(l),c.addEventListener("load",f),c.addEventListener("error",f))}}var kC=0;function iH(l,c){return l.stylesheets&&l.count===0&&up(l,l.stylesheets),0<l.count||0<l.imgCount?function(f){var p=setTimeout(function(){if(l.stylesheets&&up(l,l.stylesheets),l.unsuspend){var S=l.unsuspend;l.unsuspend=null,S()}},6e4+c);0<l.imgBytes&&kC===0&&(kC=62500*B3());var y=setTimeout(function(){if(l.waitingForImages=!1,l.count===0&&(l.stylesheets&&up(l,l.stylesheets),l.unsuspend)){var S=l.unsuspend;l.unsuspend=null,S()}},(l.imgBytes>kC?50:800)+c);return l.unsuspend=f,function(){l.unsuspend=null,clearTimeout(p),clearTimeout(y)}}:null}function lp(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)up(this,this.stylesheets);else if(this.unsuspend){var l=this.unsuspend;this.unsuspend=null,l()}}}var cp=null;function up(l,c){l.stylesheets=null,l.unsuspend!==null&&(l.count++,cp=new Map,c.forEach(sH,l),cp=null,lp.call(l))}function sH(l,c){if(!(c.state.loading&4)){var f=cp.get(l);if(f)var p=f.get(null);else{f=new Map,cp.set(l,f);for(var y=l.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<y.length;S++){var k=y[S];(k.nodeName==="LINK"||k.getAttribute("media")!=="not all")&&(f.set(k.dataset.precedence,k),p=k)}p&&f.set(null,p)}y=c.instance,k=y.getAttribute("data-precedence"),S=f.get(k)||p,S===p&&f.set(null,y),f.set(k,y),this.count++,p=lp.bind(this),y.addEventListener("load",p),y.addEventListener("error",p),S?S.parentNode.insertBefore(y,S.nextSibling):(l=l.nodeType===9?l.head:l,l.insertBefore(y,l.firstChild)),c.state.loading|=4}}var hh={$$typeof:E,Provider:null,Consumer:null,_currentValue:Q,_currentValue2:Q,_threadCount:0};function oH(l,c,f,p,y,S,k,z,oe){this.tag=1,this.containerInfo=l,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=fo(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fo(0),this.hiddenUpdates=fo(null),this.identifierPrefix=p,this.onUncaughtError=y,this.onCaughtError=S,this.onRecoverableError=k,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=oe,this.incompleteTransitions=new Map}function xT(l,c,f,p,y,S,k,z,oe,pe,Te,Pe){return l=new oH(l,c,f,k,oe,pe,Te,Pe,z),c=1,S===!0&&(c|=24),S=fi(3,null,null,c),l.current=S,S.stateNode=l,c=cw(),c.refCount++,l.pooledCache=c,c.refCount++,S.memoizedState={element:p,isDehydrated:f,cache:c},fw(S),l}function ET(l){return l?(l=Nc,l):Nc}function RT(l,c,f,p,y,S){y=ET(y),p.context===null?p.context=y:p.pendingContext=y,p=pa(c),p.payload={element:f},S=S===void 0?null:S,S!==null&&(p.callback=S),f=ma(l,p,c),f!==null&&(ti(f,l,c),Ud(f,l,c))}function TT(l,c){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var f=l.retryLane;l.retryLane=f!==0&&f<c?f:c}}function PC(l,c){TT(l,c),(l=l.alternate)&&TT(l,c)}function FT(l){if(l.tag===13||l.tag===31){var c=vl(l,67108864);c!==null&&ti(c,l,67108864),PC(l,67108864)}}function DT(l){if(l.tag===13||l.tag===31){var c=wi();c=Ms(c);var f=vl(l,c);f!==null&&ti(f,l,c),PC(l,c)}}var dp=!0;function aH(l,c,f,p){var y=_.T;_.T=null;var S=Y.p;try{Y.p=2,MC(l,c,f,p)}finally{Y.p=S,_.T=y}}function lH(l,c,f,p){var y=_.T;_.T=null;var S=Y.p;try{Y.p=8,MC(l,c,f,p)}finally{Y.p=S,_.T=y}}function MC(l,c,f,p){if(dp){var y=_C(p);if(y===null)wC(l,c,p,hp,f),kT(l,p);else if(uH(y,l,c,f,p))p.stopPropagation();else if(kT(l,p),c&4&&-1<cH.indexOf(l)){for(;y!==null;){var S=Ke(y);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var k=Ar(S.pendingLanes);if(k!==0){var z=S;for(z.pendingLanes|=2,z.entangledLanes|=2;k;){var oe=1<<31-Cr(k);z.entanglements[1]|=oe,k&=~oe}Ns(S),(Ut&6)===0&&(Kg=qe()+500,oh(0))}}break;case 31:case 13:z=vl(S,2),z!==null&&ti(z,S,2),Xg(),PC(S,2)}if(S=_C(p),S===null&&wC(l,c,p,hp,f),S===y)break;y=S}y!==null&&p.stopPropagation()}else wC(l,c,p,null,f)}}function _C(l){return l=Iv(l),LC(l)}var hp=null;function LC(l){if(hp=null,l=Ve(l),l!==null){var c=s(l);if(c===null)l=null;else{var f=c.tag;if(f===13){if(l=o(c),l!==null)return l;l=null}else if(f===31){if(l=a(c),l!==null)return l;l=null}else if(f===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;l=null}else c!==l&&(l=null)}}return hp=l,null}function AT(l){switch(l){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(hr()){case Or:return 2;case Et:return 8;case dt:case At:return 32;case ht:return 268435456;default:return 32}default:return 32}}var IC=!1,Fa=null,Da=null,Aa=null,fh=new Map,gh=new Map,ka=[],cH="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function kT(l,c){switch(l){case"focusin":case"focusout":Fa=null;break;case"dragenter":case"dragleave":Da=null;break;case"mouseover":case"mouseout":Aa=null;break;case"pointerover":case"pointerout":fh.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":gh.delete(c.pointerId)}}function ph(l,c,f,p,y,S){return l===null||l.nativeEvent!==S?(l={blockedOn:c,domEventName:f,eventSystemFlags:p,nativeEvent:S,targetContainers:[y]},c!==null&&(c=Ke(c),c!==null&&FT(c)),l):(l.eventSystemFlags|=p,c=l.targetContainers,y!==null&&c.indexOf(y)===-1&&c.push(y),l)}function uH(l,c,f,p,y){switch(c){case"focusin":return Fa=ph(Fa,l,c,f,p,y),!0;case"dragenter":return Da=ph(Da,l,c,f,p,y),!0;case"mouseover":return Aa=ph(Aa,l,c,f,p,y),!0;case"pointerover":var S=y.pointerId;return fh.set(S,ph(fh.get(S)||null,l,c,f,p,y)),!0;case"gotpointercapture":return S=y.pointerId,gh.set(S,ph(gh.get(S)||null,l,c,f,p,y)),!0}return!1}function PT(l){var c=Ve(l.target);if(c!==null){var f=s(c);if(f!==null){if(c=f.tag,c===13){if(c=o(f),c!==null){l.blockedOn=c,te(l.priority,function(){DT(f)});return}}else if(c===31){if(c=a(f),c!==null){l.blockedOn=c,te(l.priority,function(){DT(f)});return}}else if(c===3&&f.stateNode.current.memoizedState.isDehydrated){l.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}l.blockedOn=null}function fp(l){if(l.blockedOn!==null)return!1;for(var c=l.targetContainers;0<c.length;){var f=_C(l.nativeEvent);if(f===null){f=l.nativeEvent;var p=new f.constructor(f.type,f);Lv=p,f.target.dispatchEvent(p),Lv=null}else return c=Ke(f),c!==null&&FT(c),l.blockedOn=f,!1;c.shift()}return!0}function MT(l,c,f){fp(l)&&f.delete(c)}function dH(){IC=!1,Fa!==null&&fp(Fa)&&(Fa=null),Da!==null&&fp(Da)&&(Da=null),Aa!==null&&fp(Aa)&&(Aa=null),fh.forEach(MT),gh.forEach(MT)}function gp(l,c){l.blockedOn===c&&(l.blockedOn=null,IC||(IC=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,dH)))}var pp=null;function _T(l){pp!==l&&(pp=l,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){pp===l&&(pp=null);for(var c=0;c<l.length;c+=3){var f=l[c],p=l[c+1],y=l[c+2];if(typeof p!="function"){if(LC(p||f)===null)continue;break}var S=Ke(f);S!==null&&(l.splice(c,3),c-=3,_w(S,{pending:!0,data:y,method:f.method,action:p},p,y))}}))}function au(l){function c(oe){return gp(oe,l)}Fa!==null&&gp(Fa,l),Da!==null&&gp(Da,l),Aa!==null&&gp(Aa,l),fh.forEach(c),gh.forEach(c);for(var f=0;f<ka.length;f++){var p=ka[f];p.blockedOn===l&&(p.blockedOn=null)}for(;0<ka.length&&(f=ka[0],f.blockedOn===null);)PT(f),f.blockedOn===null&&ka.shift();if(f=(l.ownerDocument||l).$$reactFormReplay,f!=null)for(p=0;p<f.length;p+=3){var y=f[p],S=f[p+1],k=y[ee]||null;if(typeof S=="function")k||_T(f);else if(k){var z=null;if(S&&S.hasAttribute("formAction")){if(y=S,k=S[ee]||null)z=k.formAction;else if(LC(y)!==null)continue}else z=k.action;typeof z=="function"?f[p+1]=z:(f.splice(p,3),p-=3),_T(f)}}}function LT(){function l(S){S.canIntercept&&S.info==="react-transition"&&S.intercept({handler:function(){return new Promise(function(k){return y=k})},focusReset:"manual",scroll:"manual"})}function c(){y!==null&&(y(),y=null),p||setTimeout(f,20)}function f(){if(!p&&!navigation.transition){var S=navigation.currentEntry;S&&S.url!=null&&navigation.navigate(S.url,{state:S.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,y=null;return navigation.addEventListener("navigate",l),navigation.addEventListener("navigatesuccess",c),navigation.addEventListener("navigateerror",c),setTimeout(f,100),function(){p=!0,navigation.removeEventListener("navigate",l),navigation.removeEventListener("navigatesuccess",c),navigation.removeEventListener("navigateerror",c),y!==null&&(y(),y=null)}}}function OC(l){this._internalRoot=l}mp.prototype.render=OC.prototype.render=function(l){var c=this._internalRoot;if(c===null)throw Error(n(409));var f=c.current,p=wi();RT(f,p,l,c,null,null)},mp.prototype.unmount=OC.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var c=l.containerInfo;RT(l.current,2,null,l,null,null),Xg(),c[re]=null}};function mp(l){this._internalRoot=l}mp.prototype.unstable_scheduleHydration=function(l){if(l){var c=B();l={blockedOn:null,target:l,priority:c};for(var f=0;f<ka.length&&c!==0&&c<ka[f].priority;f++);ka.splice(f,0,l),f===0&&PT(l)}};var IT=t.version;if(IT!=="19.2.0")throw Error(n(527,IT,"19.2.0"));Y.findDOMNode=function(l){var c=l._reactInternals;if(c===void 0)throw typeof l.render=="function"?Error(n(188)):(l=Object.keys(l).join(","),Error(n(268,l)));return l=d(c),l=l!==null?h(l):null,l=l===null?null:l.stateNode,l};var hH={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:_,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vp.isDisabled&&vp.supportsFiber)try{It=vp.inject(hH),lr=vp}catch{}}return vh.createRoot=function(l,c){if(!i(l))throw Error(n(299));var f=!1,p="",y=zR,S=WR,k=UR;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onUncaughtError!==void 0&&(y=c.onUncaughtError),c.onCaughtError!==void 0&&(S=c.onCaughtError),c.onRecoverableError!==void 0&&(k=c.onRecoverableError)),c=xT(l,1,!1,null,null,f,p,null,y,S,k,LT),l[re]=c.current,vC(l),new OC(c)},vh.hydrateRoot=function(l,c,f){if(!i(l))throw Error(n(299));var p=!1,y="",S=zR,k=WR,z=UR,oe=null;return f!=null&&(f.unstable_strictMode===!0&&(p=!0),f.identifierPrefix!==void 0&&(y=f.identifierPrefix),f.onUncaughtError!==void 0&&(S=f.onUncaughtError),f.onCaughtError!==void 0&&(k=f.onCaughtError),f.onRecoverableError!==void 0&&(z=f.onRecoverableError),f.formState!==void 0&&(oe=f.formState)),c=xT(l,1,!0,c,f??null,p,y,oe,S,k,z,LT),c.context=ET(null),f=c.current,p=wi(),p=Ms(p),y=pa(p),y.callback=null,ma(f,y,p),f=p,c.current.lanes=f,hs(c,f),Ns(c),l[re]=c.current,vC(l),new mp(c)},vh.version="19.2.0",vh}var $T;function SH(){if($T)return HC.exports;$T=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),HC.exports=bH(),HC.exports}var xH=SH();const EH=Mf(xH);var vm=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},RH={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},TH=class{#e=RH;#t=!1;setTimeoutProvider(e){this.#e=e}setTimeout(e,t){return this.#e.setTimeout(e,t)}clearTimeout(e){this.#e.clearTimeout(e)}setInterval(e,t){return this.#e.setInterval(e,t)}clearInterval(e){this.#e.clearInterval(e)}},eb=new TH;function FH(e){setTimeout(e,0)}var wm=typeof window>"u"||"Deno"in globalThis;function vs(){}function DH(e,t){return typeof e=="function"?e(t):e}function AH(e){return typeof e=="number"&&e>=0&&e!==1/0}function kH(e,t){return Math.max(e+(t||0)-Date.now(),0)}function tb(e,t){return typeof e=="function"?e(t):e}function PH(e,t){return typeof e=="function"?e(t):e}function jT(e,t){const{type:r="all",exact:n,fetchStatus:i,predicate:s,queryKey:o,stale:a}=e;if(o){if(n){if(t.queryHash!==gS(o,t.options))return!1}else if(!Jh(t.queryKey,o))return!1}if(r!=="all"){const u=t.isActive();if(r==="active"&&!u||r==="inactive"&&u)return!1}return!(typeof a=="boolean"&&t.isStale()!==a||i&&i!==t.state.fetchStatus||s&&!s(t))}function YT(e,t){const{exact:r,status:n,predicate:i,mutationKey:s}=e;if(s){if(!t.options.mutationKey)return!1;if(r){if(Zh(t.options.mutationKey)!==Zh(s))return!1}else if(!Jh(t.options.mutationKey,s))return!1}return!(n&&t.state.status!==n||i&&!i(t))}function gS(e,t){return(t?.queryKeyHashFn||Zh)(e)}function Zh(e){return JSON.stringify(e,(t,r)=>rb(r)?Object.keys(r).sort().reduce((n,i)=>(n[i]=r[i],n),{}):r)}function Jh(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>Jh(e[r],t[r])):!1}var MH=Object.prototype.hasOwnProperty;function zk(e,t){if(e===t)return e;const r=KT(e)&&KT(t);if(!r&&!(rb(e)&&rb(t)))return t;const i=(r?e:Object.keys(e)).length,s=r?t:Object.keys(t),o=s.length,a=r?new Array(o):{};let u=0;for(let d=0;d<o;d++){const h=r?d:s[d],g=e[h],m=t[h];if(g===m){a[h]=g,(r?d<i:MH.call(e,h))&&u++;continue}if(g===null||m===null||typeof g!="object"||typeof m!="object"){a[h]=m;continue}const v=zk(g,m);a[h]=v,v===g&&u++}return i===o&&u===i?e:a}function KT(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function rb(e){if(!qT(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!qT(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function qT(e){return Object.prototype.toString.call(e)==="[object Object]"}function _H(e){return new Promise(t=>{eb.setTimeout(t,e)})}function LH(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?zk(e,t):t}function IH(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function OH(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var pS=Symbol();function Wk(e,t){return!e.queryFn&&t?.initialPromise?()=>t.initialPromise:!e.queryFn||e.queryFn===pS?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var NH=class extends vm{#e;#t;#r;constructor(){super(),this.#r=e=>{if(!wm&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#r=e,this.#t?.(),this.#t=e(t=>{typeof t=="boolean"?this.setFocused(t):this.onFocus()})}setFocused(e){this.#e!==e&&(this.#e=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},Uk=new NH;function BH(){let e,t;const r=new Promise((i,s)=>{e=i,t=s});r.status="pending",r.catch(()=>{});function n(i){Object.assign(r,i),delete r.resolve,delete r.reject}return r.resolve=i=>{n({status:"fulfilled",value:i}),e(i)},r.reject=i=>{n({status:"rejected",reason:i}),t(i)},r}var HH=FH;function GH(){let e=[],t=0,r=a=>{a()},n=a=>{a()},i=HH;const s=a=>{t?e.push(a):i(()=>{r(a)})},o=()=>{const a=e;e=[],a.length&&i(()=>{n(()=>{a.forEach(u=>{r(u)})})})};return{batch:a=>{let u;t++;try{u=a()}finally{t--,t||o()}return u},batchCalls:a=>(...u)=>{s(()=>{a(...u)})},schedule:s,setNotifyFunction:a=>{r=a},setBatchNotifyFunction:a=>{n=a},setScheduler:a=>{i=a}}}var Vn=GH(),VH=class extends vm{#e=!0;#t;#r;constructor(){super(),this.#r=e=>{if(!wm&&window.addEventListener){const t=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",r)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#r=e,this.#t?.(),this.#t=e(this.setOnline.bind(this))}setOnline(e){this.#e!==e&&(this.#e=e,this.listeners.forEach(r=>{r(e)}))}isOnline(){return this.#e}},v0=new VH;function zH(e){return Math.min(1e3*2**e,3e4)}function $k(e){return(e??"online")==="online"?v0.isOnline():!0}var nb=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function jk(e){let t=!1,r=0,n;const i=BH(),s=()=>i.status!=="pending",o=C=>{if(!s()){const b=new nb(C);m(b),e.onCancel?.(b)}},a=()=>{t=!0},u=()=>{t=!1},d=()=>Uk.isFocused()&&(e.networkMode==="always"||v0.isOnline())&&e.canRun(),h=()=>$k(e.networkMode)&&e.canRun(),g=C=>{s()||(n?.(),i.resolve(C))},m=C=>{s()||(n?.(),i.reject(C))},v=()=>new Promise(C=>{n=b=>{(s()||d())&&C(b)},e.onPause?.()}).then(()=>{n=void 0,s()||e.onContinue?.()}),w=()=>{if(s())return;let C;const b=r===0?e.initialPromise:void 0;try{C=b??e.fn()}catch(x){C=Promise.reject(x)}Promise.resolve(C).then(g).catch(x=>{if(s())return;const R=e.retry??(wm?0:3),E=e.retryDelay??zH,A=typeof E=="function"?E(r,x):E,D=R===!0||typeof R=="number"&&r<R||typeof R=="function"&&R(r,x);if(t||!D){m(x);return}r++,e.onFail?.(r,x),_H(A).then(()=>d()?void 0:v()).then(()=>{t?m(x):w()})})};return{promise:i,status:()=>i.status,cancel:o,continue:()=>(n?.(),i),cancelRetry:a,continueRetry:u,canStart:h,start:()=>(h()?w():v().then(w),i)}}var Yk=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),AH(this.gcTime)&&(this.#e=eb.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(wm?1/0:300*1e3))}clearGcTimeout(){this.#e&&(eb.clearTimeout(this.#e),this.#e=void 0)}},WH=class extends Yk{#e;#t;#r;#i;#n;#o;#a;constructor(e){super(),this.#a=!1,this.#o=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#i=e.client,this.#r=this.#i.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=QT(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#n?.promise}setOptions(e){if(this.options={...this.#o,...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const t=QT(this.options);t.data!==void 0&&(this.setState(XT(t.data,t.dataUpdatedAt)),this.#e=t)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#r.remove(this)}setData(e,t){const r=LH(this.state.data,e,this.options);return this.#s({data:r,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),r}setState(e,t){this.#s({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#n?.promise;return this.#n?.cancel(e),t?t.then(vs).catch(vs):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>PH(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===pS||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>tb(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!kH(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(t=>t.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#n?.continue()}onOnline(){this.observers.find(t=>t.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#n?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(this.#n&&(this.#a?this.#n.cancel({revert:!0}):this.#n.cancelRetry()),this.scheduleGc()),this.#r.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}async fetch(e,t){if(this.state.fetchStatus!=="idle"&&this.#n?.status()!=="rejected"){if(this.state.data!==void 0&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#n)return this.#n.continueRetry(),this.#n.promise}if(e&&this.setOptions(e),!this.options.queryFn){const a=this.observers.find(u=>u.options.queryFn);a&&this.setOptions(a.options)}const r=new AbortController,n=a=>{Object.defineProperty(a,"signal",{enumerable:!0,get:()=>(this.#a=!0,r.signal)})},i=()=>{const a=Wk(this.options,t),d=(()=>{const h={client:this.#i,queryKey:this.queryKey,meta:this.meta};return n(h),h})();return this.#a=!1,this.options.persister?this.options.persister(a,d,this):a(d)},o=(()=>{const a={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:i};return n(a),a})();this.options.behavior?.onFetch(o,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==o.fetchOptions?.meta)&&this.#s({type:"fetch",meta:o.fetchOptions?.meta}),this.#n=jk({initialPromise:t?.initialPromise,fn:o.fetchFn,onCancel:a=>{a instanceof nb&&a.revert&&this.setState({...this.#t,fetchStatus:"idle"}),r.abort()},onFail:(a,u)=>{this.#s({type:"failed",failureCount:a,error:u})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0});try{const a=await this.#n.start();if(a===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(a),this.#r.config.onSuccess?.(a,this),this.#r.config.onSettled?.(a,this.state.error,this),a}catch(a){if(a instanceof nb){if(a.silent)return this.#n.promise;if(a.revert){if(this.state.data===void 0)throw a;return this.state.data}}throw this.#s({type:"error",error:a}),this.#r.config.onError?.(a,this),this.#r.config.onSettled?.(this.state.data,a,this),a}finally{this.scheduleGc()}}#s(e){const t=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...UH(r.data,this.options),fetchMeta:e.meta??null};case"success":const n={...r,...XT(e.data,e.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=e.manual?n:void 0,n;case"error":const i=e.error;return{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=t(this.state),Vn.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),this.#r.notify({query:this,type:"updated",action:e})})}};function UH(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:$k(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function XT(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function QT(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}function ZT(e){return{onFetch:(t,r)=>{const n=t.options,i=t.fetchOptions?.meta?.fetchMore?.direction,s=t.state.data?.pages||[],o=t.state.data?.pageParams||[];let a={pages:[],pageParams:[]},u=0;const d=async()=>{let h=!1;const g=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(t.signal.aborted?h=!0:t.signal.addEventListener("abort",()=>{h=!0}),t.signal)})},m=Wk(t.options,t.fetchOptions),v=async(w,C,b)=>{if(h)return Promise.reject();if(C==null&&w.pages.length)return Promise.resolve(w);const R=(()=>{const M={client:t.client,queryKey:t.queryKey,pageParam:C,direction:b?"backward":"forward",meta:t.options.meta};return g(M),M})(),E=await m(R),{maxPages:A}=t.options,D=b?OH:IH;return{pages:D(w.pages,E,A),pageParams:D(w.pageParams,C,A)}};if(i&&s.length){const w=i==="backward",C=w?$H:JT,b={pages:s,pageParams:o},x=C(n,b);a=await v(b,x,w)}else{const w=e??s.length;do{const C=u===0?o[0]??n.initialPageParam:JT(n,a);if(u>0&&C==null)break;a=await v(a,C),u++}while(u<w)}return a};t.options.persister?t.fetchFn=()=>t.options.persister?.(d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r):t.fetchFn=d}}}function JT(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function $H(e,{pages:t,pageParams:r}){return t.length>0?e.getPreviousPageParam?.(t[0],t,r[0],r):void 0}var jH=class extends Yk{#e;#t;#r;#i;constructor(e){super(),this.#e=e.client,this.mutationId=e.mutationId,this.#r=e.mutationCache,this.#t=[],this.state=e.state||YH(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#t.includes(e)||(this.#t.push(e),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#t=this.#t.filter(t=>t!==e),this.scheduleGc(),this.#r.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#r.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(e){const t=()=>{this.#n({type:"continue"})},r={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#i=jk({fn:()=>this.options.mutationFn?this.options.mutationFn(e,r):Promise.reject(new Error("No mutationFn found")),onFail:(s,o)=>{this.#n({type:"failed",failureCount:s,error:o})},onPause:()=>{this.#n({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#r.canRun(this)});const n=this.state.status==="pending",i=!this.#i.canStart();try{if(n)t();else{this.#n({type:"pending",variables:e,isPaused:i}),await this.#r.config.onMutate?.(e,this,r);const o=await this.options.onMutate?.(e,r);o!==this.state.context&&this.#n({type:"pending",context:o,variables:e,isPaused:i})}const s=await this.#i.start();return await this.#r.config.onSuccess?.(s,e,this.state.context,this,r),await this.options.onSuccess?.(s,e,this.state.context,r),await this.#r.config.onSettled?.(s,null,this.state.variables,this.state.context,this,r),await this.options.onSettled?.(s,null,e,this.state.context,r),this.#n({type:"success",data:s}),s}catch(s){try{throw await this.#r.config.onError?.(s,e,this.state.context,this,r),await this.options.onError?.(s,e,this.state.context,r),await this.#r.config.onSettled?.(void 0,s,this.state.variables,this.state.context,this,r),await this.options.onSettled?.(void 0,s,e,this.state.context,r),s}finally{this.#n({type:"error",error:s})}}finally{this.#r.runNext(this)}}#n(e){const t=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),Vn.batch(()=>{this.#t.forEach(r=>{r.onMutationUpdate(e)}),this.#r.notify({mutation:this,type:"updated",action:e})})}};function YH(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var KH=class extends vm{constructor(e={}){super(),this.config=e,this.#e=new Set,this.#t=new Map,this.#r=0}#e;#t;#r;build(e,t,r){const n=new jH({client:e,mutationCache:this,mutationId:++this.#r,options:e.defaultMutationOptions(t),state:r});return this.add(n),n}add(e){this.#e.add(e);const t=wp(e);if(typeof t=="string"){const r=this.#t.get(t);r?r.push(e):this.#t.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#e.delete(e)){const t=wp(e);if(typeof t=="string"){const r=this.#t.get(t);if(r)if(r.length>1){const n=r.indexOf(e);n!==-1&&r.splice(n,1)}else r[0]===e&&this.#t.delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=wp(e);if(typeof t=="string"){const n=this.#t.get(t)?.find(i=>i.state.status==="pending");return!n||n===e}else return!0}runNext(e){const t=wp(e);return typeof t=="string"?this.#t.get(t)?.find(n=>n!==e&&n.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Vn.batch(()=>{this.#e.forEach(e=>{this.notify({type:"removed",mutation:e})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(e){const t={exact:!0,...e};return this.getAll().find(r=>YT(t,r))}findAll(e={}){return this.getAll().filter(t=>YT(e,t))}notify(e){Vn.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return Vn.batch(()=>Promise.all(e.map(t=>t.continue().catch(vs))))}};function wp(e){return e.options.scope?.id}var qH=class extends vm{constructor(e={}){super(),this.config=e,this.#e=new Map}#e;build(e,t,r){const n=t.queryKey,i=t.queryHash??gS(n,t);let s=this.get(i);return s||(s=new WH({client:e,queryKey:n,queryHash:i,options:e.defaultQueryOptions(t),state:r,defaultOptions:e.getQueryDefaults(n)}),this.add(s)),s}add(e){this.#e.has(e.queryHash)||(this.#e.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=this.#e.get(e.queryHash);t&&(e.destroy(),t===e&&this.#e.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Vn.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return this.#e.get(e)}getAll(){return[...this.#e.values()]}find(e){const t={exact:!0,...e};return this.getAll().find(r=>jT(t,r))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(r=>jT(e,r)):t}notify(e){Vn.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){Vn.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Vn.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},XH=class{#e;#t;#r;#i;#n;#o;#a;#s;constructor(e={}){this.#e=e.queryCache||new qH,this.#t=e.mutationCache||new KH,this.#r=e.defaultOptions||{},this.#i=new Map,this.#n=new Map,this.#o=0}mount(){this.#o++,this.#o===1&&(this.#a=Uk.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=v0.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#o--,this.#o===0&&(this.#a?.(),this.#a=void 0,this.#s?.(),this.#s=void 0)}isFetching(e){return this.#e.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#t.findAll({...e,status:"pending"}).length}getQueryData(e){const t=this.defaultQueryOptions({queryKey:e});return this.#e.get(t.queryHash)?.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=this.#e.build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(tb(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return this.#e.findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),s=this.#e.get(n.queryHash)?.state.data,o=DH(t,s);if(o!==void 0)return this.#e.build(this,n).setData(o,{...r,manual:!0})}setQueriesData(e,t,r){return Vn.batch(()=>this.#e.findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){const t=this.defaultQueryOptions({queryKey:e});return this.#e.get(t.queryHash)?.state}removeQueries(e){const t=this.#e;Vn.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=this.#e;return Vn.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=Vn.batch(()=>this.#e.findAll(e).map(i=>i.cancel(r)));return Promise.all(n).then(vs).catch(vs)}invalidateQueries(e,t={}){return Vn.batch(()=>(this.#e.findAll(e).forEach(r=>{r.invalidate()}),e?.refetchType==="none"?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=Vn.batch(()=>this.#e.findAll(e).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let s=i.fetch(void 0,r);return r.throwOnError||(s=s.catch(vs)),i.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(n).then(vs)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=this.#e.build(this,t);return r.isStaleByTime(tb(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(vs).catch(vs)}fetchInfiniteQuery(e){return e.behavior=ZT(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(vs).catch(vs)}ensureInfiniteQueryData(e){return e.behavior=ZT(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return v0.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#r}setDefaultOptions(e){this.#r=e}setQueryDefaults(e,t){this.#i.set(Zh(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...this.#i.values()],r={};return t.forEach(n=>{Jh(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){this.#n.set(Zh(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...this.#n.values()],r={};return t.forEach(n=>{Jh(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...this.#r.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=gS(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===pS&&(t.enabled=!1),t}defaultMutationOptions(e){return e?._defaulted?e:{...this.#r.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},QH=T.createContext(void 0),ZH=({client:e,children:t})=>(T.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),Z.jsx(QH.Provider,{value:e,children:t})),js=function(){return js=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},js.apply(this,arguments)};function Kk(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function JH(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}var Xp="right-scroll-bar-position",Qp="width-before-scroll-bar",e5="with-scroll-bars-hidden",t5="--removed-body-scroll-bar-size";function WC(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function r5(e,t){var r=T.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var i=r.value;i!==n&&(r.value=n,r.callback(n,i))}}}})[0];return r.callback=t,r.facade}var n5=typeof window<"u"?T.useLayoutEffect:T.useEffect,eF=new WeakMap;function i5(e,t){var r=r5(null,function(n){return e.forEach(function(i){return WC(i,n)})});return n5(function(){var n=eF.get(r);if(n){var i=new Set(n),s=new Set(e),o=r.current;i.forEach(function(a){s.has(a)||WC(a,null)}),s.forEach(function(a){i.has(a)||WC(a,o)})}eF.set(r,e)},[e]),r}function s5(e){return e}function o5(e,t){t===void 0&&(t=s5);var r=[],n=!1,i={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(s){var o=t(s,n);return r.push(o),function(){r=r.filter(function(a){return a!==o})}},assignSyncMedium:function(s){for(n=!0;r.length;){var o=r;r=[],o.forEach(s)}r={push:function(a){return s(a)},filter:function(){return r}}},assignMedium:function(s){n=!0;var o=[];if(r.length){var a=r;r=[],a.forEach(s),o=r}var u=function(){var h=o;o=[],h.forEach(s)},d=function(){return Promise.resolve().then(u)};d(),r={push:function(h){o.push(h),d()},filter:function(h){return o=o.filter(h),r}}}};return i}function a5(e){e===void 0&&(e={});var t=o5(null);return t.options=js({async:!0,ssr:!1},e),t}var qk=function(e){var t=e.sideCar,r=Kk(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return T.createElement(n,js({},r))};qk.isSideCarExport=!0;function l5(e,t){return e.useMedium(t),qk}var Xk=a5(),UC=function(){},Cm=T.forwardRef(function(e,t){var r=T.useRef(null),n=T.useState({onScrollCapture:UC,onWheelCapture:UC,onTouchMoveCapture:UC}),i=n[0],s=n[1],o=e.forwardProps,a=e.children,u=e.className,d=e.removeScrollBar,h=e.enabled,g=e.shards,m=e.sideCar,v=e.noRelative,w=e.noIsolation,C=e.inert,b=e.allowPinchZoom,x=e.as,R=x===void 0?"div":x,E=e.gapMode,A=Kk(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),D=m,M=i5([r,t]),F=js(js({},A),i);return T.createElement(T.Fragment,null,h&&T.createElement(D,{sideCar:Xk,removeScrollBar:d,shards:g,noRelative:v,noIsolation:w,inert:C,setCallbacks:s,allowPinchZoom:!!b,lockRef:r,gapMode:E}),o?T.cloneElement(T.Children.only(a),js(js({},F),{ref:M})):T.createElement(R,js({},F,{className:u,ref:M}),a))});Cm.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Cm.classNames={fullWidth:Qp,zeroRight:Xp};var c5=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function u5(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=c5();return t&&e.setAttribute("nonce",t),e}function d5(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function h5(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var f5=function(){var e=0,t=null;return{add:function(r){e==0&&(t=u5())&&(d5(t,r),h5(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},g5=function(){var e=f5();return function(t,r){T.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},Qk=function(){var e=g5(),t=function(r){var n=r.styles,i=r.dynamic;return e(n,i),null};return t},p5={left:0,top:0,right:0,gap:0},$C=function(e){return parseInt(e||"",10)||0},m5=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[$C(r),$C(n),$C(i)]},v5=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return p5;var t=m5(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},w5=Qk(),Fu="data-scroll-locked",C5=function(e,t,r,n){var i=e.left,s=e.top,o=e.right,a=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(e5,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(a,"px ").concat(n,`;
  }
  body[`).concat(Fu,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(a,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Xp,` {
    right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat(Qp,` {
    margin-right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat(Xp," .").concat(Xp,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Qp," .").concat(Qp,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Fu,`] {
    `).concat(t5,": ").concat(a,`px;
  }
`)},tF=function(){var e=parseInt(document.body.getAttribute(Fu)||"0",10);return isFinite(e)?e:0},y5=function(){T.useEffect(function(){return document.body.setAttribute(Fu,(tF()+1).toString()),function(){var e=tF()-1;e<=0?document.body.removeAttribute(Fu):document.body.setAttribute(Fu,e.toString())}},[])},b5=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,i=n===void 0?"margin":n;y5();var s=T.useMemo(function(){return v5(i)},[i]);return T.createElement(w5,{styles:C5(s,!t,i,r?"":"!important")})},ib=!1;if(typeof window<"u")try{var Cp=Object.defineProperty({},"passive",{get:function(){return ib=!0,!0}});window.addEventListener("test",Cp,Cp),window.removeEventListener("test",Cp,Cp)}catch{ib=!1}var lu=ib?{passive:!1}:!1,S5=function(e){return e.tagName==="TEXTAREA"},Zk=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!S5(e)&&r[t]==="visible")},x5=function(e){return Zk(e,"overflowY")},E5=function(e){return Zk(e,"overflowX")},rF=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var i=Jk(e,n);if(i){var s=eP(e,n),o=s[1],a=s[2];if(o>a)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},R5=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},T5=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},Jk=function(e,t){return e==="v"?x5(t):E5(t)},eP=function(e,t){return e==="v"?R5(t):T5(t)},F5=function(e,t){return e==="h"&&t==="rtl"?-1:1},D5=function(e,t,r,n,i){var s=F5(e,window.getComputedStyle(t).direction),o=s*n,a=r.target,u=t.contains(a),d=!1,h=o>0,g=0,m=0;do{if(!a)break;var v=eP(e,a),w=v[0],C=v[1],b=v[2],x=C-b-s*w;(w||x)&&Jk(e,a)&&(g+=x,m+=w);var R=a.parentNode;a=R&&R.nodeType===Node.DOCUMENT_FRAGMENT_NODE?R.host:R}while(!u&&a!==document.body||u&&(t.contains(a)||t===a));return(h&&Math.abs(g)<1||!h&&Math.abs(m)<1)&&(d=!0),d},yp=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},nF=function(e){return[e.deltaX,e.deltaY]},iF=function(e){return e&&"current"in e?e.current:e},A5=function(e,t){return e[0]===t[0]&&e[1]===t[1]},k5=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},P5=0,cu=[];function M5(e){var t=T.useRef([]),r=T.useRef([0,0]),n=T.useRef(),i=T.useState(P5++)[0],s=T.useState(Qk)[0],o=T.useRef(e);T.useEffect(function(){o.current=e},[e]),T.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var C=JH([e.lockRef.current],(e.shards||[]).map(iF),!0).filter(Boolean);return C.forEach(function(b){return b.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),C.forEach(function(b){return b.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var a=T.useCallback(function(C,b){if("touches"in C&&C.touches.length===2||C.type==="wheel"&&C.ctrlKey)return!o.current.allowPinchZoom;var x=yp(C),R=r.current,E="deltaX"in C?C.deltaX:R[0]-x[0],A="deltaY"in C?C.deltaY:R[1]-x[1],D,M=C.target,F=Math.abs(E)>Math.abs(A)?"h":"v";if("touches"in C&&F==="h"&&M.type==="range")return!1;var O=rF(F,M);if(!O)return!0;if(O?D=F:(D=F==="v"?"h":"v",O=rF(F,M)),!O)return!1;if(!n.current&&"changedTouches"in C&&(E||A)&&(n.current=D),!D)return!0;var L=n.current||D;return D5(L,b,C,L==="h"?E:A)},[]),u=T.useCallback(function(C){var b=C;if(!(!cu.length||cu[cu.length-1]!==s)){var x="deltaY"in b?nF(b):yp(b),R=t.current.filter(function(D){return D.name===b.type&&(D.target===b.target||b.target===D.shadowParent)&&A5(D.delta,x)})[0];if(R&&R.should){b.cancelable&&b.preventDefault();return}if(!R){var E=(o.current.shards||[]).map(iF).filter(Boolean).filter(function(D){return D.contains(b.target)}),A=E.length>0?a(b,E[0]):!o.current.noIsolation;A&&b.cancelable&&b.preventDefault()}}},[]),d=T.useCallback(function(C,b,x,R){var E={name:C,delta:b,target:x,should:R,shadowParent:_5(x)};t.current.push(E),setTimeout(function(){t.current=t.current.filter(function(A){return A!==E})},1)},[]),h=T.useCallback(function(C){r.current=yp(C),n.current=void 0},[]),g=T.useCallback(function(C){d(C.type,nF(C),C.target,a(C,e.lockRef.current))},[]),m=T.useCallback(function(C){d(C.type,yp(C),C.target,a(C,e.lockRef.current))},[]);T.useEffect(function(){return cu.push(s),e.setCallbacks({onScrollCapture:g,onWheelCapture:g,onTouchMoveCapture:m}),document.addEventListener("wheel",u,lu),document.addEventListener("touchmove",u,lu),document.addEventListener("touchstart",h,lu),function(){cu=cu.filter(function(C){return C!==s}),document.removeEventListener("wheel",u,lu),document.removeEventListener("touchmove",u,lu),document.removeEventListener("touchstart",h,lu)}},[]);var v=e.removeScrollBar,w=e.inert;return T.createElement(T.Fragment,null,w?T.createElement(s,{styles:k5(i)}):null,v?T.createElement(b5,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function _5(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const L5=l5(Xk,M5);var tP=T.forwardRef(function(e,t){return T.createElement(Cm,js({},e,{ref:t,sideCar:L5}))});tP.classNames=Cm.classNames;function Qs(e){return Object.keys(e)}function jC(e){return e&&typeof e=="object"&&!Array.isArray(e)}function mS(e,t){const r={...e},n=t;return jC(e)&&jC(t)&&Object.keys(t).forEach(i=>{jC(n[i])&&i in e?r[i]=mS(r[i],n[i]):r[i]=n[i]}),r}function I5(e){return e.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}function O5(e){return typeof e!="string"||!e.includes("var(--mantine-scale)")?e:e.match(/^calc\((.*?)\)$/)?.[1].split("*")[0].trim()}function N5(e){const t=O5(e);return typeof t=="number"?t:typeof t=="string"?t.includes("calc")||t.includes("var")?t:t.includes("px")?Number(t.replace("px","")):t.includes("rem")?Number(t.replace("rem",""))*16:t.includes("em")?Number(t.replace("em",""))*16:Number(t):NaN}function sF(e){return e==="0rem"?"0rem":`calc(${e} * var(--mantine-scale))`}function rP(e,{shouldScale:t=!1}={}){function r(n){if(n===0||n==="0")return`0${e}`;if(typeof n=="number"){const i=`${n/16}${e}`;return t?sF(i):i}if(typeof n=="string"){if(n===""||n.startsWith("calc(")||n.startsWith("clamp(")||n.includes("rgba("))return n;if(n.includes(","))return n.split(",").map(s=>r(s)).join(",");if(n.includes(" "))return n.split(" ").map(s=>r(s)).join(" ");const i=n.replace("px","");if(!Number.isNaN(Number(i))){const s=`${Number(i)/16}${e}`;return t?sF(s):s}}return n}return r}const Le=rP("rem",{shouldScale:!0}),oF=rP("em");function vS(e){return Object.keys(e).reduce((t,r)=>(e[r]!==void 0&&(t[r]=e[r]),t),{})}function nP(e){if(typeof e=="number")return!0;if(typeof e=="string"){if(e.startsWith("calc(")||e.startsWith("var(")||e.includes(" ")&&e.trim()!=="")return!0;const t=/^[+-]?[0-9]+(\.[0-9]+)?(px|em|rem|ex|ch|lh|rlh|vw|vh|vmin|vmax|vb|vi|svw|svh|lvw|lvh|dvw|dvh|cm|mm|in|pt|pc|q|cqw|cqh|cqi|cqb|cqmin|cqmax|%)?$/;return e.trim().split(/\s+/).every(n=>t.test(n))}return!1}function _f(e){return Array.isArray(e)||e===null?!1:typeof e=="object"?e.type!==T.Fragment:!1}function ld(e){const t=T.createContext(null);return[({children:i,value:s})=>Z.jsx(t.Provider,{value:s,children:i}),()=>{const i=T.useContext(t);if(i===null)throw new Error(e);return i}]}function wS(e=null){const t=T.createContext(e);return[({children:i,value:s})=>Z.jsx(t.Provider,{value:s,children:i}),()=>T.useContext(t)]}const B5={app:100,modal:200,popover:300,overlay:400,max:9999};function hc(e){return B5[e]}const H5=()=>{};function G5(e,t={active:!0}){return typeof e!="function"||!t.active?t.onKeyDown||H5:r=>{r.key==="Escape"&&(e(r),t.onTrigger?.())}}function $n(e,t="size",r=!0){if(e!==void 0)return nP(e)?r?Le(e):e:`var(--${t}-${e})`}function iP(e){return $n(e,"mantine-spacing")}function cd(e){return e===void 0?"var(--mantine-radius-default)":$n(e,"mantine-radius")}function si(e){return $n(e,"mantine-font-size")}function CS(e){if(e)return $n(e,"mantine-shadow",!1)}function V5(e,t,r){return t===void 0&&r===void 0?e:t!==void 0&&r===void 0?Math.max(e,t):Math.min(t===void 0&&r!==void 0?e:Math.max(e,t),r)}function z5(e="mantine-"){return`${e}${Math.random().toString(36).slice(2,11)}`}function Ml(e){const t=T.useRef(e);return T.useEffect(()=>{t.current=e}),T.useMemo(()=>((...r)=>t.current?.(...r)),[])}function ym(e,t){const{delay:r,flushOnUnmount:n,leading:i}=typeof t=="number"?{delay:t,flushOnUnmount:!1,leading:!1}:t,s=Ml(e),o=T.useRef(0),a=T.useMemo(()=>{const u=Object.assign((...d)=>{window.clearTimeout(o.current);const h=u._isFirstCall;u._isFirstCall=!1;function g(){window.clearTimeout(o.current),o.current=0,u._isFirstCall=!0}if(i&&h){s(...d);const w=()=>{g()},C=()=>{o.current!==0&&(g(),s(...d))},b=()=>{g()};u.flush=C,u.cancel=b,o.current=window.setTimeout(w,r);return}if(i&&!h){const w=()=>{o.current!==0&&(g(),s(...d))},C=()=>{g()};u.flush=w,u.cancel=C;const b=()=>{g()};o.current=window.setTimeout(b,r);return}const m=()=>{o.current!==0&&(g(),s(...d))},v=()=>{g()};u.flush=m,u.cancel=v,o.current=window.setTimeout(m,r)},{flush:()=>{},cancel:()=>{},_isFirstCall:!0});return u},[s,r,i]);return T.useEffect(()=>()=>{n?a.flush():a.cancel()},[a,n]),a}const W5=["mousedown","touchstart"];function U5(e,t,r){const n=T.useRef(null),i=t||W5;return T.useEffect(()=>{const s=o=>{const{target:a}=o??{};if(Array.isArray(r)){const u=!document.body.contains(a)&&a?.tagName!=="HTML";r.every(h=>!!h&&!o.composedPath().includes(h))&&!u&&e(o)}else n.current&&!n.current.contains(a)&&e(o)};return i.forEach(o=>document.addEventListener(o,s)),()=>{i.forEach(o=>document.removeEventListener(o,s))}},[n,e,r]),n}function $5(e,t){try{return e.addEventListener("change",t),()=>e.removeEventListener("change",t)}catch{return e.addListener(t),()=>e.removeListener(t)}}function j5(e,t){return typeof window<"u"&&"matchMedia"in window?window.matchMedia(e).matches:!1}function Y5(e,t,{getInitialValueInEffect:r}={getInitialValueInEffect:!0}){const[n,i]=T.useState(r?t:j5(e));return T.useEffect(()=>{try{const s=window.matchMedia(e);return i(s.matches),$5(s,o=>i(o.matches))}catch{return}},[e]),n||!1}const Lf=typeof document<"u"?T.useLayoutEffect:T.useEffect;function _h(e,t){const r=T.useRef(!1);T.useEffect(()=>()=>{r.current=!1},[]),T.useEffect(()=>{if(r.current)return e();r.current=!0},t)}function sP({opened:e,shouldReturnFocus:t=!0}){const r=T.useRef(null),n=()=>{r.current&&"focus"in r.current&&typeof r.current.focus=="function"&&r.current?.focus({preventScroll:!0})};return _h(()=>{let i=-1;const s=o=>{o.key==="Tab"&&window.clearTimeout(i)};return document.addEventListener("keydown",s),e?r.current=document.activeElement:t&&(i=window.setTimeout(n,10)),()=>{window.clearTimeout(i),document.removeEventListener("keydown",s)}},[e,t]),n}const K5=/input|select|textarea|button|object/,oP="a, input, select, textarea, button, object, [tabindex]";function q5(e){return e.style.display==="none"}function X5(e){if(e.getAttribute("aria-hidden")||e.getAttribute("hidden")||e.getAttribute("type")==="hidden")return!1;let r=e;for(;r&&!(r===document.body||r.nodeType===11);){if(q5(r))return!1;r=r.parentNode}return!0}function aP(e){let t=e.getAttribute("tabindex");return t===null&&(t=void 0),parseInt(t,10)}function sb(e){const t=e.nodeName.toLowerCase(),r=!Number.isNaN(aP(e));return(K5.test(t)&&!e.disabled||e instanceof HTMLAnchorElement&&e.href||r)&&X5(e)}function lP(e){const t=aP(e);return(Number.isNaN(t)||t>=0)&&sb(e)}function Q5(e){return Array.from(e.querySelectorAll(oP)).filter(lP)}function Z5(e,t){const r=Q5(e);if(!r.length){t.preventDefault();return}const n=r[t.shiftKey?0:r.length-1],i=e.getRootNode();let s=n===i.activeElement||e===i.activeElement;const o=i.activeElement;if(o.tagName==="INPUT"&&o.getAttribute("type")==="radio"&&(s=r.filter(h=>h.getAttribute("type")==="radio"&&h.getAttribute("name")===o.getAttribute("name")).includes(n)),!s)return;t.preventDefault();const u=r[t.shiftKey?r.length-1:0];u&&u.focus()}function J5(e=!0){const t=T.useRef(null),r=i=>{let s=i.querySelector("[data-autofocus]");if(!s){const o=Array.from(i.querySelectorAll(oP));s=o.find(lP)||o.find(sb)||null,!s&&sb(i)&&(s=i)}s&&s.focus({preventScroll:!0})},n=T.useCallback(i=>{e&&i!==null&&t.current!==i&&(i?(setTimeout(()=>{i.getRootNode()&&r(i)}),t.current=i):t.current=null)},[e]);return T.useEffect(()=>{if(!e)return;t.current&&setTimeout(()=>r(t.current));const i=s=>{s.key==="Tab"&&t.current&&Z5(t.current,s)};return document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i)},[e]),n}const eG=Oe.useId||(()=>{});function tG(){const e=eG();return e?`mantine-${e.replace(/:/g,"")}`:""}function ud(e){const t=tG(),[r,n]=T.useState(t);return Lf(()=>{n(z5())},[]),typeof e=="string"?e:typeof window>"u"?t:r}function rG(e,t,r){T.useEffect(()=>(window.addEventListener(e,t,r),()=>window.removeEventListener(e,t,r)),[e,t])}function ob(e,t){if(typeof e=="function")return e(t);typeof e=="object"&&e!==null&&"current"in e&&(e.current=t)}function nG(...e){const t=new Map;return r=>{if(e.forEach(n=>{const i=ob(n,r);i&&t.set(n,i)}),t.size>0)return()=>{e.forEach(n=>{const i=t.get(n);i&&typeof i=="function"?i():ob(n,null)}),t.clear()}}}function as(...e){return T.useCallback(nG(...e),e)}function ju({value:e,defaultValue:t,finalValue:r,onChange:n=()=>{}}){const[i,s]=T.useState(t!==void 0?t:r),o=(a,...u)=>{s(a),n?.(a,...u)};return e!==void 0?[e,n,!0]:[i,o,!1]}function cP(e,t){return Y5("(prefers-reduced-motion: reduce)",e,t)}function iG(e=!1,t={}){const[r,n]=T.useState(e),i=T.useCallback(()=>{n(a=>a||(t.onOpen?.(),!0))},[t.onOpen]),s=T.useCallback(()=>{n(a=>a&&(t.onClose?.(),!1))},[t.onClose]),o=T.useCallback(()=>{r?s():i()},[s,i,r]);return[r,{open:i,close:s,toggle:o}]}function sG(e){const t=T.useRef(void 0);return T.useEffect(()=>{t.current=e},[e]),t.current}function uP(e){const t=Oe.version;return typeof Oe.version!="string"||t.startsWith("18.")?e?.ref:e?.props?.ref}function dP(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=dP(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Di(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=dP(e))&&(n&&(n+=" "),n+=t);return n}const oG={};function aG(e){const t={};return e.forEach(r=>{Object.entries(r).forEach(([n,i])=>{t[n]?t[n]=Di(t[n],i):t[n]=i})}),t}function bm({theme:e,classNames:t,props:r,stylesCtx:n}){const s=(Array.isArray(t)?t:[t]).map(o=>typeof o=="function"?o(e,r,n):o||oG);return aG(s)}function w0({theme:e,styles:t,props:r,stylesCtx:n}){return(Array.isArray(t)?t:[t]).reduce((s,o)=>typeof o=="function"?{...s,...o(e,r,n)}:{...s,...o},{})}const hP=T.createContext(null);function Ja(){const e=T.useContext(hP);if(!e)throw new Error("[@mantine/core] MantineProvider was not found in tree");return e}function lG(){return Ja().cssVariablesResolver}function cG(){return Ja().classNamesPrefix}function yS(){return Ja().getStyleNonce}function uG(){return Ja().withStaticClasses}function dG(){return Ja().headless}function hG(){return Ja().stylesTransform?.sx}function fG(){return Ja().stylesTransform?.styles}function Sm(){return Ja().env||"default"}function gG(e){return/^#?([0-9A-F]{3}){1,2}([0-9A-F]{2})?$/i.test(e)}function pG(e){let t=e.replace("#","");if(t.length===3){const o=t.split("");t=[o[0],o[0],o[1],o[1],o[2],o[2]].join("")}if(t.length===8){const o=parseInt(t.slice(6,8),16)/255;return{r:parseInt(t.slice(0,2),16),g:parseInt(t.slice(2,4),16),b:parseInt(t.slice(4,6),16),a:o}}const r=parseInt(t,16),n=r>>16&255,i=r>>8&255,s=r&255;return{r:n,g:i,b:s,a:1}}function mG(e){const[t,r,n,i]=e.replace(/[^0-9,./]/g,"").split(/[/,]/).map(Number);return{r:t,g:r,b:n,a:i===void 0?1:i}}function vG(e){const t=/^hsla?\(\s*(\d+)\s*,\s*(\d+%)\s*,\s*(\d+%)\s*(,\s*(0?\.\d+|\d+(\.\d+)?))?\s*\)$/i,r=e.match(t);if(!r)return{r:0,g:0,b:0,a:1};const n=parseInt(r[1],10),i=parseInt(r[2],10)/100,s=parseInt(r[3],10)/100,o=r[5]?parseFloat(r[5]):void 0,a=(1-Math.abs(2*s-1))*i,u=n/60,d=a*(1-Math.abs(u%2-1)),h=s-a/2;let g,m,v;return u>=0&&u<1?(g=a,m=d,v=0):u>=1&&u<2?(g=d,m=a,v=0):u>=2&&u<3?(g=0,m=a,v=d):u>=3&&u<4?(g=0,m=d,v=a):u>=4&&u<5?(g=d,m=0,v=a):(g=a,m=0,v=d),{r:Math.round((g+h)*255),g:Math.round((m+h)*255),b:Math.round((v+h)*255),a:o||1}}function bS(e){return gG(e)?pG(e):e.startsWith("rgb")?mG(e):e.startsWith("hsl")?vG(e):{r:0,g:0,b:0,a:1}}function bp(e,t){if(e.startsWith("var("))return`color-mix(in srgb, ${e}, black ${t*100}%)`;const{r,g:n,b:i,a:s}=bS(e),o=1-t,a=u=>Math.round(u*o);return`rgba(${a(r)}, ${a(n)}, ${a(i)}, ${s})`}function ef(e,t){return typeof e.primaryShade=="number"?e.primaryShade:t==="dark"?e.primaryShade.dark:e.primaryShade.light}function YC(e){return e<=.03928?e/12.92:((e+.055)/1.055)**2.4}function wG(e){const t=e.match(/oklch\((.*?)%\s/);return t?parseFloat(t[1]):null}function CG(e){if(e.startsWith("oklch("))return(wG(e)||0)/100;const{r:t,g:r,b:n}=bS(e),i=t/255,s=r/255,o=n/255,a=YC(i),u=YC(s),d=YC(o);return .2126*a+.7152*u+.0722*d}function wh(e,t=.179){return e.startsWith("var(")?!1:CG(e)>t}function If({color:e,theme:t,colorScheme:r}){if(typeof e!="string")throw new Error(`[@mantine/core] Failed to parse color. Expected color to be a string, instead got ${typeof e}`);if(e==="bright")return{color:e,value:r==="dark"?t.white:t.black,shade:void 0,isThemeColor:!1,isLight:wh(r==="dark"?t.white:t.black,t.luminanceThreshold),variable:"--mantine-color-bright"};if(e==="dimmed")return{color:e,value:r==="dark"?t.colors.dark[2]:t.colors.gray[7],shade:void 0,isThemeColor:!1,isLight:wh(r==="dark"?t.colors.dark[2]:t.colors.gray[6],t.luminanceThreshold),variable:"--mantine-color-dimmed"};if(e==="white"||e==="black")return{color:e,value:e==="white"?t.white:t.black,shade:void 0,isThemeColor:!1,isLight:wh(e==="white"?t.white:t.black,t.luminanceThreshold),variable:`--mantine-color-${e}`};const[n,i]=e.split("."),s=i?Number(i):void 0,o=n in t.colors;if(o){const a=s!==void 0?t.colors[n][s]:t.colors[n][ef(t,r||"light")];return{color:n,value:a,shade:s,isThemeColor:o,isLight:wh(a,t.luminanceThreshold),variable:i?`--mantine-color-${n}-${s}`:`--mantine-color-${n}-filled`}}return{color:e,value:e,isThemeColor:o,isLight:wh(e,t.luminanceThreshold),shade:s,variable:void 0}}function ab(e,t){const r=If({color:e||t.primaryColor,theme:t});return r.variable?`var(${r.variable})`:e}function aF(e,t){const r={from:e?.from||t.defaultGradient.from,to:e?.to||t.defaultGradient.to,deg:e?.deg??t.defaultGradient.deg??0},n=ab(r.from,t),i=ab(r.to,t);return`linear-gradient(${r.deg}deg, ${n} 0%, ${i} 100%)`}function zs(e,t){if(typeof e!="string"||t>1||t<0)return"rgba(0, 0, 0, 1)";if(e.startsWith("var(")){const s=(1-t)*100;return`color-mix(in srgb, ${e}, transparent ${s}%)`}if(e.startsWith("oklch"))return e.includes("/")?e.replace(/\/\s*[\d.]+\s*\)/,`/ ${t})`):e.replace(")",` / ${t})`);const{r,g:n,b:i}=bS(e);return`rgba(${r}, ${n}, ${i}, ${t})`}const uu=zs,yG=({color:e,theme:t,variant:r,gradient:n,autoContrast:i})=>{const s=If({color:e,theme:t}),o=typeof i=="boolean"?i:t.autoContrast;if(r==="none")return{background:"transparent",hover:"transparent",color:"inherit",border:"none"};if(r==="filled"){const a=o&&s.isLight?"var(--mantine-color-black)":"var(--mantine-color-white)";return s.isThemeColor?s.shade===void 0?{background:`var(--mantine-color-${e}-filled)`,hover:`var(--mantine-color-${e}-filled-hover)`,color:a,border:`${Le(1)} solid transparent`}:{background:`var(--mantine-color-${s.color}-${s.shade})`,hover:`var(--mantine-color-${s.color}-${s.shade===9?8:s.shade+1})`,color:a,border:`${Le(1)} solid transparent`}:{background:e,hover:bp(e,.1),color:a,border:`${Le(1)} solid transparent`}}if(r==="light"){if(s.isThemeColor){if(s.shade===void 0)return{background:`var(--mantine-color-${e}-light)`,hover:`var(--mantine-color-${e}-light-hover)`,color:`var(--mantine-color-${e}-light-color)`,border:`${Le(1)} solid transparent`};const a=t.colors[s.color][s.shade];return{background:zs(a,.1),hover:zs(a,.12),color:`var(--mantine-color-${s.color}-${Math.min(s.shade,6)})`,border:`${Le(1)} solid transparent`}}return{background:zs(e,.1),hover:zs(e,.12),color:e,border:`${Le(1)} solid transparent`}}if(r==="outline")return s.isThemeColor?s.shade===void 0?{background:"transparent",hover:`var(--mantine-color-${e}-outline-hover)`,color:`var(--mantine-color-${e}-outline)`,border:`${Le(1)} solid var(--mantine-color-${e}-outline)`}:{background:"transparent",hover:zs(t.colors[s.color][s.shade],.05),color:`var(--mantine-color-${s.color}-${s.shade})`,border:`${Le(1)} solid var(--mantine-color-${s.color}-${s.shade})`}:{background:"transparent",hover:zs(e,.05),color:e,border:`${Le(1)} solid ${e}`};if(r==="subtle"){if(s.isThemeColor){if(s.shade===void 0)return{background:"transparent",hover:`var(--mantine-color-${e}-light-hover)`,color:`var(--mantine-color-${e}-light-color)`,border:`${Le(1)} solid transparent`};const a=t.colors[s.color][s.shade];return{background:"transparent",hover:zs(a,.12),color:`var(--mantine-color-${s.color}-${Math.min(s.shade,6)})`,border:`${Le(1)} solid transparent`}}return{background:"transparent",hover:zs(e,.12),color:e,border:`${Le(1)} solid transparent`}}return r==="transparent"?s.isThemeColor?s.shade===void 0?{background:"transparent",hover:"transparent",color:`var(--mantine-color-${e}-light-color)`,border:`${Le(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:`var(--mantine-color-${s.color}-${Math.min(s.shade,6)})`,border:`${Le(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:e,border:`${Le(1)} solid transparent`}:r==="white"?s.isThemeColor?s.shade===void 0?{background:"var(--mantine-color-white)",hover:bp(t.white,.01),color:`var(--mantine-color-${e}-filled)`,border:`${Le(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:bp(t.white,.01),color:`var(--mantine-color-${s.color}-${s.shade})`,border:`${Le(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:bp(t.white,.01),color:e,border:`${Le(1)} solid transparent`}:r==="gradient"?{background:aF(n,t),hover:aF(n,t),color:"var(--mantine-color-white)",border:"none"}:r==="default"?{background:"var(--mantine-color-default)",hover:"var(--mantine-color-default-hover)",color:"var(--mantine-color-default-color)",border:`${Le(1)} solid var(--mantine-color-default-border)`}:{}},bG={dark:["#C9C9C9","#b8b8b8","#828282","#696969","#424242","#3b3b3b","#2e2e2e","#242424","#1f1f1f","#141414"],gray:["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],red:["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],pink:["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],grape:["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],violet:["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],indigo:["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],blue:["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],cyan:["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],teal:["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],green:["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],lime:["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],yellow:["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],orange:["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"]},lF="-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji",SS={scale:1,fontSmoothing:!0,focusRing:"auto",white:"#fff",black:"#000",colors:bG,primaryShade:{light:6,dark:8},primaryColor:"blue",variantColorResolver:yG,autoContrast:!1,luminanceThreshold:.3,fontFamily:lF,fontFamilyMonospace:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace",respectReducedMotion:!1,cursorType:"default",defaultGradient:{from:"blue",to:"cyan",deg:45},defaultRadius:"sm",activeClassName:"mantine-active",focusClassName:"",headings:{fontFamily:lF,fontWeight:"700",textWrap:"wrap",sizes:{h1:{fontSize:Le(34),lineHeight:"1.3"},h2:{fontSize:Le(26),lineHeight:"1.35"},h3:{fontSize:Le(22),lineHeight:"1.4"},h4:{fontSize:Le(18),lineHeight:"1.45"},h5:{fontSize:Le(16),lineHeight:"1.5"},h6:{fontSize:Le(14),lineHeight:"1.5"}}},fontSizes:{xs:Le(12),sm:Le(14),md:Le(16),lg:Le(18),xl:Le(20)},lineHeights:{xs:"1.4",sm:"1.45",md:"1.55",lg:"1.6",xl:"1.65"},radius:{xs:Le(2),sm:Le(4),md:Le(8),lg:Le(16),xl:Le(32)},spacing:{xs:Le(10),sm:Le(12),md:Le(16),lg:Le(20),xl:Le(32)},breakpoints:{xs:"36em",sm:"48em",md:"62em",lg:"75em",xl:"88em"},shadows:{xs:`0 ${Le(1)} ${Le(3)} rgba(0, 0, 0, 0.05), 0 ${Le(1)} ${Le(2)} rgba(0, 0, 0, 0.1)`,sm:`0 ${Le(1)} ${Le(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${Le(10)} ${Le(15)} ${Le(-5)}, rgba(0, 0, 0, 0.04) 0 ${Le(7)} ${Le(7)} ${Le(-5)}`,md:`0 ${Le(1)} ${Le(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${Le(20)} ${Le(25)} ${Le(-5)}, rgba(0, 0, 0, 0.04) 0 ${Le(10)} ${Le(10)} ${Le(-5)}`,lg:`0 ${Le(1)} ${Le(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${Le(28)} ${Le(23)} ${Le(-7)}, rgba(0, 0, 0, 0.04) 0 ${Le(12)} ${Le(12)} ${Le(-7)}`,xl:`0 ${Le(1)} ${Le(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${Le(36)} ${Le(28)} ${Le(-7)}, rgba(0, 0, 0, 0.04) 0 ${Le(17)} ${Le(17)} ${Le(-7)}`},other:{},components:{}};function cF(e){return e==="auto"||e==="dark"||e==="light"}function SG({key:e="mantine-color-scheme-value"}={}){let t;return{get:r=>{if(typeof window>"u")return r;try{const n=window.localStorage.getItem(e);return cF(n)?n:r}catch{return r}},set:r=>{try{window.localStorage.setItem(e,r)}catch(n){console.warn("[@mantine/core] Local storage color scheme manager was unable to save color scheme.",n)}},subscribe:r=>{t=n=>{n.storageArea===window.localStorage&&n.key===e&&cF(n.newValue)&&r(n.newValue)},window.addEventListener("storage",t)},unsubscribe:()=>{window.removeEventListener("storage",t)},clear:()=>{window.localStorage.removeItem(e)}}}const xG="[@mantine/core] MantineProvider: Invalid theme.primaryColor, it accepts only key of theme.colors, learn more  https://mantine.dev/theming/colors/#primary-color",uF="[@mantine/core] MantineProvider: Invalid theme.primaryShade, it accepts only 0-9 integers or an object { light: 0-9, dark: 0-9 }";function KC(e){return e<0||e>9?!1:parseInt(e.toString(),10)===e}function dF(e){if(!(e.primaryColor in e.colors))throw new Error(xG);if(typeof e.primaryShade=="object"&&(!KC(e.primaryShade.dark)||!KC(e.primaryShade.light)))throw new Error(uF);if(typeof e.primaryShade=="number"&&!KC(e.primaryShade))throw new Error(uF)}function EG(e,t){if(!t)return dF(e),e;const r=mS(e,t);return t.fontFamily&&!t.headings?.fontFamily&&(r.headings.fontFamily=t.fontFamily),dF(r),r}const xS=T.createContext(null),RG=()=>T.useContext(xS)||SS;function el(){const e=T.useContext(xS);if(!e)throw new Error("@mantine/core: MantineProvider was not found in component tree, make sure you have it in your app");return e}function fP({theme:e,children:t,inherit:r=!0}){const n=RG(),i=T.useMemo(()=>EG(r?n:SS,e),[e,n,r]);return Z.jsx(xS.Provider,{value:i,children:t})}fP.displayName="@mantine/core/MantineThemeProvider";function TG(){const e=el(),t=yS(),r=Qs(e.breakpoints).reduce((n,i)=>{const s=e.breakpoints[i].includes("px"),o=N5(e.breakpoints[i]),a=s?`${o-.1}px`:oF(o-.1),u=s?`${o}px`:oF(o);return`${n}@media (max-width: ${a}) {.mantine-visible-from-${i} {display: none !important;}}@media (min-width: ${u}) {.mantine-hidden-from-${i} {display: none !important;}}`},"");return Z.jsx("style",{"data-mantine-styles":"classes",nonce:t?.(),dangerouslySetInnerHTML:{__html:r}})}function qC(e){return Object.entries(e).map(([t,r])=>`${t}: ${r};`).join("")}function Ch(e,t){return(Array.isArray(e)?e:[e]).reduce((n,i)=>`${i}{${n}}`,t)}function FG(e,t){const r=qC(e.variables),n=r?Ch(t,r):"",i=qC(e.dark),s=qC(e.light),o=i?Ch(t===":host"?`${t}([data-mantine-color-scheme="dark"])`:`${t}[data-mantine-color-scheme="dark"]`,i):"",a=s?Ch(t===":host"?`${t}([data-mantine-color-scheme="light"])`:`${t}[data-mantine-color-scheme="light"]`,s):"";return`${n}

${o}

${a}`}function DG({color:e,theme:t,autoContrast:r}){return t.autoContrast&&If({color:e||t.primaryColor,theme:t}).isLight?"var(--mantine-color-black)":"var(--mantine-color-white)"}function hF(e,t){return DG({color:e.colors[e.primaryColor][ef(e,t)],theme:e,autoContrast:null})}function Sp({theme:e,color:t,colorScheme:r,name:n=t,withColorValues:i=!0}){if(!e.colors[t])return{};if(r==="light"){const a=ef(e,"light"),u={[`--mantine-color-${n}-text`]:`var(--mantine-color-${n}-filled)`,[`--mantine-color-${n}-filled`]:`var(--mantine-color-${n}-${a})`,[`--mantine-color-${n}-filled-hover`]:`var(--mantine-color-${n}-${a===9?8:a+1})`,[`--mantine-color-${n}-light`]:uu(e.colors[t][a],.1),[`--mantine-color-${n}-light-hover`]:uu(e.colors[t][a],.12),[`--mantine-color-${n}-light-color`]:`var(--mantine-color-${n}-${a})`,[`--mantine-color-${n}-outline`]:`var(--mantine-color-${n}-${a})`,[`--mantine-color-${n}-outline-hover`]:uu(e.colors[t][a],.05)};return i?{[`--mantine-color-${n}-0`]:e.colors[t][0],[`--mantine-color-${n}-1`]:e.colors[t][1],[`--mantine-color-${n}-2`]:e.colors[t][2],[`--mantine-color-${n}-3`]:e.colors[t][3],[`--mantine-color-${n}-4`]:e.colors[t][4],[`--mantine-color-${n}-5`]:e.colors[t][5],[`--mantine-color-${n}-6`]:e.colors[t][6],[`--mantine-color-${n}-7`]:e.colors[t][7],[`--mantine-color-${n}-8`]:e.colors[t][8],[`--mantine-color-${n}-9`]:e.colors[t][9],...u}:u}const s=ef(e,"dark"),o={[`--mantine-color-${n}-text`]:`var(--mantine-color-${n}-4)`,[`--mantine-color-${n}-filled`]:`var(--mantine-color-${n}-${s})`,[`--mantine-color-${n}-filled-hover`]:`var(--mantine-color-${n}-${s===9?8:s+1})`,[`--mantine-color-${n}-light`]:uu(e.colors[t][Math.max(0,s-2)],.15),[`--mantine-color-${n}-light-hover`]:uu(e.colors[t][Math.max(0,s-2)],.2),[`--mantine-color-${n}-light-color`]:`var(--mantine-color-${n}-${Math.max(s-5,0)})`,[`--mantine-color-${n}-outline`]:`var(--mantine-color-${n}-${Math.max(s-4,0)})`,[`--mantine-color-${n}-outline-hover`]:uu(e.colors[t][Math.max(s-4,0)],.05)};return i?{[`--mantine-color-${n}-0`]:e.colors[t][0],[`--mantine-color-${n}-1`]:e.colors[t][1],[`--mantine-color-${n}-2`]:e.colors[t][2],[`--mantine-color-${n}-3`]:e.colors[t][3],[`--mantine-color-${n}-4`]:e.colors[t][4],[`--mantine-color-${n}-5`]:e.colors[t][5],[`--mantine-color-${n}-6`]:e.colors[t][6],[`--mantine-color-${n}-7`]:e.colors[t][7],[`--mantine-color-${n}-8`]:e.colors[t][8],[`--mantine-color-${n}-9`]:e.colors[t][9],...o}:o}function AG(e){return!!e&&typeof e=="object"&&"mantine-virtual-color"in e}function du(e,t,r){Qs(t).forEach(n=>Object.assign(e,{[`--mantine-${r}-${n}`]:t[n]}))}const gP=e=>{const t=ef(e,"light"),r=e.defaultRadius in e.radius?e.radius[e.defaultRadius]:Le(e.defaultRadius),n={variables:{"--mantine-z-index-app":"100","--mantine-z-index-modal":"200","--mantine-z-index-popover":"300","--mantine-z-index-overlay":"400","--mantine-z-index-max":"9999","--mantine-scale":e.scale.toString(),"--mantine-cursor-type":e.cursorType,"--mantine-webkit-font-smoothing":e.fontSmoothing?"antialiased":"unset","--mantine-moz-font-smoothing":e.fontSmoothing?"grayscale":"unset","--mantine-color-white":e.white,"--mantine-color-black":e.black,"--mantine-line-height":e.lineHeights.md,"--mantine-font-family":e.fontFamily,"--mantine-font-family-monospace":e.fontFamilyMonospace,"--mantine-font-family-headings":e.headings.fontFamily,"--mantine-heading-font-weight":e.headings.fontWeight,"--mantine-heading-text-wrap":e.headings.textWrap,"--mantine-radius-default":r,"--mantine-primary-color-filled":`var(--mantine-color-${e.primaryColor}-filled)`,"--mantine-primary-color-filled-hover":`var(--mantine-color-${e.primaryColor}-filled-hover)`,"--mantine-primary-color-light":`var(--mantine-color-${e.primaryColor}-light)`,"--mantine-primary-color-light-hover":`var(--mantine-color-${e.primaryColor}-light-hover)`,"--mantine-primary-color-light-color":`var(--mantine-color-${e.primaryColor}-light-color)`},light:{"--mantine-color-scheme":"light","--mantine-primary-color-contrast":hF(e,"light"),"--mantine-color-bright":"var(--mantine-color-black)","--mantine-color-text":e.black,"--mantine-color-body":e.white,"--mantine-color-error":"var(--mantine-color-red-6)","--mantine-color-placeholder":"var(--mantine-color-gray-5)","--mantine-color-anchor":`var(--mantine-color-${e.primaryColor}-${t})`,"--mantine-color-default":"var(--mantine-color-white)","--mantine-color-default-hover":"var(--mantine-color-gray-0)","--mantine-color-default-color":"var(--mantine-color-black)","--mantine-color-default-border":"var(--mantine-color-gray-4)","--mantine-color-dimmed":"var(--mantine-color-gray-6)","--mantine-color-disabled":"var(--mantine-color-gray-2)","--mantine-color-disabled-color":"var(--mantine-color-gray-5)","--mantine-color-disabled-border":"var(--mantine-color-gray-3)"},dark:{"--mantine-color-scheme":"dark","--mantine-primary-color-contrast":hF(e,"dark"),"--mantine-color-bright":"var(--mantine-color-white)","--mantine-color-text":"var(--mantine-color-dark-0)","--mantine-color-body":"var(--mantine-color-dark-7)","--mantine-color-error":"var(--mantine-color-red-8)","--mantine-color-placeholder":"var(--mantine-color-dark-3)","--mantine-color-anchor":`var(--mantine-color-${e.primaryColor}-4)`,"--mantine-color-default":"var(--mantine-color-dark-6)","--mantine-color-default-hover":"var(--mantine-color-dark-5)","--mantine-color-default-color":"var(--mantine-color-white)","--mantine-color-default-border":"var(--mantine-color-dark-4)","--mantine-color-dimmed":"var(--mantine-color-dark-2)","--mantine-color-disabled":"var(--mantine-color-dark-6)","--mantine-color-disabled-color":"var(--mantine-color-dark-3)","--mantine-color-disabled-border":"var(--mantine-color-dark-4)"}};du(n.variables,e.breakpoints,"breakpoint"),du(n.variables,e.spacing,"spacing"),du(n.variables,e.fontSizes,"font-size"),du(n.variables,e.lineHeights,"line-height"),du(n.variables,e.shadows,"shadow"),du(n.variables,e.radius,"radius"),e.colors[e.primaryColor].forEach((s,o)=>{n.variables[`--mantine-primary-color-${o}`]=`var(--mantine-color-${e.primaryColor}-${o})`}),Qs(e.colors).forEach(s=>{const o=e.colors[s];if(AG(o)){Object.assign(n.light,Sp({theme:e,name:o.name,color:o.light,colorScheme:"light",withColorValues:!0})),Object.assign(n.dark,Sp({theme:e,name:o.name,color:o.dark,colorScheme:"dark",withColorValues:!0}));return}o.forEach((a,u)=>{n.variables[`--mantine-color-${s}-${u}`]=a}),Object.assign(n.light,Sp({theme:e,color:s,colorScheme:"light",withColorValues:!1})),Object.assign(n.dark,Sp({theme:e,color:s,colorScheme:"dark",withColorValues:!1}))});const i=e.headings.sizes;return Qs(i).forEach(s=>{n.variables[`--mantine-${s}-font-size`]=i[s].fontSize,n.variables[`--mantine-${s}-line-height`]=i[s].lineHeight,n.variables[`--mantine-${s}-font-weight`]=i[s].fontWeight||e.headings.fontWeight}),n};function kG({theme:e,generator:t}){const r=gP(e),n=t?.(e);return n?mS(r,n):r}const XC=gP(SS);function PG(e){const t={variables:{},light:{},dark:{}};return Qs(e.variables).forEach(r=>{XC.variables[r]!==e.variables[r]&&(t.variables[r]=e.variables[r])}),Qs(e.light).forEach(r=>{XC.light[r]!==e.light[r]&&(t.light[r]=e.light[r])}),Qs(e.dark).forEach(r=>{XC.dark[r]!==e.dark[r]&&(t.dark[r]=e.dark[r])}),t}function MG(e){return`
  ${e}[data-mantine-color-scheme="dark"] { --mantine-color-scheme: dark; }
  ${e}[data-mantine-color-scheme="light"] { --mantine-color-scheme: light; }
`}function pP({cssVariablesSelector:e,deduplicateCssVariables:t}){const r=el(),n=yS(),i=lG(),s=kG({theme:r,generator:i}),o=e===":root"&&t,a=o?PG(s):s,u=FG(a,e);return u?Z.jsx("style",{"data-mantine-styles":!0,nonce:n?.(),dangerouslySetInnerHTML:{__html:`${u}${o?"":MG(e)}`}}):null}pP.displayName="@mantine/CssVariables";function hu(e,t){const r=typeof window<"u"&&"matchMedia"in window&&window.matchMedia("(prefers-color-scheme: dark)")?.matches,n=e!=="auto"?e:r?"dark":"light";t()?.setAttribute("data-mantine-color-scheme",n)}function _G({manager:e,defaultColorScheme:t,getRootElement:r,forceColorScheme:n}){const i=T.useRef(null),[s,o]=T.useState(()=>e.get(t)),a=n||s,u=T.useCallback(h=>{n||(hu(h,r),o(h),e.set(h))},[e.set,a,n]),d=T.useCallback(()=>{o(t),hu(t,r),e.clear()},[e.clear,t]);return T.useEffect(()=>(e.subscribe(u),e.unsubscribe),[e.subscribe,e.unsubscribe]),Lf(()=>{hu(e.get(t),r)},[]),T.useEffect(()=>{if(n)return hu(n,r),()=>{};n===void 0&&hu(s,r),typeof window<"u"&&"matchMedia"in window&&(i.current=window.matchMedia("(prefers-color-scheme: dark)"));const h=g=>{s==="auto"&&hu(g.matches?"dark":"light",r)};return i.current?.addEventListener("change",h),()=>i.current?.removeEventListener("change",h)},[s,n]),{colorScheme:a,setColorScheme:u,clearColorScheme:d}}function LG({respectReducedMotion:e,getRootElement:t}){Lf(()=>{e&&t()?.setAttribute("data-respect-reduced-motion","true")},[e])}function mP({theme:e,children:t,getStyleNonce:r,withStaticClasses:n=!0,withGlobalClasses:i=!0,deduplicateCssVariables:s=!0,withCssVariables:o=!0,cssVariablesSelector:a=":root",classNamesPrefix:u="mantine",colorSchemeManager:d=SG(),defaultColorScheme:h="light",getRootElement:g=()=>document.documentElement,cssVariablesResolver:m,forceColorScheme:v,stylesTransform:w,env:C}){const{colorScheme:b,setColorScheme:x,clearColorScheme:R}=_G({defaultColorScheme:h,forceColorScheme:v,manager:d,getRootElement:g});return LG({respectReducedMotion:e?.respectReducedMotion||!1,getRootElement:g}),Z.jsx(hP.Provider,{value:{colorScheme:b,setColorScheme:x,clearColorScheme:R,getRootElement:g,classNamesPrefix:u,getStyleNonce:r,cssVariablesResolver:m,cssVariablesSelector:a,withStaticClasses:n,stylesTransform:w,env:C},children:Z.jsxs(fP,{theme:e,children:[o&&Z.jsx(pP,{cssVariablesSelector:a,deduplicateCssVariables:s}),i&&Z.jsx(TG,{}),t]})})}mP.displayName="@mantine/core/MantineProvider";function fc({classNames:e,styles:t,props:r,stylesCtx:n}){const i=el();return{resolvedClassNames:bm({theme:i,classNames:e,props:r,stylesCtx:n||void 0}),resolvedStyles:w0({theme:i,styles:t,props:r,stylesCtx:n||void 0})}}const IG={always:"mantine-focus-always",auto:"mantine-focus-auto",never:"mantine-focus-never"};function OG({theme:e,options:t,unstyled:r}){return Di(t?.focusable&&!r&&(e.focusClassName||IG[e.focusRing]),t?.active&&!r&&e.activeClassName)}function NG({selector:e,stylesCtx:t,options:r,props:n,theme:i}){return bm({theme:i,classNames:r?.classNames,props:r?.props||n,stylesCtx:t})[e]}function fF({selector:e,stylesCtx:t,theme:r,classNames:n,props:i}){return bm({theme:r,classNames:n,props:i,stylesCtx:t})[e]}function BG({rootSelector:e,selector:t,className:r}){return e===t?r:void 0}function HG({selector:e,classes:t,unstyled:r}){return r?void 0:t[e]}function GG({themeName:e,classNamesPrefix:t,selector:r,withStaticClass:n}){return n===!1?[]:e.map(i=>`${t}-${i}-${r}`)}function VG({themeName:e,theme:t,selector:r,props:n,stylesCtx:i}){return e.map(s=>bm({theme:t,classNames:t.components[s]?.classNames,props:n,stylesCtx:i})?.[r])}function zG({options:e,classes:t,selector:r,unstyled:n}){return e?.variant&&!n?t[`${r}--${e.variant}`]:void 0}function WG({theme:e,options:t,themeName:r,selector:n,classNamesPrefix:i,classNames:s,classes:o,unstyled:a,className:u,rootSelector:d,props:h,stylesCtx:g,withStaticClasses:m,headless:v,transformedStyles:w}){return Di(OG({theme:e,options:t,unstyled:a||v}),VG({theme:e,themeName:r,selector:n,props:h,stylesCtx:g}),zG({options:t,classes:o,selector:n,unstyled:a}),fF({selector:n,stylesCtx:g,theme:e,classNames:s,props:h}),fF({selector:n,stylesCtx:g,theme:e,classNames:w,props:h}),NG({selector:n,stylesCtx:g,options:t,props:h,theme:e}),BG({rootSelector:d,selector:n,className:u}),HG({selector:n,classes:o,unstyled:a||v}),m&&!v&&GG({themeName:r,classNamesPrefix:i,selector:n,withStaticClass:t?.withStaticClass}),t?.className)}function UG({theme:e,themeName:t,props:r,stylesCtx:n,selector:i}){return t.map(s=>w0({theme:e,styles:e.components[s]?.styles,props:r,stylesCtx:n})[i]).reduce((s,o)=>({...s,...o}),{})}function lb({style:e,theme:t}){return Array.isArray(e)?[...e].reduce((r,n)=>({...r,...lb({style:n,theme:t})}),{}):typeof e=="function"?e(t):e??{}}function $G(e){return e.reduce((t,r)=>(r&&Object.keys(r).forEach(n=>{t[n]={...t[n],...vS(r[n])}}),t),{})}function jG({vars:e,varsResolver:t,theme:r,props:n,stylesCtx:i,selector:s,themeName:o,headless:a}){return $G([a?{}:t?.(r,n,i),...o.map(u=>r.components?.[u]?.vars?.(r,n,i)),e?.(r,n,i)])?.[s]}function YG({theme:e,themeName:t,selector:r,options:n,props:i,stylesCtx:s,rootSelector:o,styles:a,style:u,vars:d,varsResolver:h,headless:g,withStylesTransform:m}){return{...!m&&UG({theme:e,themeName:t,props:i,stylesCtx:s,selector:r}),...!m&&w0({theme:e,styles:a,props:i,stylesCtx:s})[r],...!m&&w0({theme:e,styles:n?.styles,props:n?.props||i,stylesCtx:s})[r],...jG({theme:e,props:i,stylesCtx:s,vars:d,varsResolver:h,selector:r,themeName:t,headless:g}),...o===r?lb({style:u,theme:e}):null,...lb({style:n?.style,theme:e})}}function KG({props:e,stylesCtx:t,themeName:r}){const n=el(),i=fG()?.();return{getTransformedStyles:o=>i?[...o.map(u=>i(u,{props:e,theme:n,ctx:t})),...r.map(u=>i(n.components[u]?.styles,{props:e,theme:n,ctx:t}))].filter(Boolean):[],withStylesTransform:!!i}}function wr({name:e,classes:t,props:r,stylesCtx:n,className:i,style:s,rootSelector:o="root",unstyled:a,classNames:u,styles:d,vars:h,varsResolver:g,attributes:m}){const v=el(),w=cG(),C=uG(),b=dG(),x=(Array.isArray(e)?e:[e]).filter(A=>A),{withStylesTransform:R,getTransformedStyles:E}=KG({props:r,stylesCtx:n,themeName:x});return(A,D)=>({className:WG({theme:v,options:D,themeName:x,selector:A,classNamesPrefix:w,classNames:u,classes:t,unstyled:a,className:i,rootSelector:o,props:r,stylesCtx:n,withStaticClasses:C,headless:b,transformedStyles:E([D?.styles,d])}),style:YG({theme:v,themeName:x,selector:A,options:D,props:r,stylesCtx:n,rootSelector:o,styles:d,style:s,vars:h,varsResolver:g,headless:b,withStylesTransform:R}),...m?.[A]})}function rt(e,t,r){const n=el(),i=n.components[e]?.defaultProps,s=typeof i=="function"?i(n):i;return{...t,...s,...vS(r)}}function QC(e){return Qs(e).reduce((t,r)=>e[r]!==void 0?`${t}${I5(r)}:${e[r]};`:t,"").trim()}function qG({selector:e,styles:t,media:r,container:n}){const i=t?QC(t):"",s=Array.isArray(r)?r.map(a=>`@media${a.query}{${e}{${QC(a.styles)}}}`):[],o=Array.isArray(n)?n.map(a=>`@container ${a.query}{${e}{${QC(a.styles)}}}`):[];return`${i?`${e}{${i}}`:""}${s.join("")}${o.join("")}`.trim()}function XG(e){const t=yS();return Z.jsx("style",{"data-mantine-styles":"inline",nonce:t?.(),dangerouslySetInnerHTML:{__html:qG(e)}})}function ES(e){const{m:t,mx:r,my:n,mt:i,mb:s,ml:o,mr:a,me:u,ms:d,p:h,px:g,py:m,pt:v,pb:w,pl:C,pr:b,pe:x,ps:R,bd:E,bdrs:A,bg:D,c:M,opacity:F,ff:O,fz:L,fw:W,lts:I,ta:G,lh:ne,fs:ie,tt:J,td:_,w:Y,miw:Q,maw:U,h:se,mih:N,mah:P,bgsz:V,bgp:H,bgr:j,bga:ae,pos:fe,top:le,left:de,bottom:ue,right:Ie,inset:q,display:Ge,flex:Ye,hiddenFrom:Ze,visibleFrom:ke,lightHidden:De,darkHidden:nt,sx:vt,...Xe}=e;return{styleProps:vS({m:t,mx:r,my:n,mt:i,mb:s,ml:o,mr:a,me:u,ms:d,p:h,px:g,py:m,pt:v,pb:w,pl:C,pr:b,pe:x,ps:R,bd:E,bg:D,c:M,opacity:F,ff:O,fz:L,fw:W,lts:I,ta:G,lh:ne,fs:ie,tt:J,td:_,w:Y,miw:Q,maw:U,h:se,mih:N,mah:P,bgsz:V,bgp:H,bgr:j,bga:ae,pos:fe,top:le,left:de,bottom:ue,right:Ie,inset:q,display:Ge,flex:Ye,bdrs:A,hiddenFrom:Ze,visibleFrom:ke,lightHidden:De,darkHidden:nt,sx:vt}),rest:Xe}}const QG={m:{type:"spacing",property:"margin"},mt:{type:"spacing",property:"marginTop"},mb:{type:"spacing",property:"marginBottom"},ml:{type:"spacing",property:"marginLeft"},mr:{type:"spacing",property:"marginRight"},ms:{type:"spacing",property:"marginInlineStart"},me:{type:"spacing",property:"marginInlineEnd"},mx:{type:"spacing",property:"marginInline"},my:{type:"spacing",property:"marginBlock"},p:{type:"spacing",property:"padding"},pt:{type:"spacing",property:"paddingTop"},pb:{type:"spacing",property:"paddingBottom"},pl:{type:"spacing",property:"paddingLeft"},pr:{type:"spacing",property:"paddingRight"},ps:{type:"spacing",property:"paddingInlineStart"},pe:{type:"spacing",property:"paddingInlineEnd"},px:{type:"spacing",property:"paddingInline"},py:{type:"spacing",property:"paddingBlock"},bd:{type:"border",property:"border"},bdrs:{type:"radius",property:"borderRadius"},bg:{type:"color",property:"background"},c:{type:"textColor",property:"color"},opacity:{type:"identity",property:"opacity"},ff:{type:"fontFamily",property:"fontFamily"},fz:{type:"fontSize",property:"fontSize"},fw:{type:"identity",property:"fontWeight"},lts:{type:"size",property:"letterSpacing"},ta:{type:"identity",property:"textAlign"},lh:{type:"lineHeight",property:"lineHeight"},fs:{type:"identity",property:"fontStyle"},tt:{type:"identity",property:"textTransform"},td:{type:"identity",property:"textDecoration"},w:{type:"spacing",property:"width"},miw:{type:"spacing",property:"minWidth"},maw:{type:"spacing",property:"maxWidth"},h:{type:"spacing",property:"height"},mih:{type:"spacing",property:"minHeight"},mah:{type:"spacing",property:"maxHeight"},bgsz:{type:"size",property:"backgroundSize"},bgp:{type:"identity",property:"backgroundPosition"},bgr:{type:"identity",property:"backgroundRepeat"},bga:{type:"identity",property:"backgroundAttachment"},pos:{type:"identity",property:"position"},top:{type:"size",property:"top"},left:{type:"size",property:"left"},bottom:{type:"size",property:"bottom"},right:{type:"size",property:"right"},inset:{type:"size",property:"inset"},display:{type:"identity",property:"display"},flex:{type:"identity",property:"flex"}};function RS(e,t){const r=If({color:e,theme:t});return r.color==="dimmed"?"var(--mantine-color-dimmed)":r.color==="bright"?"var(--mantine-color-bright)":r.variable?`var(${r.variable})`:r.color}function ZG(e,t){const r=If({color:e,theme:t});return r.isThemeColor&&r.shade===void 0?`var(--mantine-color-${r.color}-text)`:RS(e,t)}function JG(e,t){if(typeof e=="number")return Le(e);if(typeof e=="string"){const[r,n,...i]=e.split(" ").filter(o=>o.trim()!=="");let s=`${Le(r)}`;return n&&(s+=` ${n}`),i.length>0&&(s+=` ${RS(i.join(" "),t)}`),s.trim()}return e}const gF={text:"var(--mantine-font-family)",mono:"var(--mantine-font-family-monospace)",monospace:"var(--mantine-font-family-monospace)",heading:"var(--mantine-font-family-headings)",headings:"var(--mantine-font-family-headings)"};function e6(e){return typeof e=="string"&&e in gF?gF[e]:e}const t6=["h1","h2","h3","h4","h5","h6"];function r6(e,t){return typeof e=="string"&&e in t.fontSizes?`var(--mantine-font-size-${e})`:typeof e=="string"&&t6.includes(e)?`var(--mantine-${e}-font-size)`:typeof e=="number"||typeof e=="string"?Le(e):e}function n6(e){return e}const i6=["h1","h2","h3","h4","h5","h6"];function s6(e,t){return typeof e=="string"&&e in t.lineHeights?`var(--mantine-line-height-${e})`:typeof e=="string"&&i6.includes(e)?`var(--mantine-${e}-line-height)`:e}function o6(e,t){return typeof e=="string"&&e in t.radius?`var(--mantine-radius-${e})`:typeof e=="number"||typeof e=="string"?Le(e):e}function a6(e){return typeof e=="number"?Le(e):e}function l6(e,t){if(typeof e=="number")return Le(e);if(typeof e=="string"){const r=e.replace("-","");if(!(r in t.spacing))return Le(e);const n=`--mantine-spacing-${r}`;return e.startsWith("-")?`calc(var(${n}) * -1)`:`var(${n})`}return e}const ZC={color:RS,textColor:ZG,fontSize:r6,spacing:l6,radius:o6,identity:n6,size:a6,lineHeight:s6,fontFamily:e6,border:JG};function pF(e){return e.replace("(min-width: ","").replace("em)","")}function c6({media:e,...t}){const n=Object.keys(e).sort((i,s)=>Number(pF(i))-Number(pF(s))).map(i=>({query:i,styles:e[i]}));return{...t,media:n}}function u6(e){if(typeof e!="object"||e===null)return!1;const t=Object.keys(e);return!(t.length===1&&t[0]==="base")}function d6(e){return typeof e=="object"&&e!==null?"base"in e?e.base:void 0:e}function h6(e){return typeof e=="object"&&e!==null?Qs(e).filter(t=>t!=="base"):[]}function f6(e,t){return typeof e=="object"&&e!==null&&t in e?e[t]:e}function g6({styleProps:e,data:t,theme:r}){return c6(Qs(e).reduce((n,i)=>{if(i==="hiddenFrom"||i==="visibleFrom"||i==="sx")return n;const s=t[i],o=Array.isArray(s.property)?s.property:[s.property],a=d6(e[i]);if(!u6(e[i]))return o.forEach(d=>{n.inlineStyles[d]=ZC[s.type](a,r)}),n;n.hasResponsiveStyles=!0;const u=h6(e[i]);return o.forEach(d=>{a!=null&&(n.styles[d]=ZC[s.type](a,r)),u.forEach(h=>{const g=`(min-width: ${r.breakpoints[h]})`;n.media[g]={...n.media[g],[d]:ZC[s.type](f6(e[i],h),r)}})}),n},{hasResponsiveStyles:!1,styles:{},inlineStyles:{},media:{}}))}function p6(){return`__m__-${T.useId().replace(/[:]/g,"")}`}function vP(e){return e.startsWith("data-")?e:`data-${e}`}function m6(e){return Object.keys(e).reduce((t,r)=>{const n=e[r];return n===void 0||n===""||n===!1||n===null||(t[vP(r)]=e[r]),t},{})}function wP(e){return e?typeof e=="string"?{[vP(e)]:!0}:Array.isArray(e)?[...e].reduce((t,r)=>({...t,...wP(r)}),{}):m6(e):null}function cb(e,t){return Array.isArray(e)?[...e].reduce((r,n)=>({...r,...cb(n,t)}),{}):typeof e=="function"?e(t):e??{}}function v6({theme:e,style:t,vars:r,styleProps:n}){const i=cb(t,e),s=cb(r,e);return{...i,...s,...n}}const CP=T.forwardRef(({component:e,style:t,__vars:r,className:n,variant:i,mod:s,size:o,hiddenFrom:a,visibleFrom:u,lightHidden:d,darkHidden:h,renderRoot:g,__size:m,...v},w)=>{const C=el(),b=e||"div",{styleProps:x,rest:R}=ES(v),A=hG()?.()?.(x.sx),D=p6(),M=g6({styleProps:x,theme:C,data:QG}),F={ref:w,style:v6({theme:C,style:t,vars:r,styleProps:M.inlineStyles}),className:Di(n,A,{[D]:M.hasResponsiveStyles,"mantine-light-hidden":d,"mantine-dark-hidden":h,[`mantine-hidden-from-${a}`]:a,[`mantine-visible-from-${u}`]:u}),"data-variant":i,"data-size":nP(o)?void 0:o||void 0,size:m,...wP(s),...R};return Z.jsxs(Z.Fragment,{children:[M.hasResponsiveStyles&&Z.jsx(XG,{selector:`.${D}`,styles:M.styles,media:M.media}),typeof g=="function"?g(F):Z.jsx(b,{...F})]})});CP.displayName="@mantine/core/Box";const Dt=CP;function yP(e){return e}function ct(e){const t=T.forwardRef(e);return t.extend=yP,t.withProps=r=>{const n=T.forwardRef((i,s)=>Z.jsx(t,{...r,...i,ref:s}));return n.extend=t.extend,n.displayName=`WithProps(${t.displayName})`,n},t}function dd(e){const t=T.forwardRef(e);return t.withProps=r=>{const n=T.forwardRef((i,s)=>Z.jsx(t,{...r,...i,ref:s}));return n.extend=t.extend,n.displayName=`WithProps(${t.displayName})`,n},t.extend=yP,t}const w6=T.createContext({dir:"ltr",toggleDirection:()=>{},setDirection:()=>{}});function TS(){return T.useContext(w6)}var Of=Vk();const bP=Mf(Of);function xm(){return typeof window<"u"}function hd(e){return SP(e)?(e.nodeName||"").toLowerCase():"#document"}function Ti(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function oo(e){var t;return(t=(SP(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function SP(e){return xm()?e instanceof Node||e instanceof Ti(e).Node:!1}function zn(e){return xm()?e instanceof Element||e instanceof Ti(e).Element:!1}function to(e){return xm()?e instanceof HTMLElement||e instanceof Ti(e).HTMLElement:!1}function mF(e){return!xm()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Ti(e).ShadowRoot}const C6=new Set(["inline","contents"]);function Nf(e){const{overflow:t,overflowX:r,overflowY:n,display:i}=Rs(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!C6.has(i)}const y6=new Set(["table","td","th"]);function b6(e){return y6.has(hd(e))}const S6=[":popover-open",":modal"];function Em(e){return S6.some(t=>{try{return e.matches(t)}catch{return!1}})}const x6=["transform","translate","scale","rotate","perspective"],E6=["transform","translate","scale","rotate","perspective","filter"],R6=["paint","layout","strict","content"];function FS(e){const t=DS(),r=zn(e)?Rs(e):e;return x6.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||E6.some(n=>(r.willChange||"").includes(n))||R6.some(n=>(r.contain||"").includes(n))}function T6(e){let t=Wa(e);for(;to(t)&&!Yu(t);){if(FS(t))return t;if(Em(t))return null;t=Wa(t)}return null}function DS(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const F6=new Set(["html","body","#document"]);function Yu(e){return F6.has(hd(e))}function Rs(e){return Ti(e).getComputedStyle(e)}function Rm(e){return zn(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Wa(e){if(hd(e)==="html")return e;const t=e.assignedSlot||e.parentNode||mF(e)&&e.host||oo(e);return mF(t)?t.host:t}function xP(e){const t=Wa(e);return Yu(t)?e.ownerDocument?e.ownerDocument.body:e.body:to(t)&&Nf(t)?t:xP(t)}function tf(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const i=xP(e),s=i===((n=e.ownerDocument)==null?void 0:n.body),o=Ti(i);if(s){const a=ub(o);return t.concat(o,o.visualViewport||[],Nf(i)?i:[],a&&r?tf(a):[])}return t.concat(i,tf(i,[],r))}function ub(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}const D6=["top","right","bottom","left"],Ts=Math.min,An=Math.max,C0=Math.round,xp=Math.floor,Zs=e=>({x:e,y:e}),A6={left:"right",right:"left",bottom:"top",top:"bottom"},k6={start:"end",end:"start"};function db(e,t,r){return An(e,Ts(t,r))}function ro(e,t){return typeof e=="function"?e(t):e}function Fs(e){return e.split("-")[0]}function fd(e){return e.split("-")[1]}function AS(e){return e==="x"?"y":"x"}function kS(e){return e==="y"?"height":"width"}const P6=new Set(["top","bottom"]);function ws(e){return P6.has(Fs(e))?"y":"x"}function PS(e){return AS(ws(e))}function M6(e,t,r){r===void 0&&(r=!1);const n=fd(e),i=PS(e),s=kS(i);let o=i==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(o=y0(o)),[o,y0(o)]}function _6(e){const t=y0(e);return[hb(e),t,hb(t)]}function hb(e){return e.replace(/start|end/g,t=>k6[t])}const vF=["left","right"],wF=["right","left"],L6=["top","bottom"],I6=["bottom","top"];function O6(e,t,r){switch(e){case"top":case"bottom":return r?t?wF:vF:t?vF:wF;case"left":case"right":return t?L6:I6;default:return[]}}function N6(e,t,r,n){const i=fd(e);let s=O6(Fs(e),r==="start",n);return i&&(s=s.map(o=>o+"-"+i),t&&(s=s.concat(s.map(hb)))),s}function y0(e){return e.replace(/left|right|bottom|top/g,t=>A6[t])}function B6(e){return{top:0,right:0,bottom:0,left:0,...e}}function MS(e){return typeof e!="number"?B6(e):{top:e,right:e,bottom:e,left:e}}function Ku(e){const{x:t,y:r,width:n,height:i}=e;return{width:n,height:i,top:r,left:t,right:t+n,bottom:r+i,x:t,y:r}}var H6=typeof document<"u",G6=function(){},fb=H6?T.useLayoutEffect:G6;const V6={...Gk},z6=V6.useInsertionEffect,W6=z6||(e=>e());function U6(e){const t=T.useRef(()=>{});return W6(()=>{t.current=e}),T.useCallback(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return t.current==null?void 0:t.current(...n)},[])}function CF(e,t,r){let{reference:n,floating:i}=e;const s=ws(t),o=PS(t),a=kS(o),u=Fs(t),d=s==="y",h=n.x+n.width/2-i.width/2,g=n.y+n.height/2-i.height/2,m=n[a]/2-i[a]/2;let v;switch(u){case"top":v={x:h,y:n.y-i.height};break;case"bottom":v={x:h,y:n.y+n.height};break;case"right":v={x:n.x+n.width,y:g};break;case"left":v={x:n.x-i.width,y:g};break;default:v={x:n.x,y:n.y}}switch(fd(t)){case"start":v[o]-=m*(r&&d?-1:1);break;case"end":v[o]+=m*(r&&d?-1:1);break}return v}const $6=async(e,t,r)=>{const{placement:n="bottom",strategy:i="absolute",middleware:s=[],platform:o}=r,a=s.filter(Boolean),u=await(o.isRTL==null?void 0:o.isRTL(t));let d=await o.getElementRects({reference:e,floating:t,strategy:i}),{x:h,y:g}=CF(d,n,u),m=n,v={},w=0;for(let C=0;C<a.length;C++){const{name:b,fn:x}=a[C],{x:R,y:E,data:A,reset:D}=await x({x:h,y:g,initialPlacement:n,placement:m,strategy:i,middlewareData:v,rects:d,platform:o,elements:{reference:e,floating:t}});h=R??h,g=E??g,v={...v,[b]:{...v[b],...A}},D&&w<=50&&(w++,typeof D=="object"&&(D.placement&&(m=D.placement),D.rects&&(d=D.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:i}):D.rects),{x:h,y:g}=CF(d,m,u)),C=-1)}return{x:h,y:g,placement:m,strategy:i,middlewareData:v}};async function rf(e,t){var r;t===void 0&&(t={});const{x:n,y:i,platform:s,rects:o,elements:a,strategy:u}=e,{boundary:d="clippingAncestors",rootBoundary:h="viewport",elementContext:g="floating",altBoundary:m=!1,padding:v=0}=ro(t,e),w=MS(v),b=a[m?g==="floating"?"reference":"floating":g],x=Ku(await s.getClippingRect({element:(r=await(s.isElement==null?void 0:s.isElement(b)))==null||r?b:b.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:d,rootBoundary:h,strategy:u})),R=g==="floating"?{x:n,y:i,width:o.floating.width,height:o.floating.height}:o.reference,E=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),A=await(s.isElement==null?void 0:s.isElement(E))?await(s.getScale==null?void 0:s.getScale(E))||{x:1,y:1}:{x:1,y:1},D=Ku(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:R,offsetParent:E,strategy:u}):R);return{top:(x.top-D.top+w.top)/A.y,bottom:(D.bottom-x.bottom+w.bottom)/A.y,left:(x.left-D.left+w.left)/A.x,right:(D.right-x.right+w.right)/A.x}}const j6=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:i,rects:s,platform:o,elements:a,middlewareData:u}=t,{element:d,padding:h=0}=ro(e,t)||{};if(d==null)return{};const g=MS(h),m={x:r,y:n},v=PS(i),w=kS(v),C=await o.getDimensions(d),b=v==="y",x=b?"top":"left",R=b?"bottom":"right",E=b?"clientHeight":"clientWidth",A=s.reference[w]+s.reference[v]-m[v]-s.floating[w],D=m[v]-s.reference[v],M=await(o.getOffsetParent==null?void 0:o.getOffsetParent(d));let F=M?M[E]:0;(!F||!await(o.isElement==null?void 0:o.isElement(M)))&&(F=a.floating[E]||s.floating[w]);const O=A/2-D/2,L=F/2-C[w]/2-1,W=Ts(g[x],L),I=Ts(g[R],L),G=W,ne=F-C[w]-I,ie=F/2-C[w]/2+O,J=db(G,ie,ne),_=!u.arrow&&fd(i)!=null&&ie!==J&&s.reference[w]/2-(ie<G?W:I)-C[w]/2<0,Y=_?ie<G?ie-G:ie-ne:0;return{[v]:m[v]+Y,data:{[v]:J,centerOffset:ie-J-Y,..._&&{alignmentOffset:Y}},reset:_}}}),Y6=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:i,middlewareData:s,rects:o,initialPlacement:a,platform:u,elements:d}=t,{mainAxis:h=!0,crossAxis:g=!0,fallbackPlacements:m,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:w="none",flipAlignment:C=!0,...b}=ro(e,t);if((r=s.arrow)!=null&&r.alignmentOffset)return{};const x=Fs(i),R=ws(a),E=Fs(a)===a,A=await(u.isRTL==null?void 0:u.isRTL(d.floating)),D=m||(E||!C?[y0(a)]:_6(a)),M=w!=="none";!m&&M&&D.push(...N6(a,C,w,A));const F=[a,...D],O=await rf(t,b),L=[];let W=((n=s.flip)==null?void 0:n.overflows)||[];if(h&&L.push(O[x]),g){const ie=M6(i,o,A);L.push(O[ie[0]],O[ie[1]])}if(W=[...W,{placement:i,overflows:L}],!L.every(ie=>ie<=0)){var I,G;const ie=(((I=s.flip)==null?void 0:I.index)||0)+1,J=F[ie];if(J&&(!(g==="alignment"?R!==ws(J):!1)||W.every(Q=>ws(Q.placement)===R?Q.overflows[0]>0:!0)))return{data:{index:ie,overflows:W},reset:{placement:J}};let _=(G=W.filter(Y=>Y.overflows[0]<=0).sort((Y,Q)=>Y.overflows[1]-Q.overflows[1])[0])==null?void 0:G.placement;if(!_)switch(v){case"bestFit":{var ne;const Y=(ne=W.filter(Q=>{if(M){const U=ws(Q.placement);return U===R||U==="y"}return!0}).map(Q=>[Q.placement,Q.overflows.filter(U=>U>0).reduce((U,se)=>U+se,0)]).sort((Q,U)=>Q[1]-U[1])[0])==null?void 0:ne[0];Y&&(_=Y);break}case"initialPlacement":_=a;break}if(i!==_)return{reset:{placement:_}}}return{}}}};function yF(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function bF(e){return D6.some(t=>e[t]>=0)}const K6=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...i}=ro(e,t);switch(n){case"referenceHidden":{const s=await rf(t,{...i,elementContext:"reference"}),o=yF(s,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:bF(o)}}}case"escaped":{const s=await rf(t,{...i,altBoundary:!0}),o=yF(s,r.floating);return{data:{escapedOffsets:o,escaped:bF(o)}}}default:return{}}}}};function EP(e){const t=Ts(...e.map(s=>s.left)),r=Ts(...e.map(s=>s.top)),n=An(...e.map(s=>s.right)),i=An(...e.map(s=>s.bottom));return{x:t,y:r,width:n-t,height:i-r}}function q6(e){const t=e.slice().sort((i,s)=>i.y-s.y),r=[];let n=null;for(let i=0;i<t.length;i++){const s=t[i];!n||s.y-n.y>n.height/2?r.push([s]):r[r.length-1].push(s),n=s}return r.map(i=>Ku(EP(i)))}const X6=function(e){return e===void 0&&(e={}),{name:"inline",options:e,async fn(t){const{placement:r,elements:n,rects:i,platform:s,strategy:o}=t,{padding:a=2,x:u,y:d}=ro(e,t),h=Array.from(await(s.getClientRects==null?void 0:s.getClientRects(n.reference))||[]),g=q6(h),m=Ku(EP(h)),v=MS(a);function w(){if(g.length===2&&g[0].left>g[1].right&&u!=null&&d!=null)return g.find(b=>u>b.left-v.left&&u<b.right+v.right&&d>b.top-v.top&&d<b.bottom+v.bottom)||m;if(g.length>=2){if(ws(r)==="y"){const W=g[0],I=g[g.length-1],G=Fs(r)==="top",ne=W.top,ie=I.bottom,J=G?W.left:I.left,_=G?W.right:I.right,Y=_-J,Q=ie-ne;return{top:ne,bottom:ie,left:J,right:_,width:Y,height:Q,x:J,y:ne}}const b=Fs(r)==="left",x=An(...g.map(W=>W.right)),R=Ts(...g.map(W=>W.left)),E=g.filter(W=>b?W.left===R:W.right===x),A=E[0].top,D=E[E.length-1].bottom,M=R,F=x,O=F-M,L=D-A;return{top:A,bottom:D,left:M,right:F,width:O,height:L,x:M,y:A}}return m}const C=await s.getElementRects({reference:{getBoundingClientRect:w},floating:n.floating,strategy:o});return i.reference.x!==C.reference.x||i.reference.y!==C.reference.y||i.reference.width!==C.reference.width||i.reference.height!==C.reference.height?{reset:{rects:C}}:{}}}},RP=new Set(["left","top"]);async function Q6(e,t){const{placement:r,platform:n,elements:i}=e,s=await(n.isRTL==null?void 0:n.isRTL(i.floating)),o=Fs(r),a=fd(r),u=ws(r)==="y",d=RP.has(o)?-1:1,h=s&&u?-1:1,g=ro(t,e);let{mainAxis:m,crossAxis:v,alignmentAxis:w}=typeof g=="number"?{mainAxis:g,crossAxis:0,alignmentAxis:null}:{mainAxis:g.mainAxis||0,crossAxis:g.crossAxis||0,alignmentAxis:g.alignmentAxis};return a&&typeof w=="number"&&(v=a==="end"?w*-1:w),u?{x:v*h,y:m*d}:{x:m*d,y:v*h}}const Z6=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:i,y:s,placement:o,middlewareData:a}=t,u=await Q6(t,e);return o===((r=a.offset)==null?void 0:r.placement)&&(n=a.arrow)!=null&&n.alignmentOffset?{}:{x:i+u.x,y:s+u.y,data:{...u,placement:o}}}}},J6=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:i}=t,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:b=>{let{x,y:R}=b;return{x,y:R}}},...u}=ro(e,t),d={x:r,y:n},h=await rf(t,u),g=ws(Fs(i)),m=AS(g);let v=d[m],w=d[g];if(s){const b=m==="y"?"top":"left",x=m==="y"?"bottom":"right",R=v+h[b],E=v-h[x];v=db(R,v,E)}if(o){const b=g==="y"?"top":"left",x=g==="y"?"bottom":"right",R=w+h[b],E=w-h[x];w=db(R,w,E)}const C=a.fn({...t,[m]:v,[g]:w});return{...C,data:{x:C.x-r,y:C.y-n,enabled:{[m]:s,[g]:o}}}}}},e8=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:i,rects:s,middlewareData:o}=t,{offset:a=0,mainAxis:u=!0,crossAxis:d=!0}=ro(e,t),h={x:r,y:n},g=ws(i),m=AS(g);let v=h[m],w=h[g];const C=ro(a,t),b=typeof C=="number"?{mainAxis:C,crossAxis:0}:{mainAxis:0,crossAxis:0,...C};if(u){const E=m==="y"?"height":"width",A=s.reference[m]-s.floating[E]+b.mainAxis,D=s.reference[m]+s.reference[E]-b.mainAxis;v<A?v=A:v>D&&(v=D)}if(d){var x,R;const E=m==="y"?"width":"height",A=RP.has(Fs(i)),D=s.reference[g]-s.floating[E]+(A&&((x=o.offset)==null?void 0:x[g])||0)+(A?0:b.crossAxis),M=s.reference[g]+s.reference[E]+(A?0:((R=o.offset)==null?void 0:R[g])||0)-(A?b.crossAxis:0);w<D?w=D:w>M&&(w=M)}return{[m]:v,[g]:w}}}},t8=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:i,rects:s,platform:o,elements:a}=t,{apply:u=()=>{},...d}=ro(e,t),h=await rf(t,d),g=Fs(i),m=fd(i),v=ws(i)==="y",{width:w,height:C}=s.floating;let b,x;g==="top"||g==="bottom"?(b=g,x=m===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(x=g,b=m==="end"?"top":"bottom");const R=C-h.top-h.bottom,E=w-h.left-h.right,A=Ts(C-h[b],R),D=Ts(w-h[x],E),M=!t.middlewareData.shift;let F=A,O=D;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(O=E),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(F=R),M&&!m){const W=An(h.left,0),I=An(h.right,0),G=An(h.top,0),ne=An(h.bottom,0);v?O=w-2*(W!==0||I!==0?W+I:An(h.left,h.right)):F=C-2*(G!==0||ne!==0?G+ne:An(h.top,h.bottom))}await u({...t,availableWidth:O,availableHeight:F});const L=await o.getDimensions(a.floating);return w!==L.width||C!==L.height?{reset:{rects:!0}}:{}}}};function TP(e){const t=Rs(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const i=to(e),s=i?e.offsetWidth:r,o=i?e.offsetHeight:n,a=C0(r)!==s||C0(n)!==o;return a&&(r=s,n=o),{width:r,height:n,$:a}}function _S(e){return zn(e)?e:e.contextElement}function Du(e){const t=_S(e);if(!to(t))return Zs(1);const r=t.getBoundingClientRect(),{width:n,height:i,$:s}=TP(t);let o=(s?C0(r.width):r.width)/n,a=(s?C0(r.height):r.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const r8=Zs(0);function FP(e){const t=Ti(e);return!DS()||!t.visualViewport?r8:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function n8(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Ti(e)?!1:t}function Ql(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const i=e.getBoundingClientRect(),s=_S(e);let o=Zs(1);t&&(n?zn(n)&&(o=Du(n)):o=Du(e));const a=n8(s,r,n)?FP(s):Zs(0);let u=(i.left+a.x)/o.x,d=(i.top+a.y)/o.y,h=i.width/o.x,g=i.height/o.y;if(s){const m=Ti(s),v=n&&zn(n)?Ti(n):n;let w=m,C=ub(w);for(;C&&n&&v!==w;){const b=Du(C),x=C.getBoundingClientRect(),R=Rs(C),E=x.left+(C.clientLeft+parseFloat(R.paddingLeft))*b.x,A=x.top+(C.clientTop+parseFloat(R.paddingTop))*b.y;u*=b.x,d*=b.y,h*=b.x,g*=b.y,u+=E,d+=A,w=Ti(C),C=ub(w)}}return Ku({width:h,height:g,x:u,y:d})}function Tm(e,t){const r=Rm(e).scrollLeft;return t?t.left+r:Ql(oo(e)).left+r}function DP(e,t){const r=e.getBoundingClientRect(),n=r.left+t.scrollLeft-Tm(e,r),i=r.top+t.scrollTop;return{x:n,y:i}}function i8(e){let{elements:t,rect:r,offsetParent:n,strategy:i}=e;const s=i==="fixed",o=oo(n),a=t?Em(t.floating):!1;if(n===o||a&&s)return r;let u={scrollLeft:0,scrollTop:0},d=Zs(1);const h=Zs(0),g=to(n);if((g||!g&&!s)&&((hd(n)!=="body"||Nf(o))&&(u=Rm(n)),to(n))){const v=Ql(n);d=Du(n),h.x=v.x+n.clientLeft,h.y=v.y+n.clientTop}const m=o&&!g&&!s?DP(o,u):Zs(0);return{width:r.width*d.x,height:r.height*d.y,x:r.x*d.x-u.scrollLeft*d.x+h.x+m.x,y:r.y*d.y-u.scrollTop*d.y+h.y+m.y}}function s8(e){return Array.from(e.getClientRects())}function o8(e){const t=oo(e),r=Rm(e),n=e.ownerDocument.body,i=An(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),s=An(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+Tm(e);const a=-r.scrollTop;return Rs(n).direction==="rtl"&&(o+=An(t.clientWidth,n.clientWidth)-i),{width:i,height:s,x:o,y:a}}const SF=25;function a8(e,t){const r=Ti(e),n=oo(e),i=r.visualViewport;let s=n.clientWidth,o=n.clientHeight,a=0,u=0;if(i){s=i.width,o=i.height;const h=DS();(!h||h&&t==="fixed")&&(a=i.offsetLeft,u=i.offsetTop)}const d=Tm(n);if(d<=0){const h=n.ownerDocument,g=h.body,m=getComputedStyle(g),v=h.compatMode==="CSS1Compat"&&parseFloat(m.marginLeft)+parseFloat(m.marginRight)||0,w=Math.abs(n.clientWidth-g.clientWidth-v);w<=SF&&(s-=w)}else d<=SF&&(s+=d);return{width:s,height:o,x:a,y:u}}const l8=new Set(["absolute","fixed"]);function c8(e,t){const r=Ql(e,!0,t==="fixed"),n=r.top+e.clientTop,i=r.left+e.clientLeft,s=to(e)?Du(e):Zs(1),o=e.clientWidth*s.x,a=e.clientHeight*s.y,u=i*s.x,d=n*s.y;return{width:o,height:a,x:u,y:d}}function xF(e,t,r){let n;if(t==="viewport")n=a8(e,r);else if(t==="document")n=o8(oo(e));else if(zn(t))n=c8(t,r);else{const i=FP(e);n={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return Ku(n)}function AP(e,t){const r=Wa(e);return r===t||!zn(r)||Yu(r)?!1:Rs(r).position==="fixed"||AP(r,t)}function u8(e,t){const r=t.get(e);if(r)return r;let n=tf(e,[],!1).filter(a=>zn(a)&&hd(a)!=="body"),i=null;const s=Rs(e).position==="fixed";let o=s?Wa(e):e;for(;zn(o)&&!Yu(o);){const a=Rs(o),u=FS(o);!u&&a.position==="fixed"&&(i=null),(s?!u&&!i:!u&&a.position==="static"&&!!i&&l8.has(i.position)||Nf(o)&&!u&&AP(e,o))?n=n.filter(h=>h!==o):i=a,o=Wa(o)}return t.set(e,n),n}function d8(e){let{element:t,boundary:r,rootBoundary:n,strategy:i}=e;const o=[...r==="clippingAncestors"?Em(t)?[]:u8(t,this._c):[].concat(r),n],a=o[0],u=o.reduce((d,h)=>{const g=xF(t,h,i);return d.top=An(g.top,d.top),d.right=Ts(g.right,d.right),d.bottom=Ts(g.bottom,d.bottom),d.left=An(g.left,d.left),d},xF(t,a,i));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function h8(e){const{width:t,height:r}=TP(e);return{width:t,height:r}}function f8(e,t,r){const n=to(t),i=oo(t),s=r==="fixed",o=Ql(e,!0,s,t);let a={scrollLeft:0,scrollTop:0};const u=Zs(0);function d(){u.x=Tm(i)}if(n||!n&&!s)if((hd(t)!=="body"||Nf(i))&&(a=Rm(t)),n){const v=Ql(t,!0,s,t);u.x=v.x+t.clientLeft,u.y=v.y+t.clientTop}else i&&d();s&&!n&&i&&d();const h=i&&!n&&!s?DP(i,a):Zs(0),g=o.left+a.scrollLeft-u.x-h.x,m=o.top+a.scrollTop-u.y-h.y;return{x:g,y:m,width:o.width,height:o.height}}function JC(e){return Rs(e).position==="static"}function EF(e,t){if(!to(e)||Rs(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return oo(e)===r&&(r=r.ownerDocument.body),r}function kP(e,t){const r=Ti(e);if(Em(e))return r;if(!to(e)){let i=Wa(e);for(;i&&!Yu(i);){if(zn(i)&&!JC(i))return i;i=Wa(i)}return r}let n=EF(e,t);for(;n&&b6(n)&&JC(n);)n=EF(n,t);return n&&Yu(n)&&JC(n)&&!FS(n)?r:n||T6(e)||r}const g8=async function(e){const t=this.getOffsetParent||kP,r=this.getDimensions,n=await r(e.floating);return{reference:f8(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function p8(e){return Rs(e).direction==="rtl"}const m8={convertOffsetParentRelativeRectToViewportRelativeRect:i8,getDocumentElement:oo,getClippingRect:d8,getOffsetParent:kP,getElementRects:g8,getClientRects:s8,getDimensions:h8,getScale:Du,isElement:zn,isRTL:p8};function PP(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function v8(e,t){let r=null,n;const i=oo(e);function s(){var a;clearTimeout(n),(a=r)==null||a.disconnect(),r=null}function o(a,u){a===void 0&&(a=!1),u===void 0&&(u=1),s();const d=e.getBoundingClientRect(),{left:h,top:g,width:m,height:v}=d;if(a||t(),!m||!v)return;const w=xp(g),C=xp(i.clientWidth-(h+m)),b=xp(i.clientHeight-(g+v)),x=xp(h),E={rootMargin:-w+"px "+-C+"px "+-b+"px "+-x+"px",threshold:An(0,Ts(1,u))||1};let A=!0;function D(M){const F=M[0].intersectionRatio;if(F!==u){if(!A)return o();F?o(!1,F):n=setTimeout(()=>{o(!1,1e-7)},1e3)}F===1&&!PP(d,e.getBoundingClientRect())&&o(),A=!1}try{r=new IntersectionObserver(D,{...E,root:i.ownerDocument})}catch{r=new IntersectionObserver(D,E)}r.observe(e)}return o(!0),s}function RF(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:u=!1}=n,d=_S(e),h=i||s?[...d?tf(d):[],...tf(t)]:[];h.forEach(x=>{i&&x.addEventListener("scroll",r,{passive:!0}),s&&x.addEventListener("resize",r)});const g=d&&a?v8(d,r):null;let m=-1,v=null;o&&(v=new ResizeObserver(x=>{let[R]=x;R&&R.target===d&&v&&(v.unobserve(t),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var E;(E=v)==null||E.observe(t)})),r()}),d&&!u&&v.observe(d),v.observe(t));let w,C=u?Ql(e):null;u&&b();function b(){const x=Ql(e);C&&!PP(C,x)&&r(),C=x,w=requestAnimationFrame(b)}return r(),()=>{var x;h.forEach(R=>{i&&R.removeEventListener("scroll",r),s&&R.removeEventListener("resize",r)}),g?.(),(x=v)==null||x.disconnect(),v=null,u&&cancelAnimationFrame(w)}}const w8=Z6,C8=J6,y8=Y6,b8=t8,S8=K6,TF=j6,x8=X6,E8=e8,R8=(e,t,r)=>{const n=new Map,i={platform:m8,...r},s={...i.platform,_c:n};return $6(e,t,{...i,platform:s})};var T8=typeof document<"u",F8=function(){},Zp=T8?T.useLayoutEffect:F8;function b0(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,i;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!b0(e[n],t[n]))return!1;return!0}if(i=Object.keys(e),r=i.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,i[n]))return!1;for(n=r;n--!==0;){const s=i[n];if(!(s==="_owner"&&e.$$typeof)&&!b0(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function MP(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function FF(e,t){const r=MP(e);return Math.round(t*r)/r}function ey(e){const t=T.useRef(e);return Zp(()=>{t.current=e}),t}function D8(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:i,elements:{reference:s,floating:o}={},transform:a=!0,whileElementsMounted:u,open:d}=e,[h,g]=T.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[m,v]=T.useState(n);b0(m,n)||v(n);const[w,C]=T.useState(null),[b,x]=T.useState(null),R=T.useCallback(Q=>{Q!==M.current&&(M.current=Q,C(Q))},[]),E=T.useCallback(Q=>{Q!==F.current&&(F.current=Q,x(Q))},[]),A=s||w,D=o||b,M=T.useRef(null),F=T.useRef(null),O=T.useRef(h),L=u!=null,W=ey(u),I=ey(i),G=ey(d),ne=T.useCallback(()=>{if(!M.current||!F.current)return;const Q={placement:t,strategy:r,middleware:m};I.current&&(Q.platform=I.current),R8(M.current,F.current,Q).then(U=>{const se={...U,isPositioned:G.current!==!1};ie.current&&!b0(O.current,se)&&(O.current=se,Of.flushSync(()=>{g(se)}))})},[m,t,r,I,G]);Zp(()=>{d===!1&&O.current.isPositioned&&(O.current.isPositioned=!1,g(Q=>({...Q,isPositioned:!1})))},[d]);const ie=T.useRef(!1);Zp(()=>(ie.current=!0,()=>{ie.current=!1}),[]),Zp(()=>{if(A&&(M.current=A),D&&(F.current=D),A&&D){if(W.current)return W.current(A,D,ne);ne()}},[A,D,ne,W,L]);const J=T.useMemo(()=>({reference:M,floating:F,setReference:R,setFloating:E}),[R,E]),_=T.useMemo(()=>({reference:A,floating:D}),[A,D]),Y=T.useMemo(()=>{const Q={position:r,left:0,top:0};if(!_.floating)return Q;const U=FF(_.floating,h.x),se=FF(_.floating,h.y);return a?{...Q,transform:"translate("+U+"px, "+se+"px)",...MP(_.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:U,top:se}},[r,a,_.floating,h.x,h.y]);return T.useMemo(()=>({...h,update:ne,refs:J,elements:_,floatingStyles:Y}),[h,ne,J,_,Y])}const A8=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:i}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?TF({element:n.current,padding:i}).fn(r):{}:n?TF({element:n,padding:i}).fn(r):{}}}},k8=(e,t)=>({...w8(e),options:[e,t]}),P8=(e,t)=>({...C8(e),options:[e,t]}),DF=(e,t)=>({...E8(e),options:[e,t]}),AF=(e,t)=>({...y8(e),options:[e,t]}),M8=(e,t)=>({...b8(e),options:[e,t]}),_8=(e,t)=>({...S8(e),options:[e,t]}),kF=(e,t)=>({...x8(e),options:[e,t]}),L8=(e,t)=>({...A8(e),options:[e,t]});function _P(e){const t=T.useRef(void 0),r=T.useCallback(n=>{const i=e.map(s=>{if(s!=null){if(typeof s=="function"){const o=s,a=o(n);return typeof a=="function"?a:()=>{o(null)}}return s.current=n,()=>{s.current=null}}});return()=>{i.forEach(s=>s?.())}},e);return T.useMemo(()=>e.every(n=>n==null)?null:n=>{t.current&&(t.current(),t.current=void 0),n!=null&&(t.current=r(n))},e)}const I8={...Gk};let PF=!1,O8=0;const MF=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+O8++;function N8(){const[e,t]=T.useState(()=>PF?MF():void 0);return fb(()=>{e==null&&t(MF())},[]),T.useEffect(()=>{PF=!0},[]),e}const B8=I8.useId,H8=B8||N8;function G8(){const e=new Map;return{emit(t,r){var n;(n=e.get(t))==null||n.forEach(i=>i(r))},on(t,r){e.has(t)||e.set(t,new Set),e.get(t).add(r)},off(t,r){var n;(n=e.get(t))==null||n.delete(r)}}}const V8=T.createContext(null),z8=T.createContext(null),W8=()=>{var e;return((e=T.useContext(V8))==null?void 0:e.id)||null},U8=()=>T.useContext(z8);function $8(e){const{open:t=!1,onOpenChange:r,elements:n}=e,i=H8(),s=T.useRef({}),[o]=T.useState(()=>G8()),a=W8()!=null,[u,d]=T.useState(n.reference),h=U6((v,w,C)=>{s.current.openEvent=v?w:void 0,o.emit("openchange",{open:v,event:w,reason:C,nested:a}),r?.(v,w,C)}),g=T.useMemo(()=>({setPositionReference:d}),[]),m=T.useMemo(()=>({reference:u||n.reference||null,floating:n.floating||null,domReference:n.reference}),[u,n.reference,n.floating]);return T.useMemo(()=>({dataRef:s,open:t,onOpenChange:h,elements:m,events:o,floatingId:i,refs:g}),[t,h,m,o,i,g])}function j8(e){e===void 0&&(e={});const{nodeId:t}=e,r=$8({...e,elements:{reference:null,floating:null,...e.elements}}),n=e.rootContext||r,i=n.elements,[s,o]=T.useState(null),[a,u]=T.useState(null),h=i?.domReference||s,g=T.useRef(null),m=U8();fb(()=>{h&&(g.current=h)},[h]);const v=D8({...e,elements:{...i,...a&&{reference:a}}}),w=T.useCallback(E=>{const A=zn(E)?{getBoundingClientRect:()=>E.getBoundingClientRect(),getClientRects:()=>E.getClientRects(),contextElement:E}:E;u(A),v.refs.setReference(A)},[v.refs]),C=T.useCallback(E=>{(zn(E)||E===null)&&(g.current=E,o(E)),(zn(v.refs.reference.current)||v.refs.reference.current===null||E!==null&&!zn(E))&&v.refs.setReference(E)},[v.refs]),b=T.useMemo(()=>({...v.refs,setReference:C,setPositionReference:w,domReference:g}),[v.refs,C,w]),x=T.useMemo(()=>({...v.elements,domReference:h}),[v.elements,h]),R=T.useMemo(()=>({...v,...n,refs:b,elements:x,nodeId:t}),[v,b,x,t,n]);return fb(()=>{n.dataRef.current.floatingContext=R;const E=m?.nodesRef.current.find(A=>A.id===t);E&&(E.context=R)}),T.useMemo(()=>({...v,context:R,refs:b,elements:x}),[v,b,x,R])}const[Y8,ls]=ld("ScrollArea.Root component was not found in tree");function qu(e,t){const r=Ml(t);Lf(()=>{let n=0;if(e){const i=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return i.observe(e),()=>{window.cancelAnimationFrame(n),i.unobserve(e)}}},[e,r])}const K8=T.forwardRef((e,t)=>{const{style:r,...n}=e,i=ls(),[s,o]=T.useState(0),[a,u]=T.useState(0),d=!!(s&&a);return qu(i.scrollbarX,()=>{const h=i.scrollbarX?.offsetHeight||0;i.onCornerHeightChange(h),u(h)}),qu(i.scrollbarY,()=>{const h=i.scrollbarY?.offsetWidth||0;i.onCornerWidthChange(h),o(h)}),d?Z.jsx("div",{...n,ref:t,style:{...r,width:s,height:a}}):null}),q8=T.forwardRef((e,t)=>{const r=ls(),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?Z.jsx(K8,{...e,ref:t}):null}),X8={scrollHideDelay:1e3,type:"hover"},LP=T.forwardRef((e,t)=>{const{type:r,scrollHideDelay:n,scrollbars:i,getStyles:s,...o}=rt("ScrollAreaRoot",X8,e),[a,u]=T.useState(null),[d,h]=T.useState(null),[g,m]=T.useState(null),[v,w]=T.useState(null),[C,b]=T.useState(null),[x,R]=T.useState(0),[E,A]=T.useState(0),[D,M]=T.useState(!1),[F,O]=T.useState(!1),L=as(t,W=>u(W));return Z.jsx(Y8,{value:{type:r,scrollHideDelay:n,scrollArea:a,viewport:d,onViewportChange:h,content:g,onContentChange:m,scrollbarX:v,onScrollbarXChange:w,scrollbarXEnabled:D,onScrollbarXEnabledChange:M,scrollbarY:C,onScrollbarYChange:b,scrollbarYEnabled:F,onScrollbarYEnabledChange:O,onCornerWidthChange:R,onCornerHeightChange:A,getStyles:s},children:Z.jsx(Dt,{...o,ref:L,__vars:{"--sa-corner-width":i!=="xy"?"0px":`${x}px`,"--sa-corner-height":i!=="xy"?"0px":`${E}px`}})})});LP.displayName="@mantine/core/ScrollAreaRoot";function IP(e,t){const r=e/t;return Number.isNaN(r)?0:r}function Fm(e){const t=IP(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,n=(e.scrollbar.size-r)*t;return Math.max(n,18)}function OP(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(e[1]-e[0]);return t[0]+n*(r-e[0])}}function Q8(e,[t,r]){return Math.min(r,Math.max(t,e))}function _F(e,t,r="ltr"){const n=Fm(t),i=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,s=t.scrollbar.size-i,o=t.content-t.viewport,a=s-n,u=r==="ltr"?[0,o]:[o*-1,0],d=Q8(e,u);return OP([0,o],[0,a])(d)}function Z8(e,t,r,n="ltr"){const i=Fm(r),s=i/2,o=t||s,a=i-o,u=r.scrollbar.paddingStart+o,d=r.scrollbar.size-r.scrollbar.paddingEnd-a,h=r.content-r.viewport,g=n==="ltr"?[0,h]:[h*-1,0];return OP([u,d],g)(e)}function NP(e,t){return e>0&&e<t}function S0(e){return e?parseInt(e,10):0}function Bl(e,t,{checkForDefaultPrevented:r=!0}={}){return n=>{e?.(n),(r===!1||!n.defaultPrevented)&&t?.(n)}}const[J8,BP]=ld("ScrollAreaScrollbar was not found in tree"),HP=T.forwardRef((e,t)=>{const{sizes:r,hasThumb:n,onThumbChange:i,onThumbPointerUp:s,onThumbPointerDown:o,onThumbPositionChange:a,onDragScroll:u,onWheelScroll:d,onResize:h,...g}=e,m=ls(),[v,w]=T.useState(null),C=as(t,O=>w(O)),b=T.useRef(null),x=T.useRef(""),{viewport:R}=m,E=r.content-r.viewport,A=Ml(d),D=Ml(a),M=ym(h,10),F=O=>{if(b.current){const L=O.clientX-b.current.left,W=O.clientY-b.current.top;u({x:L,y:W})}};return T.useEffect(()=>{const O=L=>{const W=L.target;v?.contains(W)&&A(L,E)};return document.addEventListener("wheel",O,{passive:!1}),()=>document.removeEventListener("wheel",O,{passive:!1})},[R,v,E,A]),T.useEffect(D,[r,D]),qu(v,M),qu(m.content,M),Z.jsx(J8,{value:{scrollbar:v,hasThumb:n,onThumbChange:Ml(i),onThumbPointerUp:Ml(s),onThumbPositionChange:D,onThumbPointerDown:Ml(o)},children:Z.jsx("div",{...g,ref:C,"data-mantine-scrollbar":!0,style:{position:"absolute",...g.style},onPointerDown:Bl(e.onPointerDown,O=>{O.preventDefault(),O.button===0&&(O.target.setPointerCapture(O.pointerId),b.current=v.getBoundingClientRect(),x.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",F(O))}),onPointerMove:Bl(e.onPointerMove,F),onPointerUp:Bl(e.onPointerUp,O=>{const L=O.target;L.hasPointerCapture(O.pointerId)&&(O.preventDefault(),L.releasePointerCapture(O.pointerId))}),onLostPointerCapture:()=>{document.body.style.webkitUserSelect=x.current,b.current=null}})})}),GP=T.forwardRef((e,t)=>{const{sizes:r,onSizesChange:n,style:i,...s}=e,o=ls(),[a,u]=T.useState(),d=T.useRef(null),h=as(t,d,o.onScrollbarXChange);return T.useEffect(()=>{d.current&&u(getComputedStyle(d.current))},[d]),Z.jsx(HP,{"data-orientation":"horizontal",...s,ref:h,sizes:r,style:{...i,"--sa-thumb-width":`${Fm(r)}px`},onThumbPointerDown:g=>e.onThumbPointerDown(g.x),onDragScroll:g=>e.onDragScroll(g.x),onWheelScroll:(g,m)=>{if(o.viewport){const v=o.viewport.scrollLeft+g.deltaX;e.onWheelScroll(v),NP(v,m)&&g.preventDefault()}},onResize:()=>{d.current&&o.viewport&&a&&n({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:S0(a.paddingLeft),paddingEnd:S0(a.paddingRight)}})}})});GP.displayName="@mantine/core/ScrollAreaScrollbarX";const VP=T.forwardRef((e,t)=>{const{sizes:r,onSizesChange:n,style:i,...s}=e,o=ls(),[a,u]=T.useState(),d=T.useRef(null),h=as(t,d,o.onScrollbarYChange);return T.useEffect(()=>{d.current&&u(window.getComputedStyle(d.current))},[]),Z.jsx(HP,{...s,"data-orientation":"vertical",ref:h,sizes:r,style:{"--sa-thumb-height":`${Fm(r)}px`,...i},onThumbPointerDown:g=>e.onThumbPointerDown(g.y),onDragScroll:g=>e.onDragScroll(g.y),onWheelScroll:(g,m)=>{if(o.viewport){const v=o.viewport.scrollTop+g.deltaY;e.onWheelScroll(v),NP(v,m)&&g.preventDefault()}},onResize:()=>{d.current&&o.viewport&&a&&n({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:S0(a.paddingTop),paddingEnd:S0(a.paddingBottom)}})}})});VP.displayName="@mantine/core/ScrollAreaScrollbarY";const Dm=T.forwardRef((e,t)=>{const{orientation:r="vertical",...n}=e,{dir:i}=TS(),s=ls(),o=T.useRef(null),a=T.useRef(0),[u,d]=T.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),h=IP(u.viewport,u.content),g={...n,sizes:u,onSizesChange:d,hasThumb:h>0&&h<1,onThumbChange:v=>{o.current=v},onThumbPointerUp:()=>{a.current=0},onThumbPointerDown:v=>{a.current=v}},m=(v,w)=>Z8(v,a.current,u,w);return r==="horizontal"?Z.jsx(GP,{...g,ref:t,onThumbPositionChange:()=>{if(s.viewport&&o.current){const v=s.viewport.scrollLeft,w=_F(v,u,i);o.current.style.transform=`translate3d(${w}px, 0, 0)`}},onWheelScroll:v=>{s.viewport&&(s.viewport.scrollLeft=v)},onDragScroll:v=>{s.viewport&&(s.viewport.scrollLeft=m(v,i))}}):r==="vertical"?Z.jsx(VP,{...g,ref:t,onThumbPositionChange:()=>{if(s.viewport&&o.current){const v=s.viewport.scrollTop,w=_F(v,u);u.scrollbar.size===0?o.current.style.setProperty("--thumb-opacity","0"):o.current.style.setProperty("--thumb-opacity","1"),o.current.style.transform=`translate3d(0, ${w}px, 0)`}},onWheelScroll:v=>{s.viewport&&(s.viewport.scrollTop=v)},onDragScroll:v=>{s.viewport&&(s.viewport.scrollTop=m(v))}}):null});Dm.displayName="@mantine/core/ScrollAreaScrollbarVisible";const LS=T.forwardRef((e,t)=>{const r=ls(),{forceMount:n,...i}=e,[s,o]=T.useState(!1),a=e.orientation==="horizontal",u=ym(()=>{if(r.viewport){const d=r.viewport.offsetWidth<r.viewport.scrollWidth,h=r.viewport.offsetHeight<r.viewport.scrollHeight;o(a?d:h)}},10);return qu(r.viewport,u),qu(r.content,u),n||s?Z.jsx(Dm,{"data-state":s?"visible":"hidden",...i,ref:t}):null});LS.displayName="@mantine/core/ScrollAreaScrollbarAuto";const zP=T.forwardRef((e,t)=>{const{forceMount:r,...n}=e,i=ls(),[s,o]=T.useState(!1);return T.useEffect(()=>{const{scrollArea:a}=i;let u=0;if(a){const d=()=>{window.clearTimeout(u),o(!0)},h=()=>{u=window.setTimeout(()=>o(!1),i.scrollHideDelay)};return a.addEventListener("pointerenter",d),a.addEventListener("pointerleave",h),()=>{window.clearTimeout(u),a.removeEventListener("pointerenter",d),a.removeEventListener("pointerleave",h)}}},[i.scrollArea,i.scrollHideDelay]),r||s?Z.jsx(LS,{"data-state":s?"visible":"hidden",...n,ref:t}):null});zP.displayName="@mantine/core/ScrollAreaScrollbarHover";const eV=T.forwardRef((e,t)=>{const{forceMount:r,...n}=e,i=ls(),s=e.orientation==="horizontal",[o,a]=T.useState("hidden"),u=ym(()=>a("idle"),100);return T.useEffect(()=>{if(o==="idle"){const d=window.setTimeout(()=>a("hidden"),i.scrollHideDelay);return()=>window.clearTimeout(d)}},[o,i.scrollHideDelay]),T.useEffect(()=>{const{viewport:d}=i,h=s?"scrollLeft":"scrollTop";if(d){let g=d[h];const m=()=>{const v=d[h];g!==v&&(a("scrolling"),u()),g=v};return d.addEventListener("scroll",m),()=>d.removeEventListener("scroll",m)}},[i.viewport,s,u]),r||o!=="hidden"?Z.jsx(Dm,{"data-state":o==="hidden"?"hidden":"visible",...n,ref:t,onPointerEnter:Bl(e.onPointerEnter,()=>a("interacting")),onPointerLeave:Bl(e.onPointerLeave,()=>a("idle"))}):null}),gb=T.forwardRef((e,t)=>{const{forceMount:r,...n}=e,i=ls(),{onScrollbarXEnabledChange:s,onScrollbarYEnabledChange:o}=i,a=e.orientation==="horizontal";return T.useEffect(()=>(a?s(!0):o(!0),()=>{a?s(!1):o(!1)}),[a,s,o]),i.type==="hover"?Z.jsx(zP,{...n,ref:t,forceMount:r}):i.type==="scroll"?Z.jsx(eV,{...n,ref:t,forceMount:r}):i.type==="auto"?Z.jsx(LS,{...n,ref:t,forceMount:r}):i.type==="always"?Z.jsx(Dm,{...n,ref:t}):null});gb.displayName="@mantine/core/ScrollAreaScrollbar";function tV(e,t=()=>{}){let r={left:e.scrollLeft,top:e.scrollTop},n=0;return(function i(){const s={left:e.scrollLeft,top:e.scrollTop},o=r.left!==s.left,a=r.top!==s.top;(o||a)&&t(),r=s,n=window.requestAnimationFrame(i)})(),()=>window.cancelAnimationFrame(n)}const WP=T.forwardRef((e,t)=>{const{style:r,...n}=e,i=ls(),s=BP(),{onThumbPositionChange:o}=s,a=as(t,h=>s.onThumbChange(h)),u=T.useRef(void 0),d=ym(()=>{u.current&&(u.current(),u.current=void 0)},100);return T.useEffect(()=>{const{viewport:h}=i;if(h){const g=()=>{if(d(),!u.current){const m=tV(h,o);u.current=m,o()}};return o(),h.addEventListener("scroll",g),()=>h.removeEventListener("scroll",g)}},[i.viewport,d,o]),Z.jsx("div",{"data-state":s.hasThumb?"visible":"hidden",...n,ref:a,style:{width:"var(--sa-thumb-width)",height:"var(--sa-thumb-height)",...r},onPointerDownCapture:Bl(e.onPointerDownCapture,h=>{const m=h.target.getBoundingClientRect(),v=h.clientX-m.left,w=h.clientY-m.top;s.onThumbPointerDown({x:v,y:w})}),onPointerUp:Bl(e.onPointerUp,s.onThumbPointerUp)})});WP.displayName="@mantine/core/ScrollAreaThumb";const pb=T.forwardRef((e,t)=>{const{forceMount:r,...n}=e,i=BP();return r||i.hasThumb?Z.jsx(WP,{ref:t,...n}):null});pb.displayName="@mantine/core/ScrollAreaThumb";const UP=T.forwardRef(({children:e,style:t,...r},n)=>{const i=ls(),s=as(n,i.onViewportChange);return Z.jsx(Dt,{...r,ref:s,style:{overflowX:i.scrollbarXEnabled?"scroll":"hidden",overflowY:i.scrollbarYEnabled?"scroll":"hidden",...t},children:Z.jsx("div",{...i.getStyles("content"),ref:i.onContentChange,children:e})})});UP.displayName="@mantine/core/ScrollAreaViewport";var IS={root:"m_d57069b5",content:"m_b1336c6",viewport:"m_c0783ff9",viewportInner:"m_f8f631dd",scrollbar:"m_c44ba933",thumb:"m_d8b5e363",corner:"m_21657268"};const $P={scrollHideDelay:1e3,type:"hover",scrollbars:"xy"},rV=(e,{scrollbarSize:t,overscrollBehavior:r})=>({root:{"--scrollarea-scrollbar-size":Le(t),"--scrollarea-over-scroll-behavior":r}}),gd=ct((e,t)=>{const r=rt("ScrollArea",$P,e),{classNames:n,className:i,style:s,styles:o,unstyled:a,scrollbarSize:u,vars:d,type:h,scrollHideDelay:g,viewportProps:m,viewportRef:v,onScrollPositionChange:w,children:C,offsetScrollbars:b,scrollbars:x,onBottomReached:R,onTopReached:E,overscrollBehavior:A,attributes:D,...M}=r,[F,O]=T.useState(!1),[L,W]=T.useState(!1),[I,G]=T.useState(!1),ne=wr({name:"ScrollArea",props:r,classes:IS,className:i,style:s,classNames:n,styles:o,unstyled:a,attributes:D,vars:d,varsResolver:rV}),ie=T.useRef(null),J=_P([v,ie]);return T.useEffect(()=>{if(!ie.current||b!=="present")return;const _=ie.current,Y=new ResizeObserver(()=>{const{scrollHeight:Q,clientHeight:U,scrollWidth:se,clientWidth:N}=_;W(Q>U),G(se>N)});return Y.observe(_),()=>Y.disconnect()},[ie,b]),Z.jsxs(LP,{getStyles:ne,type:h==="never"?"always":h,scrollHideDelay:g,ref:t,scrollbars:x,...ne("root"),...M,children:[Z.jsx(UP,{...m,...ne("viewport",{style:m?.style}),ref:J,"data-offset-scrollbars":b===!0?"xy":b||void 0,"data-scrollbars":x||void 0,"data-horizontal-hidden":b==="present"&&!I?"true":void 0,"data-vertical-hidden":b==="present"&&!L?"true":void 0,onScroll:_=>{m?.onScroll?.(_),w?.({x:_.currentTarget.scrollLeft,y:_.currentTarget.scrollTop});const{scrollTop:Y,scrollHeight:Q,clientHeight:U}=_.currentTarget;Y-(Q-U)>=-.6&&R?.(),Y===0&&E?.()},children:C}),(x==="xy"||x==="x")&&Z.jsx(gb,{...ne("scrollbar"),orientation:"horizontal","data-hidden":h==="never"||b==="present"&&!I?!0:void 0,forceMount:!0,onMouseEnter:()=>O(!0),onMouseLeave:()=>O(!1),children:Z.jsx(pb,{...ne("thumb")})}),(x==="xy"||x==="y")&&Z.jsx(gb,{...ne("scrollbar"),orientation:"vertical","data-hidden":h==="never"||b==="present"&&!L?!0:void 0,forceMount:!0,onMouseEnter:()=>O(!0),onMouseLeave:()=>O(!1),children:Z.jsx(pb,{...ne("thumb")})}),Z.jsx(q8,{...ne("corner"),"data-hovered":F||void 0,"data-hidden":h==="never"||void 0})]})});gd.displayName="@mantine/core/ScrollArea";const OS=ct((e,t)=>{const{children:r,classNames:n,styles:i,scrollbarSize:s,scrollHideDelay:o,type:a,dir:u,offsetScrollbars:d,viewportRef:h,onScrollPositionChange:g,unstyled:m,variant:v,viewportProps:w,scrollbars:C,style:b,vars:x,onBottomReached:R,onTopReached:E,onOverflowChange:A,...D}=rt("ScrollAreaAutosize",$P,e),M=T.useRef(null),F=_P([h,M]),[O,L]=T.useState(!1),W=T.useRef(!1);return T.useEffect(()=>{if(!A)return;const I=M.current;if(!I)return;const G=()=>{const ie=I.scrollHeight>I.clientHeight;ie!==O&&(W.current?A?.(ie):(W.current=!0,ie&&A?.(!0)),L(ie))};G();const ne=new ResizeObserver(G);return ne.observe(I),()=>ne.disconnect()},[A,O]),Z.jsx(Dt,{...D,ref:t,style:[{display:"flex",overflow:"hidden"},b],children:Z.jsx(Dt,{style:{display:"flex",flexDirection:"column",flex:1,overflow:"hidden",...C==="y"&&{minWidth:0},...C==="x"&&{minHeight:0},...C==="xy"&&{minWidth:0,minHeight:0},...C===!1&&{minWidth:0,minHeight:0}},children:Z.jsx(gd,{classNames:n,styles:i,scrollHideDelay:o,scrollbarSize:s,type:a,dir:u,offsetScrollbars:d,viewportRef:F,onScrollPositionChange:g,unstyled:m,variant:v,viewportProps:w,vars:x,scrollbars:C,onBottomReached:R,onTopReached:E,"data-autosize":"true",children:r})})})});gd.classes=IS;OS.displayName="@mantine/core/ScrollAreaAutosize";OS.classes=IS;gd.Autosize=OS;var jP={root:"m_87cf2631"};const nV={__staticSelector:"UnstyledButton"},Bo=dd((e,t)=>{const r=rt("UnstyledButton",nV,e),{className:n,component:i="button",__staticSelector:s,unstyled:o,classNames:a,styles:u,style:d,attributes:h,...g}=r,m=wr({name:s,props:r,classes:jP,className:n,style:d,classNames:a,styles:u,unstyled:o,attributes:h});return Z.jsx(Dt,{...m("root",{focusable:!0}),component:i,ref:t,type:i==="button"?"button":void 0,...g})});Bo.classes=jP;Bo.displayName="@mantine/core/UnstyledButton";var YP={root:"m_515a97f8"};const NS=ct((e,t)=>{const r=rt("VisuallyHidden",null,e),{classNames:n,className:i,style:s,styles:o,unstyled:a,vars:u,attributes:d,...h}=r,g=wr({name:"VisuallyHidden",classes:YP,props:r,className:i,style:s,classNames:n,styles:o,unstyled:a,attributes:d});return Z.jsx(Dt,{component:"span",ref:t,...g("root"),...h})});NS.classes=YP;NS.displayName="@mantine/core/VisuallyHidden";var KP={root:"m_1b7284a3"};const iV=(e,{radius:t,shadow:r})=>({root:{"--paper-radius":t===void 0?void 0:cd(t),"--paper-shadow":CS(r)}}),BS=dd((e,t)=>{const r=rt("Paper",null,e),{classNames:n,className:i,style:s,styles:o,unstyled:a,withBorder:u,vars:d,radius:h,shadow:g,variant:m,mod:v,attributes:w,...C}=r,b=wr({name:"Paper",props:r,classes:KP,className:i,style:s,classNames:n,styles:o,unstyled:a,attributes:w,vars:d,varsResolver:iV});return Z.jsx(Dt,{ref:t,mod:[{"data-with-border":u},v],...b("root"),variant:m,...C})});BS.classes=KP;BS.displayName="@mantine/core/Paper";function LF(e,t,r,n){return e==="center"||n==="center"?{top:t}:e==="end"?{bottom:r}:e==="start"?{top:r}:{}}function IF(e,t,r,n,i){return e==="center"||n==="center"?{left:t}:e==="end"?{[i==="ltr"?"right":"left"]:r}:e==="start"?{[i==="ltr"?"left":"right"]:r}:{}}const sV={bottom:"borderTopLeftRadius",left:"borderTopRightRadius",right:"borderBottomLeftRadius",top:"borderBottomRightRadius"};function oV({position:e,arrowSize:t,arrowOffset:r,arrowRadius:n,arrowPosition:i,arrowX:s,arrowY:o,dir:a}){const[u,d="center"]=e.split("-"),h={width:t,height:t,transform:"rotate(45deg)",position:"absolute",[sV[u]]:n},g=-t/2;return u==="left"?{...h,...LF(d,o,r,i),right:g,borderLeftColor:"transparent",borderBottomColor:"transparent",clipPath:"polygon(100% 0, 0 0, 100% 100%)"}:u==="right"?{...h,...LF(d,o,r,i),left:g,borderRightColor:"transparent",borderTopColor:"transparent",clipPath:"polygon(0 100%, 0 0, 100% 100%)"}:u==="top"?{...h,...IF(d,s,r,i,a),bottom:g,borderTopColor:"transparent",borderLeftColor:"transparent",clipPath:"polygon(0 100%, 100% 100%, 100% 0)"}:u==="bottom"?{...h,...IF(d,s,r,i,a),top:g,borderBottomColor:"transparent",borderRightColor:"transparent",clipPath:"polygon(0 100%, 0 0, 100% 0)"}:{}}const qP=T.forwardRef(({position:e,arrowSize:t,arrowOffset:r,arrowRadius:n,arrowPosition:i,visible:s,arrowX:o,arrowY:a,style:u,...d},h)=>{const{dir:g}=TS();return s?Z.jsx("div",{...d,ref:h,style:{...u,...oV({position:e,arrowSize:t,arrowOffset:r,arrowRadius:n,arrowPosition:i,dir:g,arrowX:o,arrowY:a})}}):null});qP.displayName="@mantine/core/FloatingArrow";function aV(e,t){if(e==="rtl"&&(t.includes("right")||t.includes("left"))){const[r,n]=t.split("-"),i=r==="right"?"left":"right";return n===void 0?i:`${i}-${n}`}return t}var XP={root:"m_9814e45f"};const lV={zIndex:hc("modal")},cV=(e,{gradient:t,color:r,backgroundOpacity:n,blur:i,radius:s,zIndex:o})=>({root:{"--overlay-bg":t||(r!==void 0||n!==void 0)&&zs(r||"#000",n??.6)||void 0,"--overlay-filter":i?`blur(${Le(i)})`:void 0,"--overlay-radius":s===void 0?void 0:cd(s),"--overlay-z-index":o?.toString()}}),Am=dd((e,t)=>{const r=rt("Overlay",lV,e),{classNames:n,className:i,style:s,styles:o,unstyled:a,vars:u,fixed:d,center:h,children:g,radius:m,zIndex:v,gradient:w,blur:C,color:b,backgroundOpacity:x,mod:R,attributes:E,...A}=r,D=wr({name:"Overlay",props:r,classes:XP,className:i,style:s,classNames:n,styles:o,unstyled:a,attributes:E,vars:u,varsResolver:cV});return Z.jsx(Dt,{ref:t,...D("root"),mod:[{center:h,fixed:d},R],...A,children:g})});Am.classes=XP;Am.displayName="@mantine/core/Overlay";function ty(e){const t=document.createElement("div");return t.setAttribute("data-portal","true"),typeof e.className=="string"&&t.classList.add(...e.className.split(" ").filter(Boolean)),typeof e.style=="object"&&Object.assign(t.style,e.style),typeof e.id=="string"&&t.setAttribute("id",e.id),t}function uV({target:e,reuseTargetNode:t,...r}){if(e)return typeof e=="string"?document.querySelector(e)||ty(r):e;if(t){const n=document.querySelector("[data-mantine-shared-portal-node]");if(n)return n;const i=ty(r);return i.setAttribute("data-mantine-shared-portal-node","true"),document.body.appendChild(i),i}return ty(r)}const dV={reuseTargetNode:!0},QP=ct((e,t)=>{const{children:r,target:n,reuseTargetNode:i,...s}=rt("Portal",dV,e),[o,a]=T.useState(!1),u=T.useRef(null);return Lf(()=>(a(!0),u.current=uV({target:n,reuseTargetNode:i,...s}),ob(t,u.current),!n&&!i&&u.current&&document.body.appendChild(u.current),()=>{!n&&!i&&u.current&&document.body.removeChild(u.current)}),[n]),!o||!u.current?null:Of.createPortal(Z.jsx(Z.Fragment,{children:r}),u.current)});QP.displayName="@mantine/core/Portal";const km=ct(({withinPortal:e=!0,children:t,...r},n)=>Sm()==="test"||!e?Z.jsx(Z.Fragment,{children:t}):Z.jsx(QP,{ref:n,...r,children:t}));km.displayName="@mantine/core/OptionalPortal";const yh=e=>({in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:`scale(.9) translateY(${e==="bottom"?10:-10}px)`},transitionProperty:"transform, opacity"}),Ep={fade:{in:{opacity:1},out:{opacity:0},transitionProperty:"opacity"},"fade-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(30px)"},transitionProperty:"opacity, transform"},"fade-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-30px)"},transitionProperty:"opacity, transform"},"fade-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(30px)"},transitionProperty:"opacity, transform"},"fade-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-30px)"},transitionProperty:"opacity, transform"},scale:{in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:"scale(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-y":{in:{opacity:1,transform:"scaleY(1)"},out:{opacity:0,transform:"scaleY(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-x":{in:{opacity:1,transform:"scaleX(1)"},out:{opacity:0,transform:"scaleX(0)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"skew-up":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:"translateY(-20px) skew(-10deg, -5deg)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"skew-down":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:"translateY(20px) skew(-10deg, -5deg)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-left":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:"translateY(20px) rotate(-5deg)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-right":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:"translateY(20px) rotate(5deg)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-100%)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(100%)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"slide-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(100%)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"slide-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-100%)"},common:{transformOrigin:"right"},transitionProperty:"transform, opacity"},pop:{...yh("bottom"),common:{transformOrigin:"center center"}},"pop-bottom-left":{...yh("bottom"),common:{transformOrigin:"bottom left"}},"pop-bottom-right":{...yh("bottom"),common:{transformOrigin:"bottom right"}},"pop-top-left":{...yh("top"),common:{transformOrigin:"top left"}},"pop-top-right":{...yh("top"),common:{transformOrigin:"top right"}}},OF={entering:"in",entered:"in",exiting:"out",exited:"out","pre-exiting":"out","pre-entering":"out"};function hV({transition:e,state:t,duration:r,timingFunction:n}){const i={WebkitBackfaceVisibility:"hidden",transitionDuration:`${r}ms`,transitionTimingFunction:n};return typeof e=="string"?e in Ep?{transitionProperty:Ep[e].transitionProperty,...i,...Ep[e].common,...Ep[e][OF[t]]}:{}:{transitionProperty:e.transitionProperty,...i,...e.common,...e[OF[t]]}}function fV({duration:e,exitDuration:t,timingFunction:r,mounted:n,onEnter:i,onExit:s,onEntered:o,onExited:a,enterDelay:u,exitDelay:d}){const h=el(),g=cP(),m=h.respectReducedMotion?g:!1,[v,w]=T.useState(m?0:e),[C,b]=T.useState(n?"entered":"exited"),x=T.useRef(-1),R=T.useRef(-1),E=T.useRef(-1);function A(){window.clearTimeout(x.current),window.clearTimeout(R.current),cancelAnimationFrame(E.current)}const D=F=>{A();const O=F?i:s,L=F?o:a,W=m?0:F?e:t;w(W),W===0?(typeof O=="function"&&O(),typeof L=="function"&&L(),b(F?"entered":"exited")):E.current=requestAnimationFrame(()=>{bP.flushSync(()=>{b(F?"pre-entering":"pre-exiting")}),E.current=requestAnimationFrame(()=>{typeof O=="function"&&O(),b(F?"entering":"exiting"),x.current=window.setTimeout(()=>{typeof L=="function"&&L(),b(F?"entered":"exited")},W)})})},M=F=>{if(A(),typeof(F?u:d)!="number"){D(F);return}R.current=window.setTimeout(()=>{D(F)},F?u:d)};return _h(()=>{M(n)},[n]),T.useEffect(()=>()=>{A()},[]),{transitionDuration:v,transitionStatus:C,transitionTimingFunction:r||"ease"}}function Bf({keepMounted:e,transition:t="fade",duration:r=250,exitDuration:n=r,mounted:i,children:s,timingFunction:o="ease",onExit:a,onEntered:u,onEnter:d,onExited:h,enterDelay:g,exitDelay:m}){const v=Sm(),{transitionDuration:w,transitionStatus:C,transitionTimingFunction:b}=fV({mounted:i,exitDuration:n,duration:r,timingFunction:o,onExit:a,onEntered:u,onEnter:d,onExited:h,enterDelay:g,exitDelay:m});return w===0||v==="test"?i?Z.jsx(Z.Fragment,{children:s({})}):e?s({display:"none"}):null:C==="exited"?e?s({display:"none"}):null:Z.jsx(Z.Fragment,{children:s(hV({transition:t,duration:w,state:C,timingFunction:b}))})}Bf.displayName="@mantine/core/Transition";const[gV,ZP]=ld("Popover component was not found in the tree");function Pm({children:e,active:t=!0,refProp:r="ref",innerRef:n}){const i=J5(t),s=as(i,n);return _f(e)?T.cloneElement(e,{[r]:s}):e}function JP(e){return Z.jsx(NS,{tabIndex:-1,"data-autofocus":!0,...e})}Pm.displayName="@mantine/core/FocusTrap";JP.displayName="@mantine/core/FocusTrapInitialFocus";Pm.InitialFocus=JP;var eM={dropdown:"m_38a85659",arrow:"m_a31dc6c1",overlay:"m_3d7bc908"};const HS=ct((e,t)=>{const r=rt("PopoverDropdown",null,e),{className:n,style:i,vars:s,children:o,onKeyDownCapture:a,variant:u,classNames:d,styles:h,...g}=r,m=ZP(),v=sP({opened:m.opened,shouldReturnFocus:m.returnFocus}),w=m.withRoles?{"aria-labelledby":m.getTargetId(),id:m.getDropdownId(),role:"dialog",tabIndex:-1}:{},C=as(t,m.floating);return m.disabled?null:Z.jsx(km,{...m.portalProps,withinPortal:m.withinPortal,children:Z.jsx(Bf,{mounted:m.opened,...m.transitionProps,transition:m.transitionProps?.transition||"fade",duration:m.transitionProps?.duration??150,keepMounted:m.keepMounted,exitDuration:typeof m.transitionProps?.exitDuration=="number"?m.transitionProps.exitDuration:m.transitionProps?.duration,children:b=>Z.jsx(Pm,{active:m.trapFocus&&m.opened,innerRef:C,children:Z.jsxs(Dt,{...w,...g,variant:u,onKeyDownCapture:G5(()=>{m.onClose?.(),m.onDismiss?.()},{active:m.closeOnEscape,onTrigger:v,onKeyDown:a}),"data-position":m.placement,"data-fixed":m.floatingStrategy==="fixed"||void 0,...m.getStyles("dropdown",{className:n,props:r,classNames:d,styles:h,style:[{...b,zIndex:m.zIndex,top:m.y??0,left:m.x??0,width:m.width==="target"?void 0:Le(m.width),...m.referenceHidden?{display:"none"}:null},m.resolvedStyles.dropdown,h?.dropdown,i]}),children:[o,Z.jsx(qP,{ref:m.arrowRef,arrowX:m.arrowX,arrowY:m.arrowY,visible:m.withArrow,position:m.placement,arrowSize:m.arrowSize,arrowRadius:m.arrowRadius,arrowOffset:m.arrowOffset,arrowPosition:m.arrowPosition,...m.getStyles("arrow",{props:r,classNames:d,styles:h})})]})})})})});HS.classes=eM;HS.displayName="@mantine/core/PopoverDropdown";const pV={refProp:"ref",popupType:"dialog"},tM=ct((e,t)=>{const{children:r,refProp:n,popupType:i,...s}=rt("PopoverTarget",pV,e);if(!_f(r))throw new Error("Popover.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const o=s,a=ZP(),u=as(a.reference,uP(r),t),d=a.withRoles?{"aria-haspopup":i,"aria-expanded":a.opened,"aria-controls":a.getDropdownId(),id:a.getTargetId()}:{};return T.cloneElement(r,{...o,...d,...a.targetProps,className:Di(a.targetProps.className,o.className,r.props.className),[n]:u,...a.controlled?null:{onClick:()=>{a.onToggle(),r.props.onClick?.()}}})});tM.displayName="@mantine/core/PopoverTarget";function mV(e){if(e===void 0)return{shift:!0,flip:!0};const t={...e};return e.shift===void 0&&(t.shift=!0),e.flip===void 0&&(t.flip=!0),t}function vV(e,t,r){const n=mV(e.middlewares),i=[k8(e.offset),_8()];return e.dropdownVisible&&r!=="test"&&e.preventPositionChangeWhenVisible&&(n.flip=!1),n.shift&&i.push(P8(typeof n.shift=="boolean"?{limiter:DF(),padding:5}:{limiter:DF(),padding:5,...n.shift})),n.flip&&i.push(typeof n.flip=="boolean"?AF():AF(n.flip)),n.inline&&i.push(typeof n.inline=="boolean"?kF():kF(n.inline)),i.push(L8({element:e.arrowRef,padding:e.arrowOffset})),(n.size||e.width==="target")&&i.push(M8({...typeof n.size=="boolean"?{}:n.size,apply({rects:s,availableWidth:o,availableHeight:a,...u}){const h=t().refs.floating.current?.style??{};n.size&&(typeof n.size=="object"&&n.size.apply?n.size.apply({rects:s,availableWidth:o,availableHeight:a,...u}):Object.assign(h,{maxWidth:`${o}px`,maxHeight:`${a}px`})),e.width==="target"&&Object.assign(h,{width:`${s.reference.width}px`})}})),i}function wV(e){const t=Sm(),[r,n]=ju({value:e.opened,defaultValue:e.defaultOpened,finalValue:!1,onChange:e.onChange}),i=T.useRef(r),s=()=>{r&&!e.disabled&&n(!1)},o=()=>{e.disabled||n(!r)},a=j8({strategy:e.strategy,placement:e.preventPositionChangeWhenVisible?e.positionRef.current:e.position,middleware:vV(e,()=>a,t),whileElementsMounted:e.keepMounted?void 0:RF});return T.useEffect(()=>{if(!(!a.refs.reference.current||!a.refs.floating.current)&&r)return RF(a.refs.reference.current,a.refs.floating.current,a.update)},[r,a.update]),_h(()=>{e.onPositionChange?.(a.placement),e.positionRef.current=a.placement},[a.placement,e.preventPositionChangeWhenVisible]),_h(()=>{r!==i.current&&(r?e.onOpen?.():e.onClose?.()),i.current=r},[r,e.onClose,e.onOpen]),_h(()=>{let u=-1;return r&&(u=window.setTimeout(()=>e.setDropdownVisible(!0),4)),()=>{window.clearTimeout(u)}},[r,e.position]),{floating:a,controlled:typeof e.opened=="boolean",opened:r,onClose:s,onToggle:o}}const CV={position:"bottom",offset:8,positionDependencies:[],transitionProps:{transition:"fade",duration:150},middlewares:{flip:!0,shift:!0,inline:!1},arrowSize:7,arrowOffset:5,arrowRadius:0,arrowPosition:"side",closeOnClickOutside:!0,withinPortal:!0,closeOnEscape:!0,trapFocus:!1,withRoles:!0,returnFocus:!1,withOverlay:!1,hideDetached:!0,clickOutsideEvents:["mousedown","touchstart"],zIndex:hc("popover"),__staticSelector:"Popover",width:"max-content"},yV=(e,{radius:t,shadow:r})=>({dropdown:{"--popover-radius":t===void 0?void 0:cd(t),"--popover-shadow":CS(r)}});function bs(e){const t=rt("Popover",CV,e),{children:r,position:n,offset:i,onPositionChange:s,positionDependencies:o,opened:a,transitionProps:u,onExitTransitionEnd:d,onEnterTransitionEnd:h,width:g,middlewares:m,withArrow:v,arrowSize:w,arrowOffset:C,arrowRadius:b,arrowPosition:x,unstyled:R,classNames:E,styles:A,closeOnClickOutside:D,withinPortal:M,portalProps:F,closeOnEscape:O,clickOutsideEvents:L,trapFocus:W,onClose:I,onDismiss:G,onOpen:ne,onChange:ie,zIndex:J,radius:_,shadow:Y,id:Q,defaultOpened:U,__staticSelector:se,withRoles:N,disabled:P,returnFocus:V,variant:H,keepMounted:j,vars:ae,floatingStrategy:fe,withOverlay:le,overlayProps:de,hideDetached:ue,attributes:Ie,preventPositionChangeWhenVisible:q,...Ge}=t,Ye=wr({name:se,props:t,classes:eM,classNames:E,styles:A,unstyled:R,attributes:Ie,rootSelector:"dropdown",vars:ae,varsResolver:yV}),{resolvedStyles:Ze}=fc({classNames:E,styles:A,props:t}),[ke,De]=T.useState(a??U??!1),nt=T.useRef(n),vt=T.useRef(null),[Xe,st]=T.useState(null),[Ct,ar]=T.useState(null),{dir:qe}=TS(),hr=Sm(),Or=ud(Q),Et=wV({middlewares:m,width:g,position:aV(qe,n),offset:typeof i=="number"?i+(v?w/2:0):i,arrowRef:vt,arrowOffset:C,onPositionChange:s,positionDependencies:o,opened:a,defaultOpened:U,onChange:ie,onOpen:ne,onClose:I,onDismiss:G,strategy:fe,dropdownVisible:ke,setDropdownVisible:De,positionRef:nt,disabled:P,preventPositionChangeWhenVisible:q,keepMounted:j});U5(()=>{D&&(Et.onClose(),G?.())},L,[Xe,Ct]);const dt=T.useCallback(Tt=>{st(Tt),Et.floating.refs.setReference(Tt)},[Et.floating.refs.setReference]),At=T.useCallback(Tt=>{ar(Tt),Et.floating.refs.setFloating(Tt)},[Et.floating.refs.setFloating]),ht=T.useCallback(()=>{u?.onExited?.(),d?.(),De(!1),q||(nt.current=n)},[u?.onExited,d,q,n]),jt=T.useCallback(()=>{u?.onEntered?.(),h?.()},[u?.onEntered,h]);return Z.jsxs(gV,{value:{returnFocus:V,disabled:P,controlled:Et.controlled,reference:dt,floating:At,x:Et.floating.x,y:Et.floating.y,arrowX:Et.floating?.middlewareData?.arrow?.x,arrowY:Et.floating?.middlewareData?.arrow?.y,opened:Et.opened,arrowRef:vt,transitionProps:{...u,onExited:ht,onEntered:jt},width:g,withArrow:v,arrowSize:w,arrowOffset:C,arrowRadius:b,arrowPosition:x,placement:Et.floating.placement,trapFocus:W,withinPortal:M,portalProps:F,zIndex:J,radius:_,shadow:Y,closeOnEscape:O,onDismiss:G,onClose:Et.onClose,onToggle:Et.onToggle,getTargetId:()=>`${Or}-target`,getDropdownId:()=>`${Or}-dropdown`,withRoles:N,targetProps:Ge,__staticSelector:se,classNames:E,styles:A,unstyled:R,variant:H,keepMounted:j,getStyles:Ye,resolvedStyles:Ze,floatingStrategy:fe,referenceHidden:ue&&hr!=="test"?Et.floating.middlewareData.hide?.referenceHidden:!1},children:[r,le&&Z.jsx(Bf,{transition:"fade",mounted:Et.opened,duration:u?.duration||250,exitDuration:u?.exitDuration||250,children:Tt=>Z.jsx(km,{withinPortal:M,children:Z.jsx(Am,{...de,...Ye("overlay",{className:de?.className,style:[Tt,de?.style]})})})})]})}bs.Target=tM;bs.Dropdown=HS;bs.displayName="@mantine/core/Popover";bs.extend=e=>e;const rM=T.forwardRef(({size:e="var(--cb-icon-size, 70%)",style:t,...r},n)=>Z.jsx("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{...t,width:e,height:e},ref:n,...r,children:Z.jsx("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})}));rM.displayName="@mantine/core/CloseIcon";var nM={root:"m_86a44da5","root--subtle":"m_220c80f2"};const bV={variant:"subtle"},SV=(e,{size:t,radius:r,iconSize:n})=>({root:{"--cb-size":$n(t,"cb-size"),"--cb-radius":r===void 0?void 0:cd(r),"--cb-icon-size":Le(n)}}),Mm=dd((e,t)=>{const r=rt("CloseButton",bV,e),{iconSize:n,children:i,vars:s,radius:o,className:a,classNames:u,style:d,styles:h,unstyled:g,"data-disabled":m,disabled:v,variant:w,icon:C,mod:b,attributes:x,__staticSelector:R,...E}=r,A=wr({name:R||"CloseButton",props:r,className:a,style:d,classes:nM,classNames:u,styles:h,unstyled:g,attributes:x,vars:s,varsResolver:SV});return Z.jsxs(Bo,{ref:t,...E,unstyled:g,variant:w,disabled:v,mod:[{disabled:v||m},b],...A("root",{variant:w,active:!v&&!m}),children:[C||Z.jsx(rM,{}),i]})});Mm.classes=nM;Mm.displayName="@mantine/core/CloseButton";const[xV,qo]=ld("ModalBase component was not found in tree");function EV({opened:e,transitionDuration:t}){const[r,n]=T.useState(e),i=T.useRef(-1),o=cP()?0:t;return T.useEffect(()=>(e?(n(!0),window.clearTimeout(i.current)):o===0?n(!1):i.current=window.setTimeout(()=>n(!1),o),()=>window.clearTimeout(i.current)),[e,o]),r}function RV({id:e,transitionProps:t,opened:r,trapFocus:n,closeOnEscape:i,onClose:s,returnFocus:o}){const a=ud(e),[u,d]=T.useState(!1),[h,g]=T.useState(!1),m=typeof t?.duration=="number"?t?.duration:200,v=EV({opened:r,transitionDuration:m});return rG("keydown",w=>{w.key==="Escape"&&i&&!w.isComposing&&r&&w.target?.getAttribute("data-mantine-stop-propagation")!=="true"&&s()},{capture:!0}),sP({opened:r,shouldReturnFocus:n&&o}),{_id:a,titleMounted:u,bodyMounted:h,shouldLockScroll:v,setTitleMounted:d,setBodyMounted:g}}const iM=T.forwardRef(({keepMounted:e,opened:t,onClose:r,id:n,transitionProps:i,onExitTransitionEnd:s,onEnterTransitionEnd:o,trapFocus:a,closeOnEscape:u,returnFocus:d,closeOnClickOutside:h,withinPortal:g,portalProps:m,lockScroll:v,children:w,zIndex:C,shadow:b,padding:x,__vars:R,unstyled:E,removeScrollProps:A,...D},M)=>{const{_id:F,titleMounted:O,bodyMounted:L,shouldLockScroll:W,setTitleMounted:I,setBodyMounted:G}=RV({id:n,transitionProps:i,opened:t,trapFocus:a,closeOnEscape:u,onClose:r,returnFocus:d}),{key:ne,...ie}=A||{};return Z.jsx(km,{...m,withinPortal:g,children:Z.jsx(xV,{value:{opened:t,onClose:r,closeOnClickOutside:h,onExitTransitionEnd:s,onEnterTransitionEnd:o,transitionProps:{...i,keepMounted:e},getTitleId:()=>`${F}-title`,getBodyId:()=>`${F}-body`,titleMounted:O,bodyMounted:L,setTitleMounted:I,setBodyMounted:G,trapFocus:a,closeOnEscape:u,zIndex:C,unstyled:E},children:Z.jsx(tP,{enabled:W&&v,...ie,children:Z.jsx(Dt,{ref:M,...D,__vars:{...R,"--mb-z-index":(C||hc("modal")).toString(),"--mb-shadow":CS(b),"--mb-padding":iP(x)},children:w})},ne)})})});iM.displayName="@mantine/core/ModalBase";function TV(){const e=qo();return T.useEffect(()=>(e.setBodyMounted(!0),()=>e.setBodyMounted(!1)),[]),e.getBodyId()}var Xu={title:"m_615af6c9",header:"m_b5489c3c",inner:"m_60c222c7",content:"m_fd1ab0aa",close:"m_606cb269",body:"m_5df29311"};const sM=T.forwardRef(({className:e,...t},r)=>{const n=TV(),i=qo();return Z.jsx(Dt,{ref:r,...t,id:n,className:Di({[Xu.body]:!i.unstyled},e)})});sM.displayName="@mantine/core/ModalBaseBody";const oM=T.forwardRef(({className:e,onClick:t,...r},n)=>{const i=qo();return Z.jsx(Mm,{ref:n,...r,onClick:s=>{i.onClose(),t?.(s)},className:Di({[Xu.close]:!i.unstyled},e),unstyled:i.unstyled})});oM.displayName="@mantine/core/ModalBaseCloseButton";const aM=T.forwardRef(({transitionProps:e,className:t,innerProps:r,onKeyDown:n,style:i,...s},o)=>{const a=qo();return Z.jsx(Bf,{mounted:a.opened,transition:"pop",...a.transitionProps,onExited:()=>{a.onExitTransitionEnd?.(),a.transitionProps?.onExited?.()},onEntered:()=>{a.onEnterTransitionEnd?.(),a.transitionProps?.onEntered?.()},...e,children:u=>Z.jsx("div",{...r,className:Di({[Xu.inner]:!a.unstyled},r.className),children:Z.jsx(Pm,{active:a.opened&&a.trapFocus,innerRef:o,children:Z.jsx(BS,{...s,component:"section",role:"dialog",tabIndex:-1,"aria-modal":!0,"aria-describedby":a.bodyMounted?a.getBodyId():void 0,"aria-labelledby":a.titleMounted?a.getTitleId():void 0,style:[i,u],className:Di({[Xu.content]:!a.unstyled},t),unstyled:a.unstyled,children:s.children})})})})});aM.displayName="@mantine/core/ModalBaseContent";const lM=T.forwardRef(({className:e,...t},r)=>{const n=qo();return Z.jsx(Dt,{component:"header",ref:r,className:Di({[Xu.header]:!n.unstyled},e),...t})});lM.displayName="@mantine/core/ModalBaseHeader";const FV={duration:200,timingFunction:"ease",transition:"fade"};function DV(e){const t=qo();return{...FV,...t.transitionProps,...e}}const cM=T.forwardRef(({onClick:e,transitionProps:t,style:r,visible:n,...i},s)=>{const o=qo(),a=DV(t);return Z.jsx(Bf,{mounted:n!==void 0?n:o.opened,...a,transition:"fade",children:u=>Z.jsx(Am,{ref:s,fixed:!0,style:[r,u],zIndex:o.zIndex,unstyled:o.unstyled,onClick:d=>{e?.(d),o.closeOnClickOutside&&o.onClose()},...i})})});cM.displayName="@mantine/core/ModalBaseOverlay";function AV(){const e=qo();return T.useEffect(()=>(e.setTitleMounted(!0),()=>e.setTitleMounted(!1)),[]),e.getTitleId()}const uM=T.forwardRef(({className:e,...t},r)=>{const n=AV(),i=qo();return Z.jsx(Dt,{component:"h2",ref:r,className:Di({[Xu.title]:!i.unstyled},e),...t,id:n})});uM.displayName="@mantine/core/ModalBaseTitle";function kV({children:e}){return Z.jsx(Z.Fragment,{children:e})}const[PV,MV]=wS({size:"sm"}),dM=ct((e,t)=>{const r=rt("InputClearButton",null,e),{size:n,variant:i,vars:s,classNames:o,styles:a,...u}=r,d=MV(),{resolvedClassNames:h,resolvedStyles:g}=fc({classNames:o,styles:a,props:r});return Z.jsx(Mm,{variant:i||"transparent",ref:t,size:n||d?.size||"sm",classNames:h,styles:g,__staticSelector:"InputClearButton",style:{pointerEvents:"all",background:"var(--input-bg)",...u.style},...u})});dM.displayName="@mantine/core/InputClearButton";const _V={xs:7,sm:8,md:10,lg:12,xl:15};function LV({__clearable:e,__clearSection:t,rightSection:r,__defaultRightSection:n,size:i="sm"}){const s=e&&t;return s&&(r||n)?Z.jsxs("div",{"data-combined-clear-section":!0,style:{display:"flex",gap:2,alignItems:"center",paddingInlineEnd:_V[i]},children:[s,r||n]}):r===null?null:r||s||n}const[IV,_m]=wS({offsetBottom:!1,offsetTop:!1,describedBy:void 0,getStyles:null,inputId:void 0,labelId:void 0});var cs={wrapper:"m_6c018570",input:"m_8fb7ebe7",section:"m_82577fc2",placeholder:"m_88bacfd0",root:"m_46b77525",label:"m_8fdc1311",required:"m_78a94662",error:"m_8f816625",description:"m_fe47ce59"};const OV=(e,{size:t})=>({description:{"--input-description-size":t===void 0?void 0:`calc(${si(t)} - ${Le(2)})`}}),Lm=ct((e,t)=>{const r=rt("InputDescription",null,e),{classNames:n,className:i,style:s,styles:o,unstyled:a,vars:u,size:d,__staticSelector:h,__inheritStyles:g=!0,attributes:m,variant:v,...w}=rt("InputDescription",null,r),C=_m(),b=wr({name:["InputWrapper",h],props:r,classes:cs,className:i,style:s,classNames:n,styles:o,unstyled:a,attributes:m,rootSelector:"description",vars:u,varsResolver:OV}),x=g&&C?.getStyles||b;return Z.jsx(Dt,{component:"p",ref:t,variant:v,size:d,...x("description",C?.getStyles?{className:i,style:s}:void 0),...w})});Lm.classes=cs;Lm.displayName="@mantine/core/InputDescription";const NV=(e,{size:t})=>({error:{"--input-error-size":t===void 0?void 0:`calc(${si(t)} - ${Le(2)})`}}),Im=ct((e,t)=>{const r=rt("InputError",null,e),{classNames:n,className:i,style:s,styles:o,unstyled:a,vars:u,size:d,attributes:h,__staticSelector:g,__inheritStyles:m=!0,variant:v,...w}=r,C=wr({name:["InputWrapper",g],props:r,classes:cs,className:i,style:s,classNames:n,styles:o,unstyled:a,attributes:h,rootSelector:"error",vars:u,varsResolver:NV}),b=_m(),x=m&&b?.getStyles||C;return Z.jsx(Dt,{component:"p",ref:t,variant:v,size:d,...x("error",b?.getStyles?{className:i,style:s}:void 0),...w})});Im.classes=cs;Im.displayName="@mantine/core/InputError";const NF={labelElement:"label"},BV=(e,{size:t})=>({label:{"--input-label-size":si(t),"--input-asterisk-color":void 0}}),Om=ct((e,t)=>{const r=rt("InputLabel",NF,e),{classNames:n,className:i,style:s,styles:o,unstyled:a,vars:u,labelElement:d,size:h,required:g,htmlFor:m,onMouseDown:v,children:w,__staticSelector:C,variant:b,mod:x,attributes:R,...E}=rt("InputLabel",NF,r),A=wr({name:["InputWrapper",C],props:r,classes:cs,className:i,style:s,classNames:n,styles:o,unstyled:a,attributes:R,rootSelector:"label",vars:u,varsResolver:BV}),D=_m(),M=D?.getStyles||A;return Z.jsxs(Dt,{...M("label",D?.getStyles?{className:i,style:s}:void 0),component:d,variant:b,size:h,ref:t,htmlFor:d==="label"?m:void 0,mod:[{required:g},x],onMouseDown:F=>{v?.(F),!F.defaultPrevented&&F.detail>1&&F.preventDefault()},...E,children:[w,g&&Z.jsx("span",{...M("required"),"aria-hidden":!0,children:" *"})]})});Om.classes=cs;Om.displayName="@mantine/core/InputLabel";const GS=ct((e,t)=>{const r=rt("InputPlaceholder",null,e),{classNames:n,className:i,style:s,styles:o,unstyled:a,vars:u,__staticSelector:d,variant:h,error:g,mod:m,attributes:v,...w}=r,C=wr({name:["InputPlaceholder",d],props:r,classes:cs,className:i,style:s,classNames:n,styles:o,unstyled:a,attributes:v,rootSelector:"placeholder"});return Z.jsx(Dt,{...C("placeholder"),mod:[{error:!!g},m],component:"span",variant:h,ref:t,...w})});GS.classes=cs;GS.displayName="@mantine/core/InputPlaceholder";function HV(e,{hasDescription:t,hasError:r}){const n=e.findIndex(u=>u==="input"),i=e.slice(0,n),s=e.slice(n+1),o=t&&i.includes("description")||r&&i.includes("error");return{offsetBottom:t&&s.includes("description")||r&&s.includes("error"),offsetTop:o}}const GV={labelElement:"label",inputContainer:e=>e,inputWrapperOrder:["label","description","input","error"]},VV=(e,{size:t})=>({label:{"--input-label-size":si(t),"--input-asterisk-color":void 0},error:{"--input-error-size":t===void 0?void 0:`calc(${si(t)} - ${Le(2)})`},description:{"--input-description-size":t===void 0?void 0:`calc(${si(t)} - ${Le(2)})`}}),VS=ct((e,t)=>{const r=rt("InputWrapper",GV,e),{classNames:n,className:i,style:s,styles:o,unstyled:a,vars:u,size:d,variant:h,__staticSelector:g,inputContainer:m,inputWrapperOrder:v,label:w,error:C,description:b,labelProps:x,descriptionProps:R,errorProps:E,labelElement:A,children:D,withAsterisk:M,id:F,required:O,__stylesApiProps:L,mod:W,attributes:I,...G}=r,ne=wr({name:["InputWrapper",g],props:L||r,classes:cs,className:i,style:s,classNames:n,styles:o,unstyled:a,attributes:I,vars:u,varsResolver:VV}),ie={size:d,variant:h,__staticSelector:g},J=ud(F),_=typeof M=="boolean"?M:O,Y=E?.id||`${J}-error`,Q=R?.id||`${J}-description`,U=J,se=!!C&&typeof C!="boolean",N=!!b,P=`${se?Y:""} ${N?Q:""}`,V=P.trim().length>0?P.trim():void 0,H=x?.id||`${J}-label`,j=w&&Z.jsx(Om,{labelElement:A,id:H,htmlFor:U,required:_,...ie,...x,children:w},"label"),ae=N&&Z.jsx(Lm,{...R,...ie,size:R?.size||ie.size,id:R?.id||Q,children:b},"description"),fe=Z.jsx(T.Fragment,{children:m(D)},"input"),le=se&&T.createElement(Im,{...E,...ie,size:E?.size||ie.size,key:"error",id:E?.id||Y},C),de=v.map(ue=>{switch(ue){case"label":return j;case"input":return fe;case"description":return ae;case"error":return le;default:return null}});return Z.jsx(IV,{value:{getStyles:ne,describedBy:V,inputId:U,labelId:H,...HV(v,{hasDescription:N,hasError:se})},children:Z.jsx(Dt,{ref:t,variant:h,size:d,mod:[{error:!!C},W],...ne("root"),...G,children:de})})});VS.classes=cs;VS.displayName="@mantine/core/InputWrapper";const zV={variant:"default",leftSectionPointerEvents:"none",rightSectionPointerEvents:"none",withAria:!0,withErrorStyles:!0,size:"sm"},WV=(e,t,r)=>({wrapper:{"--input-margin-top":r.offsetTop?"calc(var(--mantine-spacing-xs) / 2)":void 0,"--input-margin-bottom":r.offsetBottom?"calc(var(--mantine-spacing-xs) / 2)":void 0,"--input-height":$n(t.size,"input-height"),"--input-fz":si(t.size),"--input-radius":t.radius===void 0?void 0:cd(t.radius),"--input-left-section-width":t.leftSectionWidth!==void 0?Le(t.leftSectionWidth):void 0,"--input-right-section-width":t.rightSectionWidth!==void 0?Le(t.rightSectionWidth):void 0,"--input-padding-y":t.multiline?$n(t.size,"input-padding-y"):void 0,"--input-left-section-pointer-events":t.leftSectionPointerEvents,"--input-right-section-pointer-events":t.rightSectionPointerEvents}}),cn=dd((e,t)=>{const r=rt("Input",zV,e),{classNames:n,className:i,style:s,styles:o,unstyled:a,required:u,__staticSelector:d,__stylesApiProps:h,size:g,wrapperProps:m,error:v,disabled:w,leftSection:C,leftSectionProps:b,leftSectionWidth:x,rightSection:R,rightSectionProps:E,rightSectionWidth:A,rightSectionPointerEvents:D,leftSectionPointerEvents:M,variant:F,vars:O,pointer:L,multiline:W,radius:I,id:G,withAria:ne,withErrorStyles:ie,mod:J,inputSize:_,attributes:Y,__clearSection:Q,__clearable:U,__defaultRightSection:se,...N}=r,{styleProps:P,rest:V}=ES(N),H=_m(),j={offsetBottom:H?.offsetBottom,offsetTop:H?.offsetTop},ae=wr({name:["Input",d],props:h||r,classes:cs,className:i,style:s,classNames:n,styles:o,unstyled:a,attributes:Y,stylesCtx:j,rootSelector:"wrapper",vars:O,varsResolver:WV}),fe=ne?{required:u,disabled:w,"aria-invalid":!!v,"aria-describedby":H?.describedBy,id:H?.inputId||G}:{},le=LV({__clearable:U,__clearSection:Q,rightSection:R,__defaultRightSection:se,size:g});return Z.jsx(PV,{value:{size:g||"sm"},children:Z.jsxs(Dt,{...ae("wrapper"),...P,...m,mod:[{error:!!v&&ie,pointer:L,disabled:w,multiline:W,"data-with-right-section":!!le,"data-with-left-section":!!C},J],variant:F,size:g,children:[C&&Z.jsx("div",{...b,"data-position":"left",...ae("section",{className:b?.className,style:b?.style}),children:C}),Z.jsx(Dt,{component:"input",...V,...fe,ref:t,required:u,mod:{disabled:w,error:!!v&&ie},variant:F,__size:_,...ae("input")}),le&&Z.jsx("div",{...E,"data-position":"right",...ae("section",{className:E?.className,style:E?.style}),children:le})]})})});cn.classes=cs;cn.Wrapper=VS;cn.Label=Om;cn.Error=Im;cn.Description=Lm;cn.Placeholder=GS;cn.ClearButton=dM;cn.displayName="@mantine/core/Input";function hM(e,t,r){const n=rt(e,t,r),{label:i,description:s,error:o,required:a,classNames:u,styles:d,className:h,unstyled:g,__staticSelector:m,__stylesApiProps:v,errorProps:w,labelProps:C,descriptionProps:b,wrapperProps:x,id:R,size:E,style:A,inputContainer:D,inputWrapperOrder:M,withAsterisk:F,variant:O,vars:L,mod:W,attributes:I,...G}=n,{styleProps:ne,rest:ie}=ES(G),J={label:i,description:s,error:o,required:a,classNames:u,className:h,__staticSelector:m,__stylesApiProps:v||n,errorProps:w,labelProps:C,descriptionProps:b,unstyled:g,styles:d,size:E,style:A,inputContainer:D,inputWrapperOrder:M,withAsterisk:F,variant:O,id:R,mod:W,attributes:I,...x};return{...ie,classNames:u,styles:d,unstyled:g,wrapperProps:{...J,...ne},inputProps:{required:a,classNames:u,styles:d,unstyled:g,size:E,__staticSelector:m,__stylesApiProps:v||n,error:o,variant:O,id:R,attributes:I}}}const UV={__staticSelector:"InputBase",withAria:!0,size:"sm"},Nm=dd((e,t)=>{const{inputProps:r,wrapperProps:n,...i}=hM("InputBase",UV,e);return Z.jsx(cn.Wrapper,{...n,children:Z.jsx(cn,{...r,...i,ref:t})})});Nm.classes={...cn.classes,...cn.Wrapper.classes};Nm.displayName="@mantine/core/InputBase";function mb({style:e,size:t=16,...r}){return Z.jsx("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{...e,width:Le(t),height:Le(t),display:"block"},...r,children:Z.jsx("path",{d:"M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}mb.displayName="@mantine/core/AccordionChevron";function fM(e){return typeof e=="string"?{value:e,label:e}:"value"in e&&!("label"in e)?{value:e.value,label:e.value,disabled:e.disabled}:typeof e=="number"?{value:e.toString(),label:e.toString()}:"group"in e?{group:e.group,items:e.items.map(t=>fM(t))}:e}function $V(e){return e?e.map(t=>fM(t)):[]}function gM(e){return e.reduce((t,r)=>"group"in r?{...t,...gM(r.items)}:(t[r.value]=r,t),{})}var li={dropdown:"m_88b62a41",search:"m_985517d8",options:"m_b2821a6e",option:"m_92253aa5",empty:"m_2530cd1d",header:"m_858f94bd",footer:"m_82b967cb",group:"m_254f3e4f",groupLabel:"m_2bb2e9e5",chevron:"m_2943220b",optionsDropdownOption:"m_390b5f4",optionsDropdownCheckIcon:"m_8ee53fc2"};const jV={error:null},YV=(e,{size:t,color:r})=>({chevron:{"--combobox-chevron-size":$n(t,"combobox-chevron-size"),"--combobox-chevron-color":r?ab(r,e):void 0}}),zS=ct((e,t)=>{const r=rt("ComboboxChevron",jV,e),{size:n,error:i,style:s,className:o,classNames:a,styles:u,unstyled:d,vars:h,mod:g,...m}=r,v=wr({name:"ComboboxChevron",classes:li,props:r,style:s,className:o,classNames:a,styles:u,unstyled:d,vars:h,varsResolver:YV,rootSelector:"chevron"});return Z.jsx(Dt,{component:"svg",...m,...v("chevron"),size:n,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",mod:["combobox-chevron",{error:i},g],ref:t,children:Z.jsx("path",{d:"M4.93179 5.43179C4.75605 5.60753 4.75605 5.89245 4.93179 6.06819C5.10753 6.24392 5.39245 6.24392 5.56819 6.06819L7.49999 4.13638L9.43179 6.06819C9.60753 6.24392 9.89245 6.24392 10.0682 6.06819C10.2439 5.89245 10.2439 5.60753 10.0682 5.43179L7.81819 3.18179C7.73379 3.0974 7.61933 3.04999 7.49999 3.04999C7.38064 3.04999 7.26618 3.0974 7.18179 3.18179L4.93179 5.43179ZM10.0682 9.56819C10.2439 9.39245 10.2439 9.10753 10.0682 8.93179C9.89245 8.75606 9.60753 8.75606 9.43179 8.93179L7.49999 10.8636L5.56819 8.93179C5.39245 8.75606 5.10753 8.75606 4.93179 8.93179C4.75605 9.10753 4.75605 9.39245 4.93179 9.56819L7.18179 11.8182C7.35753 11.9939 7.64245 11.9939 7.81819 11.8182L10.0682 9.56819Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})});zS.classes=li;zS.displayName="@mantine/core/ComboboxChevron";const[KV,us]=ld("Combobox component was not found in tree"),pM=T.forwardRef(({size:e,onMouseDown:t,onClick:r,onClear:n,...i},s)=>Z.jsx(cn.ClearButton,{ref:s,tabIndex:-1,"aria-hidden":!0,...i,onMouseDown:o=>{o.preventDefault(),t?.(o)},onClick:o=>{n(),r?.(o)}}));pM.displayName="@mantine/core/ComboboxClearButton";const WS=ct((e,t)=>{const{classNames:r,styles:n,className:i,style:s,hidden:o,...a}=rt("ComboboxDropdown",null,e),u=us();return Z.jsx(bs.Dropdown,{...a,ref:t,role:"presentation","data-hidden":o||void 0,...u.getStyles("dropdown",{className:i,style:s,classNames:r,styles:n})})});WS.classes=li;WS.displayName="@mantine/core/ComboboxDropdown";const qV={refProp:"ref"},mM=ct((e,t)=>{const{children:r,refProp:n}=rt("ComboboxDropdownTarget",qV,e);if(us(),!_f(r))throw new Error("Combobox.DropdownTarget component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");return Z.jsx(bs.Target,{ref:t,refProp:n,children:r})});mM.displayName="@mantine/core/ComboboxDropdownTarget";const US=ct((e,t)=>{const{classNames:r,className:n,style:i,styles:s,vars:o,...a}=rt("ComboboxEmpty",null,e),u=us();return Z.jsx(Dt,{ref:t,...u.getStyles("empty",{className:n,classNames:r,styles:s,style:i}),...a})});US.classes=li;US.displayName="@mantine/core/ComboboxEmpty";function $S({onKeyDown:e,withKeyboardNavigation:t,withAriaAttributes:r,withExpandedAttribute:n,targetType:i,autoComplete:s}){const o=us(),[a,u]=T.useState(null),d=g=>{if(e?.(g),!o.readOnly&&t){if(g.nativeEvent.isComposing)return;if(g.nativeEvent.code==="ArrowDown"&&(g.preventDefault(),o.store.dropdownOpened?u(o.store.selectNextOption()):(o.store.openDropdown("keyboard"),u(o.store.selectActiveOption()),o.store.updateSelectedOptionIndex("selected",{scrollIntoView:!0}))),g.nativeEvent.code==="ArrowUp"&&(g.preventDefault(),o.store.dropdownOpened?u(o.store.selectPreviousOption()):(o.store.openDropdown("keyboard"),u(o.store.selectActiveOption()),o.store.updateSelectedOptionIndex("selected",{scrollIntoView:!0}))),g.nativeEvent.code==="Enter"||g.nativeEvent.code==="NumpadEnter"){if(g.nativeEvent.keyCode===229)return;const m=o.store.getSelectedOptionIndex();o.store.dropdownOpened&&m!==-1?(g.preventDefault(),o.store.clickSelectedOption()):i==="button"&&(g.preventDefault(),o.store.openDropdown("keyboard"))}g.key==="Escape"&&o.store.closeDropdown("keyboard"),g.nativeEvent.code==="Space"&&i==="button"&&(g.preventDefault(),o.store.toggleDropdown("keyboard"))}};return{...r?{"aria-haspopup":"listbox","aria-expanded":n?!!(o.store.listId&&o.store.dropdownOpened):void 0,"aria-controls":o.store.dropdownOpened&&o.store.listId?o.store.listId:void 0,"aria-activedescendant":o.store.dropdownOpened&&a||void 0,autoComplete:s,"data-expanded":o.store.dropdownOpened||void 0,"data-mantine-stop-propagation":o.store.dropdownOpened||void 0}:{},onKeyDown:d}}const XV={refProp:"ref",targetType:"input",withKeyboardNavigation:!0,withAriaAttributes:!0,withExpandedAttribute:!1,autoComplete:"off"},vM=ct((e,t)=>{const{children:r,refProp:n,withKeyboardNavigation:i,withAriaAttributes:s,withExpandedAttribute:o,targetType:a,autoComplete:u,...d}=rt("ComboboxEventsTarget",XV,e);if(!_f(r))throw new Error("Combobox.EventsTarget component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const h=us(),g=$S({targetType:a,withAriaAttributes:s,withKeyboardNavigation:i,withExpandedAttribute:o,onKeyDown:r.props.onKeyDown,autoComplete:u});return T.cloneElement(r,{...g,...d,[n]:as(t,h.store.targetRef,uP(r))})});vM.displayName="@mantine/core/ComboboxEventsTarget";const jS=ct((e,t)=>{const{classNames:r,className:n,style:i,styles:s,vars:o,...a}=rt("ComboboxFooter",null,e),u=us();return Z.jsx(Dt,{ref:t,...u.getStyles("footer",{className:n,classNames:r,style:i,styles:s}),...a,onMouseDown:d=>{d.preventDefault()}})});jS.classes=li;jS.displayName="@mantine/core/ComboboxFooter";const YS=ct((e,t)=>{const{classNames:r,className:n,style:i,styles:s,vars:o,children:a,label:u,id:d,...h}=rt("ComboboxGroup",null,e),g=us(),m=ud(d);return Z.jsxs(Dt,{ref:t,role:"group","aria-labelledby":u?m:void 0,...g.getStyles("group",{className:n,classNames:r,style:i,styles:s}),...h,children:[u&&Z.jsx("div",{id:m,...g.getStyles("groupLabel",{classNames:r,styles:s}),children:u}),a]})});YS.classes=li;YS.displayName="@mantine/core/ComboboxGroup";const KS=ct((e,t)=>{const{classNames:r,className:n,style:i,styles:s,vars:o,...a}=rt("ComboboxHeader",null,e),u=us();return Z.jsx(Dt,{ref:t,...u.getStyles("header",{className:n,classNames:r,style:i,styles:s}),...a,onMouseDown:d=>{d.preventDefault()}})});KS.classes=li;KS.displayName="@mantine/core/ComboboxHeader";function wM({value:e,valuesDivider:t=",",...r}){return Z.jsx("input",{type:"hidden",value:Array.isArray(e)?e.join(t):e||"",...r})}wM.displayName="@mantine/core/ComboboxHiddenInput";const qS=ct((e,t)=>{const r=rt("ComboboxOption",null,e),{classNames:n,className:i,style:s,styles:o,vars:a,onClick:u,id:d,active:h,onMouseDown:g,onMouseOver:m,disabled:v,selected:w,mod:C,...b}=r,x=us(),R=T.useId(),E=d||R;return Z.jsx(Dt,{...x.getStyles("option",{className:i,classNames:n,styles:o,style:s}),...b,ref:t,id:E,mod:["combobox-option",{"combobox-active":h,"combobox-disabled":v,"combobox-selected":w},C],role:"option",onClick:A=>{v?A.preventDefault():(x.onOptionSubmit?.(r.value,r),u?.(A))},onMouseDown:A=>{A.preventDefault(),g?.(A)},onMouseOver:A=>{x.resetSelectionOnOptionHover&&x.store.resetSelectedOption(),m?.(A)}})});qS.classes=li;qS.displayName="@mantine/core/ComboboxOption";const XS=ct((e,t)=>{const r=rt("ComboboxOptions",null,e),{classNames:n,className:i,style:s,styles:o,id:a,onMouseDown:u,labelledBy:d,...h}=r,g=us(),m=ud(a);return T.useEffect(()=>{g.store.setListId(m)},[m]),Z.jsx(Dt,{ref:t,...g.getStyles("options",{className:i,style:s,classNames:n,styles:o}),...h,id:m,role:"listbox","aria-labelledby":d,onMouseDown:v=>{v.preventDefault(),u?.(v)}})});XS.classes=li;XS.displayName="@mantine/core/ComboboxOptions";const QV={withAriaAttributes:!0,withKeyboardNavigation:!0},QS=ct((e,t)=>{const r=rt("ComboboxSearch",QV,e),{classNames:n,styles:i,unstyled:s,vars:o,withAriaAttributes:a,onKeyDown:u,withKeyboardNavigation:d,size:h,...g}=r,m=us(),v=m.getStyles("search"),w=$S({targetType:"input",withAriaAttributes:a,withKeyboardNavigation:d,withExpandedAttribute:!1,onKeyDown:u,autoComplete:"off"});return Z.jsx(cn,{ref:as(t,m.store.searchRef),classNames:[{input:v.className},n],styles:[{input:v.style},i],size:h||m.size,...w,...g,__staticSelector:"Combobox"})});QS.classes=li;QS.displayName="@mantine/core/ComboboxSearch";const ZV={refProp:"ref",targetType:"input",withKeyboardNavigation:!0,withAriaAttributes:!0,withExpandedAttribute:!1,autoComplete:"off"},CM=ct((e,t)=>{const{children:r,refProp:n,withKeyboardNavigation:i,withAriaAttributes:s,withExpandedAttribute:o,targetType:a,autoComplete:u,...d}=rt("ComboboxTarget",ZV,e);if(!_f(r))throw new Error("Combobox.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const h=us(),g=$S({targetType:a,withAriaAttributes:s,withKeyboardNavigation:i,withExpandedAttribute:o,onKeyDown:r.props.onKeyDown,autoComplete:u}),m=T.cloneElement(r,{...g,...d});return Z.jsx(bs.Target,{ref:as(t,h.store.targetRef),children:m})});CM.displayName="@mantine/core/ComboboxTarget";function JV(e,t,r){for(let n=e-1;n>=0;n-=1)if(!t[n].hasAttribute("data-combobox-disabled"))return n;if(r){for(let n=t.length-1;n>-1;n-=1)if(!t[n].hasAttribute("data-combobox-disabled"))return n}return e}function ez(e,t,r){for(let n=e+1;n<t.length;n+=1)if(!t[n].hasAttribute("data-combobox-disabled"))return n;if(r){for(let n=0;n<t.length;n+=1)if(!t[n].hasAttribute("data-combobox-disabled"))return n}return e}function tz(e){for(let t=0;t<e.length;t+=1)if(!e[t].hasAttribute("data-combobox-disabled"))return t;return-1}function yM({defaultOpened:e,opened:t,onOpenedChange:r,onDropdownClose:n,onDropdownOpen:i,loop:s=!0,scrollBehavior:o="instant"}={}){const[a,u]=ju({value:t,defaultValue:e,finalValue:!1,onChange:r}),d=T.useRef(null),h=T.useRef(-1),g=T.useRef(null),m=T.useRef(null),v=T.useRef(-1),w=T.useRef(-1),C=T.useRef(-1),b=T.useCallback((_="unknown")=>{a||(u(!0),i?.(_))},[u,i,a]),x=T.useCallback((_="unknown")=>{a&&(u(!1),n?.(_))},[u,n,a]),R=T.useCallback((_="unknown")=>{a?x(_):b(_)},[x,b,a]),E=T.useCallback(()=>{const _=document.querySelector(`#${d.current} [data-combobox-selected]`);_?.removeAttribute("data-combobox-selected"),_?.removeAttribute("aria-selected")},[]),A=T.useCallback(_=>{const Q=document.getElementById(d.current)?.querySelectorAll("[data-combobox-option]");if(!Q)return null;const U=_>=Q.length?0:_<0?Q.length-1:_;return h.current=U,Q?.[U]&&!Q[U].hasAttribute("data-combobox-disabled")?(E(),Q[U].setAttribute("data-combobox-selected","true"),Q[U].setAttribute("aria-selected","true"),Q[U].scrollIntoView({block:"nearest",behavior:o}),Q[U].id):null},[o,E]),D=T.useCallback(()=>{const _=document.querySelector(`#${d.current} [data-combobox-active]`);if(_){const Y=document.querySelectorAll(`#${d.current} [data-combobox-option]`),Q=Array.from(Y).findIndex(U=>U===_);return A(Q)}return A(0)},[A]),M=T.useCallback(()=>A(ez(h.current,document.querySelectorAll(`#${d.current} [data-combobox-option]`),s)),[A,s]),F=T.useCallback(()=>A(JV(h.current,document.querySelectorAll(`#${d.current} [data-combobox-option]`),s)),[A,s]),O=T.useCallback(()=>A(tz(document.querySelectorAll(`#${d.current} [data-combobox-option]`))),[A]),L=T.useCallback((_="selected",Y)=>{C.current=window.setTimeout(()=>{const Q=document.querySelectorAll(`#${d.current} [data-combobox-option]`),U=Array.from(Q).findIndex(se=>se.hasAttribute(`data-combobox-${_}`));h.current=U,Y?.scrollIntoView&&Q[U]?.scrollIntoView({block:"nearest",behavior:o})},0)},[]),W=T.useCallback(()=>{h.current=-1,E()},[E]),I=T.useCallback(()=>{document.querySelectorAll(`#${d.current} [data-combobox-option]`)?.[h.current]?.click()},[]),G=T.useCallback(_=>{d.current=_},[]),ne=T.useCallback(()=>{v.current=window.setTimeout(()=>g.current?.focus(),0)},[]),ie=T.useCallback(()=>{w.current=window.setTimeout(()=>m.current?.focus(),0)},[]),J=T.useCallback(()=>h.current,[]);return T.useEffect(()=>()=>{window.clearTimeout(v.current),window.clearTimeout(w.current),window.clearTimeout(C.current)},[]),{dropdownOpened:a,openDropdown:b,closeDropdown:x,toggleDropdown:R,selectedOptionIndex:h.current,getSelectedOptionIndex:J,selectOption:A,selectFirstOption:O,selectActiveOption:D,selectNextOption:M,selectPreviousOption:F,resetSelectedOption:W,updateSelectedOptionIndex:L,listId:d.current,setListId:G,clickSelectedOption:I,searchRef:g,focusSearchInput:ne,targetRef:m,focusTarget:ie}}const rz={keepMounted:!0,withinPortal:!0,resetSelectionOnOptionHover:!1,width:"target",transitionProps:{transition:"fade",duration:0},size:"sm"},nz=(e,{size:t,dropdownPadding:r})=>({options:{"--combobox-option-fz":si(t),"--combobox-option-padding":$n(t,"combobox-option-padding")},dropdown:{"--combobox-padding":r===void 0?void 0:Le(r),"--combobox-option-fz":si(t),"--combobox-option-padding":$n(t,"combobox-option-padding")}});function nr(e){const t=rt("Combobox",rz,e),{classNames:r,styles:n,unstyled:i,children:s,store:o,vars:a,onOptionSubmit:u,onClose:d,size:h,dropdownPadding:g,resetSelectionOnOptionHover:m,__staticSelector:v,readOnly:w,attributes:C,...b}=t,x=yM(),R=o||x,E=wr({name:v||"Combobox",classes:li,props:t,classNames:r,styles:n,unstyled:i,attributes:C,vars:a,varsResolver:nz}),A=()=>{d?.(),R.closeDropdown()};return Z.jsx(KV,{value:{getStyles:E,store:R,onOptionSubmit:u,size:h,resetSelectionOnOptionHover:m,readOnly:w},children:Z.jsx(bs,{opened:R.dropdownOpened,preventPositionChangeWhenVisible:!0,...b,onChange:D=>!D&&A(),withRoles:!1,unstyled:i,children:s})})}const iz=e=>e;nr.extend=iz;nr.classes=li;nr.displayName="@mantine/core/Combobox";nr.Target=CM;nr.Dropdown=WS;nr.Options=XS;nr.Option=qS;nr.Search=QS;nr.Empty=US;nr.Chevron=zS;nr.Footer=jS;nr.Header=KS;nr.EventsTarget=vM;nr.DropdownTarget=mM;nr.Group=YS;nr.ClearButton=pM;nr.HiddenInput=wM;function sz({size:e,style:t,...r}){const n=e!==void 0?{width:Le(e),height:Le(e),...t}:t;return Z.jsx("svg",{viewBox:"0 0 10 7",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:n,"aria-hidden":!0,...r,children:Z.jsx("path",{d:"M4 4.586L1.707 2.293A1 1 0 1 0 .293 3.707l3 3a.997.997 0 0 0 1.414 0l5-5A1 1 0 1 0 8.293.293L4 4.586z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function nf(e){return"group"in e}function bM({options:e,search:t,limit:r}){const n=t.trim().toLowerCase(),i=[];for(let s=0;s<e.length;s+=1){const o=e[s];if(i.length===r)return i;nf(o)&&i.push({group:o.group,items:bM({options:o.items,search:t,limit:r-i.length})}),nf(o)||o.label.toLowerCase().includes(n)&&i.push(o)}return i}function oz(e){if(e.length===0)return!0;for(const t of e)if(!("group"in t)||t.items.length>0)return!1;return!0}function SM(e,t=new Set){if(Array.isArray(e))for(const r of e)if(nf(r))SM(r.items,t);else{if(typeof r.value>"u")throw new Error("[@mantine/core] Each option must have value property");if(typeof r.value!="string")throw new Error(`[@mantine/core] Option value must be a string, other data formats are not supported, got ${typeof r.value}`);if(t.has(r.value))throw new Error(`[@mantine/core] Duplicate options are not supported. Option with value "${r.value}" was provided more than once`);t.add(r.value)}}function az(e,t){return Array.isArray(e)?e.includes(t):e===t}function xM({data:e,withCheckIcon:t,value:r,checkIconPosition:n,unstyled:i,renderOption:s}){if(!nf(e)){const a=az(r,e.value),u=t&&a&&Z.jsx(sz,{className:li.optionsDropdownCheckIcon}),d=Z.jsxs(Z.Fragment,{children:[n==="left"&&u,Z.jsx("span",{children:e.label}),n==="right"&&u]});return Z.jsx(nr.Option,{value:e.value,disabled:e.disabled,className:Di({[li.optionsDropdownOption]:!i}),"data-reverse":n==="right"||void 0,"data-checked":a||void 0,"aria-selected":a,active:a,children:typeof s=="function"?s({option:e,checked:a}):d})}const o=e.items.map(a=>Z.jsx(xM,{data:a,value:r,unstyled:i,withCheckIcon:t,checkIconPosition:n,renderOption:s},a.value));return Z.jsx(nr.Group,{label:e.group,children:o})}function lz({data:e,hidden:t,hiddenWhenEmpty:r,filter:n,search:i,limit:s,maxDropdownHeight:o,withScrollArea:a=!0,filterOptions:u=!0,withCheckIcon:d=!1,value:h,checkIconPosition:g,nothingFoundMessage:m,unstyled:v,labelId:w,renderOption:C,scrollAreaProps:b,"aria-label":x}){SM(e);const E=typeof i=="string"?(n||bM)({options:e,search:u?i:"",limit:s??1/0}):e,A=oz(E),D=E.map(M=>Z.jsx(xM,{data:M,withCheckIcon:d,value:h,checkIconPosition:g,unstyled:v,renderOption:C},nf(M)?M.group:M.value));return Z.jsx(nr.Dropdown,{hidden:t||r&&A,"data-composed":!0,children:Z.jsxs(nr.Options,{labelledBy:w,"aria-label":x,children:[a?Z.jsx(gd.Autosize,{mah:o??220,type:"scroll",scrollbarSize:"var(--combobox-padding)",offsetScrollbars:"y",...b,children:D}):D,A&&m&&Z.jsx(nr.Empty,{children:m})]})})}const[cz,pd]=ld("Modal component was not found in tree");var Xo={root:"m_9df02822",content:"m_54c44539",inner:"m_1f958f16",header:"m_d0e2b9cd"};const Bm=ct((e,t)=>{const r=rt("ModalBody",null,e),{classNames:n,className:i,style:s,styles:o,vars:a,...u}=r,d=pd();return Z.jsx(sM,{ref:t,...d.getStyles("body",{classNames:n,style:s,styles:o,className:i}),...u})});Bm.classes=Xo;Bm.displayName="@mantine/core/ModalBody";const Hm=ct((e,t)=>{const r=rt("ModalCloseButton",null,e),{classNames:n,className:i,style:s,styles:o,vars:a,...u}=r,d=pd();return Z.jsx(oM,{ref:t,...d.getStyles("close",{classNames:n,style:s,styles:o,className:i}),...u})});Hm.classes=Xo;Hm.displayName="@mantine/core/ModalCloseButton";const Gm=ct((e,t)=>{const r=rt("ModalContent",null,e),{classNames:n,className:i,style:s,styles:o,vars:a,children:u,__hidden:d,...h}=r,g=pd(),m=g.scrollAreaComponent||kV;return Z.jsx(aM,{...g.getStyles("content",{className:i,style:s,styles:o,classNames:n}),innerProps:g.getStyles("inner",{className:i,style:s,styles:o,classNames:n}),"data-full-screen":g.fullScreen||void 0,"data-modal-content":!0,"data-hidden":d||void 0,ref:t,...h,children:Z.jsx(m,{style:{maxHeight:g.fullScreen?"100dvh":`calc(100dvh - (${Le(g.yOffset)} * 2))`},children:u})})});Gm.classes=Xo;Gm.displayName="@mantine/core/ModalContent";const Vm=ct((e,t)=>{const r=rt("ModalHeader",null,e),{classNames:n,className:i,style:s,styles:o,vars:a,...u}=r,d=pd();return Z.jsx(lM,{ref:t,...d.getStyles("header",{classNames:n,style:s,styles:o,className:i}),...u})});Vm.classes=Xo;Vm.displayName="@mantine/core/ModalHeader";const zm=ct((e,t)=>{const r=rt("ModalOverlay",null,e),{classNames:n,className:i,style:s,styles:o,vars:a,...u}=r,d=pd();return Z.jsx(cM,{ref:t,...d.getStyles("overlay",{classNames:n,style:s,styles:o,className:i}),...u})});zm.classes=Xo;zm.displayName="@mantine/core/ModalOverlay";const uz={__staticSelector:"Modal",closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:hc("modal"),transitionProps:{duration:200,transition:"fade-down"},yOffset:"5dvh"},dz=(e,{radius:t,size:r,yOffset:n,xOffset:i})=>({root:{"--modal-radius":t===void 0?void 0:cd(t),"--modal-size":$n(r,"modal-size"),"--modal-y-offset":Le(n),"--modal-x-offset":Le(i)}}),Wm=ct((e,t)=>{const r=rt("ModalRoot",uz,e),{classNames:n,className:i,style:s,styles:o,unstyled:a,vars:u,yOffset:d,scrollAreaComponent:h,radius:g,fullScreen:m,centered:v,xOffset:w,__staticSelector:C,attributes:b,...x}=r,R=wr({name:C,classes:Xo,props:r,className:i,style:s,classNames:n,styles:o,unstyled:a,attributes:b,vars:u,varsResolver:dz});return Z.jsx(cz,{value:{yOffset:d,scrollAreaComponent:h,getStyles:R,fullScreen:m},children:Z.jsx(iM,{ref:t,...R("root"),"data-full-screen":m||void 0,"data-centered":v||void 0,"data-offset-scrollbars":h===gd.Autosize||void 0,unstyled:a,...x})})});Wm.classes=Xo;Wm.displayName="@mantine/core/ModalRoot";const[hz,fz]=wS();function EM({children:e}){const[t,r]=T.useState([]),[n,i]=T.useState(hc("modal"));return Z.jsx(hz,{value:{stack:t,addModal:(s,o)=>{r(a=>[...new Set([...a,s])]),i(a=>typeof o=="number"&&typeof a=="number"?Math.max(a,o):a)},removeModal:s=>r(o=>o.filter(a=>a!==s)),getZIndex:s=>`calc(${n} + ${t.indexOf(s)} + 1)`,currentId:t[t.length-1],maxZIndex:n},children:e})}EM.displayName="@mantine/core/ModalStack";const Um=ct((e,t)=>{const r=rt("ModalTitle",null,e),{classNames:n,className:i,style:s,styles:o,vars:a,...u}=r,d=pd();return Z.jsx(uM,{ref:t,...d.getStyles("title",{classNames:n,style:s,styles:o,className:i}),...u})});Um.classes=Xo;Um.displayName="@mantine/core/ModalTitle";const gz={closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:hc("modal"),transitionProps:{duration:200,transition:"fade-down"},withOverlay:!0,withCloseButton:!0},As=ct((e,t)=>{const{title:r,withOverlay:n,overlayProps:i,withCloseButton:s,closeButtonProps:o,children:a,radius:u,opened:d,stackId:h,zIndex:g,...m}=rt("Modal",gz,e),v=fz(),w=!!r||s,C=v&&h?{closeOnEscape:v.currentId===h,trapFocus:v.currentId===h,zIndex:v.getZIndex(h)}:{},b=n===!1?!1:h&&v?v.currentId===h:d;return T.useEffect(()=>{v&&h&&(d?v.addModal(h,g||hc("modal")):v.removeModal(h))},[d,h,g]),Z.jsxs(Wm,{ref:t,radius:u,opened:d,zIndex:v&&h?v.getZIndex(h):g,...m,...C,children:[n&&Z.jsx(zm,{visible:b,transitionProps:v&&h?{duration:0}:void 0,...i}),Z.jsxs(Gm,{radius:u,__hidden:v&&h&&d?h!==v.currentId:!1,children:[w&&Z.jsxs(Vm,{children:[r&&Z.jsx(Um,{children:r}),s&&Z.jsx(Hm,{...o})]}),Z.jsx(Bm,{children:a})]})]})});As.classes=Xo;As.displayName="@mantine/core/Modal";As.Root=Wm;As.Overlay=zm;As.Content=Gm;As.Body=Bm;As.Header=Vm;As.Title=Um;As.CloseButton=Hm;As.Stack=EM;const pz={withCheckIcon:!0,allowDeselect:!0,checkIconPosition:"left"},x0=ct((e,t)=>{const r=rt("Select",pz,e),{classNames:n,styles:i,unstyled:s,vars:o,dropdownOpened:a,defaultDropdownOpened:u,onDropdownClose:d,onDropdownOpen:h,onFocus:g,onBlur:m,onClick:v,onChange:w,data:C,value:b,defaultValue:x,selectFirstOptionOnChange:R,onOptionSubmit:E,comboboxProps:A,readOnly:D,disabled:M,filter:F,limit:O,withScrollArea:L,maxDropdownHeight:W,size:I,searchable:G,rightSection:ne,checkIconPosition:ie,withCheckIcon:J,nothingFoundMessage:_,name:Y,form:Q,searchValue:U,defaultSearchValue:se,onSearchChange:N,allowDeselect:P,error:V,rightSectionPointerEvents:H,id:j,clearable:ae,clearButtonProps:fe,hiddenInputProps:le,renderOption:de,onClear:ue,autoComplete:Ie,scrollAreaProps:q,__defaultRightSection:Ge,__clearSection:Ye,__clearable:Ze,chevronColor:ke,autoSelectOnBlur:De,attributes:nt,...vt}=r,Xe=T.useMemo(()=>$V(C),[C]),st=T.useRef({}),Ct=T.useMemo(()=>gM(Xe),[Xe]),ar=ud(j),[qe,hr,Or]=ju({value:b,defaultValue:x,finalValue:null,onChange:w}),Et=typeof qe=="string"?qe in Ct?Ct[qe]:st.current[qe]:void 0,dt=sG(Et),[At,ht,jt]=ju({value:U,defaultValue:se,finalValue:Et?Et.label:"",onChange:N}),Tt=yM({opened:a,defaultOpened:u,onDropdownOpen:()=>{h?.(),Tt.updateSelectedOptionIndex("active",{scrollIntoView:!0})},onDropdownClose:()=>{d?.(),setTimeout(Tt.resetSelectedOption,0)}}),It=Yt=>{ht(Yt),Tt.resetSelectedOption()},{resolvedClassNames:lr,resolvedStyles:$r}=fc({props:r,styles:i,classNames:n});T.useEffect(()=>{R&&Tt.selectFirstOption()},[R,At]),T.useEffect(()=>{b===null&&It(""),typeof b=="string"&&Et&&(dt?.value!==Et.value||dt?.label!==Et.label)&&It(Et.label)},[b,Et]),T.useEffect(()=>{!Or&&!jt&&It(typeof qe=="string"?qe in Ct?Ct[qe]?.label:st.current[qe]?.label||"":"")},[Ct,qe]),T.useEffect(()=>{qe&&qe in Ct&&(st.current[qe]=Ct[qe])},[Ct,qe]);const Cr=Z.jsx(nr.ClearButton,{...fe,onClear:()=>{hr(null,null),It(""),ue?.()}}),dl=ae&&!!qe&&!M&&!D;return Z.jsxs(Z.Fragment,{children:[Z.jsxs(nr,{store:Tt,__staticSelector:"Select",classNames:lr,styles:$r,unstyled:s,readOnly:D,size:I,attributes:nt,keepMounted:De,onOptionSubmit:Yt=>{E?.(Yt);const Sn=P&&Ct[Yt].value===qe?null:Ct[Yt],nn=Sn?Sn.value:null;nn!==qe&&hr(nn,Sn),!Or&&It(typeof nn=="string"&&Sn?.label||""),Tt.closeDropdown()},...A,children:[Z.jsx(nr.Target,{targetType:G?"input":"button",autoComplete:Ie,children:Z.jsx(Nm,{id:ar,ref:t,__defaultRightSection:Z.jsx(nr.Chevron,{size:I,error:V,unstyled:s,color:ke}),__clearSection:Cr,__clearable:dl,rightSection:ne,rightSectionPointerEvents:H||"none",...vt,size:I,__staticSelector:"Select",disabled:M,readOnly:D||!G,value:At,onChange:Yt=>{It(Yt.currentTarget.value),Tt.openDropdown(),R&&Tt.selectFirstOption()},onFocus:Yt=>{G&&Tt.openDropdown(),g?.(Yt)},onBlur:Yt=>{De&&Tt.clickSelectedOption(),G&&Tt.closeDropdown();const Sn=typeof qe=="string"&&(qe in Ct?Ct[qe]:st.current[qe]);It(Sn&&Sn.label||""),m?.(Yt)},onClick:Yt=>{G?Tt.openDropdown():Tt.toggleDropdown(),v?.(Yt)},classNames:lr,styles:$r,unstyled:s,pointer:!G,error:V,attributes:nt})}),Z.jsx(lz,{data:Xe,hidden:D||M,filter:F,search:At,limit:O,hiddenWhenEmpty:!_,withScrollArea:L,maxDropdownHeight:W,filterOptions:!!G&&Et?.label!==At,value:qe,checkIconPosition:ie,withCheckIcon:J,nothingFoundMessage:_,unstyled:s,labelId:vt.label?`${ar}-label`:void 0,"aria-label":vt.label?void 0:vt["aria-label"],renderOption:de,scrollAreaProps:q})]}),Z.jsx(nr.HiddenInput,{value:qe,name:Y,form:Q,disabled:M,...le})]})});x0.classes={...Nm.classes,...nr.classes};x0.displayName="@mantine/core/Select";var Zl=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,r){const n=t?this.allAsyncListeners:this.allSyncListeners;let i=n.get(e);return!i&&r&&(i=new Set,n.set(e,i)),i}noRegisteredListenersExist(){return this.allSyncListeners.size===0&&this.allAsyncListeners.size===0&&this.globalSyncListeners.size===0&&this.globalAsyncListeners.size===0}addEventListener(e,t,r=!1){this.getListeners(e,r,!0).add(t)}removeEventListener(e,t,r=!1){const n=this.getListeners(e,r,!1);n&&(n.delete(t),n.size===0&&(r?this.allAsyncListeners:this.allSyncListeners).delete(e))}addGlobalListener(e,t=!1){this.getGlobalListeners(t).add(e)}removeGlobalListener(e,t=!1){this.getGlobalListeners(t).delete(e)}dispatchEvent(e){this.dispatchToListeners(e,!0),this.dispatchToListeners(e,!1),this.firedEvents[e.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){const r=e.type;if(t&&"event"in e){const a=e.event;a instanceof Event&&(e.eventPath=a.composedPath())}const{frameworkOverrides:n}=this,i=a=>{const u=n?()=>n.wrapIncoming(a):a;t?this.dispatchAsync(u):u()},s=this.getListeners(r,t,!1);if((s?.size??0)>0){const a=new Set(s);for(const u of a)s?.has(u)&&i(()=>u(e))}const o=this.getGlobalListeners(t);if(o.size>0){const a=new Set(o);for(const u of a)i(()=>u(r,e))}}getGlobalListeners(e){return e?this.globalAsyncListeners:this.globalSyncListeners}dispatchAsync(e){if(this.asyncFunctionsQueue.push(e),!this.scheduled){const t=()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)};this.frameworkOverrides?this.frameworkOverrides.wrapIncoming(t):t(),this.scheduled=!0}}flushAsyncQueue(){this.scheduled=!1;const e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[];for(const t of e)t()}};function Ho(e){return e==null||e===""?null:e}function $e(e){return e!=null&&e!==""}function xr(e){return!$e(e)}function vb(e){return e!=null&&typeof e.toString=="function"?e.toString():null}function sf(e,t){const r=e?JSON.stringify(e):null,n=t?JSON.stringify(t):null;return r===n}function mz(e,t,r=!1){const n=e==null,i=t==null;if(e?.toNumber&&(e=e.toNumber()),t?.toNumber&&(t=t.toNumber()),n&&i)return 0;if(n)return-1;if(i)return 1;function s(o,a){return o>a?1:o<a?-1:0}if(typeof e!="string"||!r)return s(e,t);try{return e.localeCompare(t)}catch{return s(e,t)}}var vz=/[&<>"']/g,wz={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function md(e){return e?.toString().toString()??null}function Lh(e){return md(e)?.replace(vz,t=>wz[t])??null}function Ws(e){return e.eRootDiv.getRootNode()}function Fr(e){return Ws(e).activeElement}function un(e){const{gos:t,eRootDiv:r}=e;let n=null;const i=t.get("getDocument");return i&&$e(i)?n=i():r&&(n=r.ownerDocument),n&&$e(n)?n:document}function RM(e){const t=Fr(e);return t===null||t===un(e).body}function TM(e){return un(e).defaultView||window}function ZS(e){let t=null,r=null;try{t=un(e).fullscreenElement}catch{}finally{t||(t=Ws(e));const n=t.querySelector("body");n?r=n:t instanceof ShadowRoot?r=t:t instanceof Document?r=t?.documentElement:r=t}return r}function Cz(e){return ZS(e)?.clientWidth??(window.innerWidth||-1)}function yz(e){return ZS(e)?.clientHeight??(window.innerHeight||-1)}function ks(e,t,r){r==null||typeof r=="string"&&r==""?FM(e,t):Ps(e,t,r)}function Ps(e,t,r){e.setAttribute(DM(t),r.toString())}function FM(e,t){e.removeAttribute(DM(t))}function DM(e){return`aria-${e}`}function Jl(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function bz(e){let t;return e==="asc"?t="ascending":e==="desc"?t="descending":e==="mixed"?t="other":t="none",t}function Sz(e){return e.getAttribute("aria-label")}function Qu(e,t){ks(e,"label",t)}function of(e,t){ks(e,"labelledby",t)}function AM(e,t){ks(e,"live",t)}function xz(e,t){ks(e,"atomic",t)}function Ez(e,t){ks(e,"relevant",t)}function Rz(e,t){ks(e,"invalid",t)}function Tz(e,t){ks(e,"disabled",t)}function kM(e,t){ks(e,"hidden",t)}function wb(e,t){Ps(e,"expanded",t)}function Fz(e,t){Ps(e,"setsize",t)}function Dz(e,t){Ps(e,"posinset",t)}function Az(e,t){Ps(e,"rowcount",t)}function PM(e,t){Ps(e,"rowindex",t)}function kz(e,t){Ps(e,"rowspan",t)}function Pz(e,t){Ps(e,"colcount",t)}function MM(e,t){Ps(e,"colindex",t)}function Mz(e,t){Ps(e,"colspan",t)}function _z(e,t){Ps(e,"sort",t)}function Lz(e){FM(e,"sort")}function _M(e,t){ks(e,"selected",t)}function Iz(e,t){ks(e,"controls",t)}function Oz(e,t){Iz(e,t.id),of(t,e.id)}function BF(e,t){ks(e,"owns",t)}function $m(e,t){return t===void 0?e("ariaIndeterminate","indeterminate"):t===!0?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}var Nz="[tabindex], input, select, button, textarea, [href]",LM="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function Ih(e){return!e||!e.matches("input, select, button, textarea")||!e.matches(LM)?!1:Qo(e)}function Er(e,t,r={}){const{skipAriaHidden:n}=r;e.classList.toggle("ag-hidden",!t),n||kM(e,!t)}function Bz(e,t,r={}){const{skipAriaHidden:n}=r;e.classList.toggle("ag-invisible",!t),n||kM(e,!t)}function af(e,t){const r="disabled",n=t?s=>s.setAttribute(r,""):s=>s.removeAttribute(r);n(e);const i=e.querySelectorAll("input")??[];for(const s of i)n(s)}function Hl(e,t,r){let n=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,typeof r=="number"){if(++n>r)break}else if(e===r)break}return!1}function gc(e){const{height:t,width:r,borderTopWidth:n,borderRightWidth:i,borderBottomWidth:s,borderLeftWidth:o,paddingTop:a,paddingRight:u,paddingBottom:d,paddingLeft:h,marginTop:g,marginRight:m,marginBottom:v,marginLeft:w,boxSizing:C}=window.getComputedStyle(e),b=Number.parseFloat;return{height:b(t||"0"),width:b(r||"0"),borderTopWidth:b(n||"0"),borderRightWidth:b(i||"0"),borderBottomWidth:b(s||"0"),borderLeftWidth:b(o||"0"),paddingTop:b(a||"0"),paddingRight:b(u||"0"),paddingBottom:b(d||"0"),paddingLeft:b(h||"0"),marginTop:b(g||"0"),marginRight:b(m||"0"),marginBottom:b(v||"0"),marginLeft:b(w||"0"),boxSizing:C}}function JS(e){const t=gc(e);return t.boxSizing==="border-box"?t.height-t.paddingTop-t.paddingBottom-t.borderTopWidth-t.borderBottomWidth:t.height}function lf(e){const t=gc(e);return t.boxSizing==="border-box"?t.width-t.paddingLeft-t.paddingRight-t.borderLeftWidth-t.borderRightWidth:t.width}function IM(e){const{height:t,marginBottom:r,marginTop:n}=gc(e);return Math.floor(t+r+n)}function E0(e){const{width:t,marginLeft:r,marginRight:n}=gc(e);return Math.floor(t+r+n)}function OM(e){const t=e.getBoundingClientRect(),{borderTopWidth:r,borderLeftWidth:n,borderRightWidth:i,borderBottomWidth:s}=gc(e);return{top:t.top+(r||0),left:t.left+(n||0),right:t.right+(i||0),bottom:t.bottom+(s||0)}}function R0(e,t){let r=e.scrollLeft;return t&&(r=Math.abs(r)),r}function T0(e,t,r){r&&(t*=-1),e.scrollLeft=t}function ci(e){for(;e?.firstChild;)e.firstChild.remove()}function Ua(e){e?.parentNode&&e.remove()}function NM(e){return!!e.offsetParent}function Qo(e){return e.checkVisibility?e.checkVisibility({checkVisibilityCSS:!0}):!(!NM(e)||window.getComputedStyle(e).visibility!=="visible")}function ex(e){const t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function Jp(e){return()=>{const t=e();return t?tx(t)||BM(t):!0}}function tx(e){return e.clientWidth<e.scrollWidth}function BM(e){return e.clientHeight<e.scrollHeight}function F0(e,t){t==="flex"?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):Js(e,t)}function Js(e,t){t=rx(t),e.style.width=t,e.style.maxWidth=t,e.style.minWidth=t}function Oh(e,t){t=rx(t),e.style.height=t,e.style.maxHeight=t,e.style.minHeight=t}function rx(e){return typeof e=="number"?`${e}px`:e}function nx(e){return e instanceof Node||e instanceof HTMLElement}function Ei(e,t,r){r==null||r===""?e.removeAttribute(t):e.setAttribute(t,r.toString())}function Zo(e,t,r){const i=TM(e).ResizeObserver,s=i?new i(r):null;return s?.observe(t),()=>s?.disconnect()}function Jo(e,t){const r=TM(e);r.requestAnimationFrame?r.requestAnimationFrame(t):r.webkitRequestAnimationFrame?r.webkitRequestAnimationFrame(t):r.setTimeout(t,0)}var HM="data-ref",ry;function HF(){return ry??(ry=document.createTextNode(" ")),ry.cloneNode()}function Hf(e){const{attrs:t,children:r,cls:n,ref:i,role:s,tag:o}=e,a=document.createElement(o);if(n&&(a.className=n),i&&a.setAttribute(HM,i),s&&a.setAttribute("role",s),t)for(const u of Object.keys(t))a.setAttribute(u,t[u]);if(r)if(typeof r=="string")a.textContent=r;else{let u=!0;for(const d of r)d&&(typeof d=="string"?(a.appendChild(document.createTextNode(d)),u=!1):typeof d=="function"?a.appendChild(d()):(u&&(a.appendChild(HF()),u=!1),a.append(Hf(d)),a.appendChild(HF())))}return a}var Hz=["touchstart","touchend","touchmove","touchcancel","scroll"],Gz=["wheel"],ny={},GM=(()=>{const e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return r=>{if(typeof ny[r]=="boolean")return ny[r];const n=document.createElement(e[r]||"div");return r="on"+r,ny[r]=r in n}})();function Vz(e,t){return!t||!e?!1:Wz(t).indexOf(e)>=0}function zz(e){const t=[];let r=e.target;for(;r;)t.push(r),r=r.parentElement;return t}function Wz(e){const t=e;return t.path?t.path:t.composedPath?t.composedPath():zz(t)}function Uz(e,t,r){const n=$z(t);let i;n!=null&&(i={passive:n}),e.addEventListener(t,r,i)}var $z=e=>{const t=Hz.includes(e),r=Gz.includes(e);if(t)return!0;if(r)return!1};function VM(e,t,r){if(r===0)return!1;const n=Math.abs(e.clientX-t.clientX),i=Math.abs(e.clientY-t.clientY);return Math.max(n,i)<=r}var Nh=(e,t)=>{const r=e.identifier;for(let n=0,i=t.length;n<i;++n){const s=t[n];if(s.identifier===r)return s}return null};function cf(e,t){return e.gos.isElementInThisInstance(t.target)}function jz(e,t,r){const i=e.getBoundingClientRect().height,s=Cz(r)-2,o=yz(r)-2;if(!e.offsetParent)return;const u=OM(e.offsetParent),{clientY:d,clientX:h}=t;let g=d-u.top-i/2,m=h-u.left-10;const v=un(r),w=v.defaultView||window,C=w.pageYOffset||v.documentElement.scrollTop,b=w.pageXOffset||v.documentElement.scrollLeft;s>0&&m+e.clientWidth>s+b&&(m=s+b-e.clientWidth),m<0&&(m=0),o>0&&g+e.clientHeight>o+C&&(g=o+C-e.clientHeight),g<0&&(g=0),e.style.left=`${m}px`,e.style.top=`${g}px`}var e0=(e,...t)=>{for(const r of t){const[n,i,s,o]=r;n.addEventListener(i,s,o),e.push(r)}},ix=e=>{if(e){for(const[t,r,n,i]of e)t.removeEventListener(r,n,i);e.length=0}},Oa=e=>{e.cancelable&&e.preventDefault()};function Yz(e,t){return t}function zM(e){return e?.getLocaleTextFunc()??Yz}function Kz(e,t,r,n){const i=t[r];return e.getLocaleTextFunc()(r,typeof i=="function"?i(n):i,n)}function qz(e){return(t,r,n)=>e({key:t,defaultValue:r,variableValues:n})}function Xz(e){return(t,r,n)=>{let i=e?.[t];if(i&&n?.length){let s=0;for(;!(s>=n.length||i.indexOf("${variable}")===-1);)i=i.replace("${variable}",n[s++])}return i??r}}var ao=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.propertyListenerId=0,this.lastChangeSetIdLookup={},this.isAlive=()=>!this.destroyed}preWireBeans(e){this.beans=e,this.stubContext=e.context,this.eventSvc=e.eventSvc,this.gos=e.gos}destroy(){const{destroyFunctions:e}=this;for(let t=0;t<e.length;t++)e[t]();e.length=0,this.destroyed=!0,this.dispatchLocalEvent({type:"destroyed"})}addEventListener(e,t,r){this.localEventService||(this.localEventService=new Zl),this.localEventService.addEventListener(e,t,r)}removeEventListener(e,t,r){this.localEventService?.removeEventListener(e,t,r)}dispatchLocalEvent(e){this.localEventService?.dispatchEvent(e)}addManagedElementListeners(e,t){return this._setupListeners(e,t)}addManagedEventListeners(e){return this._setupListeners(this.eventSvc,e)}addManagedListeners(e,t){return this._setupListeners(e,t)}_setupListeners(e,t){const r=[];for(const n of Object.keys(t)){const i=t[n];i&&r.push(this._setupListener(e,n,i))}return r}_setupListener(e,t,r){if(this.destroyed)return()=>null;let n;if(Qz(e))e.__addEventListener(t,r),n=()=>(e.__removeEventListener(t,r),null);else{const i=Zz(e);e instanceof HTMLElement?Uz(e,t,r):i?e.addListener(t,r):e.addEventListener(t,r),n=i?()=>(e.removeListener(t,r),null):()=>(e.removeEventListener(t,r),null)}return this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter(i=>i!==n),null)}setupPropertyListener(e,t){const{gos:r}=this;r.addPropertyEventListener(e,t);const n=()=>(r.removePropertyEventListener(e,t),null);return this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter(i=>i!==n),null)}addManagedPropertyListener(e,t){return this.destroyed?()=>null:this.setupPropertyListener(e,t)}addManagedPropertyListeners(e,t){if(this.destroyed)return;const r=e.join("-")+this.propertyListenerId++,n=i=>{if(i.changeSet){if(i.changeSet&&i.changeSet.id===this.lastChangeSetIdLookup[r])return;this.lastChangeSetIdLookup[r]=i.changeSet.id}const s={type:"propertyChanged",changeSet:i.changeSet,source:i.source};t(s)};for(const i of e)this.setupPropertyListener(i,n)}getLocaleTextFunc(){return zM(this.beans.localeSvc)}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createOptionalManagedBean(e,t){return e?this.createManagedBean(e,t):void 0}createManagedBean(e,t){const r=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),r}createBean(e,t,r){return(t||this.stubContext).createBean(e,r)}destroyBean(e,t){return(t||this.stubContext).destroyBean(e)}destroyBeans(e,t){return(t||this.stubContext).destroyBeans(e)}};function Qz(e){return e.__addEventListener!==void 0}function Zz(e){return e.eventServiceType==="global"}var Ee=class extends ao{},GF={};function sx(e,t){GF[t]||(e(),GF[t]=!0)}var Jz={pending:!1,funcs:[]},e7={pending:!1,funcs:[]};function Cb(e,t="setTimeout",r){const n=t==="raf"?e7:Jz;if(n.funcs.push(e),n.pending)return;n.pending=!0;const i=()=>{const s=n.funcs.slice();n.funcs.length=0,n.pending=!1;for(const o of s)o()};t==="raf"?Jo(r,i):window.setTimeout(i,0)}function yn(e,t,r){let n;return function(...i){const s=this;window.clearTimeout(n),n=window.setTimeout(function(){e.isAlive()&&t.apply(s,i)},r)}}function VF(e,t){let r=0;return function(...n){const i=this,s=Date.now();s-r<t||(r=s,e.apply(i,n))}}function t7(e,t,r,n=100){const i=Date.now();let s=null,o=!1;const a=()=>{s!=null&&(window.clearInterval(s),s=null)};e.addDestroyFunc(a);const u=()=>{const d=Date.now()-i>n;(t()||d)&&(r(),o=!0,a())};u(),o||(s=window.setInterval(u,10))}var WM=new Set(["__proto__","constructor","prototype"]);function r7(e,t){if(e!=null){if(Array.isArray(e)){for(let r=0;r<e.length;r++)t(r.toString(),e[r]);return}for(const r of Object.keys(e).filter(n=>!WM.has(n)))t(r,e[r])}}function Wn(e,t,r=!0,n=!1){$e(t)&&r7(t,(i,s)=>{let o=e[i];o!==s&&(n&&o==null&&s!=null&&typeof s=="object"&&s.constructor===Object&&(o={},e[i]=o),zF(s)&&zF(o)&&!Array.isArray(o)?Wn(o,s,r,n):(r||s!==void 0)&&(e[i]=s))})}function zF(e){return typeof e=="object"&&e!==null}var ox=class _o{static applyGlobalGridOptions(t){if(!_o.gridOptions)return{...t};let r={};return Wn(r,_o.gridOptions,!0,!0),_o.mergeStrategy==="deep"?Wn(r,t,!0,!0):r={...r,...t},_o.gridOptions.context&&(r.context=_o.gridOptions.context),t.context&&(_o.mergeStrategy==="deep"&&r.context&&Wn(t.context,r.context,!0,!0),r.context=t.context),r}static applyGlobalGridOption(t,r){if(_o.mergeStrategy==="deep"){const n=UM(t);if(n&&typeof n=="object"&&typeof r=="object")return _o.applyGlobalGridOptions({[t]:r})[t]}return r}};ox.gridOptions=void 0;ox.mergeStrategy="shallow";var ax=ox;function UM(e){return ax.gridOptions?.[e]}var $M={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!0,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"	",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,enableStrictPivotColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressMoveWhenColumnDragging:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,cellFlashDuration:500,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,rowDragInsertDelay:500,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1,columnMenu:"new",reactiveCustomComponents:!0,suppressSetFilterByDefault:!1,rowNumbers:!1,enableFilterHandlers:!1},jM="https://www.ag-grid.com";function ec(e,t,...r){e.get("debug")&&console.log("AG Grid: "+t,...r)}function Bh(e,...t){sx(()=>console.warn("AG Grid: "+e,...t),e+t?.join(""))}function Au(e,...t){sx(()=>console.error("AG Grid: "+e,...t),e+t?.join(""))}var YM=new Set,D0={},Gl={},t0,KM=!1,qM=!1,n7=!1;function i7(e){const[t,r]=e.version.split(".")||[],[n,i]=t0.split(".")||[];return t===n&&r===i}function s7(e){t0||(t0=e.version);const t=n=>`You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. ${n} Please update all modules to the same version.`;e.version?i7(e)||Au(t(`'${e.moduleName}' is version ${e.version} but the other modules are version ${t0}.`)):Au(t(`'${e.moduleName}' is incompatible.`));const r=e.validate?.();r&&!r.isValid&&Au(`${r.message}`)}function uf(e,t,r=!1){r||(KM=!0),s7(e);const n=e.rowModels??["all"];YM.add(e);let i;t!==void 0?(qM=!0,Gl[t]===void 0&&(Gl[t]={}),i=Gl[t]):i=D0;for(const s of n)i[s]===void 0&&(i[s]={}),i[s][e.moduleName]=e;if(e.dependsOn)for(const s of e.dependsOn)uf(s,t,r)}function o7(e){delete Gl[e]}function yb(e,t,r){const n=i=>!!D0[i]?.[e]||!!Gl[t]?.[i]?.[e];return n(r)||n("all")}function lx(){return qM}function a7(e,t){const r=Gl[e]??{};return[...Object.values(D0.all??{}),...Object.values(r.all??{}),...Object.values(D0[t]??{}),...Object.values(r[t]??{})]}function l7(){return new Set(YM)}function c7(e,t){const r=Gl[e]??{};return[...Object.values(r.all??{}),...Object.values(r[t]??{})]}function u7(){return KM}function d7(){return n7}var h7=class{static register(e){uf(e,void 0)}static registerModules(e){for(const t of e)uf(t,void 0)}},Ue="34.3.1",WF=2e3,UF=100,XM="_version_",QM=null,ku=`${jM}/javascript-data-grid`;function f7(e){QM=e}function g7(e){ku=e}function ZM(e,t,r){return QM?.(e,t)??[w7(e,t,r)]}function cx(e,t,r,n,i){e(`${n?"warning":"error"} #${t}`,...ZM(t,r,i))}function p7(e){if(!e)return String(e);const t={};for(const r of Object.keys(e))typeof e[r]!="object"&&typeof e[r]!="function"&&(t[r]=e[r]);return JSON.stringify(t)}function m7(e){let t=e;return e instanceof Error?t=e.toString():typeof e=="object"&&(t=p7(e)),t}function A0(e){return e===void 0?"undefined":e===null?"null":e}function bb(e,t){return`${e}?${t.toString()}`}function v7(e,t,r){const n=Array.from(t.entries()).sort((s,o)=>o[1].length-s[1].length);let i=bb(e,t);for(const[s,o]of n){if(s===XM)continue;const a=i.length-r;if(a<=0)break;const u="...",d=a+u.length,h=o.length-d>UF?o.slice(0,o.length-d)+u:o.slice(0,UF)+u;t.set(s,h),i=bb(e,t)}return i}function JM(e,t){const r=new URLSearchParams;if(r.append(XM,Ue),t)for(const s of Object.keys(t))r.append(s,m7(t[s]));const n=`${ku}/errors/${e}`,i=bb(n,r);return i.length<=WF?i:v7(n,r,WF)}var w7=(e,t,r)=>{const n=JM(e,t);return`${`${r?r+` 
`:""}Visit ${n}`}${r?"":` 
  Alternatively register the ValidationModule to see the full message in the console.`}`};function Me(...e){cx(Bh,e[0],e[1],!0)}function Zt(...e){cx(Au,e[0],e[1],!1)}function Dh(e,t,r){cx(Au,e,t,!1,r)}function C7(e,t){const r=t[0];return`error #${r} `+ZM(r,t[1],e).join(" ")}function eo(...e){return C7(void 0,e)}function e_(e,t){return e.get("rowModelType")===t}function _r(e,t){return e_(e,"clientSide")}function pc(e,t){return e_(e,"serverSide")}function bn(e,t){return e.get("domLayout")===t}function Vl(e){return P0(e)!==void 0}function t_(e){return typeof e.get("getRowHeight")=="function"}function y7(e,t){return t?!e.get("enableStrictPivotColumnOrder"):e.get("maintainColumnOrder")}function $a(e,t,r=!1,n){const{gos:i,environment:s}=e;if(n==null&&(n=s.getDefaultRowHeight()),t_(i)){if(r)return{height:n,estimated:!0};const u={node:t,data:t.data},d=i.getCallback("getRowHeight")(u);if(Sb(d))return d===0&&Me(23),{height:Math.max(1,d),estimated:!1}}if(t.detail&&i.get("masterDetail"))return b7(i);const o=i.get("rowHeight");return{height:o&&Sb(o)?o:n,estimated:!1}}function b7(e){if(e.get("detailRowAutoHeight"))return{height:1,estimated:!1};const t=e.get("detailRowHeight");return Sb(t)?{height:t,estimated:!1}:{height:300,estimated:!1}}function zl(e){const{environment:t,gos:r}=e,n=r.get("rowHeight");if(!n||xr(n))return t.getDefaultRowHeight();const i=t.refreshRowHeightVariable();return i!==-1?i:(Me(24),t.getDefaultRowHeight())}function Sb(e){return!isNaN(e)&&typeof e=="number"&&isFinite(e)}function r_(e,t,r){const n=t[e.getDomDataKey()];return n?n[r]:void 0}function tc(e,t,r,n){const i=e.getDomDataKey();let s=t[i];xr(s)&&(s={},t[i]=s),s[r]=n}function Pu(e){return e.get("ensureDomOrder")?!1:e.get("animateRows")}function n_(e){return!(e.get("paginateChildRows")||e.get("groupHideOpenParents")||bn(e,"print"))}function Ys(e){return!e.get("autoGroupColumnDef")?.comparator&&!e.get("treeData")}function xb(e){const t=e.get("groupAggFiltering");if(typeof t=="function")return e.getCallback("groupAggFiltering");if(t===!0)return()=>!0}function i_(e){return e.get("grandTotalRow")}function s_(e,t){return t?!1:e.get("groupDisplayType")==="groupRows"}function o_(e,t,r){return!!t.group&&!t.footer&&s_(e,r)}function Zu(e){const t=e.getCallback("getRowId");return t===void 0?t:r=>{let n=t(r);return typeof n!="string"&&(sx(()=>Me(25,{id:n}),"getRowIdString"),n=String(n)),n}}function S7(e,t){const r=e.get("groupHideParentOfSingleChild");return!!(r===!0||r==="leafGroupsOnly"&&t.leafGroup||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")&&t.leafGroup)}function x7(e){const t=e.get("maxConcurrentDatasourceRequests");return t>0?t:void 0}function Mu(e){return e?.checkboxes??!0}function r0(e){return e?.mode==="multiRow"&&(e.headerCheckbox??!0)}function k0(e){if(typeof e=="object")return e.checkboxLocation??"selectionColumn"}function iy(e){return e?.hideDisabledCheckboxes??!1}function E7(e){return typeof e.get("rowSelection")!="string"}function ja(e){const t=e.get("cellSelection");return t!==void 0?!!t:e.get("enableRangeSelection")}function a_(e){const t=e.get("rowSelection")??"single";if(typeof t=="string"){const r=e.get("suppressRowClickSelection"),n=e.get("suppressRowDeselection");return r&&n?!1:r?"enableDeselection":n?"enableSelection":!0}return t.mode==="singleRow"||t.mode==="multiRow"?t.enableClickSelection??!1:!1}function R7(e){const t=a_(e);return t===!0||t==="enableSelection"}function T7(e){const t=a_(e);return t===!0||t==="enableDeselection"}function Eb(e){const t=e.get("rowSelection");return typeof t=="string"?e.get("isRowSelectable"):t?.isRowSelectable}function P0(e){const t="beanName"in e&&e.beanName==="gos"?e.get("rowSelection"):e.rowSelection;if(typeof t=="string")switch(t){case"multiple":return"multiRow";case"single":return"singleRow";default:return}switch(t?.mode){case"multiRow":case"singleRow":return t.mode;default:return}}function M0(e){return P0(e)==="multiRow"}function F7(e){const t=e.get("rowSelection");return typeof t=="string"?e.get("rowMultiSelectWithClick"):t?.enableSelectionWithoutKeys??!1}function _0(e){const t=e.get("rowSelection");if(typeof t=="string"){const r=e.get("groupSelectsChildren"),n=e.get("groupSelectsFiltered");return r&&n?"filteredDescendants":r?"descendants":"self"}return t?.mode==="multiRow"?t.groupSelects:void 0}function l_(e,t=!0){const r=e.get("rowSelection");return typeof r!="object"?t?"all":void 0:r.mode==="multiRow"?r.selectAll:"all"}function D7(e){const t=e.get("rowSelection");return typeof t=="string"?!1:t?.mode==="multiRow"?t.ctrlASelectsRows??!1:!1}function df(e){const t=_0(e);return t==="descendants"||t==="filteredDescendants"}function $F(e){const t=e.get("rowSelection");return typeof t=="object"&&t.masterSelects||"self"}function A7(e){return e.isModuleRegistered("SetFilter")&&!e.get("suppressSetFilterByDefault")}function Ri(e){return e.get("columnMenu")==="legacy"}function k7(e){return!Ri(e)}function P7(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substring(1)}function M7(e,t,r){typeof e!="object"&&(e={});const n={...e};for(const i of r){const s=t[i];typeof s<"u"&&(n[i]=s)}return n}function _7(e,t){if(!e)return;const r={};let n=!1;for(const o of Object.keys(e))r[o]=e[o],n=!0;if(!n)return;const i={type:"gridOptionsChanged",options:r};t.dispatchEvent(i);const s={type:"componentStateChanged",...r};t.dispatchEvent(s)}function it(e,t){return e.addCommon(t)}function n0(e,t){return e[t]??e.gridOptions?.[t]??UM(t)??$M[t]}function jF({gos:e},t){return t.button===2||t.ctrlKey&&e.get("allowContextMenuWithControlKey")}var L7={resizable:!0,sortable:!0},I7=0;function c_(){return I7++}function Ya(e){return e instanceof mc}var mc=class extends Ee{constructor(e,t,r,n){super(),this.colDef=e,this.userProvidedColDef=t,this.colId=r,this.primary=n,this.isColumn=!0,this.instanceId=c_(),this.autoHeaderHeight=null,this.moving=!1,this.resizing=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.colEventSvc=new Zl,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.flex=null,this.colIdSanitised=Lh(r)}destroy(){super.destroy(),this.beans.rowSpanSvc?.deregister(this)}getInstanceId(){return this.instanceId}setState(){const{colDef:e,beans:{sortSvc:t,pinnedCols:r,colFlex:n}}=this;t?.initCol(this);const i=e.hide;i!==void 0?this.visible=!i:this.visible=!e.initialHide,r?.initCol(this),n?.initCol(this)}setColDef(e,t,r){const n=e.spanRows!==this.colDef.spanRows;this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),n&&(this.beans.rowSpanSvc?.deregister(this),this.initRowSpan()),this.dispatchColEvent("colDefChanged",r)}getUserProvidedColDef(){return this.userProvidedColDef}getParent(){return this.parent}getOriginalParent(){return this.originalParent}postConstruct(){this.setState(),this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.initRowSpan(),this.addPivotListener()}initDotNotation(){const{gos:e,colDef:{field:t,tooltipField:r}}=this,n=e.get("suppressFieldDotNotation");this.fieldContainsDots=$e(t)&&t.includes(".")&&!n,this.tooltipFieldContainsDots=$e(r)&&r.includes(".")&&!n}initMinAndMaxWidths(){const e=this.colDef;this.minWidth=e.minWidth??this.beans.environment.getDefaultColumnMinWidth(),this.maxWidth=e.maxWidth??Number.MAX_SAFE_INTEGER}initTooltip(){this.beans.tooltipSvc?.initCol(this)}initRowSpan(){this.colDef.spanRows&&this.beans.rowSpanSvc?.register(this)}addPivotListener(){const e=this.beans.pivotColDefSvc,t=this.colDef.pivotValueColumn;!e||!t||this.addManagedListeners(t,{colDefChanged:r=>{const n=e.recreateColDef(this.colDef);this.setColDef(n,n,r.source)}})}resetActualWidth(e){const t=this.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}calculateColInitialWidth(e){let t;const r=e.width,n=e.initialWidth;return r!=null?t=r:n!=null?t=n:t=200,Math.max(Math.min(t,this.maxWidth),this.minWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){return this.beans.showRowGroupCols?.isRowGroupDisplayed(this,e)??!1}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}getHighlighted(){return this.highlighted}__addEventListener(e,t){this.colEventSvc.addEventListener(e,t)}__removeEventListener(e,t){this.colEventSvc.removeEventListener(e,t)}addEventListener(e,t){this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,this.colEventSvc);const r=this.frameworkEventListenerService?.wrap(e,t)??t;this.colEventSvc.addEventListener(e,r)}removeEventListener(e,t){const r=this.frameworkEventListenerService?.unwrap(e,t)??t;this.colEventSvc.removeEventListener(e,r)}createColumnFunctionCallbackParams(e){return it(this.gos,{node:e,data:e.data,column:this,colDef:this.colDef})}isSuppressNavigable(e){return this.beans.cellNavigation?.isSuppressNavigable(this,e)??!1}isCellEditable(e){return this.beans.editSvc?.isCellEditable({rowNode:e,column:this})??!1}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){return this.beans.selectionSvc?.isCellCheckboxSelection(this,e)??!1}isSuppressPaste(e){return this.isColumnFunc(e,this.colDef?.suppressPaste??null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(e){return this.colDef[e]??L7[e]}isColumnFunc(e,t){if(typeof t=="boolean")return t;if(typeof t=="function"){const r=this.createColumnFunctionCallbackParams(e);return t(r)}return!1}createColumnEvent(e,t){return it(this.gos,{type:e,column:this,columns:[this],source:t})}isMoving(){return this.moving}getSort(){return this.sort}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return this.sort==="asc"}isSortDescending(){return this.sort==="desc"}isSortNone(){return xr(this.sort)}isSorting(){return $e(this.sort)}getSortIndex(){return this.sortIndex}isMenuVisible(){return this.menuVisible}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchColEvent("leftChanged",t))}isFilterActive(){return this.filterActive}isHovered(){return Me(261),!!this.beans.colHover?.isHovered(this)}setFirstRightPinned(e,t){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.dispatchColEvent("firstRightPinnedChanged",t))}setLastLeftPinned(e,t){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.dispatchColEvent("lastLeftPinnedChanged",t))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return this.pinned==="left"||this.pinned==="right"}isPinnedLeft(){return this.pinned==="left"}isPinnedRight(){return this.pinned==="right"}getPinned(){return this.pinned}setVisible(e,t){const r=e===!0;this.visible!==r&&(this.visible=r,this.dispatchColEvent("visibleChanged",t)),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){return!this.getColDef().suppressSpanHeaderHeight}getFirstRealParent(){let e=this.getOriginalParent();for(;e?.isPadding();)e=e.getOriginalParent();return e}getColumnGroupPaddingInfo(){let e=this.getParent();if(!e?.isPadding())return{numberOfParents:0,isSpanningTotal:!1};const t=e.getPaddingLevel()+1;let r=!0;for(;e;){if(!e.isPadding()){r=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:r}}getColDef(){return this.colDef}getDefinition(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return it(this.gos,{node:e,data:e.data,colDef:this.colDef,column:this})}getColSpan(e){if(xr(this.colDef.colSpan))return 1;const t=this.createBaseColDefParams(e),r=this.colDef.colSpan(t);return Math.max(r,1)}getRowSpan(e){if(xr(this.colDef.rowSpan))return 1;const t=this.createBaseColDefParams(e),r=this.colDef.rowSpan(t);return Math.max(r,1)}setActualWidth(e,t,r=!1){e=Math.max(e,this.minWidth),e=Math.min(e,this.maxWidth),this.actualWidth!==e&&(this.actualWidth=e,this.flex!=null&&t!=="flex"&&t!=="gridInitializing"&&(this.flex=null),r||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.dispatchColEvent("widthChanged",e)}isGreaterThanMax(e){return e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex}isRowGroupActive(){return this.rowGroupActive}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}isValueActive(){return this.aggregationActive}isAllowPivot(){return this.colDef.enablePivot===!0}isAllowValue(){return this.colDef.enableValue===!0}isAllowRowGroup(){return this.colDef.enableRowGroup===!0}dispatchColEvent(e,t,r){const n=this.createColumnEvent(e,t);r&&Wn(n,r),this.colEventSvc.dispatchEvent(n)}dispatchStateUpdatedEvent(e){this.colEventSvc.dispatchEvent({type:"columnStateUpdated",key:e})}};function Tn(e){return e instanceof i0}var i0=class extends Ee{constructor(e,t,r,n){super(),this.colGroupDef=e,this.groupId=t,this.padding=r,this.level=n,this.isColumn=!1,this.expandable=!1,this.instanceId=c_(),this.expandableListenerRemoveCallback=null,this.expanded=!!e?.openByDefault}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0),super.destroy()}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return this.children?this.children.some(e=>e.isVisible()):!1}isPadding(){return this.padding}setExpanded(e){this.expanded=e===void 0?!1:e,this.dispatchLocalEvent({type:"expandedChanged"})}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}forEachLeafColumn(e){if(this.children)for(const t of this.children)Ya(t)?e(t):Tn(t)&&t.forEachLeafColumn(e)}addLeafColumns(e){if(this.children)for(const t of this.children)Ya(t)?e.push(t):Tn(t)&&t.addLeafColumns(e)}getColumnGroupShow(){const e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const e=this.onColumnVisibilityChanged.bind(this);for(const t of this.getLeafColumns())t.__addEventListener("visibleChanged",e);this.expandableListenerRemoveCallback=()=>{for(const t of this.getLeafColumns())t.__removeEventListener("visibleChanged",e);this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let e=!1,t=!1,r=!1;const n=this.findChildrenRemovingPadding();for(let s=0,o=n.length;s<o;s++){const a=n[s];if(!a.isVisible())continue;const u=a.getColumnGroupShow();u==="open"?(e=!0,r=!0):u==="closed"?(t=!0,r=!0):(e=!0,t=!0)}const i=e&&t&&r;this.expandable!==i&&(this.expandable=i,this.dispatchLocalEvent({type:"expandableChanged"}))}findChildrenRemovingPadding(){const e=[],t=r=>{for(const n of r)Tn(n)&&n.isPadding()?t(n.children):e.push(n)};return t(this.children),e}onColumnVisibilityChanged(){this.setExpandable()}},O7={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}};function YF(e,t,r){const n={},i=e.gos;return Object.assign(n,i.get("defaultColGroupDef")),Object.assign(n,t),i.validateColDef(n,r),n}var N7=class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=vb(e);let r=0;for(;;){let n=e??t;if(n?r!==0&&(n+="_"+r):n=r,!this.existingKeys[n]){const i=String(n);return e&&r>0&&Me(273,{providedId:e,usedId:i}),this.existingKeys[i]=!0,i}r++}}};function ir(e){if(e?.length)return e[e.length-1]}function tl(e,t,r){if(e===t)return!0;if(!e||!t)return e==null&&t==null;const n=e.length;if(n!==t.length)return!1;for(let i=0;i<n;i++)if(e[i]!==t[i]&&!r?.(e[i],t[i]))return!1;return!0}function bh(e,t){if(e)for(const r of e)t(r)}function Ds(e,t){const r=e.indexOf(t);r>=0&&e.splice(r,1)}function KF(e,t,r){for(let n=0;n<t.length;n++)Ds(e,t[n]);for(let n=t.length-1;n>=0;n--)e.splice(r,0,t[n])}var jm="ag-Grid-AutoColumn",u_="ag-Grid-SelectionColumn",d_="ag-Grid-RowNumbersColumn";function h_(e){const t=[],r=n=>{for(let i=0;i<n.length;i++){const s=n[i];Ya(s)?t.push(s):Tn(s)&&r(s.getChildren())}};return r(e),t}function Lo(e){return e.reduce((t,r)=>t+r.getActualWidth(),0)}function L0(e,t,r){const n={};if(!t)return;Vo(null,t,s=>{n[s.getInstanceId()]=s}),r&&Vo(null,r,s=>{n[s.getInstanceId()]=null});const i=Object.values(n).filter(s=>s!=null);e.context.destroyBeans(i)}function ux(e){return e.getId().startsWith(jm)}function ea(e){return(typeof e=="string"?e:"getColId"in e?e.getColId():e.colId)?.startsWith(u_)??!1}function Go(e){return(typeof e=="string"?e:"getColId"in e?e.getColId():e.colId)?.startsWith(d_)??!1}function B7(e){return ea(e)||Go(e)}function I0(e){let t=[];return e instanceof Array?t=e:typeof e=="string"&&(t=e.split(",")),t}function H7(e,t){return tl(e,t,(r,n)=>r.getColId()===n.getColId())}function G7(e){e.map={};for(const t of e.list)e.map[t.getId()]=t}function _u(e){return e==="optionsUpdated"?"gridOptionsChanged":e}function Hh(e,t){const r=e===t,n=e.getColDef()===t,i=e.getColId()==t;return r||n||i}var V7=(e,t)=>(r,n)=>{const i={value1:void 0,value2:void 0};let s=!1;return e&&(e[r]!==void 0&&(i.value1=e[r],s=!0),$e(n)&&e[n]!==void 0&&(i.value2=e[n],s=!0)),!s&&t&&(t[r]!==void 0&&(i.value1=t[r]),$e(n)&&t[n]!==void 0&&(i.value2=t[n])),i},z7=(e,t)=>{Tn(e)&&e.setupExpandable(),e.originalParent=t};function W7(e,t=null,r,n,i){const s=new N7,{existingCols:o,existingGroups:a,existingColKeys:u}=U7(n);s.addExistingKeys(u);const d=f_(e,t,0,r,o,s,a,i),{colGroupSvc:h}=e,g=h?.findMaxDepth(d,0)??0,m=h?h.balanceColumnTree(d,0,g,s):d;return Vo(null,m,z7),{columnTree:m,treeDepth:g}}function U7(e){const t=[],r=[],n=[];return e&&Vo(null,e,i=>{if(Tn(i)){const s=i;r.push(s)}else{const s=i;n.push(s.getId()),t.push(s)}}),{existingCols:t,existingGroups:r,existingColKeys:n}}function f_(e,t,r,n,i,s,o,a){if(!t)return[];const{colGroupSvc:u}=e,d=new Array(t.length);for(let h=0;h<d.length;h++){const g=t[h];u&&X7(g)?d[h]=u.createProvidedColumnGroup(n,g,r,i,s,o,a):d[h]=$7(e,n,g,i,s,a)}return d}function $7(e,t,r,n,i,s){const o=Y7(r,n);o&&n?.splice(o.idx,1);let a=o?.column;if(a){const u=Rb(e,r,a.getColId());a.setColDef(u,r,s),j7(e,a,u,s)}else{const u=i.getUniqueKey(r.colId,r.field),d=Rb(e,r,u);a=new mc(d,r,u,t),e.context.createBean(a)}return e.dataTypeSvc?.addColumnListeners(a),a}function g_(e,t,r,n,i,s,o,a){const{sortSvc:u,pinnedCols:d,colFlex:h}=e;r!==void 0&&t.setVisible(!r,a),u&&(u.updateColSort(t,n,a),i!==void 0&&u.setColSortIndex(t,i)),s!==void 0&&d?.setColPinned(t,s),o!==void 0&&h?.setColFlex(t,o)}function j7(e,t,r,n){g_(e,t,r.hide,r.sort,r.sortIndex,r.pinned,r.flex,n);const i=t.getFlex();if(!(i!=null&&i>0))if(r.width!=null)t.setActualWidth(r.width,n);else{const s=t.getActualWidth();t.setActualWidth(s,n)}}function Y7(e,t){if(t)for(let r=0;r<t.length;r++){const n=t[r].getUserProvidedColDef();if(!n)continue;if(e.colId!=null){if(t[r].getId()===e.colId)return{idx:r,column:t[r]};continue}if(e.field!=null){if(n.field===e.field)return{idx:r,column:t[r]};continue}if(n===e)return{idx:r,column:t[r]}}}function Rb(e,t,r,n){const{gos:i,dataTypeSvc:s}=e,o={},a=i.get("defaultColDef");Wn(o,a,!1,!0);const u=K7(e,o,t,r);u&&q7(e,u,o);const d=o.cellDataType;Wn(o,t,!1,!0),d!==void 0&&(o.cellDataType=d);const h=i.get("autoGroupColumnDef"),g=Ys(i);return t.rowGroup&&h&&g&&Wn(o,{sort:h.sort,initialSort:h.initialSort},!1,!0),s&&(s.postProcess(o),s.validateColDef(o)),i.validateColDef(o,r,n),o}function K7(e,t,r,n){const i=e.dataTypeSvc?.updateColDefAndGetColumnType(t,r,n),s=r.type??i??t.type;return t.type=s,s?I0(s):void 0}function q7(e,t,r){if(!t.length)return;const n=Object.assign({},O7),i=e.gos.get("columnTypes")||{};for(const s of Object.keys(i)){const o=i[s];s in n?Me(34,{key:s}):(o.type&&Me(35),n[s]=o)}for(const s of t){const o=n[s.trim()];o?Wn(r,o,!1,!0):Me(36,{t:s})}}function X7(e){return e.children!==void 0}function Vo(e,t,r){if(t)for(let n=0;n<t.length;n++){const i=t[n];Tn(i)&&Vo(i,i.getChildren(),r),r(i,e)}}function p_(e,t){const r=[],n=[],i=[];return e.forEach(o=>{const a=o.getColDef().lockPosition;a==="right"?i.push(o):a==="left"||a===!0?r.push(o):n.push(o)}),t.get("enableRtl")?[...i,...n,...r]:[...r,...n,...i]}function m_(e,t){let r=!0;return Vo(null,t,n=>{if(!Tn(n))return;const i=n;if(!i.getColGroupDef()?.marryChildren)return;const a=[];for(const m of i.getLeafColumns()){const v=e.indexOf(m);a.push(v)}const u=Math.max.apply(Math,a),d=Math.min.apply(Math,a),h=u-d,g=i.getLeafColumns().length-1;h>g&&(r=!1)}),r}function v_(e,t){if(!e||e.length==0)return;const r=t(e[0]);for(let n=1;n<e.length;n++)if(r!==t(e[n]))return;return r}function w_(e,t,r){if(!t.length)return;const n=t.length===1?t[0]:null,i=v_(t,s=>s.getPinned());e.dispatchEvent({type:"columnPinned",pinned:i??null,columns:t,column:n,source:r})}function Q7(e,t,r){if(!t.length)return;const n=t.length===1?t[0]:null,i=v_(t,s=>s.isVisible());e.dispatchEvent({type:"columnVisible",visible:i,columns:t,column:n,source:r})}function Z7(e,t,r,n){e.dispatchEvent({type:t,columns:r,column:r&&r.length==1?r[0]:null,source:n})}function Ju(e,t,r,n,i=null){t?.length&&e.dispatchEvent({type:"columnResized",columns:t,column:t.length===1?t[0]:null,flexColumns:i,finished:r,source:n})}function Ss(e,t,r){const{colModel:n,rowGroupColsSvc:i,pivotColsSvc:s,autoColSvc:o,selectionColSvc:a,colAnimation:u,visibleCols:d,pivotResultCols:h,environment:g,valueColsSvc:m,eventSvc:v,gos:w}=e,C=n.getColDefCols()??[],b=a?.getColumns();if(!C.length&&!b?.length)return!1;if(t?.state&&!t.state.forEach)return Me(32),!1;const x=(D,M,F,O,L)=>{if(!D)return;const W=V7(M,t.defaultState),I=W("flex").value1;if(g_(e,D,W("hide").value1,W("sort").value1,W("sortIndex").value1,W("pinned").value1,I,r),I==null){const G=W("width").value1;if(G!=null){const ne=D.getColDef().minWidth??g.getDefaultColumnMinWidth();ne!=null&&G>=ne&&D.setActualWidth(G,r)}}L||!D.isPrimary()||(m?.syncColumnWithState(D,r,W),i?.syncColumnWithState(D,r,W,F),s?.syncColumnWithState(D,r,W,O))},R=(D,M,F)=>{const O=C_(e,r),L=M.slice(),W={},I={},G=[],ne=[],ie=[];let J=0;const _=i?.columns.slice()??[],Y=s?.columns.slice()??[];for(const se of D){const N=se.colId;if(N.startsWith(jm)){G.push(se),ie.push(se);continue}if(ea(N)){ne.push(se),ie.push(se);continue}const V=F(N);V?(x(V,se,W,I,!1),Ds(L,V)):(ie.push(se),J+=1)}const Q=se=>x(se,null,W,I,!1);L.forEach(Q),i?.sortColumns(qF.bind(i,W,_)),s?.sortColumns(qF.bind(s,I,Y)),n.refreshCols(!1,r);const U=(se,N,P=[])=>{for(const V of N){const H=se(V.colId);Ds(P,H),x(H,V,null,null,!0)}P.forEach(Q)};return U(se=>o?.getColumn(se)??null,G,o?.getColumns()?.slice()),U(se=>a?.getColumn(se)??null,ne,a?.getColumns()?.slice()),eW(t,n,w),d.refresh(r),v.dispatchEvent({type:"columnEverythingChanged",source:r}),O(),{unmatchedAndAutoStates:ie,unmatchedCount:J}};u?.start();let{unmatchedAndAutoStates:E,unmatchedCount:A}=R(t.state||[],C,D=>n.getColDefCol(D));if(E.length>0||$e(t.defaultState)){const D=h?.getPivotResultCols()?.list??[];A=R(E,D,M=>h?.getPivotResultCol(M)??null).unmatchedCount}return u?.finish(),A===0}function J7(e,t){const{colModel:r,autoColSvc:n,selectionColSvc:i,eventSvc:s,gos:o}=e,a=r.getColDefCols();if(!a?.length)return;const u=r.getColDefColTree(),d=h_(u),h=[];let g=1e3,m=1e3;const v=R=>{const E=y_(R);xr(E.rowGroupIndex)&&E.rowGroup&&(E.rowGroupIndex=g++),xr(E.pivotIndex)&&E.pivot&&(E.pivotIndex=m++),h.push(E)};n?.getColumns()?.forEach(v),i?.getColumns()?.forEach(v),d?.forEach(v),Ss(e,{state:h},t);const w=n?.getColumns()??[],x=[...i?.getColumns()??[],...w,...a].map(R=>({colId:R.colId}));Ss(e,{state:x,applyOrder:!0},t),s.dispatchEvent(it(o,{type:"columnsReset",source:t}))}function C_(e,t){const{rowGroupColsSvc:r,pivotColsSvc:n,valueColsSvc:i,colModel:s,sortSvc:o,eventSvc:a}=e,u={rowGroupColumns:r?.columns.slice()??[],pivotColumns:n?.columns.slice()??[],valueColumns:i?.columns.slice()??[]},d=O0(e),h={};for(const g of d)h[g.colId]=g;return()=>{const g=(M,F,O,L)=>{const W=F.map(L),I=O.map(L);if(tl(W,I))return;const ne=new Set(F);for(const J of O)ne.delete(J)||ne.add(J);const ie=[...ne];a.dispatchEvent({type:M,columns:ie,column:ie.length===1?ie[0]:null,source:t})},m=M=>{const F=[];return s.forAllCols(O=>{const L=h[O.getColId()];L&&M(L,O)&&F.push(O)}),F},v=M=>M.getColId();g("columnRowGroupChanged",u.rowGroupColumns,r?.columns??[],v),g("columnPivotChanged",u.pivotColumns,n?.columns??[],v);const C=m((M,F)=>{const O=M.aggFunc!=null,L=O!=F.isValueActive(),W=O&&M.aggFunc!=F.getAggFunc();return L||W});C.length>0&&Z7(a,"columnValueChanged",C,t),Ju(a,m((M,F)=>M.width!=F.getActualWidth()),!0,t),w_(a,m((M,F)=>M.pinned!=F.getPinned()),t),Q7(a,m((M,F)=>M.hide==F.isVisible()),t);const A=m((M,F)=>M.sort!=F.getSort()||M.sortIndex!=F.getSortIndex());A.length>0&&o?.dispatchSortChangedEvents(t,A);const D=O0(e);rW(d,D,t,s,a)}}function O0(e){const{colModel:t,rowGroupColsSvc:r,pivotColsSvc:n}=e,i=t.getColDefCols();if(xr(i)||!t.isAlive())return[];const s=r?.columns,o=n?.columns,a=[],u=h=>{const g=h.isRowGroupActive()&&s?s.indexOf(h):null,m=h.isPivotActive()&&o?o.indexOf(h):null,v=h.isValueActive()?h.getAggFunc():null,w=h.getSort()!=null?h.getSort():null,C=h.getSortIndex()!=null?h.getSortIndex():null;a.push({colId:h.getColId(),width:h.getActualWidth(),hide:!h.isVisible(),pinned:h.getPinned(),sort:w,sortIndex:C,aggFunc:v,rowGroup:h.isRowGroupActive(),rowGroupIndex:g,pivot:h.isPivotActive(),pivotIndex:m,flex:h.getFlex()??null})};t.forAllCols(h=>u(h));const d=new Map(t.getCols().map((h,g)=>[h.getColId(),g]));return a.sort((h,g)=>{const m=d.has(h.colId)?d.get(h.colId):-1,v=d.has(g.colId)?d.get(g.colId):-1;return m-v}),a}function y_(e){const t=(w,C)=>w??C??null,r=e.getColDef(),n=t(r.sort,r.initialSort),i=t(r.sortIndex,r.initialSortIndex),s=t(r.hide,r.initialHide),o=t(r.pinned,r.initialPinned),a=t(r.width,r.initialWidth),u=t(r.flex,r.initialFlex);let d=t(r.rowGroupIndex,r.initialRowGroupIndex),h=t(r.rowGroup,r.initialRowGroup);d==null&&!h&&(d=null,h=null);let g=t(r.pivotIndex,r.initialPivotIndex),m=t(r.pivot,r.initialPivot);g==null&&!m&&(g=null,m=null);const v=t(r.aggFunc,r.initialAggFunc);return{colId:e.getColId(),sort:n,sortIndex:i,hide:s,pinned:o,width:a,flex:u,rowGroup:h,rowGroupIndex:d,pivot:m,pivotIndex:g,aggFunc:v}}function eW(e,t,r){if(!e.applyOrder||!e.state)return;const n=[];for(const i of e.state)i.colId!=null&&n.push(i.colId);tW(t.cols,n,t,r)}function tW(e,t,r,n){if(e==null)return;let i=[];const s={};for(const a of t){if(s[a])continue;const u=e.map[a];u&&(i.push(u),s[a]=!0)}let o=0;for(const a of e.list){const u=a.getColId();if(s[u]!=null)continue;u.startsWith(jm)?i.splice(o++,0,a):i.push(a)}if(i=p_(i,n),!m_(i,r.getColTree())){Me(39);return}e.list=i}function rW(e,t,r,n,i){const s={};for(const h of t)s[h.colId]=h;const o={};for(const h of e)s[h.colId]&&(o[h.colId]=!0);const a=e.filter(h=>o[h.colId]),u=t.filter(h=>o[h.colId]),d=[];u.forEach((h,g)=>{const m=a?.[g];if(m&&m.colId!==h.colId){const v=n.getCol(m.colId);v&&d.push(v)}}),d.length&&i.dispatchEvent({type:"columnMoved",columns:d,column:d.length===1?d[0]:null,finished:!0,source:r})}var qF=(e,t,r,n)=>{const i=e[r.getId()],s=e[n.getId()],o=i!=null,a=s!=null;if(o&&a)return i-s;if(o)return-1;if(a)return 1;const u=t.indexOf(r),d=t.indexOf(n),h=u>=0,g=d>=0;return h&&g?u-d:h?-1:1},nW=class extends Ee{constructor(){super(...arguments),this.beanName="colModel",this.pivotMode=!1,this.ready=!1,this.changeEventsDispatching=!1}postConstruct(){this.pivotMode=this.gos.get("pivotMode"),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents","rowNumbers","hidePaddedHeaderRows"],e=>this.refreshAll(_u(e.source))),this.addManagedPropertyListeners(["defaultColDef","defaultColGroupDef","columnTypes","suppressFieldDotNotation"],this.recreateColumnDefs.bind(this)),this.addManagedPropertyListener("pivotMode",e=>this.setPivotMode(this.gos.get("pivotMode"),_u(e.source)))}createColsFromColDefs(e){const{beans:t}=this,{valueCache:r,colAutosize:n,rowGroupColsSvc:i,pivotColsSvc:s,valueColsSvc:o,visibleCols:a,eventSvc:u,groupHierarchyColSvc:d}=t,h=this.colDefs?C_(t,e):void 0;r?.expire();const g=this.colDefCols?.list,m=this.colDefCols?.tree,v=W7(t,this.colDefs,!0,m,e);L0(t,this.colDefCols?.tree,v.columnTree);const w=v.columnTree,C=v.treeDepth,b=h_(w),x={};for(const R of b)x[R.getId()]=R;this.colDefCols={tree:w,treeDepth:C,list:b,map:x},this.createColumnsForService([d],this.colDefCols,e),i?.extractCols(e,g),s?.extractCols(e,g),o?.extractCols(e,g),this.ready=!0,this.refreshCols(!0,e),a.refresh(e),u.dispatchEvent({type:"columnEverythingChanged",source:e}),h&&(this.changeEventsDispatching=!0,h(),this.changeEventsDispatching=!1),u.dispatchEvent({type:"newColumnsLoaded",source:e}),e==="gridInitializing"&&n?.applyAutosizeStrategy()}refreshCols(e,t){if(!this.colDefCols)return;const r=this.cols?.tree;this.saveColOrder();const{autoColSvc:n,selectionColSvc:i,rowNumbersSvc:s,quickFilter:o,pivotResultCols:a,showRowGroupCols:u,rowAutoHeight:d,visibleCols:h,colViewport:g,eventSvc:m}=this.beans,v=this.selectCols(a,this.colDefCols);this.createColumnsForService([n,i,s],v,t);const w=y7(this.gos,this.showingPivotResult);(!e||w)&&this.restoreColOrder(v),this.positionLockedCols(v),u?.refresh(),o?.refreshCols(),this.setColSpanActive(),d?.setAutoHeightActive(v),h.clear(),g.clear(),!tl(r,this.cols.tree)&&m.dispatchEvent({type:"gridColumnsChanged"})}createColumnsForService(e,t,r){for(const n of e)n&&(n.createColumns(t,i=>{this.lastOrder=i(this.lastOrder),this.lastPivotOrder=i(this.lastPivotOrder)},r),n.addColumns(t))}selectCols(e,t){const r=e?.getPivotResultCols()??null;this.showingPivotResult=r!=null;const{map:n,list:i,tree:s,treeDepth:o}=r??t;return this.cols={list:i.slice(),map:{...n},tree:s.slice(),treeDepth:o},r&&(r.list.some(u=>this.cols?.map[u.getColId()]!==void 0)||(this.lastPivotOrder=null)),this.cols}getColsToShow(){if(!this.cols)return[];const{valueColsSvc:e,selectionColSvc:t,gos:r}=this.beans,n=this.isPivotMode()&&!this.showingPivotResult,i=t?.isSelectionColumnEnabled(),s=r.get("rowNumbers"),o=e?.columns;return this.cols.list.filter(u=>{const d=ux(u);if(n){const h=o?.includes(u);return d||h||i&&ea(u)||s&&Go(u)}else return d||u.isVisible()})}refreshAll(e){this.ready&&(this.refreshCols(!1,e),this.beans.visibleCols.refresh(e))}setColsVisible(e,t=!1,r){Ss(this.beans,{state:e.map(n=>({colId:typeof n=="string"?n:n.getColId(),hide:!t}))},r)}restoreColOrder(e){const t=this.showingPivotResult?this.lastPivotOrder:this.lastOrder;if(!t)return;const r=t.filter(g=>e.map[g.getId()]!=null);if(r.length===0)return;if(r.length===e.list.length){e.list=r;return}const n=g=>{const m=g.getOriginalParent();return m?m.getChildren().length>1?!0:n(m):!1};if(!r.some(g=>n(g))){const g=new Set(r);for(const m of e.list)g.has(m)||r.push(m);e.list=r;return}const i=new Map;for(let g=0;g<r.length;g++){const m=r[g];i.set(m,g)}const s=e.list.filter(g=>!i.has(g));if(s.length===0){e.list=r;return}const o=(g,m)=>{const v=m?m.getOriginalParent():g.getOriginalParent();if(!v)return null;let w=null,C=null;for(const b of v.getChildren())if(!(b===m||b===g)){if(b instanceof mc){const x=i.get(b);if(x==null)continue;(w==null||w<x)&&(w=x,C=b);continue}b.forEachLeafColumn(x=>{const R=i.get(x);R!=null&&(w==null||w<R)&&(w=R,C=x)})}return C??o(g,v)},a=[],u=new Map;for(const g of s){const m=o(g,null);if(m==null){a.push(g);continue}const v=u.get(m);v===void 0?u.set(m,g):Array.isArray(v)?v.push(g):u.set(m,[v,g])}const d=new Array(e.list.length);let h=d.length-1;for(let g=a.length-1;g>=0;g--)d[h--]=a[g];for(let g=r.length-1;g>=0;g--){const m=r[g],v=u.get(m);if(v)if(Array.isArray(v))for(let w=v.length-1;w>=0;w--){const C=v[w];d[h--]=C}else d[h--]=v;d[h--]=m}e.list=d}positionLockedCols(e){e.list=p_(e.list,this.gos)}saveColOrder(){this.showingPivotResult?this.lastPivotOrder=this.cols?.list??null:this.lastOrder=this.cols?.list??null}getColumnDefs(e){return this.colDefCols&&this.beans.colDefFactory?.getColumnDefs(this.colDefCols.list,this.showingPivotResult,this.lastOrder,this.cols?.list??[],e)}setColSpanActive(){this.colSpanActive=!!this.cols?.list.some(e=>e.getColDef().colSpan!=null)}isPivotMode(){return this.pivotMode}setPivotMode(e,t){if(e===this.pivotMode||(this.pivotMode=e,!this.ready))return;this.refreshCols(!1,t);const{visibleCols:r,eventSvc:n}=this.beans;r.refresh(t),n.dispatchEvent({type:"columnPivotModeChanged"})}isPivotActive(){const e=this.beans.pivotColsSvc?.columns;return this.pivotMode&&!!e?.length}recreateColumnDefs(e){if(!this.cols)return;this.beans.autoColSvc?.updateColumns(e);const t=_u(e.source);this.createColsFromColDefs(t)}setColumnDefs(e,t){this.colDefs=e,this.createColsFromColDefs(t)}destroy(){L0(this.beans,this.colDefCols?.tree),super.destroy()}getColTree(){return this.cols?.tree??[]}getColDefColTree(){return this.colDefCols?.tree??[]}getColDefCols(){return this.colDefCols?.list??null}getCols(){return this.cols?.list??[]}forAllCols(e){const{pivotResultCols:t,autoColSvc:r,selectionColSvc:n,groupHierarchyColSvc:i}=this.beans;bh(this.colDefCols?.list,e),bh(r?.columns?.list,e),bh(n?.columns?.list,e),bh(i?.columns?.list,e),bh(t?.getPivotResultCols()?.list,e)}getColsForKeys(e){return e?e.map(t=>this.getCol(t)).filter(t=>t!=null):[]}getColDefCol(e){return this.colDefCols?.list?this.getColFromCollection(e,this.colDefCols):null}getCol(e){return e==null?null:this.getColFromCollection(e,this.cols)}getColById(e){return this.cols?.map[e]??null}getColFromCollection(e,t){if(t==null)return null;const{map:r,list:n}=t;if(typeof e=="string"&&r[e])return r[e];for(let a=0;a<n.length;a++)if(Hh(n[a],e))return n[a];const{autoColSvc:i,selectionColSvc:s,groupHierarchyColSvc:o}=this.beans;return i?.getColumn(e)??s?.getColumn(e)??o?.getColumn(e)??null}},b_=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){const t=this.existingIds[e];let r;return typeof t!="number"?r=0:r=t+1,this.existingIds[e]=r,r}},vd=class extends Ee{};function Gf(e,t,r){return r&&e.addDestroyFunc(()=>t.destroyBean(r)),r??e}var tt=null;function XF(e){return typeof e?.getGui=="function"}var Vf=class{constructor(e){this.cssClassStates={},this.getGui=e}toggleCss(e,t){if(!e)return;if(e.indexOf(" ")>=0){const n=(e||"").split(" ");if(n.length>1){for(const i of n)this.toggleCss(i,t);return}}this.cssClassStates[e]!==t&&e.length&&(this.getGui()?.classList.toggle(e,t),this.cssClassStates[e]=t)}},iW=0,zf=class extends ao{constructor(e,t){super(),this.suppressDataRefValidation=!1,this.displayed=!0,this.visible=!0,this.compId=iW++,this.cssManager=new Vf(()=>this.eGui),this.componentSelectors=new Map((t??[]).map(r=>[r.selector,r])),e&&this.setTemplate(e)}preConstruct(){this.wireTemplate(this.getGui());const e="component-"+Object.getPrototypeOf(this)?.constructor?.name;for(const t of this.css??[])this.beans.environment.addGlobalCSS(t,e)}wireTemplate(e,t){e&&this.gos&&(this.applyElementsToComponent(e),this.createChildComponentsFromTags(e,t))}getCompId(){return this.compId}getDataRefAttribute(e){return e.getAttribute?e.getAttribute(HM):null}applyElementsToComponent(e,t,r,n=null){if(t===void 0&&(t=this.getDataRefAttribute(e)),t){const i=this[t];if(i===tt)this[t]=n??e;else{const s=r?.[t];if(!this.suppressDataRefValidation&&!s)throw new Error(`data-ref: ${t} on ${this.constructor.name} with ${i}`)}}}createChildComponentsFromTags(e,t){const r=[];for(const n of e.childNodes??[])r.push(n);for(const n of r){if(!(n instanceof HTMLElement))continue;const i=this.createComponentFromElement(n,s=>{const o=s.getGui();if(o)for(const a of n.attributes??[])o.setAttribute(a.name,a.value)},t);if(i){if(i.addItems&&n.children.length){this.createChildComponentsFromTags(n,t);const s=Array.prototype.slice.call(n.children);i.addItems(s)}this.swapComponentForNode(i,e,n)}else n.childNodes&&this.createChildComponentsFromTags(n,t)}}createComponentFromElement(e,t,r){const n=e.nodeName,i=this.getDataRefAttribute(e),s=n.indexOf("AG-")===0,o=s?this.componentSelectors.get(n):null;let a=null;if(o){const u=r&&i?r[i]:void 0;a=new o.component(u),a.setParentComponent(this),this.createBean(a,null,t)}else if(s)throw new Error(`selector: ${n}`);return this.applyElementsToComponent(e,i,r,a),a}swapComponentForNode(e,t,r){const n=e.getGui();t.replaceChild(n,r),t.insertBefore(document.createComment(r.nodeName),n),this.addDestroyFunc(this.destroyBean.bind(this,e))}activateTabIndex(e){const t=this.gos.get("tabIndex");e||(e=[]),e.length||e.push(this.getGui());for(const r of e)r.setAttribute("tabindex",t.toString())}setTemplate(e,t,r){let n;typeof e=="string"||e==null?n=ex(e):n=Hf(e),this.setTemplateFromElement(n,t,r)}setTemplateFromElement(e,t,r,n=!1){if(this.eGui=e,this.suppressDataRefValidation=n,t)for(let i=0;i<t.length;i++){const s=t[i];this.componentSelectors.set(s.selector,s)}this.wireTemplate(e,r)}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(e){this.parentComponent=e}getParentComponent(){return this.parentComponent}setGui(e){this.eGui=e}queryForHtmlElement(e){return this.eGui.querySelector(e)}getContainerAndElement(e,t){let r=t;return e==null?null:(r||(r=this.eGui),nx(e)?{element:e,parent:r}:{element:e.getGui(),parent:r})}prependChild(e,t){const{element:r,parent:n}=this.getContainerAndElement(e,t)||{};!r||!n||n.insertAdjacentElement("afterbegin",r)}appendChild(e,t){const{element:r,parent:n}=this.getContainerAndElement(e,t)||{};!r||!n||n.appendChild(r)}isDisplayed(){return this.displayed}setVisible(e,t={}){if(e!==this.visible){this.visible=e;const{skipAriaHidden:r}=t;Bz(this.eGui,e,{skipAriaHidden:r})}}setDisplayed(e,t={}){if(e!==this.displayed){this.displayed=e;const{skipAriaHidden:r}=t;Er(this.eGui,e,{skipAriaHidden:r});const n={type:"displayChanged",visible:this.displayed};this.dispatchLocalEvent(n)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),super.destroy()}addGuiEventListener(e,t,r){this.eGui.addEventListener(e,t,r),this.addDestroyFunc(()=>this.eGui.removeEventListener(e,t))}addCss(e){this.cssManager.toggleCss(e,!0)}removeCss(e){this.cssManager.toggleCss(e,!1)}toggleCss(e,t){this.cssManager.toggleCss(e,t)}registerCSS(e){this.css||(this.css=[]),this.css.push(e)}},Dr=class extends zf{};function S_(e){return typeof e=="object"&&!!e.component}function sW(e,t){return new Nt(r=>{r(window.setInterval(e,t))})}var Nt=class Ah{constructor(t){this.status=0,this.resolution=null,this.waiters=[],t(r=>this.onDone(r),r=>this.onReject(r))}static all(t){return t.length?new Ah(r=>{let n=t.length;const i=new Array(n);t.forEach((s,o)=>{s.then(a=>{i[o]=a,n--,n===0&&r(i)})})}):Ah.resolve()}static resolve(t=null){return new Ah(r=>r(t))}then(t){return new Ah(r=>{this.status===1?r(t(this.resolution)):this.waiters.push(n=>r(t(n)))})}onDone(t){this.status=1,this.resolution=t;for(const r of this.waiters)r(t)}onReject(t){}};function oW(e){return e?e.prototype&&"getGui"in e.prototype:!1}function x_(e,t,r,n){const{name:i}=r;let s,o,a,u,d,h;if(t){const g=t,m=g[i+"Selector"],v=m?m(n):null,w=C=>{typeof C=="string"?s=C:C!=null&&C!==!0&&(e.isFrameworkComponent(C)?a=C:o=C)};v?(w(v.component),u=v.params,d=v.popup,h=v.popupPosition):w(g[i])}return{compName:s,jsComp:o,fwComp:a,paramsFromSelector:u,popupFromSelector:d,popupPositionFromSelector:h}}var aW=class extends Ee{constructor(){super(...arguments),this.beanName="userCompFactory"}wireBeans(e){this.agCompUtils=e.agCompUtils,this.registry=e.registry,this.frameworkCompWrapper=e.frameworkCompWrapper,this.gridOptions=e.gridOptions}getCompDetailsFromGridOptions(e,t,r,n=!1){return this.getCompDetails(this.gridOptions,e,t,r,n)}getCompDetails(e,t,r,n,i=!1){const{name:s,cellRenderer:o}=t;let{compName:a,jsComp:u,fwComp:d,paramsFromSelector:h,popupFromSelector:g,popupPositionFromSelector:m}=x_(this.beans.frameworkOverrides,e,t,n),v,w;const C=E=>{const A=this.registry.getUserComponent(s,E);A&&(u=A.componentFromFramework?void 0:A.component,d=A.componentFromFramework?A.component:void 0,v=A.params,w=A.processParams)};if(a!=null&&C(a),u==null&&d==null&&r!=null&&C(r),u&&o&&!oW(u)&&(u=this.agCompUtils?.adaptFunction(t,u)),!u&&!d){const{validation:E}=this.beans;i&&(a!==r||!r)?a?E?.isProvidedUserComp(a)||Zt(50,{compName:a}):r?E||Zt(260,{...this.gos.getModuleErrorParams(),propName:s,compName:r}):Zt(216,{name:s}):r&&!E&&Zt(146,{comp:r});return}const b=this.mergeParams(e,t,n,h,v,w),x=u==null,R=u??d;return{componentFromFramework:x,componentClass:R,params:b,type:t,popupFromSelector:g,popupPositionFromSelector:m,newAgStackInstance:()=>this.newAgStackInstance(R,x,b,t)}}newAgStackInstance(e,t,r,n){const i=!t;let s;i?s=new e:s=this.frameworkCompWrapper.wrap(e,n.mandatoryMethods,n.optionalMethods,n),this.createBean(s);const o=s.init?.(r);return o==null?Nt.resolve(s):o.then(()=>s)}mergeParams(e,t,r,n=null,i,s){const o={...r,...i},u=e?.[t.name+"Params"];if(typeof u=="function"){const d=u(r);Wn(o,d)}else typeof u=="object"&&Wn(o,u);return Wn(o,n),s?s(o):o}},lW={name:"dateComponent",mandatoryMethods:["getDate","setDate"],optionalMethods:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","refresh"]},cW={name:"dragAndDropImageComponent",mandatoryMethods:["setIcon","setLabel"]},uW={name:"headerComponent",optionalMethods:["refresh"]},dW={name:"innerHeaderComponent"},hW={name:"innerHeaderGroupComponent"},fW={name:"headerGroupComponent"},gW={name:"cellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},pW={name:"loadingCellRenderer",cellRenderer:!0},mW={name:"cellEditor",mandatoryMethods:["getValue"],optionalMethods:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},vW={name:"loadingOverlayComponent",optionalMethods:["refresh"]},wW={name:"noRowsOverlayComponent",optionalMethods:["refresh"]},CW={name:"tooltipComponent"},dx={name:"filter",mandatoryMethods:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethods:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},yW={name:"floatingFilterComponent",mandatoryMethods:["onParentModelChanged"],optionalMethods:["afterGuiAttached","refresh"]},bW={name:"fullWidthCellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},SW={name:"loadingCellRenderer",cellRenderer:!0},xW={name:"groupRowRenderer",optionalMethods:["afterGuiAttached"],cellRenderer:!0},EW={name:"detailCellRenderer",optionalMethods:["refresh"],cellRenderer:!0};function RW(e,t){return e.getCompDetailsFromGridOptions(cW,"agDragAndDropImage",t,!0)}function TW(e,t,r){return e.getCompDetails(t,uW,"agColumnHeader",r)}function FW(e,t,r){return e.getCompDetails(t,dW,void 0,r)}function DW(e,t){const r=t.columnGroup.getColGroupDef();return e.getCompDetails(r,fW,"agColumnGroupHeader",t)}function AW(e,t,r){return e.getCompDetails(t,hW,void 0,r)}function kW(e,t){return e.getCompDetailsFromGridOptions(bW,void 0,t,!0)}function PW(e,t){return e.getCompDetailsFromGridOptions(SW,"agLoadingCellRenderer",t,!0)}function MW(e,t){return e.getCompDetailsFromGridOptions(xW,"agGroupRowRenderer",t,!0)}function _W(e,t){return e.getCompDetailsFromGridOptions(EW,"agDetailCellRenderer",t,!0)}function QF(e,t,r){return e.getCompDetails(t,gW,void 0,r)}function ZF(e,t,r){return e.getCompDetails(t,pW,"agSkeletonCellRenderer",r,!0)}function E_(e,t,r){return e.getCompDetails(t,mW,"agCellEditor",r,!0)}function LW(e,t,r,n){const i=t.filter;return S_(i)&&(t={filter:i.component,filterParams:t.filterParams}),e.getCompDetails(t,dx,n,r,!0)}function IW(e,t,r){return e.getCompDetails(t,lW,"agDateInput",r,!0)}function OW(e,t){return e.getCompDetailsFromGridOptions(vW,"agLoadingOverlay",t,!0)}function NW(e,t){return e.getCompDetailsFromGridOptions(wW,"agNoRowsOverlay",t,!0)}function BW(e,t){return e.getCompDetails(t.colDef,CW,"agTooltipComponent",t,!0)}function HW(e,t,r,n){return e.getCompDetails(t,yW,n,r)}function R_(e,t){return x_(e,t,dx)}function sy(e,t,r){return e.mergeParams(t,dx,r)}function hf(e){const t=e;return t?.getFrameworkComponentInstance!=null?t.getFrameworkComponentInstance():e}function GW(e){return typeof e=="object"&&!!e.getComp}var me={BACKSPACE:"Backspace",TAB:"Tab",ENTER:"Enter",ESCAPE:"Escape",SPACE:" ",LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown",DELETE:"Delete",F2:"F2",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",PAGE_HOME:"Home",PAGE_END:"End",A:"KeyA",C:"KeyC",D:"KeyD",V:"KeyV",X:"KeyX",Y:"KeyY",Z:"KeyZ"},hx=class extends zf{isPopup(){return!0}setParentComponent(e){e.addCss("ag-has-popup"),super.setParentComponent(e)}destroy(){const e=this.parentComponent;e?.isAlive()&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}},oy,ay,ly,cy,Tb,Fb,uy;function rl(){return oy===void 0&&(oy=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),oy}function T_(){return ay===void 0&&(ay=/(firefox)/i.test(navigator.userAgent)),ay}function F_(){return ly===void 0&&(ly=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),ly}function Wl(){return cy===void 0&&(cy=/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1),cy}function Db(e){if(!e)return null;const t=e.tabIndex,r=e.getAttribute("tabIndex");return t===-1&&(r===null||r===""&&!T_())?null:t.toString()}function VW(){if(uy!==void 0)return uy;if(!document.body)return-1;let e=1e6;const t=T_()?6e6:1e9,r=document.createElement("div");for(document.body.appendChild(r);;){const n=e*2;if(r.style.height=n+"px",n>t||r.clientHeight!==n)break;e=n}return r.remove(),uy=e,e}function zW(){return Fb==null&&D_(),Fb}function D_(){const e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let r=t.offsetWidth-t.clientWidth;r===0&&t.clientWidth===0&&(r=null),t.parentNode&&t.remove(),r!=null&&(Fb=r,Tb=r===0)}function A_(){return Tb==null&&D_(),Tb}var fx="T",WW=new RegExp(`[${fx} ]`),UW=new RegExp(`^\\d{4}-\\d{2}-\\d{2}(${fx}\\d{2}:\\d{2}:\\d{2}\\D?)?`);function Ks(e,t){return e.toString().padStart(t,"0")}function Fi(e,t=!0,r=fx){if(!e)return null;let n=[e.getFullYear(),e.getMonth()+1,e.getDate()].map(i=>Ks(i,2)).join("-");return t&&(n+=r+[e.getHours(),e.getMinutes(),e.getSeconds()].map(i=>Ks(i,2)).join(":")),n}function Rp(e,t=!0){return e?t?[String(e.getFullYear()),String(e.getMonth()+1),Ks(e.getDate(),2),Ks(e.getHours(),2),`:${Ks(e.getMinutes(),2)}`,`:${Ks(e.getSeconds(),2)}`]:[e.getFullYear(),e.getMonth()+1,Ks(e.getDate(),2)].map(String):null}var dy=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"},JF=["January","February","March","April","May","June","July","August","September","October","November","December"],hy=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function Ab(e,t){if(t==null)return Fi(e,!1);const r=Ks(e.getFullYear(),4),n={YYYY:()=>r.slice(r.length-4,r.length),YY:()=>r.slice(r.length-2,r.length),Y:()=>`${e.getFullYear()}`,MMMM:()=>JF[e.getMonth()],MMM:()=>JF[e.getMonth()].slice(0,3),MM:()=>Ks(e.getMonth()+1,2),Mo:()=>`${e.getMonth()+1}${dy(e.getMonth()+1)}`,M:()=>`${e.getMonth()+1}`,Do:()=>`${e.getDate()}${dy(e.getDate())}`,DD:()=>Ks(e.getDate(),2),D:()=>`${e.getDate()}`,dddd:()=>hy[e.getDay()],ddd:()=>hy[e.getDay()].slice(0,3),dd:()=>hy[e.getDay()].slice(0,2),do:()=>`${e.getDay()}${dy(e.getDay())}`,d:()=>`${e.getDay()}`},i=new RegExp(Object.keys(n).join("|"),"g");return t.replace(i,s=>s in n?n[s]():s)}function s0(e,t=!1){return!!ui(e,t)}function $W(e){return s0(e,!0)}function ui(e,t=!1,r){if(!e||!r&&!UW.test(e))return null;const[n,i]=e.split(WW);if(!n)return null;const s=n.split("-").map(v=>Number.parseInt(v,10));if(s.filter(v=>!isNaN(v)).length!==3)return null;const[o,a,u]=s,d=new Date(o,a-1,u);if(d.getFullYear()!==o||d.getMonth()!==a-1||d.getDate()!==u||!i&&t)return null;if(!i||i==="00:00:00")return d;const[h,g,m]=i.split(":").map(v=>Number.parseInt(v,10));if(h>=0&&h<24)d.setHours(h);else if(t)return null;if(g>=0&&g<60)d.setMinutes(g);else if(t)return null;if(m>=0&&m<60)d.setSeconds(m);else if(t)return null;return d}function kb(e){const{inputValue:t,allSuggestions:r,hideIrrelevant:n,filterByPercentageOfBestMatch:i}=e;let s=(r??[]).map((u,d)=>({value:u,relevance:jW(t,u),idx:d}));if(s.sort((u,d)=>u.relevance-d.relevance),n&&(s=s.filter(u=>u.relevance<Math.max(u.value.length,t.length))),s.length>0&&i&&i>0){const d=s[0].relevance*i;s=s.filter(h=>d-h.relevance<0)}const o=[],a=[];for(const u of s)o.push(u.value),a.push(u.idx);return{values:o,indices:a}}function jW(e,t){e.length<t.length&&([e,t]=[t,e]);let r=[],n=[];const i=e.length,s=t.length;for(let a=0;a<=s;a++)r[a]=a;let o=0;for(let a=1;a<=i;a++){n[0]=a;for(let u=1;u<=s;u++){const d=e[a-1],h=t[u-1];if(d.toLocaleLowerCase()===h.toLocaleLowerCase())++o,d===h&&++o,a>1&&u>1&&e[a-2].toLocaleLowerCase()===t[u-2].toLocaleLowerCase()&&(++o,e[a-2]===t[u-2]&&++o),a<i/2-10&&++o,n[u]=r[u-1];else{const g=n[u-1],m=r[u],v=r[u-1];n[u]=1+Math.min(g,m,v)}}[r,n]=[n,r]}return r[s]/(o+1)}function k_(e){return e.altKey||e.ctrlKey||e.metaKey?!1:e.key?.length===1}var Pb=!1,N0=0;function YW(e){N0>0||(e.addEventListener("keydown",B0),e.addEventListener("mousedown",B0))}function KW(e){N0>0||(e.removeEventListener("keydown",B0),e.removeEventListener("mousedown",B0))}function B0(e){const t=Pb,r=e.type==="keydown";r&&(e.ctrlKey||e.metaKey||e.altKey)||t!==r&&(Pb=r)}function qW(e){const t=un(e);return YW(t),N0++,()=>{N0--,KW(t)}}function XW(){return Pb}function Lu(e,t,r=!1){const n=Nz;let i=LM;t&&(i+=", "+t),r&&(i+=', [tabindex="-1"]');const s=Array.prototype.slice.apply(e.querySelectorAll(n)).filter(u=>Qo(u)),o=Array.prototype.slice.apply(e.querySelectorAll(i));return o.length?((u,d)=>u.filter(h=>d.indexOf(h)===-1))(s,o):s}function rc(e,t=!1,r=!1,n=!1){const i=Lu(e,n?".ag-tab-guard":null,r),s=t?ir(i):i[0];return s?(s.focus({preventScroll:!0}),!0):!1}function vc(e,t,r,n){const i=Lu(t,r?':not([tabindex="-1"])':null),s=Fr(e);let o;r?o=i.findIndex(u=>u.contains(s)):o=i.indexOf(s);const a=o+(n?-1:1);return a<0||a>=i.length?null:i[a]}function P_(e,t=5){let r=0;for(;e&&Db(e)===null&&++r<=t;)e=e.parentElement;return Db(e)===null?null:e}var QW=".ag-label{white-space:nowrap}:where(.ag-ltr) .ag-label{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-label-align-right) .ag-label{order:1}:where(.ag-ltr) :where(.ag-label-align-right) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-rtl) :where(.ag-label-align-right) .ag-label{margin-right:var(--ag-spacing)}.ag-label-align-right>*{flex:none}.ag-label-align-top{align-items:flex-start;flex-direction:column;>*{align-self:stretch}}.ag-label-ellipsis{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-label-align-top) .ag-label{margin-bottom:calc(var(--ag-spacing)*.5)}",ZW=class extends zf{constructor(e,t,r){super(t,r),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{},this.registerCSS(QW)}postConstruct(){this.addCss("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator:e,label:t,labelWidth:r,labelAlignment:n,disabled:i}=this.config;i!=null&&this.setDisabled(i),e!=null&&this.setLabelSeparator(e),t!=null&&this.setLabel(t),r!=null&&this.setLabelWidth(r),this.setLabelAlignment(n||this.labelAlignment),this.refreshLabel()}refreshLabel(){const{label:e,eLabel:t}=this;ci(t),typeof e=="string"?t.innerText=e+this.labelSeparator:e&&t.appendChild(e),e===""?(Er(t,!1),Jl(t,"presentation")):(Er(t,!0),Jl(t,null))}setLabelSeparator(e){return this.labelSeparator===e?this:(this.labelSeparator=e,this.label!=null&&this.refreshLabel(),this)}getLabelId(){const e=this.eLabel;return e.id=e.id||`ag-${this.getCompId()}-label`,e.id}getLabel(){return this.label}setLabel(e){return this.label===e?this:(this.label=e,this.refreshLabel(),this)}setLabelAlignment(e){const r=this.getGui().classList;return r.toggle("ag-label-align-left",e==="left"),r.toggle("ag-label-align-right",e==="right"),r.toggle("ag-label-align-top",e==="top"),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return this.label==null?this:(F0(this.eLabel,e),this)}setDisabled(e){e=!!e;const t=this.getGui();return af(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}},M_=class extends ZW{constructor(e,t,r,n){super(e,t,r),this.className=n}postConstruct(){super.postConstruct();const{width:e,value:t,onValueChange:r}=this.config;e!=null&&this.setWidth(e),t!=null&&this.setValue(t),r!=null&&this.onValueChange(r),this.className&&this.addCss(this.className),this.refreshAriaLabelledBy()}setLabel(e){return super.setLabel(e),this.refreshAriaLabelledBy(),this}refreshAriaLabelledBy(){const e=this.getAriaElement(),t=this.getLabelId(),r=this.getLabel();r==null||r==""||Sz(e)!==null?of(e,""):of(e,t??"")}setAriaLabel(e){return Qu(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListeners(this,{fieldValueChanged:()=>e(this.getValue())}),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return Js(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e?this:(this.previousValue=this.value,this.value=e,t||this.dispatchLocalEvent({type:"fieldValueChanged"}),this)}};function JW(e){return{tag:"div",role:"presentation",children:[{tag:"div",ref:"eLabel",cls:"ag-input-field-label"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-input-wrapper",role:"presentation",children:[{tag:e,ref:"eInput",cls:"ag-input-field-input"}]}]}}var Il=class extends M_{constructor(e,t,r="text",n="input"){super(e,e?.template??JW(n),[],t),this.inputType=r,this.displayFieldTag=n,this.eLabel=tt,this.eWrapper=tt,this.eInput=tt}postConstruct(){super.postConstruct(),this.setInputType(this.inputType);const{eLabel:e,eWrapper:t,eInput:r,className:n}=this;e.classList.add(`${n}-label`),t.classList.add(`${n}-input-wrapper`),r.classList.add(`${n}-input`),this.addCss("ag-input-field"),r.id=r.id||`ag-${this.getCompId()}-input`;const{inputName:i,inputWidth:s}=this.config;i!=null&&this.setInputName(i),s!=null&&this.setInputWidth(s),this.addInputListeners(),this.activateTabIndex([r])}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:e=>this.setValue(e.target.value)})}setInputType(e){this.displayFieldTag==="input"&&(this.inputType=e,Ei(this.eInput,"type",e))}getInputElement(){return this.eInput}setInputWidth(e){return F0(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){const t=this.eInput;return t.maxLength=e,this}setInputPlaceholder(e){return Ei(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return Qu(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return af(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){if(e===!0)Ei(this.eInput,"autocomplete",null);else{const t=typeof e=="string"?e:"off";Ei(this.eInput,"autocomplete",t)}return this}},gx=class extends Il{constructor(e,t="ag-checkbox",r="checkbox"){super(e,t,r),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();const{readOnly:e,passive:t}=this.config;typeof e=="boolean"&&this.setReadOnly(e),typeof t=="boolean"&&this.setPassive(t)}addInputListeners(){this.addManagedElementListeners(this.eInput,{click:this.onCheckboxClick.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.toggle.bind(this)})}getNextValue(){return this.selected===void 0?!0:!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;const e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){const t=this.getInputElement();return t.name=e,this}isSelected(){return this.selected}setSelected(e,t){if(this.isSelected()===e)return;this.previousValue=this.isSelected(),e=this.selected=typeof e=="boolean"?e:void 0;const r=this.eInput;r.checked=e,r.indeterminate=e===void 0,t||this.dispatchChange(this.selected,this.previousValue)}dispatchChange(e,t,r){this.dispatchLocalEvent({type:"fieldValueChanged",selected:e,previousValue:t,event:r});const n=this.getInputElement();this.eventSvc.dispatchEvent({type:"checkboxChanged",id:n.id,name:n.name,selected:e,previousValue:t})}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;const t=this.isSelected(),r=this.selected=e.target.checked;this.refreshSelectedClass(r),this.dispatchChange(r,t,e)}refreshSelectedClass(e){const t=this.eWrapper.classList;t.toggle("ag-checked",e===!0),t.toggle("ag-indeterminate",e==null)}},px={selector:"AG-CHECKBOX",component:gx},e9=class extends gx{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedEventListeners({checkboxChanged:this.onChange.bind(this)})}onChange(e){const t=this.eInput;e.selected&&e.name&&t.name&&t.name===e.name&&e.id&&t.id!==e.id&&this.setValue(!1,!0)}},wc=class extends Il{constructor(e,t="ag-text-field",r="text"){super(e,t,r)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){const r=this.eInput;return r.value!==e&&(r.value=$e(e)?e:""),super.setValue(e,t)}setStartValue(e){this.setValue(e,!0)}preventDisallowedCharacters(){const e=new RegExp(`[${this.config.allowedCharPattern}]`),t=r=>{k_(r)&&r.key&&!e.test(r.key)&&r.preventDefault()};this.addManagedListeners(this.eInput,{keydown:t,paste:r=>{r.clipboardData?.getData("text")?.split("").some(i=>!e.test(i))&&r.preventDefault()}})}},Ym={selector:"AG-INPUT-TEXT-FIELD",component:wc},t9=class extends Il{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){const r=super.setValue(e,t);return this.eInput.value=e,r}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}},r9={selector:"AG-INPUT-TEXT-AREA",component:t9},mx=class extends wc{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct();const e=this.eInput;this.addManagedListeners(e,{blur:()=>{const s=Number.parseFloat(e.value),o=isNaN(s)?"":this.normalizeValue(s.toString());this.value!==o&&this.setValue(o)},wheel:this.onWheel.bind(this)}),e.step="any";const{precision:t,min:r,max:n,step:i}=this.config;typeof t=="number"&&this.setPrecision(t),typeof r=="number"&&this.setMin(r),typeof n=="number"&&this.setMax(n),typeof i=="number"&&this.setStep(i)}onWheel(e){Fr(this.beans)===this.eInput&&e.preventDefault()}normalizeValue(e){return e===""?"":(this.precision!=null&&(e=this.adjustPrecision(e)),e)}adjustPrecision(e,t){const r=this.precision;if(r==null)return e;if(t){const i=Number.parseFloat(e).toFixed(r);return Number.parseFloat(i).toString()}const n=String(e).split(".");if(n.length>1){if(n[1].length<=r)return e;if(r>0)return`${n[0]}.${n[1].slice(0,r)}`}return n[0]}setMin(e){return this.min===e?this:(this.min=e,Ei(this.eInput,"min",e),this)}setMax(e){return this.max===e?this:(this.max=e,Ei(this.eInput,"max",e),this)}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e?this:(this.step=e,Ei(this.eInput,"step",e),this)}setValue(e,t){return this.setValueOrInputValue(r=>super.setValue(r,t),()=>this,e)}setStartValue(e){return this.setValueOrInputValue(t=>super.setValue(t,!0),t=>{this.eInput.value=t},e)}setValueOrInputValue(e,t,r){if($e(r)){let n=this.isScientificNotation(r);if(n&&this.eInput.validity.valid)return e(r);if(!n){r=this.adjustPrecision(r);const i=this.normalizeValue(r);n=r!=i}if(n)return t(r)}return e(r)}getValue(){const e=this.eInput;if(!e.validity.valid)return;const t=e.value;return this.isScientificNotation(t)?this.adjustPrecision(t,!0):super.getValue()}isScientificNotation(e){return typeof e=="string"&&e.includes("e")}},n9={selector:"AG-INPUT-NUMBER-FIELD",component:mx},i9=class extends wc{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct();const e=rl();this.addManagedListeners(this.eInput,{wheel:this.onWheel.bind(this),mousedown:()=>{this.isDisabled()||e||this.eInput.focus()}}),this.eInput.step="any"}onWheel(e){Fr(this.beans)===this.eInput&&e.preventDefault()}setMin(e){const t=e instanceof Date?Fi(e??null,!!this.includeTime)??void 0:e;return this.min===t?this:(this.min=t,Ei(this.eInput,"min",t),this)}setMax(e){const t=e instanceof Date?Fi(e??null,!!this.includeTime)??void 0:e;return this.max===t?this:(this.max=t,Ei(this.eInput,"max",t),this)}setStep(e){return this.step===e?this:(this.step=e,Ei(this.eInput,"step",e),this)}setIncludeTime(e){return this.includeTime===e?this:(this.includeTime=e,super.setInputType(e?"datetime-local":"date"),e&&this.setStep(1),this)}getDate(){if(this.eInput.validity.valid)return ui(this.getValue())??void 0}setDate(e,t){this.setValue(Fi(e??null,this.includeTime),t)}},__={selector:"AG-INPUT-DATE-FIELD",component:i9},s9=".ag-list-item{align-items:center;display:flex;height:var(--ag-list-item-height);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;&.ag-active-item{background-color:var(--ag-row-hover-color)}}",o9="ag-active-item",a9=(e,t)=>({tag:"div",cls:`ag-list-item ag-${e}-list-item`,attrs:{role:"option"},children:[{tag:"span",ref:"eText",children:t}]}),l9=class extends zf{constructor(e,t,r){super(a9(e,t)),this.label=t,this.value=r,this.eText=tt}postConstruct(){this.createTooltip(),this.addEventListeners()}setHighlighted(e){const t=this.getGui();t.classList.toggle(o9,e),_M(t,e),this.dispatchLocalEvent({type:"itemHighlighted",highlighted:e})}getHeight(){return this.getGui().clientHeight}setIndex(e,t){const r=this.getGui();Dz(r,e),Fz(r,t)}createTooltip(){const e={getTooltipValue:()=>this.label,getGui:()=>this.getGui(),getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>tx(this.eText)},t=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("highlightTooltipFeature",!1,e,this));t&&(this.tooltipFeature=t)}addEventListeners(){const e=this.getParentComponent();e&&(this.addGuiEventListener("mouseover",()=>{e.highlightItem(this)}),this.addGuiEventListener("mousedown",t=>{t.preventDefault(),t.stopPropagation(),e.setValue(this.value)}))}},c9=class extends zf{constructor(e="default"){super({tag:"div",cls:`ag-list ag-${e}-list`}),this.cssIdentifier=e,this.options=[],this.listItems=[],this.highlightedItem=null,this.registerCSS(s9)}postConstruct(){const e=this.getGui();this.addManagedElementListeners(e,{mouseleave:()=>this.clearHighlighted()})}handleKeyDown(e){const t=e.key;switch(t){case me.ENTER:if(!this.highlightedItem)this.setValue(this.getValue());else{const r=this.listItems.indexOf(this.highlightedItem);this.setValueByIndex(r)}break;case me.DOWN:case me.UP:e.preventDefault(),this.navigate(t);break;case me.PAGE_DOWN:case me.PAGE_UP:case me.PAGE_HOME:case me.PAGE_END:e.preventDefault(),this.navigateToPage(t);break}}addOptions(e){for(const t of e)this.addOption(t);return this}addOption(e){const{value:t,text:r}=e,n=r??t;return this.options.push({value:t,text:n}),this.renderOption(t,n),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0);for(const e of this.listItems)e.destroy();ci(this.getGui()),this.listItems=[],this.refreshAriaRole()}setValue(e,t){if(this.value===e)return this.fireItemSelected(),this;if(e==null)return this.reset(t),this;const r=this.options.findIndex(n=>n.value===e);if(r!==-1){const n=this.options[r];this.value=n.value,this.displayValue=n.text,this.highlightItem(this.listItems[r]),t||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();const e=this.options.findIndex(t=>t.value===this.value);e!==-1&&this.highlightItem(this.listItems[e])}highlightItem(e){const t=e.getGui();if(!Qo(t))return;this.clearHighlighted(),e.setHighlighted(!0),this.highlightedItem=e;const r=this.getGui(),{scrollTop:n,clientHeight:i}=r,{offsetTop:s,offsetHeight:o}=t;(s+o>n+i||s<n)&&t.scrollIntoView({block:"nearest"})}hideItemTooltip(){this.highlightedItem?.tooltipFeature?.attemptToHideTooltip()}destroy(){this.hideItemTooltip(),super.destroy()}reset(e){this.value=null,this.displayValue=null,this.clearHighlighted(),e||this.fireChangeEvent()}clearHighlighted(){this.highlightedItem?.setHighlighted(!1),this.highlightedItem=null}renderOption(e,t){const r=new l9(this.cssIdentifier,t,e);r.setParentComponent(this);const n=this.createManagedBean(r);this.listItems.push(n),this.getGui().appendChild(n.getGui())}navigate(e){const t=e===me.DOWN;let r;const{listItems:n,highlightedItem:i}=this;if(!i)r=t?n[0]:ir(n);else{let o=n.indexOf(i)+(t?1:-1);o=Math.min(Math.max(o,0),n.length-1),r=n[o]}this.highlightItem(r)}navigateToPage(e){const{listItems:t,highlightedItem:r}=this;if(!r||t.length===0)return;const n=t.indexOf(r),i=this.options.length-1,s=t[0].getHeight(),o=Math.floor(this.getGui().clientHeight/s);let a=-1;e===me.PAGE_HOME?a=0:e===me.PAGE_END?a=i:e===me.PAGE_DOWN?a=Math.min(n+o,i):e===me.PAGE_UP&&(a=Math.max(n-o,0)),a!==-1&&this.highlightItem(t[a])}refreshAriaRole(){Jl(this.getGui(),this.options.length===0?"presentation":"listbox")}updateIndices(){this.refreshAriaRole();const e=this.listItems,t=e.length;e.forEach((r,n)=>{r.setIndex(n+1,t)})}fireChangeEvent(){this.dispatchLocalEvent({type:"fieldValueChanged"}),this.fireItemSelected()}fireItemSelected(){this.dispatchLocalEvent({type:"selectedItem"})}},u9=".ag-picker-field-display{flex:1 1 auto}.ag-picker-field{align-items:center;display:flex}.ag-picker-field-icon{border:0;cursor:pointer;display:flex;margin:0;padding:0}.ag-picker-field-wrapper{background-color:var(--ag-picker-button-background-color);border:var(--ag-picker-button-border);border-radius:5px;min-height:max(var(--ag-list-item-height),calc(var(--ag-spacing)*4));overflow:hidden;&:where(.ag-picker-has-focus),&:where(:focus-within){background-color:var(--ag-picker-button-focus-background-color);border:var(--ag-picker-button-focus-border);box-shadow:var(--ag-focus-shadow);&:where(.invalid){box-shadow:var(--ag-focus-error-shadow)}}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:disabled{opacity:.5}}",d9={tag:"div",cls:"ag-picker-field",role:"presentation",children:[{tag:"div",ref:"eLabel"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-picker-field-wrapper ag-picker-collapsed",children:[{tag:"div",ref:"eDisplayField",cls:"ag-picker-field-display"},{tag:"div",ref:"eIcon",cls:"ag-picker-field-icon",attrs:{"aria-hidden":"true"}}]}]},h9=class extends M_{constructor(e){if(super(e,e?.template||d9,e?.agComponents||[],e?.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.eLabel=tt,this.eWrapper=tt,this.eDisplayField=tt,this.eIcon=tt,this.registerCSS(u9),this.ariaRole=e?.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!e)return;const{pickerGap:t,maxPickerHeight:r,variableWidth:n,minPickerWidth:i,maxPickerWidth:s}=e;t!=null&&(this.pickerGap=t),this.variableWidth=!!n,r!=null&&this.setPickerMaxHeight(r),i!=null&&this.setPickerMinWidth(i),s!=null&&this.setPickerMaxWidth(s)}postConstruct(){super.postConstruct(),this.setupAria();const e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e);const t=this.getAriaElement();this.addManagedElementListeners(t,{keydown:this.onKeyDown.bind(this)}),this.addManagedElementListeners(this.eLabel,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)}),this.addManagedElementListeners(this.eWrapper,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)});const{pickerIcon:r,inputWidth:n}=this.config;if(r){const i=this.beans.iconSvc.createIconNoSpan(r);i&&this.eIcon.appendChild(i)}n!=null&&this.setInputWidth(n)}setupAria(){const e=this.getAriaElement();e.setAttribute("tabindex",this.gos.get("tabIndex").toString()),wb(e,!1),this.ariaRole&&Jl(e,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){const t=this.getFocusableElement();if(t!==this.eWrapper&&e?.target===t)return;e.preventDefault(),this.getFocusableElement().focus()}if(this.skipClick){this.skipClick=!1;return}this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case me.UP:case me.DOWN:case me.ENTER:case me.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case me.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker());break}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());const e=this.pickerComponent.getGui();e.addEventListener("focusin",this.onPickerFocusIn),e.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){const e=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||([this.destroyMouseWheelFunc]=this.addManagedEventListeners({bodyScroll:()=>{this.hidePicker()}}));const t=this.getLocaleTextFunc(),{config:{pickerAriaLabelKey:r,pickerAriaLabelValue:n,modalPicker:i=!0},maxPickerHeight:s,minPickerWidth:o,maxPickerWidth:a,variableWidth:u,beans:d,eWrapper:h}=this,g={modal:i,eChild:e,closeOnEsc:!0,closedCallback:()=>{const C=RM(d);this.beforeHidePicker(),C&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:t(r,n),anchorToElement:h};e.style.position="absolute";const m=d.popupSvc,v=m.addPopup(g);u?(o&&(e.style.minWidth=o),e.style.width=rx(E0(h)),a&&(e.style.maxWidth=a)):F0(e,a??E0(h));const w=s??`${JS(m.getPopupParent())}px`;return e.style.setProperty("max-height",w),this.alignPickerToComponent(),v.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;const{pickerGap:e,config:{pickerType:t},beans:{popupSvc:r,gos:n},eWrapper:i,pickerComponent:s}=this,o=n.get("enableRtl")?"right":"left";r.positionPopupByComponent({type:t,eventSource:i,ePopup:s.getGui(),position:"under",alignSide:o,keepWithinBounds:!0,nudgeY:e})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);const e=this.pickerComponent.getGui();e.removeEventListener("focusin",this.onPickerFocusIn),e.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(e){if(!this.isAlive())return;const t=this.getAriaElement();wb(t,e);const r=this.eWrapper.classList;r.toggle("ag-picker-expanded",e),r.toggle("ag-picker-collapsed",!e)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){this.pickerComponent?.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(e){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",e)}hidePicker(){this.hideCurrentPicker&&(this.hideCurrentPicker(),this.dispatchLocalEvent({type:"pickerHidden"}))}setInputWidth(e){return F0(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}setPickerGap(e){return this.pickerGap=e,this}setPickerMinWidth(e){return typeof e=="number"&&(e=`${e}px`),this.minPickerWidth=e??void 0,this}setPickerMaxWidth(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerWidth=e??void 0,this}setPickerMaxHeight(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerHeight=e??void 0,this}destroy(){this.hidePicker(),super.destroy()}},f9=".ag-select{align-items:center;display:flex;&.ag-disabled{opacity:.5}}:where(.ag-select){.ag-picker-field-wrapper{cursor:default}&.ag-disabled .ag-picker-field-wrapper:focus{box-shadow:none}&:not(.ag-cell-editor,.ag-label-align-top){min-height:var(--ag-list-item-height)}.ag-picker-field-display{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-picker-field-icon{align-items:center;display:flex}}:where(.ag-ltr) :where(.ag-select){.ag-picker-field-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding)/2);padding-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-select){.ag-picker-field-wrapper{padding-left:var(--ag-spacing);padding-right:calc(var(--ag-cell-horizontal-padding)/2)}}.ag-select-list{background-color:var(--ag-picker-list-background-color);border:var(--ag-picker-list-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);overflow:hidden auto}.ag-select-list-item{cursor:default;-webkit-user-select:none;-moz-user-select:none;user-select:none;:where(span){overflow:hidden;text-overflow:ellipsis;white-space:nowrap}}:where(.ag-ltr) .ag-select-list-item{padding-left:calc(var(--ag-cell-horizontal-padding)/2)}:where(.ag-rtl) .ag-select-list-item{padding-right:calc(var(--ag-cell-horizontal-padding)/2)}",vx=class extends h9{constructor(e){super({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"selectOpen",ariaRole:"combobox",...e}),this.registerCSS(f9)}postConstruct(){this.tooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{shouldDisplayTooltip:Jp(()=>this.eDisplayField),getGui:()=>this.getGui()})),super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{options:e,value:t,placeholder:r}=this.config;e!=null&&this.addOptions(e),t!=null&&this.setValue(t,!0),r&&t==null&&(this.eDisplayField.textContent=r),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)})}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){const e=this.createBean(new c9("select"));this.listComponent=e,e.setParentComponent(this);const t=e.getAriaElement(),r=`ag-select-list-${e.getCompId()}`;t.setAttribute("id",r),Oz(this.getAriaElement(),t),e.addManagedElementListeners(e.getGui(),{mousedown:n=>{n?.preventDefault()}}),e.addManagedListeners(e,{selectedItem:()=>{this.hidePicker(),this.dispatchLocalEvent({type:"selectedItem"})},fieldValueChanged:()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())}})}createPickerComponent(){return this.listComponent}beforeHidePicker(){this.listComponent?.hideItemTooltip(),super.beforeHidePicker()}onKeyDown(e){const{key:t}=e;switch(t===me.TAB&&this.hidePicker(),t){case me.ENTER:case me.UP:case me.DOWN:case me.PAGE_UP:case me.PAGE_DOWN:case me.PAGE_HOME:case me.PAGE_END:e.preventDefault(),this.isPickerDisplayed?this.listComponent?.handleKeyDown(e):super.onKeyDown(e);break;case me.ESCAPE:super.onKeyDown(e);break;case me.SPACE:this.isPickerDisplayed?e.preventDefault():super.onKeyDown(e);break}}showPicker(){const e=this.listComponent;e&&(super.showPicker(),e.refreshHighlighted())}addOptions(e){for(const t of e)this.addOption(t);return this}addOption(e){return this.listComponent.addOption(e),this}clearOptions(){return this.listComponent?.clearOptions(),this.setValue(void 0,!0),this}setValue(e,t,r){const{listComponent:n,config:{placeholder:i},eDisplayField:s,tooltipFeature:o}=this;if(this.value===e||!n)return this;if(r||n.setValue(e,!0),n.getValue()===this.getValue())return this;let u=n.getDisplayValue();return u==null&&i&&(u=i),s.textContent=u,o?.setTooltipAndRefresh(u??null),super.setValue(e,t)}destroy(){this.listComponent=this.destroyBean(this.listComponent),super.destroy()}},g9={selector:"AG-SELECT",component:vx},p9=':where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart),:where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]){box-sizing:border-box;&:after,&:before{box-sizing:border-box}&:where(div,span,label):focus-visible{box-shadow:inset var(--ag-focus-shadow);outline:none;&:where(.invalid){box-shadow:inset var(--ag-focus-error-shadow)}}&:where(button){color:inherit}}:where(.ag-root-wrapper,ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]) ::-ms-clear{display:none}.ag-hidden{display:none!important}.ag-invisible{visibility:hidden!important}.ag-popup-child{top:0;z-index:5;&:where(:not(.ag-tooltip-custom)){box-shadow:var(--ag-popup-shadow)}}.ag-input-wrapper,.ag-picker-field-wrapper{align-items:center;display:flex;flex:1 1 auto;line-height:normal;position:relative}.ag-input-field{align-items:center;display:flex;flex-direction:row}.ag-input-field-input:where(:not([type=checkbox],[type=radio])){flex:1 1 auto;min-width:0;width:100%}.ag-chart,.ag-dnd-ghost,.ag-external,.ag-popup,.ag-root-wrapper{cursor:default;line-height:normal;white-space:normal;-webkit-font-smoothing:antialiased;background-color:var(--ag-background-color);color:var(--ag-text-color);color-scheme:var(--ag-browser-color-scheme);font-family:var(--ag-font-family);font-size:var(--ag-font-size);--ag-indentation-level:0}:where(.ag-icon):before{align-items:center;background-color:currentcolor;color:inherit;content:"";display:flex;font-family:inherit;font-size:var(--ag-icon-size);font-style:normal;font-variant:normal;height:var(--ag-icon-size);justify-content:center;line-height:var(--ag-icon-size);-webkit-mask-size:contain;mask-size:contain;text-transform:none;width:var(--ag-icon-size)}.ag-icon{background-position:50%;background-repeat:no-repeat;background-size:contain;color:var(--ag-icon-color);display:block;height:var(--ag-icon-size);position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:var(--ag-icon-size)}.ag-disabled,[disabled]{.ag-icon{opacity:.5}&.ag-icon-grip{opacity:.35}}.ag-resizer{pointer-events:none;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none;z-index:1}:where(.ag-resizer){&.ag-resizer-topLeft{cursor:nwse-resize;height:5px;left:0;top:0;width:5px}&.ag-resizer-top{cursor:ns-resize;height:5px;left:5px;right:5px;top:0}&.ag-resizer-topRight{cursor:nesw-resize;height:5px;right:0;top:0;width:5px}&.ag-resizer-right{bottom:5px;cursor:ew-resize;right:0;top:5px;width:5px}&.ag-resizer-bottomRight{bottom:0;cursor:nwse-resize;height:5px;right:0;width:5px}&.ag-resizer-bottom{bottom:0;cursor:ns-resize;height:5px;left:5px;right:5px}&.ag-resizer-bottomLeft{bottom:0;cursor:nesw-resize;height:5px;left:0;width:5px}&.ag-resizer-left{bottom:5px;cursor:ew-resize;left:0;top:5px;width:5px}}',wx=typeof window!="object"||!window?.document?.fonts?.forEach,ed=(e,t,r,n,i,s)=>{if(wx)return;n&&(e=`@layer ${CSS.escape(n)} { ${e} }`);let o=Iu.map.get(t);if(o||(o=[],Iu.map.set(t,o)),o.some(h=>h.css===e))return;const a=document.createElement("style");s&&a.setAttribute("nonce",s),a.dataset.agGlobalCss=r,a.textContent=e;const u={css:e,el:a,priority:i};let d;for(const h of o){if(h.priority>i)break;d=h}if(d){d.el.insertAdjacentElement("afterend",a);const h=o.indexOf(d);o.splice(h+1,0,u)}else t.insertBefore(a,t.querySelector(":not(title, meta)")),o.push(u)},L_=(e,t,r,n)=>{ed(p9,e,"shared",t,0,r),n?.forEach((i,s)=>i.forEach(o=>ed(o,e,s,t,0,r)))},m9=e=>{Iu.grids.add(e)},v9=e=>{if(Iu.grids.delete(e),Iu.grids.size===0){Iu.map=new WeakMap;for(const t of document.head.querySelectorAll("style[data-ag-global-css]"))t.remove()}},eD,Iu=(eD=typeof window=="object"?window:{}).agStyleInjectionState??(eD.agStyleInjectionState={map:new WeakMap,grids:new Set}),no=e=>new I_(e),Na="$default",w9=0,I_=class{constructor({feature:e,params:t,modeParams:r={},css:n,cssImports:i}){this.feature=e,this.css=n,this.cssImports=i,this.modeParams={[Na]:{...r[Na]??{},...t??{}},...r}}use(e,t,r){let n=this._inject;if(n==null){let{css:i}=this;if(i){const s=`ag-theme-${this.feature??"part"}-${++w9}`;typeof i=="function"&&(i=i()),i=`:where(.${s}) {
${i}
}
`;for(const o of this.cssImports??[])i=`@import url(${JSON.stringify(o)});
${i}`;n={css:i,class:s}}else n=!1;this._inject=n}return n&&e&&ed(n.css,e,n.class,t,1,r),n?n.class:!1}},C9=e=>e.replace(/[A-Z]/g,t=>`-${t}`).toLowerCase(),O_=e=>`--ag-${C9(e)}`,io=e=>`var(${O_(e)})`,y9=(e,t,r)=>Math.max(t,Math.min(r,e)),b9=e=>{const t=new Map;return r=>{const n=r;return t.has(n)||t.set(n,e(r)),t.get(n)}},Us=e=>({ref:"accentColor",mix:e}),qi=e=>({ref:"foregroundColor",mix:e}),es=e=>({ref:"foregroundColor",mix:e,onto:"backgroundColor"}),S9=e=>({ref:"foregroundColor",mix:e,onto:"headerBackgroundColor"}),ii={ref:"backgroundColor"},Su={ref:"foregroundColor"},Io={ref:"accentColor"},H0={backgroundColor:"#fff",foregroundColor:"#181d1f",borderColor:qi(.15),chromeBackgroundColor:es(.02),browserColorScheme:"light"},x9={...H0,textColor:Su,accentColor:"#2196f3",invalidColor:"#e02525",fontFamily:["-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu","Cantarell","Helvetica Neue","sans-serif"],subtleTextColor:{ref:"textColor",mix:.5},borderWidth:1,borderRadius:4,spacing:8,fontSize:14,focusShadow:{spread:3,color:Us(.5)},focusErrorShadow:{spread:3,color:{ref:"invalidColor",onto:"backgroundColor",mix:.5}},popupShadow:"0 0 16px #00000026",cardShadow:"0 1px 4px 1px #00000018",dropdownShadow:{ref:"cardShadow"},listItemHeight:{calc:"max(iconSize, dataFontSize) + widgetVerticalSpacing"},dragAndDropImageBackgroundColor:ii,dragAndDropImageBorder:!0,dragAndDropImageNotAllowedBorder:{color:{ref:"invalidColor",onto:"dragAndDropImageBackgroundColor",mix:.5}},dragAndDropImageShadow:{ref:"popupShadow"},iconSize:16,iconColor:"inherit",toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonOnBackgroundColor:Io,toggleButtonOffBackgroundColor:es(.3),toggleButtonSwitchBackgroundColor:ii,toggleButtonSwitchInset:2,tooltipBackgroundColor:{ref:"chromeBackgroundColor"},tooltipErrorBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.1},tooltipTextColor:{ref:"textColor"},tooltipErrorTextColor:{ref:"invalidColor"},tooltipBorder:!0,tooltipErrorBorder:{color:{ref:"invalidColor",onto:"backgroundColor",mix:.25}}},E9=["colorScheme","color","length","scale","borderStyle","border","shadow","image","fontFamily","fontWeight","duration"],R9=b9(e=>(e=e.toLowerCase(),E9.find(t=>e.endsWith(t.toLowerCase()))??"length")),Km=e=>typeof e=="object"&&e?.ref?io(e.ref):typeof e=="string"?e:typeof e=="number"?String(e):!1,Cx=e=>{if(typeof e=="string")return e;if(e&&"ref"in e){const t=io(e.ref);return e.mix==null?t:`color-mix(in srgb, ${e.onto?io(e.onto):"transparent"}, ${t} ${y9(e.mix*100,0,100)}%)`}return!1},T9=Km,xu=e=>typeof e=="string"?e:typeof e=="number"?`${e}px`:e&&"calc"in e?`calc(${e.calc.replace(/ ?[*/+] ?/g," $& ").replace(/-?\b[a-z][a-z0-9]*\b(?![-(])/gi,r=>r[0]==="-"?r:" "+io(r)+" ")})`:e&&"ref"in e?io(e.ref):!1,F9=Km,Mb=(e,t)=>typeof e=="string"?e:e===!0?Mb({},t):e===!1?t==="columnBorder"?Mb({color:"transparent"},t):"none":e&&"ref"in e?io(e.ref):N_(e.style??"solid")+" "+xu(e.width??{ref:"borderWidth"})+" "+Cx(e.color??{ref:"borderColor"}),D9=e=>typeof e=="string"?e:e===!1?"none":e&&"ref"in e?io(e.ref):[xu(e.offsetX??0),xu(e.offsetY??0),xu(e.radius??0),xu(e.spread??0),Cx(e.color??{ref:"foregroundColor"})].join(" "),N_=Km,B_=e=>typeof e=="string"?e.includes(",")?e:tD(e):e&&"googleFont"in e?B_(e.googleFont):e&&"ref"in e?io(e.ref):Array.isArray(e)?e.map(t=>(typeof t=="object"&&"googleFont"in t&&(t=t.googleFont),tD(t))).join(", "):!1,tD=e=>/^[\w-]+$|\w\(/.test(e)?e:JSON.stringify(e),A9=Km,H_=e=>typeof e=="string"?e:e&&"url"in e?`url(${JSON.stringify(e.url)})`:e&&"svg"in e?H_({url:`data:image/svg+xml,${encodeURIComponent(e.svg)}`}):e&&"ref"in e?io(e.ref):!1,k9=(e,t,r)=>typeof e=="string"?e:typeof e=="number"?(e>=10&&r.warn(104,{value:e,param:t}),`${e}s`):e&&"ref"in e?io(e.ref):!1,P9={color:Cx,colorScheme:T9,length:xu,scale:F9,border:Mb,borderStyle:N_,shadow:D9,image:H_,fontFamily:B_,fontWeight:A9,duration:k9},M9=(e,t,r)=>{const n=R9(e);return P9[n](t,e,r)},_9=e=>new G_(e),G_=class V_{constructor(t,r=[]){this.themeLogger=t,this.parts=r}withPart(t){return typeof t=="function"&&(t=t()),t instanceof I_?new V_(this.themeLogger,[...this.parts,t]):(this.themeLogger.preInitErr(259,"Invalid part",{part:t}),this)}withoutPart(t){return this.withPart(no({feature:t}))}withParams(t,r=Na){return this.withPart(no({modeParams:{[r]:t}}))}_startUse({styleContainer:t,cssLayer:r,nonce:n,loadThemeGoogleFonts:i,moduleCss:s}){if(wx)return;I9(),L_(t,r,n,s);const o=L9(this);if(o.length>0)for(const a of o)i&&O9(a,n);for(const a of this.parts)a.use(t,r,n)}_getCssClass(){return this._cssClassCache??(this._cssClassCache=rD(this.parts).map(t=>t.use(void 0,void 0,void 0)).filter(Boolean).join(" "))}_getModeParams(){let t=this._paramsCache;if(!t){const r={[Na]:{...x9}};for(const n of rD(this.parts))for(const i of Object.keys(n.modeParams)){const s=n.modeParams[i];if(s){const o=r[i]??(r[i]={}),a=new Set;for(const u of Object.keys(s)){const d=s[u];d!==void 0&&(o[u]=d,a.add(u))}if(i===Na)for(const u of Object.keys(r)){const d=r[u];if(u!==Na)for(const h of a)delete d[h]}}}this._paramsCache=t=r}return t}_getPerInstanceCss(t){const r="##SELECTOR##";let n=this._paramsCssCache;if(!n){let i="",s="";const o=this._getModeParams();for(const u of Object.keys(o)){const d=o[u];if(u!==Na){const g=`:where([data-ag-theme-mode="${typeof CSS=="object"?CSS.escape(u):u}"]) & {
`;i+=g,s+=g}for(const h of Object.keys(d).sort()){const g=d[h],m=M9(h,g,this.themeLogger);if(m===!1)this.themeLogger.error(107,{key:h,value:g});else{const v=O_(h),w=v.replace("--ag-","--ag-inherited-");i+=`	${v}: var(${w}, ${m});
`,s+=`	${w}: var(${v});
`}}u!==Na&&(i+=`}
`,s+=`}
`)}let a=`${r} {
${i}}
`;a+=`:has(> ${r}):not(${r}) {
${s}}
`,this._paramsCssCache=n=a}return n.replaceAll(r,`:where(.${t})`)}},rD=e=>{const t=new Map;for(const n of e)t.set(n.feature,n);const r=[];for(const n of e)(!n.feature||t.get(n.feature)===n)&&r.push(n);return r},L9=e=>{const t=new Set,r=s=>{if(Array.isArray(s))s.forEach(r);else{const o=s?.googleFont;typeof o=="string"&&t.add(o)}};return Object.values(e._getModeParams()).flatMap(s=>Object.values(s)).forEach(r),Array.from(t).sort()},nD=!1,I9=()=>{if(!nD){nD=!0;for(const e of Array.from(document.head.querySelectorAll('style[data-ag-scope="legacy"]')))e.remove()}},O9=async(e,t)=>{const r=`@import url('https://${N9}/css2?family=${encodeURIComponent(e)}:wght@100;200;300;400;500;600;700;800;900&display=swap');
`;ed(r,document.head,`googleFont:${e}`,void 0,0,t)},N9="fonts.googleapis.com",B9=1,H9=class{constructor(e){this.beans={},this.createdBeans=[],this.destroyed=!1,this.instanceId=B9++,e?.beanClasses&&(this.beanDestroyComparator=e.beanDestroyComparator,this.init(e))}init(e){this.id=e.id,this.beans.context=this,this.destroyCallback=e.destroyCallback;for(const t of Object.keys(e.providedBeanInstances))this.beans[t]=e.providedBeanInstances[t];for(const t of e.beanClasses){const r=new t;r.beanName?this.beans[r.beanName]=r:console.error(`Bean ${t.name} is missing beanName`),this.createdBeans.push(r)}for(const t of e.derivedBeans??[]){const{beanName:r,bean:n}=t(this);this.beans[r]=n,this.createdBeans.push(n)}e.beanInitComparator&&this.createdBeans.sort(e.beanInitComparator),this.initBeans(this.createdBeans)}getBeanInstances(){return Object.values(this.beans)}createBean(e,t){return this.initBeans([e],t),e}initBeans(e,t){const r=this.beans;for(const n of e)n.preWireBeans?.(r),n.wireBeans?.(r);for(const n of e)n.preConstruct?.();t&&e.forEach(t);for(const n of e)n.postConstruct?.()}getBeans(){return this.beans}getBean(e){return this.beans[e]}getId(){return this.id}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this.getBeanInstances();this.beanDestroyComparator&&e.sort(this.beanDestroyComparator),this.destroyBeans(e),this.beans={},this.createdBeans=[],this.destroyCallback?.()}destroyBean(e){e?.destroy?.()}destroyBeans(e){if(e)for(let t=0;t<e.length;t++)this.destroyBean(e[t]);return[]}isDestroyed(){return this.destroyed}},G9=0,V9=class extends ao{constructor(){super(...arguments),this.beanName="environment",this.paramsClass=`ag-theme-params-${++G9}`,this.globalCSS=[]}wireBeans(e){this.eRootDiv=e.eRootDiv}postConstruct(){const{gos:e,eRootDiv:t}=this;e.setInstanceDomData(t),this.eStyleContainer=e.get("themeStyleContainer")??(t.getRootNode()===document?document.head:t),this.cssLayer=e.get("themeCssLayer"),this.styleNonce=e.get("styleNonce"),this.addManagedPropertyListener("theme",()=>this.handleThemeChange()),this.handleThemeChange(),this.initVariables(),this.addDestroyFunc(()=>v9(this)),this.mutationObserver=new MutationObserver(()=>{this.fireStylesChangedEvent("themeChanged")}),this.addDestroyFunc(()=>this.mutationObserver.disconnect())}applyThemeClasses(e,t=[]){const{theme:r}=this;let n;r?n=`${this.paramsClass} ${r._getCssClass()}`:n=this.applyLegacyThemeClasses();for(const i of Array.from(e.classList))i.startsWith("ag-theme-")&&e.classList.remove(i);if(n){const i=e.className;e.className=`${i}${i?" ":""}${n}${t?.length?" "+t.join(" "):""}`}}applyLegacyThemeClasses(){let e="";this.mutationObserver.disconnect();let t=this.eRootDiv;for(;t;){let r=!1;for(const n of Array.from(t.classList))n.startsWith("ag-theme-")&&(r=!0,e=e?`${e} ${n}`:n);r&&this.mutationObserver.observe(t,{attributes:!0,attributeFilter:["class"]}),t=t.parentElement}return e}addGlobalCSS(e,t){this.theme?ed(e,this.eStyleContainer,t,this.cssLayer,0,this.styleNonce):this.globalCSS.push([e,t])}handleThemeChange(){const{gos:e,theme:t}=this,r=e.get("theme");let n;if(r==="legacy")n=void 0;else{const i=r??this.getDefaultTheme();i instanceof G_?n=i:this.themeError(i)}n!==t&&this.handleNewTheme(n),this.postProcessThemeChange(n,r)}handleNewTheme(e){const{gos:t,eRootDiv:r,globalCSS:n}=this,i=this.getAdditionalCss();if(e){m9(this),L_(this.eStyleContainer,this.cssLayer,this.styleNonce,i);for(const[o,a]of n)ed(o,this.eStyleContainer,a,this.cssLayer,0,this.styleNonce);n.length=0}this.theme=e,e?._startUse({loadThemeGoogleFonts:t.get("loadThemeGoogleFonts"),styleContainer:this.eStyleContainer,cssLayer:this.cssLayer,nonce:this.styleNonce,moduleCss:i});let s=this.eParamsStyle;if(!s){s=this.eParamsStyle=Hf({tag:"style"});const o=t.get("styleNonce");o&&s.setAttribute("nonce",o),r.appendChild(s)}wx||(s.textContent=e?._getPerInstanceCss(this.paramsClass)||""),this.applyThemeClasses(r),this.fireStylesChangedEvent("themeChanged")}},z9=class extends ao{constructor(){super(...arguments),this.beanName="registry"}registerDynamicBeans(e){if(e){this.dynamicBeans??(this.dynamicBeans={});for(const t of Object.keys(e))this.dynamicBeans[t]=e[t]}}createDynamicBean(e,t,...r){if(!this.dynamicBeans)throw new Error(this.getDynamicError(e,!0));const n=this.dynamicBeans[e];if(n==null){if(t)throw new Error(this.getDynamicError(e,!1));return}return new n(...r)}},W9=class extends ao{constructor(){super(...arguments),this.beanName="eventSvc",this.eventServiceType="global",this.globalSvc=new Zl}addListener(e,t,r){this.globalSvc.addEventListener(e,t,r)}removeListener(e,t,r){this.globalSvc.removeEventListener(e,t,r)}addGlobalListener(e,t=!1){this.globalSvc.addGlobalListener(e,t)}removeGlobalListener(e,t=!1){this.globalSvc.removeGlobalListener(e,t)}dispatchEvent(e){this.globalSvc.dispatchEvent(this.gos.addCommon(e))}dispatchEventOnce(e){this.globalSvc.dispatchEventOnce(this.gos.addCommon(e))}},z_=class extends ao{constructor(e,t){super(),this.ctrl=e,t&&(this.beans=t)}postConstruct(){this.refreshTooltip()}setBrowserTooltip(e,t){const r="title",n=this.ctrl.getGui();n&&(e!=null&&(e!=""||t)?n.setAttribute(r,e):n.removeAttribute(r))}updateTooltipText(){const{getTooltipValue:e}=this.ctrl;e&&(this.tooltip=e())}createTooltipFeatureIfNeeded(){if(this.tooltipManager==null){const e=this.beans.registry.createDynamicBean("tooltipStateManager",!0,this.ctrl,()=>this.tooltip);e&&(this.tooltipManager=this.createBean(e,this.beans.context))}}attemptToShowTooltip(){this.tooltipManager?.prepareToShowTooltip()}attemptToHideTooltip(){this.tooltipManager?.hideTooltip()}setTooltipAndRefresh(e){this.tooltip=e,this.refreshTooltip()}refreshTooltip(e){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)):(this.setBrowserTooltip(e?"":null,e),this.createTooltipFeatureIfNeeded())}destroy(){this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context),super.destroy()}},U9=1e3,$9=1e3,iD=100,sD,Tp=!1,j9=class extends ao{constructor(e,t){super(),this.tooltipCtrl=e,this.getTooltipValue=t,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}wireBeans(e){this.popupSvc=e.popupSvc}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");const e=this.tooltipCtrl.getGui();this.tooltipTrigger===0&&this.addManagedListeners(e,{mouseenter:this.onMouseEnter.bind(this),mouseleave:this.onMouseLeave.bind(this)}),this.tooltipTrigger===1&&this.addManagedListeners(e,{focusin:this.onFocusIn.bind(this),focusout:this.onFocusOut.bind(this)}),this.addManagedListeners(e,{mousemove:this.onMouseMove.bind(this)}),this.interactionEnabled||this.addManagedListeners(e,{mousedown:this.onMouseDown.bind(this),keydown:this.onKeyDown.bind(this)})}getGridOptionsTooltipDelay(e){const t=this.gos.get(e);return Math.max(200,t)}getTooltipDelay(e){return e==="show"?this.tooltipCtrl.getTooltipShowDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipShowDelay"):this.tooltipCtrl.getTooltipHideDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){const e=this.gos.get("tooltipTrigger");return!e||e==="hover"?0:1}onMouseEnter(e){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),!Wl()&&(Tp?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(e)},iD):this.prepareToShowTooltip(e))}onMouseMove(e){this.lastMouseEvent&&(this.lastMouseEvent=e),this.tooltipMouseTrack&&this.state===2&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(e){const t=e.relatedTarget,r=this.tooltipCtrl.getGui(),n=this.tooltipComp?.getGui();this.isInteractingWithTooltip||r.contains(t)||this.interactionEnabled&&n?.contains(t)||this.setToDoNothing()}onKeyDown(){this.isInteractingWithTooltip&&(this.isInteractingWithTooltip=!1),this.setToDoNothing()}prepareToShowTooltip(e){if(this.state!=0||Tp)return;let t=0;e&&(t=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=e||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),t),this.state=1}isLastTooltipHiddenRecently(){return Date.now()-sD<U9}setToDoNothing(e){!e&&this.state===2&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.clearEventHandlers(),this.onDocumentKeyDownCallback&&(this.onDocumentKeyDownCallback(),this.onDocumentKeyDownCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){const e=this.getTooltipValue(),t=this.tooltipCtrl;if(!$e(e)||t.shouldDisplayTooltip&&!t.shouldDisplayTooltip()){this.setToDoNothing();return}const r=this.gos.addCommon({location:t.getLocation?.()??"UNKNOWN",value:e,hideTooltipCallback:()=>this.hideTooltip(!0),...t.getAdditionalParams?.()});this.state=2,this.tooltipInstanceCount++;const n=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.createTooltipComp(r,n)}hideTooltip(e){!e&&this.isInteractingWithTooltip||(this.tooltipComp&&(this.destroyTooltipComp(),sD=Date.now()),this.eventSvc.dispatchEvent({type:"tooltipHide",parentGui:this.tooltipCtrl.getGui()}),e&&(this.isInteractingWithTooltip=!1),this.setToDoNothing(!0))}newTooltipComponentCallback(e,t){if(this.state!==2||this.tooltipInstanceCount!==e){this.destroyBean(t);return}const n=t.getGui();this.tooltipComp=t,n.classList.contains("ag-tooltip")||n.classList.add("ag-tooltip-custom"),this.tooltipTrigger===0&&n.classList.add("ag-tooltip-animate"),this.interactionEnabled&&n.classList.add("ag-tooltip-interactive");const i=this.getLocaleTextFunc(),s=this.popupSvc?.addPopup({eChild:n,ariaLabel:i("ariaLabelTooltip","Tooltip")});if(s&&(this.tooltipPopupDestroyFunc=s.hideFunc),this.positionTooltip(),this.tooltipTrigger===1){const o=()=>this.setToDoNothing();[this.onBodyScrollEventCallback]=this.addManagedEventListeners({bodyScroll:o}),this.setEventHandlers(o)}this.interactionEnabled&&([this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener]=this.addManagedElementListeners(n,{mouseenter:this.onTooltipMouseEnter.bind(this),mouseleave:this.onTooltipMouseLeave.bind(this)}),[this.onDocumentKeyDownCallback]=this.addManagedElementListeners(un(this.beans),{keydown:o=>{n.contains(o?.target)||this.onKeyDown()}}),this.tooltipTrigger===1&&([this.tooltipFocusInListener,this.tooltipFocusOutListener]=this.addManagedElementListeners(n,{focusin:this.onTooltipFocusIn.bind(this),focusout:this.onTooltipFocusOut.bind(this)}))),this.eventSvc.dispatchEvent({type:"tooltipShow",tooltipGui:n,parentGui:this.tooltipCtrl.getGui()}),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,this.lockService())}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}isTooltipFocused(){const e=this.tooltipComp?.getGui(),t=Fr(this.beans);return!!e&&e.contains(t)}onTooltipFocusOut(e){const t=this.tooltipCtrl.getGui();this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,t.contains(e.relatedTarget)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){const e={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupSvc?.positionPopupUnderMouseEvent({...e,mouseEvent:this.lastMouseEvent}):this.popupSvc?.positionPopupByComponent({...e,eventSource:this.tooltipCtrl.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5})}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");const e=this.tooltipPopupDestroyFunc,t=this.tooltipComp,r=this.tooltipTrigger===0?$9:0;window.setTimeout(()=>{e(),this.destroyBean(t)},r),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){for(const e of[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener])e&&e();this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){Tp=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},iD)}unlockService(){Tp=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}},Y9=class extends z_{constructor(e,t,r){super(e,r),this.highlightTracker=t,this.onHighlight=this.onHighlight.bind(this)}postConstruct(){super.postConstruct(),this.wireHighlightListeners()}wireHighlightListeners(){this.addManagedPropertyListener("tooltipTrigger",({currentValue:e})=>{this.setTooltipMode(e)}),this.setTooltipMode(this.gos.get("tooltipTrigger")),this.highlightTracker.addEventListener("itemHighlighted",this.onHighlight)}onHighlight(e){this.tooltipMode===1&&(e.highlighted?this.attemptToShowTooltip():this.attemptToHideTooltip())}setTooltipMode(e="focus"){this.tooltipMode=e==="focus"?1:0}destroy(){this.highlightTracker.removeEventListener("itemHighlighted",this.onHighlight),super.destroy()}},Fp=0,K9=200,q9=class extends ao{constructor(){super(...arguments),this.beanName="popupSvc",this.popupList=[]}getPopupParent(){const e=this.gos.get("popupParent");return e||this.getDefaultPopupParent()}positionPopupUnderMouseEvent(e){const{ePopup:t,nudgeX:r,nudgeY:n,skipObserver:i}=e;this.positionPopup({ePopup:t,nudgeX:r,nudgeY:n,keepWithinBounds:!0,skipObserver:i,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e,e.type,e.ePopup,null,e.mouseEvent)})}calculatePointerAlign(e){const t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(e){const{ePopup:t,nudgeX:r,nudgeY:n,keepWithinBounds:i,eventSource:s,alignSide:o="left",position:a="over",type:u}=e,d=s.getBoundingClientRect(),h=this.getParentRect();this.setAlignedTo(s,t);const g=()=>{let m=d.left-h.left;o==="right"&&(m-=t.offsetWidth-d.width);let v;return a==="over"?(v=d.top-h.top,this.setAlignedStyles(t,"over")):(this.setAlignedStyles(t,"under"),this.shouldRenderUnderOrAbove(t,d,h,e.nudgeY||0)==="under"?v=d.top-h.top+d.height:v=d.top-t.offsetHeight-(n||0)*2-h.top),{x:m,y:v}};this.positionPopup({ePopup:t,nudgeX:r,nudgeY:n,keepWithinBounds:i,updatePosition:g,postProcessCallback:()=>this.callPostProcessPopup(e,u,t,s,null)})}shouldRenderUnderOrAbove(e,t,r,n){const i=r.bottom-t.bottom,s=t.top-r.top,o=e.offsetHeight+n;return i>o?"under":s>o||s>i?"above":"under"}setAlignedStyles(e,t){const r=this.getPopupIndex(e);if(r===-1)return;const n=this.popupList[r],{alignedToElement:i}=n;if(!i)return;const s=["right","left","over","above","under"];for(const o of s)i.classList.remove(`ag-has-popup-positioned-${o}`),e.classList.remove(`ag-popup-positioned-${o}`);t&&(i.classList.add(`ag-has-popup-positioned-${t}`),e.classList.add(`ag-popup-positioned-${t}`))}setAlignedTo(e,t){const r=this.getPopupIndex(t);if(r!==-1){const n=this.popupList[r];n.alignedToElement=e}}positionPopup(e){const{ePopup:t,keepWithinBounds:r,nudgeX:n,nudgeY:i,skipObserver:s,updatePosition:o}=e,a={width:0,height:0},u=(d=!1)=>{let{x:h,y:g}=o();d&&t.clientWidth===a.width&&t.clientHeight===a.height||(a.width=t.clientWidth,a.height=t.clientHeight,n&&(h+=n),i&&(g+=i),r&&(h=this.keepXYWithinBounds(t,h,1),g=this.keepXYWithinBounds(t,g,0)),t.style.left=`${h}px`,t.style.top=`${g}px`,e.postProcessCallback&&e.postProcessCallback())};if(u(),!s){const d=Zo(this.beans,t,()=>u(!0));setTimeout(()=>d(),K9)}}getParentRect(){const e=un(this.beans);let t=this.getPopupParent();return t===e.body?t=e.documentElement:getComputedStyle(t).position==="static"&&(t=t.offsetParent),OM(t)}keepXYWithinBounds(e,t,r){const n=r===0,i=n?"clientHeight":"clientWidth",s=n?"top":"left",o=n?"height":"width",a=n?"scrollTop":"scrollLeft",u=un(this.beans),d=u.documentElement,h=this.getPopupParent(),g=e.getBoundingClientRect(),m=h.getBoundingClientRect(),v=u.documentElement.getBoundingClientRect(),w=h===u.body,C=Math.ceil(g[o]);let x=w?(n?IM:E0)(d)+d[a]:h[i];w&&(x-=Math.abs(v[s]-m[s]));const R=x-C;return Math.min(Math.max(t,0),Math.max(R,0))}addPopup(e){const{eChild:t,ariaLabel:r,ariaOwns:n,alwaysOnTop:i,positionCallback:s,anchorToElement:o}=e,a=this.getPopupIndex(t);if(a!==-1)return{hideFunc:this.popupList[a].hideFunc};this.initialisePopupPosition(t);const u=this.createPopupWrapper(t,!!i,r,n),d=this.addEventListenersToPopup({...e,wrapperEl:u});return s&&s(),this.addPopupToPopupList(t,u,d,o),{hideFunc:d}}initialisePopupPosition(e){const r=this.getPopupParent().getBoundingClientRect();$e(e.style.top)||(e.style.top=`${r.top*-1}px`),$e(e.style.left)||(e.style.left=`${r.left*-1}px`)}createPopupWrapper(e,t,r,n){const i=this.getPopupParent(),{environment:s,gos:o}=this.beans,a=Hf({tag:"div"});return s.applyThemeClasses(a),a.classList.add("ag-popup"),e.classList.add(o.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||Jl(e,"dialog"),r?Qu(e,r):n&&(e.id||(e.id=`popup-component-${Fp}`),BF(n,e.id)),a.appendChild(e),i.appendChild(a),t?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),a}addEventListenersToPopup(e){const t=this.beans,r=un(t),{wrapperEl:n,eChild:i,closedCallback:s,afterGuiAttached:o,closeOnEsc:a,modal:u,ariaOwns:d}=e;let h=!1;const g=C=>{if(!n.contains(Fr(t)))return;C.key===me.ESCAPE&&!this.isStopPropagation(C)&&w({keyboardEvent:C})},m=C=>w({mouseEvent:C}),v=C=>w({touchEvent:C}),w=(C={})=>{const{mouseEvent:b,touchEvent:x,keyboardEvent:R,forceHide:E}=C;!E&&(this.isEventFromCurrentPopup({mouseEvent:b,touchEvent:x},i)||h)||(h=!0,n.remove(),r.removeEventListener("keydown",g),r.removeEventListener("mousedown",m),r.removeEventListener("touchstart",v),r.removeEventListener("contextmenu",m),this.eventSvc.removeListener("dragStarted",m),s&&s(b||x||R),this.removePopupFromPopupList(i,d))};return o&&o({hidePopup:w}),window.setTimeout(()=>{a&&r.addEventListener("keydown",g),u&&(r.addEventListener("mousedown",m),this.eventSvc.addListener("dragStarted",m),r.addEventListener("touchstart",v),r.addEventListener("contextmenu",m))},0),w}addPopupToPopupList(e,t,r,n){this.popupList.push({element:e,wrapper:t,hideFunc:r,instanceId:Fp,isAnchored:!!n}),n&&this.setPopupPositionRelatedToElement(e,n),Fp=Fp+1}getPopupIndex(e){return this.popupList.findIndex(t=>t.element===e)}setPopupPositionRelatedToElement(e,t){const r=this.getPopupIndex(e);if(r===-1)return;const n=this.popupList[r];if(n.stopAnchoringPromise&&n.stopAnchoringPromise.then(s=>s&&s()),n.stopAnchoringPromise=void 0,n.isAnchored=!1,!t)return;const i=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:n.hideFunc});return n.stopAnchoringPromise=i,n.isAnchored=!0,i}removePopupFromPopupList(e,t){this.setAlignedStyles(e,null),this.setPopupPositionRelatedToElement(e,null),t&&BF(t,null),this.popupList=this.popupList.filter(r=>r.element!==e)}keepPopupPositionedRelativeTo(e){const t=this.getPopupParent(),r=t.getBoundingClientRect(),{element:n,ePopup:i}=e,s=n.getBoundingClientRect(),o=g=>Number.parseInt(g.substring(0,g.length-1),10),a=(g,m)=>{const v=r[g]-s[g],w=o(i.style[g]);return{initialDiff:v,lastDiff:v,initial:w,last:w,direction:m}},u=a("top",0),d=a("left",1),h=this.beans.frameworkOverrides;return new Nt(g=>{h.wrapIncoming(()=>{sW(()=>{const m=t.getBoundingClientRect(),v=n.getBoundingClientRect();if(v.top==0&&v.left==0&&v.height==0&&v.width==0){e.hidePopup();return}const C=(b,x)=>{const R=o(i.style[x]);b.last!==R&&(b.initial=R,b.last=R);const E=m[x]-v[x];if(E!=b.lastDiff){const A=this.keepXYWithinBounds(i,b.initial+b.initialDiff-E,b.direction);i.style[x]=`${A}px`,b.last=A}b.lastDiff=E};C(u,"top"),C(d,"left")},200).then(m=>{g(()=>{m!=null&&window.clearInterval(m)})})},"popupPositioning")})}isEventFromCurrentPopup(e,t){const{mouseEvent:r,touchEvent:n}=e,i=r||n;if(!i)return!1;const s=this.getPopupIndex(t);if(s===-1)return!1;for(let o=s;o<this.popupList.length;o++){const a=this.popupList[o];if(Vz(a.element,i))return!0}return this.isElementWithinCustomPopup(i.target)}isElementWithinCustomPopup(e){const t=un(this.beans);for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||e.parentElement===null)return!0;e=e.parentElement}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){const r=this.getWrapper(e);r&&(r.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(r))}bringPopupToFront(e){const t=this.getPopupParent(),r=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),n=r.length,i=this.getWrapper(e);if(!i||n<=1||!t.contains(e))return;const s=[],o=[];for(const m of r)m!==i&&(m.classList.contains("ag-always-on-top")?o.push(m):s.push(m));const a=[],u=o.length,g=i.classList.contains("ag-always-on-top")||!u?[...s,...o,i]:[...s,i,...o];for(let m=0;m<=n;m++){const v=g[m];if(r[m]===g[m]||v===i)continue;const w=v.querySelectorAll("div");for(const C of w)C.scrollTop!==0&&a.push([C,C.scrollTop]);m===0?t.insertAdjacentElement("afterbegin",v):g[m-1].insertAdjacentElement("afterend",v)}for(;a.length;){const m=a.pop();m[0].scrollTop=m[1]}}},X9=class extends hx{constructor(){super({tag:"div",cls:"ag-tooltip"})}init(e){const{value:t}=e,r=this.getGui();r.textContent=md(t);const n=e.location.replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase();r.classList.add(`ag-${n}-tooltip`)}},W_=(e,t)=>{if(t!=null&&e?.setPointerCapture)try{return e.setPointerCapture(t),e.hasPointerCapture(t)}catch{}return!1},Q9=(e,t)=>{if(typeof PointerEvent>"u"||!(t instanceof PointerEvent))return null;const r=t.pointerId;if(!W_(e,r))return null;const n={eElement:e,pointerId:r,onLost(i){J9(n,i)}};return e.addEventListener("lostpointercapture",n.onLost),n},Z9=e=>{if(!e)return;U_(e);const{eElement:t,pointerId:r}=e;if(t){try{t.releasePointerCapture(r)}catch{}e.eElement=null}},U_=e=>{const{eElement:t,onLost:r}=e;t&&r&&(t.removeEventListener("lostpointercapture",r),e.onLost=null)},J9=(e,t)=>{U_(e);const{eElement:r,pointerId:n}=e;r&&t.pointerId===n&&W_(r,n)},fu,Eu,Mo=e=>{if(!Eu)Eu=new WeakSet;else if(Eu.has(e))return!1;return Eu.add(e),!0},eU=class extends ao{constructor(){super(...arguments),this.beanName="dragSvc",this.dragging=!1,this.drag=null,this.dragSources=[]}get startTarget(){return this.drag?.start.target??null}isPointer(){return!!fu?.has(Ws(this.beans))}hasPointerCapture(){const e=this.drag?.pointerCapture;return!!(e&&this.beans.eRootDiv.hasPointerCapture?.(e.pointerId))}destroy(){this.drag&&this.cancelDrag();const e=this.dragSources;for(const t of e)oD(t);e.length=0,super.destroy()}removeDragSource(e){const t=this.dragSources;for(let r=0,n=t.length;r<n;++r){const i=t[r];if(i.params===e){t.splice(r,1),oD(i);break}}}addDragSource(e){if(!this.isAlive())return;const{eElement:t,includeTouch:r}=e,n=[];let i;if(r){const d=t.style;d&&(i=d.touchAction,d.touchAction="none")}const s={handlers:n,params:e,oldTouchAction:i};this.dragSources.push(s),e0(n,[t,"pointerdown",d=>this.onPointerDown(e,d),{passive:!1}],[t,"mousedown",d=>this.onMouseDown(e,d)]);const u=this.gos.get("suppressTouch");r&&!u&&e0(n,[t,"touchstart",h=>this.onTouchStart(e,h),{passive:!1}])}cancelDrag(e){const t=this.drag;e??(e=t?.eElement),e&&this.eventSvc.dispatchEvent({type:"dragCancelled",target:e}),t?.params.onDragCancel?.(),this.destroyDrag()}shouldPreventMouseEvent(e){const t=e.type;return(t==="mousemove"||t==="pointermove")&&e.cancelable&&cf(this.beans,e)&&!Ih(gy(e))}initDrag(e,...t){this.drag=e;const r=this.beans,n=a=>this.onScroll(a),i=a=>this.onKeyDown(a),s=Ws(r),o=un(r);e0(e.handlers,[s,"contextmenu",Oa],[s,"keydown",i],[o,"scroll",n,{capture:!0}],[o.defaultView||window,"scroll",n],...t)}destroyDrag(){this.dragging=!1;const e=this.drag;if(e){const t=e.rootEl;fu?.get(t)===e&&fu?.delete(t),this.drag=null,Z9(e.pointerCapture),ix(e.handlers)}}onPointerDown(e,t){if(this.isPointer())return;const r=this.beans;if(Eu?.has(t))return;const n=t.pointerType;if(n==="touch"&&(r.gos.get("suppressTouch")||!e.includeTouch||(e.stopPropagationForTouch&&t.stopPropagation(),Ih(gy(t))))||!t.isPrimary||n==="mouse"&&t.button!==0)return;this.destroyDrag();const i=Ws(r),s=e.eElement,o=t.pointerId,a=new fy(i,e,t,o);fu??(fu=new WeakMap),fu.set(i,a);const u=g=>{g.pointerId===o&&this.onMouseOrPointerMove(g)},d=g=>{g.pointerId===o&&this.onMouseOrPointerUp(g)},h=g=>{g.pointerId===o&&Mo(g)&&this.cancelDrag()};this.initDrag(a,[i,"pointerup",d],[i,"pointercancel",h],[i,"pointermove",u,{passive:!1}],[i,"touchmove",Oa,{passive:!1}],[s,"mousemove",Oa,{passive:!1}]),e.dragStartPixels===0?this.onMouseOrPointerMove(t):Mo(t)}onTouchStart(e,t){if(this.gos.get("suppressTouch")||!e.includeTouch||!Mo(t)||Ih(gy(t)))return;if(e.stopPropagationForTouch&&t.stopPropagation(),this.isPointer()){Oa(t);return}this.destroyDrag();const n=this.beans,i=Ws(n),s=new fy(i,e,t.touches[0]),o=d=>this.onTouchMove(d),a=d=>this.onTouchUp(d),u=t.target??e.eElement;this.initDrag(s,[Ws(n),"touchmove",Oa,{passive:!1}],[u,"touchmove",o,{passive:!0}],[u,"touchend",a,{passive:!0}],[u,"touchcancel",a,{passive:!0}]),e.dragStartPixels===0&&this.onMove(s.start)}onMouseDown(e,t){if(t.button!==0||Eu?.has(t)||this.isPointer())return;const r=this.beans;this.destroyDrag();const n=new fy(Ws(r),e,t),i=a=>this.onMouseOrPointerMove(a),s=a=>this.onMouseOrPointerUp(a),o=Ws(r);this.initDrag(n,[o,"mousemove",i],[o,"mouseup",s]),e.dragStartPixels===0?this.onMouseOrPointerMove(t):Mo(t)}onScroll(e){if(!Mo(e))return;const t=this.drag,r=t?.lastDrag;r&&this.dragging&&t.params?.onDragging(r)}onMouseOrPointerMove(e){Mo(e)&&(rl()&&un(this.beans).getSelection()?.removeAllRanges(),this.shouldPreventMouseEvent(e)&&Oa(e),this.onMove(e))}onTouchMove(e){const t=this.drag;if(!t||!Mo(e))return;const r=Nh(t.start,e.touches);r&&(e.preventDefault(),this.onMove(r))}onMove(e){const t=this.drag;if(!t)return;t.lastDrag=e;const r=t.params;if(!this.dragging){const n=t.start,s=r.dragStartPixels??4;if(VM(e,n,s)||(this.dragging=!0,r.capturePointer&&(t.pointerCapture=Q9(this.beans.eRootDiv,e)),this.eventSvc.dispatchEvent({type:"dragStarted",target:r.eElement}),r.onDragStart(n),this.drag!==t)||(r.onDragging(n),this.drag!==t))return}r.onDragging(e)}onTouchUp(e){const t=this.drag;t&&Mo(e)&&this.onUp(Nh(t.start,e.changedTouches))}onMouseOrPointerUp(e){Mo(e)&&this.onUp(e)}onUp(e){const t=this.drag;t&&(e||(e=t.lastDrag),e&&this.dragging&&(this.dragging=!1,t.params.onDragStop(e),this.eventSvc.dispatchEvent({type:"dragStopped",target:t.params.eElement})),this.destroyDrag())}onKeyDown(e){e.key===me.ESCAPE&&this.cancelDrag()}},oD=e=>{ix(e.handlers);const t=e.oldTouchAction;if(t!=null){const r=e.params.eElement.style;r&&(r.touchAction=t)}},fy=class{constructor(e,t,r,n=null){this.rootEl=e,this.params=t,this.start=r,this.pointerId=n,this.handlers=[],this.lastDrag=null,this.pointerCapture=null,this.eElement=t.eElement}},gy=e=>{const t=e.target;return t instanceof Element?t:null},tU=class extends ao{constructor(){super(...arguments),this.beanName="dragAndDrop",this.dragSourceAndParamsList=[],this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.dragSource=null,this.dragImageParent=null,this.dragImageCompPromise=null,this.dragImageComp=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.dropTargets=[],this.lastDropTarget=null}addDragSource(e,t=!1){const r={capturePointer:!0,dragSource:e,eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:n=>this.onDragStart(e,n),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),onDragCancel:this.onDragCancel.bind(this),includeTouch:t};this.dragSourceAndParamsList.push(r),this.beans.dragSvc.addDragSource(r)}setDragImageCompIcon(e,t=!1){const r=this.dragImageComp;r&&(t||this.dragImageLastIcon!==e)&&(this.dragImageLastIcon=e,r.setIcon(e,t))}removeDragSource(e){const{dragSourceAndParamsList:t,beans:r}=this,n=t.find(i=>i.dragSource===e);n&&(r.dragSvc?.removeDragSource(n),Ds(t,n))}destroy(){const{dragSourceAndParamsList:e,dropTargets:t,beans:r}=this,n=r.dragSvc;for(const i of e)n?.removeDragSource(i);e.length=0,t.length=0,this.clearDragAndDropProperties(),super.destroy()}nudge(){const e=this.lastMouseEvent;e&&this.onDragging(e,!0)}onDragStart(e,t){this.lastMouseEvent=t,this.dragSource=e,this.dragItem=e.getDragItem();const r=e.eElement.getBoundingClientRect();this.dragInitialSourcePointerOffsetX=t.clientX-r.left,this.dragInitialSourcePointerOffsetY=t.clientY-r.top,e.onDragStarted?.(),this.createAndUpdateDragImageComp(e)}onDragStop(e){const{dragSource:t,lastDropTarget:r}=this;if(t?.onDragStopped?.(),r){const n=this.dropTargetEvent(r,e,!1);r.onDragStop?.(n)}this.clearDragAndDropProperties()}onDragCancel(){const{dragSource:e,lastDropTarget:t,lastMouseEvent:r}=this;if(e?.onDragCancelled?.(),t&&r){const n=this.dropTargetEvent(t,r,!1);t.onDragCancel?.(n)}this.clearDragAndDropProperties()}onDragging(e,t=!1){this.positionDragImageComp(e);const r=this.findCurrentDropTarget(e),{lastDropTarget:n,dragSource:i,dragItem:s}=this;let o=!1;if(r!==n){if(o=!0,n){const a=this.dropTargetEvent(n,e,t);n.onDragLeave?.(a)}if(n!==null&&!r?this.handleExit(i,s):n===null&&r&&this.handleEnter(i,s),r){const a=this.dropTargetEvent(r,e,t);r.onDragEnter?.(a)}this.lastDropTarget=r}else if(r){const a=this.dropTargetEvent(r,e,t);r.onDragging?.(a),a?.changed&&(o=!0)}this.lastMouseEvent=e,o&&this.updateDragImageComp()}clearDragAndDropProperties(){this.removeDragImageComp(this.dragImageComp),this.dragImageCompPromise=null,this.dragImageParent=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.lastDropTarget=null,this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.dragSource=null}getAllContainersFromDropTarget(e){const t=e.getSecondaryContainers?e.getSecondaryContainers():null,r=[[e.getContainer()]];return t?r.concat(t):r}isMouseOnDropTarget(e,t){const r=this.getAllContainersFromDropTarget(t);let n=!1;const i=(a,u)=>{for(const d of u){const{width:h,height:g,left:m,right:v,top:w,bottom:C}=d.getBoundingClientRect();if(h===0||g===0)return!1;const b=a.clientX>=m&&a.clientX<v,x=a.clientY>=w&&a.clientY<C;if(!b||!x)return!1}return!0};for(const a of r)if(i(e,a)){n=!0;break}const{eElement:s,type:o}=this.dragSource;return t.targetContainsSource&&!t.getContainer().contains(s)?!1:n&&t.isInterestedIn(o,s)}findCurrentDropTarget(e){const t=this.dropTargets.filter(s=>this.isMouseOnDropTarget(e,s)),r=t.length;if(r===0)return null;if(r===1)return t[0];const i=Ws(this.beans).elementsFromPoint(e.clientX,e.clientY);for(const s of i)for(const o of t)if(this.getAllContainersFromDropTarget(o).flatMap(u=>u).indexOf(s)!==-1)return o;return null}addDropTarget(e){this.dropTargets.push(e)}removeDropTarget(e){this.dropTargets=this.dropTargets.filter(t=>t.getContainer()!==e.getContainer())}hasExternalDropZones(){return this.dropTargets.some(e=>e.external)}findExternalZone(e){return this.dropTargets.find(t=>t.external&&t.getContainer()===e)||null}dropTargetEvent(e,t,r){const{dragSource:n,dragItem:i,lastDraggingEvent:s,lastMouseEvent:o,dragInitialSourcePointerOffsetX:a,dragInitialSourcePointerOffsetY:u}=this,d=e.getContainer(),h=d.getBoundingClientRect(),{clientX:g,clientY:m}=t,v=g-(o?.clientX||0),w=m-(o?.clientY||0),C=this.createEvent({event:t,x:g-h.left,y:m-h.top,vDirection:w>0?"down":w<0?"up":null,hDirection:v<0?"left":v>0?"right":null,initialSourcePointerOffsetX:a,initialSourcePointerOffsetY:u,dragSource:n,fromNudge:r,dragItem:i,dropZoneTarget:d,dropTarget:s?.dropTarget??null,changed:!!s?.changed});return this.lastDraggingEvent=C,C}positionDragImageComp(e){const t=this.dragImageComp?.getGui();t&&jz(t,e,this.beans)}removeDragImageComp(e){this.dragImageComp===e&&(this.dragImageComp=null),e&&(e.getGui()?.remove(),this.destroyBean(e))}createAndUpdateDragImageComp(e){const t=this.createDragImageComp(e)??null;this.dragImageCompPromise=t,t?.then(r=>{if(t!==this.dragImageCompPromise||!this.lastMouseEvent||!this.isAlive()){this.destroyBean(r);return}this.dragImageCompPromise=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0;const n=this.dragImageComp;n!==r&&(this.dragImageComp=r,this.removeDragImageComp(n)),r&&(this.appendDragImageComp(r),this.updateDragImageComp())})}appendDragImageComp(e){const t=e.getGui(),r=t.style;r.position="absolute",r.zIndex="9999",this.beans.dragSvc?.hasPointerCapture()&&(r.pointerEvents="none"),this.gos.setInstanceDomData(t),this.beans.environment.applyThemeClasses(t),r.top="20px",r.left="20px";const n=ZS(this.beans);this.dragImageParent=n,n?n.appendChild(t):this.warnNoBody()}updateDragImageComp(){const{dragImageComp:e,dragSource:t,lastDropTarget:r,lastDraggingEvent:n,dragImageLastLabel:i}=this;if(!e)return;this.setDragImageCompIcon(r?.getIconName?.(n)??null);let s=t?.dragItemName;typeof s=="function"&&(s=s(n)),s||(s=""),i!==s&&(this.dragImageLastLabel=s,e.setLabel(s))}},rU=class extends tU{createEvent(e){return it(this.gos,e)}createDragImageComp(e){const{gos:t,beans:r}=this;return RW(r.userCompFactory,it(t,{dragSource:e}))?.newAgStackInstance()}handleEnter(e,t){e?.onGridEnter?.(t)}handleExit(e,t){e?.onGridExit?.(t)}warnNoBody(){Me(54)}isDropZoneWithinThisGrid(e){return this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody.contains(e.dropZoneTarget)}registerGridDropTarget(e,t){const r={getContainer:e,isInterestedIn:n=>n===1||n===0,getIconName:()=>"notAllowed"};this.addDropTarget(r),t.addDestroyFunc(()=>this.removeDropTarget(r))}};function $_(e,t){return e+"_"+t}function Vr(e){return e instanceof ff}var ff=class extends Ee{constructor(e,t,r,n){super(),this.providedColumnGroup=e,this.groupId=t,this.partId=r,this.pinned=n,this.isColumn=!1,this.displayedChildren=[],this.autoHeaderHeight=null,this.parent=null,this.colIdSanitised=Lh(this.getUniqueId())}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}getUniqueId(){return $_(this.groupId,this.partId)}isEmptyGroup(){return this.displayedChildren.length===0}isMoving(){const e=this.getProvidedColumnGroup().getLeafColumns();return!e||e.length===0?!1:e.every(t=>t.isMoving())}checkLeft(){for(const e of this.displayedChildren)Vr(e)&&e.checkLeft();if(this.displayedChildren.length>0)if(this.gos.get("enableRtl")){const t=ir(this.displayedChildren).getLeft();this.setLeft(t)}else{const e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchLocalEvent({type:"leftChanged"}))}getPinned(){return this.pinned}getGroupId(){return this.groupId}getPartId(){return this.partId}getActualWidth(){let e=0;for(const t of this.displayedChildren??[])e+=t.getActualWidth();return e}isResizable(){if(!this.displayedChildren)return!1;let e=!1;for(const t of this.displayedChildren)t.isResizable()&&(e=!0);return e}getMinWidth(){let e=0;for(const t of this.displayedChildren)e+=t.getMinWidth();return e}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){const e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}isAutoHeaderHeight(){return!!this.getColGroupDef()?.autoHeaderHeight}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}addDisplayedLeafColumns(e){for(const t of this.displayedChildren??[])Ya(t)?e.push(t):Vr(t)&&t.addDisplayedLeafColumns(e)}addLeafColumns(e){for(const t of this.children??[])Ya(t)?e.push(t):Vr(t)&&t.addLeafColumns(e)}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const e=this.getParent();return!this.isPadding()||!e?.isPadding()?0:1+e.getPaddingLevel()}calculateDisplayedColumns(){this.displayedChildren=[];let e=this;for(;e?.isPadding();)e=e.getParent();if(!(e?e.getProvidedColumnGroup().isExpandable():!1)){this.displayedChildren=this.children,this.dispatchLocalEvent({type:"displayedChildrenChanged"});return}for(const r of this.children??[]){if(Vr(r)&&!r.displayedChildren?.length)continue;switch(r.getColumnGroupShow()){case"open":e.getProvidedColumnGroup().isExpanded()&&this.displayedChildren.push(r);break;case"closed":e.getProvidedColumnGroup().isExpanded()||this.displayedChildren.push(r);break;default:this.displayedChildren.push(r);break}}this.dispatchLocalEvent({type:"displayedChildrenChanged"})}},_b="row-group-",yx="t-",bx="b-",nU=0,Ka=class{constructor(e){this.master=!1,this.detail=void 0,this.rowIndex=null,this.key=null,this.sourceRowIndex=-1,this._leafs=void 0,this.childrenMapped=null,this.treeParent=null,this.treeNodeFlags=0,this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=nU++,this.alreadyRendered=!1,this.hovered=!1,this.__selected=!1,this.beans=e}get allLeafChildren(){const e=this._leafs;return e===void 0?this.beans.groupStage?.loadLeafs?.(this)??null:e}set allLeafChildren(e){this._leafs=e}setData(e){this.setDataCommon(e,!1)}updateData(e){this.setDataCommon(e,!0)}setDataCommon(e,t){const{valueCache:r,eventSvc:n}=this.beans,i=this.data;this.data=e,r?.onDataChanged(),this.updateDataOnDetailNode(),this.resetQuickFilterAggregateText();const s=this.createDataChangedEvent(e,i,t);if(this.__localEventService?.dispatchEvent(s),this.sibling){this.sibling.data=e;const a=this.sibling.createDataChangedEvent(e,i,t);this.sibling.__localEventService?.dispatchEvent(a)}n.dispatchEvent({type:"rowNodeDataChanged",node:this});const o=this.pinnedSibling;o&&(o.data=e,o.__localEventService?.dispatchEvent(o.createDataChangedEvent(e,i,t)),n.dispatchEvent({type:"rowNodeDataChanged",node:o}))}updateDataOnDetailNode(){const e=this.detailNode;e&&(e.data=this.data)}createDataChangedEvent(e,t,r){return{type:"dataChanged",node:this,oldData:t,newData:e,update:r}}getRowIndexString(){return this.rowIndex==null?(Zt(13),null):this.rowPinned==="top"?yx+this.rowIndex:this.rowPinned==="bottom"?bx+this.rowIndex:this.rowIndex.toString()}setDataAndId(e,t){const{selectionSvc:r}=this.beans,n=r?.createDaemonNode?.(this),i=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),r&&(r.updateRowSelectable(this),r.syncInRowNode(this,n));const s=this.createDataChangedEvent(e,i,!1);this.__localEventService?.dispatchEvent(s)}setId(e){const t=Zu(this.beans.gos);if(t)if(this.data){const r=this.parent?.getRoute()??[];this.id=t({data:this.data,parentKeys:r.length>0?r:void 0,level:this.level,rowPinned:this.rowPinned}),this.id.startsWith(_b)&&Zt(14,{groupPrefix:_b})}else this.id=void 0;else this.id=e}setRowTop(e){if(this.oldRowTop=this.rowTop,this.rowTop===e)return;this.rowTop=e,this.dispatchRowEvent("topChanged");const t=e!==null;this.displayed!==t&&(this.displayed=t,this.dispatchRowEvent("displayedChanged"))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setHovered(e){this.hovered=e}isHovered(){return this.hovered}setRowHeight(e,t=!1){this.rowHeight=e,this.rowHeightEstimated=t,this.dispatchRowEvent("heightChanged")}setExpanded(e,t,r){this.beans.expansionSvc?.setExpanded(this,e,t,r)}setDataValue(e,t,r){const{colModel:n,valueSvc:i,gos:s,editSvc:o}=this.beans,a=typeof e!="string"?e:n.getCol(e)??n.getColDefCol(e);if(!a)return!1;const u=i.getValueForDisplay(a,this,void 0,void 0,"api").value;if(s.get("readOnlyEdit")){const{beans:{eventSvc:h},data:g,rowIndex:m,rowPinned:v}=this;return h.dispatchEvent({type:"cellEditRequest",event:null,rowIndex:m,rowPinned:v,column:a,colDef:a.colDef,data:g,node:this,oldValue:u,newValue:t,value:t,source:r}),!1}if(o&&!o.committing){const h=o.setDataValue({rowNode:this,column:a},t,r);if(h!=null)return h}const d=i.setValue(this,a,t,r);return this.dispatchCellChangedEvent(a,t,u),d&&this.pinnedSibling?.dispatchCellChangedEvent(a,t,u),d}updateHasChildren(){let e=this.group&&!this.footer||!!this.childrenAfterGroup?.length;const{rowChildrenSvc:t}=this.beans;t&&(e=t.getHasChildrenValue(this)),e!==this.__hasChildren&&(this.__hasChildren=!!e,this.dispatchRowEvent("hasChildrenChanged"))}hasChildren(){return this.__hasChildren==null&&this.updateHasChildren(),this.__hasChildren}dispatchCellChangedEvent(e,t,r){const n={type:"cellChanged",node:this,column:e,newValue:t,oldValue:r};this.__localEventService?.dispatchEvent(n)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return this.beans.expansionSvc?.isExpandable(this)??!1}isSelected(){if(this.footer)return this.sibling.isSelected();const e=this.rowPinned&&this.pinnedSibling;return e?e.isSelected():this.__selected}depthFirstSearch(e){const t=this.childrenAfterGroup;if(t)for(let r=0,n=t.length;r<n;++r)t[r].depthFirstSearch(e);e(this)}dispatchRowEvent(e){this.__localEventService?.dispatchEvent({type:e,node:this})}setSelected(e,t=!1,r="api"){this.beans.selectionSvc?.setNodesSelected({nodes:[this],newValue:e,clearSelection:t,source:r})}isRowPinned(){return!!this.rowPinned}__addEventListener(e,t){(this.__localEventService??(this.__localEventService=new Zl)).addEventListener(e,t)}__removeEventListener(e,t){this.removeLocalListener(e,t)}addEventListener(e,t){this.beans.validation?.checkRowEvents(e);const r=this.__localEventService??(this.__localEventService=new Zl);this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,r);const n=this.frameworkEventListenerService?.wrap(e,t)??t;r.addEventListener(e,n)}removeEventListener(e,t){const r=this.frameworkEventListenerService?.unwrap(e,t)??t;this.removeLocalListener(e,r)}removeLocalListener(e,t){const r=this.__localEventService;r&&(r.removeEventListener(e,t),r.noRegisteredListenersExist()&&(this.__localEventService=null))}isFullWidthCell(){if(Me(61),this.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this}):!1}getRoute(){if(this.level===-1)return[];if(this.key==null)return;const e=[];let t=this;for(;t?.key!=null;)e.push(t.key),t=t.parent;return e.reverse()}setRowIndex(e){this.rowIndex!==e&&(this.rowIndex=e,this.dispatchRowEvent("rowIndexChanged"))}setAllChildrenCount(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.dispatchRowEvent("allChildrenCountChanged"))}setUiLevel(e){this.uiLevel!==e&&(this.uiLevel=e,this.dispatchRowEvent("uiLevelChanged"))}getFirstChild(){const e=this.childStore;return e?e.getFirstNode():this.childrenAfterSort?.[0]??null}};function iU(e,t,r){return it(t,{type:r,node:e,data:e.data,rowIndex:e.rowIndex,rowPinned:e.rowPinned})}var sU=new Set(["__autoHeights","__checkAutoHeightsDebounced","__localEventService","__objectId","_leafs","childStore","oldRowTop","sticky","treeNodeFlags","treeParent"]),oU=(e,t)=>{const r=new Ka(t);for(const n of Object.keys(e))sU.has(n)||(r[n]=e[n]);return r.oldRowTop=null,r},j_=e=>{for(;e?.length;){const t=e[0];if(t.data)return t;e=t.childrenAfterGroup}},Y_={agSetColumnFilter:"agSetColumnFilterHandler",agMultiColumnFilter:"agMultiColumnFilterHandler",agGroupColumnFilter:"agGroupColumnFilterHandler",agNumberColumnFilter:"agNumberColumnFilterHandler",agDateColumnFilter:"agDateColumnFilterHandler",agTextColumnFilter:"agTextColumnFilterHandler"},aU=new Set(Object.values(Y_));function Ma(e,t){const r=e.filterUi;if(!r)return null;if(r.created)return r.promise;if(t)return null;const n=r.create(r.refreshed),i=r;return i.created=!0,i.promise=n,n}function lU(e,t,r,n,i,s,o){return t.refresh?.({...r,model:n,source:s,additionalEventAttributes:o}),e().then(a=>{if(a){const{filter:u,filterParams:d}=a;K_(u,d,n,i,s,o)}})}function K_(e,t,r,n,i,s){e?.refresh?.({...t,model:r,state:n,source:i,additionalEventAttributes:s})}function q_(e,t,r){const n=e();n?.created&&n.promise.then(i=>{const s=t();K_(i,n.filterParams,s,r()??{model:s},"ui")})}function aD(e,t,r,n,i,s,o){let a,u=!1,d;switch(e){case"apply":{const h=n();d=h?.model??null,o&&(d=o(d)),a={state:h?.state,model:d},u=!0;break}case"clear":{a={model:null};break}case"reset":{a={model:null},u=!0,d=null;break}case"cancel":{a={model:r()};break}}i(a),u?s(d):q_(t,r,n)}function on(e,t){return e[t]??null}function jn(e){return Hf(e)}function cU(e){return{tag:"div",cls:e}}var uU=class extends Dr{constructor(e){const{className:t="ag-filter-apply-panel"}=e??{};super(cU(t)),this.listeners=[],this.validationMessage=null,this.className=t}updateButtons(e,t){const r=this.buttons;if(this.buttons=e,r===e)return;const n=this.getGui();ci(n);let i;this.destroyListeners();const s=document.createDocumentFragment(),o=this.className,a=({type:d,label:h})=>{const g=x=>{this.dispatchLocalEvent({type:d,event:x})};["apply","clear","reset","cancel"].includes(d)||Me(75);const m=d==="apply",w=jn({tag:"button",attrs:{type:m&&t?"submit":"button"},ref:`${d}FilterButton`,cls:`ag-button ag-standard-button ${o}-button${m?" "+o+"-apply-button":""}`,children:h});this.activateTabIndex([w]),m&&(i=w);const C=x=>{x.key===me.ENTER&&(x.preventDefault(),g(x))},b=this.listeners;w.addEventListener("click",g),b.push(()=>w.removeEventListener("click",g)),w.addEventListener("keydown",C),b.push(()=>w.removeEventListener("keydown",C)),s.append(w)};for(const d of e)a(d);this.eApply=i;const u=this.validationTooltipFeature;i&&!u?this.validationTooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.eApply,getLocation:()=>"advancedFilter",getTooltipShowDelayOverride:()=>1e3})):!i&&u&&(this.validationTooltipFeature=this.destroyBean(u)),n.append(s)}getApplyButton(){return this.eApply}updateValidity(e,t=null){const r=this.eApply;r&&(af(r,e===!1),this.validationMessage=t??null,this.validationTooltipFeature?.setTooltipAndRefresh(this.validationMessage))}destroyListeners(){for(const e of this.listeners)e();this.listeners=[]}destroy(){this.destroyListeners(),super.destroy()}},dU={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd",filterSummaryInactive:"is (All)",filterSummaryContains:"contains",filterSummaryNotContains:"does not contain",filterSummaryTextEquals:"equals",filterSummaryTextNotEqual:"does not equal",filterSummaryStartsWith:"begins with",filterSummaryEndsWith:"ends with",filterSummaryBlank:"is blank",filterSummaryNotBlank:"is not blank",filterSummaryEquals:"=",filterSummaryNotEqual:"!=",filterSummaryGreaterThan:">",filterSummaryGreaterThanOrEqual:">=",filterSummaryLessThan:"<",filterSummaryLessThanOrEqual:"<=",filterSummaryInRange:"between",filterSummaryInRangeValues:e=>`(${e[0]}, ${e[1]})`,filterSummaryTextQuote:e=>`"${e[0]}"`};function Ba(e,t,r){return Kz(e,dU,t,r)}function Sx(e,t){const{debounceMs:r}=e;return qm(e)?(r!=null&&Me(71),0):r??t}function qm(e){return(e.buttons?.indexOf("apply")??-1)>=0}var hU=class extends Dr{constructor(e,t,r,n,i,s){super(),this.column=e,this.wrapper=t,this.eventParent=r,this.updateModel=n,this.isGlobalButtons=i,this.enableGlobalButtonCheck=s,this.hidePopup=null,this.applyActive=!1}postConstruct(){const{comp:e,params:t}=this.wrapper,r=t,n=r.useForm,i=n?"form":"div";this.setTemplate({tag:i,cls:"ag-filter-wrapper"}),n&&this.addManagedElementListeners(this.getGui(),{submit:s=>{s?.preventDefault()},keydown:this.handleKeyDown.bind(this)}),this.appendChild(e.getGui()),this.params=r,this.resetButtonsPanel(r),this.addManagedListeners(this.eventParent,{filterParamsChanged:({column:s,params:o})=>{s===this.column&&this.resetButtonsPanel(o,this.params)},filterStateChanged:({column:s,state:o})=>{s===this.column&&this.eButtons?.updateValidity(o.valid!==!1)},filterAction:({column:s,action:o,event:a})=>{s===this.column&&this.afterAction(o,a)},...this.enableGlobalButtonCheck?{filterGlobalButtons:({isGlobal:s})=>{if(s!==this.isGlobalButtons){this.isGlobalButtons=s;const o=this.params;this.resetButtonsPanel(o,o,!0)}}}:void 0})}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup)}resetButtonsPanel(e,t,r){const{buttons:n,readOnly:i}=t??{},{buttons:s,readOnly:o,useForm:a}=e;if(!r&&i===o&&sf(n,s))return;const u=s&&s.length>0&&!e.readOnly&&!this.isGlobalButtons;let d=this.eButtons;if(u){const h=s.map(g=>{const m=`${g}Filter`;return{type:g,label:Ba(this,m)}});if(this.applyActive=qm(this.params),!d){d=this.createBean(new uU),this.appendChild(d.getGui());const g=this.column,m=v=>({event:w})=>{this.updateModel(g,v,{fromButtons:!0}),this.afterAction(v,w)};d?.addManagedListeners(d,{apply:m("apply"),clear:m("clear"),reset:m("reset"),cancel:m("cancel")}),this.eButtons=d}d.updateButtons(h,a)}else this.applyActive=!1,d&&(Ua(d.getGui()),this.eButtons=this.destroyBean(d))}close(e){const t=this.hidePopup;if(!t)return;const r=e,n=r?.key;let i;(n===me.ENTER||n===me.SPACE)&&(i={keyboardEvent:r}),t(i),this.hidePopup=null}afterAction(e,t){const{params:r,applyActive:n}=this,i=r?.closeOnApply;switch(e){case"apply":{t?.preventDefault(),i&&n&&this.close(t);break}case"reset":{i&&n&&this.close();break}case"cancel":{i&&this.close(t);break}}}handleKeyDown(e){!e.defaultPrevented&&e.key===me.ENTER&&this.applyActive&&(this.updateModel(this.column,"apply",{fromButtons:!0}),this.afterAction("apply",e))}destroy(){this.hidePopup=null,this.eButtons=this.destroyBean(this.eButtons)}},fU={tag:"div",cls:"ag-filter"},gU=class extends Dr{constructor(e,t,r){super(fU),this.column=e,this.source=t,this.enableGlobalButtonCheck=r,this.wrapper=null}postConstruct(){this.beans.colFilter?.activeFilterComps.add(this),this.createFilter(!0),this.addManagedEventListeners({filterDestroyed:this.onFilterDestroyed.bind(this)})}hasFilter(){return this.wrapper!=null}getFilter(){return this.wrapper?.then(e=>e.comp)??null}afterInit(){return this.wrapper?.then(()=>{})??Nt.resolve()}afterGuiAttached(e){this.afterGuiAttachedParams=e,this.wrapper?.then(t=>{this.comp?.afterGuiAttached(e),t?.comp?.afterGuiAttached?.(e)})}afterGuiDetached(){this.wrapper?.then(e=>{e?.comp?.afterGuiDetached?.()})}createFilter(e){const{column:t,source:r,beans:{colFilter:n}}=this,i=n.getFilterUiForDisplay(t)??null;this.wrapper=i,i?.then(s=>{if(!s)return;const{isHandler:o,comp:a}=s;let u;if(o){const d=!!this.enableGlobalButtonCheck,h=this.createBean(new hU(t,s,n,n.updateModel.bind(n),d&&n.isGlobalButtons,d));this.comp=h,u=h.getGui()}else u=a.getGui(),$e(u)||Me(69,{guiFromFilter:u});this.appendChild(u),e?this.eventSvc.dispatchEvent({type:"filterOpened",column:t,source:r,eGui:this.getGui()}):a.afterGuiAttached?.(this.afterGuiAttachedParams)})}onFilterDestroyed(e){const{source:t,column:r}=e;(t==="api"||t==="paramsUpdated")&&r.getId()===this.column.getId()&&this.beans.colModel.getColDefCol(this.column)&&(ci(this.getGui()),this.comp=this.destroyBean(this.comp),this.createFilter())}destroy(){this.beans.colFilter?.activeFilterComps.delete(this),this.eventSvc.dispatchEvent({type:"filterClosed",column:this.column}),this.wrapper=null,this.comp=this.destroyBean(this.comp),this.afterGuiAttachedParams=void 0,super.destroy()}},lD={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},cD=["january","february","march","april","may","june","july","august","september","october","november","december"];function pU(e,t){return e==null?-1:t==null?1:Number.parseFloat(e)-Number.parseFloat(t)}function uD(e){return e instanceof Date&&!isNaN(e.getTime())}var Lb={number:()=>{},boolean:()=>({maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(e,t)=>t,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(e,t)=>t===!1,numberOfInputs:0}]}),date:()=>({isValidDate:uD}),dateString:({dataTypeDefinition:e})=>({comparator:(t,r)=>{const n=e.dateParser(r);return r==null||n<t?-1:n>t?1:0},isValidDate:t=>typeof t=="string"&&uD(e.dateParser(t))}),dateTime:e=>Lb.date(e),dateTimeString:e=>Lb.dateString(e),object:()=>{},text:()=>{}},Ib={number:()=>({comparator:pU}),boolean:({t:e})=>({valueFormatter:t=>$e(t.value)?e(String(t.value),t.value?"True":"False"):e("blanks","(Blanks)")}),date:({formatValue:e,t})=>({valueFormatter:r=>{const n=e(r);return $e(n)?n:t("blanks","(Blanks)")},treeList:!0,treeListFormatter:(r,n)=>{if(r==="NaN")return t("invalidDate","Invalid Date");if(n===1&&r!=null){const i=cD[Number(r)-1];return t(i,lD[i])}return r??t("blanks","(Blanks)")},treeListPathGetter:r=>Rp(r,!1)}),dateString:({formatValue:e,dataTypeDefinition:t,t:r})=>({valueFormatter:n=>{const i=e(n);return $e(i)?i:r("blanks","(Blanks)")},treeList:!0,treeListPathGetter:n=>Rp(t.dateParser(n??void 0),!1),treeListFormatter:(n,i)=>{if(i===1&&n!=null){const s=cD[Number(n)-1];return r(s,lD[s])}return n??r("blanks","(Blanks)")}}),dateTime:e=>{const t=Ib.date(e);return t.treeListPathGetter=Rp,t},dateTimeString(e){const t=e.dataTypeDefinition.dateParser,r=Ib.dateString(e);return r.treeListPathGetter=n=>Rp(t(n??void 0)),r},object:({formatValue:e,t})=>({valueFormatter:r=>{const n=e(r);return $e(n)?n:t("blanks","(Blanks)")}}),text:()=>{}};function mU(e,t,r,n,i,s,o){let a=t,u=r;const d=e==="agSetColumnFilter";!u&&n.baseDataType==="object"&&!d&&(u=({column:v,node:w})=>i({column:v,node:w,value:s.valueSvc.getValue(v,w)}));const g=(d?Ib:Lb)[n.baseDataType],m=g({dataTypeDefinition:n,formatValue:i,t:o});return a=typeof t=="object"?{...m,...t}:m,{filterParams:a,filterValueGetter:u}}var vU={boolean:"agTextColumnFilter",date:"agDateColumnFilter",dateString:"agDateColumnFilter",dateTime:"agDateColumnFilter",dateTimeString:"agDateColumnFilter",number:"agNumberColumnFilter",object:"agTextColumnFilter",text:"agTextColumnFilter"},wU={boolean:"agTextColumnFloatingFilter",date:"agDateColumnFloatingFilter",dateString:"agDateColumnFloatingFilter",dateTime:"agDateColumnFloatingFilter",dateTimeString:"agDateColumnFloatingFilter",number:"agNumberColumnFloatingFilter",object:"agTextColumnFloatingFilter",text:"agTextColumnFloatingFilter"};function CU(e,t=!1){return(t?wU:vU)[e??"text"]}var X_="ag-resizer-wrapper",_a=(e,t)=>({tag:"div",ref:`${e}Resizer`,cls:`ag-resizer ag-resizer-${t}`}),yU={tag:"div",cls:X_,children:[_a("eTopLeft","topLeft"),_a("eTop","top"),_a("eTopRight","topRight"),_a("eRight","right"),_a("eBottomRight","bottomRight"),_a("eBottom","bottom"),_a("eBottomLeft","bottomLeft"),_a("eLeft","left")]},bU=class extends Ee{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},t)}wireBeans(e){this.popupSvc=e.popupSvc,this.dragSvc=e.dragSvc}center(e){const{clientHeight:t,clientWidth:r}=this.offsetParent,n=r/2-this.getWidth()/2,i=t/2-this.getHeight()/2;this.offsetElement(n,i,e)}initialisePosition(e){if(this.positioned)return;const{centered:t,forcePopupParentAsOffsetParent:r,minWidth:n,width:i,minHeight:s,height:o,x:a,y:u}=this.config;this.offsetParent||this.setOffsetParent();let d=0,h=0;const g=Qo(this.element);if(g){const m=this.findBoundaryElement(),v=window.getComputedStyle(m);if(v.minWidth!=null){const w=m.offsetWidth-this.element.offsetWidth;h=Number.parseInt(v.minWidth,10)-w}if(v.minHeight!=null){const w=m.offsetHeight-this.element.offsetHeight;d=Number.parseInt(v.minHeight,10)-w}}if(this.minHeight=s||d,this.minWidth=n||h,i&&this.setWidth(i),o&&this.setHeight(o),(!i||!o)&&this.refreshSize(),t)this.center(e);else if(a||u)this.offsetElement(a,u,e);else if(g&&r){let m=this.boundaryEl,v=!0;if(m||(m=this.findBoundaryElement(),v=!1),m){const w=Number.parseFloat(m.style.top),C=Number.parseFloat(m.style.left);v?this.offsetElement(isNaN(C)?0:C,isNaN(w)?0:w,e):this.setPosition(C,w)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){if(!this.config.popup||e===this.movable)return;this.movable=e;const r=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragSvc?.addDragSource(r),this.moveElementDragListener=r):(this.dragSvc?.removeDragSource(r),this.moveElementDragListener=void 0)}setResizable(e){if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),typeof e=="boolean"){if(e===!1)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}Object.keys(e).forEach(t=>{const n=!!e[t],i=this.getResizerElement(t),s={dragStartPixels:0,eElement:i,onDragStart:o=>this.onResizeStart(o,t),onDragging:this.onResize.bind(this),onDragStop:o=>this.onResizeEnd(o,t)};(n||!this.isAlive()&&!n)&&(n?(this.dragSvc?.addDragSource(s),this.resizeListeners.push(s),i.style.pointerEvents="all"):i.style.pointerEvents="none",this.resizable[t]=n)})}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";const{height:e,width:t}=this.lastSize;t!==-1&&(this.element.style.width=`${t}px`),e!==-1&&(this.element.style.height=`${e}px`)}getHeight(){return this.element.offsetHeight}setHeight(e){const{popup:t}=this.config,r=this.element;let n=!1;if(typeof e=="string"&&e.includes("%"))Oh(r,e),e=IM(r),n=!0;else if(e=Math.max(this.minHeight,e),this.positioned){const i=this.getAvailableHeight();i&&e>i&&(e=i)}this.getHeight()!==e&&(n?(r.style.maxHeight="unset",r.style.minHeight="unset"):t?Oh(r,e):(r.style.height=`${e}px`,r.style.flex="0 0 auto",this.lastSize.height=typeof e=="number"?e:Number.parseFloat(e)))}getAvailableHeight(){const{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();const{clientHeight:r}=this.offsetParent;if(!r)return null;const n=this.element.getBoundingClientRect(),i=this.offsetParent.getBoundingClientRect(),s=e?this.position.y:n.top,o=e?0:i.top;let a=0;if(t){const d=this.element.parentElement;if(d){const{bottom:h}=d.getBoundingClientRect();a=h-n.bottom}}return r+o-s-a}getWidth(){return this.element.offsetWidth}setWidth(e){const t=this.element,{popup:r}=this.config;let n=!1;if(typeof e=="string"&&e.includes("%"))Js(t,e),e=E0(t),n=!0;else if(this.positioned){e=Math.max(this.minWidth,e);const{clientWidth:i}=this.offsetParent,s=r?this.position.x:this.element.getBoundingClientRect().left;i&&e+s>i&&(e=i-s)}this.getWidth()!==e&&(n?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?Js(t,e):(t.style.width=`${e}px`,t.style.flex=" unset",this.lastSize.width=typeof e=="number"?e:Number.parseFloat(e)))}offsetElement(e=0,t=0,r){const{forcePopupParentAsOffsetParent:n}=this.config,i=n?this.boundaryEl:this.element;i&&(this.popupSvc?.positionPopup({ePopup:i,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t}),postProcessCallback:r}),this.setPosition(Number.parseFloat(i.style.left),Number.parseFloat(i.style.top)))}constrainSizeToAvailableHeight(e){if(!this.config.forcePopupParentAsOffsetParent)return;const t=()=>{const r=this.getAvailableHeight();this.element.style.setProperty("max-height",`${r}px`)};e&&this.popupSvc?(this.resizeObserverSubscriber?.(),this.resizeObserverSubscriber=Zo(this.beans,this.popupSvc?.getPopupParent(),t)):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){const{e:t,isLeft:r,isTop:n,anywhereWithin:i,topBuffer:s}=e,o=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y,u=this.shouldSkipX(t,!!r,!!i,o)?0:o,d=this.shouldSkipY(t,!!n,s,a)?0:a;return{movementX:u,movementY:d}}shouldSkipX(e,t,r,n){const i=this.element.getBoundingClientRect(),s=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:i.left;let u=a<=0&&s.left>=e.clientX||s.right<=e.clientX&&s.right<=o.right;return u?!0:(t?u=n<0&&e.clientX>a+s.left||n>0&&e.clientX<a+s.left:r?u=n<0&&e.clientX>o.right||n>0&&e.clientX<a+s.left:u=n<0&&e.clientX>o.right||n>0&&e.clientX<o.right,u)}shouldSkipY(e,t,r=0,n){const i=this.element.getBoundingClientRect(),s=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:i.top;let u=a<=0&&s.top>=e.clientY||s.bottom<=e.clientY&&s.bottom<=o.bottom;return u?!0:(t?u=n<0&&e.clientY>a+s.top+r||n>0&&e.clientY<a+s.top:u=n<0&&e.clientY>o.bottom||n>0&&e.clientY<o.bottom,u)}createResizeMap(){const e=t=>({element:this.element.querySelector(`[data-ref=${t}Resizer]`)});this.resizerMap={topLeft:e("eTopLeft"),top:e("eTop"),topRight:e("eTopRight"),right:e("eRight"),bottomRight:e("eBottomRight"),bottom:e("eBottom"),bottomLeft:e("eBottomLeft"),left:e("eLeft")}}addResizers(){if(this.resizersAdded)return;const e=this.element;e&&(e.appendChild(jn(yU)),this.createResizeMap(),this.resizersAdded=!0)}removeResizers(){this.resizerMap=void 0,this.element.querySelector(`.${X_}`)?.remove(),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");const{popup:r,forcePopupParentAsOffsetParent:n}=this.config;!r&&!n&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){const t=this.element.parentElement;return t?Array.prototype.slice.call(t.children).filter(r=>!r.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){const e=this.getSiblings()||[];let t=0,r=0;for(let n=0;n<e.length;n++){const i=e[n],s=!!i.style.flex&&i.style.flex!=="0 0 auto";if(i===this.element)continue;let o=this.minHeight||0,a=this.minWidth||0;if(s){const u=window.getComputedStyle(i);u.minHeight&&(o=Number.parseInt(u.minHeight,10)),u.minWidth&&(a=Number.parseInt(u.minWidth,10))}else o=i.offsetHeight,a=i.offsetWidth;t+=o,r+=a}return{height:t,width:r}}applySizeToSiblings(e){let t=null;const r=this.getSiblings();if(r){for(let n=0;n<r.length;n++){const i=r[n];i!==t&&(e?i.style.height=`${i.offsetHeight}px`:i.style.width=`${i.offsetWidth}px`,i.style.flex="0 0 auto",i===this.element&&(t=r[n+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(e=>e)}onResize(e){if(!this.isResizing||!this.currentResizer)return;const{popup:t,forcePopupParentAsOffsetParent:r}=this.config,{isTop:n,isRight:i,isBottom:s,isLeft:o}=this.currentResizer,a=i||o,u=s||n,{movementX:d,movementY:h}=this.calculateMouseMovement({e,isLeft:o,isTop:n}),g=this.position.x,m=this.position.y;let v=0,w=0;if(a&&d){const C=o?-1:1,b=this.getWidth(),x=b+d*C;let R=!1;o&&(v=b-x,(g+v<=0||x<=this.minWidth)&&(R=!0,v=0)),R||this.setWidth(x)}if(u&&h){const C=n?-1:1,b=this.getHeight(),x=b+h*C;let R=!1;n?(w=b-x,(m+w<=0||x<=this.minHeight)&&(R=!0,w=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&b<x&&this.getMinSizeOfSiblings().height+x>this.element.parentElement.offsetHeight&&(R=!0),R||this.setHeight(x)}this.updateDragStartPosition(e.clientX,e.clientY),((t||r)&&v||w)&&this.offsetElement(g+v,m+w)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null,this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchLocalEvent({type:"resize"})}refreshSize(){const e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;const{x:t,y:r}=this.position;let n;this.config.calculateTopBuffer&&(n=this.config.calculateTopBuffer());const{movementX:i,movementY:s}=this.calculateMouseMovement({e,isTop:!0,anywhereWithin:!0,topBuffer:n});this.offsetElement(t+i,r+s),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent&&this.popupSvc?this.offsetParent=this.popupSvc.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if(window.getComputedStyle(e).position!=="static")return e;e=e.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){const e=this.resizeListeners.pop();this.dragSvc?.removeDragSource(e)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragSvc?.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}},Q_="__ag_Grid_Stop_Propagation";function nc(e){e[Q_]=!0}function zo(e){return e[Q_]===!0}var SU="ag-focus-managed",wd=class extends Ee{constructor(e,t={}){super(),this.eFocusable=e,this.callbacks=t,this.callbacks={shouldStopEventPropagation:()=>!1,onTabKeyDown:r=>{if(r.defaultPrevented)return;const n=vc(this.beans,this.eFocusable,!1,r.shiftKey);n&&(n.focus(),r.preventDefault())},...t}}postConstruct(){const{eFocusable:e,callbacks:{onFocusIn:t,onFocusOut:r}}=this;e.classList.add(SU),this.addKeyDownListeners(e),t&&this.addManagedElementListeners(e,{focusin:t}),r&&this.addManagedElementListeners(e,{focusout:r})}addKeyDownListeners(e){this.addManagedElementListeners(e,{keydown:t=>{if(t.defaultPrevented||zo(t))return;const{callbacks:r}=this;if(r.shouldStopEventPropagation(t)){nc(t);return}t.key===me.TAB?r.onTabKeyDown(t):r.handleKeyDown&&r.handleKeyDown(t)}})}},xU=class extends Dr{constructor(e,t){super(),this.filterNameKey=e,this.cssIdentifier=t,this.applyActive=!1,this.debouncePending=!1,this.defaultDebounceMs=0}postConstruct(){const e={tag:"div",cls:`ag-filter-body-wrapper ag-${this.cssIdentifier}-body-wrapper`,children:[this.createBodyTemplate()]};this.setTemplate(e,this.getAgComponents()),this.createManagedBean(new wd(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=this.createBean(new bU(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}))}handleKeyDown(e){}init(e){const t=e;this.setParams(t),this.setModelIntoUi(t.state.model,!0).then(()=>this.updateUiVisibility())}refresh(e){const t=e,r=this.params;this.params=t,t.source==="colDef"&&this.updateParams(t,r);const i=t.state,s=this.state;return this.state=i,(i.model!==s.model||i.state!==s.state)&&this.setModelIntoUi(i.model),!0}setParams(e){this.params=e,this.state=e.state,this.commonUpdateParams(e)}updateParams(e,t){this.commonUpdateParams(e,t)}commonUpdateParams(e,t){this.applyActive=qm(e),this.setupApplyDebounced()}doesFilterPass(e){Me(283);const{getHandler:t,model:r,column:n}=this.params;return t().doesFilterPass({...e,model:r,handlerParams:this.beans.colFilter.getHandlerParams(n)})}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return Me(284),this.params.model!=null}setupApplyDebounced(){const e=Sx(this.params,this.defaultDebounceMs),t=yn(this,this.checkApplyDebounce.bind(this),e);this.applyDebounced=()=>{this.debouncePending=!0,t()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.doApplyModel())}getModel(){return Me(285),this.params.model}setModel(e){Me(286);const{beans:t,params:r}=this;return t.colFilter.setModelForColumnLegacy(r.column,e)}applyModel(e="api"){return this.doApplyModel()}canApply(e){return!0}doApplyModel(e){const{params:t,state:r}=this,n=!this.areModelsEqual(t.model,r.model);return n&&t.onAction("apply",e),n}onNewRowsLoaded(){}onUiChanged(e,t=!1){this.updateUiVisibility();const r=this.getModelFromUi(),n={model:r,state:this.getState(),valid:this.canApply(r)};this.state=n;const i=this.params;i.onStateChange(n),i.onUiChange(this.getUiChangeEventParams()),this.gos.get("enableFilterHandlers")||this.eventSvc.dispatchEvent({type:"filterModified",column:i.column,filterInstance:this}),e??(e=this.applyActive?void 0:"debounce"),e==="immediately"?this.doApplyModel({afterFloatingFilter:t,afterDataChange:!1}):e==="debounce"&&this.applyDebounced()}getState(){}getUiChangeEventParams(){}afterGuiAttached(e){this.lastContainerType=e?.container,this.refreshFilterResizer(e?.container)}refreshFilterResizer(e){const{positionableFeature:t,gos:r}=this;if(!t)return;const n=e==="floatingFilter"||e==="columnFilter";n?(t.restoreLastSize(),t.setResizable(r.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(t.removeSizeFromEl(),t.setResizable(!1)),t.constrainSizeToAvailableHeight(n)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature?.constrainSizeToAvailableHeight(!1)}destroy(){this.positionableFeature=this.destroyBean(this.positionableFeature),super.destroy()}translate(e){return Ba(this,e)}getPositionableElement(){return this.getGui()}areModelsEqual(e,t){return e===t||e==null&&t==null?!0:e==null||t==null?!1:this.areNonNullModelsEqual(e,t)}};function Z_(e){return!!e.operator}function EU(e,t,r){if(t==null)return null;let n=null;const{compName:i,jsComp:s,fwComp:o}=R_(e,t);return i?n={agSetColumnFilter:"agSetColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"}[i]:s==null&&o==null&&t.filter===!0&&(n=r()),n}var o0={AUTO_HEIGHT:"ag-layout-auto-height",NORMAL:"ag-layout-normal",PRINT:"ag-layout-print"},xx=class extends Ee{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const e=this.gos.get("domLayout"),t={autoHeight:e==="autoHeight",normal:e==="normal",print:e==="print"},r=t.autoHeight?o0.AUTO_HEIGHT:t.print?o0.PRINT:o0.NORMAL;this.view.updateLayoutClasses(r,t)}},La="Viewport",dD="fakeVScrollComp",py=["fakeHScrollComp","centerHeader","topCenter","bottomCenter","stickyTopCenter","stickyBottomCenter"],hD=100,my=150,RU=class extends Ee{constructor(e){super(),this.clearRetryListenerFncs=[],this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.lastIsHorizontalScrollShowing=!1,this.scrollTimer=0,this.isScrollActive=!1,this.isVerticalPositionInvalidated=!0,this.isHorizontalPositionInvalidated=!0,this.eBodyViewport=e,this.resetLastHScrollDebounced=yn(this,()=>this.lastScrollSource[1]=null,my),this.resetLastVScrollDebounced=yn(this,()=>this.lastScrollSource[0]=null,my)}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.animationFrameSvc=e.animationFrameSvc,this.visibleCols=e.visibleCols}destroy(){super.destroy(),this.clearRetryListenerFncs=[],window.clearTimeout(this.scrollTimer)}postConstruct(){this.enableRtl=this.gos.get("enableRtl");const e=this.invalidateVerticalScroll.bind(this),t=this.invalidateHorizontalScroll.bind(this);this.addManagedEventListeners({displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this),bodyHeightChanged:e,scrollGapChanged:t}),this.addManagedElementListeners(this.eBodyViewport,{scroll:e}),this.ctrlsSvc.whenReady(this,r=>{this.centerRowsCtrl=r.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}invalidateHorizontalScroll(){this.isHorizontalPositionInvalidated=!0}invalidateVerticalScroll(){this.isVerticalPositionInvalidated=!0}addScrollListener(){this.addHorizontalScrollListeners(),this.addVerticalScrollListeners()}addHorizontalScrollListeners(){this.addManagedElementListeners(this.centerRowsCtrl.eViewport,{scroll:this.onHScroll.bind(this,La)});for(const e of py){const t=this.ctrlsSvc.get(e);this.registerScrollPartner(t,this.onHScroll.bind(this,e))}}addVerticalScrollListeners(){const e=this.ctrlsSvc.get("fakeVScrollComp"),t=this.gos.get("debounceVerticalScrollbar"),r=t?yn(this,this.onVScroll.bind(this,La),hD):this.onVScroll.bind(this,La),n=t?yn(this,this.onVScroll.bind(this,dD),hD):this.onVScroll.bind(this,dD);this.addManagedElementListeners(this.eBodyViewport,{scroll:r}),this.registerScrollPartner(e,n)}registerScrollPartner(e,t){e.onScrollCallback(t)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){this.centerRowsCtrl!=null&&(e===void 0&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft()),this.setScrollLeftForAllContainersExceptCurrent(Math.abs(e)))}setScrollLeftForAllContainersExceptCurrent(e){for(const t of[...py,La]){if(this.lastScrollSource[1]===t)continue;const r=this.getViewportForSource(t);T0(r,e,this.enableRtl)}}getViewportForSource(e){return e===La?this.centerRowsCtrl.eViewport:this.ctrlsSvc.get(e).eViewport}isControllingScroll(e,t){return this.lastScrollSource[t]==null?(t===0?this.lastScrollSource[0]=e:this.lastScrollSource[1]=e,!0):this.lastScrollSource[t]===e}onHScroll(e){if(!this.isControllingScroll(e,1))return;const t=this.centerRowsCtrl.eViewport,{scrollLeft:r}=t;if(this.shouldBlockScrollUpdate(1,r,!0))return;const n=R0(this.getViewportForSource(e),this.enableRtl);this.doHorizontalScroll(n),this.resetLastHScrollDebounced()}onVScroll(e){if(!this.isControllingScroll(e,0))return;let t;if(e===La?t=this.eBodyViewport.scrollTop:t=this.ctrlsSvc.get("fakeVScrollComp").getScrollPosition(),this.shouldBlockScrollUpdate(0,t,!0))return;const{animationFrameSvc:r}=this;r?.setScrollTop(t),this.nextScrollTop=t,e===La?this.ctrlsSvc.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,r?.active?r.schedule():this.scrollGridIfNeeded(!0),this.resetLastVScrollDebounced()}doHorizontalScroll(e){const t=this.ctrlsSvc.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}isScrolling(){return this.isScrollActive}fireScrollEvent(e){const t={type:"bodyScroll",direction:e===1?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.isScrollActive=!0,this.eventSvc.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=window.setTimeout(()=>{this.scrollTimer=0,this.isScrollActive=!1,this.eventSvc.dispatchEvent({...t,type:"bodyScrollEnd"})},my)}shouldBlockScrollUpdate(e,t,r=!1){return r&&!Wl()?!1:e===0?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t)}shouldBlockVerticalScroll(e){const t=JS(this.eBodyViewport),{scrollHeight:r}=this.eBodyViewport;return e<0||e+t>r}shouldBlockHorizontalScroll(e){const t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:r}=this.centerRowsCtrl.eViewport;if(this.enableRtl){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>r}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){const e=this.scrollLeft;let t=!1;for(const r of py)if(this.getViewportForSource(r).scrollLeft!==e){t=!0;break}t&&this.onHScroll(La)}scrollGridIfNeeded(e=!1){const t=this.scrollTop!=this.nextScrollTop;return t&&(this.scrollTop=this.nextScrollTop,e&&this.invalidateVerticalScroll(),this.redrawRowsAfterScroll()),t}setHorizontalScrollPosition(e,t=!1){const n=this.centerRowsCtrl.eViewport.scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(this.enableRtl?e=e>0?0:n:e=Math.min(Math.max(e,0),n)),T0(this.centerRowsCtrl.eViewport,Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.invalidateVerticalScroll(),this.eBodyViewport.scrollTop=e}getVScrollPosition(){if(!this.isVerticalPositionInvalidated){const{lastOffsetHeight:r,lastScrollTop:n}=this;return{top:n,bottom:n+r}}this.isVerticalPositionInvalidated=!1;const{scrollTop:e,offsetHeight:t}=this.eBodyViewport;return this.lastScrollTop=e,this.lastOffsetHeight=t,{top:e,bottom:e+t}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.isHorizontalPositionInvalidated&&(this.lastIsHorizontalScrollShowing=this.centerRowsCtrl.isHorizontalScrollShowing(),this.isHorizontalPositionInvalidated=!1),this.lastIsHorizontalScrollShowing}scrollHorizontally(e){const t=this.centerRowsCtrl.eViewport.scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.eViewport.scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e,t=null){const{rowModel:r}=this.beans,n=r.getRowCount();let i=-1;for(let s=0;s<n;s++){const o=r.getRow(s);if(typeof e=="function"){if(o&&e(o)){i=s;break}}else if(e===o||e===o.data){i=s;break}}i>=0&&this.ensureIndexVisible(i,t)}ensureIndexVisible(e,t,r=0){if(bn(this.gos,"print"))return;const{rowModel:n}=this.beans,i=n.getRowCount();if(typeof e!="number"||e<0||e>=i){Me(88,{index:e});return}this.clearRetryListeners();const{frameworkOverrides:s,pageBounds:o,rowContainerHeight:a,rowRenderer:u}=this.beans;s.wrapIncoming(()=>{const d=this.ctrlsSvc.getGridBodyCtrl(),h=n.getRow(e);let g,m,v=0;this.invalidateVerticalScroll();do{const{stickyTopHeight:w,stickyBottomHeight:C}=d,b=h.rowTop,x=h.rowHeight,R=o.getPixelOffset(),E=h.rowTop-R,A=E+h.rowHeight,D=this.getVScrollPosition(),M=a.divStretchOffset,F=D.top+M,O=D.bottom+M,L=O-F,W=a.getScrollPositionForPixel(E),I=a.getScrollPositionForPixel(A-L),G=Math.min((W+I)/2,E),ne=F+w>E,ie=O-C<A;let J=null;t==="top"?J=W-w:t==="bottom"?J=I+C:t==="middle"?J=G:ne?J=W-w:ie&&(I-W>L?J=W-w:J=I+C),J!==null&&(this.setVerticalScrollPosition(J),u.redraw({afterScroll:!0})),g=b!==h.rowTop||x!==h.rowHeight,m=w!==d.stickyTopHeight||C!==d.stickyBottomHeight,v++}while((g||m)&&v<10);if(this.animationFrameSvc?.flushAllFrames(),r<10&&(h?.stub||!this.beans.rowAutoHeight?.areRowsMeasured())){const w=this.getVScrollPosition().top;this.clearRetryListenerFncs=this.addManagedEventListeners({bodyScroll:()=>{const C=this.getVScrollPosition().top;w!==C&&this.clearRetryListeners()},modelUpdated:()=>{this.clearRetryListeners(),!(e>=n.getRowCount())&&this.ensureIndexVisible(e,t,r+1)}})}})}clearRetryListeners(){for(const e of this.clearRetryListenerFncs)e();this.clearRetryListenerFncs=[]}ensureColumnVisible(e,t="auto"){const{colModel:r,frameworkOverrides:n}=this.beans,i=r.getCol(e);if(!i||i.isPinned()||!this.visibleCols.isColDisplayed(i))return;const s=this.getPositionedHorizontalScroll(i,t);n.wrapIncoming(()=>{s!==null&&this.centerRowsCtrl.setCenterViewportScrollLeft(s),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameSvc?.flushAllFrames()})}getPositionedHorizontalScroll(e,t){const{columnBeforeStart:r,columnAfterEnd:n}=this.isColumnOutsideViewport(e),i=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),s=this.centerRowsCtrl.getCenterWidth(),o=this.enableRtl;let a=(o?r:n)||i,u=o?n:r;t!=="auto"&&(a=t==="start",u=t==="end");const d=t==="middle";if(a||u||d){const{colLeft:h,colMiddle:g,colRight:m}=this.getColumnBounds(e);return d?g-s/2:a?o?m:h:o?h-s:m-s}return null}isColumnOutsideViewport(e){const{start:t,end:r}=this.getViewportBounds(),{colLeft:n,colRight:i}=this.getColumnBounds(e),s=this.enableRtl,o=s?t>i:r<i,a=s?r<n:t>n;return{columnBeforeStart:o,columnAfterEnd:a}}getColumnBounds(e){const t=this.enableRtl,r=this.visibleCols.bodyWidth,n=e.getActualWidth(),i=e.getLeft(),s=t?-1:1,o=t?r-i:i,a=o+n*s,u=o+n/2*s;return{colLeft:o,colMiddle:u,colRight:a}}getViewportBounds(){const e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft(),r=t,n=e+t;return{start:r,end:n,width:e}}},Ex=class extends Ee{constructor(e,t=!1){super(),this.callback=e,this.addSpacer=t}postConstruct(){const e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedEventListeners({columnContainerWidthChanged:e,displayedColumnsChanged:e,leftPinnedWidthChanged:e}),this.addSpacer&&this.addManagedEventListeners({rightPinnedWidthChanged:e,scrollVisibilityChanged:e,scrollbarWidthChanged:e}),this.setWidth()}setWidth(){const e=bn(this.gos,"print"),{visibleCols:t,scrollVisibleSvc:r}=this.beans,n=t.bodyWidth,i=t.getColsLeftWidth(),s=t.getDisplayedColumnsRightWidth();let o;e?o=n+i+s:(o=n,this.addSpacer&&(this.gos.get("enableRtl")?i:s)===0&&r.verticalScrollShowing&&(o+=r.getScrollbarWidth())),this.callback(o)}},TU=class extends Ee{constructor(e){super(),this.centerContainerCtrl=e}wireBeans(e){this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()}),this.addManagedEventListeners({scrollbarWidthChanged:this.onScrollbarWidthChanged.bind(this)}),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){const{beans:e,centerContainerCtrl:t,gridBodyCtrl:r}=this,n=()=>{Jo(e,()=>{this.onCenterViewportResized()})};t.registerViewportResizeListener(n),r.registerBodyViewportResizeListener(n)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.scrollVisibleSvc.updateScrollGap(),this.centerContainerCtrl.isViewportInTheDOMTree()){const{pinnedCols:e,colFlex:t}=this.beans;e?.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();const r=this.centerContainerCtrl.getCenterWidth();r!==this.centerWidth&&(this.centerWidth=r,t?.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.scrollFeature.checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const e=this.gridBodyCtrl.eBodyViewport,t=JS(e);this.bodyHeight!==t&&(this.bodyHeight=t,this.eventSvc.dispatchEvent({type:"bodyHeightChanged"}))}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){if(!this.isAlive())return;const e={horizontalScrollShowing:this.centerContainerCtrl.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleSvc.setScrollsVisible(e)}onHorizontalViewportChanged(){const e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.beans.colViewport.setScrollPosition(e,t)}};function a0(e,t,r,n){const i=t.getColDef().cellRendererParams?.suppressMouseEventHandling;return J_(e,t,r,n,i)}function FU(e,t,r,n){const i=t?.suppressMouseEventHandling;return J_(e,void 0,r,n,i)}function J_(e,t,r,n,i){return i?i(it(e,{column:t,node:r,event:n})):!1}function eL(e,t,r){let n=t;for(;n;){const i=r_(e,n,r);if(i)return i;n=n.parentElement}return null}var G0="cellCtrl";function Rx(e,t){return eL(e,t,G0)}var V0="renderedRow";function DU(e,t){return eL(e,t,V0)}function Ob(e,t,r,n,i){const s=n?n.getColDef().suppressKeyboardEvent:void 0;if(!s)return!1;const o=it(e,{event:t,editing:i,column:n,node:r,data:r.data,colDef:n.getColDef()});return!!(s&&s(o))}function AU(e){const{pinnedRowModel:t,rowModel:r}=e,[n,i]=[t?.isEmpty("top")??!0,t?.isEmpty("bottom")??!0],s=n?null:"top";let o,a;i?(o=null,a=r.getRowCount()-1):(o="bottom",a=t?.getPinnedBottomRowCount()??-1);const{visibleCols:u,rangeSvc:d}=e,h=u.allCols;!d||!h?.length||d.setCellRange({rowStartIndex:0,rowStartPinned:s,rowEndIndex:a,rowEndPinned:o})}var kU=65,PU=67,MU=86,_U=68,LU=90,IU=89;function OU(e){const{keyCode:t}=e;let r;switch(t){case kU:r=me.A;break;case PU:r=me.C;break;case MU:r=me.V;break;case _U:r=me.D;break;case LU:r=me.Z;break;case IU:r=me.Y;break;default:r=e.code}return r}var NU=class extends Ee{constructor(e){super(),this.element=e}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.beans.touchSvc?.mockRowContextMenu(this),this.editSvc=this.beans.editSvc}addKeyboardListeners(){const e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}addMouseListeners(){const t=["dblclick","contextmenu","mouseover","mouseout","click",GM("touchstart")?"touchstart":"mousedown"];for(const r of t){const n=this.processMouseEvent.bind(this,r);this.addManagedElementListeners(this.element,{[r]:n})}}processMouseEvent(e,t){if(!cf(this.beans,t)||zo(t))return;const{cellCtrl:r,rowCtrl:n}=this.getControlsForEventTarget(t.target);e==="contextmenu"?(r?.column&&r.dispatchCellContextMenuEvent(t),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(t,void 0,n,r)):(r&&r.onMouseEvent(e,t),n&&n.onMouseEvent(e,t))}getControlsForEventTarget(e){const{gos:t}=this;return{cellCtrl:Rx(t,e),rowCtrl:DU(t,e)}}processKeyboardEvent(e,t){const{cellCtrl:r,rowCtrl:n}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(r?this.processCellKeyboardEvent(r,e,t):n?.isFullWidth()&&this.processFullWidthRowKeyboardEvent(n,e,t))}processCellKeyboardEvent(e,t,r){const n=this.editSvc?.isEditing(e,{withOpenEditor:!0})??!1;!Ob(this.gos,r,e.rowNode,e.column,n)&&t==="keydown"&&(!n&&this.beans.navigation?.handlePageScrollingKey(r)||e.onKeyDown(r),this.doGridOperations(r,n),k_(r)&&e.processCharacter(r)),t==="keydown"&&this.eventSvc.dispatchEvent(e.createEvent(r,"cellKeyDown"))}processFullWidthRowKeyboardEvent(e,t,r){const{rowNode:n}=e,{focusSvc:i,navigation:s}=this.beans,a=i.getFocusedCell()?.column;if(!Ob(this.gos,r,n,a,!1)){const d=r.key;if(t==="keydown")switch(d){case me.PAGE_HOME:case me.PAGE_END:case me.PAGE_UP:case me.PAGE_DOWN:s?.handlePageScrollingKey(r,!0);break;case me.LEFT:case me.RIGHT:if(!this.gos.get("embedFullWidthRows"))break;case me.UP:case me.DOWN:e.onKeyboardNavigate(r);break;case me.TAB:e.onTabKeyDown(r);break}}t==="keydown"&&this.eventSvc.dispatchEvent(e.createRowEvent("cellKeyDown",r))}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey||t||!cf(this.beans,e))return;const r=OU(e),{clipboardSvc:n,undoRedo:i}=this.beans;if(r===me.A)return this.onCtrlAndA(e);if(r===me.C)return this.onCtrlAndC(n,e);if(r===me.D)return this.onCtrlAndD(n,e);if(r===me.V)return this.onCtrlAndV(n,e);if(r===me.X)return this.onCtrlAndX(n,e);if(r===me.Y)return this.onCtrlAndY(i);if(r===me.Z)return this.onCtrlAndZ(i,e)}onCtrlAndA(e){const{beans:{rowModel:t,rangeSvc:r,selectionSvc:n},gos:i}=this;r&&ja(i)&&!D7(i)&&t.isRowsToRender()?AU(this.beans):n&&n.selectAllRowNodes({source:"keyboardSelectAll",selectAll:l_(i)}),e.preventDefault()}onCtrlAndC(e,t){if(!e||this.gos.get("enableCellTextSelection"))return;const{cellCtrl:r}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(r,{withOpenEditor:!0})||(t.preventDefault(),e.copyToClipboard())}onCtrlAndX(e,t){if(!e||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;const{cellCtrl:r}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(r,{withOpenEditor:!0})||(t.preventDefault(),e.cutToClipboard(void 0,"ui"))}onCtrlAndV(e,t){const{cellCtrl:r}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(r,{withOpenEditor:!0})||e&&!this.gos.get("suppressClipboardPaste")&&e.pasteFromClipboard()}onCtrlAndD(e,t){e&&!this.gos.get("suppressClipboardPaste")&&e.copyRangeDown(),t.preventDefault()}onCtrlAndZ(e,t){!this.gos.get("undoRedoCellEditing")||!e||(t.preventDefault(),t.shiftKey?e.redo("ui"):e.undo("ui"))}onCtrlAndY(e){e?.redo("ui")}},tL=class extends Ee{constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedEventListeners({rowContainerHeightChanged:this.onHeightChanged.bind(this,this.beans.rowContainerHeight)})}onHeightChanged(e){const t=e.uiContainerHeight,r=t!=null?`${t}px`:"";this.eContainer.style.height=r,this.eViewport&&(this.eViewport.style.height=r)}},Dp=e=>e.topRowCtrls,Ap=e=>e.getStickyTopRowCtrls(),kp=e=>e.getStickyBottomRowCtrls(),Pp=e=>e.bottomRowCtrls,Mp=e=>e.allRowCtrls,vy=e=>e.getCtrls("top"),wy=e=>e.getCtrls("center"),Cy=e=>e.getCtrls("bottom"),BU={center:{type:"center",name:"center-cols",getRowCtrls:Mp,getSpannedRowCtrls:wy},left:{type:"left",name:"pinned-left-cols",pinnedType:"left",getRowCtrls:Mp,getSpannedRowCtrls:wy},right:{type:"right",name:"pinned-right-cols",pinnedType:"right",getRowCtrls:Mp,getSpannedRowCtrls:wy},fullWidth:{type:"fullWidth",name:"full-width",fullWidth:!0,getRowCtrls:Mp},topCenter:{type:"center",name:"floating-top",getRowCtrls:Dp,getSpannedRowCtrls:vy},topLeft:{type:"left",name:"pinned-left-floating",container:"ag-pinned-left-floating-top",pinnedType:"left",getRowCtrls:Dp,getSpannedRowCtrls:vy},topRight:{type:"right",name:"pinned-right-floating",container:"ag-pinned-right-floating-top",pinnedType:"right",getRowCtrls:Dp,getSpannedRowCtrls:vy},topFullWidth:{type:"fullWidth",name:"floating-top-full-width",fullWidth:!0,getRowCtrls:Dp},stickyTopCenter:{type:"center",name:"sticky-top",getRowCtrls:Ap},stickyTopLeft:{type:"left",name:"pinned-left-sticky-top",container:"ag-pinned-left-sticky-top",pinnedType:"left",getRowCtrls:Ap},stickyTopRight:{type:"right",name:"pinned-right-sticky-top",container:"ag-pinned-right-sticky-top",pinnedType:"right",getRowCtrls:Ap},stickyTopFullWidth:{type:"fullWidth",name:"sticky-top-full-width",fullWidth:!0,getRowCtrls:Ap},stickyBottomCenter:{type:"center",name:"sticky-bottom",getRowCtrls:kp},stickyBottomLeft:{type:"left",name:"pinned-left-sticky-bottom",container:"ag-pinned-left-sticky-bottom",pinnedType:"left",getRowCtrls:kp},stickyBottomRight:{type:"right",name:"pinned-right-sticky-bottom",container:"ag-pinned-right-sticky-bottom",pinnedType:"right",getRowCtrls:kp},stickyBottomFullWidth:{type:"fullWidth",name:"sticky-bottom-full-width",fullWidth:!0,getRowCtrls:kp},bottomCenter:{type:"center",name:"floating-bottom",getRowCtrls:Pp,getSpannedRowCtrls:Cy},bottomLeft:{type:"left",name:"pinned-left-floating-bottom",container:"ag-pinned-left-floating-bottom",pinnedType:"left",getRowCtrls:Pp,getSpannedRowCtrls:Cy},bottomRight:{type:"right",name:"pinned-right-floating-bottom",container:"ag-pinned-right-floating-bottom",pinnedType:"right",getRowCtrls:Pp,getSpannedRowCtrls:Cy},bottomFullWidth:{type:"fullWidth",name:"floating-bottom-full-width",fullWidth:!0,getRowCtrls:Pp}};function rL(e){return`ag-${Wf(e).name}-viewport`}function l0(e){const t=Wf(e);return t.container??`ag-${t.name}-container`}function HU(e){return`ag-${Wf(e).name}-spanned-cells-container`}function Wf(e){return BU[e]}var GU=["topCenter","topLeft","topRight"],VU=["bottomCenter","bottomLeft","bottomRight"],zU=["center","left","right"],WU=["center","left","right","fullWidth"],UU=["stickyTopCenter","stickyBottomCenter","center","topCenter","bottomCenter"],$U=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],jU=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],nL=["stickyTopCenter","stickyTopLeft","stickyTopRight"],iL=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],YU=[...nL,"stickyTopFullWidth",...iL,"stickyBottomFullWidth"],KU=[...GU,...VU,...zU,...nL,...iL],qU=class extends Ee{constructor(e){super(),this.name=e,this.visible=!0,this.EMPTY_CTRLS=[],this.options=Wf(e)}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>{this.viewportSizeFeature=this.createManagedBean(new TU(this)),this.addManagedEventListeners({stickyTopOffsetChanged:this.onStickyTopOffsetChanged.bind(this)})})}onStickyTopOffsetChanged(e){this.comp.setOffsetTop(`${e.offset}px`)}registerWithCtrlsService(){this.options.fullWidth||this.beans.ctrlsSvc.register(this.name,this)}forContainers(e,t){e.indexOf(this.name)>=0&&t()}setComp(e,t,r,n){this.comp=e,this.eContainer=t,this.eSpannedContainer=r,this.eViewport=n,this.createManagedBean(new NU(this.eViewport??this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder();const{pinnedCols:i,rangeSvc:s}=this.beans,o=()=>this.onPinnedWidthChanged();this.forContainers($U,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(i?.createPinnedWidthFeature(!0,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({leftPinnedWidthChanged:o})}),this.forContainers(jU,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(i?.createPinnedWidthFeature(!1,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({rightPinnedWidthChanged:o})}),this.forContainers(WU,()=>this.createManagedBean(new tL(this.eContainer,this.name==="center"?n:void 0))),s&&this.forContainers(KU,()=>this.createManagedBean(s.createDragListenerFeature(this.eContainer))),this.forContainers(UU,()=>this.createManagedBean(new Ex(a=>this.comp.setContainerWidth(`${a}px`)))),this.visible=this.isContainerVisible(),this.addListeners(),this.registerWithCtrlsService()}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}addListeners(){const{spannedRowRenderer:e,gos:t}=this.beans,r=this.onDisplayedColumnsChanged.bind(this);this.addManagedEventListeners({displayedColumnsChanged:r,displayedColumnsWidthChanged:r,displayedRowsChanged:n=>this.onDisplayedRowsChanged(n.afterScroll)}),r(),this.onDisplayedRowsChanged(),e&&this.options.getSpannedRowCtrls&&t.get("enableCellSpan")&&this.addManagedListeners(e,{spannedRowsUpdated:()=>{const n=this.options.getSpannedRowCtrls(e);n&&this.comp.setSpannedRowCtrls(n,!1)}})}listenOnDomOrder(){if(YU.indexOf(this.name)>=0){this.comp.setDomOrder(!0);return}const t=()=>{const r=this.gos.get("ensureDomOrder"),n=bn(this.gos,"print");this.comp.setDomOrder(r||n)};this.addManagedPropertyListener("domLayout",t),t()}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){const{dragSvc:e}=this.beans;if(!e)return;const t=r=>{e.dragging&&r.cancelable&&r.preventDefault()};this.eContainer.addEventListener("touchmove",t,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",t))}onHorizontalViewportChanged(e=!1){const t=this.getCenterWidth(),r=this.getCenterViewportScrollLeft();this.beans.colViewport.setScrollPosition(t,r,e)}hasHorizontalScrollGap(){return this.eContainer.clientWidth-this.eViewport.clientWidth<0}hasVerticalScrollGap(){return this.eContainer.clientHeight-this.eViewport.clientHeight<0}getCenterWidth(){return lf(this.eViewport)}getCenterViewportScrollLeft(){return R0(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){const t=Zo(this.beans,this.eViewport,e);this.addDestroyFunc(()=>t())}isViewportInTheDOMTree(){return NM(this.eViewport)}getViewportScrollLeft(){return R0(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||tx(this.eViewport)}setHorizontalScroll(e){this.comp.setHorizontalScroll(e)}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){T0(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!(this.options.pinnedType!=null)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(e=!1){const t=this.options.getRowCtrls(this.beans.rowRenderer);if(!this.visible||t.length===0){this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});return}const r=bn(this.gos,"print"),i=this.gos.get("embedFullWidthRows")||r,s=t.filter(o=>{const a=o.isFullWidth();return this.options.fullWidth?!i&&a:i||!a});this.comp.setRowCtrls({rowCtrls:s,useFlushSync:e})}},XU="ag-force-vertical-scroll",QU="ag-selectable",ZU="ag-column-moving",JU=class extends Ee{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colModel=e.colModel,this.scrollVisibleSvc=e.scrollVisibleSvc,this.pinnedRowModel=e.pinnedRowModel,this.filterManager=e.filterManager,this.rowGroupColsSvc=e.rowGroupColsSvc}setComp(e,t,r,n,i,s,o){this.comp=e,this.eGridBody=t,this.eBodyViewport=r,this.eTop=n,this.eBottom=i,this.eStickyTop=s,this.eStickyBottom=o,this.eCenterColsViewport=r.querySelector(`.${rL("center")}`),this.eFullWidthContainer=r.querySelector(`.${l0("fullWidth")}`),this.eStickyTopFullWidthContainer=s.querySelector(`.${l0("stickyTopFullWidth")}`),this.eStickyBottomFullWidthContainer=o.querySelector(`.${l0("stickyBottomFullWidth")}`),this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",a=>this.setCellTextSelection(a.currentValue)),this.createManagedBean(new xx(this.comp)),this.scrollFeature=this.createManagedBean(new RU(r)),this.beans.rowDragSvc?.setupRowDrag(r,this),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([n,r,i,s,o]),this.setGridRootRole(),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.updateScrollingClasses(),this.filterManager?.setupAdvFilterHeaderComp(n),this.ctrlsSvc.register("gridBodyCtrl",this)}addEventListeners(){const e=this.setFloatingHeights.bind(this),t=this.setGridRootRole.bind(this),r=this.toggleRowResizeStyles.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this),scrollGapChanged:this.updateScrollingClasses.bind(this),pinnedRowDataChanged:e,pinnedHeightChanged:e,pinnedRowsChanged:e,headerHeightChanged:this.setStickyTopOffsetTop.bind(this),columnRowGroupChanged:t,columnPivotChanged:t,rowResizeStarted:r,rowResizeEnded:r}),this.addManagedPropertyListener("treeData",t)}toggleRowResizeStyles(e){const t=e.type==="rowResizeStarted";this.eBodyViewport.classList.toggle("ag-prevent-animation",t)}onGridColumnsChanged(){const e=this.beans.colModel.getCols();this.comp.setColumnCount(e.length)}onScrollVisibilityChanged(){const{scrollVisibleSvc:e}=this,t=e.verticalScrollShowing;this.setVerticalScrollPaddingVisible(t),this.setStickyWidth(t),this.setStickyBottomOffsetBottom();const r=t&&e.getScrollbarWidth()||0,n=A_()?16:0,i=`calc(100% + ${r+n}px)`;Jo(this.beans,()=>this.comp.setBodyViewportWidth(i)),this.updateScrollingClasses()}setGridRootRole(){const{rowGroupColsSvc:e,colModel:t}=this;let r=this.gos.get("treeData");if(!r){const n=t.isPivotMode();r=(e?e.columns.length:0)>=(n?2:1)}this.comp.setGridRootRole(r?"treegrid":"grid")}addFocusListeners(e){for(const t of e)this.addManagedElementListeners(t,{focusin:r=>{const{target:n}=r,i=Hl(n,"ag-root",t);t.classList.toggle("ag-has-focus",!i)},focusout:r=>{const{target:n,relatedTarget:i}=r,s=t.contains(i),o=Hl(i,"ag-root",t);Hl(n,"ag-root",t)||(!s||o)&&t.classList.remove("ag-has-focus")}})}setColumnMovingCss(e){this.comp.setColumnMovingCss(ZU,e)}setCellTextSelection(e=!1){this.comp.setCellSelectableCss(QU,e)}updateScrollingClasses(){const{eGridBody:{classList:e},scrollVisibleSvc:t}=this;e.toggle("ag-body-vertical-content-no-gap",!t.verticalScrollGap),e.toggle("ag-body-horizontal-content-no-gap",!t.horizontalScrollGap)}disableBrowserDragging(){this.addManagedElementListeners(this.eGridBody,{dragstart:e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}})}addStopEditingWhenGridLosesFocus(){this.beans.editSvc?.addStopEditingWhenGridLosesFocus([this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom])}updateRowCount(){const e=(this.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.filterManager?.getHeaderRowCount()??0),{rowModel:t}=this.beans,r=t.isLastRowIndexKnown()?t.getRowCount():-1,n=r===-1?-1:e+r;this.comp.setRowCount(n)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){const t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){const e=this.gos.get("alwaysShowVerticalScroll"),t=e?XU:null,r=bn(this.gos,"normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||r&&BM(this.eBodyViewport)}setupRowAnimationCssClass(){const{rowContainerHeight:e,environment:t}=this.beans;let r=t.sizesMeasured;const n=()=>{const i=r&&Pu(this.gos)&&!e.stretching,s=i?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(s,i)};n(),this.addManagedEventListeners({heightScaleChanged:n}),this.addManagedPropertyListener("animateRows",n),this.addManagedEventListeners({gridStylesChanged:()=>{!r&&t.sizesMeasured&&(r=!0,n())}})}addBodyViewportListener(){const{eBodyViewport:e,eStickyTop:t,eStickyBottom:r,eTop:n,eBottom:i,beans:{popupSvc:s,touchSvc:o}}=this,a=this.onBodyViewportContextMenu.bind(this);this.addManagedElementListeners(e,{contextmenu:a}),o?.mockBodyContextMenu(this,a),this.addManagedElementListeners(e,{wheel:this.onBodyViewportWheel.bind(this,s)});const u=this.onStickyWheel.bind(this);for(const h of[t,r,n,i])this.addManagedElementListeners(h,{wheel:u});const d=this.onHorizontalWheel.bind(this);for(const h of["left","right","topLeft","topRight","bottomLeft","bottomRight"])this.addManagedElementListeners(this.ctrlsSvc.get(h).eContainer,{wheel:d});this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){this.addManagedElementListeners(this.eFullWidthContainer,{wheel:e=>this.onFullWidthContainerWheel(e)})}onFullWidthContainerWheel(e){const{deltaX:t,deltaY:r,shiftKey:n}=e;(n||Math.abs(t)>Math.abs(r))&&cf(this.beans,e)&&this.scrollGridBodyToMatchEvent(e)}onStickyWheel(e){const{deltaY:t}=e;this.scrollVertically(t)>0&&e.preventDefault()}onHorizontalWheel(e){const{deltaX:t,deltaY:r,shiftKey:n}=e;(n||Math.abs(t)>Math.abs(r))&&this.scrollGridBodyToMatchEvent(e)}scrollGridBodyToMatchEvent(e){const{deltaX:t,deltaY:r}=e;e.preventDefault(),this.eCenterColsViewport.scrollBy({left:t||r})}onBodyViewportContextMenu(e,t,r){if(!e&&!r)return;this.gos.get("preventDefaultOnContextMenu")&&(e||r).preventDefault();const{target:n}=e||t;(n===this.eBodyViewport||n===this.ctrlsSvc.get("center").eViewport)&&this.beans.contextMenuSvc?.showContextMenu({mouseEvent:e,touchEvent:r,value:null,anchorToElement:this.eGridBody,source:"ui"})}onBodyViewportWheel(e,t){this.gos.get("suppressScrollWhenPopupsAreOpen")&&e?.hasAnchoredPopup()&&t.preventDefault()}scrollVertically(e){const t=this.eBodyViewport.scrollTop;return this.scrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}setFloatingHeights(){const{pinnedRowModel:e,beans:{environment:t}}=this,r=e?.getPinnedTopTotalHeight(),n=e?.getPinnedBottomTotalHeight(),i=t.getPinnedRowBorderWidth(),s=t.getRowBorderWidth(),o=i-s,a=r?o+r:0,u=n?o+n:0;this.comp.setTopHeight(a),this.comp.setBottomHeight(u),this.comp.setTopInvisible(a<=0),this.comp.setBottomInvisible(u<=0),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(e=0){this.comp.setStickyTopHeight(`${e}px`),this.stickyTopHeight=e}setStickyBottomHeight(e=0){this.comp.setStickyBottomHeight(`${e}px`),this.stickyBottomHeight=e}setStickyWidth(e){if(!e)this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%");else{const t=this.scrollVisibleSvc.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${t}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${t}px)`)}}setStickyTopOffsetTop(){const t=this.ctrlsSvc.get("gridHeaderCtrl").headerHeight+(this.filterManager?.getHeaderHeight()??0),r=this.pinnedRowModel?.getPinnedTopTotalHeight()??0;let n=0;t>0&&(n+=t),r>0&&(n+=r),n>0&&(n+=1),this.comp.setStickyTopTop(`${n}px`)}setStickyBottomOffsetBottom(){const{pinnedRowModel:e,scrollVisibleSvc:t,comp:r}=this,n=e?.getPinnedBottomTotalHeight()??0,s=t.horizontalScrollShowing&&t.getScrollbarWidth()||0,o=n+s;r.setStickyBottomBottom(`${o}px`)}};function e$(e,t){return Rx(e,t.target)?.getFocusedCellPosition()??null}function fD(e,t){const r=bn(e.gos,"normal"),n=t;let i,s;n.clientX!=null||n.clientY!=null?(i=n.clientX,s=n.clientY):(i=n.x,s=n.y);const{pageFirstPixel:o}=e.pageBounds.getCurrentPagePixelRange();if(s+=o,r){const a=e.ctrlsSvc.getScrollFeature(),u=a.getVScrollPosition(),d=a.getHScrollPosition();i+=d.left,s+=u.top}return{x:i,y:s}}var sL=class extends Dr{constructor(e,t){super(),this.direction=t,this.eViewport=tt,this.eContainer=tt,this.hideTimeout=0,this.setTemplate(e)}postConstruct(){this.addManagedEventListeners({scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this)}),this.onScrollVisibilityChanged(),this.toggleCss("ag-apple-scrollbar",F_()||Wl())}destroy(){super.destroy(),window.clearTimeout(this.hideTimeout)}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.invisibleScrollbar=A_(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const e=this.getGui(),t=()=>this.toggleCss("ag-scrollbar-active",!0),r=()=>this.toggleCss("ag-scrollbar-active",!1);this.addManagedListeners(e,{mouseenter:t,mousedown:t,touchstart:t,mouseleave:r,touchend:r})}onScrollVisibilityChanged(){this.invisibleScrollbar===void 0&&this.initialiseInvisibleScrollbar(),Jo(this.beans,()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedEventListeners({bodyScroll:e=>{e.direction===this.direction&&(this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=0),this.toggleCss("ag-scrollbar-scrolling",!0))},bodyScrollEnd:()=>{this.hideTimeout=window.setTimeout(()=>{this.toggleCss("ag-scrollbar-scrolling",!1),this.hideTimeout=0},400)}})}attemptSettingScrollPosition(e){const t=this.eViewport;t7(this,()=>Qo(t),()=>this.setScrollPosition(e),100)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}},t$={tag:"div",cls:"ag-body-horizontal-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eLeftSpacer",cls:"ag-horizontal-left-spacer"},{tag:"div",ref:"eViewport",cls:"ag-body-horizontal-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-horizontal-scroll-container"}]},{tag:"div",ref:"eRightSpacer",cls:"ag-horizontal-right-spacer"}]},r$=class extends sL{constructor(){super(t$,"horizontal"),this.eLeftSpacer=tt,this.eRightSpacer=tt,this.setScrollVisibleDebounce=0}wireBeans(e){this.visibleCols=e.visibleCols,this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){super.postConstruct();const e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e,pinnedRowDataChanged:this.refreshCompBottom.bind(this)}),this.addManagedPropertyListener("domLayout",e),this.beans.ctrlsSvc.register("fakeHScrollComp",this),this.createManagedBean(new Ex(t=>this.eContainer.style.width=`${t}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}destroy(){window.clearTimeout(this.setScrollVisibleDebounce),super.destroy()}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}refreshCompBottom(){if(!this.invisibleScrollbar)return;const e=this.beans.pinnedRowModel?.getPinnedBottomTotalHeight()??0;this.getGui().style.bottom=`${e}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const e=this.scrollVisibleSvc.verticalScrollShowing;let t=this.visibleCols.getDisplayedColumnsRightWidth();const r=!this.enableRtl&&e,n=this.scrollVisibleSvc.getScrollbarWidth();r&&(t+=n),Js(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=n);let i=this.visibleCols.getColsLeftWidth();this.enableRtl&&e&&(i+=n),Js(this.eLeftSpacer,i),this.eLeftSpacer.classList.toggle("ag-scroller-corner",i<=n)}setScrollVisible(){const e=this.scrollVisibleSvc.horizontalScrollShowing,t=this.invisibleScrollbar,r=this.gos.get("suppressHorizontalScroll"),n=e&&this.scrollVisibleSvc.getScrollbarWidth()||0,s=r?0:n===0&&t?16:n,o=()=>{this.setScrollVisibleDebounce=0,this.toggleCss("ag-scrollbar-invisible",t),Oh(this.getGui(),s),Oh(this.eViewport,s),Oh(this.eContainer,s),s||this.eContainer.style.setProperty("min-height","1px"),this.setVisible(e,{skipAriaHidden:!0})};window.clearTimeout(this.setScrollVisibleDebounce),e?this.setScrollVisibleDebounce=window.setTimeout(o,100):o()}getScrollPosition(){return R0(this.eViewport,this.enableRtl)}setScrollPosition(e){Qo(this.eViewport)||this.attemptSettingScrollPosition(e),T0(this.eViewport,e,this.enableRtl)}},n$={tag:"div",cls:"ag-body-vertical-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eViewport",cls:"ag-body-vertical-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-vertical-scroll-container"}]}]},i$=class extends sL{constructor(){super(n$,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new tL(this.eContainer));const{ctrlsSvc:e}=this.beans;e.register("fakeVScrollComp",this),this.addManagedEventListeners({rowContainerHeightChanged:this.onRowContainerHeightChanged.bind(this,e)})}setScrollVisible(){const{scrollVisibleSvc:e}=this.beans,t=e.verticalScrollShowing,r=this.invisibleScrollbar,n=t&&e.getScrollbarWidth()||0,i=n===0&&r?16:n;this.toggleCss("ag-scrollbar-invisible",r),Js(this.getGui(),i),Js(this.eViewport,i),Js(this.eContainer,i),this.setDisplayed(t,{skipAriaHidden:!0})}onRowContainerHeightChanged(e){const r=e.getGridBodyCtrl().eBodyViewport,n=this.getScrollPosition(),i=r.scrollTop;n!=i&&this.setScrollPosition(i,!0)}getScrollPosition(){return this.eViewport.scrollTop}setScrollPosition(e,t){!t&&!Qo(this.eViewport)&&this.attemptSettingScrollPosition(e),this.eViewport.scrollTop=e}},s$="ag-column-first",o$="ag-column-last";function oL(e,t,r,n){return xr(e)?[]:l$(e.headerClass,e,t,r,n)}function aL(e,t,r){e.toggleCss(s$,r.isColAtEdge(t,"first")),e.toggleCss(o$,r.isColAtEdge(t,"last"))}function a$(e,t,r,n){return it(t,{colDef:e,column:r,columnGroup:n})}function l$(e,t,r,n,i){if(xr(e))return[];let s;if(typeof e=="function"){const o=a$(t,r,n,i);s=e(o)}else s=e;return typeof s=="string"?[s]:Array.isArray(s)?[...s]:[]}function c$(e,t,r){t.addManagedElementListeners(r,{keydown:n=>{if(!n.defaultPrevented&&n.key===me.TAB){const i=n.shiftKey;vc(e,r,!1,i)||td(e,i)&&n.preventDefault()}}})}function u$(e,t){return e.ctrlsSvc.get("gridCtrl").focusInnerElement(t)}function Ul(e){return e.gos.get("suppressHeaderFocus")||!!e.overlays?.isExclusive()}function Xm(e){return e.gos.get("suppressCellFocus")||!!e.overlays?.isExclusive()}function td(e,t,r=!1){const n=e.ctrlsSvc.get("gridCtrl");return!r&&n.focusNextInnerContainer(t)?!0:((r||!t&&!n.isDetailGrid())&&n.forceFocusOutOfContainer(t),!1)}function qs(e){return e.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0}function Tx(e){const t=[],r=e.ctrlsSvc.getHeaderRowContainerCtrls();for(const n of r){if(!n)continue;const i=n.getGroupRowCount()||0;for(let s=0;s<i;s++){const o=n.getGroupRowCtrlAtIndex(s),a=t[s];if(o){const u=d$(e,o);(a==null||u>a)&&(t[s]=u)}}}return t}function d$(e,t){let n=e.colModel.isPivotMode()?f$(e):cL(e);const i=t.getHeaderCellCtrls();for(const s of i){const{column:o}=s,a=o.getAutoHeaderHeight();a!=null&&a>n&&o.isAutoHeaderHeight()&&(n=a)}return n}function Fx(e){let r=e.colModel.isPivotMode()?h$(e):Uf(e);return e.colModel.forAllCols(n=>{const i=n.getAutoHeaderHeight();i!=null&&i>r&&n.isAutoHeaderHeight()&&(r=i)}),r}function Uf(e){return e.gos.get("headerHeight")??e.environment.getDefaultHeaderHeight()}function lL(e){return e.gos.get("floatingFiltersHeight")??Uf(e)}function cL(e){return e.gos.get("groupHeaderHeight")??Uf(e)}function h$(e){return e.gos.get("pivotHeaderHeight")??Uf(e)}function f$(e){return e.gos.get("pivotGroupHeaderHeight")??cL(e)}function g$(e,t){return e.headerRowIndex===t.headerRowIndex&&e.column===t.column}var p$=class extends Ee{setComp(e,t,r){this.comp=e,this.eGui=t;const{beans:n}=this,{headerNavigation:i,touchSvc:s,ctrlsSvc:o}=n;i&&this.createManagedBean(new wd(r,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedEventListeners({columnPivotModeChanged:this.onPivotModeChanged.bind(this,n),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this,n)}),this.onPivotModeChanged(n),this.setupHeaderHeight();const a=this.onHeaderContextMenu.bind(this);this.addManagedElementListeners(this.eGui,{contextmenu:a}),s?.mockHeaderContextMenu(this,a),o.register("gridHeaderCtrl",this)}setupHeaderHeight(){const e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],e),this.addManagedEventListeners({headerRowsChanged:e,columnHeaderHeightChanged:e,columnGroupHeaderHeightChanged:()=>Jo(this.beans,()=>e()),gridStylesChanged:e,advancedFilterEnabledChanged:e})}setHeaderHeight(){const{beans:e}=this;let t=0;const r=Tx(e).reduce((s,o)=>s+o,0),n=Fx(e);if(e.filterManager?.hasFloatingFilters()&&(t+=lL(e)),t+=r,t+=n,this.headerHeight===t)return;this.headerHeight=t;const i=`${t+1}px`;this.comp.setHeightAndMinHeight(i),this.eventSvc.dispatchEvent({type:"headerHeightChanged"})}onPivotModeChanged(e){const t=e.colModel.isPivotMode();this.comp.toggleCss("ag-pivot-on",t),this.comp.toggleCss("ag-pivot-off",!t)}onDisplayedColumnsChanged(e){const r=e.visibleCols.allCols.some(n=>n.isSpanHeaderHeight());this.comp.toggleCss("ag-header-allow-overflow",r)}onTabKeyDown(e){const t=this.gos.get("enableRtl"),r=e.shiftKey,n=r!==t?"LEFT":"RIGHT",{beans:i}=this,{headerNavigation:s,focusSvc:o}=i;(s.navigateHorizontally(n,!0,e)||!r&&o.focusOverlay(!1)||td(i,r,!0))&&e.preventDefault()}handleKeyDown(e){let t=null;const{headerNavigation:r}=this.beans;switch(e.key){case me.LEFT:t="LEFT";case me.RIGHT:{$e(t)||(t="RIGHT"),r.navigateHorizontally(t,!1,e)&&e.preventDefault();break}case me.UP:t="UP";case me.DOWN:{$e(t)||(t="DOWN"),r.navigateVertically(t,e)&&e.preventDefault();break}default:return}}onFocusOut(e){const{relatedTarget:t}=e,{eGui:r,beans:n}=this;!t&&r.contains(Fr(n))||r.contains(t)||(n.focusSvc.focusedHeader=null)}onHeaderContextMenu(e,t,r){const{menuSvc:n,ctrlsSvc:i}=this.beans;if(!e&&!r||!n?.isHeaderContextMenuEnabled())return;const{target:s}=e??t;(s===this.eGui||s===i.getHeaderRowContainerCtrl()?.eViewport)&&n.showHeaderContextMenu(void 0,e,r)}},Dx=class extends Ee{constructor(e,t,r,n){super(),this.columnOrGroup=e,this.eCell=t,this.colsSpanning=n,this.columnOrGroup=e,this.ariaEl=t.querySelector("[role=columnheader]")||t,this.beans=r}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){const{beans:e,colsSpanning:t}=this;return e.gos.get("enableRtl")&&t?ir(t):this.columnOrGroup}postConstruct(){const e=this.onLeftChanged.bind(this);this.addManagedListeners(this.columnOrGroup,{leftChanged:e}),this.setLeftFirstTime(),this.addManagedEventListeners({displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}setLeftFirstTime(){const{gos:e,colAnimation:t}=this.beans,r=e.get("suppressColumnMoveAnimation"),n=$e(this.columnOrGroup.getOldLeft());t?.isActive()&&n&&!r?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const e=this.getColumnOrGroup(),t=this.modifyLeftForPrintLayout(e,e.getOldLeft()),r=this.modifyLeftForPrintLayout(e,e.getLeft());this.setLeft(t),this.actualLeft=r,this.beans.colAnimation.executeNextVMTurn(()=>{this.actualLeft===r&&this.setLeft(r)})}onLeftChanged(){const e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){const{gos:r,visibleCols:n}=this.beans;if(!bn(r,"print")||e.getPinned()==="left")return t;const s=n.getColsLeftWidth();if(e.getPinned()==="right"){const o=n.bodyWidth;return s+o+t}return s+t}setLeft(e){if($e(e)&&(this.eCell.style.left=`${e}px`),Vr(this.columnOrGroup)){const t=this.columnOrGroup.getLeafColumns();if(!t.length)return;t.length>1&&Mz(this.ariaEl,t.length)}}},m$=0,uL="headerCtrl",Ax=class extends Ee{constructor(e,t){super(),this.column=e,this.rowCtrl=t,this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.reAttemptToFocus=!1,this.instanceId=e.getUniqueId()+"-"+m$++}postConstruct(){const e=this.refreshTabIndex.bind(this);this.addManagedPropertyListeners(["suppressHeaderFocus"],e),this.addManagedEventListeners({overlayExclusiveChanged:e})}setComp(e,t,r,n,i){t.setAttribute("col-id",this.column.colIdSanitised),this.wireComp(e,t,r,n,i),this.reAttemptToFocus&&(this.reAttemptToFocus=!1,this.focus(this.lastFocusEvent??void 0))}shouldStopEventPropagation(e){const{headerRowIndex:t,column:r}=this.beans.focusSvc.focusedHeader,n=r.getDefinition(),i=n?.suppressHeaderKeyboardEvent;if(!$e(i))return!1;const s=it(this.gos,{colDef:n,column:r,headerRowIndex:t,event:e});return!!i(s)}getWrapperHasFocus(){return Fr(this.beans)===this.eGui}setGui(e,t){this.eGui=e,this.addDomData(t),t.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),t.addManagedElementListeners(this.eGui,{focus:this.onGuiFocus.bind(this)}),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}refreshHeaderStyles(){const e=this.column.getDefinition();if(!e)return;const{headerStyle:t}=e;let r;if(typeof t=="function"){const n=this.getHeaderClassParams();r=t(n)}else r=t;r&&this.comp.setUserStyles(r)}onGuiFocus(){this.eventSvc.dispatchEvent({type:"headerFocused",column:this.column})}setupAutoHeight(e){const{wrapperElement:t,checkMeasuringCallback:r,compBean:n}=e,{beans:i}=this,s=g=>{if(!this.isAlive()||!n.isAlive())return;const{paddingTop:m,paddingBottom:v,borderBottomWidth:w,borderTopWidth:C}=gc(this.eGui),b=m+v+w+C,R=t.offsetHeight+b;if(g<5){const A=!un(i)?.contains(t),D=R==0;if(A||D){Cb(()=>s(g+1),"raf",i);return}}this.setColHeaderHeight(this.column,R)};let o=!1,a;const u=()=>{const g=this.column.isAutoHeaderHeight();g&&!o&&d(),!g&&o&&h()},d=()=>{o=!0,this.comp.toggleCss("ag-header-cell-auto-height",!0),s(0),a=Zo(this.beans,t,()=>s(0))},h=()=>{o=!1,a&&a(),this.comp.toggleCss("ag-header-cell-auto-height",!1),a=void 0};u(),n.addDestroyFunc(()=>h()),n.addManagedListeners(this.column,{widthChanged:()=>o&&s(0)}),n.addManagedEventListeners({sortChanged:()=>{o&&window.setTimeout(()=>s(0))}}),r&&r(u)}onDisplayedColumnsChanged(){const{comp:e,column:t,beans:r,eGui:n}=this;!e||!t||!n||(aL(e,t,r.visibleCols),MM(n,r.visibleCols.getAriaColIndex(t)))}addResizeAndMoveKeyboardListeners(e){e.addManagedListeners(this.eGui,{keydown:this.onGuiKeyDown.bind(this),keyup:this.onGuiKeyUp.bind(this)})}refreshTabIndex(){const e=Ul(this.beans);this.eGui&&Ei(this.eGui,"tabindex",e?null:"-1")}onGuiKeyDown(e){const t=Fr(this.beans),r=e.key===me.LEFT||e.key===me.RIGHT;if(this.isResizing&&(e.preventDefault(),e.stopImmediatePropagation()),t!==this.eGui||!e.shiftKey&&!e.altKey||((this.isResizing||r)&&(e.preventDefault(),e.stopImmediatePropagation()),!r))return;const i=e.key===me.LEFT!==this.gos.get("enableRtl")?"left":"right";if(e.altKey){this.isResizing=!0,this.resizeMultiplier+=1;const s=this.getViewportAdjustedResizeDiff(e);this.resizeHeader(s,e.shiftKey),this.resizeFeature?.toggleColumnResizing(!0)}else this.moveHeader(i)}moveHeader(e){this.beans.colMoves?.moveHeader(e,this.eGui,this.column,this.rowCtrl.pinned,this)}getViewportAdjustedResizeDiff(e){const t=this.getResizeDiff(e),{pinnedCols:r}=this.beans;return r?r.getHeaderResizeDiff(t,this.column):t}getResizeDiff(e){const{gos:t,column:r}=this;let n=e.key===me.LEFT!==t.get("enableRtl");const i=r.getPinned(),s=t.get("enableRtl");return i&&s!==(i==="right")&&(n=!n),(n?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=window.setTimeout(()=>{this.resizeFeature?.toggleColumnResizing(!1)},150))}handleKeyDown(e){const t=this.getWrapperHasFocus();switch(e.key){case me.PAGE_DOWN:case me.PAGE_UP:case me.PAGE_HOME:case me.PAGE_END:t&&e.preventDefault()}}addDomData(e){const t=uL,{eGui:r,gos:n}=this;tc(n,r,t,this),e.addDestroyFunc(()=>tc(n,r,t,null))}focus(e){if(!this.isAlive())return!1;const{eGui:t}=this;return t?(t.focus(),this.lastFocusEvent=e||null):this.reAttemptToFocus=!0,!0}focusThis(){this.beans.focusSvc.focusedHeader={headerRowIndex:this.rowCtrl.rowIndex,column:this.column}}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop?.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(e,t,r){const n=e??t,{menuSvc:i,gos:s}=this.beans;s.get("preventDefaultOnContextMenu")&&n.preventDefault(),i?.isHeaderContextMenuEnabled(r)&&i.showHeaderContextMenu(r,e,t),this.dispatchColumnMouseEvent("columnHeaderContextMenu",r)}dispatchColumnMouseEvent(e,t){this.eventSvc.dispatchEvent({type:e,column:t})}setColHeaderHeight(e,t){if(!e.setAutoHeaderHeight(t))return;const{eventSvc:r}=this;e.isColumn?r.dispatchEvent({type:"columnHeaderHeightChanged",column:e,columns:[e],source:"autosizeColumnHeaderHeight"}):r.dispatchEvent({type:"columnGroupHeaderHeightChanged",columnGroup:e,source:"autosizeColumnGroupHeaderHeight"})}clearComponent(){this.removeDragSource(),this.resizeFeature=null,this.comp=null,this.eGui=null}destroy(){super.destroy(),this.column=null,this.lastFocusEvent=null,this.rowCtrl=null}},v$=class extends Ax{constructor(){super(...arguments),this.refreshFunctions={},this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map}wireComp(e,t,r,n,i){this.comp=e;const{rowCtrl:s,column:o,beans:a}=this,{colResize:u,context:d,colHover:h,rangeSvc:g}=a,m=Gf(this,d,i);this.setGui(t,m),this.updateState(),this.setupWidth(m),this.setupMovingCss(m),this.setupMenuClass(m),this.setupSortableClass(m),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight({wrapperElement:n,checkMeasuringCallback:w=>this.setRefreshFunction("measuring",w),compBean:m}),this.addColumnHoverListener(m),this.setupFilterClass(m),this.setupStylesFromColDef(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(m),this.setupSelectAll(m),this.setupUserComp(),this.refreshAria(),u?this.resizeFeature=m.createManagedBean(u.createResizeFeature(s.pinned,o,r,e,this)):Er(r,!1),h?.createHoverFeature(m,[o],t),g?.createRangeHighlightFeature(m,o,e),m.createManagedBean(new Dx(o,t,a)),m.createManagedBean(new wd(t,{shouldStopEventPropagation:w=>this.shouldStopEventPropagation(w),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(m),m.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader","enableAdvancedFilter"],()=>this.refresh()),m.addManagedListeners(o,{colDefChanged:()=>this.refresh()}),m.addManagedListeners(o,{headerHighlightChanged:this.onHeaderHighlightChanged.bind(this)});const v=()=>this.checkDisplayName();m.addManagedEventListeners({columnValueChanged:v,columnRowGroupChanged:v,columnPivotChanged:v,headerHeightChanged:this.onHeaderHeightChanged.bind(this)}),m.addDestroyFunc(()=>{this.refreshFunctions={},this.selectAllFeature=null,this.dragSourceElement=void 0,this.userCompDetails=null,this.userHeaderClasses.clear(),this.ariaDescriptionProperties.clear(),this.clearComponent()})}resizeHeader(e,t){this.beans.colResize?.resizeHeader(this.column,e,t)}getHeaderClassParams(){const{column:e,beans:t}=this,r=e.colDef;return it(t.gos,{colDef:r,column:e,floatingFilter:!1})}setupUserComp(){const e=this.lookupUserCompDetails();e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(){const e=this.createParams(),t=this.column.getColDef();return TW(this.beans.userCompFactory,t,e)}createParams(){const{menuSvc:e,sortSvc:t,colFilter:r,gos:n}=this.beans;return it(n,{column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&!!e?.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!!r&&(!this.openFilterEnabled||Ri(this.gos)),showColumnMenu:(s,o)=>{e?.showColumnMenu({column:this.column,buttonElement:s,positionBy:"button",onClosedCallback:o})},showColumnMenuAfterMouseClick:(s,o)=>{e?.showColumnMenu({column:this.column,mouseEvent:s,positionBy:"mouse",onClosedCallback:o})},showFilter:s=>{e?.showFilterMenu({column:this.column,buttonElement:s,containerType:"columnFilter",positionBy:"button"})},progressSort:s=>{t?.progressSort(this.column,!!s,"uiColumnSorted")},setSort:(s,o)=>{t?.setSortForColumn(this.column,s,!!o,"uiColumnSorted")},eGridHeader:this.eGui,setTooltip:(s,o)=>{n.assertModuleRegistered("Tooltip",3),this.setupTooltip(s,o)}})}setupSelectAll(e){const{selectionSvc:t}=this.beans;t&&(this.selectAllFeature=e.createOptionalManagedBean(t.createSelectAllFeature(this.column)),this.selectAllFeature?.setComp(this),e.addManagedPropertyListener("rowSelection",()=>{const r=t.createSelectAllFeature(this.column);r&&!this.selectAllFeature?(this.selectAllFeature=e.createManagedBean(r),this.selectAllFeature?.setComp(this),this.comp.refreshSelectAllGui()):this.selectAllFeature&&!r&&(this.comp.removeSelectAllGui(),this.selectAllFeature=this.destroyBean(this.selectAllFeature))}))}getSelectAllGui(){return this.selectAllFeature?.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===me.SPACE&&this.selectAllFeature?.onSpaceKeyDown(e),e.key===me.ENTER&&this.onEnterKeyDown(e),e.key===me.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){e.ctrlKey||e.metaKey?this.showMenuOnKeyPress(e,!0):this.sortable&&this.beans.sortSvc?.progressSort(this.column,e.shiftKey,"uiColumnSorted")}showMenuOnKeyPress(e,t){const r=this.comp.getUserCompInstance();gD(r)&&r.onMenuKeyboardShortcut(t)&&e.preventDefault()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||(this.focusThis(),this.announceAriaDescription()),XW()&&this.setActiveHeader(!0)}onFocusOut(e){this.eGui.contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderTooltip(this.tooltipFeature,this,e,t)}setupStylesFromColDef(){this.setRefreshFunction("headerStyles",this.refreshHeaderStyles.bind(this)),this.refreshHeaderStyles()}setupClassesFromColDef(){const e=()=>{const t=this.column.getColDef(),r=oL(t,this.gos,this.column,null),n=this.userHeaderClasses;this.userHeaderClasses=new Set(r);for(const i of r)n.has(i)?n.delete(i):this.comp.toggleCss(i,!0);for(const i of n)this.comp.toggleCss(i,!1)};this.setRefreshFunction("headerClasses",e),e()}setDragSource(e){this.dragSourceElement=e,this.removeDragSource(),!(!e||!this.draggable)&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null)}updateState(){const{menuSvc:e}=this.beans;this.menuEnabled=!!e?.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=!!e?.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}setRefreshFunction(e,t){this.refreshFunctions[e]=t}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria();for(const e of Object.values(this.refreshFunctions))e()}refreshHeaderComp(){const e=this.lookupUserCompDetails();if(!e)return;(this.comp.getUserCompInstance()!=null&&this.userCompDetails.componentClass==e.componentClass?this.attemptHeaderCompRefresh(e.params):!1)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)}attemptHeaderCompRefresh(e){const t=this.comp.getUserCompInstance();return!t||!t.refresh?!1:t.refresh(e)}calculateDisplayName(){return this.beans.colNames.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){const e=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}setupWidth(e){const t=()=>{const r=this.column.getActualWidth();this.comp.setWidth(`${r}px`)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupMovingCss(e){const t=()=>{this.comp.toggleCss("ag-header-cell-moving",this.column.isMoving())};e.addManagedListeners(this.column,{movingChanged:t}),t()}setupMenuClass(e){const t=()=>{this.comp?.toggleCss("ag-column-menu-visible",this.column.isMenuVisible())};e.addManagedListeners(this.column,{menuVisibleChanged:t}),t()}setupSortableClass(e){const t=()=>{this.comp.toggleCss("ag-header-cell-sortable",!!this.sortable)};t(),this.setRefreshFunction("updateSortable",t),e.addManagedEventListeners({sortChanged:this.refreshAriaSort.bind(this)})}setupFilterClass(e){const t=()=>{const r=this.column.isFilterActive();this.comp.toggleCss("ag-header-cell-filtered",r),this.refreshAria()};e.addManagedListeners(this.column,{filterActiveChanged:t}),t()}setupWrapTextClass(){const e=()=>{const t=!!this.column.getColDef().wrapHeaderText;this.comp.toggleCss("ag-header-cell-wrap-text",t)};e(),this.setRefreshFunction("wrapText",e)}onHeaderHighlightChanged(){const e=this.column.getHighlighted(),t=e===0,r=e===1;this.comp.toggleCss("ag-header-highlight-before",t),this.comp.toggleCss("ag-header-highlight-after",r)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){const{eGui:e,column:t,comp:r,beans:n}=this,i=Tx(this.beans),s=i.reduce((m,v)=>m+v,0)===0;if(r.toggleCss("ag-header-parent-hidden",s),!t.isSpanHeaderHeight()){e.style.removeProperty("top"),e.style.removeProperty("height"),r.toggleCss("ag-header-span-height",!1),r.toggleCss("ag-header-span-total",!1);return}const{numberOfParents:o,isSpanningTotal:a}=this.column.getColumnGroupPaddingInfo();r.toggleCss("ag-header-span-height",o>0);const u=Fx(n);if(o===0){r.toggleCss("ag-header-span-total",!1),e.style.setProperty("top","0px"),e.style.setProperty("height",`${u}px`);return}r.toggleCss("ag-header-span-total",a);const d=(this.column.getFirstRealParent()?.getLevel()??-1)+1,h=i.length-d;let g=0;for(let m=0;m<h;m++)g+=i[i.length-1-m];e.style.setProperty("top",`${-g}px`),e.style.setProperty("height",`${u+g}px`)}refreshAriaSort(){if(this.sortable){const e=this.getLocaleTextFunc(),t=this.beans.sortSvc?.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(bz(t)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){const e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!Ri(this.gos)){const e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",e("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){const e=this.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",e("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(e,t){t!=null?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}announceAriaDescription(){if(!this.eGui.contains(Fr(this.beans)))return;const e=Array.from(this.ariaDescriptionProperties.keys()).sort((t,r)=>t==="filter"?-1:r.charCodeAt(0)-t.charCodeAt(0)).map(t=>this.ariaDescriptionProperties.get(t)).join(". ");this.beans.ariaAnnounce?.announceValue(e,"columnHeader")}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(e){this.beans.colHover?.addHeaderColumnHoverListener(e,this.comp,this.column)}addActiveHeaderMouseListeners(e){const t=i=>this.handleMouseOverChange(i.type==="mouseenter"),r=()=>{this.setActiveHeader(!0),this.dispatchColumnMouseEvent("columnHeaderClicked",this.column)},n=i=>this.handleContextMenuMouseEvent(i,void 0,this.column);e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:r,contextmenu:n})}handleMouseOverChange(e){this.setActiveHeader(e),this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column})}setActiveHeader(e){this.comp.toggleCss("ag-header-active",e)}getAnchorElementForMenu(e){const t=this.comp.getUserCompInstance();return gD(t)?t.getAnchorElementForMenu(e):this.eGui}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function gD(e){return typeof e?.getAnchorElementForMenu=="function"&&typeof e.onMenuKeyboardShortcut=="function"}var w$=0,yy=class extends Ee{constructor(e,t,r){super(),this.rowIndex=e,this.pinned=t,this.type=r,this.instanceId=w$++,this.comp=null,this.allCtrls=[];let n="ag-header-row-column";r==="group"?n="ag-header-row-group":r==="filter"&&(n="ag-header-row-filter"),this.headerRowClass=`ag-header-row ${n}`}setRowIndex(e){this.rowIndex=e,this.comp?.setRowIndex(this.getAriaRowIndex()),this.onRowHeightChanged()}postConstruct(){this.isPrintLayout=bn(this.gos,"print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}areCellsRendered(){return this.comp?this.allCtrls.every(e=>e.eGui!=null):!1}setComp(e,t,r=!0){this.comp=e,t=Gf(this,this.beans.context,t),r&&(this.setRowIndex(this.rowIndex),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners(t)}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(e){const t=this.onRowHeightChanged.bind(this),r=this.onDisplayedColumnsChanged.bind(this);e.addManagedEventListeners({columnResized:this.setWidth.bind(this),displayedColumnsChanged:r,virtualColumnsChanged:n=>this.onVirtualColumnsChanged(n.afterScroll),columnGroupHeaderHeightChanged:t,columnHeaderHeightChanged:t,gridStylesChanged:t,advancedFilterEnabledChanged:t}),e.addManagedPropertyListener("domLayout",r),e.addManagedPropertyListener("ensureDomOrder",n=>this.isEnsureDomOrder=n.currentValue),e.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],t)}onDisplayedColumnsChanged(){this.isPrintLayout=bn(this.gos,"print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}setWidth(){if(!this.comp)return;const e=this.getWidthForRow();this.comp.setWidth(`${e}px`)}getWidthForRow(){const{visibleCols:e}=this.beans;return this.isPrintLayout?this.pinned!=null?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null):e.getContainerWidth(this.pinned)}onRowHeightChanged(){if(!this.comp)return;const{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){let e=0;const t=Tx(this.beans);for(let i=0;i<t.length;i++){if(i===this.rowIndex&&this.type==="group")return{topOffset:e,rowHeight:t[i]};e+=t[i]}const r=Fx(this.beans);if(this.type==="column")return{topOffset:e,rowHeight:r};e+=r;const n=lL(this.beans);return{topOffset:e,rowHeight:n}}onVirtualColumnsChanged(e=!1){if(!this.comp)return;const t=this.getUpdatedHeaderCtrls(),r=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,r,e)}getUpdatedHeaderCtrls(){const e=this.ctrlsById;this.ctrlsById=new Map;const t=this.getColumnsInViewport();for(const n of t)this.recycleAndCreateHeaderCtrls(n,this.ctrlsById,e);const r=n=>{const{focusSvc:i,visibleCols:s}=this.beans;return i.isHeaderWrapperFocused(n)?s.isVisible(n.column):!1};if(e)for(const[n,i]of e)r(i)?this.ctrlsById.set(n,i):this.destroyBean(i);return this.allCtrls=Array.from(this.ctrlsById.values()),this.allCtrls}getHeaderCellCtrls(){return this.allCtrls}recycleAndCreateHeaderCtrls(e,t,r){if(e.isEmptyGroup())return;const n=e.getUniqueId();let i;if(r&&(i=r.get(n),r.delete(n)),i&&i.column!=e&&(this.destroyBean(i),i=void 0),i==null)switch(this.type){case"filter":{i=this.createBean(this.beans.registry.createDynamicBean("headerFilterCellCtrl",!0,e,this));break}case"group":i=this.createBean(this.beans.registry.createDynamicBean("headerGroupCellCtrl",!0,e,this));break;default:i=this.createBean(new v$(e,this));break}t.set(n,i)}getColumnsInViewport(){if(!this.isPrintLayout)return this.getComponentsToRender();if(this.pinned)return[];const e=[];for(const t of["left",null,"right"])e.push(...this.getComponentsToRender(t));return e}getComponentsToRender(e=this.pinned){return this.type==="group"?this.beans.colViewport.getHeadersToRender(e,this.rowIndex):this.beans.colViewport.getColumnHeadersToRender(e)}focusHeader(e,t){const r=this.allCtrls.find(i=>i.column==e);return r?r.focus(t):!1}destroy(){this.allCtrls=this.destroyBeans(this.allCtrls),this.ctrlsById=void 0,this.comp=null,super.destroy()}},C$=class extends Ee{constructor(e){super(),this.pinned=e,this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[]}setComp(e,t){this.comp=e,this.eViewport=t;const{pinnedCols:r,ctrlsSvc:n,colModel:i,colMoves:s}=this.beans;this.setupCenterWidth(),r?.setupHeaderPinnedWidth(this),this.setupDragAndDrop(s,this.eViewport);const o=this.refresh.bind(this,!0);this.addManagedEventListeners({displayedColumnsChanged:o,advancedFilterEnabledChanged:o});const a=`${typeof this.pinned=="string"?this.pinned:"center"}Header`;n.register(a,this),i.ready&&this.refresh()}getAllCtrls(){const e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}refresh(e=!1){const{focusSvc:t,filterManager:r,visibleCols:n}=this.beans;let i=0;const s=t.getFocusHeaderToUseAfterRefresh(),o=()=>{const g=n.headerGroupRowCount;i=g,e||(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls));const m=this.groupsRowCtrls.length;if(m!==g){if(m>g){for(let v=g;v<m;v++)this.destroyBean(this.groupsRowCtrls[v]);this.groupsRowCtrls.length=g;return}for(let v=m;v<g;v++){const w=this.createBean(new yy(v,this.pinned,"group"));this.groupsRowCtrls.push(w)}}},a=()=>{const g=i++;if(this.hidden){this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl);return}this.columnsRowCtrl==null||!e?(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.columnsRowCtrl=this.createBean(new yy(g,this.pinned,"column"))):this.columnsRowCtrl.rowIndex!==g&&this.columnsRowCtrl.setRowIndex(g)},u=()=>{this.includeFloatingFilter=!!r?.hasFloatingFilters()&&!this.hidden;const g=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter){g();return}e||g();const m=i++;this.filtersRowCtrl?this.filtersRowCtrl.rowIndex!==m&&this.filtersRowCtrl.setRowIndex(m):this.filtersRowCtrl=this.createBean(new yy(m,this.pinned,"filter"))},d=this.getAllCtrls();o(),a(),u();const h=this.getAllCtrls();this.comp.setCtrls(h),this.restoreFocusOnHeader(t,s),d.length!==h.length&&this.beans.eventSvc.dispatchEvent({type:"headerRowsChanged"})}getHeaderCtrlForColumn(e){const t=r=>r?.getHeaderCellCtrls().find(n=>n.column===e);if(Ya(e))return t(this.columnsRowCtrl);if(this.groupsRowCtrls.length!==0)for(let r=0;r<this.groupsRowCtrls.length;r++){const n=t(this.groupsRowCtrls[r]);if(n)return n}}getHtmlElementForColumnHeader(e){return this.getHeaderCtrlForColumn(e)?.eGui??null}getRowType(e){return this.getAllCtrls()[e]?.type}focusHeader(e,t,r){const i=this.getAllCtrls()[e];return i?i.focusHeader(t,r):!1}getGroupRowCount(){return this.groupsRowCtrls.length}getGroupRowCtrlAtIndex(e){return this.groupsRowCtrls[e]}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}destroy(){this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl),this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls),super.destroy()}setupDragAndDrop(e,t){const r=e?.createBodyDropTarget(this.pinned,t);r&&this.createManagedBean(r)}restoreFocusOnHeader(e,t){if(!t)return;const{column:r}=t;r.getPinned()==this.pinned&&e.focusHeaderPosition({headerPosition:t,scroll:!1})}setupCenterWidth(){this.pinned==null&&this.createManagedBean(new Ex(e=>this.comp.setCenterWidth(`${e}px`),!0))}},y$=class extends Ee{constructor(){super(...arguments),this.beanName="menuSvc"}postConstruct(){const{enterpriseMenuFactory:e,filterMenuFactory:t}=this.beans;this.activeMenuFactory=e??t}showColumnMenu(e){this.showColumnMenuCommon(this.activeMenuFactory,e,"columnMenu")}showFilterMenu(e){this.showColumnMenuCommon(mD(this.beans),e,e.containerType,!0)}showHeaderContextMenu(e,t,r){this.activeMenuFactory?.showMenuAfterContextMenuEvent(e,t,r)}hidePopupMenu(){this.beans.contextMenuSvc?.hideActiveMenu(),this.activeMenuFactory?.hideActiveMenu()}hideFilterMenu(){mD(this.beans)?.hideActiveMenu()}isColumnMenuInHeaderEnabled(e){const{suppressHeaderMenuButton:t}=e.getColDef();return!t&&!!this.activeMenuFactory?.isMenuEnabled(e)&&(Ri(this.gos)||!!this.beans.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(e){return!e.getColDef().suppressHeaderFilterButton&&!!this.beans.filterManager?.isFilterAllowed(e)}isHeaderContextMenuEnabled(e){return!(e&&Ya(e)?e.getColDef():e?.getColGroupDef())?.suppressHeaderContextMenu&&this.gos.get("columnMenu")==="new"}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){const e=!this.isSuppressMenuHide();return!(Wl()&&e)}isHeaderFilterButtonEnabled(e){return this.isFilterMenuInHeaderEnabled(e)&&!Ri(this.gos)&&!this.isFloatingFilterButtonDisplayed(e)}isFilterMenuItemEnabled(e){return!!this.beans.filterManager?.isFilterAllowed(e)&&!Ri(this.gos)&&!this.isFilterMenuInHeaderEnabled(e)&&!this.isFloatingFilterButtonDisplayed(e)}isFloatingFilterButtonEnabled(e){return!e.getColDef().suppressFloatingFilterButton}isFloatingFilterButtonDisplayed(e){return!!e.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(e)}isSuppressMenuHide(){const e=this.gos,t=e.get("suppressMenuHide");return Ri(e)?e.exists("suppressMenuHide")?t:!1:t}showColumnMenuCommon(e,t,r,n){const{positionBy:i,onClosedCallback:s}=t,o=t.column;if(i==="button"){const{buttonElement:a}=t;e?.showMenuAfterButtonClick(o,a,r,s,n)}else if(i==="mouse"){const{mouseEvent:a}=t;e?.showMenuAfterMouseEvent(o,a,r,s,n)}else if(o){const a=this.beans,u=a.ctrlsSvc;u.getScrollFeature().ensureColumnVisible(o,"auto"),Jo(a,()=>{const d=u.getHeaderRowContainerCtrl(o.getPinned())?.getHeaderCtrlForColumn(o);d&&e?.showMenuAfterButtonClick(o,d.getAnchorElementForMenu(n),r,s,n)})}}};function pD(e,t,r){e.menuVisible!==t&&(e.menuVisible=t,e.dispatchColEvent("menuVisibleChanged",r))}function mD(e){const{enterpriseMenuFactory:t,filterMenuFactory:r,gos:n}=e;return t&&Ri(n)?t:r}var Qm=class extends hx{constructor(){super(...arguments),this.errorMessages=null}init(e){this.params=e,this.initialiseEditor(e),this.eEditor.onValueChange(()=>e.validate())}destroy(){this.errorMessages=null}},dL=class extends Dr{constructor(){super()}},b$={tag:"span",cls:"ag-overlay-loading-center"},S$=class extends dL{init(){const e=Ho(this.gos.get("overlayLoadingTemplate")?.trim());if(this.setTemplate(e??b$),!e){const r=this.getLocaleTextFunc()("loadingOoo","Loading...");this.getGui().textContent=r,this.beans.ariaAnnounce.announceValue(r,"overlay")}}},x$={tag:"span",cls:"ag-overlay-no-rows-center"},E$=class extends dL{init(){const e=Ho(this.gos.get("overlayNoRowsTemplate")?.trim());if(this.setTemplate(e??x$),!e){const r=this.getLocaleTextFunc()("noRowsToShow","No Rows To Show");this.getGui().textContent=r,this.beans.ariaAnnounce.announceValue(r,"overlay")}}};function R$(e,t,r){const n=ts(e,t,r);if(n){const{className:s}=n;if(typeof s=="string"&&s.includes("ag-icon")||typeof s=="object"&&s["ag-icon"])return n}const i=jn({tag:"span"});return i.appendChild(n),i}function ts(e,t,r){let n=null;e==="smallDown"?Me(262):e==="smallLeft"?Me(263):e==="smallRight"&&Me(264);const i=r?.getColDef().icons;if(i&&(n=i[e]),t.gos&&!n){const s=t.gos.get("icons");s&&(n=s[e])}if(n){let s;if(typeof n=="function")s=n();else if(typeof n=="string")s=n;else{Me(38,{iconName:e});return}if(typeof s=="string")return ex(s);if(nx(s))return s;Me(133,{iconName:e});return}else{const s=t.registry.getIcon(e);return s||t.validation?.validateIcon(e),jn({tag:"span",cls:`ag-icon ag-icon-${s??e}`,role:"presentation",attrs:{unselectable:"on"}})}}var T$=".ag-dnd-ghost{align-items:center;background-color:var(--ag-drag-and-drop-image-background-color);border:var(--ag-drag-and-drop-image-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-drag-and-drop-image-shadow);color:var(--ag-text-color);cursor:move;display:flex;font-weight:500;gap:var(--ag-cell-widget-spacing);height:var(--ag-header-height);overflow:hidden;padding-left:var(--ag-cell-horizontal-padding);padding-right:var(--ag-cell-horizontal-padding);text-overflow:ellipsis;transform:translateY(calc(var(--ag-spacing)*2));white-space:nowrap}.ag-dnd-ghost-not-allowed{border:var(--ag-drag-and-drop-image-not-allowed-border)}",F$={tag:"div",children:[{tag:"div",ref:"eGhost",cls:"ag-dnd-ghost ag-unselectable",children:[{tag:"span",ref:"eIcon",cls:"ag-dnd-ghost-icon ag-shake-left-to-right"},{tag:"div",ref:"eLabel",cls:"ag-dnd-ghost-label"}]}]},D$=class extends Dr{constructor(){super(),this.dragSource=null,this.eIcon=tt,this.eLabel=tt,this.eGhost=tt,this.registerCSS(T$)}postConstruct(){const e=t=>R$(t,this.beans,null);this.dropIconMap={pinned:e("columnMovePin"),hide:e("columnMoveHide"),move:e("columnMoveMove"),left:e("columnMoveLeft"),right:e("columnMoveRight"),group:e("columnMoveGroup"),aggregate:e("columnMoveValue"),pivot:e("columnMovePivot"),notAllowed:e("dropNotAllowed")}}init(e){this.dragSource=e.dragSource,this.setTemplate(F$),this.beans.environment.applyThemeClasses(this.eGhost)}destroy(){this.dragSource=null,super.destroy()}setIcon(e,t){const{eGhost:r,eIcon:n,dragSource:i,dropIconMap:s,gos:o}=this;ci(n);let a=null;e||(e=i?.getDefaultIconName?i.getDefaultIconName():"notAllowed"),a=s[e],r.classList.toggle("ag-dnd-ghost-not-allowed",e==="notAllowed"),n.classList.toggle("ag-shake-left-to-right",t),!(a===s.hide&&o.get("suppressDragLeaveHidesColumns"))&&a&&n.appendChild(a)}setLabel(e){this.eLabel.textContent=e}},A$=".ag-checkbox-cell{height:100%}",k$={tag:"div",cls:"ag-cell-wrapper ag-checkbox-cell",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},P$=class extends Dr{constructor(){super(k$,[px]),this.eCheckbox=tt,this.registerCSS(A$)}init(e){this.refresh(e);const{eCheckbox:t,beans:r}=this,n=t.getInputElement();n.setAttribute("tabindex","-1"),AM(n,"polite"),this.addManagedListeners(n,{click:i=>{if(nc(i),t.isDisabled())return;const s=t.getValue();this.onCheckboxChanged(s)},dblclick:i=>{nc(i)}}),this.addManagedElementListeners(e.eGridCell,{keydown:i=>{if(i.key===me.SPACE&&!t.isDisabled()){e.eGridCell===Fr(r)&&t.toggle();const s=t.getValue();this.onCheckboxChanged(s),i.preventDefault()}}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){let t,r=!0;const{value:n,column:i,node:s}=e;if(s.group&&i)if(typeof n=="boolean")t=n;else{const g=i.getColId();g.startsWith(jm)?t=n==null||n===""?void 0:n==="true":s.aggData&&s.aggData[g]!==void 0||s.sourceRowIndex>=0?t=n??void 0:r=!1}else t=n??void 0;const{eCheckbox:o}=this;if(!r){o.setDisplayed(!1);return}o.setValue(t);const a=e.disabled??!i?.isCellEditable(s);o.setDisabled(a);const u=this.getLocaleTextFunc(),d=$m(u,t),h=a?d:`${u("ariaToggleCellValue","Press SPACE to toggle cell value")} (${d})`;o.setInputAriaLabel(h)}onCheckboxChanged(e){const{params:t}=this,{column:r,node:n,value:i}=t;this.beans?.editSvc?.setEditingCells([{column:r,colId:r.getColId(),rowIndex:n.rowIndex,rowPinned:n.rowPinned,state:"changed",oldValue:i,newValue:i}],{update:!0,forceRefreshOfEditCellsOnly:!0});const s=n.setDataValue(r,e,"renderer");this.beans.editSvc?.stopEditing({rowNode:n,column:r},{source:this.beans.editSvc?.isBatchEditing()?"ui":"api"}),s||this.updateCheckbox(t)}},vD=class{constructor(e,t){this.beans=e,this.floating=t,this.all=new Set,this.visible=new Set,this.order=[],this.queued=new Set}size(){return this.visible.size}add(e){const{all:t,visible:r,order:n}=this;t.has(e)||(t.add(e),r.add(e),n.push(e),this.sort())}delete(e){this.all.delete(e),this.visible.delete(e),this.queued.delete(e.id),Ds(this.order,e)}has(e){return this.visible.has(e)}forEach(e){this.order.forEach(e)}getByIndex(e){return this.order[e]}getById(e){for(const t of this.visible)if(t.id==e)return t}clear(){const{all:e,visible:t,order:r,queued:n}=this;e.clear(),n.clear(),t.clear(),r.length=0}sort(){const{sortSvc:e,rowNodeSorter:t,gos:r}=this.beans,n=e?.getSortOptions()??[],i=L$(this.order);if(this.order.sort((o,a)=>(o.pinnedSibling?.rowIndex??0)-(a.pinnedSibling?.rowIndex??0)),this.order=t?.doFullSort(this.order,n)??this.order,!i)return;const s=i_(r);s==="bottom"||s==="pinnedBottom"?this.order.push(i):this.order.unshift(i)}hide(e){const{all:t,visible:r}=this;t.forEach(n=>e(n)?r.delete(n):r.add(n)),this.order=Array.from(r),this.sort()}queue(e){this.queued.add(e)}unqueue(e){this.queued.delete(e)}forEachQueued(e){this.queued.forEach(e)}};function hL(e){if(e.level===-1)return!0;const t=e.parent;return t?.childrenAfterSort?.some(r=>r==e)?hL(t):!1}function by(e,t){const{gos:r,rowModel:n,filterManager:i}=e;return pc(r)?!n.getRowNode(t.id):i?.isAnyFilterPresent()?!hL(t):r.get("pivotMode")?!t.group:!1}function M$(e){return!!e.footer&&e.level===-1}function _$(e){return!!e.pinnedSibling&&M$(e.pinnedSibling)}function L$(e){const t=e.findIndex(_$);if(t>-1)return e.splice(t,1)?.[0]}var wD=class extends Ee{postConstruct(){const{gos:e,beans:t}=this;this.top=new vD(t,"top"),this.bottom=new vD(t,"bottom");const r=i=>by(t,i.pinnedSibling),n=()=>{const i=e.get("isRowPinned");i&&e.get("enableRowPinning")&&t.rowModel.forEachNode(s=>this.pinRow(s,i(s)),!0),this.refreshRowPositions(),this.dispatchRowPinnedEvents()};this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this),modelUpdated:({keepRenderedRows:i})=>{this.tryToEmptyQueues(),this.pinGrandTotalRow(),this.forContainers(o=>o.hide(r));const s=this.refreshRowPositions();(!i||s)&&this.dispatchRowPinnedEvents()},columnRowGroupChanged:()=>{this.forContainers(O$),this.refreshRowPositions()},rowNodeDataChanged:({node:i})=>{(e.get("isRowPinnable")?.(i)??!0)||this.pinRow(i,null)},firstDataRendered:n}),this.addManagedPropertyListener("pivotMode",()=>{this.forContainers(i=>i.hide(r)),this.dispatchRowPinnedEvents()}),this.addManagedPropertyListener("grandTotalRow",({currentValue:i})=>{this._grandTotalPinned=i==="pinnedBottom"?"bottom":i==="pinnedTop"?"top":null}),this.addManagedPropertyListener("isRowPinned",n)}destroy(){this.reset(!1),super.destroy()}reset(e=!0){this.forContainers(t=>{const r=[];t.forEach(n=>r.push(n)),r.forEach(n=>this.pinRow(n,null)),t.clear()}),e&&this.dispatchRowPinnedEvents()}pinRow(e,t,r){if(e.footer&&e.level>-1)return;if(e.footer&&e.level===-1){this._grandTotalPinned=t,B$(this.beans);return}const n=e.rowPinned??e.pinnedSibling?.rowPinned;if(n!=null&&t!=null&&t!=n){const o=e.rowPinned?e:e.pinnedSibling,a=e.rowPinned?e.pinnedSibling:e;this.pinRow(o,null,r),this.pinRow(a,t,r);return}const s=r&&N$(this.beans,e,r);if(s){s.forEach(o=>this.pinRow(o,t));return}if(t==null){const o=e.rowPinned?e:e.pinnedSibling,a=this.findPinnedRowNode(o);if(!a)return;a.delete(o);const u=o.pinnedSibling;Sy(o),this.refreshRowPositions(t),this.dispatchRowPinnedEvents(u)}else{const o=CD(this.beans,e,t),a=this.getContainer(t);a.add(o),by(this.beans,e)&&a.hide(u=>by(this.beans,u.pinnedSibling)),this.refreshRowPositions(t),this.dispatchRowPinnedEvents(e)}}isManual(){return!0}isEmpty(e){return this.getContainer(e).size()===0}isRowsToRender(e){return!this.isEmpty(e)}ensureRowHeightsValid(){let e=!1,t=0;const r=n=>{if(n.rowHeightEstimated){const i=$a(this.beans,n);n.setRowTop(t),n.setRowHeight(i.height),t+=i.height,e=!0}};return this.bottom.forEach(r),t=0,this.top.forEach(r),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}getPinnedTopTotalHeight(){return yD(this.top)}getPinnedBottomTotalHeight(){return yD(this.bottom)}getPinnedTopRowCount(){return this.top.size()}getPinnedBottomRowCount(){return this.bottom.size()}getPinnedTopRow(e){return this.top.getByIndex(e)}getPinnedBottomRow(e){return this.bottom.getByIndex(e)}getPinnedRowById(e,t){return this.getContainer(t).getById(e)}forEachPinnedRow(e,t){this.getContainer(e).forEach(t)}getPinnedState(){const e=t=>{const r=[];return this.forEachPinnedRow(t,n=>r.push(n.pinnedSibling.id)),r};return{top:e("top"),bottom:e("bottom")}}setPinnedState(e){this.forContainers((t,r)=>{for(const n of e[r]){const i=this.beans.rowModel.getRowNode(n);i?this.pinRow(i,r):t.queue(n)}})}getGrandTotalPinned(){return this._grandTotalPinned}setGrandTotalPinned(e){this._grandTotalPinned=e}tryToEmptyQueues(){this.forContainers((e,t)=>{const r=new Set;e.forEachQueued(n=>{const i=this.beans.rowModel.getRowNode(n);i&&r.add(i)});for(const n of r)e.unqueue(n.id),this.pinRow(n,t)})}pinGrandTotalRow(){const{gos:e,beans:t,_grandTotalPinned:r}=this,n=t.rowModel;if(!_r(e))return;const i=n.rootNode?.sibling;if(!i)return;const s=i.pinnedSibling,o=s&&this.findPinnedRowNode(s);if(r){if(o&&o.floating!==r&&(o.delete(s),Sy(s)),!o||o.floating!==r){const a=CD(t,i,r);this.getContainer(r).add(a)}}else{if(!o)return;o.delete(s),Sy(s)}}onGridStylesChanges(e){e.rowHeightChanged&&this.forContainers(t=>t.forEach(r=>r.setRowHeight(r.rowHeight,!0)))}getContainer(e){return e==="top"?this.top:this.bottom}findPinnedRowNode(e){if(this.top.has(e))return this.top;if(this.bottom.has(e))return this.bottom}refreshRowPositions(e){const t=n=>I$(this.beans,n);if(e)return t(this.getContainer(e));let r=!1;return this.forContainers(n=>{const i=t(n);r||(r=i)}),r}forContainers(e){e(this.top,"top"),e(this.bottom,"bottom")}dispatchRowPinnedEvents(e){this.eventSvc.dispatchEvent({type:"pinnedRowsChanged"}),e?.dispatchRowEvent("rowPinned")}};function I$(e,t){let r=0,n=!1;return t.forEach((i,s)=>{if(n||(n=i.rowTop!==r),i.setRowTop(r),i.rowHeightEstimated||i.rowHeight==null){const o=$a(e,i).height;n||(n=i.rowHeight!==o),i.setRowHeight(o)}i.setRowIndex(s),r+=i.rowHeight}),n}function CD(e,t,r){if(t.pinnedSibling)return t.pinnedSibling;const n=oU(t,e);n.setRowTop(null),n.setRowIndex(null),n.rowPinned=r;const i=r==="top"?yx:bx;return n.id=`${i}${r}-${t.id}`,n.pinnedSibling=t,t.pinnedSibling=n,n}function Sy(e){if(!e.pinnedSibling)return;e.rowPinned=null,e.setRowTop(null),e.setRowIndex(null);const t=e.pinnedSibling;e.pinnedSibling=void 0,t&&(t.pinnedSibling=void 0,t.rowPinned=null)}function O$(e){const t=new Set;e.forEach(r=>{r.group&&t.add(r)}),t.forEach(r=>e.delete(r))}function N$(e,t,r){const{rowSpanSvc:n}=e,i=(r&&n?.isCellSpanning(r,t))??!1;if(r&&i)return n?.getCellSpan(r,t)?.spannedNodes}function yD(e){const t=e.size();if(t===0)return 0;const r=e.getByIndex(t-1);return r===void 0?0:r.rowTop+r.rowHeight}function B$({gos:e,rowModel:t}){_r(e)&&t.refreshModel({step:"map"})}var bD=class extends Ee{constructor(){super(...arguments),this.nextId=0,this.pinnedTopRows={cache:{},order:[]},this.pinnedBottomRows={cache:{},order:[]}}postConstruct(){const e=this.gos;this.setPinnedRowData(e.get("pinnedTopRowData"),"top"),this.setPinnedRowData(e.get("pinnedBottomRowData"),"bottom"),this.addManagedPropertyListener("pinnedTopRowData",t=>this.setPinnedRowData(t.currentValue,"top")),this.addManagedPropertyListener("pinnedBottomRowData",t=>this.setPinnedRowData(t.currentValue,"bottom")),this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this)})}reset(){}isEmpty(e){return this.getCache(e).order.length===0}isRowsToRender(e){return!this.isEmpty(e)}isManual(){return!1}pinRow(e,t){}onGridStylesChanges(e){if(e.rowHeightChanged){const t=r=>{r.setRowHeight(r.rowHeight,!0)};Sh(this.pinnedBottomRows,t),Sh(this.pinnedTopRows,t)}}ensureRowHeightsValid(){let e=!1,t=0;const r=n=>{if(n.rowHeightEstimated){const i=$a(this.beans,n);n.setRowTop(t),n.setRowHeight(i.height),t+=i.height,e=!0}};return Sh(this.pinnedBottomRows,r),t=0,Sh(this.pinnedTopRows,r),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}setPinnedRowData(e,t){this.updateNodesFromRowData(e,t),this.eventSvc.dispatchEvent({type:"pinnedRowDataChanged"})}updateNodesFromRowData(e,t){const r=this.getCache(t);if(e===void 0){r.order.length=0,r.cache={};return}const n=Zu(this.gos),i=t==="top"?yx:bx,s=new Set(r.order),o=[],a=new Set;let u=0,d=-1;for(const h of e){const g=n?.({data:h,level:0,rowPinned:t})??i+this.nextId++;if(a.has(g)){Me(96,{id:g,data:h});continue}d++,a.add(g),o.push(g);const m=Gh(r,g);if(m!==void 0)m.data!==h&&m.updateData(h),u+=this.setRowTopAndRowIndex(m,u,d),s.delete(g);else{const v=new Ka(this.beans);v.id=g,v.data=h,v.rowPinned=t,u+=this.setRowTopAndRowIndex(v,u,d),r.cache[g]=v,r.order.push(g)}}for(const h of s)Gh(r,h)?.clearRowTopAndRowIndex(),delete r.cache[h];r.order=o}setRowTopAndRowIndex(e,t,r){return e.setRowTop(t),e.setRowHeight($a(this.beans,e).height),e.setRowIndex(r),e.rowHeight}getPinnedTopTotalHeight(){return SD(this.pinnedTopRows)}getPinnedBottomTotalHeight(){return SD(this.pinnedBottomRows)}getPinnedTopRowCount(){return Bb(this.pinnedTopRows)}getPinnedBottomRowCount(){return Bb(this.pinnedBottomRows)}getPinnedTopRow(e){return Nb(this.pinnedTopRows,e)}getPinnedBottomRow(e){return Nb(this.pinnedBottomRows,e)}getPinnedRowById(e,t){return Gh(this.getCache(t),e)}forEachPinnedRow(e,t){return Sh(this.getCache(e),t)}getCache(e){return e==="top"?this.pinnedTopRows:this.pinnedBottomRows}getPinnedState(){return{top:[],bottom:[]}}setPinnedState(){}getGrandTotalPinned(){}setGrandTotalPinned(){}};function SD(e){const t=Bb(e);if(t===0)return 0;const r=Nb(e,t-1);return r===void 0?0:r.rowTop+r.rowHeight}function Gh(e,t){return e.cache[t]}function Nb(e,t){return Gh(e,e.order[t])}function Sh(e,t){e.order.forEach((r,n)=>{const i=Gh(e,r);i&&t(i,n)})}function Bb(e){return e.order.length}var H$=class extends Ee{constructor(){super(...arguments),this.beanName="pinnedRowModel"}postConstruct(){const{gos:e}=this,t=()=>{const r=e.get("enableRowPinning"),n=i_(e),s=!!r||(n==="pinnedBottom"||n==="pinnedTop"),o=s?this.inner instanceof bD:this.inner instanceof wD;this.inner&&o&&this.destroyBean(this.inner),(o||!this.inner)&&(this.inner=this.createManagedBean(s?new wD:new bD))};this.addManagedPropertyListeners(["enableRowPinning","grandTotalRow"],t),t()}reset(){return this.inner.reset()}isEmpty(e){return this.inner.isEmpty(e)}isManual(){return this.inner.isManual()}isRowsToRender(e){return this.inner.isRowsToRender(e)}pinRow(e,t,r){return this.inner.pinRow(e,t,r)}ensureRowHeightsValid(){return this.inner.ensureRowHeightsValid()}getPinnedRowById(e,t){return this.inner.getPinnedRowById(e,t)}getPinnedTopTotalHeight(){return this.inner.getPinnedTopTotalHeight()}getPinnedBottomTotalHeight(){return this.inner.getPinnedBottomTotalHeight()}getPinnedTopRowCount(){return this.inner.getPinnedTopRowCount()}getPinnedBottomRowCount(){return this.inner.getPinnedBottomRowCount()}getPinnedTopRow(e){return this.inner.getPinnedTopRow(e)}getPinnedBottomRow(e){return this.inner.getPinnedBottomRow(e)}forEachPinnedRow(e,t){return this.inner.forEachPinnedRow(e,t)}getPinnedState(){return this.inner.getPinnedState()}setPinnedState(e){return this.inner.setPinnedState(e)}setGrandTotalPinned(e){return this.inner.setGrandTotalPinned(e)}getGrandTotalPinned(){return this.inner.getGrandTotalPinned()}};function $f(e){return!!(e.rowPinned&&e.pinnedSibling)}function Xi(e,t,r,n){const i=t==="top";if(!r)return Xi(e,t,i?e.getPinnedTopRow(0):e.getPinnedBottomRow(0),n);if(!n){const u=i?e.getPinnedTopRowCount():e.getPinnedBottomRowCount();return Xi(e,t,r,i?e.getPinnedTopRow(u-1):e.getPinnedBottomRow(u-1))}let s=!1,o=!1;const a=[];return e.forEachPinnedRow(t,u=>{if(u===r&&!s){s=!0,a.push(u);return}if(s&&u===n){o=!0,a.push(u);return}s&&!o&&a.push(u)}),a}var G$={tag:"div",cls:"ag-selection-checkbox",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},V$=class extends Dr{constructor(){super(G$,[px]),this.eCheckbox=tt}postConstruct(){this.eCheckbox.setPassive(!0)}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){const e=this.getLocaleTextFunc(),{rowNode:t,eCheckbox:r}=this,n=t.isSelected(),i=$m(e,n),[s,o]=t.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],a=e(s,o);r.setValue(n,!0),r.setInputAriaLabel(`${a} (${i})`)}init(e){if(this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListeners(this.eCheckbox.getInputElement(),{dblclick:nc,click:n=>{nc(n),this.beans.selectionSvc?.handleSelectionEvent(n,this.rowNode,"checkboxSelected")}}),this.addManagedListeners(this.rowNode,{rowSelected:this.onSelectionChanged.bind(this),dataChanged:this.onDataChanged.bind(this),selectableChanged:this.onSelectableChanged.bind(this)}),this.addManagedPropertyListener("rowSelection",({currentValue:n,previousValue:i})=>{const s=typeof n=="object"?iy(n):void 0,o=typeof i=="object"?iy(i):void 0;s!==o&&this.onSelectableChanged()}),Eb(this.gos)||typeof this.getIsVisible()=="function"){const n=this.showOrHideSelect.bind(this);this.addManagedEventListeners({displayedColumnsChanged:n}),this.addManagedListeners(this.rowNode,{dataChanged:n,cellChanged:n}),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}showOrHideSelect(){const{column:e,rowNode:t,overrides:r,gos:n}=this,i=t.selectable,s=this.getIsVisible();let o;if(typeof s=="function"){const g=r?.callbackParams;if(!e)o=s({...g,node:t,data:t.data});else{const m=e.createColumnFunctionCallbackParams(t);o=s({...g,...m})}}else o=s??!1;const a=i&&!o||!i&&o,u=i||o,d=n.get("rowSelection"),h=d&&typeof d!="string"?!iy(d):!!e?.getColDef().showDisabledCheckboxes;this.setVisible(u&&(a?h:!0)),this.setDisplayed(u&&(a?h:!0)),u&&this.eCheckbox.setDisabled(a),r?.removeHidden&&this.setDisplayed(u)}getIsVisible(){const e=this.overrides;if(e)return e.isVisible;const t=this.gos.get("rowSelection");return t&&typeof t!="string"?Mu(t):this.column?.getColDef()?.checkboxSelection}},z$=class{constructor(e,t){this.rowModel=e,this.pinnedRowModel=t,this.selectAll=!1,this.rootId=null,this.endId=null,this.cachedRange=[]}reset(){this.rootId=null,this.endId=null,this.cachedRange.length=0}setRoot(e){this.rootId=e.id,this.endId=null,this.cachedRange.length=0}setEndRange(e){this.endId=e.id,this.cachedRange.length=0}getRange(){if(this.cachedRange.length===0){const e=this.getRoot(),t=this.getEnd();if(e==null||t==null)return this.cachedRange;this.cachedRange=this.getNodesInRange(e,t)??[]}return this.cachedRange}isInRange(e){return this.rootId===null?!1:this.getRange().some(t=>t.id===e.id)}getRoot(e){if(this.rootId)return this.getRowNode(this.rootId);if(e)return this.setRoot(e),e}getEnd(){if(this.endId)return this.getRowNode(this.endId)}getRowNode(e){let t;const{rowModel:r,pinnedRowModel:n}=this;return t??(t=r.getRowNode(e)),n?.isManual()&&(t??(t=n.getPinnedRowById(e,"top")),t??(t=n.getPinnedRowById(e,"bottom"))),t}truncate(e){const t=this.getRange();if(t.length===0)return{keep:[],discard:[]};const r=t[0].id===this.rootId,n=t.findIndex(i=>i.id===e.id);if(n>-1){const i=t.slice(0,n),s=t.slice(n+1);return this.setEndRange(e),r?{keep:i,discard:s}:{keep:s,discard:i}}else return{keep:t,discard:[]}}extend(e,t=!1){const r=this.getRoot();if(r==null){const i=this.getRange().slice();return t&&e.depthFirstSearch(s=>!s.group&&i.push(s)),i.push(e),this.setRoot(e),{keep:i,discard:[]}}const n=this.getNodesInRange(r,e);if(!n)return this.setRoot(e),{keep:[e],discard:[]};if(n.find(i=>i.id===this.endId))return this.setEndRange(e),{keep:this.getRange(),discard:[]};{const i=this.getRange().slice();return this.setEndRange(e),{keep:this.getRange(),discard:i}}}getNodesInRange(e,t){const{pinnedRowModel:r,rowModel:n}=this;if(!r?.isManual())return n.getNodesInRangeForSelection(e,t);if(e.rowPinned==="top"&&!t.rowPinned)return Xi(r,"top",e,void 0).concat(n.getNodesInRangeForSelection(n.getRow(0),t)??[]);if(e.rowPinned==="bottom"&&!t.rowPinned){const i=Xi(r,"bottom",void 0,e),s=n.getRowCount(),o=n.getRow(s-1);return(n.getNodesInRangeForSelection(t,o)??[]).concat(i)}if(!e.rowPinned&&!t.rowPinned)return n.getNodesInRangeForSelection(e,t);if(e.rowPinned==="top"&&t.rowPinned==="top")return Xi(r,"top",e,t);if(e.rowPinned==="bottom"&&t.rowPinned==="top"){const i=Xi(r,"top",t,void 0),s=Xi(r,"bottom",void 0,e),o=n.getRow(0),a=n.getRow(n.getRowCount()-1);return i.concat(n.getNodesInRangeForSelection(o,a)??[]).concat(s)}if(!e.rowPinned&&t.rowPinned==="top")return Xi(r,"top",t,void 0).concat(n.getNodesInRangeForSelection(n.getRow(0),e)??[]);if(e.rowPinned==="top"&&t.rowPinned==="bottom"){const i=Xi(r,"top",e,void 0),s=Xi(r,"bottom",void 0,t),o=n.getRow(0),a=n.getRow(n.getRowCount()-1);return i.concat(n.getNodesInRangeForSelection(o,a)??[]).concat(s)}if(e.rowPinned==="bottom"&&t.rowPinned==="bottom")return Xi(r,"bottom",e,t);if(!e.rowPinned&&t.rowPinned==="bottom"){const i=Xi(r,"bottom",void 0,t),s=n.getRow(n.getRowCount());return(n.getNodesInRangeForSelection(e,s)??[]).concat(i)}return null}},W$=class extends Ee{constructor(e){super(),this.column=e,this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1}onSpaceKeyDown(e){const t=this.cbSelectAll;t.isDisplayed()&&!t.getGui().contains(Fr(this.beans))&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e;const t=this.createManagedBean(new gx);this.cbSelectAll=t,t.addCss("ag-header-select-all"),Jl(t.getGui(),"presentation"),this.showOrHideSelectAll();const r=this.updateStateOfCheckbox.bind(this);this.addManagedEventListeners({newColumnsLoaded:()=>this.showOrHideSelectAll(),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),selectionChanged:r,paginationChanged:r,modelUpdated:r}),this.addManagedPropertyListener("rowSelection",({currentValue:n,previousValue:i})=>{const s=o=>typeof o=="string"||!o||o.mode==="singleRow"?void 0:o.selectAll;s(n)!==s(i)&&this.showOrHideSelectAll(),this.updateStateOfCheckbox()}),this.addManagedListeners(t,{fieldValueChanged:this.onCbSelectAll.bind(this)}),t.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onDisplayedColumnsChanged(e){this.isAlive()&&this.showOrHideSelectAll(e.source==="uiColumnMoved")}showOrHideSelectAll(e=!1){const t=this.isCheckboxSelection();this.cbSelectAllVisible=t,this.cbSelectAll.setDisplayed(t),t&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel(e)}updateStateOfCheckbox(){if(!this.cbSelectAllVisible||this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;const e=this.getSelectAllMode(),t=this.beans.selectionSvc,r=this.cbSelectAll,n=t.getSelectAllState(e);r.setValue(n);const i=t.hasNodesToSelect(e);r.setDisabled(!i),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(e=!1){const t=this.getLocaleTextFunc(),{headerCellCtrl:r,cbSelectAll:n,cbSelectAllVisible:i}=this,s=n.getValue(),o=$m(t,s),a=t("ariaRowSelectAll","Press Space to toggle all rows selection");r.setAriaDescriptionProperty("selectAll",i?`${a} (${o})`:null),n.setInputAriaLabel(t("ariaHeaderSelection","Column with Header Selection")),e||r.announceAriaDescription()}checkSelectionType(e){return M0(this.gos)?!0:(Me(128,{feature:e}),!1)}checkRightRowModelType(e){const{gos:t,rowModel:r}=this.beans;return _r(t)||pc(t)?!0:(Me(129,{feature:e,rowModel:r.getType()}),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox||!this.cbSelectAllVisible)return;const e=this.cbSelectAll.getValue(),t=this.getSelectAllMode();let r="uiSelectAll";t==="currentPage"?r="uiSelectAllCurrentPage":t==="filtered"&&(r="uiSelectAllFiltered");const n={source:r,selectAll:t},i=this.beans.selectionSvc;e?i.selectAllRowNodes(n):i.deselectAllRowNodes(n)}isCheckboxSelection(){const{column:e,gos:t,beans:r}=this,s=typeof t.get("rowSelection")=="object"?"headerCheckbox":"headerCheckboxSelection";return fL(r,e)&&this.checkRightRowModelType(s)&&this.checkSelectionType(s)}getSelectAllMode(){const e=l_(this.gos,!1);if(e)return e;const{headerCheckboxSelectionCurrentPageOnly:t,headerCheckboxSelectionFilteredOnly:r}=this.column.getColDef();return t?"currentPage":r?"filtered":"all"}destroy(){super.destroy(),this.cbSelectAll=void 0,this.headerCellCtrl=void 0}};function fL({gos:e,selectionColSvc:t},r){const n=e.get("rowSelection"),i=r.getColDef(),{headerCheckboxSelection:s}=i;let o=!1;if(typeof n=="object"){const u=ea(r),d=ux(r);(k0(n)==="autoGroupColumn"&&d||u&&t?.isSelectionColumnEnabled())&&(o=r0(n))}else typeof s=="function"?o=s(it(e,{column:r,colDef:i})):o=!!s;return o}var U$=class extends Ee{postConstruct(){const{gos:e,beans:t}=this;this.selectionCtx=new z$(t.rowModel,t.pinnedRowModel),this.addManagedPropertyListeners(["isRowSelectable","rowSelection"],()=>{const r=Eb(e);r!==this.isRowSelectable&&(this.isRowSelectable=r,this.updateSelectable())}),this.isRowSelectable=Eb(e),this.addManagedEventListeners({cellValueChanged:r=>this.updateRowSelectable(r.node),rowNodeDataChanged:r=>this.updateRowSelectable(r.node)})}destroy(){super.destroy(),this.selectionCtx.reset()}createCheckboxSelectionComponent(){return new V$}createSelectAllFeature(e){if(fL(this.beans,e))return new W$(e)}isMultiSelect(){return M0(this.gos)}onRowCtrlSelected(e,t,r){const n=!!e.rowNode.isSelected();e.forEachGui(r,i=>{i.rowComp.toggleCss("ag-row-selected",n);const s=i.element;_M(s,n),s.contains(Fr(this.beans))&&t(i)})}announceAriaRowSelection(e){if(this.isRowSelectionBlocked(e))return;const t=e.isSelected(),r=this.beans.editSvc?.isEditing({rowNode:e});if(!e.selectable||r)return;const i=this.getLocaleTextFunc()(t?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${t?"deselect":"select"} this row`);this.beans.ariaAnnounce?.announceValue(i,"rowSelection")}isRowSelectionBlocked(e){return!e.selectable||e.rowPinned&&!$f(e)||!Vl(this.gos)}updateRowSelectable(e,t){const r=e.rowPinned&&e.pinnedSibling?e.pinnedSibling.selectable:this.isRowSelectable?.(e)??!0;return this.setRowSelectable(e,r,t),r}setRowSelectable(e,t,r){if(e.selectable!==t){if(e.selectable=t,e.dispatchRowEvent("selectableChanged"),r)return;if(df(this.gos)){const i=this.calculateSelectedFromChildren(e);this.setNodesSelected({nodes:[e],newValue:i??!1,source:"selectableChanged"});return}e.isSelected()&&!e.selectable&&this.setNodesSelected({nodes:[e],newValue:!1,source:"selectableChanged"})}}calculateSelectedFromChildren(e){let t=!1,r=!1;if(!e.childrenAfterGroup?.length)return e.selectable?e.__selected:null;for(let n=0;n<e.childrenAfterGroup.length;n++){const i=e.childrenAfterGroup[n];let s=i.isSelected();if(!i.selectable){const o=this.calculateSelectedFromChildren(i);if(o===null)continue;s=o}switch(s){case!0:t=!0;break;case!1:r=!0;break;default:return}}if(!(t&&r))return t?!0:r?!1:e.selectable?e.__selected:null}selectRowNode(e,t,r,n="api"){const i=!e.selectable&&t,s=e.__selected===t;if(i||s)return!1;e.__selected=t,e.dispatchRowEvent("rowSelected");const o=e.sibling;o&&o.footer&&o.__localEventService&&o.dispatchRowEvent("rowSelected");const a=e.pinnedSibling;return a?.rowPinned&&a.__localEventService&&a.dispatchRowEvent("rowSelected"),this.eventSvc.dispatchEvent({...iU(e,this.gos,"rowSelected"),event:r||null,source:n}),!0}isCellCheckboxSelection(e,t){const r=this.gos.get("rowSelection");if(r&&typeof r!="string"){const n=ea(e)&&Mu(r);return e.isColumnFunc(t,n)}else return e.isColumnFunc(t,e.colDef.checkboxSelection)}inferNodeSelections(e,t,r,n){const{gos:i,selectionCtx:s}=this,o=e.isSelected(),a=df(i),u=R7(i),d=T7(i),h=this.isMultiSelect(),g=n==="rowClicked";if(g&&!(u||d))return null;if(t&&r&&h){const m=s.getRoot();if(m)if(m.isSelected()){const v=s.isInRange(e)?s.truncate(e):s.extend(e,a);return{deselect:v.discard,select:v.keep,reset:!1}}else{const v=s.extend(e,a);return{select:[],deselect:v.keep,reset:!1}}else return null}else if(t&&h){const m=s.selectAll?this.beans.rowModel.getRow(0):void 0,v=s.getRoot(m),w=s.isInRange(e)?s.truncate(e):s.extend(e,a);return{select:w.keep,deselect:w.discard,reset:s.selectAll||!!(v&&!v.isSelected())}}else if(r){if(g){const m=!o;return m&&!u||!m&&!d?null:(s.setRoot(e),{node:e,newValue:m,clearSelection:!1})}return s.setRoot(e),{node:e,newValue:!o,clearSelection:!h}}else{s.setRoot(e);const m=F7(i),v=_0(i)==="filteredDescendants",w=g&&(!m||!u);if(v&&o===void 0&&_r(i))return{node:e,newValue:!1,checkFilteredNodes:!0,clearSelection:!h||w};if(g){const C=o?!m:u;return C===o&&!w||C&&!u||!C&&!d?null:{node:e,newValue:C,clearSelection:!h||w,keepDescendants:e.group&&a}}return{node:e,newValue:!o,clearSelection:!h||w}}}},Ou={TAB_GUARD:"ag-tab-guard",TAB_GUARD_TOP:"ag-tab-guard-top",TAB_GUARD_BOTTOM:"ag-tab-guard-bottom"},gL=class extends Ee{constructor(e){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1,this.allowFocus=!1;const{comp:t,eTopGuard:r,eBottomGuard:n,focusTrapActive:i,forceFocusOutWhenTabGuardsAreEmpty:s,isFocusableContainer:o,focusInnerElement:a,onFocusIn:u,onFocusOut:d,shouldStopEventPropagation:h,onTabKeyDown:g,handleKeyDown:m,isEmpty:v,eFocusableElement:w}=e;this.comp=t,this.eTopGuard=r,this.eBottomGuard=n,this.providedFocusInnerElement=a,this.eFocusableElement=w,this.focusTrapActive=!!i,this.forceFocusOutWhenTabGuardsAreEmpty=!!s,this.isFocusableContainer=!!o,this.providedFocusIn=u,this.providedFocusOut=d,this.providedShouldStopEventPropagation=h,this.providedOnTabKeyDown=g,this.providedHandleKeyDown=m,this.providedIsEmpty=v}postConstruct(){this.createManagedBean(new wd(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards();for(const e of[this.eTopGuard,this.eBottomGuard])this.addManagedElementListeners(e,{focus:this.onFocus.bind(this)})}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return this.providedShouldStopEventPropagation?this.providedShouldStopEventPropagation():!1}activateTabGuards(){if(this.forcingFocusOut)return;const e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.isFocusableContainer&&!this.eFocusableElement.contains(e.relatedTarget)&&!this.allowFocus){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.skipTabGuardFocus){this.skipTabGuardFocus=!1;return}if(this.forceFocusOutWhenTabGuardsAreEmpty&&(this.providedIsEmpty?this.providedIsEmpty():Lu(this.eFocusableElement,".ag-tab-guard").length===0)){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.isFocusableContainer&&this.eFocusableElement.contains(e.relatedTarget))return;const t=e.target===this.eBottomGuard;!(this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t))&&this.forceFocusOutWhenTabGuardsAreEmpty&&this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard)}findNextElementOutsideAndFocus(e){const t=un(this.beans),r=Lu(t.body,null,!0),n=r.indexOf(e?this.eTopGuard:this.eBottomGuard);if(n===-1)return;let i,s;e?(i=0,s=n):(i=n+1,s=r.length);const o=r.slice(i,s),a=this.gos.get("tabIndex");o.sort((u,d)=>{const h=Number.parseInt(u.getAttribute("tabindex")||"0"),g=Number.parseInt(d.getAttribute("tabindex")||"0");return g===a?1:h===a?-1:h===0?1:g===0?-1:h-g}),o[e?o.length-1:0]?.focus()}onFocusIn(e){this.focusTrapActive||this.forcingFocusOut||(this.providedFocusIn&&this.providedFocusIn(e),this.isFocusableContainer||this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown){this.providedOnTabKeyDown(e);return}if(this.focusTrapActive||e.defaultPrevented)return;const t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();const r=this.getNextFocusableElement(e.shiftKey);t&&setTimeout(()=>this.activateTabGuards(),0),r&&(r.focus(),e.preventDefault())}focusInnerElement(e=!1){const t=Lu(this.eFocusableElement);return this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length?(t[e?t.length-1:0].focus({preventScroll:!0}),!0):!1}getNextFocusableElement(e){return vc(this.beans,this.eFocusableElement,!1,e)}forceFocusOutOfContainer(e=!1){if(this.forcingFocusOut)return;const t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(e,t){return e===this.eTopGuard&&!t||e===this.eBottomGuard&&(t??!0)}setAllowFocus(e){this.allowFocus=e}},$$=class extends Ee{constructor(e){super(),this.comp=e}initialiseTabGuard(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.comp.getFocusableElement();const{eTopGuard:t,eBottomGuard:r,eFocusableElement:n}=this,i=[t,r],s={setTabIndex:b=>{for(const x of i)b!=null?x.setAttribute("tabindex",b):x.removeAttribute("tabindex")}};this.addTabGuards(t,r);const{focusTrapActive:o=!1,onFocusIn:a,onFocusOut:u,focusInnerElement:d,handleKeyDown:h,onTabKeyDown:g,shouldStopEventPropagation:m,isEmpty:v,forceFocusOutWhenTabGuardsAreEmpty:w,isFocusableContainer:C}=e;this.tabGuardCtrl=this.createManagedBean(new gL({comp:s,focusTrapActive:o,eTopGuard:t,eBottomGuard:r,eFocusableElement:n,onFocusIn:a,onFocusOut:u,focusInnerElement:d,handleKeyDown:h,onTabKeyDown:g,shouldStopEventPropagation:m,isEmpty:v,forceFocusOutWhenTabGuardsAreEmpty:w,isFocusableContainer:C}))}getTabGuardCtrl(){return this.tabGuardCtrl}createTabGuard(e){const t=un(this.beans).createElement("div"),r=e==="top"?Ou.TAB_GUARD_TOP:Ou.TAB_GUARD_BOTTOM;return t.classList.add(Ou.TAB_GUARD,r),Jl(t,"presentation"),t}addTabGuards(e,t){const r=this.eFocusableElement;r.insertAdjacentElement("afterbegin",e),r.insertAdjacentElement("beforeend",t)}removeAllChildrenExceptTabGuards(){const e=[this.eTopGuard,this.eBottomGuard];ci(this.comp.getFocusableElement()),this.addTabGuards(...e)}forceFocusOutOfContainer(e=!1){this.tabGuardCtrl.forceFocusOutOfContainer(e)}appendChild(e,t,r){nx(t)||(t=t.getGui());const{eBottomGuard:n}=this;n?n.insertAdjacentElement("beforebegin",t):e(t,r)}destroy(){const{eTopGuard:e,eBottomGuard:t}=this;Ua(e),Ua(t),super.destroy()}},j$=class extends Dr{initialiseTabGuard(t){this.tabGuardFeature=this.createManagedBean(new $$(this)),this.tabGuardFeature.initialiseTabGuard(t)}forceFocusOutOfContainer(t=!1){this.tabGuardFeature.forceFocusOutOfContainer(t)}appendChild(t,r){this.tabGuardFeature.appendChild(super.appendChild.bind(this),t,r)}},Y$=500,K$=550,_p,q$=e=>{if(!_p)_p=new WeakSet;else if(_p.has(e))return!1;return _p.add(e),!0},Pl=class{constructor(e,t=!1){this.eElement=e,this.preventClick=t,this.startListener=null,this.handlers=[],this.eventSvc=void 0,this.touchStart=null,this.lastTapTime=null,this.longPressTimer=0,this.moved=!1}addEventListener(e,t){let r=this.eventSvc;if(!r){if(r===null)return;this.eventSvc=r=new Zl;const n=this.onTouchStart.bind(this);this.startListener=n,this.eElement.addEventListener("touchstart",n,{passive:!0})}r.addEventListener(e,t)}removeEventListener(e,t){this.eventSvc?.removeEventListener(e,t)}onTouchStart(e){if(this.touchStart||!q$(e))return;const t=e.touches[0];this.touchStart=t;const r=this.handlers;if(!r.length){const n=this.eElement,i=n.ownerDocument,s=this.onTouchMove.bind(this),o=this.onTouchEnd.bind(this),a=this.onTouchCancel.bind(this),u={passive:!0},d={passive:!1};e0(r,[n,"touchmove",s,u],[i,"touchcancel",a,u],[i,"touchend",o,d],[i,"contextmenu",Oa,d])}this.clearLongPress(),this.longPressTimer=window.setTimeout(()=>{this.longPressTimer=0,this.touchStart===t&&!this.moved&&(this.moved=!0,this.eventSvc?.dispatchEvent({type:"longTap",touchStart:t,touchEvent:e}))},K$)}onTouchMove(e){const{moved:t,touchStart:r}=this;if(!t&&r){const n=Nh(r,e.touches);n&&!VM(n,r,4)&&(this.clearLongPress(),this.moved=!0)}}onTouchEnd(e){const t=this.touchStart;!t||!Nh(t,e.changedTouches)||(this.moved||(this.eventSvc?.dispatchEvent({type:"tap",touchStart:t}),this.checkDoubleTap(t)),this.preventClick&&Oa(e),this.cancel())}onTouchCancel(e){const t=this.touchStart;!t||!Nh(t,e.changedTouches)||(this.lastTapTime=null,this.cancel())}checkDoubleTap(e){let t=Date.now();const r=this.lastTapTime;r&&t-r>Y$&&(this.eventSvc?.dispatchEvent({type:"doubleTap",touchStart:e}),t=null),this.lastTapTime=t}cancel(){this.clearLongPress(),ix(this.handlers),this.touchStart=null}clearLongPress(){window.clearTimeout(this.longPressTimer),this.longPressTimer=0,this.moved=!1}destroy(){const e=this.startListener;e&&(this.startListener=null,this.eElement.removeEventListener("touchstart",e)),this.cancel(),this.eElement=null,this.eventSvc=null}},X$=class{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=e.scrollAxis.includes("x"),this.scrollVertically=e.scrollAxis.includes("y"),this.scrollByTick=e.scrollByTick!=null?e.scrollByTick:20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}get scrolling(){return this.tickingInterval!==null}check(e,t=!1){const r=t||this.shouldSkipVerticalScroll();if(r&&this.shouldSkipHorizontalScroll())return;const n=this.scrollContainer.getBoundingClientRect(),i=this.scrollByTick;this.tickLeft=e.clientX<n.left+i,this.tickRight=e.clientX>n.right-i,this.tickUp=e.clientY<n.top+i&&!r,this.tickDown=e.clientY>n.bottom-i&&!r,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){this.tickingInterval===null&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;const e=this.tickCount>20?200:this.tickCount>10?80:40;if(this.scrollVertically){const t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){const t=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(t-e),this.tickRight&&this.setHorizontalPosition(t+e)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}},pL=class{constructor(e="javascript"){this.frameworkName=e,this.renderingEngine="vanilla",this.batchFrameworkComps=!1,this.wrapIncoming=t=>t(),this.wrapOutgoing=t=>t(),this.baseDocLink=`${jM}/${this.frameworkName}-data-grid`,g7(this.baseDocLink)}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){return this.baseDocLink+(e?"/"+e:"")}};function Q$(e){return{beanName:"gridApi",bean:e.getBean("apiFunctionSvc").api}}var Z$=["licenseManager","environment","eventSvc","gos","paginationAutoPageSizeSvc","apiFunctionSvc","gridApi","registry","agCompUtils","userCompFactory","rowContainerHeight","horizontalResizeSvc","localeSvc","pinnedRowModel","dragSvc","colGroupSvc","visibleCols","popupSvc","selectionSvc","colFilter","quickFilter","filterManager","colModel","headerNavigation","pageBounds","pagination","pageBoundsListener","rowSpanSvc","stickyRowSvc","rowRenderer","expressionSvc","alignedGridsSvc","navigation","valueCache","valueSvc","autoWidthCalc","filterMenuFactory","dragAndDrop","focusSvc","cellNavigation","cellStyles","scrollVisibleSvc","sortSvc","colHover","colAnimation","autoColSvc","selectionColSvc","changeDetectionSvc","animationFrameSvc","undoRedo","colDefFactory","rowStyleSvc","rowNodeBlockLoader","rowNodeSorter","ctrlsSvc","pinnedCols","dataTypeSvc","syncSvc","overlays","stateSvc","expansionSvc","apiEventSvc","ariaAnnounce","menuSvc","colMoves","colAutosize","colFlex","colResize","pivotColsSvc","valueColsSvc","rowGroupColsSvc","colNames","colViewport","pivotResultCols","showRowGroupCols","validation"],xD=Object.fromEntries(Z$.map((e,t)=>[e,t]));function J$(e,t){const r=(e.beanName?xD[e.beanName]:void 0)??Number.MAX_SAFE_INTEGER,n=(t.beanName?xD[t.beanName]:void 0)??Number.MAX_SAFE_INTEGER;return r-n}function ej(e,t){return e?.beanName==="gridDestroySvc"?-1:t?.beanName==="gridDestroySvc"?1:0}var tj=class extends Ee{constructor(){super(...arguments),this.additionalFocusableContainers=new Set}setComp(e,t,r){this.view=e,this.eGridHostDiv=t,this.eGui=r,this.eGui.setAttribute("grid-id",this.beans.context.getId());const{dragAndDrop:n,ctrlsSvc:i}=this.beans;n?.registerGridDropTarget(()=>this.eGui,this),this.createManagedBean(new xx(this.view)),this.view.setRtlClass(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr");const s=Zo(this.beans,this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>s()),i.register("gridCtrl",this)}isDetailGrid(){return P_(this.getGui())?.getAttribute("row-id")?.startsWith("detail")||!1}getOptionalSelectors(){const e=this.beans;return{paginationSelector:e.pagination?.getPaginationSelector(),gridHeaderDropZonesSelector:e.registry?.getSelector("AG-GRID-HEADER-DROP-ZONES"),sideBarSelector:e.sideBar?.getSelector(),statusBarSelector:e.registry?.getSelector("AG-STATUS-BAR"),watermarkSelector:e.licenseManager?.getWatermarkSelector()}}onGridSizeChanged(){this.eventSvc.dispatchEvent({type:"gridSizeChanged",clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight})}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){const{view:t}=this;if(e===!1)t.setCursor(null);else{const r=e===1?"ew-resize":"ns-resize";t.setCursor(r)}}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){const t=this.getFocusableContainers(),{indexWithFocus:r,nextIndex:n}=this.getNextFocusableIndex(t,e);if(n<0||n>=t.length)return!1;if(n===0){if(r>0){const{visibleCols:i,focusSvc:s}=this.beans,o=i.allCols,a=ir(o);if(s.focusGridView({column:a,backwards:!0}))return!0}return!1}return this.focusContainer(t[n],e)}focusInnerElement(e){if(this.gos.getCallback("focusGridInnerElement")?.({fromBottom:!!e}))return!0;const r=this.getFocusableContainers(),{focusSvc:n,visibleCols:i}=this.beans,s=i.allCols;if(e){if(r.length>1)return this.focusContainer(ir(r),e);const o=ir(s);if(n.focusGridView({column:o,backwards:e}))return!0}if(this.gos.get("headerHeight")===0||Ul(this.beans)){if(n.focusGridView({column:s[0],backwards:e}))return!0;for(let o=1;o<r.length;o++)if(rc(r[o].getGui(),e))return!0;return!1}return n.focusFirstHeader()}forceFocusOutOfContainer(e=!1){this.view.forceFocusOutOfContainer(e)}addFocusableContainer(e){this.additionalFocusableContainers.add(e)}removeFocusableContainer(e){this.additionalFocusableContainers.delete(e)}allowFocusForNextCoreContainer(e){const t=this.view.getFocusableContainers(),{nextIndex:r,indexWithFocus:n}=this.getNextFocusableIndex(t,e);if(n===-1||r<0||r>=t.length)return;const i=t[r];i.setAllowFocus?.(!0),setTimeout(()=>{i.setAllowFocus?.(!1)})}isFocusable(){const e=this.beans;return!Xm(e)||!Ul(e)||!!e.sideBar?.comp?.isDisplayed()}getNextFocusableIndex(e,t){const r=Fr(this.beans),n=e.findIndex(s=>s.getGui().contains(r)),i=n+(t?-1:1);return{indexWithFocus:n,nextIndex:i}}focusContainer(e,t){e.setAllowFocus?.(!0);const r=rc(e.getGui(),t,!1,!0);return e.setAllowFocus?.(!1),r}getFocusableContainers(){return[...this.view.getFocusableContainers(),...this.additionalFocusableContainers]}destroy(){this.additionalFocusableContainers.clear(),super.destroy()}},ft=(e,t)=>{for(const r of Object.keys(t))t[r]=e;return t},ED={dispatchEvent:"CommunityCore",...ft("CommunityCore",{destroy:0,getGridId:0,getGridOption:0,isDestroyed:0,setGridOption:0,updateGridOptions:0,isModuleRegistered:0}),...ft("GridState",{getState:0,setState:0}),...ft("SharedRowSelection",{setNodesSelected:0,selectAll:0,deselectAll:0,selectAllFiltered:0,deselectAllFiltered:0,selectAllOnCurrentPage:0,deselectAllOnCurrentPage:0,getSelectedNodes:0,getSelectedRows:0}),...ft("RowApi",{redrawRows:0,setRowNodeExpanded:0,getRowNode:0,addRenderedRowListener:0,getRenderedNodes:0,forEachNode:0,getFirstDisplayedRowIndex:0,getLastDisplayedRowIndex:0,getDisplayedRowAtIndex:0,getDisplayedRowCount:0}),...ft("ScrollApi",{getVerticalPixelRange:0,getHorizontalPixelRange:0,ensureColumnVisible:0,ensureIndexVisible:0,ensureNodeVisible:0}),...ft("KeyboardNavigation",{getFocusedCell:0,clearFocusedCell:0,setFocusedCell:0,tabToNextCell:0,tabToPreviousCell:0,setFocusedHeader:0}),...ft("EventApi",{addEventListener:0,addGlobalListener:0,removeEventListener:0,removeGlobalListener:0}),...ft("ValueCache",{expireValueCache:0}),...ft("CellApi",{getCellValue:0}),...ft("SharedMenu",{showColumnMenu:0,hidePopupMenu:0}),...ft("Sort",{onSortChanged:0}),...ft("PinnedRow",{getPinnedTopRowCount:0,getPinnedBottomRowCount:0,getPinnedTopRow:0,getPinnedBottomRow:0,forEachPinnedRow:0}),...ft("Overlay",{showLoadingOverlay:0,showNoRowsOverlay:0,hideOverlay:0}),...ft("RenderApi",{setGridAriaProperty:0,refreshCells:0,refreshHeader:0,isAnimationFrameQueueEmpty:0,flushAllAnimationFrames:0,getSizesForCurrentTheme:0,getCellRendererInstances:0}),...ft("HighlightChanges",{flashCells:0}),...ft("RowDrag",{addRowDropZone:0,removeRowDropZone:0,getRowDropZoneParams:0,getRowDropPositionIndicator:0,setRowDropPositionIndicator:0}),...ft("ColumnApi",{getColumnDefs:0,getColumnDef:0,getDisplayNameForColumn:0,getColumn:0,getColumns:0,applyColumnState:0,getColumnState:0,resetColumnState:0,isPinning:0,isPinningLeft:0,isPinningRight:0,getDisplayedColAfter:0,getDisplayedColBefore:0,setColumnsVisible:0,setColumnsPinned:0,getAllGridColumns:0,getDisplayedLeftColumns:0,getDisplayedCenterColumns:0,getDisplayedRightColumns:0,getAllDisplayedColumns:0,getAllDisplayedVirtualColumns:0}),...ft("ColumnAutoSize",{sizeColumnsToFit:0,autoSizeColumns:0,autoSizeAllColumns:0}),...ft("ColumnGroup",{setColumnGroupOpened:0,getColumnGroup:0,getProvidedColumnGroup:0,getDisplayNameForColumnGroup:0,getColumnGroupState:0,setColumnGroupState:0,resetColumnGroupState:0,getLeftDisplayedColumnGroups:0,getCenterDisplayedColumnGroups:0,getRightDisplayedColumnGroups:0,getAllDisplayedColumnGroups:0}),...ft("ColumnMove",{moveColumnByIndex:0,moveColumns:0}),...ft("ColumnResize",{setColumnWidths:0}),...ft("ColumnHover",{isColumnHovered:0}),...ft("EditCore",{getCellEditorInstances:0,getEditingCells:0,getEditRowValues:0,stopEditing:0,startEditingCell:0,isEditing:0,validateEdit:0}),...ft("BatchEdit",{startBatchEdit:0,cancelBatchEdit:0,commitBatchEdit:0,isBatchEditing:0}),...ft("UndoRedoEdit",{undoCellEditing:0,redoCellEditing:0,getCurrentUndoSize:0,getCurrentRedoSize:0}),...ft("FilterCore",{isAnyFilterPresent:0,onFilterChanged:0}),...ft("ColumnFilter",{isColumnFilterPresent:0,getColumnFilterInstance:0,destroyFilter:0,setFilterModel:0,getFilterModel:0,getColumnFilterModel:0,setColumnFilterModel:0,showColumnFilter:0,hideColumnFilter:0,getColumnFilterHandler:0,doFilterAction:0}),...ft("QuickFilter",{isQuickFilterPresent:0,getQuickFilter:0,resetQuickFilter:0}),...ft("Find",{findGetActiveMatch:0,findGetTotalMatches:0,findGoTo:0,findNext:0,findPrevious:0,findGetNumMatches:0,findGetParts:0,findClearActive:0,findRefresh:0}),...ft("Pagination",{paginationIsLastPageFound:0,paginationGetPageSize:0,paginationGetCurrentPage:0,paginationGetTotalPages:0,paginationGetRowCount:0,paginationGoToNextPage:0,paginationGoToPreviousPage:0,paginationGoToFirstPage:0,paginationGoToLastPage:0,paginationGoToPage:0}),...ft("CsrmSsrmSharedApi",{expandAll:0,collapseAll:0}),...ft("SsrmInfiniteSharedApi",{setRowCount:0,getCacheBlockState:0,isLastRowIndexKnown:0}),...ft("ClientSideRowModelApi",{onGroupExpandedOrCollapsed:0,refreshClientSideRowModel:0,isRowDataEmpty:0,forEachLeafNode:0,forEachNodeAfterFilter:0,forEachNodeAfterFilterAndSort:0,applyTransaction:0,applyTransactionAsync:0,flushAsyncTransactions:0,getBestCostNodeSelection:0,onRowHeightChanged:0,resetRowHeights:0}),...ft("CsvExport",{getDataAsCsv:0,exportDataAsCsv:0}),...ft("InfiniteRowModel",{refreshInfiniteCache:0,purgeInfiniteCache:0,getInfiniteRowCount:0}),...ft("AdvancedFilter",{getAdvancedFilterModel:0,setAdvancedFilterModel:0,showAdvancedFilterBuilder:0,hideAdvancedFilterBuilder:0}),...ft("IntegratedCharts",{getChartModels:0,getChartRef:0,getChartImageDataURL:0,downloadChart:0,openChartToolPanel:0,closeChartToolPanel:0,createRangeChart:0,createPivotChart:0,createCrossFilterChart:0,updateChart:0,restoreChart:0}),...ft("Clipboard",{copyToClipboard:0,cutToClipboard:0,copySelectedRowsToClipboard:0,copySelectedRangeToClipboard:0,copySelectedRangeDown:0,pasteFromClipboard:0}),...ft("ExcelExport",{getDataAsExcel:0,exportDataAsExcel:0,getSheetDataForExcel:0,getMultipleSheetsAsExcel:0,exportMultipleSheetsAsExcel:0}),...ft("SharedMasterDetail",{addDetailGridInfo:0,removeDetailGridInfo:0,getDetailGridInfo:0,forEachDetailGridInfo:0}),...ft("ContextMenu",{showContextMenu:0}),...ft("ColumnMenu",{showColumnChooser:0,hideColumnChooser:0}),...ft("CellSelection",{getCellRanges:0,addCellRange:0,clearRangeSelection:0,clearCellSelection:0}),...ft("SharedRowGrouping",{setRowGroupColumns:0,removeRowGroupColumns:0,addRowGroupColumns:0,getRowGroupColumns:0,moveRowGroupColumn:0}),...ft("SharedAggregation",{addAggFuncs:0,clearAggFuncs:0,setColumnAggFunc:0}),...ft("SharedPivot",{isPivotMode:0,getPivotResultColumn:0,setValueColumns:0,getValueColumns:0,removeValueColumns:0,addValueColumns:0,setPivotColumns:0,removePivotColumns:0,addPivotColumns:0,getPivotColumns:0,setPivotResultColumns:0,getPivotResultColumns:0}),...ft("ServerSideRowModelApi",{getServerSideSelectionState:0,setServerSideSelectionState:0,applyServerSideTransaction:0,applyServerSideTransactionAsync:0,applyServerSideRowData:0,retryServerSideLoads:0,flushServerSideAsyncTransactions:0,refreshServerSide:0,getServerSideGroupLevelState:0,onRowHeightChanged:0,resetRowHeights:0}),...ft("SideBar",{isSideBarVisible:0,setSideBarVisible:0,setSideBarPosition:0,openToolPanel:0,closeToolPanel:0,getOpenedToolPanel:0,refreshToolPanel:0,isToolPanelShowing:0,getToolPanelInstance:0,getSideBar:0}),...ft("StatusBar",{getStatusPanel:0}),...ft("AiToolkit",{getStructuredSchema:0})},xy={isDestroyed:()=>!0,destroy(){},preConstruct(){},postConstruct(){},preWireBeans(){},wireBeans(){}},rj=(e,t)=>e.eventSvc.dispatchEvent(t),mL=class{};Reflect.defineProperty(mL,"name",{value:"GridApi"});var nj=class extends Ee{constructor(){super(),this.beanName="apiFunctionSvc",this.api=new mL,this.fns={...xy,dispatchEvent:rj},this.preDestroyLink="";const{api:e}=this;for(const t of Object.keys(ED))e[t]=this.makeApi(t)[t]}postConstruct(){this.preDestroyLink=this.beans.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}addFunction(e,t){const{fns:r,beans:n}=this;r!==xy&&(r[e]=n?.validation?.validateApiFunction(e,t)??t)}makeApi(e){return{[e]:(...t)=>{const{beans:r,fns:{[e]:n}}=this;return n?n(r,...t):this.apiNotFound(e)}}}apiNotFound(e){const{beans:t,gos:r,preDestroyLink:n}=this;if(!t)Me(26,{fnName:e,preDestroyLink:n});else{const i=ED[e];r.assertModuleRegistered(i,`api.${e}`)&&Me(27,{fnName:e,module:i})}}destroy(){super.destroy(),this.fns=xy,this.beans=null}};function ij(e){return e.context.getId()}function sj(e){e.gridDestroySvc.destroy()}function oj(e){return e.gridDestroySvc.destroyCalled}function aj(e,t){return e.gos.get(t)}function lj(e,t,r){vL(e,{[t]:r})}function vL(e,t){e.gos.updateGridOptions({options:t})}function cj(e,t){const r=t.replace(/Module$/,"");return e.gos.isModuleRegistered(r)}var uj={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{draggable:"true"}},dj=class extends Dr{constructor(e,t,r){super(uj),this.rowNode=e,this.column=t,this.eCell=r}postConstruct(){this.getGui().appendChild(ts("rowDrag",this.beans,null)),this.addGuiEventListener("mousedown",t=>{t.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(e){const{rowNode:t,column:r,eCell:n,gos:i}=this,s=r.getColDef().dndSourceOnRowDrag,o=e.dataTransfer;if(o.setDragImage(n,0,0),s){const a=it(i,{rowNode:t,dragEvent:e});s(a)}else try{const a=JSON.stringify(t.data);o.setData("application/json",a),o.setData("text/plain",a)}catch{}}checkVisibility(){const e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}};function hj(e,t){e.rowDragSvc?.rowDragFeature?.addRowDropZone(t)}function fj(e,t){const r=e.dragAndDrop?.findExternalZone(t.getContainer());r&&e.dragAndDrop?.removeDropTarget(r)}function gj(e,t){return e.rowDragSvc?.rowDragFeature?.getRowDropZone(t)}function pj(e){const t=e.rowDropHighlightSvc;return t?{row:t.row,dropIndicatorPosition:t.position}:{row:null,dropIndicatorPosition:"none"}}function mj(e,t){const r=e.rowDropHighlightSvc;if(!r)return;const n=t?.row;let i=t?.dropIndicatorPosition;i!=="above"&&i!=="below"&&i!=="inside"&&(i="none");const s=n?.rowIndex;s==null||i==="none"?r.clear():r.set(n,i)}var vj=class extends eU{shouldPreventMouseEvent(e){return this.gos.get("enableCellTextSelection")&&super.shouldPreventMouseEvent(e)}},wj=class extends Ee{constructor(){super(...arguments),this.beanName="horizontalResizeSvc"}addResizeBar(e){const t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),onDragCancel:this.onDragStop.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0},{dragSvc:r}=this.beans;return r.addDragSource(t),()=>r.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();const r=t instanceof MouseEvent&&t.shiftKey===!0;e.onResizeStart(r)}setResizeIcons(){const e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(1),e.disableUserSelect(!0)}onDragStop(e){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}},Cj={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{"aria-hidden":"true"}},yj=class extends Dr{constructor(e,t,r,n,i,s=!1){super(),this.cellValueFn=e,this.rowNode=t,this.column=r,this.customGui=n,this.dragStartPixels=i,this.alwaysVisible=s,this.dragSource=null}isCustomGui(){return this.customGui!=null}postConstruct(){const{beans:e,customGui:t}=this;t?this.setDragElement(t,this.dragStartPixels):(this.setTemplate(Cj),this.getGui().appendChild(ts("rowDrag",e,null)),this.addDragSource()),this.alwaysVisible||this.initCellDrag()}initCellDrag(){const{beans:e,gos:t,rowNode:r}=this,n=this.refreshVisibility.bind(this);this.addManagedPropertyListener("suppressRowDrag",n),this.addManagedListeners(r,{dataChanged:n,cellChanged:n}),this.addManagedListeners(e.eventSvc,t.get("rowDragManaged")?{sortChanged:n,filterChanged:n,columnRowGroupChanged:n,newColumnsLoaded:n}:{newColumnsLoaded:n})}setDragElement(e,t){this.setTemplateFromElement(e,void 0,void 0,!0),this.addDragSource(t)}refreshVisibility(){if(this.alwaysVisible)return;const e={skipAriaHidden:!0};if(this.isNeverDisplayed()){this.setDisplayed(!1,e);return}const t=this.column;let r=typeof t?.getColDef().rowDrag=="function",n=!t||this.isCustomGui()||t.isRowDrag(this.rowNode);n&&this.rowNode.footer&&this.gos.get("rowDragManaged")&&(n=!1,r=!0),this.setDisplayed(r||n,e),this.setVisible(n,e)}isNeverDisplayed(){const{gos:e,beans:t}=this;return!!(e.get("suppressRowDrag")||e.get("rowDragManaged")&&t.rowDragSvc.rowDragFeature?.shouldPreventRowMove()&&!t.dragAndDrop?.hasExternalDropZones())}getSelectedNodes(){const e=this.rowNode;if(!this.gos.get("rowDragMultiRow"))return[e];const r=this.beans.selectionSvc?.getSelectedNodes()??[];return r.indexOf(e)!==-1?r:[e]}getDragItem(){const{column:e,rowNode:t}=this;return{rowNode:t,rowNodes:this.getSelectedNodes(),columns:e?[e]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(e){if(e){const t=e.getColDef();if(t.rowDragText)return t.rowDragText}return this.gos.get("rowDragText")}addDragSource(e=4){if(this.dragSource&&this.removeDragSource(),this.gos.get("rowDragManaged")&&this.rowNode.footer)return;const t=this.getGui();this.gos.get("enableCellTextSelection")&&(this.removeMouseDownListener(),this.mouseDownListener=this.addManagedElementListeners(t,{mousedown:n=>{n?.preventDefault()}})[0]);const r=this.getLocaleTextFunc();this.dragSource={type:2,eElement:t,dragItemName:n=>{const i=n?.dragItem||this.getDragItem(),s=(n?.dropTarget?.rows.length??i.rowNodes?.length)||1,o=this.getRowDragText(this.column);return o?o(i,s):s===1?this.cellValueFn():`${s} ${r("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDrop.addDragSource(this.dragSource,!0)}destroy(){this.removeDragSource(),this.removeMouseDownListener(),super.destroy()}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop.removeDragSource(this.dragSource),this.dragSource=null)}removeMouseDownListener(){this.mouseDownListener&&(this.mouseDownListener(),this.mouseDownListener=void 0)}},c0=class{constructor(){this.reordered=!1,this.removals=new Set,this.updates=new Set,this.adds=new Set}};function bj(e){const{rowIndex:t,rowPinned:r,column:n}=e;return`${t}.${r??"null"}.${n.getId()}`}function wL(e,t){const r=e.column===t.column,n=e.rowPinned===t.rowPinned,i=e.rowIndex===t.rowIndex;return r&&n&&i}function Sj(e,t){switch(e.rowPinned){case"top":if(t.rowPinned!=="top")return!0;break;case"bottom":if(t.rowPinned!=="bottom")return!1;break;default:if($e(t.rowPinned))return t.rowPinned!=="top";break}return e.rowIndex<t.rowIndex}function xj(e,t){return!e&&!t?!0:e&&!t||!e&&t?!1:e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned}function Ej(e){let t=0,r;const{pinnedRowModel:n,rowModel:i,pageBounds:s}=e;return n?.getPinnedTopRowCount()?r="top":i.getRowCount()?(r=null,t=s.getFirstRow()):n?.getPinnedBottomRowCount()&&(r="bottom"),r===void 0?null:{rowIndex:t,rowPinned:r}}function Rj(e){let t,r=null;const{pinnedRowModel:n,pageBounds:i}=e,s=n?.getPinnedBottomRowCount(),o=n?.getPinnedTopRowCount();return s?(r="bottom",t=s-1):e.rowModel.getRowCount()?t=i.getLastRow():o&&(r="top",t=o-1),t===void 0?null:{rowIndex:t,rowPinned:r}}function Yo(e,t){switch(t.rowPinned){case"top":return e.pinnedRowModel?.getPinnedTopRow(t.rowIndex);case"bottom":return e.pinnedRowModel?.getPinnedBottomRow(t.rowIndex);default:return e.rowModel.getRow(t.rowIndex)}}function Ru(e,t){const r=e.spannedRowRenderer?.getCellByPosition(t);if(r)return r;const n=e.rowRenderer.getRowByPosition(t);return n?n.getCellCtrl(t.column):null}function Tj(e,t,r){const{rowModel:n,pinnedRowModel:i}=e;let s;return s??(s=n?.getRowNode(t)),r?s??(s=i?.getPinnedRowById(t,r)):(s??(s=i?.getPinnedRowById(t,"top")),s??(s=i?.getPinnedRowById(t,"bottom"))),s}function z0(e,t,r=!1){const{rowIndex:n,rowPinned:i}=t,{pageBounds:s,pinnedRowModel:o,rowModel:a}=e;if(n===0)return i==="top"?null:i==="bottom"&&a.isRowsToRender()?{rowIndex:s.getLastRow(),rowPinned:null}:o?.isRowsToRender("top")?{rowIndex:o.getPinnedTopRowCount()-1,rowPinned:"top"}:null;if(r){const u=i?void 0:a.getRow(n);return CL(e,u,!0)??{rowIndex:n-1,rowPinned:i}}return{rowIndex:n-1,rowPinned:i}}function RD(e,t,r=!1){const{rowIndex:n,rowPinned:i}=t,{pageBounds:s,pinnedRowModel:o,rowModel:a}=e;if(Fj(e,t))return i==="bottom"?null:i==="top"&&a.isRowsToRender()?{rowIndex:s.getFirstRow(),rowPinned:null}:o?.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;if(r){const u=i?void 0:a.getRow(n);return CL(e,u)??{rowIndex:n+1,rowPinned:i}}return{rowIndex:n+1,rowPinned:i}}function CL(e,t,r=!1){const{gos:n,rowRenderer:i}=e;if(!t?.sticky||!n_(n))return;const s=i.getStickyTopRowCtrls(),o=i.getStickyBottomRowCtrls(),a=!o.some(g=>g.rowNode.rowIndex===t.rowIndex),u=a?s:o,d=(r?-1:1)*(a?-1:1);let h;for(let g=0;g<u.length;g++)if(u[g].rowNode.rowIndex===t.rowIndex){h=u[g+d];break}return h?{rowIndex:h.rowNode.rowIndex,rowPinned:null}:void 0}function Fj(e,t){const{rowPinned:r,rowIndex:n}=t,{pinnedRowModel:i,pageBounds:s}=e;return r==="top"?(i?.getPinnedTopRowCount()??0)-1<=n:r==="bottom"?(i?.getPinnedBottomRowCount()??0)-1<=n:s.getLastRow()<=n}var gf=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}depthFirstSearchChangedPath(e,t){const{rowNode:r,children:n}=e;if(n)for(let i=0;i<n.length;++i)this.depthFirstSearchChangedPath(n[i],t);t(r)}depthFirstSearchEverything(e,t,r){const n=e.childrenAfterGroup;if(n)for(let i=0,s=n.length;i<s;++i){const o=n[i];o.childrenAfterGroup?this.depthFirstSearchEverything(o,t,r):r&&t(o)}t(e)}forEachChangedNodeDepthFirst(e,t=!1,r=!1){this.active&&!r?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,r=0;for(;!this.mapToItems[t.id];){const n={rowNode:t,children:null};this.mapToItems[t.id]=n,r++,t=t.parent}return r}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let r=e;for(;r;){this.nodeIdsToColumns[r.id]||(this.nodeIdsToColumns[r.id]={});for(const n of t)this.nodeIdsToColumns[r.id][n.getId()]=!0;r=r.parent}}linkPathItems(e,t){let r=e;for(let n=0;n<t;n++){const i=this.mapToItems[r.id],s=this.mapToItems[r.parent.id];s.children||(s.children=[]),s.children.push(i),r=r.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;const r=this.createPathItems(e);this.linkPathItems(e,r),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;const r=this.nodeIdsToColumns[e.id];return t.filter(i=>r[i.getId()])}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;const r=this.nodeIdsToColumns[e.id];return t.filter(i=>!r[i.getId()])}},Dj=class{constructor(e,t){this.beans=e,this.groupThrottled=!1,this.scrollChanged=!1,this.scrollChanging=!1,this.oldVScroll=null,this.groupTimer=null,this.groupTarget=null,this.onGroupThrottle=()=>{this.groupTimer=null,this.groupThrottled=!0,this.beans.dragAndDrop?.nudge()};const r=()=>t.scrollFeature.getVScrollPosition().top;this.autoScroll=new X$({scrollContainer:t.eBodyViewport,scrollAxis:"y",getVerticalPosition:r,setVerticalPosition:n=>t.scrollFeature.setVerticalScrollPosition(n),onScrollCallback:()=>{const n=r();if(this.oldVScroll!==n){this.oldVScroll=n,this.scrollChanging=!0;return}const i=this.scrollChanging;this.scrollChanged=i,this.scrollChanging=!1,i&&(this.beans.dragAndDrop?.nudge(),this.scrollChanged=!1)}})}updateGroup(e,t){this.groupTarget&&this.groupTarget!==e&&this.clearGroup(),e&&(t&&this.groupThrottled&&!e.expanded&&e.childrenAfterSort?.length&&e.isExpandable()&&e.setExpanded(!0,void 0,!0),e.expanded&&e.childrenAfterSort?.length&&(this.groupThrottled=!0,this.groupTarget=e))}startGroup(e){this.groupTarget=e,this.groupTimer===null&&(this.groupTimer=window.setTimeout(this.onGroupThrottle,this.beans.gos.get("rowDragInsertDelay")))}clearGroup(){this.groupThrottled=!1,this.groupTarget=null;const e=this.groupTimer;e!==null&&(this.groupTimer=null,window.clearTimeout(e))}clear(){this.clearGroup(),this.autoScroll.ensureCleared(),this.oldVScroll=null,this.scrollChanged=!1,this.scrollChanging=!1}},Aj=class extends Ee{constructor(e){super(),this.eContainer=e,this.lastDraggingEvent=null,this.nudger=null}postConstruct(){const e=this.beans;e.ctrlsSvc.whenReady(this,t=>{this.nudger=new Dj(e,t.gridBodyCtrl)})}destroy(){super.destroy(),this.nudger?.clear(),this.nudger=null,this.lastDraggingEvent=null,this.eContainer=null}getContainer(){return this.eContainer}isInterestedIn(e){return e===2}getIconName(e){return e?.dropTarget?.allowed===!1||this.gos.get("rowDragManaged")&&this.shouldPreventRowMove()?"notAllowed":"move"}shouldPreventRowMove(){const{rowGroupColsSvc:e,filterManager:t,sortSvc:r}=this.beans;return!!((e?.columns??[]).length||t?.isAnyFilterPresent()||r?.isSortActive())}getRowNodes(e){if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];const t=e.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){const r=this.beans.selectionSvc?.getSelectedNodes();if(r&&r.indexOf(t)>=0)return r.slice().sort(Mj)}return[t]}onDragEnter(e){this.dragging(e,!0)}onDragging(e){this.dragging(e,!1)}dragging(e,t){const{lastDraggingEvent:r,beans:n}=this;if(t){const o=this.getRowNodes(e);e.dragItem.rowNodes=o,DD(o,!0)}this.lastDraggingEvent=e;const i=e.fromNudge,s=this.makeRowsDrop(r,e,i,!1);n.rowDropHighlightSvc?.fromDrag(e),t&&this.dispatchGridEvent("rowDragEnter",e),this.dispatchGridEvent("rowDragMove",e),s?.rowDragManaged&&s.moved&&s.allowed&&s.sameGrid&&!s.suppressMoveWhenRowDragging&&(!i&&!this.nudger?.autoScroll.scrolling||this.nudger?.scrollChanged)&&this.dropRows(s),this.nudger?.autoScroll.check(e.event)}isFromThisGrid(e){return e.dragSource.dragSourceDomDataKey===this.gos.getDomDataKey()}makeRowsDrop(e,t,r,n){const{beans:i,gos:s}=this,o=this.newRowsDrop(t,n),a=i.rowModel;if(t.dropTarget=o,t.changed=!1,!o)return null;let{sameGrid:u,rootNode:d,source:h,target:g,rows:m}=o;g??(g=a.getRow(a.getRowCount()-1)??null);const v=!!this.beans.groupStage?.treeData&&u;let w=null;if(g?.footer){const E=u0(a,-1,g)??u0(a,1,g);w=g.sibling??d,g=E??null}g?.detail&&(g=g.parent),o.moved&&(o.moved=h!==g);let C=.5;if(g&&(u&&o.moved&&(w||!v)?C=h.rowIndex>g.rowIndex?-.5:.5:C=(o.y-g.rowTop-g.rowHeight/2)/g.rowHeight||0),!v&&u&&g&&o.moved&&_r(s)){const E=_j(a,o);E&&(C=h.rowIndex>E.rowIndex?-.5:.5,g=E,o.moved&&(o.moved=h!==g))}const b=this.nudger;b?.updateGroup(g,r),v&&!w&&b&&(!g||C>=.5&&g.rowIndex===i.pageBounds.getLastRow()?w=d:o.moved&&this.targetShouldBeParent(g,C,m)&&(b.groupThrottled&&(w=g),!r&&(!w||g&&!g.expanded&&g.childrenAfterSort?.length)&&b.startGroup(g)),w??(w=g?.parent??d));let x=!1;if(w){if(w===g&&w!==d){const E=w.expanded?u0(a,1,g):null;E?.parent===w?(g=E,C=-.5):x=!0}if(g&&!x){let E=g;for(;E&&E!==d&&E!==w;)g=E,E=E.parent}}o.target=g,o.newParent=w,o.moved&&(o.moved=h!==g);const R=C<0?"above":"below";return o.position=o.moved?x?"inside":R:"none",this.validateRowsDrop(o,v,R,n),t.changed||(t.changed=Pj(e?.dropTarget,o)),o}newRowsDrop(e,t){const{beans:r,gos:n}=this,i=r.rowModel.rootNode,s=_r(n)?n.get("rowDragManaged"):!1,o=n.get("suppressMoveWhenRowDragging"),a=this.isFromThisGrid(e);let{rowNode:u,rowNodes:d}=e.dragItem;if(d||(d=u?[u]:[]),u||(u=d[0]),!u||!i)return null;const h=this.beans.dragAndDrop.isDropZoneWithinThisGrid(e);let g=!0;s&&(!d.length||this.shouldPreventRowMove()||(o||!a)&&!h)&&(g=!1);const m=fD(r,e).y,v=this.getOverNode(m);return{api:r.gridApi,context:r.gridOptions.context,draggingEvent:e,rowDragManaged:s,suppressMoveWhenRowDragging:o,sameGrid:a,withinGrid:h,rootNode:i,moved:u!==v,y:m,overNode:v,overIndex:v?.rowIndex??-1,position:"none",source:u,target:v??null,newParent:null,rows:d,allowed:g,highlight:!t&&s&&o&&(h||!a)}}validateRowsDrop(e,t,r,n){const{rowDragManaged:i,suppressMoveWhenRowDragging:s}=e;t||(e.newParent=null),s&&!e.moved&&(e.allowed=!1);const o=(!i||e.allowed)&&this.gos.get("isRowValidDropPosition");if(o){t&&e.newParent&&TD(e.rows,e.newParent)&&(e.newParent=null);const a=o(e);if(!a)e.allowed=!1;else if(typeof a=="object"){a.rows!==void 0&&(e.rows=a.rows??[]),t&&a.newParent!==void 0&&(e.newParent=a.newParent),a.target!==void 0&&(e.target=a.target),a.position&&(e.position=a.position),a.allowed!==void 0?e.allowed=a.allowed:i||(e.allowed=!0);const u=e.draggingEvent;a.changed&&u&&(u.changed=!0),!n&&a.highlight!==void 0&&(e.highlight=a.highlight)}}i&&(e.rows=this.filterRows(e)),t&&e.newParent&&TD(e.rows,e.newParent)&&(e.newParent=null),s&&(!e.rows.length||e.position==="none")&&(e.allowed=!1),(!e.allowed||!e.newParent)&&e.position==="inside"&&(e.position=r)}targetShouldBeParent(e,t,r){const n=e.rowIndex,i=.25;if(t<-.5+i)return!1;if(t<.5-i)return!0;let s,o=n+1;const a=this.beans.rowModel;do s=a.getRow(o++);while(s?.footer);const u=e.childrenAfterGroup;if(s&&s.parent===e&&u?.length){const d=new Set(r);for(const h of u)if(h.rowIndex!==null&&!d.has(h))return!0}return!1}addRowDropZone(e){if(!e.getContainer()){Me(55);return}const t=this.beans.dragAndDrop;if(t.findExternalZone(e.getContainer())){Me(56);return}const r=e.fromGrid?e:{getContainer:e.getContainer,onDragEnter:e.onDragEnter&&(i=>e.onDragEnter(this.rowDragEvent("rowDragEnter",i))),onDragLeave:e.onDragLeave&&(i=>e.onDragLeave(this.rowDragEvent("rowDragLeave",i))),onDragging:e.onDragging&&(i=>e.onDragging(this.rowDragEvent("rowDragMove",i))),onDragStop:e.onDragStop&&(i=>e.onDragStop(this.rowDragEvent("rowDragEnd",i))),onDragCancel:e.onDragCancel&&(i=>e.onDragCancel(this.rowDragEvent("rowDragCancel",i)))},n={isInterestedIn:i=>i===2,getIconName:()=>"move",external:!0,...r};t.addDropTarget(n),this.addDestroyFunc(()=>t.removeDropTarget(n))}getRowDropZone(e){return{getContainer:this.getContainer.bind(this),onDragEnter:r=>{this.onDragEnter(r),e?.onDragEnter?.(this.rowDragEvent("rowDragEnter",r))},onDragLeave:r=>{this.onDragLeave(r),e?.onDragLeave?.(this.rowDragEvent("rowDragLeave",r))},onDragging:r=>{this.onDragging(r),e?.onDragging?.(this.rowDragEvent("rowDragMove",r))},onDragStop:r=>{this.onDragStop(r),e?.onDragStop?.(this.rowDragEvent("rowDragEnd",r))},onDragCancel:r=>{this.onDragCancel(r),e?.onDragCancel?.(this.rowDragEvent("rowDragCancel",r))},fromGrid:!0}}getOverNode(e){const{pageBounds:t,rowModel:r}=this.beans,i=e>t.getCurrentPagePixelRange().pageLastPixel?-1:r.getRowIndexAtPixel(e);return i>=0?r.getRow(i):void 0}rowDragEvent(e,t){const r=this.beans,{dragItem:n,dropTarget:i,event:s,vDirection:o}=t,a=i?.rootNode===r.rowModel.rootNode,u=a?i.y:fD(r,t).y,d=a?i.overNode:this.getOverNode(u),h=a?i.overIndex:d?.rowIndex??-1;return{api:r.gridApi,context:r.gridOptions.context,type:e,event:s,node:n.rowNode,nodes:n.rowNodes,overIndex:h,overNode:d,y:u,vDirection:o,rowsDrop:i}}dispatchGridEvent(e,t){const r=this.rowDragEvent(e,t);this.eventSvc.dispatchEvent(r)}onDragLeave(e){this.dispatchGridEvent("rowDragLeave",e),this.stopDragging(e)}onDragStop(e){const t=this.makeRowsDrop(this.lastDraggingEvent,e,!1,!0);this.dispatchGridEvent("rowDragEnd",e),t?.allowed&&t.rowDragManaged&&(t.suppressMoveWhenRowDragging||!t.sameGrid||this.nudger?.autoScroll.scrolling)&&this.dropRows(t),this.stopDragging(e)}onDragCancel(e){this.dispatchGridEvent("rowDragCancel",e),this.stopDragging(e)}stopDragging(e){this.nudger?.clear(),this.beans.rowDropHighlightSvc?.fromDrag(null),DD(e.dragItem.rowNodes,!1)}dropRows(e){return e.sameGrid?this.csrmMoveRows(e):this.csrmAddRows(e)}csrmAddRows({position:e,target:t,rows:r}){const n=Zu(this.gos),i=this.beans.rowModel,s=r.filter(({data:a,rowPinned:u})=>!i.getRowNode(n?.({data:a,level:0,rowPinned:u})??a.id)).map(({data:a})=>a);if(s.length===0)return!1;const o=t?FD(t)+(e==="above"?0:1):void 0;return i.updateRowData({add:s,addIndex:o}),!0}filterRows({newParent:e,rows:t}){let r;for(let n=0,i=t.length;n<i;++n){let s=!0;const o=t[n];(!o||o.footer||o.rowTop===null&&o!==this.beans.rowModel.getRowNode(o.id)||e&&o.parent!==e&&kj(o,e)||!Hb(o))&&(s=!1),s?r?.push(o):r??(r=t.slice(0,n))}return r??t}csrmMoveRows({position:e,target:t,rows:r,newParent:n,rootNode:i}){let s=!1;const o=new Set;for(const m of r){n&&m.parent!==n&&(m.treeParent=n,s=!0);const v=Hb(m);v&&o.add(v)}if(!s&&o.size===0)return!1;const a=this.beans.focusSvc,u=a.getFocusedCell(),d=u&&Ru(this.beans,u);if(o.size&&this.reorderLeafChildren(o,...this.getMoveRowsBounds(o,t,e==="above"))&&(s=!0),!s)return!1;const h=this.beans.rowModel,g=new c0;return g.reordered=!0,h.refreshModel({step:"group",keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedPath:new gf(!1,i),changedRowNodes:g}),d?d.focusCell():a.clearFocusedCell(),!0}getMoveRowsBounds(e,t,r){const n=this.beans.rowModel.rootNode?._leafs?.length??0;let i=t?FD(t):-1;i<0||i>=n?i=n:r||++i;let s=i,o=Math.min(i,n-1);for(const a of e){const u=a.sourceRowIndex;u<s&&(s=u),u>o&&(o=u)}return[s,i,o]}reorderLeafChildren(e,t,r,n){let i=!1;const s=this.beans.rowModel.rootNode?._leafs;if(!e.size||!s)return!1;let o=t;for(let u=t;u<r;++u){const d=s[u];e.has(d)||(d.sourceRowIndex!==o&&(d.sourceRowIndex=o,s[o]=d,i=!0),++o)}let a=n;for(let u=n;u>=r;--u){const d=s[u];e.has(d)||(d.sourceRowIndex!==a&&(d.sourceRowIndex=a,s[a]=d,i=!0),--a)}for(const u of e)u.sourceRowIndex!==o&&(u.sourceRowIndex=o,s[o]=u,i=!0),++o;return i}},u0=(e,t,r)=>{if(r){const n=e.getRowCount();let i=r.rowIndex+t;for(;i>=0&&i<n;){const s=e.getRow(i);if(!s||!s.footer&&!s.detail)return s;i+=t}}},kj=(e,t)=>{let r=t;for(;r;){if(r===e)return!0;r=r.parent}return!1},TD=(e,t)=>{for(let r=0,n=e.length;r<n;++r)if(e[r].parent!==t)return!1;return!0},FD=e=>{const t=Hb(e);return t!==void 0?t.sourceRowIndex:-1},Hb=e=>e.data?e:j_(e.childrenAfterGroup),Pj=(e,t)=>e!==t&&(!e||e.sameGrid!==t.sameGrid||e.allowed!==t.allowed||e.position!==t.position||e.target!==t.target||e.source!==t.source||e.newParent!==t.newParent||!tl(e.rows,t.rows)),Mj=({rowIndex:e},{rowIndex:t})=>e!==null&&t!==null?e-t:0,DD=(e,t)=>{for(let r=0,n=e?.length||0;r<n;++r){const i=e[r];i.dragging!==t&&(i.dragging=t,i.dispatchRowEvent("draggingChanged"))}},_j=(e,t)=>{let r=null,n=t.target;if(n&&t.rows.indexOf(n)<0)return null;const i=t.source;if(!n||!i)return null;let s=n.rowIndex-i.rowIndex;const o=s<0?-1:1;s=t.suppressMoveWhenRowDragging?Math.abs(s):1;const a=new Set(t.rows);do{const u=u0(e,o,n);if(!u)break;a.has(u)||(r=u,--s),n=u}while(s>0);return r},Lj=class extends Ee{constructor(){super(...arguments),this.beanName="rowDragSvc"}setupRowDrag(e,t){const r=t.createManagedBean(new Aj(e)),n=this.beans.dragAndDrop;n.addDropTarget(r),t.addDestroyFunc(()=>n.removeDropTarget(r)),this.rowDragFeature=r}createRowDragComp(e,t,r,n,i,s){return new yj(e,t,r,n,i,s)}createRowDragCompForRow(e,t){if(ja(this.gos))return;const r=this.getLocaleTextFunc();return this.createRowDragComp(()=>`1 ${r("rowDragRow","row")}`,e,void 0,t,void 0,!0)}createRowDragCompForCell(e,t,r,n,i,s){const o=this.gos;return o.get("rowDragManaged")&&(!_r(o)||o.get("pagination"))?void 0:this.createRowDragComp(r,e,t,n,i,s)}},Ij=class extends Ee{constructor(){super(...arguments),this.beanName="rowDropHighlightSvc",this.uiLevel=0,this.dragging=!1,this.row=null,this.position="none"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this)})}onModelUpdated(){const e=this.row,t=this.dragging;!e||e?.rowIndex===null||this.position==="none"?this.clear():this.set(e,this.position),this.dragging=t}destroy(){this.clear(),super.destroy()}clear(){const e=this.row;this.dragging=!1,e&&(this.uiLevel=0,this.position="none",this.row=null,e.dispatchRowEvent("rowHighlightChanged"))}set(e,t){const r=e!==this.row,n=e.uiLevel,i=t!==this.position,s=n!==this.uiLevel;this.dragging=!1,(r||i||s)&&(r&&this.clear(),this.uiLevel=n,this.position=t,this.row=e,e.dispatchRowEvent("rowHighlightChanged"))}fromDrag(e){const t=e?.dropTarget;if(t){const{highlight:r,target:n,position:i}=t;if(r&&n&&i!=="none"){this.set(n,i),this.dragging=!0;return}}this.dragging&&this.clear()}},yL={moduleName:"Drag",version:Ue,beans:[vj]},Oj={moduleName:"DragAndDrop",version:Ue,dynamicBeans:{dndSourceComp:dj},icons:{rowDrag:"grip"}},bL={moduleName:"SharedDragAndDrop",version:Ue,beans:[rU],dependsOn:[yL],userComponents:{agDragAndDropImage:D$},icons:{columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",rowDrag:"grip"}},Nj={moduleName:"RowDrag",version:Ue,beans:[Ij,Lj],apiFunctions:{addRowDropZone:hj,removeRowDropZone:fj,getRowDropZoneParams:gj,getRowDropPositionIndicator:pj,setRowDropPositionIndicator:mj},dependsOn:[bL]},Bj={moduleName:"HorizontalResize",version:Ue,beans:[wj],dependsOn:[yL]},Hj=":where(.ag-ltr) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:left .2s}.ag-header-group-cell{transition:left .2s,width .2s}}:where(.ag-rtl) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:right .2s}.ag-header-group-cell{transition:right .2s,width .2s}}",Gj=class extends Ee{constructor(){super(...arguments),this.beanName="colAnimation",this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.activeNext=!1,this.suppressAnimation=!1,this.animationThreadCount=0}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>this.gridBodyCtrl=e.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){if(this.active)return;const{gos:e}=this;e.get("suppressColumnMoveAnimation")||e.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0,this.activeNext=!0)}finish(){this.active&&this.flush(()=>this.activeNext=!1,()=>this.active=!1)}executeNextVMTurn(e){this.activeNext?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const e=this.animationThreadCount,{gridBodyCtrl:t}=this;t.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===e&&t.setColumnMovingCss(!1)})}flush(e,t){const{executeNextFuncs:r,executeLaterFuncs:n}=this;if(r.length===0&&n.length===0){e(),t();return}const i=s=>{for(;s.length;){const o=s.pop();o&&o()}};this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e(),i(r)},0),window.setTimeout(()=>{t(),i(n)},200)})}};function Vj(e,t,r){e.colMoves?.moveColumnByIndex(t,r,"api")}function zj(e,t,r){e.colMoves?.moveColumns(t,r,"api")}var Wj=class extends Ee{constructor(e){super(),this.pinned=e,this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[]}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;const t=e.dragItem.columns;if(t)for(const r of t)r.isPrimary()&&(r.isAnyFunctionActive()||(r.isAllowValue()?this.columnsToAggregate.push(r):r.isAllowRowGroup()?this.columnsToGroup.push(r):r.isAllowPivot()&&this.columnsToPivot.push(r)))}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?"pinned":"move":null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){const{valueColsSvc:t,rowGroupColsSvc:r,pivotColsSvc:n}=this.beans;this.columnsToAggregate.length>0&&t?.addColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&r?.addColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&n?.addColumns(this.columnsToPivot,"toolPanelDragAndDrop")}onDragCancel(){this.clearColumnsList()}};function Uj(e,t){!t||t.length<=1||t.filter(n=>e.indexOf(n)<0).length>0||t.sort((n,i)=>{const s=e.indexOf(n),o=e.indexOf(i);return s-o})}function $j(e){const t=[...e];for(const r of e){let n=null,i=r.getParent();for(;i!=null&&i.getDisplayedLeafColumns().length===1;)n=i,i=i.getParent();if(n!=null){const o=!!n.getColGroupDef()?.marryChildren?n.getProvidedColumnGroup().getLeafColumns():n.getLeafColumns();for(const a of o)t.includes(a)||t.push(a)}}return t}function jj(e,t,r,n){const i=n.allCols;let s=null,o=null;for(let a=0;a<e.length;a++){const u=e[a],d=r.getProposedColumnOrder(t,u);if(!r.doesOrderPassRules(d))continue;const h=d.filter(m=>i.includes(m));if(o===null)o=h;else if(!tl(h,o))break;const g=Kj(d);(s===null||g<s.fragCount)&&(s={move:u,fragCount:g})}return s}function SL(e){const{isFromHeader:t,fromLeft:r,xPosition:n,fromEnter:i,fakeEvent:s,pinned:o,gos:a,colModel:u,colMoves:d,visibleCols:h}=e;let{allMovingColumns:g}=e;t&&(g=$j(g));const m=g.slice();Uj(u.getCols(),m);const v=Xj({movingCols:m,draggingRight:r,xPosition:n,pinned:o,gos:a,colModel:u,visibleCols:h}),w=Yj(m,u);if(v.length===0)return;const C=v[0];if(w!==null&&(t||!i)&&!s&&(!r&&C>=w||r&&C<=w))return;const x=jj(v,m,d,h);if(!x)return;const R=x.move;if(!(R>u.getCols().length-m.length))return{columns:m,toIndex:R}}function xL(e){const{columns:t,toIndex:r}=SL(e)||{},{finished:n,colMoves:i}=e;return!t||r==null?null:(i.moveColumns(t,r,"uiColumnMoved",n),n?null:{columns:t,toIndex:r})}function Yj(e,t){const r=t.getCols(),n=e.map(u=>r.indexOf(u)).sort((u,d)=>u-d),i=n[0];return ir(n)-i!==n.length-1?null:i}function Kj(e){function t(n){const i=[];let s=n.getOriginalParent();for(;s!=null;)i.push(s),s=s.getOriginalParent();return i}let r=0;for(let n=0;n<e.length-1;n++){let i=t(e[n]),s=t(e[n+1]);[i,s]=i.length>s.length?[i,s]:[s,i];for(const o of i)s.indexOf(o)===-1&&r++}return r}function qj(e,t){switch(t){case"left":return e.leftCols;case"right":return e.rightCols;default:return e.centerCols}}function Xj(e){const{movingCols:t,draggingRight:r,xPosition:n,pinned:i,gos:s,colModel:o,visibleCols:a}=e;if(s.get("suppressMovableColumns")||t.some(E=>E.getColDef().suppressMovable))return[];const d=qj(a,i),h=o.getCols(),g=d.filter(E=>t.includes(E)),m=d.filter(E=>!t.includes(E)),v=h.filter(E=>!t.includes(E));let w=0,C=n;if(r){let E=0;for(const A of g)E+=A.getActualWidth();C-=E}if(C>0){for(let E=0;E<m.length;E++){const A=m[E];if(C-=A.getActualWidth(),C<0)break;w++}r&&w++}let b;if(w>0){const E=m[w-1];b=v.indexOf(E)+1}else b=v.indexOf(m[0]),b===-1&&(b=0);const x=[b],R=(E,A)=>E-A;if(r){let E=b+1;const A=h.length-1;for(;E<=A;)x.push(E),E++;x.sort(R)}else{let E=b;const A=h.length-1;let D=h[E];for(;E<=A&&d.indexOf(D)<0;)E++,x.push(E),D=h[E];E=b-1;const M=0;for(;E>=M;)x.push(E),E--;x.sort(R).reverse()}return x}function Gb(e){const{pinned:t,fromKeyboard:r,gos:n,ctrlsSvc:i,useHeaderRow:s,skipScrollPadding:o}=e;let a=i.getHeaderRowContainerCtrl(t)?.eViewport,{x:u}=e;return a?(r&&(u-=a.getBoundingClientRect().left),n.get("enableRtl")&&(s&&(a=a.querySelector(".ag-header-row")),u=a.clientWidth-u),t==null&&!o&&(u+=i.get("center").getCenterViewportScrollLeft()),u):0}function Ey(e,t){for(const r of e)r.moving=t,r.dispatchColEvent("movingChanged","uiColumnMoved")}var AD=7,Vb=100,Lp=Vb/2,Qj=5,Zj=100,Jj=class extends Ee{constructor(e){super(),this.pinned=e,this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.isCenterContainer=!$e(e)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}getIconName(){const{pinned:e,lastDraggingEvent:t}=this,{dragItem:r}=t||{},n=r?.columns??[];for(const i of n){const s=i.getPinned();if(i.getColDef().lockPinned){if(s==e)return"move";continue}const o=r?.containerType;if(o===e||!e)return"move";if(e&&(!s||o!==e))return"pinned"}return"notAllowed"}onDragEnter(e){const t=e.dragItem,r=t.columns;if(e.dragSource.type===0)this.setColumnsVisible(r,!0,"uiColumnDragged");else{const i=t.visibleState,s=(r||[]).filter(o=>i[o.getId()]&&!o.isVisible());this.setColumnsVisible(s,!0,"uiColumnDragged")}this.gos.get("suppressMoveWhenColumnDragging")||this.attemptToPinColumns(r,this.pinned),this.onDragging(e,!0,!0)}onDragging(e=this.lastDraggingEvent,t=!1,r=!1,n=!1){const{gos:i,ctrlsSvc:s}=this.beans,o=i.get("suppressMoveWhenColumnDragging");if(n&&!o){this.finishColumnMoving();return}if(this.lastDraggingEvent=e,!e||!n&&xr(e.hDirection))return;const a=Gb({x:e.x,pinned:this.pinned,gos:i,ctrlsSvc:s});t||this.checkCenterForScrolling(a),o?this.handleColumnDragWhileSuppressingMovement(e,t,r,a,n):this.handleColumnDragWhileAllowingMovement(e,t,r,a,n)}onDragLeave(){this.ensureIntervalCleared(),this.clearHighlighted(),this.updateDragItemContainerType(),this.lastMovedInfo=null}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}onDragCancel(){this.clearHighlighted(),this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,r){if(!e?.length)return;const n=e.filter(i=>!i.getColDef().lockVisible);n.length&&this.beans.colModel.setColsVisible(n,t,r)}finishColumnMoving(){this.clearHighlighted();const e=this.lastMovedInfo;if(!e)return;const{columns:t,toIndex:r}=e;this.beans.colMoves.moveColumns(t,r,"uiColumnMoved",!0)}updateDragItemContainerType(){const{lastDraggingEvent:e}=this;if(this.gos.get("suppressMoveWhenColumnDragging")||!e)return;const t=e.dragItem;t&&(t.containerType=this.pinned)}handleColumnDragWhileSuppressingMovement(e,t,r,n,i){const s=this.getAllMovingColumns(e,!0);if(i){const o=this.isAttemptingToPin(s);o&&this.attemptToPinColumns(s,void 0,!0);const{fromLeft:a,xPosition:u}=this.getNormalisedXPositionInfo(s,o)||{};if(a==null||u==null){this.finishColumnMoving();return}this.moveColumnsAfterHighlight({allMovingColumns:s,xPosition:u,fromEnter:t,fakeEvent:r,fromLeft:a})}else{if(!this.beans.dragAndDrop.isDropZoneWithinThisGrid(e))return;this.highlightHoveredColumn(s,n)}}handleColumnDragWhileAllowingMovement(e,t,r,n,i){const s=this.getAllMovingColumns(e),o=this.normaliseDirection(e.hDirection)==="right",a=e.dragSource.type===1,u=this.getMoveColumnParams({allMovingColumns:s,isFromHeader:a,xPosition:n,fromLeft:o,fromEnter:t,fakeEvent:r}),d=xL({...u,finished:i});d&&(this.lastMovedInfo=d)}getAllMovingColumns(e,t=!1){const r=e.dragSource.getDragItem();let n=null;t?(n=r.columnsInSplit,n||(n=r.columns)):n=r.columns;const i=s=>s.getColDef().lockPinned?s.getPinned()==this.pinned:!0;return n?n.filter(i):[]}getMoveColumnParams(e){const{allMovingColumns:t,isFromHeader:r,xPosition:n,fromLeft:i,fromEnter:s,fakeEvent:o}=e,{gos:a,colModel:u,colMoves:d,visibleCols:h}=this.beans;return{allMovingColumns:t,isFromHeader:r,fromLeft:i,xPosition:n,pinned:this.pinned,fromEnter:s,fakeEvent:o,gos:a,colModel:u,colMoves:d,visibleCols:h}}highlightHoveredColumn(e,t){const{gos:r,colModel:n}=this.beans,i=r.get("enableRtl"),s=n.getCols().filter(h=>h.isVisible()&&h.getPinned()===this.pinned);let o=null,a=null,u=null;for(const h of s){if(a=h.getActualWidth(),o=this.getNormalisedColumnLeft(h,0,i),o!=null){const g=o+a;if(o<=t&&g>=t){u=h;break}}o=null,a=null}if(u)e.indexOf(u)!==-1&&(u=null);else{for(let h=s.length-1;h>=0;h--){const g=s[h],m=s[h].getParent();if(!m){u=g;break}const v=m?.getDisplayedLeafColumns();if(v.length){u=ir(v);break}}if(!u)return;o=this.getNormalisedColumnLeft(u,0,i),a=u.getActualWidth()}if(this.lastHighlightedColumn?.column!==u&&this.clearHighlighted(),u==null||o==null||a==null)return;let d;t-o<a/2!==i?d=0:d=1,kD(u,d),this.lastHighlightedColumn={column:u,position:d}}getNormalisedXPositionInfo(e,t){const{gos:r,visibleCols:n}=this.beans,i=r.get("enableRtl"),{firstMovingCol:s,column:o,position:a}=this.getColumnMoveAndTargetInfo(e,t,i);if(!s||!o||a==null)return;const u=n.allCols,d=u.indexOf(s),h=u.indexOf(o),g=a===0!==i,m=d<h||d===h&&!g;let v=0;if(g?m&&(v-=1):m||(v+=1),h+v===d)return;const w=u[h+v];if(!w)return;const C=this.getNormalisedColumnLeft(w,20,i);return{fromLeft:m,xPosition:C}}getColumnMoveAndTargetInfo(e,t,r){const n=this.lastHighlightedColumn||{},{firstMovingCol:i,lastMovingCol:s}=eY(e);if(!i||!s||n.column||!t)return{firstMovingCol:i,...n};const a=this.getPinDirection()==="left";return{firstMovingCol:i,position:a?1:0,column:a!==r?i:s}}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case"left":return"right";case"right":return"left"}return e}getNormalisedColumnLeft(e,t,r){const{gos:n,ctrlsSvc:i}=this.beans,s=e.getLeft();if(s==null)return null;const o=e.getActualWidth();return Gb({x:r?s+o-t:s+t,pinned:e.getPinned(),useHeaderRow:r,skipScrollPadding:!0,gos:n,ctrlsSvc:i})}isAttemptingToPin(e){const t=this.needToMoveLeft||this.needToMoveRight,r=this.failedMoveAttempts>AD;return t&&r||e.some(n=>n.getPinned()!==this.pinned)}moveColumnsAfterHighlight(e){const{allMovingColumns:t,xPosition:r,fromEnter:n,fakeEvent:i,fromLeft:s}=e,o=this.getMoveColumnParams({allMovingColumns:t,isFromHeader:!0,xPosition:r,fromLeft:s,fromEnter:n,fakeEvent:i}),{columns:a,toIndex:u}=SL(o)||{};a&&u!=null&&(this.lastMovedInfo={columns:a,toIndex:u}),this.finishColumnMoving()}clearHighlighted(){const{lastHighlightedColumn:e}=this;e&&(kD(e.column,null),this.lastHighlightedColumn=null)}checkCenterForScrolling(e){if(!this.isCenterContainer)return;const t=this.beans.ctrlsSvc.get("center"),r=t.getCenterViewportScrollLeft(),n=r+t.getCenterWidth();let i,s;this.gos.get("enableRtl")?(i=e<r+Lp,s=e>n-Lp):(s=e<r+Lp,i=e>n-Lp),this.needToMoveRight=i,this.needToMoveLeft=s,s||i?this.ensureIntervalStarted():this.ensureIntervalCleared()}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),Zj),this.beans.dragAndDrop.setDragImageCompIcon(this.needToMoveLeft?"left":"right",!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.failedMoveAttempts=0,this.beans.dragAndDrop.setDragImageCompIcon(this.getIconName()))}moveInterval(){let e;this.intervalCount++,e=10+this.intervalCount*Qj,e>Vb&&(e=Vb);let t=null;const r=this.gridBodyCon.scrollFeature;if(this.needToMoveLeft?t=r.scrollHorizontally(-e):this.needToMoveRight&&(t=r.scrollHorizontally(e)),t!==0)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;const{pinnedCols:n,dragAndDrop:i,gos:s}=this.beans;if(this.failedMoveAttempts<=AD+1||!n)return;if(i.setDragImageCompIcon("pinned"),!s.get("suppressMoveWhenColumnDragging")){const o=this.lastDraggingEvent?.dragItem.columns;this.attemptToPinColumns(o,void 0,!0)}}}getPinDirection(){if(this.needToMoveLeft||this.pinned==="left")return"left";if(this.needToMoveRight||this.pinned==="right")return"right"}attemptToPinColumns(e,t,r=!1){const n=(e||[]).filter(o=>!o.getColDef().lockPinned);if(!n.length)return 0;r&&(t=this.getPinDirection());const{pinnedCols:i,dragAndDrop:s}=this.beans;return i?.setColsPinned(n,t,"uiColumnDragged"),r&&s.nudge(),n.length}destroy(){super.destroy(),this.lastDraggingEvent=null,this.clearHighlighted(),this.lastMovedInfo=null}};function kD(e,t){e.highlighted!==t&&(e.highlighted=t,e.dispatchColEvent("headerHighlightChanged","uiColumnMoved"))}function eY(e){const t=e.length;let r,n;for(let i=0;i<t;i++){if(!r){const s=e[i];s.getLeft()!=null&&(r=s)}if(!n){const s=e[t-1-i];s.getLeft()!=null&&(n=s)}if(r&&n)break}return{firstMovingCol:r,lastMovingCol:n}}var tY=class extends Ee{constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){const{ctrlsSvc:e,dragAndDrop:t}=this.beans,r=this.pinned;e.whenReady(this,n=>{let i;const s=n.gridBodyCtrl.eBodyViewport;switch(r){case"left":i=[[s,n.left.eContainer],[n.bottomLeft.eContainer],[n.topLeft.eContainer]];break;case"right":i=[[s,n.right.eContainer],[n.bottomRight.eContainer],[n.topRight.eContainer]];break;default:i=[[s,n.center.eViewport],[n.bottomCenter.eViewport],[n.topCenter.eViewport]];break}this.eSecondaryContainers=i}),this.moveColumnFeature=this.createManagedBean(new Jj(r)),this.bodyDropPivotTarget=this.createManagedBean(new Wj(r)),t.addDropTarget(this),this.addDestroyFunc(()=>t.removeDropTarget(this))}isInterestedIn(e){return e===1||e===0&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.beans.colModel.isPivotMode()&&e.dragSource.type===0}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}onDragCancel(){this.currentDropListener.onDragCancel()}},rY=class extends Ee{constructor(){super(...arguments),this.beanName="colMoves"}moveColumnByIndex(e,t,r){const n=this.beans.colModel.getCols();if(!n)return;const i=n[e];this.moveColumns([i],t,r)}moveColumns(e,t,r,n=!0){const{colModel:i,colAnimation:s,visibleCols:o,eventSvc:a}=this.beans,u=i.getCols();if(!u)return;if(t>u.length-e.length){Me(30,{toIndex:t});return}s?.start();const d=i.getColsForKeys(e);this.doesMovePassRules(d,t)&&(KF(i.getCols(),d,t),o.refresh(r),a.dispatchEvent({type:"columnMoved",columns:d,column:d.length===1?d[0]:null,toIndex:t,finished:n,source:r})),s?.finish()}doesMovePassRules(e,t){const r=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(r)}doesOrderPassRules(e){const{colModel:t,gos:r}=this.beans;return!(!m_(e,t.getColTree())||!(i=>{const s=d=>d?d==="left"||d===!0?-1:1:0,o=r.get("enableRtl");let a=o?1:-1,u=!0;for(const d of i){const h=s(d.getColDef().lockPosition);o?h>a&&(u=!1):h<a&&(u=!1),a=h}return u})(e))}getProposedColumnOrder(e,t){const n=this.beans.colModel.getCols().slice();return KF(n,e,t),n}createBodyDropTarget(e,t){return new tY(e,t)}moveHeader(e,t,r,n,i){const{ctrlsSvc:s,gos:o,colModel:a,visibleCols:u,focusSvc:d}=this.beans,h=t.getBoundingClientRect(),g=h.left,m=Vr(r),v=m?h.width:r.getActualWidth(),w=e==="left"!==o.get("enableRtl"),C=Gb({x:w?g-20:g+v+20,pinned:n,fromKeyboard:!0,gos:o,ctrlsSvc:s}),b=d.focusedHeader;xL({allMovingColumns:m?r.getLeafColumns():[r],isFromHeader:!0,fromLeft:e==="right",xPosition:C,pinned:n,fromEnter:!1,fakeEvent:!1,gos:o,colModel:a,colMoves:this,visibleCols:u,finished:!0});let x;if(m){const R=r.getDisplayedLeafColumns();x=w?R[0]:ir(R)}else x=r;if(s.getScrollFeature().ensureColumnVisible(x,"auto"),(!i.isAlive()||o.get("ensureDomOrder"))&&b){let R;if(m){const E=r.getGroupId(),A=r.getLeafColumns();if(!A.length)return;const D=A[0].getParent();if(!D)return;R=nY(D,E)}else R=r;R&&d.focusHeaderPosition({headerPosition:{...b,column:R}})}}setDragSourceForHeader(e,t,r){const{gos:n,colModel:i,dragAndDrop:s,visibleCols:o}=this.beans;let a=!n.get("suppressDragLeaveHidesColumns");const u=Vr(t),d=u?t.getProvidedColumnGroup().getLeafColumns():[t],g={type:1,eElement:e,getDefaultIconName:()=>a?"hide":"notAllowed",getDragItem:u?()=>sY(t,o.allCols):()=>iY(t),dragItemName:r,onDragStarted:()=>{a=!n.get("suppressDragLeaveHidesColumns"),Ey(d,!0)},onDragStopped:()=>Ey(d,!1),onDragCancelled:()=>Ey(d,!1),onGridEnter:m=>{if(a){const{columns:v=[],visibleState:w}=m??{},C=u?x=>!w||w[x.getColId()]:()=>!0,b=v.filter(x=>!x.getColDef().lockVisible&&C(x));i.setColsVisible(b,!0,"uiColumnMoved")}},onGridExit:m=>{if(a){const v=m?.columns?.filter(w=>!w.getColDef().lockVisible)||[];i.setColsVisible(v,!1,"uiColumnMoved")}}};return s.addDragSource(g,!0),g}};function nY(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}}function iY(e){const t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t,containerType:e.pinned}}function sY(e,t){const r=e.getProvidedColumnGroup().getLeafColumns(),n={};for(const a of r)n[a.getId()]=a.isVisible();const i=[];for(const a of t)r.indexOf(a)>=0&&(i.push(a),Ds(r,a));for(const a of r)i.push(a);const s=[],o=e.getLeafColumns();for(const a of i)o.indexOf(a)!==-1&&s.push(a);return{columns:i,columnsInSplit:s,visibleState:n,containerType:s[0]?.pinned}}var oY={moduleName:"ColumnMove",version:Ue,beans:[rY,Gj],apiFunctions:{moveColumnByIndex:Vj,moveColumns:zj},dependsOn:[bL],css:[Hj]},aY=class extends Ee{constructor(){super(...arguments),this.beanName="autoWidthCalc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowContainerCtrl=e.center})}getPreferredWidthForColumn(e,t){const r=this.getHeaderCellForColumn(e);if(!r)return-1;const n=this.beans.rowRenderer.getAllCellsNotSpanningForColumn(e);return t||n.push(r),this.getPreferredWidthForElements(n)}getPreferredWidthForColumnGroup(e){const t=this.getHeaderCellForColumn(e);return t?this.getPreferredWidthForElements([t]):-1}getPreferredWidthForElements(e,t){const r=document.createElement("form");r.style.position="fixed";const n=this.centerRowContainerCtrl.eContainer;for(const s of e)this.cloneItemIntoDummy(s,r);n.appendChild(r);const i=r.offsetWidth;return r.remove(),t=t??this.gos.get("autoSizePadding"),i+t}getHeaderCellForColumn(e){let t=null;for(const r of this.beans.ctrlsSvc.getHeaderRowContainerCtrls()){const n=r.getHtmlElementForColumnHeader(e);n!=null&&(t=n)}return t}cloneItemIntoDummy(e,t){const r=e.cloneNode(!0);r.style.width="",r.style.position="static",r.style.left="";const n=document.createElement("div"),i=n.classList;["ag-header-cell","ag-header-group-cell"].some(a=>r.classList.contains(a))?(i.add("ag-header","ag-header-row"),n.style.position="static"):i.add("ag-row");let o=e.parentElement;for(;o;){if(["ag-header-row","ag-row"].some(u=>o.classList.contains(u))){for(let u=0;u<o.classList.length;u++){const d=o.classList[u];d!="ag-row-position-absolute"&&i.add(d)}break}o=o.parentElement}n.appendChild(r),t.appendChild(n)}},EL={moduleName:"AutoWidth",version:Ue,beans:[aY]};function lY(e,t,r=!0,n="api"){e.colResize?.setColumnWidths(t,!1,r,n)}var cY=class extends Ee{constructor(e,t,r,n){super(),this.comp=e,this.eResize=t,this.pinned=r,this.columnGroup=n}postConstruct(){if(!this.columnGroup.isResizable()){this.comp.setResizableDisplayed(!1);return}const{horizontalResizeSvc:e,gos:t,colAutosize:r}=this.beans,n=e.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});this.addDestroyFunc(n),!t.get("suppressAutoSize")&&r&&this.addDestroyFunc(r.addColumnGroupResize(this.eResize,this.columnGroup,()=>this.resizeLeafColumnsToFit("uiColumnResized")))}onResizeStart(e){const{columnsToResize:t,resizeStartWidth:r,resizeRatios:n,groupAfterColumns:i,groupAfterStartWidth:s,groupAfterRatios:o}=this.getInitialValues(e);this.resizeCols=t,this.resizeStartWidth=r,this.resizeRatios=n,this.resizeTakeFromCols=i,this.resizeTakeFromStartWidth=s,this.resizeTakeFromRatios=o,this.toggleColumnResizing(!0)}onResizing(e,t,r="uiColumnResized"){const n=this.normaliseDragChange(t),i=this.resizeStartWidth+n;this.resizeColumnsFromLocalValues(i,r,e)}getInitialValues(e){const t=u=>u.reduce((d,h)=>d+h.getActualWidth(),0),r=(u,d)=>u.map(h=>h.getActualWidth()/d),n=this.getColumnsToResize(),i=t(n),s=r(n,i),o={columnsToResize:n,resizeStartWidth:i,resizeRatios:s};let a=null;if(e&&(a=this.beans.colGroupSvc?.getGroupAtDirection(this.columnGroup,"After")??null),a){const u=a.getDisplayedLeafColumns(),d=o.groupAfterColumns=u.filter(g=>g.isResizable()),h=o.groupAfterStartWidth=t(d);o.groupAfterRatios=r(d,h)}else o.groupAfterColumns=void 0,o.groupAfterStartWidth=void 0,o.groupAfterRatios=void 0;return o}resizeLeafColumnsToFit(e){const t=this.beans.autoWidthCalc.getPreferredWidthForColumnGroup(this.columnGroup),r=this.getInitialValues();t>r.resizeStartWidth&&this.resizeColumns(r,t,e,!0)}resizeColumnsFromLocalValues(e,t,r=!0){if(!this.resizeCols||!this.resizeRatios)return;const n={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:this.resizeTakeFromCols,groupAfterStartWidth:this.resizeTakeFromStartWidth,groupAfterRatios:this.resizeTakeFromRatios};this.resizeColumns(n,e,t,r)}resizeColumns(e,t,r,n=!0){const{columnsToResize:i,resizeStartWidth:s,resizeRatios:o,groupAfterColumns:a,groupAfterStartWidth:u,groupAfterRatios:d}=e,h=[];if(h.push({columns:i,ratios:o,width:t}),a){const g=t-s;h.push({columns:a,ratios:d,width:u-g})}this.beans.colResize?.resizeColumnSets({resizeSets:h,finished:n,source:r}),n&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.toggleCss("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(t=>t.isResizable())}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?this.pinned!=="left"&&(t*=-1):this.pinned==="right"&&(t*=-1),t}destroy(){super.destroy(),this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}},uY=class extends Ee{constructor(e,t,r,n,i){super(),this.pinned=e,this.column=t,this.eResize=r,this.comp=n,this.ctrl=i}postConstruct(){const e=[];let t,r;const n=()=>{if(Er(this.eResize,t),!t)return;const{horizontalResizeSvc:o,colAutosize:a}=this.beans,u=o.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});e.push(u),r&&a&&e.push(a.addColumnAutosizeListeners(this.eResize,this.column))},i=()=>{for(const o of e)o();e.length=0},s=()=>{const o=this.column.isResizable(),a=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(o!==t||a!==r)&&(t=o,r=a,i(),n())};s(),this.addDestroyFunc(i),this.ctrl.setRefreshFunction("resize",s)}onResizing(e,t){const{column:r,lastResizeAmount:n,resizeStartWidth:i,beans:s}=this,o=this.normaliseResizeAmount(t),a=i+o,u=[{key:r,newWidth:a}],{pinnedCols:d,ctrlsSvc:h,colResize:g}=s;if(this.column.getPinned()){const m=d?.leftWidth??0,v=d?.rightWidth??0,w=lf(h.getGridBodyCtrl().eBodyViewport)-50;if(m+v+(o-n)>w)return}this.lastResizeAmount=o,g?.setColumnWidths(u,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.column.resizing=e,this.comp.toggleCss("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e;const r=this.pinned!=="left",n=this.pinned==="right";return this.gos.get("enableRtl")?r&&(t*=-1):n&&(t*=-1),t}},dY=class extends Ee{constructor(){super(...arguments),this.beanName="colResize"}setColumnWidths(e,t,r,n){const i=[],{colModel:s,gos:o,visibleCols:a}=this.beans;for(const u of e){const d=s.getColDefCol(u.key)||s.getCol(u.key);if(!d)continue;if(i.push({width:u.newWidth,ratios:[1],columns:[d]}),o.get("colResizeDefault")==="shift"&&(t=!t),t){const g=a.getColAfter(d);if(!g)continue;const m=d.getActualWidth()-u.newWidth,v=g.getActualWidth()+m;i.push({width:v,ratios:[1],columns:[g]})}}i.length!==0&&this.resizeColumnSets({resizeSets:i,finished:r,source:n})}resizeColumnSets(e){const{resizeSets:t,finished:r,source:n}=e;if(!(!t||t.every(h=>hY(h)))){if(r){const h=t&&t.length>0?t[0].columns:null;Ju(this.eventSvc,h,r,n)}return}const s=[],o=[];for(const h of t){const{width:g,columns:m,ratios:v}=h,w={},C={};for(const R of m)o.push(R);let b=!0,x=0;for(;b;){if(x++,x>1e3){Zt(31);break}b=!1;const R=[];let E=0,A=g;m.forEach((M,F)=>{if(C[M.getId()])A-=w[M.getId()];else{R.push(M);const L=v[F];E+=L}});const D=1/E;R.forEach((M,F)=>{const O=F===R.length-1;let L;O?L=A:(L=Math.round(v[F]*g*D),A-=L);const W=M.getMinWidth(),I=M.getMaxWidth();L<W?(L=W,C[M.getId()]=!0,b=!0):I>0&&L>I&&(L=I,C[M.getId()]=!0,b=!0),w[M.getId()]=L})}for(const R of m){const E=w[R.getId()];R.getActualWidth()!==E&&(R.setActualWidth(E,n),s.push(R))}}const a=s.length>0;let u=[];if(a){const{colFlex:h,visibleCols:g,colViewport:m}=this.beans;u=h?.refreshFlexedColumns({resizingCols:o,skipSetLeft:!0})??[],g.setLeftValues(n),g.updateBodyWidths(),m.checkViewportColumns()}const d=o.concat(u);(a||r)&&Ju(this.eventSvc,d,r,n,u)}resizeHeader(e,t,r){if(!e.isResizable())return;const n=e.getActualWidth(),i=e.getMinWidth(),s=e.getMaxWidth(),o=Math.min(Math.max(n+t,i),s);this.setColumnWidths([{key:e,newWidth:o}],r,!0,"uiColumnResized")}createResizeFeature(e,t,r,n,i){return new uY(e,t,r,n,i)}createGroupResizeFeature(e,t,r,n){return new cY(e,t,r,n)}};function hY(e){const{columns:t,width:r}=e;let n=0,i=0,s=!0;for(const u of t){const d=u.getMinWidth();n+=d||0;const h=u.getMaxWidth();h>0?i+=h:s=!1}const o=r>=n,a=!s||r<=i;return o&&a}var fY={moduleName:"ColumnResize",version:Ue,beans:[dY],apiFunctions:{setColumnWidths:lY},dependsOn:[Bj,EL]},gY=class extends Ee{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListeners(this.columnGroup,{displayedChildrenChanged:this.onDisplayedChildrenChanged.bind(this)}),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const e=this.onWidthChanged.bind(this);for(const t of this.columnGroup.getLeafColumns())t.__addEventListener("widthChanged",e),t.__addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push(()=>{t.__removeEventListener("widthChanged",e),t.__removeEventListener("visibleChanged",e)})}removeListenersOnChildrenColumns(){for(const e of this.removeChildListenersFuncs)e();this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const e=this.columnGroup.getActualWidth();this.comp.setWidth(`${e}px`),this.comp.toggleCss("ag-hidden",e===0)}},pY=class extends Ax{constructor(){super(...arguments),this.onSuppressColMoveChange=()=>{!this.isAlive()||this.isSuppressMoving()?this.removeDragSource():this.dragSource||this.setDragSource(this.eGui)}}wireComp(e,t,r,n,i){const{column:s,beans:o}=this,{context:a,colNames:u,colHover:d,rangeSvc:h,colResize:g}=o;this.comp=e,i=Gf(this,a,i),this.setGui(t,i),this.displayName=u.getDisplayNameForColumnGroup(s,"header"),this.refreshHeaderStyles(),this.addClasses(),this.setupMovingCss(i),this.setupExpandable(i),this.setupTooltip(),this.setupAutoHeight({wrapperElement:n,compBean:i}),this.setupUserComp(),this.addHeaderMouseListeners(i),this.addManagedPropertyListener("groupHeaderHeight",this.refreshMaxHeaderHeight.bind(this)),this.refreshMaxHeaderHeight();const m=this.rowCtrl.pinned,v=s.getProvidedColumnGroup().getLeafColumns();d?.createHoverFeature(i,v,t),h?.createRangeHighlightFeature(i,s,e),i.createManagedBean(new Dx(s,t,o)),i.createManagedBean(new gY(e,s)),g?this.resizeFeature=i.createManagedBean(g.createGroupResizeFeature(e,r,m,s)):e.setResizableDisplayed(!1),i.createManagedBean(new wd(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addHighlightListeners(i,v),i.addManagedPropertyListener("suppressMovableColumns",this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners(i),i.addDestroyFunc(()=>this.clearComponent())}getHeaderClassParams(){const{column:e,beans:t}=this,r=e.getDefinition();return it(t.gos,{colDef:r,columnGroup:e,floatingFilter:!1})}refreshMaxHeaderHeight(){const{gos:e,comp:t}=this,r=e.get("groupHeaderHeight");r!=null?r===0?t.setHeaderWrapperHidden(!0):t.setHeaderWrapperMaxHeight(r):(t.setHeaderWrapperHidden(!1),t.setHeaderWrapperMaxHeight(null))}addHighlightListeners(e,t){if(this.beans.gos.get("suppressMoveWhenColumnDragging"))for(const r of t)e.addManagedListeners(r,{headerHighlightChanged:this.onLeafColumnHighlightChanged.bind(this,r)})}onLeafColumnHighlightChanged(e){const t=this.column.getDisplayedLeafColumns(),r=t[0]===e,n=ir(t)===e;if(!r&&!n)return;const i=e.getHighlighted(),s=!!this.rowCtrl.getHeaderCellCtrls().find(u=>u.column.isMoving());let o=!1,a=!1;if(s){const u=this.beans.gos.get("enableRtl"),d=i===1,h=i===0;r&&(u?a=d:o=h),n&&(u?o=h:a=d)}this.comp.toggleCss("ag-header-highlight-before",o),this.comp.toggleCss("ag-header-highlight-after",a)}resizeHeader(e,t){const{resizeFeature:r}=this;if(!r)return;const n=r.getInitialValues(t);r.resizeColumns(n,n.resizeStartWidth+e,"uiColumnResized",!0)}resizeLeafColumnsToFit(e){this.resizeFeature?.resizeLeafColumnsToFit(e)}setupUserComp(){const{colGroupSvc:e,userCompFactory:t,gos:r,enterpriseMenuFactory:n}=this.beans,i=this.column,s=i.getProvidedColumnGroup(),o=it(r,{displayName:this.displayName,columnGroup:i,setExpanded:u=>{e.setColumnGroupOpened(s,u,"gridInitializing")},setTooltip:(u,d)=>{r.assertModuleRegistered("Tooltip",3),this.setupTooltip(u,d)},showColumnMenu:(u,d)=>n?.showMenuAfterButtonClick(s,u,"columnMenu",d),showColumnMenuAfterMouseClick:(u,d)=>n?.showMenuAfterMouseEvent(s,u,"columnMenu",d),eGridHeader:this.eGui}),a=DW(t,o);a&&this.comp.setUserCompDetails(a)}addHeaderMouseListeners(e){const t=i=>this.handleMouseOverChange(i.type==="mouseenter"),r=()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column.getProvidedColumnGroup()),n=i=>this.handleContextMenuMouseEvent(i,void 0,this.column.getProvidedColumnGroup());e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:r,contextmenu:n})}handleMouseOverChange(e){this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column.getProvidedColumnGroup()})}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderGroupTooltip(this.tooltipFeature,this,e,t)}setupExpandable(e){const t=this.column.getProvidedColumnGroup();this.refreshExpanded();const r=this.refreshExpanded.bind(this);e.addManagedListeners(t,{expandedChanged:r,expandableChanged:r})}refreshExpanded(){const{column:e}=this;this.expandable=e.isExpandable();const t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0),this.refreshHeaderStyles()}addClasses(){const{column:e}=this,t=e.getColGroupDef(),r=oL(t,this.gos,null,e);e.isPadding()?(r.push("ag-header-group-cell-no-group"),e.getLeafColumns().every(i=>i.isSpanHeaderHeight())&&r.push("ag-header-span-height")):(r.push("ag-header-group-cell-with-group"),t?.wrapHeaderText&&r.push("ag-header-cell-wrap-text"));for(const n of r)this.comp.toggleCss(n,!0)}setupMovingCss(e){const{column:t}=this,n=t.getProvidedColumnGroup().getLeafColumns(),i=()=>this.comp.toggleCss("ag-header-cell-moving",t.isMoving());for(const s of n)e.addManagedListeners(s,{movingChanged:i});i()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||this.focusThis()}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();if(!(!this.expandable||!t)&&e.key===me.ENTER){const r=this.column,n=!r.isExpanded();this.beans.colGroupSvc.setColumnGroupOpened(r.getProvidedColumnGroup(),n,"uiColumnExpanded")}}setDragSource(e){!this.isAlive()||this.isSuppressMoving()||(this.removeDragSource(),e&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null))}isSuppressMoving(){return this.gos.get("suppressMovableColumns")||this.column.getLeafColumns().some(e=>e.getColDef().suppressMovable||e.getColDef().lockPosition)}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function mY(e,t,r){e.colGroupSvc?.setColumnGroupOpened(t,r,"api")}function vY(e,t,r){return e.colGroupSvc?.getColumnGroup(t,r)??null}function wY(e,t){return e.colGroupSvc?.getProvidedColGroup(t)??null}function CY(e,t,r){return e.colNames.getDisplayNameForColumnGroup(t,r)||""}function yY(e){return e.colGroupSvc?.getColumnGroupState()??[]}function bY(e,t){e.colGroupSvc?.setColumnGroupState(t,"api")}function SY(e){e.colGroupSvc?.resetColumnGroupState("api")}function xY(e){return e.visibleCols.treeLeft}function EY(e){return e.visibleCols.treeCenter}function RY(e){return e.visibleCols.treeRight}function TY(e){return e.visibleCols.getAllTrees()}function FY(e,t){for(let r=0;r<t.length;r++){const n=e.indexOf(t[r]);n>=0&&(e[n]=e[e.length-1],e.pop())}}var DY=class extends Ee{constructor(){super(...arguments),this.beanName="visibleCols",this.colsAndGroupsMap={},this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.headerGroupRowCount=0,this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.isBodyWidthDirty=!0}refresh(e,t=!1){const{colFlex:r,colModel:n,colGroupSvc:i,colViewport:s,selectionColSvc:o}=this.beans;t||this.buildTrees(n,i),i?.updateOpenClosedVisibility(),this.leftCols=Ry(this.treeLeft),this.centerCols=Ry(this.treeCenter),this.rightCols=Ry(this.treeRight),o?.refreshVisibility(this.leftCols,this.centerCols,this.rightCols),this.joinColsAriaOrder(n),this.joinCols(),this.headerGroupRowCount=this.getHeaderRowCount(),this.setLeftValues(e),this.autoHeightCols=this.allCols.filter(a=>a.isAutoHeight()),r?.refreshFlexedColumns(),this.updateBodyWidths(),this.setFirstRightAndLastLeftPinned(n,this.leftCols,this.rightCols,e),s.checkViewportColumns(!1),this.eventSvc.dispatchEvent({type:"displayedColumnsChanged",source:e})}getHeaderRowCount(){if(!this.gos.get("hidePaddedHeaderRows"))return this.beans.colModel.cols.treeDepth;let e=0;for(const t of this.allCols){let r=t.getParent();for(;r;){if(!r.isPadding()){const n=r.getProvidedColumnGroup().getLevel()+1;n>e&&(e=n);break}r=r.getParent()}}return e}updateBodyWidths(){const e=Lo(this.centerCols),t=Lo(this.leftCols),r=Lo(this.rightCols);this.isBodyWidthDirty=this.bodyWidth!==e,(this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==r)&&(this.bodyWidth=e,this.leftWidth=t,this.rightWidth=r,this.eventSvc.dispatchEvent({type:"columnContainerWidthChanged"}),this.eventSvc.dispatchEvent({type:"displayedColumnsWidthChanged"}))}setLeftValues(e){this.setLeftValuesOfCols(e),this.setLeftValuesOfGroups()}setFirstRightAndLastLeftPinned(e,t,r,n){let i,s;this.gos.get("enableRtl")?(i=t?t[0]:null,s=r?ir(r):null):(i=t?ir(t):null,s=r?r[0]:null);for(const o of e.getCols())o.setLastLeftPinned(o===i,n),o.setFirstRightPinned(o===s,n)}buildTrees(e,t){const r=e.getColsToShow(),n=r.filter(u=>u.getPinned()=="left"),i=r.filter(u=>u.getPinned()=="right"),s=r.filter(u=>u.getPinned()!="left"&&u.getPinned()!="right"),o=new b_,a=u=>t?t.createColumnGroups(u):u.columns;this.treeLeft=a({columns:n,idCreator:o,pinned:"left",oldDisplayedGroups:this.treeLeft}),this.treeRight=a({columns:i,idCreator:o,pinned:"right",oldDisplayedGroups:this.treeRight}),this.treeCenter=a({columns:s,idCreator:o,pinned:null,oldDisplayedGroups:this.treeCenter}),this.updateColsAndGroupsMap()}clear(){this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.ariaOrderColumns=[]}joinColsAriaOrder(e){const t=e.getCols(),r=[],n=[],i=[];for(const s of t){const o=s.getPinned();o?o===!0||o==="left"?r.push(s):i.push(s):n.push(s)}this.ariaOrderColumns=r.concat(n).concat(i)}getAriaColIndex(e){let t;return Vr(e)?t=e.getLeafColumns()[0]:t=e,this.ariaOrderColumns.indexOf(t)+1}setLeftValuesOfGroups(){for(const e of[this.treeLeft,this.treeRight,this.treeCenter])for(const t of e)Vr(t)&&t.checkLeft()}setLeftValuesOfCols(e){const{colModel:t}=this.beans;if(!t.getColDefCols())return;const n=t.getCols().slice(0),i=this.gos.get("enableRtl");for(const s of[this.leftCols,this.rightCols,this.centerCols]){if(i){let o=Lo(s);for(const a of s)o-=a.getActualWidth(),a.setLeft(o,e)}else{let o=0;for(const a of s)a.setLeft(o,e),o+=a.getActualWidth()}FY(n,s)}for(const s of n)s.setLeft(null,e)}joinCols(){this.gos.get("enableRtl")?this.allCols=this.rightCols.concat(this.centerCols).concat(this.leftCols):this.allCols=this.leftCols.concat(this.centerCols).concat(this.rightCols)}getAllTrees(){return this.treeLeft&&this.treeRight&&this.treeCenter?this.treeLeft.concat(this.treeCenter).concat(this.treeRight):null}isColDisplayed(e){return this.allCols.indexOf(e)>=0}getLeftColsForRow(e){const{leftCols:t,beans:{colModel:r}}=this;return r.colSpanActive?this.getColsForRow(e,t):t}getRightColsForRow(e){const{rightCols:t,beans:{colModel:r}}=this;return r.colSpanActive?this.getColsForRow(e,t):t}getColsForRow(e,t,r,n){const i=[];let s=null;for(let o=0;o<t.length;o++){const a=t[o],u=t.length-o,d=Math.min(a.getColSpan(e),u),h=[a];if(d>1){const m=d-1;for(let v=1;v<=m;v++)h.push(t[o+v]);o+=m}let g;if(r){g=!1;for(const m of h)r(m)&&(g=!0)}else g=!0;g&&(i.length===0&&s&&(n&&n(a))&&i.push(s),i.push(a)),s=a}return i}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}getColBefore(e){const t=this.allCols,r=t.indexOf(e);return r>0?t[r-1]:null}isPinningLeft(){return this.leftCols.length>0}isPinningRight(){return this.rightCols.length>0}updateColsAndGroupsMap(){this.colsAndGroupsMap={};const e=t=>{this.colsAndGroupsMap[t.getUniqueId()]=t};$l(this.treeCenter,!1,e),$l(this.treeLeft,!1,e),$l(this.treeRight,!1,e)}isVisible(e){return this.colsAndGroupsMap[e.getUniqueId()]===e}getFirstColumn(){const e=this.gos.get("enableRtl"),t=["leftCols","centerCols","rightCols"];e&&t.reverse();for(let r=0;r<t.length;r++){const n=this[t[r]];if(n.length)return e?ir(n):n[0]}return null}getColAfter(e){const t=this.allCols,r=t.indexOf(e);return r<t.length-1?t[r+1]:null}getColsLeftWidth(){return Lo(this.leftCols)}getDisplayedColumnsRightWidth(){return Lo(this.rightCols)}isColAtEdge(e,t){const r=this.allCols;if(!r.length)return!1;const n=t==="first";let i;if(Vr(e)){const s=e.getDisplayedLeafColumns();if(!s.length)return!1;i=n?s[0]:ir(s)}else i=e;return(n?r[0]:ir(r))===i}};function $l(e,t,r){if(e)for(let n=0;n<e.length;n++){const i=e[n];if(Vr(i)){const s=t?i.getDisplayedChildren():i.getChildren();$l(s,t,r)}r(i)}}function Ry(e){const t=[];return $l(e,!0,r=>{Ya(r)&&t.push(r)}),t}var AY=class extends Ee{constructor(){super(...arguments),this.beanName="colGroupSvc"}getColumnGroupState(){const e=[],t=this.beans.colModel.getColTree();return Vo(null,t,r=>{Tn(r)&&e.push({groupId:r.getGroupId(),open:r.isExpanded()})}),e}resetColumnGroupState(e){const t=this.beans.colModel.getColDefColTree();if(!t)return;const r=[];Vo(null,t,n=>{if(Tn(n)){const i=n.getColGroupDef(),s={groupId:n.getGroupId(),open:i?i.openByDefault:void 0};r.push(s)}}),this.setColumnGroupState(r,e)}setColumnGroupState(e,t){const{colModel:r,colAnimation:n,visibleCols:i,eventSvc:s}=this.beans;if(!r.getColTree().length)return;n?.start();const a=[];for(const u of e){const d=u.groupId,h=u.open,g=this.getProvidedColGroup(d);g&&g.isExpanded()!==h&&(g.setExpanded(h),a.push(g))}i.refresh(t,!0),a.length&&s.dispatchEvent({type:"columnGroupOpened",columnGroup:a.length===1?a[0]:void 0,columnGroups:a}),n?.finish()}setColumnGroupOpened(e,t,r){let n;Tn(e)?n=e.getId():n=e||"",this.setColumnGroupState([{groupId:n,open:t}],r)}getProvidedColGroup(e){let t=null;return Vo(null,this.beans.colModel.getColTree(),r=>{Tn(r)&&r.getId()===e&&(t=r)}),t}getGroupAtDirection(e,t){const r=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),n=e.getDisplayedLeafColumns(),i=t==="After"?ir(n):n[0],s=`getCol${t}`;for(;;){const o=this.beans.visibleCols[s](i);if(!o)return null;const a=this.getColGroupAtLevel(o,r);if(a!==e)return a}}getColGroupAtLevel(e,t){let r=e.getParent(),n,i;for(;n=r.getProvidedColumnGroup().getLevel(),i=r.getPaddingLevel(),!(n+i<=t);)r=r.getParent();return r}updateOpenClosedVisibility(){const e=this.beans.visibleCols.getAllTrees();$l(e,!1,t=>{Vr(t)&&t.calculateDisplayedColumns()})}getColumnGroup(e,t){if(!e)return null;if(Vr(e))return e;const r=this.beans.visibleCols.getAllTrees(),n=typeof t=="number";let i=null;return $l(r,!1,s=>{if(Vr(s)){const o=s;let a;n?a=e===o.getGroupId()&&t===o.getPartId():a=e===o.getGroupId(),a&&(i=o)}}),i}createColumnGroups(e){const{columns:t,idCreator:r,pinned:n,oldDisplayedGroups:i,isStandaloneStructure:s}=e,o=this.mapOldGroupsById(i),a=[];let u=t;for(;u.length;){const d=u;u=[];let h=0;const g=m=>{const v=h;h=m;const w=d[v],b=(Vr(w)?w.getProvidedColumnGroup():w).getOriginalParent();if(b==null){for(let R=v;R<m;R++)a.push(d[R]);return}const x=this.createColumnGroup(b,r,o,n,s);for(let R=v;R<m;R++)x.addChild(d[R]);u.push(x)};for(let m=1;m<d.length;m++){const v=d[m],C=(Vr(v)?v.getProvidedColumnGroup():v).getOriginalParent(),b=d[h],R=(Vr(b)?b.getProvidedColumnGroup():b).getOriginalParent();C!==R&&g(m)}h<d.length&&g(d.length)}return s||this.setupParentsIntoCols(a,null),a}createProvidedColumnGroup(e,t,r,n,i,s,o){const a=i.getUniqueKey(t.groupId||null,null),u=YF(this.beans,t,a),d=new i0(u,a,!1,r);this.createBean(d);const h=this.findExistingGroup(t,s);h&&s.splice(h.idx,1);const g=h?.group;g&&d.setExpanded(g.isExpanded());const m=f_(this.beans,u.children,r+1,e,n,i,s,o);return d.setChildren(m),d}balanceColumnTree(e,t,r,n){const i=[];for(let s=0;s<e.length;s++){const o=e[s];if(Tn(o)){const a=o,u=this.balanceColumnTree(a.getChildren(),t+1,r,n);a.setChildren(u),i.push(a)}else{let a,u;for(let d=t;d<r;d++){const h=n.getUniqueKey(null,null),g=YF(this.beans,null,h),m=new i0(g,h,!0,d);this.createBean(m),u&&u.setChildren([m]),u=m,a||(a=u)}if(a&&u)if(i.push(a),e.some(h=>Tn(h))){u.setChildren([o]);continue}else{u.setChildren(e);break}i.push(o)}}return i}findDepth(e){let t=0,r=e;for(;r?.[0]&&Tn(r[0]);)t++,r=r[0].getChildren();return t}findMaxDepth(e,t){let r=t;for(let n=0;n<e.length;n++){const i=e[n];if(Tn(i)){const s=i,o=this.findMaxDepth(s.getChildren(),t+1);r<o&&(r=o)}}return r}balanceTreeForAutoCols(e,t){const r=[];for(const n of e){let i=n;for(let s=t-1;s>=0;s--){const o=new i0(null,`FAKE_PATH_${n.getId()}}_${s}`,!0,s);this.createBean(o),o.setChildren([i]),i.originalParent=o,i=o}t===0&&(n.originalParent=null),r.push(i)}return r}findExistingGroup(e,t){if(e.groupId!=null)for(let n=0;n<t.length;n++){const i=t[n];if(i.getColGroupDef()&&i.getId()===e.groupId)return{idx:n,group:i}}}createColumnGroup(e,t,r,n,i){const s=e.getGroupId(),o=t.getInstanceIdForKey(s),a=$_(s,o);let u=r[a];return u&&u.getProvidedColumnGroup()!==e&&(u=null),$e(u)?u.reset():(u=new ff(e,s,o,n),i||this.createBean(u)),u}mapOldGroupsById(e){const t={},r=n=>{for(const i of n)if(Vr(i)){const s=i;t[i.getUniqueId()]=s,r(s.getChildren())}};return e&&r(e),t}setupParentsIntoCols(e,t){for(const r of e??[])if(r.parent!==t&&(this.beans.colViewport.colsWithinViewportHash=""),r.parent=t,Vr(r)){const n=r;this.setupParentsIntoCols(n.getChildren(),n)}}},kY={moduleName:"ColumnGroup",version:Ue,dynamicBeans:{headerGroupCellCtrl:pY},beans:[AY],apiFunctions:{getAllDisplayedColumnGroups:TY,getCenterDisplayedColumnGroups:EY,getColumnGroup:vY,getColumnGroupState:yY,getDisplayNameForColumnGroup:CY,getLeftDisplayedColumnGroups:xY,getProvidedColumnGroup:wY,getRightDisplayedColumnGroups:RY,resetColumnGroupState:SY,setColumnGroupOpened:mY,setColumnGroupState:bY}},PY={tag:"div",cls:"ag-skeleton-container"},MY=class extends Dr{constructor(){super(PY)}init(t){const r=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",r),this.addDestroyFunc(()=>of(t.eParentOfValue)),of(t.eParentOfValue,r),t.deferRender?this.setupLoading(t):t.node.failedLoad?this.setupFailed():this.setupLoading(t)}setupFailed(){const t=this.getLocaleTextFunc();this.getGui().textContent=t("loadingError","ERR");const r=t("ariaSkeletonCellLoadingFailed","Row failed to load");Qu(this.getGui(),r)}setupLoading(t){const r=jn({tag:"div",cls:"ag-skeleton-effect"}),n=t.node.rowIndex;if(n!=null){const o=75+25*(n%2===0?Math.sin(n):Math.cos(n));r.style.width=`${o}%`}this.getGui().appendChild(r);const i=this.getLocaleTextFunc(),s=t.deferRender?i("ariaDeferSkeletonCellLoading","Cell is loading"):i("ariaSkeletonCellLoading","Row data is loading");Qu(this.getGui(),s)}refresh(t){return!1}},_Y={moduleName:"CheckboxCellRenderer",version:Ue,userComponents:{agCheckboxCellRenderer:P$}},LY={moduleName:"SkeletonCellRenderer",version:Ue,userComponents:{agSkeletonCellRenderer:MY}};function IY(e,t){const r=e.colModel.getColDefCol(t);return r?r.getColDef():null}function OY(e){return e.colModel.getColumnDefs(!0)}function NY(e,t,r){return e.colNames.getDisplayNameForColumn(t,r)||""}function BY(e,t){return e.colModel.getColDefCol(t)}function HY(e){return e.colModel.getColDefCols()}function GY(e,t){return Ss(e,t,"api")}function VY(e){return O0(e)}function zY(e){J7(e,"api")}function WY(e){return e.visibleCols.isPinningLeft()||e.visibleCols.isPinningRight()}function UY(e){return e.visibleCols.isPinningLeft()}function $Y(e){return e.visibleCols.isPinningRight()}function jY(e,t){return e.visibleCols.getColAfter(t)}function YY(e,t){return e.visibleCols.getColBefore(t)}function KY(e,t,r){e.colModel.setColsVisible(t,r,"api")}function qY(e,t,r){e.pinnedCols?.setColsPinned(t,r,"api")}function XY(e){return e.colModel.getCols()}function QY(e){return e.visibleCols.leftCols}function ZY(e){return e.visibleCols.centerCols}function JY(e){return e.visibleCols.rightCols}function eK(e){return e.visibleCols.allCols}function tK(e){return e.colViewport.getViewportColumns()}function zb(e,t){if(!e)return;const r=e,n={};for(const i of Object.keys(r)){if(t&&t.indexOf(i)>=0||WM.has(i))continue;const s=r[i];typeof s=="object"&&s!==null&&s.constructor===Object?n[i]=zb(s):n[i]=s}return n}var rK=class extends Ee{constructor(){super(...arguments),this.beanName="colDefFactory"}wireBeans(e){this.rowGroupColsSvc=e.rowGroupColsSvc,this.pivotColsSvc=e.pivotColsSvc}getColumnDefs(e,t,r,n,i=!1){const s=e.slice();t?s.sort((u,d)=>r.indexOf(u)-r.indexOf(d)):(r||i)&&s.sort((u,d)=>n.indexOf(u)-n.indexOf(d));const o=this.rowGroupColsSvc?.columns,a=this.pivotColsSvc?.columns;return this.buildColumnDefs(s,o,a)}buildColumnDefs(e,t=[],r=[]){const n=[],i={};for(const s of e){const o=this.createDefFromColumn(s,t,r);let a=!0,u=o,d=s.getOriginalParent(),h=null;for(;d;){let g=null;if(d.isPadding()){d=d.getOriginalParent();continue}const m=i[d.getGroupId()];if(m){m.children.push(u),a=!1;break}if(g=this.createDefFromGroup(d),g&&(g.children=[u],i[g.groupId]=g,u=g,d=d.getOriginalParent()),d!=null&&h===d){a=!1;break}h=d}a&&n.push(u)}return n}createDefFromGroup(e){const t=zb(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,r){const n=zb(e.getColDef());return n.colId=e.getColId(),n.width=e.getActualWidth(),n.rowGroup=e.isRowGroupActive(),n.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,n.pivot=e.isPivotActive(),n.pivotIndex=e.isPivotActive()?r.indexOf(e):null,n.aggFunc=e.isValueActive()?e.getAggFunc():null,n.hide=e.isVisible()?void 0:!0,n.pinned=e.isPinned()?e.getPinned():null,n.sort=e.getSort()?e.getSort():null,n.sortIndex=e.getSortIndex()!=null?e.getSortIndex():null,n}},nK=class extends Ee{constructor(){super(...arguments),this.beanName="colFlex",this.columnsHidden=!1}refreshFlexedColumns(e={}){const t=e.source??"flex";e.viewportWidth!=null&&(this.flexViewportWidth=e.viewportWidth);const r=this.flexViewportWidth,{visibleCols:n,colDelayRenderSvc:i}=this.beans,s=n.centerCols;let o=-1;if(e.resizingCols){const C=new Set(e.resizingCols);for(let b=s.length-1;b>=0;b--)if(C.has(s[b])){o=b;break}}let a=!1;const u=s.map((C,b)=>{const x=C.getFlex(),R=x!=null&&x>0&&b>o;return a||(a=R),{col:C,isFlex:R,flex:Math.max(0,x??0),initialSize:C.getActualWidth(),min:C.getMinWidth(),max:C.getMaxWidth(),targetSize:0}});if(a?(i?.hideColumns("colFlex"),this.columnsHidden=!0):this.columnsHidden&&this.revealColumns(i),!r||!a)return[];let d=u.length,h=u.reduce((C,b)=>C+b.flex,0),g=r;const m=(C,b)=>{C.frozenSize=b,C.col.setActualWidth(b,t),g-=b,h-=C.flex,d-=1},v=C=>C.frozenSize!=null;for(const C of u)C.isFlex||m(C,C.initialSize);for(;d>0;){const C=Math.round(h<1?g*h:g);let b,x=0,R=0;for(const D of u){if(v(D))continue;b=D,R+=C*(D.flex/h);const M=R-x,F=Math.round(M);D.targetSize=F,x+=F}b&&(b.targetSize+=C-x);let E=0;for(const D of u){if(v(D))continue;const M=D.targetSize,F=Math.min(Math.max(M,D.min),D.max);E+=F-M,D.violationType=F===M?void 0:F<M?"max":"min",D.targetSize=F}const A=E===0?"all":E>0?"min":"max";for(const D of u)v(D)||(A==="all"||D.violationType===A)&&m(D,D.targetSize)}e.skipSetLeft||n.setLeftValues(t),e.updateBodyWidths&&n.updateBodyWidths();const w=u.filter(C=>C.isFlex&&!C.violationType).map(C=>C.col);if(e.fireResizedEvent){const C=u.filter(x=>x.initialSize!==x.frozenSize).map(x=>x.col),b=u.filter(x=>x.flex).map(x=>x.col);Ju(this.eventSvc,C,!0,t,b)}return this.revealColumns(i),w}revealColumns(e){this.columnsHidden&&(e?.revealColumns("colFlex"),this.columnsHidden=!1)}initCol(e){const{flex:t,initialFlex:r}=e.colDef;t!==void 0?e.flex=t:r!==void 0&&(e.flex=r)}setColFlex(e,t){e.flex=t??null,e.dispatchStateUpdatedEvent("flex")}};function Vh(e,t,r){if(!t||!e)return;if(!r)return e[t];const n=t.split(".");let i=e;for(let s=0;s<n.length;s++){if(i==null)return;i=i[n[s]]}return i}var iK=["dateTimeString","dateString","text","number","boolean","date"],sK=class extends Ee{constructor(){super(...arguments),this.beanName="dataTypeSvc",this.dataTypeDefinitions={},this.isPendingInference=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[],this.columnDefinitionPropsPerDataType={number(){return{cellEditor:"agNumberCellEditor"}},boolean(){return{cellEditor:"agCheckboxCellEditor",cellRenderer:"agCheckboxCellRenderer",getFindText:()=>null,suppressKeyboardEvent:e=>!!e.colDef.editable&&e.event.key===me.SPACE}},date({formatValue:e}){return{cellEditor:"agDateCellEditor",keyCreator:e}},dateString({formatValue:e}){return{cellEditor:"agDateStringCellEditor",keyCreator:e}},dateTime(e){return this.date(e)},dateTimeString(e){return this.dateString(e)},object({formatValue:e,colModel:t,colId:r}){return{cellEditorParams:{useFormatter:!0},comparator:(n,i)=>{const s=t.getColDefCol(r),o=s?.getColDef();if(!s||!o)return 0;const a=n==null?"":e({column:s,node:null,value:n}),u=i==null?"":e({column:s,node:null,value:i});return a===u?0:a>u?1:-1},keyCreator:e}},text(){return{}}}}wireBeans(e){this.colModel=e.colModel}postConstruct(){this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",e=>{this.processDataTypeDefinitions(),this.colModel.recreateColumnDefs(e)})}processDataTypeDefinitions(){const e=this.getDefaultDataTypes(),t={},r={},n=h=>g=>{const{column:m,node:v,value:w}=g;let C=m.getColDef().valueFormatter;return C===h.groupSafeValueFormatter&&(C=h.valueFormatter),this.beans.valueSvc.formatValue(m,v,w,C)};for(const h of Object.keys(e)){const g=e[h],m={...g,groupSafeValueFormatter:_D(g,this.gos)};t[h]=m,r[h]=n(m)}const i=this.gos.get("dataTypeDefinitions")??{},s={};for(const h of Object.keys(i)){const g=i[h],m=this.processDataTypeDefinition(g,i,[h],e);m&&(t[h]=m,g.dataTypeMatcher&&(s[h]=g.dataTypeMatcher),r[h]=n(m))}const{valueParser:o,valueFormatter:a}=e.object,{valueParser:u,valueFormatter:d}=t.object;this.hasObjectValueParser=u!==o,this.hasObjectValueFormatter=d!==a,this.formatValueFuncs=r,this.dataTypeDefinitions=t,this.dataTypeMatchers=this.sortKeysInMatchers(s,e)}sortKeysInMatchers(e,t){const r={...e};for(const n of iK)delete r[n],r[n]=e[n]??t[n].dataTypeMatcher;return r}processDataTypeDefinition(e,t,r,n){let i;const s=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let o=n[s];const a=t[s];if(o&&a&&(o=a),!MD(e,o,s))return;i=PD(o,e)}else{if(r.includes(s)){Me(44);return}const o=t[s];if(!MD(e,o,s))return;const a=this.processDataTypeDefinition(o,t,[...r,s],n);if(!a)return;i=PD(a,e)}return{...i,groupSafeValueFormatter:_D(i,this.gos)}}updateColDefAndGetColumnType(e,t,r){let{cellDataType:n}=t;const{field:i}=t;if(n===void 0&&(n=e.cellDataType),(n==null||n===!0)&&(n=this.canInferCellDataType(e,t)?this.inferCellDataType(i,r):!1),!n){e.cellDataType=!1;return}const s=this.dataTypeDefinitions[n];if(!s){Me(47,{cellDataType:n});return}return e.cellDataType=n,s.groupSafeValueFormatter&&(e.valueFormatter=s.groupSafeValueFormatter),s.valueParser&&(e.valueParser=s.valueParser),s.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,n,s,r),s.columnTypes}addColumnListeners(e){if(!this.isPendingInference)return;const t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;const r=n=>{t.add(n.key)};e.__addEventListener("columnStateUpdated",r),this.columnStateUpdateListenerDestroyFuncs.push(()=>e.__removeEventListener("columnStateUpdated",r))}canInferCellDataType(e,t){const{gos:r}=this;if(!_r(r))return!1;const n={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(Ty(t,n))return!1;const i=t.type===null?e.type:t.type;if(i){const s=r.get("columnTypes")??{};if(I0(i).some(a=>{const u=s[a.trim()];return u&&Ty(u,n)}))return!1}return!Ty(e,n)}inferCellDataType(e,t){if(!e)return;let r;const n=this.getInitialData();if(n){const s=e.includes(".")&&!this.gos.get("suppressFieldDotNotation");r=Vh(n,e,s)}else this.initWaitForRowData(t);return r==null?void 0:Object.keys(this.dataTypeMatchers).find(s=>this.dataTypeMatchers[s](r))??"object"}getInitialData(){const e=this.gos.get("rowData");if(e?.length)return e[0];if(this.initialData)return this.initialData;{const t=this.beans.rowModel.rootNode?._leafs;if(t?.length)return t[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isPendingInference)return;this.isPendingInference=!0;const t=this.isColumnTypeOverrideInDataTypeDefinitions,{colAutosize:r,eventSvc:n}=this.beans;t&&r&&(r.shouldQueueResizeOperations=!0);const[i]=this.addManagedEventListeners({rowDataUpdateStarted:s=>{const{firstRowData:o}=s;o&&(i?.(),this.isPendingInference=!1,this.processColumnsPendingInference(o,t),this.columnStateUpdatesPendingInference={},t&&r?.processResizeOperations(),n.dispatchEvent({type:"dataTypesInferred"}))}})}processColumnsPendingInference(e,t){this.initialData=e;const r=[];this.destroyColumnStateUpdateListeners();const n={},i={};for(const s of Object.keys(this.columnStateUpdatesPendingInference)){const o=this.columnStateUpdatesPendingInference[s],a=this.colModel.getCol(s);if(!a)return;const u=a.getColDef();if(!this.resetColDefIntoCol(a,"cellDataTypeInferred"))return;const d=a.getColDef();if(t&&d.type&&d.type!==u.type){const h=aK(a,o);h.rowGroup&&h.rowGroupIndex==null&&(n[s]=h),h.pivot&&h.pivotIndex==null&&(i[s]=h),r.push(h)}}t&&r.push(...this.generateColumnStateForRowGroupAndPivotIndexes(n,i)),r.length&&Ss(this.beans,{state:r},"cellDataTypeInferred"),this.initialData=null}generateColumnStateForRowGroupAndPivotIndexes(e,t){const r={},{rowGroupColsSvc:n,pivotColsSvc:i}=this.beans;return n?.restoreColumnOrder(r,e),i?.restoreColumnOrder(r,t),Object.values(r)}resetColDefIntoCol(e,t){const r=e.getUserProvidedColDef();if(!r)return!1;const n=Rb(this.beans,r,e.getColId());return e.setColDef(n,r,t),!0}getDateStringTypeDefinition(e){const{dateString:t}=this.dataTypeDefinitions;return e?this.getDataTypeDefinition(e)??t:t}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDateIncludesTimeFlag(e){return e==="dateTime"||e==="dateTimeString"}getDataTypeDefinition(e){const t=e.getColDef();if(t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){return this.getDataTypeDefinition(e)?.baseDataType}checkType(e,t){if(t==null)return!0;const r=this.getDataTypeDefinition(e)?.dataTypeMatcher;return r?r(t):!0}validateColDef(e){const t=r=>Me(48,{property:r});if(e.cellDataType==="object"){const{object:r}=this.dataTypeDefinitions;e.valueFormatter===r.groupSafeValueFormatter&&!this.hasObjectValueFormatter&&t("Formatter"),e.editable&&e.valueParser===r.valueParser&&!this.hasObjectValueParser&&t("Parser")}}postProcess(e){const t=e.cellDataType;if(!t||typeof t!="string")return;const{dataTypeDefinitions:r,beans:n,formatValueFuncs:i}=this,s=r[t];s&&n.colFilter?.setColDefPropsForDataType(e,s,i[t])}getFormatValue(e){return this.formatValueFuncs[e]}isColPendingInference(e){return this.isPendingInference&&!!this.columnStateUpdatesPendingInference[e]}setColDefPropertiesForBaseDataType(e,t,r,n){const i=this.formatValueFuncs[t],s=this.columnDefinitionPropsPerDataType[r.baseDataType]({colDef:e,cellDataType:t,colModel:this.colModel,dataTypeDefinition:r,colId:n,formatValue:i});Object.assign(e,s)}getDateObjectTypeDef(e){const t=this.getLocaleTextFunc(),r=this.getDateIncludesTimeFlag(e);return{baseDataType:e,valueParser:n=>ui(n.newValue&&String(n.newValue)),valueFormatter:n=>n.value==null?"":!(n.value instanceof Date)||isNaN(n.value.getTime())?t("invalidDate","Invalid Date"):Fi(n.value,r)??"",dataTypeMatcher:n=>n instanceof Date}}getDateStringTypeDef(e){const t=this.getDateIncludesTimeFlag(e);return{baseDataType:e,dateParser:r=>ui(r)??void 0,dateFormatter:r=>Fi(r??null,t)??void 0,valueParser:r=>s0(String(r.newValue))?r.newValue:null,valueFormatter:r=>s0(String(r.value))?String(r.value):"",dataTypeMatcher:r=>typeof r=="string"&&s0(r)}}getDefaultDataTypes(){const e=this.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:t=>t.newValue?.trim?.()===""?null:Number(t.newValue),valueFormatter:t=>t.value==null?"":typeof t.value!="number"||isNaN(t.value)?e("invalidNumber","Invalid Number"):String(t.value),dataTypeMatcher:t=>typeof t=="number"},text:{baseDataType:"text",valueParser:t=>t.newValue===""?null:vb(t.newValue),dataTypeMatcher:t=>typeof t=="string"},boolean:{baseDataType:"boolean",valueParser:t=>t.newValue==null?t.newValue:t.newValue?.trim?.()===""?null:String(t.newValue).toLowerCase()==="true",valueFormatter:t=>t.value==null?"":String(t.value),dataTypeMatcher:t=>typeof t=="boolean"},date:this.getDateObjectTypeDef("date"),dateString:this.getDateStringTypeDef("dateString"),dateTime:this.getDateObjectTypeDef("dateTime"),dateTimeString:{...this.getDateStringTypeDef("dateTimeString"),dataTypeMatcher:t=>typeof t=="string"&&$W(t)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:t=>vb(t.value)??""}}}destroyColumnStateUpdateListeners(){for(const e of this.columnStateUpdateListenerDestroyFuncs)e();this.columnStateUpdateListenerDestroyFuncs=[]}destroy(){this.dataTypeDefinitions={},this.dataTypeMatchers={},this.formatValueFuncs={},this.columnStateUpdatesPendingInference={},this.destroyColumnStateUpdateListeners(),super.destroy()}};function PD(e,t){const r={...e,...t};return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(r.columnTypes=[...I0(e.columnTypes),...I0(t.columnTypes)]),r}function MD(e,t,r){return t?t.baseDataType!==e.baseDataType?(Me(46),!1):!0:(Me(45,{parentCellDataType:r}),!1)}function _D(e,t){if(e.valueFormatter)return r=>{if(r.node?.group){const n=(r.colDef.pivotValueColumn??r.column).getAggFunc();if(n){if(n==="first"||n==="last")return e.valueFormatter(r);if(e.baseDataType==="number"&&n!=="count"){if(typeof r.value=="number")return e.valueFormatter(r);if(typeof r.value=="object"){if(!r.value)return;if("toNumber"in r.value)return e.valueFormatter({...r,value:r.value.toNumber()});if("value"in r.value)return e.valueFormatter({...r,value:r.value.value})}}return}}else if(t.get("groupHideOpenParents")&&r.column.isRowGroupActive()&&typeof r.value=="string"&&!e.dataTypeMatcher?.(r.value))return;return e.valueFormatter(r)}}function oK(e,t,r,n){if(!t[r])return!1;const i=e[r];return i===null?(t[r]=!1,!1):n===void 0?!!i:i===n}function Ty(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([r,n])=>oK(e,t,r,n))}function aK(e,t){const r=y_(e);for(const n of t)delete r[n],n==="rowGroup"?delete r.rowGroupIndex:n==="pivot"&&delete r.pivotIndex;return r}var lK={moduleName:"DataType",version:Ue,beans:[sK],dependsOn:[_Y]},cK={moduleName:"ColumnFlex",version:Ue,beans:[nK]},RL={moduleName:"ColumnApi",version:Ue,beans:[rK],apiFunctions:{getColumnDef:IY,getDisplayNameForColumn:NY,getColumn:BY,getColumns:HY,applyColumnState:GY,getColumnState:VY,resetColumnState:zY,isPinning:WY,isPinningLeft:UY,isPinningRight:$Y,getDisplayedColAfter:jY,getDisplayedColBefore:YY,setColumnsVisible:KY,setColumnsPinned:qY,getAllGridColumns:XY,getDisplayedLeftColumns:QY,getDisplayedCenterColumns:ZY,getDisplayedRightColumns:JY,getAllDisplayedColumns:eK,getAllDisplayedVirtualColumns:tK,getColumnDefs:OY}};function uK(e){if(!e||e==null)return null;const t=/([a-z])([A-Z])/g,r=/([A-Z]+)([A-Z])([a-z])/g;return e.replace(t,"$1 $2").replace(r,"$1 $2$3").replace(/\./g," ").split(" ").map(i=>i.substring(0,1).toUpperCase()+(i.length>1?i.substring(1,i.length):"")).join(" ")}var dK=class extends Ee{constructor(){super(...arguments),this.beanName="colNames"}getDisplayNameForColumn(e,t,r=!1){if(!e)return null;const n=this.getHeaderName(e.getColDef(),e,null,null,t),{aggColNameSvc:i}=this.beans;return r&&i?i.getHeaderName(e,n):n}getDisplayNameForProvidedColumnGroup(e,t,r){const n=t?.getColGroupDef();return n?this.getHeaderName(n,null,e,t,r):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,r,n,i){const s=e.headerValueGetter;if(s){const o=it(this.gos,{colDef:e,column:t,columnGroup:r,providedColumnGroup:n,location:i});return typeof s=="function"?s(o):typeof s=="string"?this.beans.expressionSvc?.evaluate(s,o)??null:""}else{if(e.headerName!=null)return e.headerName;if(e.field)return uK(e.field)}return""}},hK=class extends Ee{constructor(){super(...arguments),this.beanName="colViewport",this.colsWithinViewport=[],this.headerColsWithinViewport=[],this.colsWithinViewportHash="",this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.columnsToRenderLeft=[],this.columnsToRenderRight=[],this.columnsToRenderCenter=[]}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel}postConstruct(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation")}setScrollPosition(e,t,r=!1){const{visibleCols:n}=this,i=n.isBodyWidthDirty;if(!(e===this.scrollWidth&&t===this.scrollPosition&&!i)){if(this.scrollWidth=e,this.scrollPosition=t,n.isBodyWidthDirty=!0,this.gos.get("enableRtl")){const o=n.bodyWidth;this.viewportLeft=o-t-e,this.viewportRight=o-t}else this.viewportLeft=t,this.viewportRight=e+t;this.colModel.ready&&this.checkViewportColumns(r)}}getColumnHeadersToRender(e){switch(e){case"left":return this.columnsToRenderLeft;case"right":return this.columnsToRenderRight;default:return this.columnsToRenderCenter}}getHeadersToRender(e,t){let r;switch(e){case"left":r=this.rowsOfHeadersToRenderLeft[t];break;case"right":r=this.rowsOfHeadersToRenderRight[t];break;default:r=this.rowsOfHeadersToRenderCenter[t];break}return r??[]}extractViewportColumns(){const e=this.visibleCols.centerCols;this.isColumnVirtualisationSuppressed()?(this.colsWithinViewport=e,this.headerColsWithinViewport=e):(this.colsWithinViewport=e.filter(this.isColumnInRowViewport.bind(this)),this.headerColsWithinViewport=e.filter(this.isColumnInHeaderViewport.bind(this)))}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||this.viewportRight===0}clear(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.colsWithinViewportHash=""}isColumnInHeaderViewport(e){return e.isAutoHeaderHeight()||fK(e)?!0:this.isColumnInRowViewport(e)}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;const t=e.getLeft()||0,r=t+e.getActualWidth(),n=this.viewportLeft-200,i=this.viewportRight+200,s=t<n&&r<n,o=t>i&&r>i;return!s&&!o}getViewportColumns(){const{leftCols:e,rightCols:t}=this.visibleCols;return this.colsWithinViewport.concat(e).concat(t)}getColsWithinViewport(e){if(!this.colModel.colSpanActive)return this.colsWithinViewport;const t=s=>{const o=s.getLeft();return $e(o)&&o>this.viewportLeft},r=this.isColumnVirtualisationSuppressed()?void 0:this.isColumnInRowViewport.bind(this),{visibleCols:n}=this,i=n.centerCols;return n.getColsForRow(e,i,r,t)}checkViewportColumns(e=!1){this.extractViewport()&&this.eventSvc.dispatchEvent({type:"virtualColumnsChanged",afterScroll:e})}calculateHeaderRows(){const{leftCols:e,rightCols:t}=this.visibleCols;this.columnsToRenderLeft=e,this.columnsToRenderRight=t,this.columnsToRenderCenter=this.colsWithinViewport;const r=n=>{const i=new Set,s={};for(const o of n){let a=o.getParent();const u=o.isSpanHeaderHeight();for(;a&&!i.has(a);){if(u&&a.isPadding()){a=a.getParent();continue}const h=a.getProvidedColumnGroup().getLevel();s[h]??(s[h]=[]),s[h].push(a),i.add(a),a=a.getParent()}}return s};this.rowsOfHeadersToRenderLeft=r(e),this.rowsOfHeadersToRenderRight=r(t),this.rowsOfHeadersToRenderCenter=r(this.headerColsWithinViewport)}extractViewport(){const e=n=>`${n.getId()}-${n.getPinned()||"normal"}`;this.extractViewportColumns();const t=this.getViewportColumns().map(e).join("#"),r=this.colsWithinViewportHash!==t;return r&&(this.colsWithinViewportHash=t,this.calculateHeaderRows()),r}};function fK(e){for(;e;){if(e.isAutoHeaderHeight())return!0;e=e.getParent()}return!1}var gK=class extends Ee{constructor(){super(...arguments),this.beanName="agCompUtils"}adaptFunction(e,t){if(!e.cellRenderer)return null;class r{refresh(){return!1}getGui(){return this.eGui}init(i){const s=t(i),o=typeof s;if(o==="string"||o==="number"||o==="boolean"){this.eGui=ex("<span>"+s+"</span>");return}if(s==null){this.eGui=jn({tag:"span"});return}this.eGui=s}}return r}},pK={moduleName:"CellRendererFunction",version:Ue,beans:[gK]},mK=class extends z9{constructor(){super(...arguments),this.agGridDefaults={},this.agGridDefaultOverrides={},this.jsComps={},this.selectors={},this.icons={}}postConstruct(){const e=this.gos.get("components");if(e!=null)for(const t of Object.keys(e))this.jsComps[t]=e[t]}registerModule(e){const{icons:t,userComponents:r,dynamicBeans:n,selectors:i}=e;if(r){const s=(o,a,u,d)=>{this.agGridDefaults[o]=a,(u||d)&&(this.agGridDefaultOverrides[o]={params:u,processParams:d})};for(const o of Object.keys(r)){let a=r[o];if(GW(a)&&(a=a.getComp(this.beans)),typeof a=="object"){const{classImp:u,params:d,processParams:h}=a;s(o,u,d,h)}else s(o,a)}}this.registerDynamicBeans(n);for(const s of i??[])this.selectors[s.selector]=s;if(t)for(const s of Object.keys(t))this.icons[s]=t[s]}getUserComponent(e,t){const r=(a,u,d,h)=>({componentFromFramework:u,component:a,params:d,processParams:h}),{frameworkOverrides:n}=this.beans,i=n.frameworkComponent(t,this.gos.get("components"));if(i!=null)return r(i,!0);const s=this.jsComps[t];if(s){const a=n.isFrameworkComponent(s);return r(s,a)}const o=this.agGridDefaults[t];if(o){const a=this.agGridDefaultOverrides[t];return r(o,!1,a?.params,a?.processParams)}return this.beans.validation?.missingUserComponent(e,t,this.agGridDefaults,this.jsComps),null}getSelector(e){return this.selectors[e]}getIcon(e){return this.icons[e]}getDynamicError(e,t){return t?eo(279,{name:e}):this.beans.validation?.missingDynamicBean(e)??eo(256)}},vK=23,wK=class extends Ee{constructor(){super(...arguments),this.beanName="ctrlsSvc",this.params={},this.ready=!1,this.readyCallbacks=[]}postConstruct(){this.addEventListener("ready",()=>{if(this.updateReady(),this.ready){for(const e of this.readyCallbacks)e(this.params);this.readyCallbacks.length=0}},this.beans.frameworkOverrides.runWhenReadyAsync?.()??!1)}updateReady(){const e=Object.values(this.params);this.ready=e.length===vK&&e.every(t=>t?.isAlive()??!1)}whenReady(e,t){this.ready?t(this.params):this.readyCallbacks.push(t),e.addDestroyFunc(()=>{const r=this.readyCallbacks.indexOf(t);r>=0&&this.readyCallbacks.splice(r,1)})}register(e,t){this.params[e]=t,this.updateReady(),this.ready&&this.dispatchLocalEvent({type:"ready"}),t.addDestroyFunc(()=>{this.updateReady()})}get(e){return this.params[e]}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){const{leftHeader:e,centerHeader:t,rightHeader:r}=this.params;return[e,r,t]}getHeaderRowContainerCtrl(e){const t=this.params;switch(e){case"left":return t.leftHeader;case"right":return t.rightHeader;default:return t.centerHeader}}getScrollFeature(){return this.getGridBodyCtrl().scrollFeature}},CK='.ag-aria-description-container{border:0;z-index:9999;clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.ag-unselectable{-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-selectable{-webkit-user-select:text;-moz-user-select:text;user-select:text}.ag-tab-guard{display:block;height:0;position:absolute;width:0}:where(.ag-virtual-list-viewport) .ag-tab-guard{position:sticky}.ag-tab-guard-top{top:1px}.ag-tab-guard-bottom{bottom:1px}.ag-shake-left-to-right{animation-direction:alternate;animation-duration:.2s;animation-iteration-count:infinite;animation-name:ag-shake-left-to-right}@keyframes ag-shake-left-to-right{0%{padding-left:6px;padding-right:2px}to{padding-left:2px;padding-right:6px}}.ag-body-horizontal-scroll-viewport,.ag-body-vertical-scroll-viewport,.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport,.ag-virtual-list-viewport{flex:1 1 auto;height:100%;min-width:0;overflow:hidden;position:relative}.ag-viewport{position:relative}.ag-spanning-container{position:absolute;top:0;z-index:1}.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport{overflow-x:auto;-ms-overflow-style:none!important;scrollbar-width:none!important;&::-webkit-scrollbar{display:none!important}}.ag-body-viewport{display:flex;overflow-x:hidden;&:where(.ag-layout-normal){overflow-y:auto;-webkit-overflow-scrolling:touch}}.ag-floating-bottom-container,.ag-floating-top-container,.ag-sticky-bottom-container,.ag-sticky-top-container{min-height:1px}.ag-center-cols-viewport{min-height:100%;width:100%}.ag-body-horizontal-scroll-viewport{overflow-x:scroll}.ag-body-vertical-scroll-viewport{overflow-y:scroll}.ag-virtual-list-viewport{overflow:auto;width:100%}.ag-body-container,.ag-body-horizontal-scroll-container,.ag-body-vertical-scroll-container,.ag-center-cols-container,.ag-floating-bottom-container,.ag-floating-bottom-full-width-container,.ag-floating-top-container,.ag-full-width-container,.ag-header-container,.ag-pinned-left-cols-container,.ag-pinned-right-cols-container,.ag-sticky-bottom-container,.ag-sticky-top-container,.ag-virtual-list-container{position:relative}.ag-floating-bottom-container,.ag-floating-top-container,.ag-header-container,.ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top,.ag-sticky-bottom-container,.ag-sticky-top-container{height:100%;white-space:nowrap}.ag-center-cols-container,.ag-pinned-right-cols-container{display:block}.ag-body-horizontal-scroll-container{height:100%}.ag-body-vertical-scroll-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container,.ag-full-width-container,.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{pointer-events:none;position:absolute;top:0}:where(.ag-ltr) .ag-floating-bottom-full-width-container,:where(.ag-ltr) .ag-floating-top-full-width-container,:where(.ag-ltr) .ag-full-width-container,:where(.ag-ltr) .ag-sticky-bottom-full-width-container,:where(.ag-ltr) .ag-sticky-top-full-width-container{left:0}:where(.ag-rtl) .ag-floating-bottom-full-width-container,:where(.ag-rtl) .ag-floating-top-full-width-container,:where(.ag-rtl) .ag-full-width-container,:where(.ag-rtl) .ag-sticky-bottom-full-width-container,:where(.ag-rtl) .ag-sticky-top-full-width-container{right:0}.ag-full-width-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container{display:inline-block;height:100%;overflow:hidden;width:100%}.ag-virtual-list-container{overflow:hidden}.ag-body{display:flex;flex:1 1 auto;flex-direction:row!important;min-height:0;position:relative}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:flex;min-height:0;min-width:0;position:relative;&:where(.ag-scrollbar-invisible){bottom:0;position:absolute;&:where(.ag-apple-scrollbar){opacity:0;transition:opacity .4s;visibility:hidden;&:where(.ag-scrollbar-scrolling,.ag-scrollbar-active){opacity:1;visibility:visible}}}}.ag-body-horizontal-scroll{width:100%;&:where(.ag-scrollbar-invisible){left:0;right:0}}.ag-body-vertical-scroll{height:100%;&:where(.ag-scrollbar-invisible){top:0;z-index:10}}:where(.ag-ltr) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){right:0}}:where(.ag-rtl) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){left:0}}.ag-force-vertical-scroll{overflow-y:scroll!important}.ag-horizontal-left-spacer,.ag-horizontal-right-spacer{height:100%;min-width:0;overflow-x:scroll;&:where(.ag-scroller-corner){overflow-x:hidden}}:where(.ag-row-animation) .ag-row{transition:transform .4s,top .4s,opacity .2s;&:where(.ag-after-created){transition:transform .4s,top .4s,height .4s,opacity .2s}}:where(.ag-row-animation.ag-prevent-animation) .ag-row{transition:none!important;&:where(.ag-row.ag-after-created){transition:none!important}}:where(.ag-row-no-animation) .ag-row{transition:none}.ag-row-loading{align-items:center;display:flex}.ag-row-position-absolute{position:absolute}.ag-row-position-relative{position:relative}.ag-full-width-row{overflow:hidden;pointer-events:all}.ag-row-inline-editing{z-index:1}.ag-row-dragging{z-index:2}.ag-stub-cell{align-items:center;display:flex}.ag-cell{display:inline-block;height:100%;position:absolute;white-space:nowrap;&:focus-visible{box-shadow:none}}.ag-cell-value{flex:1 1 auto}.ag-cell-value:not(.ag-allow-overflow),.ag-group-value{overflow:hidden;text-overflow:ellipsis}.ag-cell-wrap-text{white-space:normal;word-break:break-word}:where(.ag-cell) .ag-icon{display:inline-block;vertical-align:middle}.ag-floating-top{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-top:not(.ag-invisible)){border-bottom:var(--ag-pinned-row-border)}.ag-floating-bottom{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-bottom:not(.ag-invisible)){border-top:var(--ag-pinned-row-border)}.ag-sticky-bottom,.ag-sticky-top{background-color:var(--ag-data-background-color);display:flex;height:0;overflow:hidden;position:absolute;width:100%;z-index:1}.ag-opacity-zero{opacity:0!important}.ag-cell-label-container{align-items:center;display:flex;flex-direction:row-reverse;height:100%;justify-content:space-between;width:100%}:where(.ag-right-aligned-header){.ag-cell-label-container{flex-direction:row}.ag-header-cell-text{text-align:end}}.ag-column-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr){direction:ltr;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row}}:where(.ag-rtl){direction:rtl;text-align:right;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row-reverse}.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{display:block}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(180deg)}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(-180deg)}}.ag-measurement-container{height:0;overflow:hidden;visibility:hidden;width:0}.ag-measurement-element-border{display:inline-block;&:before{border-left:var(--ag-internal-measurement-border);content:"";display:block}}.ag-group{position:relative;width:100%}.ag-group-title-bar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-title{display:inline;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-group-title-bar) .ag-group-title{cursor:default}.ag-group-toolbar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-container{display:flex}.ag-disabled .ag-group-container{pointer-events:none}.ag-disabled-group-container,.ag-disabled-group-title-bar{opacity:.5}.ag-group-container-horizontal{flex-flow:row wrap}.ag-group-container-vertical{flex-direction:column}.ag-group-title-bar-icon{cursor:pointer;flex:none}:where(.ag-ltr) .ag-group-title-bar-icon{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-group-title-bar-icon{margin-left:var(--ag-spacing)}:where(.ag-group-item-alignment-stretch) .ag-group-item{align-items:stretch}:where(.ag-group-item-alignment-start) .ag-group-item{align-items:flex-start}:where(.ag-group-item-alignment-end) .ag-group-item{align-items:flex-end}:where(.ag-ltr) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-left:var(--ag-row-group-indent-size)}:where(.ag-rtl) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-right:var(--ag-row-group-indent-size)}:where(.ag-ltr) .ag-row-group-leaf-indent{margin-left:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}:where(.ag-rtl) .ag-row-group-leaf-indent{margin-right:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}.ag-value-change-delta{padding:0 2px}.ag-value-change-delta-up{color:var(--ag-value-change-delta-up-color)}.ag-value-change-delta-down{color:var(--ag-value-change-delta-down-color)}.ag-value-change-value{background-color:transparent;border-radius:1px;padding-left:1px;padding-right:1px;transition:background-color 1s}.ag-value-change-value-highlight{background-color:var(--ag-value-change-value-highlight-background-color);transition:background-color .1s}.ag-cell-data-changed{background-color:var(--ag-value-change-value-highlight-background-color)!important}.ag-cell-data-changed-animation{background-color:transparent}.ag-cell-highlight{background-color:var(--ag-range-selection-highlight-color)!important}.ag-row,.ag-spanned-row{color:var(--ag-cell-text-color);font-family:var(--ag-cell-font-family);font-size:var(--ag-data-font-size);white-space:nowrap;--ag-internal-content-line-height:calc(min(var(--ag-row-height), var(--ag-line-height, 1000px)) - var(--ag-internal-row-border-width, 1px) - 2px)}.ag-row{background-color:var(--ag-data-background-color);border-bottom:var(--ag-row-border);height:var(--ag-row-height);width:100%;&.ag-row-editing-invalid{background-color:var(--ag-full-row-edit-invalid-background-color)}}:where(.ag-body-vertical-content-no-gap>div>div>div,.ag-body-vertical-content-no-gap>div>div>div>div)>.ag-row-last{border-bottom-color:transparent}.ag-sticky-bottom{border-top:var(--ag-row-border);box-sizing:content-box!important}.ag-group-contracted,.ag-group-expanded{cursor:pointer}.ag-cell,.ag-full-width-row .ag-cell-wrapper.ag-row-group{border:1px solid transparent;line-height:var(--ag-internal-content-line-height);-webkit-font-smoothing:subpixel-antialiased}:where(.ag-ltr) .ag-cell{border-right:var(--ag-column-border)}:where(.ag-rtl) .ag-cell{border-left:var(--ag-column-border)}.ag-spanned-cell-wrapper{background-color:var(--ag-data-background-color);position:absolute}.ag-spanned-cell-wrapper>.ag-spanned-cell{display:block;position:relative}:where(.ag-ltr) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-right-color:transparent}:where(.ag-rtl) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-left-color:transparent}.ag-cell-wrapper{align-items:center;display:flex;>:where(:not(.ag-cell-value,.ag-group-value)){align-items:center;display:flex;height:var(--ag-internal-content-line-height)}&:where(.ag-row-group){align-items:flex-start}:where(.ag-full-width-row) &:where(.ag-row-group){align-items:center;height:100%}}:where(.ag-ltr) .ag-cell-wrapper{padding-left:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-rtl) .ag-cell-wrapper{padding-right:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-cell-wrap-text:not(.ag-cell-auto-height)) .ag-cell-wrapper{align-items:normal;height:100%;:where(.ag-cell-value){height:100%}}:where(.ag-ltr) .ag-row>.ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}:where(.ag-rtl) .ag-row>.ag-cell-wrapper.ag-row-group{padding-right:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-cell-focus:not(.ag-cell-range-selected):focus-within,.ag-cell-range-single-cell,.ag-cell-range-single-cell.ag-cell-range-handle,.ag-context-menu-open .ag-cell-focus:not(.ag-cell-range-selected),.ag-context-menu-open .ag-full-width-row.ag-row-focus .ag-cell-wrapper.ag-row-group,.ag-full-width-row.ag-row-focus:focus .ag-cell-wrapper.ag-row-group{border:1px solid;border-color:var(--ag-range-selection-border-color);border-style:var(--ag-range-selection-border-style);outline:initial}.ag-full-width-row.ag-row-focus:focus{box-shadow:none}:where(.ag-ltr) .ag-group-contracted,:where(.ag-ltr) .ag-group-expanded,:where(.ag-ltr) .ag-row-drag,:where(.ag-ltr) .ag-selection-checkbox{margin-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-group-contracted,:where(.ag-rtl) .ag-group-expanded,:where(.ag-rtl) .ag-row-drag,:where(.ag-rtl) .ag-selection-checkbox{margin-left:var(--ag-cell-widget-spacing)}:where(.ag-ltr) .ag-group-child-count{margin-left:3px}:where(.ag-rtl) .ag-group-child-count{margin-right:3px}.ag-row-highlight-above:after,.ag-row-highlight-below:after,.ag-row-highlight-inside:after{background-color:var(--ag-range-selection-border-color);content:"";height:1px;pointer-events:none;position:absolute;width:calc(100% - 1px)}:where(.ag-ltr) .ag-row-highlight-above:after,:where(.ag-ltr) .ag-row-highlight-below:after,:where(.ag-ltr) .ag-row-highlight-inside:after{left:1px}:where(.ag-rtl) .ag-row-highlight-above:after,:where(.ag-rtl) .ag-row-highlight-below:after,:where(.ag-rtl) .ag-row-highlight-inside:after{right:1px}.ag-row-highlight-above:after{top:0}.ag-row-highlight-below:after{bottom:0}.ag-row-highlight-indent:after{display:block;width:auto}:where(.ag-ltr) .ag-row-highlight-indent:after{left:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size));right:1px}:where(.ag-rtl) .ag-row-highlight-indent:after{left:1px;right:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size))}.ag-row-highlight-inside:after{background-color:var(--ag-selected-row-background-color);border:1px solid var(--ag-range-selection-border-color);display:block;height:auto;inset:0;width:auto}.ag-body,.ag-floating-bottom,.ag-floating-top{background-color:var(--ag-data-background-color)}.ag-row-odd{background-color:var(--ag-odd-row-background-color)}.ag-row-selected:before{background-color:var(--ag-selected-row-background-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-full-width-row.ag-row-group:before,.ag-row-hover:not(.ag-full-width-row):before{background-color:var(--ag-row-hover-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-row-selected:before{background-color:var(--ag-row-hover-color);background-image:linear-gradient(var(--ag-selected-row-background-color),var(--ag-selected-row-background-color))}.ag-row.ag-full-width-row.ag-row-group>*{position:relative}.ag-column-hover{background-color:var(--ag-column-hover-color)}.ag-header-range-highlight{background-color:var(--ag-range-header-highlight-color)}.ag-right-aligned-cell{font-variant-numeric:tabular-nums}:where(.ag-ltr) .ag-right-aligned-cell{text-align:right}:where(.ag-rtl) .ag-right-aligned-cell{text-align:left}.ag-right-aligned-cell .ag-cell-value,.ag-right-aligned-cell .ag-group-value{margin-left:auto}:where(.ag-ltr) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-ltr) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level));padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}:where(.ag-rtl) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-rtl) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-row>.ag-cell-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}.ag-row-dragging{cursor:move;opacity:.5}.ag-details-row{background-color:var(--ag-data-background-color);padding:calc(var(--ag-spacing)*3.75)}.ag-layout-auto-height,.ag-layout-print{.ag-center-cols-container,.ag-center-cols-viewport{min-height:150px}}.ag-overlay-loading-wrapper{background-color:var(--ag-modal-overlay-background-color)}.ag-skeleton-container{align-content:center;height:100%;width:100%}.ag-skeleton-effect{animation:ag-skeleton-loading 1.5s ease-in-out .5s infinite;background-color:var(--ag-row-loading-skeleton-effect-color);border-radius:.25rem;height:1em;width:100%}:where(.ag-ltr) .ag-right-aligned-cell .ag-skeleton-effect{margin-left:auto}:where(.ag-rtl) .ag-right-aligned-cell .ag-skeleton-effect{margin-right:auto}@keyframes ag-skeleton-loading{0%{background-color:var(--ag-row-loading-skeleton-effect-color)}50%{background-color:color-mix(in srgb,transparent,var(--ag-row-loading-skeleton-effect-color) 40%)}to{background-color:var(--ag-row-loading-skeleton-effect-color)}}.ag-loading{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-loading{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-loading{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-ltr) .ag-loading-icon{padding-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-loading-icon{padding-left:var(--ag-cell-widget-spacing)}.ag-icon-loading{animation-duration:1s;animation-iteration-count:infinite;animation-name:spin;animation-timing-function:linear}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.ag-header{background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border);color:var(--ag-header-text-color);display:flex;font-family:var(--ag-header-font-family);font-size:var(--ag-header-font-size);font-weight:var(--ag-header-font-weight);overflow:hidden;white-space:nowrap;width:100%}.ag-header-row{height:var(--ag-header-height);position:absolute}.ag-floating-filter-button-button,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,:where(.ag-header-cell-sortable) .ag-header-cell-label{cursor:pointer}:where(.ag-ltr) .ag-header-expand-icon{margin-left:4px}:where(.ag-rtl) .ag-header-expand-icon{margin-right:4px}.ag-header-row:where(:not(:first-child)){:where(.ag-header-cell:not(.ag-header-span-height.ag-header-span-total,.ag-header-parent-hidden),.ag-header-group-cell.ag-header-group-cell-with-group){border-top:var(--ag-header-row-border)}}.ag-header-row:where(:not(.ag-header-row-column-group)){overflow:hidden}:where(.ag-header.ag-header-allow-overflow) .ag-header-row{overflow:visible}.ag-header-cell{display:inline-flex;overflow:hidden}.ag-header-group-cell{contain:paint;display:flex}.ag-header-cell,.ag-header-group-cell{align-items:center;gap:var(--ag-cell-widget-spacing);height:100%;padding:0 var(--ag-cell-horizontal-padding);position:absolute}@property --ag-internal-moving-color{syntax:"<color>";inherits:false;initial-value:transparent}@property --ag-internal-hover-color{syntax:"<color>";inherits:false;initial-value:transparent}.ag-header-cell:where(:not(.ag-floating-filter)),.ag-header-group-cell{&:before{background-image:linear-gradient(var(--ag-internal-hover-color),var(--ag-internal-hover-color)),linear-gradient(var(--ag-internal-moving-color),var(--ag-internal-moving-color));content:"";inset:0;position:absolute;--ag-internal-moving-color:transparent;--ag-internal-hover-color:transparent;transition:--ag-internal-moving-color var(--ag-header-cell-background-transition-duration),--ag-internal-hover-color var(--ag-header-cell-background-transition-duration)}&:where(:hover):before{--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}&:where(.ag-header-cell-moving):before{--ag-internal-moving-color:var(--ag-header-cell-moving-background-color);--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}}:where(.ag-header-cell:not(.ag-floating-filter) *,.ag-header-group-cell *){position:relative;z-index:1}.ag-header-cell-menu-button:where(:not(.ag-header-menu-always-show)){opacity:0;transition:opacity .2s}.ag-header-cell-filter-button,:where(.ag-header-cell.ag-header-active) .ag-header-cell-menu-button{opacity:1}.ag-header-cell-label,.ag-header-group-cell-label{align-items:center;align-self:stretch;display:flex;flex:1 1 auto;overflow:hidden;padding:5px 0}:where(.ag-ltr) .ag-sort-indicator-icon{padding-left:var(--ag-spacing)}:where(.ag-rtl) .ag-sort-indicator-icon{padding-right:var(--ag-spacing)}.ag-header-cell-label{text-overflow:ellipsis}.ag-header-group-cell-label.ag-sticky-label{flex:none;max-width:100%;overflow:visible;position:sticky}:where(.ag-ltr) .ag-header-group-cell-label.ag-sticky-label{left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-header-group-cell-label.ag-sticky-label{right:var(--ag-cell-horizontal-padding)}.ag-header-cell-text,.ag-header-group-text{overflow:hidden;text-overflow:ellipsis}.ag-header-cell-text{word-break:break-word}.ag-header-cell-comp-wrapper{width:100%}:where(.ag-header-group-cell) .ag-header-cell-comp-wrapper{display:flex}:where(.ag-header-cell:not(.ag-header-cell-auto-height)) .ag-header-cell-comp-wrapper{align-items:center;display:flex;height:100%}.ag-header-cell-wrap-text .ag-header-cell-comp-wrapper{white-space:normal}.ag-header-cell-comp-wrapper-limited-height>*{overflow:hidden}:where(.ag-right-aligned-header) .ag-header-cell-label{flex-direction:row-reverse}:where(.ag-ltr) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-ltr) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}.ag-header-cell:after,.ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{content:"";height:var(--ag-header-column-border-height);position:absolute;top:calc(50% - var(--ag-header-column-border-height)*.5);z-index:1}:where(.ag-ltr) .ag-header-cell:after,:where(.ag-ltr) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-right:var(--ag-header-column-border);right:0}:where(.ag-rtl) .ag-header-cell:after,:where(.ag-rtl) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-left:var(--ag-header-column-border);left:0}.ag-header-highlight-after:after,.ag-header-highlight-before:after{background-color:var(--ag-accent-color);content:"";height:100%;position:absolute;width:1px}:where(.ag-ltr) .ag-header-highlight-before:after{left:0}:where(.ag-rtl) .ag-header-highlight-before:after{right:0}:where(.ag-ltr) .ag-header-highlight-after:after{right:0;:where(.ag-pinned-left-header) &{right:1px}}:where(.ag-rtl) .ag-header-highlight-after:after{left:0;:where(.ag-pinned-left-header) &{left:1px}}.ag-header-cell-resize{align-items:center;cursor:ew-resize;display:flex;height:100%;position:absolute;top:0;width:8px;z-index:2;&:after{background-color:var(--ag-header-column-resize-handle-color);content:"";height:var(--ag-header-column-resize-handle-height);position:absolute;top:calc(50% - var(--ag-header-column-resize-handle-height)*.5);width:var(--ag-header-column-resize-handle-width);z-index:1}}:where(.ag-ltr) .ag-header-cell-resize{right:-3px;&:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-rtl) .ag-header-cell-resize{left:-3px;&:after{right:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-header-cell.ag-header-span-height) .ag-header-cell-resize:after{height:calc(100% - var(--ag-spacing)*4);top:calc(var(--ag-spacing)*2)}.ag-header-group-cell-no-group:where(.ag-header-span-height){display:none}.ag-sort-indicator-container{display:flex;gap:var(--ag-spacing)}.ag-layout-print{&.ag-body{display:block;height:unset}&.ag-root-wrapper{display:inline-block}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:none}&.ag-force-vertical-scroll{overflow-y:visible!important}}@media print{.ag-root-wrapper.ag-layout-print{display:table;.ag-body-horizontal-scroll-viewport,.ag-body-viewport,.ag-center-cols-container,.ag-center-cols-viewport,.ag-root,.ag-root-wrapper-body,.ag-virtual-list-viewport{display:block!important;height:auto!important;overflow:hidden!important}.ag-cell,.ag-row{-moz-column-break-inside:avoid;break-inside:avoid}}}ag-grid,ag-grid-angular{display:block}.ag-root-wrapper{border:var(--ag-wrapper-border);border-radius:var(--ag-wrapper-border-radius);display:flex;flex-direction:column;overflow:hidden;position:relative;&.ag-layout-normal{height:100%}}.ag-root-wrapper-body{display:flex;flex-direction:row;&.ag-layout-normal{flex:1 1 auto;height:0;min-height:0}}.ag-root{display:flex;flex-direction:column;position:relative;&.ag-layout-auto-height,&.ag-layout-normal{flex:1 1 auto;overflow:hidden;width:0}&.ag-layout-normal{height:100%}}.ag-virtual-list-item{height:var(--ag-list-item-height);position:absolute;width:100%}.ag-list-item-hovered:after{background-color:var(--ag-accent-color);content:"";height:1px;left:0;position:absolute;right:0}.ag-item-highlight-top:after{top:0}.ag-item-highlight-bottom:after{bottom:0}.ag-drag-handle{color:var(--ag-drag-handle-color);cursor:grab;:where(.ag-icon){color:var(--ag-drag-handle-color)}}.ag-chart-menu-icon,.ag-chart-settings-next,.ag-chart-settings-prev,.ag-column-group-icons,.ag-column-select-header-icon,.ag-filter-toolpanel-expand,.ag-floating-filter-button-button,.ag-group-title-bar-icon,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,.ag-panel-title-bar-button-icon,.ag-set-filter-group-icons,:where(.ag-group-contracted) .ag-icon,:where(.ag-group-expanded) .ag-icon{background-color:var(--ag-icon-button-background-color);border-radius:var(--ag-icon-button-border-radius);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-background-color);color:var(--ag-icon-button-color);&:hover{background-color:var(--ag-icon-button-hover-background-color);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-hover-background-color);color:var(--ag-icon-button-hover-color)}}.ag-filter-active{background-image:linear-gradient(var(--ag-icon-button-active-background-color),var(--ag-icon-button-active-background-color));border-radius:1px;outline:solid var(--ag-icon-button-background-spread) var(--ag-icon-button-active-background-color);position:relative;&:after{background-color:var(--ag-icon-button-active-indicator-color);border-radius:50%;content:"";height:6px;position:absolute;top:-1px;width:6px}:where(.ag-icon-filter){clip-path:path("M8,0C8,4.415 11.585,8 16,8L16,16L0,16L0,0L8,0Z");color:var(--ag-icon-button-active-color)}}:where(.ag-ltr) .ag-filter-active{&:after{right:-1px}}:where(.ag-rtl) .ag-filter-active{&:after{left:-1px}}.ag-menu{background-color:var(--ag-menu-background-color);border:var(--ag-menu-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-menu-shadow);color:var(--ag-menu-text-color);max-height:100%;overflow-y:auto;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}',yK={wrapperBorder:!0,rowBorder:!0,headerRowBorder:!0,footerRowBorder:{ref:"rowBorder"},columnBorder:{style:"solid",width:1,color:"transparent"},headerColumnBorder:!1,headerColumnBorderHeight:"100%",pinnedColumnBorder:!0,pinnedRowBorder:!0,sidePanelBorder:!0,sideBarPanelWidth:250,sideBarBackgroundColor:{ref:"chromeBackgroundColor"},sideButtonBarBackgroundColor:{ref:"sideBarBackgroundColor"},sideButtonBarTopPadding:0,sideButtonSelectedUnderlineWidth:2,sideButtonSelectedUnderlineColor:"transparent",sideButtonSelectedUnderlineTransitionDuration:0,sideButtonBackgroundColor:"transparent",sideButtonTextColor:{ref:"textColor"},sideButtonHoverBackgroundColor:{ref:"sideButtonBackgroundColor"},sideButtonHoverTextColor:{ref:"sideButtonTextColor"},sideButtonSelectedBackgroundColor:ii,sideButtonSelectedTextColor:{ref:"sideButtonTextColor"},sideButtonBorder:"solid 1px transparent",sideButtonSelectedBorder:!0,sideButtonLeftPadding:{ref:"spacing"},sideButtonRightPadding:{ref:"spacing"},sideButtonVerticalPadding:{calc:"spacing * 3"},headerBackgroundColor:{ref:"chromeBackgroundColor"},headerFontFamily:{ref:"fontFamily"},cellFontFamily:{ref:"fontFamily"},headerFontWeight:500,headerFontSize:{ref:"fontSize"},dataFontSize:{ref:"fontSize"},headerTextColor:{ref:"textColor"},headerCellHoverBackgroundColor:"transparent",headerCellMovingBackgroundColor:{ref:"headerCellHoverBackgroundColor"},headerCellBackgroundTransitionDuration:"0.2s",cellTextColor:{ref:"textColor"},rangeSelectionBorderStyle:"solid",rangeSelectionBorderColor:Io,rangeSelectionBackgroundColor:Us(.2),rangeSelectionChartBackgroundColor:"#0058FF1A",rangeSelectionChartCategoryBackgroundColor:"#00FF841A",rangeSelectionHighlightColor:Us(.5),rangeHeaderHighlightColor:S9(.08),rowNumbersSelectedColor:Us(.5),rowHoverColor:Us(.08),columnHoverColor:Us(.05),selectedRowBackgroundColor:Us(.12),modalOverlayBackgroundColor:{ref:"backgroundColor",mix:.66},dataBackgroundColor:ii,oddRowBackgroundColor:{ref:"dataBackgroundColor"},wrapperBorderRadius:8,cellHorizontalPadding:{calc:"spacing * 2 * cellHorizontalPaddingScale"},cellWidgetSpacing:{calc:"spacing * 1.5"},cellHorizontalPaddingScale:1,rowGroupIndentSize:{calc:"cellWidgetSpacing + iconSize"},valueChangeDeltaUpColor:"#43a047",valueChangeDeltaDownColor:"#e53935",valueChangeValueHighlightBackgroundColor:"#16a08580",rowHeight:{calc:"max(iconSize, dataFontSize) + spacing * 3.25 * rowVerticalPaddingScale"},rowVerticalPaddingScale:1,headerHeight:{calc:"max(iconSize, dataFontSize) + spacing * 4 * headerVerticalPaddingScale"},headerVerticalPaddingScale:1,paginationPanelHeight:{ref:"rowHeight",calc:"max(rowHeight, 22px)"},dragHandleColor:qi(.7),headerColumnResizeHandleHeight:"30%",headerColumnResizeHandleWidth:2,headerColumnResizeHandleColor:{ref:"borderColor"},widgetContainerHorizontalPadding:{calc:"spacing * 1.5"},widgetContainerVerticalPadding:{calc:"spacing * 1.5"},widgetHorizontalSpacing:{calc:"spacing * 1.5"},widgetVerticalSpacing:{ref:"spacing"},iconButtonColor:{ref:"iconColor"},iconButtonBackgroundColor:"transparent",iconButtonBackgroundSpread:4,iconButtonBorderRadius:1,iconButtonHoverColor:{ref:"iconButtonColor"},iconButtonHoverBackgroundColor:qi(.1),iconButtonActiveColor:Io,iconButtonActiveBackgroundColor:Us(.28),iconButtonActiveIndicatorColor:Io,menuBorder:{color:qi(.2)},menuBackgroundColor:es(.03),menuTextColor:es(.95),menuShadow:{ref:"popupShadow"},menuSeparatorColor:{ref:"borderColor"},setFilterIndentSize:{ref:"iconSize"},chartMenuPanelWidth:260,chartMenuLabelColor:qi(.8),dialogShadow:{ref:"popupShadow"},cellEditingBorder:{color:Io},cellEditingShadow:{ref:"cardShadow"},fullRowEditInvalidBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.25},dialogBorder:{color:qi(.2)},panelBackgroundColor:ii,panelTitleBarHeight:{ref:"headerHeight"},panelTitleBarBackgroundColor:{ref:"headerBackgroundColor"},panelTitleBarIconColor:{ref:"headerTextColor"},panelTitleBarTextColor:{ref:"headerTextColor"},panelTitleBarFontWeight:{ref:"headerFontWeight"},panelTitleBarBorder:!0,columnSelectIndentSize:{ref:"iconSize"},toolPanelSeparatorBorder:!0,columnDropCellBackgroundColor:qi(.07),columnDropCellTextColor:{ref:"textColor"},columnDropCellDragHandleColor:{ref:"textColor"},columnDropCellBorder:{color:qi(.13)},selectCellBackgroundColor:qi(.07),selectCellBorder:{color:qi(.13)},advancedFilterBuilderButtonBarBorder:!0,advancedFilterBuilderIndentSize:{calc:"spacing * 2 + iconSize"},advancedFilterBuilderJoinPillColor:"#f08e8d",advancedFilterBuilderColumnPillColor:"#a6e194",advancedFilterBuilderOptionPillColor:"#f3c08b",advancedFilterBuilderValuePillColor:"#85c0e4",filterPanelApplyButtonColor:ii,filterPanelApplyButtonBackgroundColor:Io,filterPanelCardSubtleColor:{ref:"textColor",mix:.7},filterPanelCardSubtleHoverColor:{ref:"textColor"},findMatchColor:Su,findMatchBackgroundColor:"#ffff00",findActiveMatchColor:Su,findActiveMatchBackgroundColor:"#ffa500",filterToolPanelGroupIndent:{ref:"spacing"},rowLoadingSkeletonEffectColor:qi(.15),statusBarLabelColor:Su,statusBarLabelFontWeight:500,statusBarValueColor:Su,statusBarValueFontWeight:500,pinnedSourceRowTextColor:{ref:"textColor"},pinnedSourceRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedSourceRowFontWeight:600,pinnedRowFontWeight:600,pinnedRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedRowTextColor:{ref:"textColor"}},bK=".ag-cell-batch-edit{background-color:var(--ag-cell-batch-edit-background-color);color:var(--ag-cell-batch-edit-text-color);display:inherit}.ag-row-batch-edit{background-color:var(--ag-row-batch-edit-background-color);color:var(--ag-row-batch-edit-text-color)}",TL={cellBatchEditBackgroundColor:"rgba(220 181 139 / 16%)",cellBatchEditTextColor:"#422f00",rowBatchEditBackgroundColor:{ref:"cellBatchEditBackgroundColor"},rowBatchEditTextColor:{ref:"cellBatchEditTextColor"}},SK={...TL,cellBatchEditTextColor:"#f3d0b3"},xK=()=>no({feature:"batchEditStyle",params:TL,css:bK}),EK=xK(),RK=":where(.ag-button){background:none;border:none;color:inherit;cursor:pointer;font-family:inherit;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0;text-indent:inherit;text-shadow:inherit;text-transform:inherit;word-spacing:inherit;&:disabled{cursor:default}&:focus-visible{box-shadow:var(--ag-focus-shadow);outline:none}}.ag-standard-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--ag-button-background-color);border:var(--ag-button-border);border-radius:var(--ag-button-border-radius);color:var(--ag-button-text-color);cursor:pointer;font-weight:var(--ag-button-font-weight);padding:var(--ag-button-vertical-padding) var(--ag-button-horizontal-padding);&:hover{background-color:var(--ag-button-hover-background-color);border:var(--ag-button-hover-border);color:var(--ag-button-hover-text-color)}&:active{background-color:var(--ag-button-active-background-color);border:var(--ag-button-active-border);color:var(--ag-button-active-text-color)}&:disabled{background-color:var(--ag-button-disabled-background-color);border:var(--ag-button-disabled-border);color:var(--ag-button-disabled-text-color)}}",TK={buttonTextColor:"inherit",buttonFontWeight:"normal",buttonBackgroundColor:"transparent",buttonBorder:!1,buttonBorderRadius:{ref:"borderRadius"},buttonHorizontalPadding:{calc:"spacing * 2"},buttonVerticalPadding:{ref:"spacing"},buttonHoverTextColor:{ref:"buttonTextColor"},buttonHoverBackgroundColor:{ref:"buttonBackgroundColor"},buttonHoverBorder:{ref:"buttonBorder"},buttonActiveTextColor:{ref:"buttonHoverTextColor"},buttonActiveBackgroundColor:{ref:"buttonHoverBackgroundColor"},buttonActiveBorder:{ref:"buttonHoverBorder"},buttonDisabledTextColor:{ref:"inputDisabledTextColor"},buttonDisabledBackgroundColor:{ref:"inputDisabledBackgroundColor"},buttonDisabledBorder:{ref:"inputDisabledBorder"}},FK=()=>no({feature:"buttonStyle",params:{...TK,buttonBackgroundColor:ii,buttonBorder:!0,buttonHoverBackgroundColor:{ref:"rowHoverColor"},buttonActiveBorder:{color:Io}},css:RK}),DK=FK(),AK=".ag-column-drop-vertical-empty-message{align-items:center;border:dashed var(--ag-border-width);border-color:var(--ag-border-color);display:flex;inset:0;justify-content:center;margin:calc(var(--ag-spacing)*1.5) calc(var(--ag-spacing)*2);overflow:hidden;padding:calc(var(--ag-spacing)*2);position:absolute}",kK=()=>no({feature:"columnDropStyle",css:AK}),FL=kK(),PK={warn:(...e)=>{Me(e[0],e[1])},error:(...e)=>{Zt(e[0],e[1])},preInitErr:(...e)=>{Dh(e[0],e[2],e[1])}},MK=()=>_9(PK).withParams(yK).withPart(DK).withPart(FL).withPart(EK),_K='.ag-checkbox-input-wrapper,.ag-radio-button-input-wrapper{background-color:var(--ag-checkbox-unchecked-background-color);border:solid var(--ag-checkbox-border-width) var(--ag-checkbox-unchecked-border-color);flex:none;height:var(--ag-icon-size);position:relative;width:var(--ag-icon-size);:where(input){-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:block;height:var(--ag-icon-size);margin:0;opacity:0;width:var(--ag-icon-size)}&:after{content:"";display:block;inset:0;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;pointer-events:none;position:absolute}&:where(.ag-checked){background-color:var(--ag-checkbox-checked-background-color);border-color:var(--ag-checkbox-checked-border-color);&:after{background-color:var(--ag-checkbox-checked-shape-color)}}&:where(:focus-within,:active){box-shadow:var(--ag-focus-shadow)}&:where(.ag-disabled){filter:grayscale();opacity:.5}}.ag-checkbox-input-wrapper{border-radius:var(--ag-checkbox-border-radius);&:where(.ag-checked):after{-webkit-mask-image:var(--ag-checkbox-checked-shape-image);mask-image:var(--ag-checkbox-checked-shape-image)}&:where(.ag-indeterminate){background-color:var(--ag-checkbox-indeterminate-background-color);border-color:var(--ag-checkbox-indeterminate-border-color);&:after{background-color:var(--ag-checkbox-indeterminate-shape-color);-webkit-mask-image:var(--ag-checkbox-indeterminate-shape-image);mask-image:var(--ag-checkbox-indeterminate-shape-image)}}}.ag-cell-editing-error .ag-checkbox-input-wrapper:focus-within{box-shadow:var(--ag-focus-error-shadow)}.ag-radio-button-input-wrapper{border-radius:100%;&:where(.ag-checked):after{-webkit-mask-image:var(--ag-radio-checked-shape-image);mask-image:var(--ag-radio-checked-shape-image)}}',LK=()=>no({feature:"checkboxStyle",params:{checkboxBorderWidth:1,checkboxBorderRadius:{ref:"borderRadius"},checkboxUncheckedBackgroundColor:ii,checkboxUncheckedBorderColor:es(.3),checkboxCheckedBackgroundColor:Io,checkboxCheckedBorderColor:{ref:"checkboxCheckedBackgroundColor"},checkboxCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="7" fill="none"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M1 3.5 3.5 6l5-5"/></svg>'},checkboxCheckedShapeColor:ii,checkboxIndeterminateBackgroundColor:es(.3),checkboxIndeterminateBorderColor:{ref:"checkboxIndeterminateBackgroundColor"},checkboxIndeterminateShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="2" fill="none"><rect width="10" height="2" fill="#000" rx="1"/></svg>'},checkboxIndeterminateShapeColor:ii,radioCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" fill="none"><circle cx="3" cy="3" r="3" fill="#000"/></svg>'}},css:_K}),IK=LK(),DL=()=>({...H0,...SK,backgroundColor:"hsl(217, 0%, 17%)",foregroundColor:"#FFF",chromeBackgroundColor:es(.05),rowHoverColor:Us(.15),selectedRowBackgroundColor:Us(.2),menuBackgroundColor:es(.1),browserColorScheme:"dark",popupShadow:"0 0px 20px #000A",cardShadow:"0 1px 4px 1px #000A",advancedFilterBuilderJoinPillColor:"#7a3a37",advancedFilterBuilderColumnPillColor:"#355f2d",advancedFilterBuilderOptionPillColor:"#5a3168",advancedFilterBuilderValuePillColor:"#374c86",filterPanelApplyButtonColor:Su,findMatchColor:ii,findActiveMatchColor:ii,checkboxUncheckedBorderColor:es(.4),toggleButtonOffBackgroundColor:es(.4),rowBatchEditBackgroundColor:es(.1)}),OK=()=>({...DL(),backgroundColor:"#1f2836"}),NK=()=>no({feature:"colorScheme",params:H0,modeParams:{light:H0,dark:DL(),"dark-blue":OK()}}),BK=NK(),AL={aggregation:'<path d="M18 7V4H6l6 8-6 8h12v-3"/>',arrows:'<polyline points="5 9 2 12 5 15"/><polyline points="9 5 12 2 15 5"/><polyline points="15 19 12 22 9 19"/><polyline points="19 9 22 12 19 15"/><line x1="2" x2="22" y1="12" y2="12"/><line x1="12" x2="12" y1="2" y2="22"/>',asc:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',cancel:'<path d="m18 6-12 12"/><path d="m6 6 12 12"/>',chart:'<line x1="18" x2="18" y1="20" y2="10"/><line x1="12" x2="12" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="14"/>',"color-picker":'<path d="m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z"/><path d="m5 2 5 5"/><path d="M2 13h15"/><path d="M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z"/>',columns:'<path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"/>',contracted:'<path d="m9 18 6-6-6-6"/>',copy:'<rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>',cross:'<path d="M18 6 6 18"/><path d="m6 6 12 12"/>',csv:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',cut:'<circle cx="6" cy="6" r="3"/><path d="M8.12 8.12 12 12"/><path d="M20 4 8.12 15.88"/><circle cx="6" cy="18" r="3"/><path d="M14.8 14.8 20 20"/>',desc:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',down:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',excel:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',expanded:'<path d="m15 18-6-6 6-6"/>',"eye-slash":'<path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/>',eye:'<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/>',filter:'<path d="M3 6h18"/><path d="M7 12h10"/><path d="M10 18h4"/>',first:'<path d="m17 18-6-6 6-6"/><path d="M7 6v12"/>',group:'<path d="M16 12H3"/><path d="M16 18H3"/><path d="M10 6H3"/><path d="M21 18V8a2 2 0 0 0-2-2h-5"/><path d="m16 8-2-2 2-2"/>',last:'<path d="m7 18 6-6-6-6"/><path d="M17 6v12"/>',left:'<path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>',linked:'<path d="M9 17H7A5 5 0 0 1 7 7h2"/><path d="M15 7h2a5 5 0 1 1 0 10h-2"/><line x1="8" x2="16" y1="12" y2="12"/>',loading:'<line x1="12" x2="12" y1="2" y2="6"/><line x1="12" x2="12" y1="18" y2="22"/><line x1="4.93" x2="7.76" y1="4.93" y2="7.76"/><line x1="16.24" x2="19.07" y1="16.24" y2="19.07"/><line x1="2" x2="6" y1="12" y2="12"/><line x1="18" x2="22" y1="12" y2="12"/><line x1="4.93" x2="7.76" y1="19.07" y2="16.24"/><line x1="16.24" x2="19.07" y1="7.76" y2="4.93"/>',maximize:'<polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/>',menu:'<line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/>',"menu-alt":'<circle cx="12" cy="5" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="12" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="19" r="0.75" fill="#D9D9D9"/>',minimize:'<polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" x2="21" y1="10" y2="3"/><line x1="3" x2="10" y1="21" y2="14"/>',minus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/>',next:'<path d="m9 18 6-6-6-6"/>',none:'<path d="m7 15 5 5 5-5"/><path d="m7 9 5-5 5 5"/>',"not-allowed":'<circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/>',paste:'<path d="M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z"/><path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10"/><path d="m17 10 4 4-4 4"/>',pin:'<line x1="12" x2="12" y1="17" y2="22"/><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"/>',pivot:'<path d="M15 3v18"/><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M21 9H3"/><path d="M21 15H3"/>',plus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/>',previous:'<path d="m15 18-6-6 6-6"/>',right:'<path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>',save:'<path d="M12 17V3"/><path d="m6 11 6 6 6-6"/><path d="M19 21H5"/>',"small-left":'<path d="m15 18-6-6 6-6"/>',"small-right":'<path d="m9 18 6-6-6-6"/>',tick:'<path d="M20 6 9 17l-5-5"/>',"tree-closed":'<path d="m9 18 6-6-6-6"/>',"tree-indeterminate":'<path d="M5 12h14"/>',"tree-open":'<path d="m6 9 6 6 6-6"/>',unlinked:'<path d="M9 17H7A5 5 0 0 1 7 7"/><path d="M15 7h2a5 5 0 0 1 4 8"/><line x1="8" x2="12" y1="12" y2="12"/><line x1="2" x2="22" y1="2" y2="22"/>',up:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',grip:'<circle cx="5" cy="8" r="0.5"/><circle cx="12" cy="8" r="0.5"/><circle cx="19" cy="8" r="0.5"/><circle cx="5" cy="16" r="0.5"/><circle cx="12" cy="16" r="0.5"/><circle cx="19" cy="16" r="0.5"/><g stroke="none" fill="currentColor"><circle cx="5" cy="8" r="1"/><circle cx="12" cy="8" r="1"/><circle cx="19" cy="8" r="1"/><circle cx="5" cy="16" r="1"/><circle cx="12" cy="16" r="1"/><circle cx="19" cy="16" r="1"/></g>',settings:'<path d="M20 7h-9"/><path d="M14 17H5"/><circle cx="17" cy="17" r="3"/><circle cx="7" cy="7" r="3"/>'},kL={"column-arrow":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 32 32"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 26C0 28.2092 1.79086 30 4 30H14C16.2091 30 18 28.2092 18 26V15H25.8786L24.4394 16.4393C23.8536 17.0251 23.8536 17.9749 24.4394 18.5607C25.0252 19.1464 25.9748 19.1464 26.5606 18.5607L30.5606 14.5607C31.1464 13.9749 31.1464 13.0251 30.5606 12.4393L26.5606 8.43934C25.9748 7.85356 25.0252 7.85356 24.4394 8.43934C23.8536 9.02512 23.8536 9.97488 24.4394 10.5607L25.8786 12H18V6C18 3.79086 16.2091 2 14 2H4C1.79086 2 0 3.79086 0 6V26ZM14 5H10.5V12H15V6C15 5.44772 14.5523 5 14 5ZM4 5H7.5V12H3V6C3 5.44772 3.44772 5 4 5ZM10.5 15H15V26C15 26.5522 14.5523 27 14 27H10.5V15ZM4 27H7.5V15H3V26C3 26.5522 3.44772 27 4 27Z" fill="currentColor"/></svg>',"small-down":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 10.667 16 21.334l8.667-10.667H7.334Z"/></svg>',"small-up":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 21.333 16 10.666l8.667 10.667H7.334Z"/></svg>',"pinned-top":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.53 3.72A.75.75 0 0 1 12 5H4a.75.75 0 0 1 0-1.5h8a.75.75 0 0 1 .53.22ZM3.269 10.744a.75.75 0 0 1 .2-.524l4-4a.75.75 0 0 1 1.06 0l4 4a.75.75 0 1 1-1.06 1.06L8.75 8.56V14a.75.75 0 0 1-1.5 0V8.56l-2.72 2.72a.75.75 0 0 1-1.26-.536Z"/></svg>',"pinned-bottom":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M3.47 12.28A.75.75 0 0 1 4 11h8a.75.75 0 0 1 0 1.5H4a.75.75 0 0 1-.53-.22ZM12.731 5.256a.75.75 0 0 1-.2.524l-4 4a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 1 1 1.06-1.06l2.72 2.72V2a.75.75 0 0 1 1.5 0v5.44l2.72-2.72a.75.75 0 0 1 1.26.536Z"/></svg>',"un-pin":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M8 11a.75.75 0 0 0-.75.75v3.333a.75.75 0 1 0 1.5 0V11.75A.75.75 0 0 0 8 11Z"/><path fill="currentColor" d="M13.11 1.436a.75.75 0 0 0-1.22-.872l-10 14a.75.75 0 1 0 1.22.872L5.207 12.5h7.376a.75.75 0 0 0 .75-.75v-1.174a2.08 2.08 0 0 0-1.153-1.863l-1.185-.599-.005-.002a.58.58 0 0 1-.323-.522V5.165a2.083 2.083 0 0 0 1.854-2.904l.589-.825Zm-3.943 5.52v.634a2.08 2.08 0 0 0 1.153 1.863l1.185.6.005.002a.58.58 0 0 1 .323.522V11H6.28l2.887-4.044ZM9.277 1H5.25a2.084 2.084 0 0 0-.083 4.165v1.676l1.5-2.132v-.292a.75.75 0 0 0-.75-.75H5.25a.584.584 0 0 1 0-1.167h2.972L9.277 1Z"/></svg>',"chevron-down":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 6L8 10L4 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-up":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 10L8 6L12 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-left":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-right":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"filter-add":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.12126 7.75L10.8517 7.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M6.65934 11.748L9.32778 11.748" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M12.2943 1.04872V6.19184M14.9886 3.74341H9.68478" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M8.25488 3C8.04799 3.18323 7.91706 3.45099 7.91699 3.74902C7.91713 4.04868 8.04988 4.31681 8.25879 4.5H2C1.58579 4.5 1.25 4.16421 1.25 3.75C1.25 3.33579 1.58579 3 2 3H8.25488Z" fill="currentColor"/></svg>',edit:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 10.6262V12.5012H5.375L10.905 6.97122L9.03 5.09622L3.5 10.6262ZM12.355 5.52122C12.4014 5.47497 12.4381 5.42002 12.4632 5.35953C12.4883 5.29905 12.5012 5.23421 12.5012 5.16872C12.5012 5.10324 12.4883 5.0384 12.4632 4.97791C12.4381 4.91742 12.4014 4.86248 12.355 4.81622L11.185 3.64622C11.1387 3.59987 11.0838 3.5631 11.0233 3.53801C10.9628 3.51291 10.898 3.5 10.8325 3.5C10.767 3.5 10.7022 3.51291 10.6417 3.53801C10.5812 3.5631 10.5263 3.59987 10.48 3.64622L9.565 4.56122L11.44 6.43622L12.355 5.52122Z" fill="currentColor"/></svg>'},HK=(e={})=>{let t="";for(const r of[...Object.keys(AL),...Object.keys(kL)]){const n=GK(r,e.strokeWidth);t+=`.ag-icon-${r}::before { mask-image: url('data:image/svg+xml,${encodeURIComponent(n)}'); }
`}return t},GK=(e,t=1.5)=>{const r=kL[e];if(r)return r;const n=AL[e];if(!n)throw new Error(`Missing icon data for ${e}`);return`<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="black" stroke-width="${t}" viewBox="0 0 24 24"><style>* { vector-effect: non-scaling-stroke; }</style>`+n+"</svg>"},VK=(e={})=>no({feature:"iconSet",css:()=>HK(e)}),zK=VK(),WK=':where(.ag-input-field-input[type=number]:not(.ag-number-field-input-stepper)){-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield;&::-webkit-inner-spin-button,&::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}}.ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){background-color:var(--ag-input-background-color);border:var(--ag-input-border);border-radius:var(--ag-input-border-radius);color:var(--ag-input-text-color);font-family:inherit;font-size:inherit;line-height:inherit;margin:0;min-height:var(--ag-input-height);padding:0;&:where(:disabled){background-color:var(--ag-input-disabled-background-color);border:var(--ag-input-disabled-border);color:var(--ag-input-disabled-text-color)}&:where(:focus){background-color:var(--ag-input-focus-background-color);border:var(--ag-input-focus-border);box-shadow:var(--ag-input-focus-shadow);color:var(--ag-input-focus-text-color);outline:none}&:where(:invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&::-moz-placeholder{color:var(--ag-input-placeholder-text-color)}&::placeholder{color:var(--ag-input-placeholder-text-color)}}:where(.ag-ltr) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-left:var(--ag-input-padding-start)}:where(.ag-rtl) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-right:var(--ag-input-padding-start)}:where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{background-color:currentcolor;color:var(--ag-input-icon-color);content:"";display:block;height:12px;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;opacity:.5;position:absolute;width:12px}}:where(.ag-ltr) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{margin-left:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-left:calc(var(--ag-spacing)*1.5 + 12px)}}:where(.ag-rtl) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{margin-right:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-right:calc(var(--ag-spacing)*1.5 + 12px)}}',UK=".ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){&:focus{box-shadow:var(--ag-focus-shadow);&:where(.invalid),&:where(:invalid){box-shadow:var(--ag-focus-error-shadow)}}}",$K={inputBackgroundColor:"transparent",inputBorder:!1,inputBorderRadius:0,inputTextColor:{ref:"textColor"},inputPlaceholderTextColor:{ref:"inputTextColor",mix:.5},inputPaddingStart:0,inputHeight:{calc:"max(iconSize, fontSize) + spacing * 2"},inputFocusBackgroundColor:{ref:"inputBackgroundColor"},inputFocusBorder:{ref:"inputBorder"},inputFocusShadow:"none",inputFocusTextColor:{ref:"inputTextColor"},inputDisabledBackgroundColor:{ref:"inputBackgroundColor"},inputDisabledBorder:{ref:"inputBorder"},inputDisabledTextColor:{ref:"inputTextColor"},inputInvalidBackgroundColor:{ref:"inputBackgroundColor"},inputInvalidBorder:{ref:"inputBorder"},inputInvalidTextColor:{ref:"inputTextColor"},inputIconColor:{ref:"inputTextColor"},pickerButtonBorder:!1,pickerButtonFocusBorder:{ref:"inputFocusBorder"},pickerButtonBackgroundColor:{ref:"backgroundColor"},pickerButtonFocusBackgroundColor:{ref:"backgroundColor"},pickerListBorder:!1,pickerListBackgroundColor:{ref:"backgroundColor"},colorPickerThumbSize:18,colorPickerTrackSize:12,colorPickerThumbBorderWidth:3,colorPickerTrackBorderRadius:12,colorPickerColorBorderRadius:4},jK=()=>no({feature:"inputStyle",params:{...$K,inputBackgroundColor:ii,inputBorder:!0,inputBorderRadius:{ref:"borderRadius"},inputPaddingStart:{ref:"spacing"},inputFocusBorder:{color:Io},inputFocusShadow:{ref:"focusShadow"},inputDisabledBackgroundColor:es(.06),inputDisabledTextColor:{ref:"textColor",mix:.5},inputInvalidBorder:{color:{ref:"invalidColor"}},pickerButtonBorder:!0,pickerListBorder:!0},css:()=>WK+UK}),YK=jK(),KK='.ag-tabs-header{background-color:var(--ag-tab-bar-background-color);border-bottom:var(--ag-tab-bar-border);display:flex;flex:1;gap:var(--ag-tab-spacing);padding:var(--ag-tab-bar-top-padding) var(--ag-tab-bar-horizontal-padding) 0}.ag-tabs-header-wrapper{display:flex}.ag-tabs-close-button-wrapper{align-items:center;border:0;display:flex;padding:var(--ag-spacing)}:where(.ag-ltr) .ag-tabs-close-button-wrapper{border-right:solid var(--ag-border-width) var(--ag-border-color)}:where(.ag-rtl) .ag-tabs-close-button-wrapper{border-left:solid var(--ag-border-width) var(--ag-border-color)}.ag-tabs-close-button{background-color:unset;border:0;cursor:pointer;padding:0}.ag-tab{align-items:center;background-color:var(--ag-tab-background-color);border-left:var(--ag-tab-selected-border-width) solid transparent;border-right:var(--ag-tab-selected-border-width) solid transparent;color:var(--ag-tab-text-color);cursor:pointer;display:flex;flex:1;justify-content:center;padding:var(--ag-tab-top-padding) var(--ag-tab-horizontal-padding) var(--ag-tab-bottom-padding);position:relative;&:hover{background-color:var(--ag-tab-hover-background-color);color:var(--ag-tab-hover-text-color)}&.ag-tab-selected{background-color:var(--ag-tab-selected-background-color);color:var(--ag-tab-selected-text-color)}&:after{background-color:var(--ag-tab-selected-underline-color);bottom:0;content:"";display:block;height:var(--ag-tab-selected-underline-width);left:0;opacity:0;position:absolute;right:0;transition:opacity var(--ag-tab-selected-underline-transition-duration)}&.ag-tab-selected:after{opacity:1}}:where(.ag-ltr) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-left-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-right-color:var(--ag-tab-selected-border-color)}}}:where(.ag-rtl) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-right-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-left-color:var(--ag-tab-selected-border-color)}}}',qK={tabBarBackgroundColor:"transparent",tabBarHorizontalPadding:0,tabBarTopPadding:0,tabBackgroundColor:"transparent",tabTextColor:{ref:"textColor"},tabHorizontalPadding:{ref:"spacing"},tabTopPadding:{ref:"spacing"},tabBottomPadding:{ref:"spacing"},tabSpacing:"0",tabHoverBackgroundColor:{ref:"tabBackgroundColor"},tabHoverTextColor:{ref:"tabTextColor"},tabSelectedBackgroundColor:{ref:"tabBackgroundColor"},tabSelectedTextColor:{ref:"tabTextColor"},tabSelectedBorderWidth:{ref:"borderWidth"},tabSelectedBorderColor:"transparent",tabSelectedUnderlineColor:"transparent",tabSelectedUnderlineWidth:0,tabSelectedUnderlineTransitionDuration:0,tabBarBorder:!1},XK=()=>no({feature:"tabStyle",params:{...qK,tabBarBorder:!0,tabBarBackgroundColor:qi(.05),tabTextColor:{ref:"textColor",mix:.7},tabSelectedTextColor:{ref:"textColor"},tabHoverTextColor:{ref:"textColor"},tabSelectedBorderColor:{ref:"borderColor"},tabSelectedBackgroundColor:ii},css:KK}),QK=XK(),ZK=()=>MK().withPart(IK).withPart(BK).withPart(zK).withPart(QK).withPart(YK).withPart(FL).withParams({fontFamily:[{googleFont:"IBM Plex Sans"},"-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu"]}),JK=ZK(),eq={cssName:"--ag-cell-horizontal-padding",changeKey:"cellHorizontalPaddingChanged",defaultValue:16},tq={cssName:"--ag-indentation-level",changeKey:"indentationLevelChanged",defaultValue:0,noWarn:!0,cacheDefault:!0},rq={cssName:"--ag-row-group-indent-size",changeKey:"rowGroupIndentSizeChanged",defaultValue:0},LD={cssName:"--ag-row-height",changeKey:"rowHeightChanged",defaultValue:42},ID={cssName:"--ag-header-height",changeKey:"headerHeightChanged",defaultValue:48},OD={cssName:"--ag-list-item-height",changeKey:"listItemHeightChanged",defaultValue:24},Fy={cssName:"--ag-row-border",changeKey:"rowBorderWidthChanged",defaultValue:1,border:!0},ND={cssName:"--ag-pinned-row-border",changeKey:"pinnedRowBorderWidthChanged",defaultValue:1,border:!0};function nq(e,t){for(const r of t.sort((n,i)=>n.moduleName.localeCompare(i.moduleName))){const n=r.css;n&&e.set(`module-${r.moduleName}`,n)}}var iq=class extends V9{constructor(){super(...arguments),this.sizeEls=new Map,this.lastKnownValues=new Map,this.sizesMeasured=!1}initVariables(){this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.getSizeEl(LD),this.getSizeEl(ID),this.getSizeEl(OD),this.getSizeEl(Fy),this.getSizeEl(ND),this.refreshRowBorderWidthVariable()}getPinnedRowBorderWidth(){return this.getCSSVariablePixelValue(ND)}getRowBorderWidth(){return this.getCSSVariablePixelValue(Fy)}getDefaultRowHeight(){return this.getCSSVariablePixelValue(LD)}getDefaultHeaderHeight(){return this.getCSSVariablePixelValue(ID)}getDefaultCellHorizontalPadding(){return this.getCSSVariablePixelValue(eq)}getCellPaddingLeft(){const e=this.getDefaultCellHorizontalPadding(),t=this.getCSSVariablePixelValue(tq),r=this.getCSSVariablePixelValue(rq);return e-1+r*t}getCellPadding(){const e=this.getDefaultCellHorizontalPadding()-1;return this.getCellPaddingLeft()+e}getDefaultColumnMinWidth(){return Math.min(36,this.getDefaultRowHeight())}getDefaultListItemHeight(){return this.getCSSVariablePixelValue(OD)}refreshRowHeightVariable(){const{eRootDiv:e}=this,t=e.style.getPropertyValue("--ag-line-height").trim(),r=this.gos.get("rowHeight");if(r==null||isNaN(r)||!isFinite(r))return t!==null&&e.style.setProperty("--ag-line-height",null),-1;const n=`${r}px`;return t!=n?(e.style.setProperty("--ag-line-height",n),r):t!=""?Number.parseFloat(t):-1}getCSSVariablePixelValue(e){const t=this.lastKnownValues.get(e);if(t!=null)return t;const r=this.measureSizeEl(e);return r==="detached"||r==="no-styles"?(e.cacheDefault&&this.lastKnownValues.set(e,e.defaultValue),e.defaultValue):(this.lastKnownValues.set(e,r),r)}measureSizeEl(e){const t=this.getSizeEl(e);if(t.offsetParent==null)return"detached";const r=t.offsetWidth;return r===Dy?"no-styles":(this.sizesMeasured=!0,r)}getMeasurementContainer(){let e=this.eMeasurementContainer;return e||(e=this.eMeasurementContainer=jn({tag:"div",cls:"ag-measurement-container"}),this.eRootDiv.appendChild(e)),e}getSizeEl(e){let t=this.sizeEls.get(e);if(t)return t;const r=this.getMeasurementContainer();t=jn({tag:"div"});const{border:n,noWarn:i}=e;n?(t.className="ag-measurement-element-border",t.style.setProperty("--ag-internal-measurement-border",`var(${e.cssName}, solid ${Dy}px)`)):t.style.width=`var(${e.cssName}, ${Dy}px)`,r.appendChild(t),this.sizeEls.set(e,t);let s=this.measureSizeEl(e);s==="no-styles"&&!i&&Me(9,{variable:e});const o=Zo(this.beans,t,()=>{const a=this.measureSizeEl(e);a==="detached"||a==="no-styles"||(this.lastKnownValues.set(e,a),a!==s&&(s=a,this.fireStylesChangedEvent(e.changeKey)))});return this.addDestroyFunc(()=>o()),t}fireStylesChangedEvent(e){e==="rowBorderWidthChanged"&&this.refreshRowBorderWidthVariable(),this.eventSvc.dispatchEvent({type:"gridStylesChanged",[e]:!0})}refreshRowBorderWidthVariable(){const e=this.getCSSVariablePixelValue(Fy);this.eRootDiv.style.setProperty("--ag-internal-row-border-width",`${e}px`)}postProcessThemeChange(e,t){e&&getComputedStyle(this.getMeasurementContainer()).getPropertyValue("--ag-legacy-styles-loaded")&&Zt(t?106:239)}getAdditionalCss(){const e=new Map;return e.set("core",[CK]),nq(e,Array.from(l7())),e}getDefaultTheme(){return JK}themeError(e){Zt(240,{theme:e})}},Dy=15538,sq=class extends W9{postConstruct(){const{globalListener:e,globalSyncListener:t}=this.beans;e&&this.addGlobalListener(e,!0),t&&this.addGlobalListener(t,!1)}};function PL(e,t,r){const n=e.visibleCols.headerGroupRowCount;if(r>=n)return{column:t,headerRowIndex:r};let i=t.getParent();for(;i&&i.getProvidedColumnGroup().getLevel()>r;)i=i.getParent();const s=t.isSpanHeaderHeight();return!i||s&&i.isPadding()?{column:t,headerRowIndex:n}:{column:i,headerRowIndex:i.getProvidedColumnGroup().getLevel()}}var oq=class extends Ee{constructor(){super(...arguments),this.beanName="headerNavigation",this.currentHeaderRowWithoutSpan=-1}postConstruct(){const e=this.beans;e.ctrlsSvc.whenReady(this,r=>{this.gridBodyCon=r.gridBodyCtrl});const t=un(e);this.addManagedElementListeners(t,{mousedown:()=>{this.currentHeaderRowWithoutSpan=-1}})}getHeaderPositionForColumn(e,t){let r;const{colModel:n,colGroupSvc:i,ctrlsSvc:s}=this.beans;if(typeof e=="string"?(r=n.getCol(e),r||(r=i?.getColumnGroup(e)??null)):r=e,!r)return null;const a=s.getHeaderRowContainerCtrl()?.getAllCtrls(),u=ir(a||[]).type==="filter",d=qs(this.beans)-1;let h=-1,g=r;for(;g;)h++,g=g.getParent();let m=h;return t&&u&&m===d-1&&m++,m===-1?null:{headerRowIndex:m,column:r}}navigateVertically(e,t){const{focusSvc:r,visibleCols:n}=this.beans,{focusedHeader:i}=r;if(!i)return!1;const{headerRowIndex:s}=i,o=i.column,a=qs(this.beans),u=this.getHeaderRowType(s),d=n.headerGroupRowCount;let{headerRowIndex:h,column:g,headerRowIndexWithoutSpan:m}=e==="UP"?aq(u,o,s):lq(o,s,d),v=!1;return h<0&&(h=0,g=o,v=!0),h>=a?(h=-1,this.currentHeaderRowWithoutSpan=-1):m!==void 0&&(this.currentHeaderRowWithoutSpan=m),!v&&!g?!1:r.focusHeaderPosition({headerPosition:{headerRowIndex:h,column:g},allowUserOverride:!0,event:t})}navigateHorizontally(e,t=!1,r){const{focusSvc:n,gos:i}=this.beans,s={...n.focusedHeader};let o,a;this.currentHeaderRowWithoutSpan!==-1?s.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=s.headerRowIndex,e==="LEFT"!==i.get("enableRtl")?(a="Before",o=this.findHeader(s,a)):(a="After",o=this.findHeader(s,a));const u=i.getCallback("tabToNextHeader");if(t&&u){const d=n.focusHeaderPositionFromUserFunc({userFunc:u,headerPosition:o,direction:a});if(d){const{headerRowIndex:h}=n.focusedHeader||{};h!=null&&h!=s.headerRowIndex&&(this.currentHeaderRowWithoutSpan=h)}return d}return o||!t?n.focusHeaderPosition({headerPosition:o,direction:a,fromTab:t,allowUserOverride:!0,event:r}):this.focusNextHeaderRow(s,a,r)}focusNextHeaderRow(e,t,r){const n=this.beans,i=e.headerRowIndex;let s=null,o;const a=qs(n),u=this.beans.visibleCols.allCols;if(t==="Before"){if(i<=0)return!1;s=ir(u),o=i-1,this.currentHeaderRowWithoutSpan-=1}else s=u[0],o=i+1,this.currentHeaderRowWithoutSpan<a?this.currentHeaderRowWithoutSpan+=1:this.currentHeaderRowWithoutSpan=-1;let{column:d,headerRowIndex:h}=PL(this.beans,s,o);return h>=a&&(h=-1),n.focusSvc.focusHeaderPosition({headerPosition:{column:d,headerRowIndex:h},direction:t,fromTab:!0,allowUserOverride:!0,event:r})}scrollToColumn(e,t="After"){if(e.getPinned())return;let r;if(Vr(e)){const n=e.getDisplayedLeafColumns();r=t==="Before"?ir(n):n[0]}else r=e;this.gridBodyCon.scrollFeature.ensureColumnVisible(r)}findHeader(e,t){const{colGroupSvc:r,visibleCols:n}=this.beans;let i=e.column;if(i instanceof ff){const u=i.getDisplayedLeafColumns();i=t==="Before"?u[0]:u[u.length-1]}const s=t==="Before"?n.getColBefore(i):n.getColAfter(i);if(!s)return;const o=n.headerGroupRowCount;if(e.headerRowIndex>=o)return{headerRowIndex:e.headerRowIndex,column:s};const a=r?.getColGroupAtLevel(s,e.headerRowIndex);return a?a.isPadding()&&s.isSpanHeaderHeight()?{headerRowIndex:n.headerGroupRowCount,column:s}:{headerRowIndex:e.headerRowIndex,column:a??s}:{headerRowIndex:s instanceof mc&&s.isSpanHeaderHeight()?n.headerGroupRowCount:e.headerRowIndex,column:s}}getHeaderRowType(e){const t=this.beans.ctrlsSvc.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}};function aq(e,t,r){const n=r-1;if(e!=="filter"){const i=t instanceof mc&&t.isSpanHeaderHeight();let s=t.getParent();for(;s&&(s.getProvidedColumnGroup().getLevel()>n||i&&s.isPadding());)s=s.getParent();if(s)return i?{column:s,headerRowIndex:s.getProvidedColumnGroup().getLevel(),headerRowIndexWithoutSpan:n}:{column:s,headerRowIndex:n,headerRowIndexWithoutSpan:n}}return{column:t,headerRowIndex:n,headerRowIndexWithoutSpan:n}}function lq(e,t,r){const n=t+1,i={column:e,headerRowIndex:n,headerRowIndexWithoutSpan:n};if(e instanceof ff){if(n>=r)return{column:e.getDisplayedLeafColumns()[0],headerRowIndex:r,headerRowIndexWithoutSpan:n};let o=e.getDisplayedChildren()[0];if(o instanceof ff&&o.isPadding()){const u=o.getDisplayedLeafColumns()[0];u.isSpanHeaderHeight()&&(o=u)}i.column=o,o instanceof mc&&o.isSpanHeaderHeight()&&(i.headerRowIndex=r,i.headerRowIndexWithoutSpan=n)}return i}var cq=class extends Ee{constructor(){super(...arguments),this.beanName="focusSvc",this.focusFallbackTimeout=null,this.needsFocusRestored=!1}wireBeans(e){this.colModel=e.colModel,this.visibleCols=e.visibleCols,this.rowRenderer=e.rowRenderer,this.navigation=e.navigation,this.filterManager=e.filterManager,this.overlays=e.overlays}postConstruct(){const e=this.clearFocusedCell.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:this.onColumnEverythingChanged.bind(this),columnGroupOpened:e,columnRowGroupChanged:e}),this.addDestroyFunc(qW(this.beans))}attemptToRecoverFocus(){this.needsFocusRestored=!0,this.focusFallbackTimeout!=null&&clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=window.setTimeout(this.setFocusRecovered.bind(this),100)}setFocusRecovered(){this.needsFocusRestored=!1,this.focusFallbackTimeout!=null&&(clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=null)}shouldTakeFocus(){return this.gos.get("suppressFocusAfterRefresh")?(this.setFocusRecovered(),!1):this.needsFocusRestored?(this.setFocusRecovered(),!0):this.doesRowOrCellHaveBrowserFocus()}onColumnEverythingChanged(){if(!this.focusedCell)return;const e=this.focusedCell.column,t=this.colModel.getCol(e.getId());e!==t&&this.clearFocusedCell()}getFocusCellToUseAfterRefresh(){const{gos:e,focusedCell:t}=this;return e.get("suppressFocusAfterRefresh")||e.get("suppressCellFocus")||!t||!this.doesRowOrCellHaveBrowserFocus()?null:t}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeader||!this.isDomDataPresentInHierarchy(Fr(this.beans),uL)?null:this.focusedHeader}doesRowOrCellHaveBrowserFocus(){const e=Fr(this.beans);return this.isDomDataPresentInHierarchy(e,G0)?!0:this.isDomDataPresentInHierarchy(e,V0)}isDomDataPresentInHierarchy(e,t){let r=e;for(;r;){if(r_(this.gos,r,t))return!0;r=r.parentNode}return!1}getFocusedCell(){return this.focusedCell}getFocusEventParams(e){const{rowIndex:t,rowPinned:r,column:n}=e,i={rowIndex:t,rowPinned:r,column:n,isFullWidthCell:!1},s=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:r});return s&&(i.isFullWidthCell=s.isFullWidth()),i}clearFocusedCell(){if(this.focusedCell==null)return;const e=this.getFocusEventParams(this.focusedCell);this.focusedCell=null,this.eventSvc.dispatchEvent({type:"cellFocusCleared",...e})}setFocusedCell(e){this.setFocusRecovered();const{column:t,rowIndex:r,rowPinned:n,forceBrowserFocus:i=!1,preventScrollOnBrowserFocus:s=!1,sourceEvent:o}=e,a=this.colModel.getCol(t);if(!a){this.focusedCell=null;return}this.focusedCell={rowIndex:r,rowPinned:Ho(n),column:a};const u=this.getFocusEventParams(this.focusedCell);this.eventSvc.dispatchEvent({type:"cellFocused",...u,...this.previousCellFocusParams&&{previousParams:this.previousCellFocusParams},forceBrowserFocus:i,preventScrollOnBrowserFocus:s,sourceEvent:o}),this.previousCellFocusParams=u}isCellFocused(e){return this.focusedCell==null?!1:wL(e,this.focusedCell)}isHeaderWrapperFocused(e){if(this.focusedHeader==null)return!1;const{column:t,rowCtrl:{rowIndex:r,pinned:n}}=e,{column:i,headerRowIndex:s}=this.focusedHeader;return t===i&&r===s&&n==i.getPinned()}focusHeaderPosition(e){if(this.setFocusRecovered(),Ul(this.beans))return!1;const{direction:t,fromTab:r,allowUserOverride:n,event:i,fromCell:s,rowWithoutSpanValue:o,scroll:a=!0}=e;let{headerPosition:u}=e;if(s&&this.filterManager?.isAdvFilterHeaderActive())return this.focusAdvancedFilter(u);if(n){const d=this.focusedHeader,h=qs(this.beans);if(r){const g=this.gos.getCallback("tabToNextHeader");g&&(u=this.getHeaderPositionFromUserFunc({userFunc:g,direction:t,currentPosition:d,headerPosition:u,headerRowCount:h}))}else{const g=this.gos.getCallback("navigateToNextHeader");if(g&&i){const m={key:i.key,previousHeaderPosition:d,nextHeaderPosition:u,headerRowCount:h,event:i};u=g(m)}}}return u?this.focusProvidedHeaderPosition({headerPosition:u,direction:t,event:i,fromCell:s,rowWithoutSpanValue:o,scroll:a}):!1}focusHeaderPositionFromUserFunc(e){if(Ul(this.beans))return!1;const{userFunc:t,headerPosition:r,direction:n,event:i}=e,s=this.focusedHeader,o=qs(this.beans),a=this.getHeaderPositionFromUserFunc({userFunc:t,direction:n,currentPosition:s,headerPosition:r,headerRowCount:o});return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:n,event:i})}getHeaderPositionFromUserFunc(e){const{userFunc:t,direction:r,currentPosition:n,headerPosition:i,headerRowCount:s}=e,a=t({backwards:r==="Before",previousHeaderPosition:n,nextHeaderPosition:i,headerRowCount:s});return a===!0?n:a===!1?null:a}focusProvidedHeaderPosition(e){const{headerPosition:t,direction:r,fromCell:n,rowWithoutSpanValue:i,event:s,scroll:o=!0}=e,{column:a,headerRowIndex:u}=t,{filterManager:d,ctrlsSvc:h,headerNavigation:g}=this.beans;if(this.focusedHeader&&g$(e.headerPosition,this.focusedHeader))return!1;if(u===-1)return d?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(t):this.focusGridView({column:a,event:s});o&&g?.scrollToColumn(a,r);const v=h.getHeaderRowContainerCtrl(a.getPinned())?.focusHeader(t.headerRowIndex,a,s)||!1;return g&&v&&(i!=null||n)&&(g.currentHeaderRowWithoutSpan=i??-1),v}focusFirstHeader(){if(this.overlays?.isExclusive()&&this.focusOverlay())return!0;const e=this.visibleCols.allCols[0];if(!e)return!1;const t=PL(this.beans,e,0);return this.focusHeaderPosition({headerPosition:t,rowWithoutSpanValue:0})}focusLastHeader(e){if(this.overlays?.isExclusive()&&this.focusOverlay(!0))return!0;const t=qs(this.beans)-1,r=ir(this.visibleCols.allCols);return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:r},rowWithoutSpanValue:-1,event:e})}focusPreviousFromFirstCell(e){return this.filterManager?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(e)}isAnyCellFocused(){return!!this.focusedCell}isRowFocused(e,t){return this.focusedCell==null?!1:this.focusedCell.rowIndex===e&&this.focusedCell.rowPinned===Ho(t)}focusOverlay(e){const t=this.overlays?.isVisible()&&this.overlays.eWrapper?.getGui();return!!t&&rc(t,e)}focusGridView(e){const{backwards:t=!1,canFocusOverlay:r=!0,event:n}=e;if(this.overlays?.isExclusive())return r&&this.focusOverlay(t);if(Xm(this.beans))return t&&!Ul(this.beans)?this.focusLastHeader():r&&this.focusOverlay(t)?!0:t?!1:td(this.beans,t);const i=t?Rj(this.beans):Ej(this.beans);if(i){const s=e.column??this.focusedHeader?.column,{rowIndex:o,rowPinned:a}=i,u=Yo(this.beans,i);if(!s||!u||o==null)return!1;if(s.isSuppressNavigable(u)){const d=this.gos.get("enableRtl");let h;return!n||n.key===me.TAB?h=d?me.LEFT:me.RIGHT:h=n.key,this.beans.navigation?.navigateToNextCell(null,h,{rowIndex:o,column:s,rowPinned:a||null},!0),!0}return this.navigation?.ensureCellVisible({rowIndex:o,column:s,rowPinned:a}),t&&this.rowRenderer.getRowByPosition(i)?.isFullWidth()&&this.navigation?.tryToFocusFullWidthRow(i,t)||(this.setFocusedCell({rowIndex:o,column:s,rowPinned:Ho(a),forceBrowserFocus:!0}),this.beans.rangeSvc?.setRangeToCell({rowIndex:o,rowPinned:a,column:s})),!0}return!!(r&&this.focusOverlay(t)||t&&this.focusLastHeader())}focusAdvancedFilter(e){return this.advFilterFocusColumn=e?.column,this.beans.advancedFilter?.getCtrl().focusHeaderComp()??!1}focusNextFromAdvancedFilter(e,t){const r=(t?void 0:this.advFilterFocusColumn)??this.visibleCols.allCols?.[0];return e?this.focusHeaderPosition({headerPosition:{column:r,headerRowIndex:qs(this.beans)-1}}):this.focusGridView({column:r})}clearAdvancedFilterColumn(){this.advFilterFocusColumn=void 0}},uq=class extends Ee{constructor(){super(...arguments),this.beanName="scrollVisibleSvc"}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colAnimation=e.colAnimation}postConstruct(){this.horizontalScrollShowing=this.gos.get("alwaysShowHorizontalScroll")===!0,this.verticalScrollShowing=this.gos.get("alwaysShowVerticalScroll")===!0,this.getScrollbarWidth(),this.addManagedEventListeners({displayedColumnsChanged:this.updateScrollVisible.bind(this),displayedColumnsWidthChanged:this.updateScrollVisible.bind(this)})}updateScrollVisible(){const{colAnimation:e}=this;e?.isActive()?e.executeLaterVMTurn(()=>{e.executeLaterVMTurn(()=>this.updateScrollVisibleImpl())}):this.updateScrollVisibleImpl()}updateScrollVisibleImpl(){const e=this.ctrlsSvc.get("center");if(!e||this.colAnimation?.isActive())return;const t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.verticalScrollShowing};this.setScrollsVisible(t),this.updateScrollGap()}updateScrollGap(){const e=this.ctrlsSvc.get("center"),t=e.hasHorizontalScrollGap(),r=e.hasVerticalScrollGap();(this.horizontalScrollGap!==t||this.verticalScrollGap!==r)&&(this.horizontalScrollGap=t,this.verticalScrollGap=r,this.eventSvc.dispatchEvent({type:"scrollGapChanged"}))}setScrollsVisible(e){(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing)&&(this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing,this.eventSvc.dispatchEvent({type:"scrollVisibilityChanged"}))}getScrollbarWidth(){if(this.scrollbarWidth==null){const e=this.gos.get("scrollbarWidth"),r=typeof e=="number"&&e>=0?e:zW();r!=null&&(this.scrollbarWidth=r,this.eventSvc.dispatchEvent({type:"scrollbarWidthChanged"}))}return this.scrollbarWidth}},dq=class extends Ee{constructor(){super(...arguments),this.beanName="gridDestroySvc",this.destroyCalled=!1}destroy(){if(this.destroyCalled)return;const{stateSvc:e,ctrlsSvc:t,context:r}=this.beans;this.eventSvc.dispatchEvent({type:"gridPreDestroyed",state:e?.getState()??{}}),this.destroyCalled=!0,t.get("gridCtrl")?.destroyGridUi(),r.destroy(),super.destroy()}},d0=new Set(["gridPreDestroyed","fillStart","pasteStart"]),hq=["columnEverythingChanged","newColumnsLoaded","columnPivotModeChanged","pivotMaxColumnsExceeded","columnRowGroupChanged","expandOrCollapseAll","columnPivotChanged","gridColumnsChanged","columnValueChanged","columnMoved","columnVisible","columnPinned","columnGroupOpened","columnResized","displayedColumnsChanged","virtualColumnsChanged","columnHeaderMouseOver","columnHeaderMouseLeave","columnHeaderClicked","columnHeaderContextMenu","asyncTransactionsFlushed","rowGroupOpened","rowDataUpdated","pinnedRowDataChanged","pinnedRowsChanged","rangeSelectionChanged","cellSelectionChanged","chartCreated","chartRangeSelectionChanged","chartOptionsChanged","chartDestroyed","toolPanelVisibleChanged","toolPanelSizeChanged","modelUpdated","cutStart","cutEnd","pasteStart","pasteEnd","fillStart","fillEnd","cellSelectionDeleteStart","cellSelectionDeleteEnd","rangeDeleteStart","rangeDeleteEnd","undoStarted","undoEnded","redoStarted","redoEnded","cellClicked","cellDoubleClicked","cellMouseDown","cellContextMenu","cellValueChanged","cellEditRequest","rowValueChanged","headerFocused","cellFocused","rowSelected","selectionChanged","tooltipShow","tooltipHide","cellKeyDown","cellMouseOver","cellMouseOut","filterChanged","filterModified","filterUiChanged","filterOpened","floatingFilterUiChanged","advancedFilterBuilderVisibleChanged","sortChanged","virtualRowRemoved","rowClicked","rowDoubleClicked","gridReady","gridPreDestroyed","gridSizeChanged","viewportChanged","firstDataRendered","dragStarted","dragStopped","dragCancelled","rowEditingStarted","rowEditingStopped","cellEditingStarted","cellEditingStopped","bodyScroll","bodyScrollEnd","paginationChanged","componentStateChanged","storeRefreshed","stateUpdated","columnMenuVisibleChanged","contextMenuVisibleChanged","rowDragEnter","rowDragMove","rowDragLeave","rowDragEnd","rowDragCancel","findChanged","rowResizeStarted","rowResizeEnded","columnsReset","bulkEditingStarted","bulkEditingStopped","batchEditingStarted","batchEditingStopped"],kx=hq.reduce((e,t)=>(e[t]=P7(t),e),{}),xh=(e,t)=>({tag:"span",ref:`eSort${e}`,cls:`ag-sort-indicator-icon ag-sort-${t} ag-hidden`,attrs:{"aria-hidden":"true"}}),fq={tag:"span",cls:"ag-sort-indicator-container",children:[xh("Order","order"),xh("Asc","ascending-icon"),xh("Desc","descending-icon"),xh("Mixed","mixed-icon"),xh("None","none-icon")]},Px=class extends Dr{constructor(e){super(),this.eSortOrder=tt,this.eSortAsc=tt,this.eSortDesc=tt,this.eSortMixed=tt,this.eSortNone=tt,e||this.setTemplate(fq)}attachCustomElements(e,t,r,n,i){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=r,this.eSortMixed=n,this.eSortNone=i}setupSort(e,t=!1){if(this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator(),!e.isSortable()&&!e.getColDef().showRowGroup)return;this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e);const r=this.updateIcons.bind(this),n=this.onSortChanged.bind(this);this.addManagedPropertyListener("unSortIcon",r),this.addManagedEventListeners({newColumnsLoaded:r,sortChanged:n,columnRowGroupChanged:n}),this.onSortChanged()}addInIcon(e,t,r){if(t==null)return;const n=ts(e,this.beans,r);n&&t.appendChild(n)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const{eSortAsc:e,eSortDesc:t,eSortNone:r,column:n,gos:i,beans:s}=this,o=s.sortSvc.getDisplaySortForColumn(n);if(e&&Er(e,o==="asc",{skipAriaHidden:!0}),t&&Er(t,o==="desc",{skipAriaHidden:!0}),r){const a=!n.getColDef().unSortIcon&&!i.get("unSortIcon"),u=o==null;Er(r,!a&&u,{skipAriaHidden:!0})}}setupMultiSortIndicator(){const{eSortMixed:e,column:t,gos:r}=this;this.addInIcon("sortUnSort",e,t);const n=t.getColDef().showRowGroup;Ys(r)&&n&&(this.addManagedEventListeners({sortChanged:this.updateMultiSortIndicator.bind(this),columnRowGroupChanged:this.updateMultiSortIndicator.bind(this)}),this.updateMultiSortIndicator())}updateMultiSortIndicator(){const{eSortMixed:e,beans:t,column:r}=this;if(e){const n=t.sortSvc.getDisplaySortForColumn(r)==="mixed";Er(e,n,{skipAriaHidden:!0})}}updateSortOrder(){const{eSortOrder:e,column:t,beans:{sortSvc:r}}=this;if(!e)return;const n=r.getColumnsWithSortingOrdered(),i=r.getDisplaySortIndexForColumn(t)??-1,s=n.some(a=>r.getDisplaySortIndexForColumn(a)??!1),o=i>=0&&s;Er(e,o,{skipAriaHidden:!0}),i>=0?e.textContent=(i+1).toString():ci(e)}},gq={selector:"AG-SORT-INDICATOR",component:Px},pf=["asc","desc",null],pq=class extends Ee{constructor(){super(...arguments),this.beanName="sortSvc"}progressSort(e,t,r){const n=this.getNextSortDirection(e);this.setSortForColumn(e,n,t,r)}progressSortFromEvent(e,t){const n=this.gos.get("multiSortKey")==="ctrl"?t.ctrlKey||t.metaKey:t.shiftKey;this.progressSort(e,n,"uiColumnSorted")}setSortForColumn(e,t,r,n){t!=="asc"&&t!=="desc"&&(t=null);const{gos:i,showRowGroupCols:s}=this.beans,o=Ys(i);let a=[e];if(o&&e.getColDef().showRowGroup){const g=s?.getSourceColumnsForGroupColumn?.(e)?.filter(m=>m.isSortable());g&&(a=[e,...g])}for(const h of a)this.setColSort(h,t,n);const u=(r||i.get("alwaysMultiSort"))&&!i.get("suppressMultiSort"),d=[];if(!u){const h=this.clearSortBarTheseColumns(a,n);d.push(...h)}this.updateSortIndex(e),d.push(...a),this.dispatchSortChangedEvents(n,d)}updateSortIndex(e){const{gos:t,colModel:r,showRowGroupCols:n}=this.beans,i=Ys(t),s=n?.getShowRowGroupCol(e.getId()),o=i&&s||e,a=this.getColumnsWithSortingOrdered();r.forAllCols(h=>this.setColSortIndex(h,null));const u=a.filter(h=>i&&h.getColDef().showRowGroup?!1:h!==o);(o.getSort()?[...u,o]:u).forEach((h,g)=>this.setColSortIndex(h,g))}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){let e=!1;return this.beans.colModel.forAllCols(t=>{t.getSort()&&(e=!0)}),e}dispatchSortChangedEvents(e,t){const r={type:"sortChanged",source:e};t&&(r.columns=t),this.eventSvc.dispatchEvent(r)}clearSortBarTheseColumns(e,t){const r=[];return this.beans.colModel.forAllCols(n=>{e.includes(n)||(n.getSort()&&r.push(n),this.setColSort(n,void 0,t))}),r}getNextSortDirection(e){const t=e.getColDef().sortingOrder??this.gos.get("sortingOrder")??pf,r=t.indexOf(e.getSort()),n=r<0,i=r==t.length-1;return n||i?t[0]:t[r+1]}getIndexedSortMap(){const{gos:e,colModel:t,showRowGroupCols:r,rowGroupColsSvc:n}=this.beans;let i=[];if(t.forAllCols(d=>{d.getSort()&&i.push(d)}),t.isPivotMode()){const d=Ys(e);i=i.filter(h=>{const g=!!h.getAggFunc(),m=!h.isPrimary(),v=d?r?.getShowRowGroupCol(h.getId()):h.getColDef().showRowGroup;return g||m||v})}const s=n?.columns.filter(d=>!!d.getSort())??[],o={};i.forEach((d,h)=>o[d.getId()]=h),i.sort((d,h)=>{const g=d.getSortIndex(),m=h.getSortIndex();if(g!=null&&m!=null)return g-m;if(g==null&&m==null){const v=o[d.getId()],w=o[h.getId()];return v>w?1:-1}else return m==null?-1:1});const a=Ys(e)&&!!s.length;a&&(i=[...new Set(i.map(d=>r?.getShowRowGroupCol(d.getId())??d))]);const u=new Map;if(i.forEach((d,h)=>u.set(d,h)),a)for(const d of s){const h=r.getShowRowGroupCol(d.getId());u.set(d,u.get(h))}return u}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([,e],[,t])=>e-t).map(([e])=>e)}getSortModel(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),colId:e.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),column:e}))}canColumnDisplayMixedSort(e){const t=Ys(this.gos),r=!!e.getColDef().showRowGroup;return t&&r}getDisplaySortForColumn(e){const t=this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!t?.length)return e.getSort();const n=e.getColDef().field!=null||!!e.getColDef().valueGetter?[e,...t]:t,i=n[0].getSort();return n.every(o=>o.getSort()==i)?i:"mixed"}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}setupHeader(e,t,r){let n=0;e.addManagedListeners(t,{movingChanged:()=>{n=Date.now()}}),r&&e.addManagedElementListeners(r,{click:s=>{const o=t.isMoving(),u=Date.now()-n<50;o||u||this.progressSortFromEvent(t,s)}});const i=()=>{const s=t.getSort();if(e.toggleCss("ag-header-cell-sorted-asc",s==="asc"),e.toggleCss("ag-header-cell-sorted-desc",s==="desc"),e.toggleCss("ag-header-cell-sorted-none",!s),t.getColDef().showRowGroup){const u=!this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(t)?.every(d=>t.getSort()==d.getSort());e.toggleCss("ag-header-cell-sorted-mixed",u)}};e.addManagedEventListeners({sortChanged:i,columnRowGroupChanged:i})}initCol(e){const{sort:t,initialSort:r,sortIndex:n,initialSortIndex:i}=e.colDef;t!==void 0?(t==="asc"||t==="desc")&&(e.sort=t):(r==="asc"||r==="desc")&&(e.sort=r),n!==void 0?n!==null&&(e.sortIndex=n):i!==null&&(e.sortIndex=i)}updateColSort(e,t,r){t!==void 0&&(t==="desc"||t==="asc"?this.setColSort(e,t,r):this.setColSort(e,void 0,r))}setColSort(e,t,r){e.sort!==t&&(e.sort=t,e.dispatchColEvent("sortChanged",r)),e.dispatchStateUpdatedEvent("sort")}setColSortIndex(e,t){e.sortIndex=t,e.dispatchStateUpdatedEvent("sortIndex")}createSortIndicator(e){return new Px(e)}getSortIndicatorSelector(){return gq}},Nu={agSetColumnFilter:"SetFilter",agSetColumnFloatingFilter:"SetFilter",agMultiColumnFilter:"MultiFilter",agMultiColumnFloatingFilter:"MultiFilter",agGroupColumnFilter:"GroupFilter",agGroupColumnFloatingFilter:"GroupFilter",agGroupCellRenderer:"GroupCellRenderer",agGroupRowRenderer:"GroupCellRenderer",agRichSelect:"RichSelect",agRichSelectCellEditor:"RichSelect",agDetailCellRenderer:"SharedMasterDetail",agSparklineCellRenderer:"Sparklines",agDragAndDropImage:"SharedDragAndDrop",agColumnHeader:"ColumnHeaderComp",agColumnGroupHeader:"ColumnGroupHeaderComp",agSortIndicator:"Sort",agAnimateShowChangeCellRenderer:"HighlightChanges",agAnimateSlideCellRenderer:"HighlightChanges",agLoadingCellRenderer:"LoadingCellRenderer",agSkeletonCellRenderer:"SkeletonCellRenderer",agCheckboxCellRenderer:"CheckboxCellRenderer",agLoadingOverlay:"Overlay",agNoRowsOverlay:"Overlay",agTooltipComponent:"Tooltip",agReadOnlyFloatingFilter:"CustomFilter",agTextColumnFilter:"TextFilter",agNumberColumnFilter:"NumberFilter",agDateColumnFilter:"DateFilter",agDateInput:"DateFilter",agTextColumnFloatingFilter:"TextFilter",agNumberColumnFloatingFilter:"NumberFilter",agDateColumnFloatingFilter:"DateFilter",agCellEditor:"TextEditor",agSelectCellEditor:"SelectEditor",agTextCellEditor:"TextEditor",agNumberCellEditor:"NumberEditor",agDateCellEditor:"DateEditor",agDateStringCellEditor:"DateEditor",agCheckboxCellEditor:"CheckboxEditor",agLargeTextCellEditor:"LargeTextEditor",agMenuItem:"MenuItem",agColumnsToolPanel:"ColumnsToolPanel",agFiltersToolPanel:"FiltersToolPanel",agNewFiltersToolPanel:"NewFiltersToolPanel",agAggregationComponent:"StatusBar",agSelectedRowCountComponent:"StatusBar",agTotalRowCountComponent:"StatusBar",agFilteredRowCountComponent:"StatusBar",agTotalAndFilteredRowCountComponent:"StatusBar",agFindCellRenderer:"Find"};function BD(e){return`"${e}"`}var mq=()=>({checkboxSelection:{version:"32.2",message:"Use `rowSelection.checkboxes` in `GridOptions` instead."},headerCheckboxSelection:{version:"32.2",message:"Use `rowSelection.headerCheckbox = true` in `GridOptions` instead."},headerCheckboxSelectionFilteredOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "filtered"` in `GridOptions` instead.'},headerCheckboxSelectionCurrentPageOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "currentPage"` in `GridOptions` instead.'},showDisabledCheckboxes:{version:"32.2",message:"Use `rowSelection.hideDisabledCheckboxes = true` in `GridOptions` instead."},rowGroupingHierarchy:{version:"34.3",message:"Use `colDef.groupHierarchy` instead."}}),vq={aggFunc:"SharedAggregation",autoHeight:"RowAutoHeight",cellClass:"CellStyle",cellClassRules:"CellStyle",cellEditor:({cellEditor:e,editable:t})=>t?typeof e=="string"?Nu[e]??"CustomEditor":"CustomEditor":null,cellRenderer:({cellRenderer:e})=>typeof e!="string"?null:Nu[e],cellStyle:"CellStyle",columnChooserParams:"ColumnMenu",contextMenuItems:"ContextMenu",dndSource:"DragAndDrop",dndSourceOnRowDrag:"DragAndDrop",editable:({editable:e,cellEditor:t})=>e&&!t?"TextEditor":null,enableCellChangeFlash:"HighlightChanges",enablePivot:"SharedPivot",enableRowGroup:"SharedRowGrouping",enableValue:"SharedAggregation",filter:({filter:e})=>e&&typeof e!="string"&&typeof e!="boolean"?"CustomFilter":typeof e=="string"?Nu[e]??"ColumnFilter":"ColumnFilter",floatingFilter:"ColumnFilter",getQuickFilterText:"QuickFilter",headerTooltip:"Tooltip",headerTooltipValueGetter:"Tooltip",mainMenuItems:"ColumnMenu",menuTabs:e=>{const t=["columnsMenuTab","generalMenuTab"];return e.menuTabs?.some(r=>t.includes(r))?"ColumnMenu":null},pivot:"SharedPivot",pivotIndex:"SharedPivot",rowDrag:"RowDrag",rowGroup:"SharedRowGrouping",rowGroupIndex:"SharedRowGrouping",tooltipField:"Tooltip",tooltipValueGetter:"Tooltip",tooltipComponentSelector:"Tooltip",spanRows:"CellSpan",groupHierarchy:"SharedRowGrouping"},wq=()=>({autoHeight:{supportedRowModels:["clientSide","serverSide"],validate:(t,{paginationAutoPageSize:r})=>r?"colDef.autoHeight is not supported with paginationAutoPageSize.":null},cellRendererParams:{validate:t=>(t.rowGroup!=null||t.rowGroupIndex!=null||t.cellRenderer==="agGroupCellRenderer")&&"checkbox"in t.cellRendererParams?'Since v33.0, `cellRendererParams.checkbox` has been deprecated. Use `rowSelection.checkboxLocation = "autoGroupColumn"` instead.':null},flex:{validate:(t,r)=>r.autoSizeStrategy?"colDef.flex is not supported with gridOptions.autoSizeStrategy":null},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],validate:(t,{rowSelection:r})=>r==="multiple"?null:"headerCheckboxSelection is only supported with rowSelection=multiple"},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],validate:(t,{rowSelection:r})=>r==="multiple"?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],validate:(t,{rowSelection:r})=>r==="multiple"?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"},headerValueGetter:{validate:t=>{const r=t.headerValueGetter;return typeof r=="function"||typeof r=="string"?null:"headerValueGetter must be a function or a valid string expression"}},icons:{validate:({icons:t})=>{if(t){if(t.smallDown)return eo(262);if(t.smallLeft)return eo(263);if(t.smallRight)return eo(264)}return null}},sortingOrder:{validate:t=>{const r=t.sortingOrder;if(Array.isArray(r)&&r.length>0){const n=r.filter(i=>!pf.includes(i));if(n.length>0)return`sortingOrder must be an array with elements from [${pf.map(A0).join()}], currently it includes [${n.map(A0).join()}]`}else if(!Array.isArray(r)||r.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${r}`;return null}},type:{validate:t=>{const r=t.type;return r instanceof Array?r.some(i=>typeof i!="string")?"if colDef.type is supplied an array it should be of type 'string[]'":null:typeof r=="string"?null:"colDef.type should be of type 'string' | 'string[]'"}},rowSpan:{validate:(t,{suppressRowTransform:r})=>r?null:"colDef.rowSpan requires suppressRowTransform to be enabled."},spanRows:{dependencies:{editable:{required:[!1,void 0]},rowDrag:{required:[!1,void 0]},colSpan:{required:[void 0]},rowSpan:{required:[void 0]}},validate:(t,{rowSelection:r,cellSelection:n,suppressRowTransform:i,enableCellSpan:s,rowDragEntireRow:o,enableCellTextSelection:a})=>typeof r=="object"&&r?.mode==="singleRow"&&r?.enableClickSelection?"colDef.spanRows is not supported with rowSelection.clickSelection":n?"colDef.spanRows is not supported with cellSelection.":i?"colDef.spanRows is not supported with suppressRowTransform.":s?o?"colDef.spanRows is not supported with rowDragEntireRow.":a?"colDef.spanRows is not supported with enableCellTextSelection.":null:"colDef.spanRows requires enableCellSpan to be enabled."},groupHierarchy:{validate(t,{groupHierarchyConfig:r={}},n){const i=new Set(["year","quarter","month","formattedMonth","day","hour","minute","second"]),s=[];for(const o of t.groupHierarchy??[]){if(typeof o=="object"){n.validation?.validateColDef(o);continue}!i.has(o)&&!(o in r)&&s.push(BD(o))}if(s.length>0){const o=`The following parts of colDef.groupHierarchy are not recognised: ${s.join(", ")}.`,a=`Choose one of ${[...i].map(BD).join(", ")}, or define your own parts in gridOptions.groupHierarchyConfig.`;return`${o}
${a}`}return null}}}),Cq={headerName:void 0,columnGroupShow:void 0,headerStyle:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,headerTooltipValueGetter:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,spanRows:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,tooltipComponentSelector:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,context:void 0,dateComponent:void 0,dateComponentParams:void 0,getFindText:void 0,rowGroupingHierarchy:void 0,groupHierarchy:void 0},yq=()=>Object.keys(Cq),bq=()=>({objectName:"colDef",allProperties:yq(),docsUrl:"column-properties/",deprecations:mq(),validations:wq()}),Sq=["overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","treeDataChildrenField","treeDataParentIdField","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","invalidEditValueMode","grandTotalRow","themeCssLayer","findSearchValue","styleNonce","renderingMode"],xq=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","dragAndDropImageComponentParams","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","themeStyleContainer","statusBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterParent","advancedFilterBuilderParams","advancedFilterParams","initialState","autoSizeStrategy","selectionColumnDef","findOptions","filterHandlers","groupHierarchyConfig"],Eq=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector"],ML=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns","rowDragInsertDelay"],Rq=["theme","rowSelection"],Tq=["cellSelection","sideBar","rowNumbers","suppressGroupChangesColumnVisibility","groupAggFiltering","suppressStickyTotalRow","groupHideParentOfSingleChild","enableRowPinning"],_L=["loadThemeGoogleFonts","suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressColumnMoveAnimation","suppressMoveWhenColumnDragging","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","allowContextMenuWithControlKey","suppressContextMenu","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressFocusAfterRefresh","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","enableCellSpan","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval","loading","maintainColumnOrder","enableStrictPivotColumnOrder","suppressSetFilterByDefault","enableFilterHandlers","suppressStartEditOnTab","hidePaddedHeaderRows","ssrmExpandAllAffectsAllRows"],Fq=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","dragAndDropImageComponent","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher","getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getFullRowEditValidationErrors","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","focusGridInnerElement","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","chartMenuItems","groupTotalRow","alwaysPassFilter","isRowPinnable","isRowPinned","isRowValidDropPosition"],Dq=()=>[...Eq,...xq,...Sq,...ML,...Fq,..._L,...Tq,...Rq],Aq=()=>({suppressLoadingOverlay:{version:"32",message:"Use `loading`=false instead."},enableFillHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeSelection:{version:"32.2",message:"Use `cellSelection = true` instead."},suppressMultiRangeSelection:{version:"32.2",message:"Use `cellSelection.suppressMultiRanges` instead."},suppressClearOnFillReduction:{version:"32.2",message:"Use `cellSelection.handle.suppressClearOnFillReduction` instead."},fillHandleDirection:{version:"32.2",message:"Use `cellSelection.handle.direction` instead."},fillOperation:{version:"32.2",message:"Use `cellSelection.handle.setFillValue` instead."},suppressRowClickSelection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},suppressRowDeselection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},rowMultiSelectWithClick:{version:"32.2",message:"Use `rowSelection.enableSelectionWithoutKeys` instead."},groupSelectsChildren:{version:"32.2",message:'Use `rowSelection.groupSelects = "descendants"` instead.'},groupSelectsFiltered:{version:"32.2",message:'Use `rowSelection.groupSelects = "filteredDescendants"` instead.'},isRowSelectable:{version:"32.2",message:"Use `selectionOptions.isRowSelectable` instead."},suppressCopySingleCellRanges:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},suppressCopyRowsToClipboard:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},onRangeSelectionChanged:{version:"32.2",message:"Use `onCellSelectionChanged` instead."},onRangeDeleteStart:{version:"32.2",message:"Use `onCellSelectionDeleteStart` instead."},onRangeDeleteEnd:{version:"32.2",message:"Use `onCellSelectionDeleteEnd` instead."},suppressBrowserResizeObserver:{version:"32.2",message:"The grid always uses the browser's ResizeObserver, this grid option has no effect."},onColumnEverythingChanged:{version:"32.2",message:"Either use `onDisplayedColumnsChanged` which is fired at the same time, or use one of the more specific column events."},groupRemoveSingleChildren:{version:"33",message:"Use `groupHideParentOfSingleChild` instead."},groupRemoveLowestSingleChildren:{version:"33",message:'Use `groupHideParentOfSingleChild: "leafGroupsOnly"` instead.'},suppressRowGroupHidesColumns:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressHideOnGroup"` instead.'},suppressMakeColumnVisibleAfterUnGroup:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressShowOnUngroup"` instead.'},unSortIcon:{version:"33",message:"Use `defaultColDef.unSortIcon` instead."},sortingOrder:{version:"33",message:"Use `defaultColDef.sortingOrder` instead."},suppressPropertyNamesCheck:{version:"33",message:"`gridOptions` and `columnDefs` both have a `context` property that should be used for arbitrary user data. This means that column definitions and gridOptions should only contain valid properties making this property redundant."},suppressAdvancedFilterEval:{version:"34",message:"Advanced filter no longer uses function evaluation, so this option has no effect."}});function Bs(e,t,r){return typeof t=="number"||t==null?t==null||t>=r?null:`${e}: value should be greater than or equal to ${r}`:`${e}: value should be a number`}var kq={alignedGrids:"AlignedGrids",allowContextMenuWithControlKey:"ContextMenu",autoSizeStrategy:"ColumnAutoSize",cellSelection:"CellSelection",columnHoverHighlight:"ColumnHover",datasource:"InfiniteRowModel",doesExternalFilterPass:"ExternalFilter",editType:"EditCore",invalidEditValueMode:"EditCore",enableAdvancedFilter:"AdvancedFilter",enableCellSpan:"CellSpan",enableCharts:"IntegratedCharts",enableRangeSelection:"CellSelection",enableRowPinning:"PinnedRow",findSearchValue:"Find",getFullRowEditValidationErrors:"EditCore",getContextMenuItems:"ContextMenu",getLocaleText:"Locale",getMainMenuItems:"ColumnMenu",getRowClass:"RowStyle",getRowStyle:"RowStyle",groupTotalRow:"SharedRowGrouping",grandTotalRow:"ClientSideRowModelHierarchy",initialState:"GridState",isExternalFilterPresent:"ExternalFilter",isRowPinnable:"PinnedRow",isRowPinned:"PinnedRow",localeText:"Locale",masterDetail:"SharedMasterDetail",pagination:"Pagination",pinnedBottomRowData:"PinnedRow",pinnedTopRowData:"PinnedRow",pivotMode:"SharedPivot",pivotPanelShow:"RowGroupingPanel",quickFilterText:"QuickFilter",rowClass:"RowStyle",rowClassRules:"RowStyle",rowData:"ClientSideRowModel",rowDragManaged:"RowDrag",rowGroupPanelShow:"RowGroupingPanel",rowNumbers:"RowNumbers",rowSelection:"SharedRowSelection",rowStyle:"RowStyle",serverSideDatasource:"ServerSideRowModel",sideBar:"SideBar",statusBar:"StatusBar",treeData:"SharedTreeData",undoRedoCellEditing:"UndoRedoEdit",valueCache:"ValueCache",viewportDatasource:"ViewportRowModel"},Pq=()=>{const e={autoSizePadding:{validate({autoSizePadding:r}){return Bs("autoSizePadding",r,0)}},cacheBlockSize:{supportedRowModels:["serverSide","infinite"],validate({cacheBlockSize:r}){return Bs("cacheBlockSize",r,1)}},cacheOverflowSize:{validate({cacheOverflowSize:r}){return Bs("cacheOverflowSize",r,1)}},datasource:{supportedRowModels:["infinite"]},domLayout:{validate:r=>{const n=r.domLayout,i=["autoHeight","normal","print"];return n&&!i.includes(n)?`domLayout must be one of [${i.join()}], currently it's ${n}`:null}},enableFillHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeSelection:{dependencies:{rowDragEntireRow:{required:[!1,void 0]}}},enableRowPinning:{supportedRowModels:["clientSide"],validate({enableRowPinning:r,pinnedTopRowData:n,pinnedBottomRowData:i}){return r&&(n||i)?"Manual row pinning cannot be used together with pinned row data. Either set `enableRowPinning` to `false`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":null}},isRowPinnable:{supportedRowModels:["clientSide"],validate({enableRowPinning:r,isRowPinnable:n,pinnedTopRowData:i,pinnedBottomRowData:s}){return n&&(i||s)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinnable`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!r&&n?"`isRowPinnable` requires `enableRowPinning` to be set.":null}},isRowPinned:{supportedRowModels:["clientSide"],validate({enableRowPinning:r,isRowPinned:n,pinnedTopRowData:i,pinnedBottomRowData:s}){return n&&(i||s)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinned`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!r&&n?"`isRowPinned` requires `enableRowPinning` to be set.":null}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupHideOpenParents:{supportedRowModels:["clientSide","serverSide"],dependencies:{groupTotalRow:{required:[void 0,"bottom"]},treeData:{required:[void 0,!1],reason:"Tree Data has values at the group level so it doesn't make sense to hide them."}}},groupHideParentOfSingleChild:{dependencies:{groupHideOpenParents:{required:[void 0,!1]}}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveSingleChildren:{required:[void 0,!1]}}},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveLowestSingleChildren:{required:[void 0,!1]}}},groupSelectsChildren:{dependencies:{rowSelection:{required:["multiple"]}}},groupHierarchyConfig:{validate({groupHierarchyConfig:r={}},n,i){for(const s of Object.keys(r))i.validation?.validateColDef(r[s]);return null}},icons:{validate:({icons:r})=>{if(r){if(r.smallDown)return eo(262);if(r.smallLeft)return eo(263);if(r.smallRight)return eo(264)}return null}},infiniteInitialRowCount:{validate({infiniteInitialRowCount:r}){return Bs("infiniteInitialRowCount",r,1)}},initialGroupOrderComparator:{supportedRowModels:["clientSide"]},ssrmExpandAllAffectsAllRows:{validate:r=>{if(typeof r.ssrmExpandAllAffectsAllRows=="boolean"){if(r.rowModelType!=="serverSide")return"'ssrmExpandAllAffectsAllRows' is only supported with the Server Side Row Model.";if(r.ssrmExpandAllAffectsAllRows&&typeof r.getRowId!="function")return"'getRowId' callback must be provided for Server Side Row Model grouping to work correctly."}return null}},keepDetailRowsCount:{validate({keepDetailRowsCount:r}){return Bs("keepDetailRowsCount",r,1)}},paginationPageSize:{validate({paginationPageSize:r}){return Bs("paginationPageSize",r,1)}},paginationPageSizeSelector:{validate:r=>{const n=r.paginationPageSizeSelector;return typeof n=="boolean"||n==null||n.length?null:`'paginationPageSizeSelector' cannot be an empty array.
                    If you want to hide the page size selector, set paginationPageSizeSelector to false.`}},pivotMode:{dependencies:{treeData:{required:[!1,void 0],reason:"Pivot Mode is not supported with Tree Data."}}},quickFilterText:{supportedRowModels:["clientSide"]},rowBuffer:{validate({rowBuffer:r}){return Bs("rowBuffer",r,0)}},rowClass:{validate:r=>typeof r.rowClass=="function"?"rowClass should not be a function, please use getRowClass instead":null},rowData:{supportedRowModels:["clientSide"]},rowDragManaged:{supportedRowModels:["clientSide"],dependencies:{pagination:{required:[!1,void 0]}}},rowSelection:{validate({rowSelection:r}){return r&&typeof r=="string"?'As of version 32.2.1, using `rowSelection` with the values "single" or "multiple" has been deprecated. Use the object value instead.':r&&typeof r!="object"?"Expected `RowSelectionOptions` object for the `rowSelection` property.":r&&r.mode!=="multiRow"&&r.mode!=="singleRow"?`Selection mode "${r.mode}" is invalid. Use one of 'singleRow' or 'multiRow'.`:null}},rowStyle:{validate:r=>{const n=r.rowStyle;return n&&typeof n=="function"?"rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead":null}},serverSideDatasource:{supportedRowModels:["serverSide"]},serverSideInitialRowCount:{supportedRowModels:["serverSide"],validate({serverSideInitialRowCount:r}){return Bs("serverSideInitialRowCount",r,1)}},serverSideOnlyRefreshFilteredGroups:{supportedRowModels:["serverSide"]},serverSideSortAllLevels:{supportedRowModels:["serverSide"]},sortingOrder:{validate:r=>{const n=r.sortingOrder;if(Array.isArray(n)&&n.length>0){const i=n.filter(s=>!pf.includes(s));if(i.length>0)return`sortingOrder must be an array with elements from [${pf.map(A0).join()}], currently it includes [${i.map(A0).join()}]`}else if(!Array.isArray(n)||n.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${n}`;return null}},tooltipHideDelay:{validate:r=>r.tooltipHideDelay&&r.tooltipHideDelay<0?"tooltipHideDelay should not be lower than 0":null},tooltipShowDelay:{validate:r=>r.tooltipShowDelay&&r.tooltipShowDelay<0?"tooltipShowDelay should not be lower than 0":null},treeData:{supportedRowModels:["clientSide","serverSide"],validate:r=>{const n=r.rowModelType??"clientSide";switch(n){case"clientSide":{const{treeDataChildrenField:i,treeDataParentIdField:s,getDataPath:o,getRowId:a}=r;if(!i&&!s&&!o)return"treeData requires either 'treeDataChildrenField' or 'treeDataParentIdField' or 'getDataPath' in the clientSide row model.";if(i){if(o)return"Cannot use both 'treeDataChildrenField' and 'getDataPath' at the same time.";if(s)return"Cannot use both 'treeDataChildrenField' and 'treeDataParentIdField' at the same time."}if(s){if(!a)return"getRowId callback not provided, tree data with parent id cannot be built.";if(o)return"Cannot use both 'treeDataParentIdField' and 'getDataPath' at the same time."}return null}case"serverSide":{const i=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${n} row model.`;return r.isServerSideGroup&&r.getServerSideGroupKey?null:i}}return null}},viewportDatasource:{supportedRowModels:["viewport"]},viewportRowModelBufferSize:{validate({viewportRowModelBufferSize:r}){return Bs("viewportRowModelBufferSize",r,0)}},viewportRowModelPageSize:{validate({viewportRowModelPageSize:r}){return Bs("viewportRowModelPageSize",r,1)}},rowDragEntireRow:{dependencies:{cellSelection:{required:[void 0]}}},autoGroupColumnDef:{validate({autoGroupColumnDef:r,showOpenedGroup:n}){return r?.field&&n?"autoGroupColumnDef.field and showOpenedGroup are not supported when used together.":r?.valueGetter&&n?"autoGroupColumnDef.valueGetter and showOpenedGroup are not supported when used together.":null}},renderingMode:{validate:r=>{const n=r.renderingMode,i=["default","legacy"];return n&&!i.includes(n)?`renderingMode must be one of [${i.join()}], currently it's ${n}`:null}},autoSizeStrategy:{validate:({autoSizeStrategy:r})=>{if(!r)return null;const n=["fitCellContents","fitGridWidth","fitProvidedWidth"],i=r.type;return i!=="fitCellContents"&&i!=="fitGridWidth"&&i!=="fitProvidedWidth"?`Invalid Auto-size strategy. \`autoSizeStrategy\` must be one of ${n.map(s=>'"'+s+'"').join(", ")}, currently it's ${i}`:i==="fitProvidedWidth"&&typeof r.width!="number"?`When using the 'fitProvidedWidth' auto-size strategy, must provide a numeric \`width\`. You provided ${r.width}`:null}}},t={};for(const r of _L)t[r]={expectedType:"boolean"};for(const r of ML)t[r]={expectedType:"number"};return Wn(t,e),t},Mq=()=>({objectName:"gridOptions",allProperties:[...Dq(),...Object.values(kx)],propertyExceptions:["api"],docsUrl:"grid-options/",deprecations:Aq(),validations:Pq()}),_q=0,Lq=0,HD="__ag_grid_instance",Iq=class extends Ee{constructor(){super(...arguments),this.beanName="gos",this.domDataKey="__AG_"+Math.random().toString(),this.instanceId=Lq++,this.gridReadyFired=!1,this.queueEvents=[],this.propEventSvc=new Zl,this.globalEventHandlerFactory=e=>(t,r)=>{if(!this.isAlive())return;const n=d0.has(t);if(n&&!e||!n&&e||!Oq(t))return;const i=(s,o)=>{const a=kx[s],u=this.gridOptions[a];typeof u=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>u(o))};if(this.gridReadyFired)i(t,r);else if(t==="gridReady"){i(t,r),this.gridReadyFired=!0;for(const s of this.queueEvents)i(s.eventName,s.event);this.queueEvents=[]}else this.queueEvents.push({eventName:t,event:r})}}wireBeans(e){this.gridOptions=e.gridOptions,this.validation=e.validation,this.api=e.gridApi,this.gridId=e.context.getId()}get gridOptionsContext(){return this.gridOptions.context}postConstruct(){this.validateGridOptions(this.gridOptions),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory().bind(this),!0),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propEventSvc.setFrameworkOverrides(this.beans.frameworkOverrides),this.addManagedEventListeners({gridOptionsChanged:({options:e})=>{this.updateGridOptions({options:e,force:!0,source:"optionsUpdated"})}})}destroy(){super.destroy(),this.queueEvents=[]}get(e){return this.gridOptions[e]??$M[e]}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return $e(this.gridOptions[e])}mergeGridCommonParams(e){return e&&(r=>e(this.addCommon(r)))}updateGridOptions({options:e,force:t,source:r="api"}){const n={id:_q++,properties:[]},i=[],{gridOptions:s,validation:o}=this;for(const a of Object.keys(e)){const u=ax.applyGlobalGridOption(a,e[a]);o?.warnOnInitialPropertyUpdate(r,a);const d=t||typeof u=="object"&&r==="api",h=s[a];if(d||h!==u){s[a]=u;const g={type:a,currentValue:u,previousValue:h,changeSet:n,source:r};i.push(g)}}this.validateGridOptions(this.gridOptions),n.properties=i.map(a=>a.type);for(const a of i)ec(this,`Updated property ${a.type} from`,a.previousValue," to ",a.currentValue),this.propEventSvc.dispatchEvent(a)}addPropertyEventListener(e,t){this.propEventSvc.addEventListener(e,t)}removePropertyEventListener(e,t){this.propEventSvc.removeEventListener(e,t)}getDomDataKey(){return this.domDataKey}addCommon(e){return e.api=this.api,e.context=this.gridOptionsContext,e}validateOptions(e,t){for(const r of Object.keys(e)){const n=e[r];if(n==null||n===!1)continue;let i=t[r];typeof i=="function"&&(i=i(e,this.gridOptions,this.beans)),i&&this.assertModuleRegistered(i,r)}}validateGridOptions(e){this.validateOptions(e,kq),this.validation?.processGridOptions(e)}validateColDef(e,t,r){(r||!this.beans.dataTypeSvc?.isColPendingInference(t))&&(this.validateOptions(e,vq),this.validation?.validateColDef(e))}assertModuleRegistered(e,t){const r=Array.isArray(e)?e.some(n=>this.isModuleRegistered(n)):this.isModuleRegistered(e);return r||Zt(200,{...this.getModuleErrorParams(),moduleName:e,reasonOrId:t}),r}getModuleErrorParams(){return{gridId:this.gridId,gridScoped:lx(),rowModelType:this.get("rowModelType"),isUmd:d7()}}isModuleRegistered(e){return yb(e,this.gridId,this.get("rowModelType"))}setInstanceDomData(e){e[HD]=this.instanceId}isElementInThisInstance(e){let t=e;for(;t;){const r=t[HD];if($e(r))return r===this.instanceId;t=t.parentElement}return!1}};function Oq(e){return!!kx[e]}function LL(e){const t={"aria-hidden":"true"};return{tag:"div",cls:"ag-cell-label-container",role:"presentation",children:[{tag:"span",ref:"eMenu",cls:"ag-header-icon ag-header-cell-menu-button",attrs:t},{tag:"span",ref:"eFilterButton",cls:"ag-header-icon ag-header-cell-filter-button",attrs:t},{tag:"div",ref:"eLabel",cls:"ag-header-cell-label",role:"presentation",children:[{tag:"span",ref:"eText",cls:"ag-header-cell-text"},{tag:"span",ref:"eFilter",cls:"ag-header-icon ag-header-label-icon ag-filter-icon",attrs:t},e?{tag:"ag-sort-indicator",ref:"eSortIndicator"}:null]}]}}var Nq=LL(!0),Bq=LL(!1),Hq=class extends Dr{constructor(){super(...arguments),this.eFilter=tt,this.eFilterButton=tt,this.eSortIndicator=tt,this.eMenu=tt,this.eLabel=tt,this.eText=tt,this.eSortOrder=tt,this.eSortAsc=tt,this.eSortDesc=tt,this.eSortMixed=tt,this.eSortNone=tt,this.isLoadingInnerComponent=!1}refresh(e){const t=this.params;if(this.params=e,this.workOutTemplate(e,!!this.beans?.sortSvc)!=this.currentTemplate||this.workOutShowMenu()!=this.currentShowMenu||e.enableSorting!=this.currentSort||this.currentSuppressMenuHide!=null&&this.shouldSuppressMenuHide()!=this.currentSuppressMenuHide||t.enableFilterButton!=e.enableFilterButton||t.enableFilterIcon!=e.enableFilterIcon)return!1;if(this.innerHeaderComponent){const r={...e};Wn(r,e.innerHeaderComponentParams),this.innerHeaderComponent.refresh?.(r)}else this.setDisplayName(e);return!0}workOutTemplate(e,t){const r=e.template;return r?r?.trim?r.trim():r:t?Nq:Bq}init(e){this.params=e;const{sortSvc:t,touchSvc:r,rowNumbersSvc:n,userCompFactory:i}=this.beans,s=t?.getSortIndicatorSelector();this.currentTemplate=this.workOutTemplate(e,!!s),this.setTemplate(this.currentTemplate,s?[s]:void 0),r?.setupForHeader(this),this.setMenu(),this.setupSort(),n?.setupForHeader(this),this.setupFilterIcon(),this.setupFilterButton(),this.workOutInnerHeaderComponent(i,e),this.setDisplayName(e)}workOutInnerHeaderComponent(e,t){const r=FW(e,t,t);r&&(this.isLoadingInnerComponent=!0,r.newAgStackInstance().then(n=>{this.isLoadingInnerComponent=!1,n&&(this.isAlive()?(this.innerHeaderComponent=n,this.eText&&this.eText.appendChild(n.getGui())):this.destroyBean(n))}))}setDisplayName(e){const{displayName:t}=e,r=this.currentDisplayName;this.currentDisplayName=t,!(!this.eText||r===t||this.innerHeaderComponent||this.isLoadingInnerComponent)&&(this.eText.textContent=md(t))}addInIcon(e,t,r){const n=ts(e,this.beans,r);n&&t.appendChild(n)}workOutShowMenu(){return this.params.enableMenu&&!!this.beans.menuSvc?.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return!!this.beans.menuSvc?.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu){Ua(this.eMenu),this.eMenu=void 0;return}const{gos:e,eMenu:t,params:r}=this,n=Ri(e);this.addInIcon(n?"menu":"menuAlt",t,r.column),t.classList.toggle("ag-header-menu-icon",!n);const i=this.shouldSuppressMenuHide();this.currentSuppressMenuHide=i,this.addManagedElementListeners(t,{click:()=>this.showColumnMenu(this.eMenu)}),this.toggleMenuAlwaysShow(i)}toggleMenuAlwaysShow(e){this.eMenu?.classList.toggle("ag-header-menu-always-show",e)}showColumnMenu(e){const{currentSuppressMenuHide:t,params:r}=this;t||this.toggleMenuAlwaysShow(!0),r.showColumnMenu(e,()=>{t||this.toggleMenuAlwaysShow(!1)})}onMenuKeyboardShortcut(e){const{params:t,gos:r,beans:n,eMenu:i,eFilterButton:s}=this,o=t.column,a=Ri(r);if(e&&!a){if(n.menuSvc?.isFilterMenuInHeaderEnabled(o))return t.showFilter(s??i??this.getGui()),!0}else if(t.enableMenu)return this.showColumnMenu(i??s??this.getGui()),!0;return!1}setupSort(){const{sortSvc:e}=this.beans;if(!e)return;const{enableSorting:t,column:r}=this.params;if(this.currentSort=t,!this.eSortIndicator){this.eSortIndicator=this.createBean(e.createSortIndicator(!0));const{eSortIndicator:n,eSortOrder:i,eSortAsc:s,eSortDesc:o,eSortMixed:a,eSortNone:u}=this;n.attachCustomElements(i,s,o,a,u)}this.eSortIndicator.setupSort(r),this.currentSort&&e.setupHeader(this,r,this.eLabel)}setupFilterIcon(){const{eFilter:e,params:t}=this;if(!e)return;const r=()=>{const n=t.column.isFilterActive();Er(e,n,{skipAriaHidden:!0})};this.configureFilter(t.enableFilterIcon,e,r,"filterActive")}setupFilterButton(){const{eFilterButton:e,params:t}=this;if(!e)return;this.configureFilter(t.enableFilterButton,e,this.onFilterChangedButton.bind(this),"filter")?this.addManagedElementListeners(e,{click:()=>t.showFilter(e)}):this.eFilterButton=void 0}configureFilter(e,t,r,n){if(!e)return Ua(t),!1;const i=this.params.column;return this.addInIcon(n,t,i),this.addManagedListeners(i,{filterChanged:r}),r(),!0}onFilterChangedButton(){const e=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",e)}getAnchorElementForMenu(e){const{eFilterButton:t,eMenu:r}=this;return e?t??r??this.getGui():r??t??this.getGui()}destroy(){super.destroy(),this.innerHeaderComponent&&(this.destroyBean(this.innerHeaderComponent),this.innerHeaderComponent=void 0)}},Gq={tag:"div",cls:"ag-header-group-cell-label",role:"presentation",children:[{tag:"span",ref:"agLabel",cls:"ag-header-group-text",role:"presentation"},{tag:"span",ref:"agOpened",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"},{tag:"span",ref:"agClosed",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"}]},Vq=class extends Dr{constructor(){super(Gq),this.agOpened=tt,this.agClosed=tt,this.agLabel=tt,this.isLoadingInnerComponent=!1}init(e){const{userCompFactory:t,touchSvc:r}=this.beans;this.params=e,this.checkWarnings(),this.workOutInnerHeaderGroupComponent(t,e),this.setupLabel(e),this.addGroupExpandIcon(e),this.setupExpandIcons(),r?.setupForHeaderGroup(this)}checkWarnings(){this.params.template&&Me(89)}workOutInnerHeaderGroupComponent(e,t){const r=AW(e,t,t);r&&(this.isLoadingInnerComponent=!0,r.newAgStackInstance().then(n=>{this.isLoadingInnerComponent=!1,n&&(this.isAlive()?(this.innerHeaderGroupComponent=n,this.agLabel.appendChild(n.getGui())):this.destroyBean(n))}))}setupExpandIcons(){const{agOpened:e,agClosed:t,params:{columnGroup:r},beans:n}=this;this.addInIcon("columnGroupOpened",e),this.addInIcon("columnGroupClosed",t);const i=u=>{if(zo(u))return;const d=!r.isExpanded();n.colGroupSvc.setColumnGroupOpened(r.getProvidedColumnGroup(),d,"uiColumnExpanded")};this.addTouchAndClickListeners(n,t,i),this.addTouchAndClickListeners(n,e,i);const s=u=>{nc(u)};this.addManagedElementListeners(t,{dblclick:s}),this.addManagedElementListeners(e,{dblclick:s}),this.addManagedElementListeners(this.getGui(),{dblclick:i}),this.updateIconVisibility();const o=r.getProvidedColumnGroup(),a=this.updateIconVisibility.bind(this);this.addManagedListeners(o,{expandedChanged:a,expandableChanged:a})}addTouchAndClickListeners(e,t,r){e.touchSvc?.setupForHeaderGroupElement(this,t,r),this.addManagedElementListeners(t,{click:r})}updateIconVisibility(){const{agOpened:e,agClosed:t,params:{columnGroup:r}}=this;if(r.isExpandable()){const n=r.isExpanded();Er(e,n),Er(t,!n)}else Er(e,!1),Er(t,!1)}addInIcon(e,t){const r=ts(e,this.beans,null);r&&t.appendChild(r)}addGroupExpandIcon(e){if(!e.columnGroup.isExpandable()){const{agOpened:t,agClosed:r}=this;Er(t,!1),Er(r,!1)}}setupLabel(e){const{displayName:t,columnGroup:r}=e,n=this.innerHeaderGroupComponent||this.isLoadingInnerComponent;$e(t)&&!n&&(this.agLabel.textContent=md(t)),this.toggleCss("ag-sticky-label",!r.getColGroupDef()?.suppressStickyLabel)}destroy(){super.destroy(),this.innerHeaderGroupComponent&&(this.destroyBean(this.innerHeaderGroupComponent),this.innerHeaderGroupComponent=void 0)}},zq={moduleName:"ColumnHeaderComp",version:Ue,userComponents:{agColumnHeader:Hq},icons:{menu:"menu",menuAlt:"menu-alt"}},Wq={moduleName:"ColumnGroupHeaderComp",version:Ue,userComponents:{agColumnGroupHeader:Vq},icons:{columnGroupOpened:"expanded",columnGroupClosed:"contracted"}},Uq=class extends Ee{constructor(){super(...arguments),this.beanName="animationFrameSvc",this.p1={list:[],sorted:!1},this.p2={list:[],sorted:!1},this.f1={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastScrollTop=0,this.taskCount=0}setScrollTop(e){this.scrollGoingDown=e>=this.lastScrollTop,e===0&&(this.scrollGoingDown=!0),this.lastScrollTop=e}postConstruct(){this.active=!this.gos.get("suppressAnimationFrame"),this.batchFrameworkComps=this.beans.frameworkOverrides.batchFrameworkComps}verify(){this.active===!1&&Me(92)}createTask(e,t,r,n,i=!1){this.verify();let s=r;n&&this.batchFrameworkComps&&(s="f1");const o={task:e,index:t,createOrder:++this.taskCount,deferred:i};this.addTaskToList(this[s],o),this.schedule()}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;const t=this.scrollGoingDown?1:-1;e.list.sort((r,n)=>r.deferred!==n.deferred?r.deferred?-1:1:r.index!==n.index?t*(n.index-r.index):n.createOrder-r.createOrder),e.sorted=!0}addDestroyTask(e){this.verify(),this.destroyTasks.push(e),this.schedule()}executeFrame(e){const{p1:t,p2:r,f1:n,destroyTasks:i,beans:s}=this,{ctrlsSvc:o,frameworkOverrides:a}=s,u=t.list,d=r.list,h=n.list,g=Date.now();let m=0;const v=e<=0,w=o.getScrollFeature();for(;v||m<e;){if(!w.scrollGridIfNeeded()){let b;if(u.length)this.sortTaskList(t),b=u.pop().task;else if(d.length)this.sortTaskList(r),b=d.pop().task;else if(h.length)a.wrapOutgoing(()=>{for(;(v||m<e)&&!w.scrollGridIfNeeded();){if(h.length)this.sortTaskList(n),b=h.pop().task,b();else break;m=Date.now()-g}}),b=()=>{};else if(i.length)b=i.pop();else break;b()}m=Date.now()-g}u.length||d.length||h.length||i.length?this.requestFrame():this.ticking=!1}flushAllFrames(){this.active&&this.executeFrame(-1)}schedule(){this.active&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){const e=this.executeFrame.bind(this,60);Jo(this.beans,e)}isQueueEmpty(){return!this.ticking}},$q={moduleName:"AnimationFrame",version:Ue,beans:[Uq]},jq=class extends Ee{constructor(){super(...arguments),this.beanName="iconSvc"}createIconNoSpan(e,t){return ts(e,this.beans,t?.column)}},Yq=class extends Ee{constructor(){super(...arguments),this.beanName="touchSvc"}mockBodyContextMenu(e,t){this.mockContextMenu(e,e.eBodyViewport,t)}mockHeaderContextMenu(e,t){this.mockContextMenu(e,e.eGui,t)}mockRowContextMenu(e){if(!Wl())return;const t=(r,n,i)=>{const{rowCtrl:s,cellCtrl:o}=e.getControlsForEventTarget(i?.target??null);o?.column&&o.dispatchCellContextMenuEvent(i??null),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(void 0,i,s,o)};this.mockContextMenu(e,e.element,t)}handleCellDoubleClick(e,t){return(()=>{if(!Wl()||GM("dblclick"))return!1;const n=Date.now(),i=n-e.lastIPadMouseClickEvent<200;return e.lastIPadMouseClickEvent=n,i})()?(e.onCellDoubleClicked(t),t.preventDefault(),!0):!1}setupForHeader(e){const{gos:t,sortSvc:r,menuSvc:n}=this.beans;if(t.get("suppressTouch"))return;const{params:i,eMenu:s,eFilterButton:o}=e,a=new Pl(e.getGui(),!0);e.addDestroyFunc(()=>a.destroy());const u=e.shouldSuppressMenuHide(),d=u&&$e(s)&&i.enableMenu;let h=a;if(d&&(h=new Pl(s,!0),e.addDestroyFunc(()=>h.destroy())),i.enableMenu||n?.isHeaderContextMenuEnabled(i.column)){const g=d?"tap":"longTap",m=v=>i.showColumnMenuAfterMouseClick(v.touchStart);e.addManagedListeners(h,{[g]:m}),e.addManagedListeners(a,{longTap:m})}if(i.enableSorting){const g=m=>{const v=m.touchStart.target;u&&(s?.contains(v)||o?.contains(v))||r?.progressSort(i.column,!1,"uiColumnSorted")};e.addManagedListeners(a,{tap:g})}if(i.enableFilterButton&&o){const g=new Pl(o,!0);e.addManagedListeners(g,{tap:()=>i.showFilter(o)}),e.addDestroyFunc(()=>g.destroy())}}setupForHeaderGroup(e){const t=e.params;if(this.beans.menuSvc?.isHeaderContextMenuEnabled(t.columnGroup.getProvidedColumnGroup())){const r=new Pl(t.eGridHeader,!0),n=i=>t.showColumnMenuAfterMouseClick(i.touchStart);e.addManagedListeners(r,{longTap:n}),e.addDestroyFunc(()=>r.destroy())}}setupForHeaderGroupElement(e,t,r){const n=new Pl(t,!0);e.addManagedListeners(n,{tap:r}),e.addDestroyFunc(()=>n.destroy())}mockContextMenu(e,t,r){if(!Wl())return;const n=new Pl(t),i=s=>{cf(this.beans,s.touchEvent)&&r(void 0,s.touchStart,s.touchEvent)};e.addManagedListeners(n,{longTap:i}),e.addDestroyFunc(()=>n.destroy())}},Kq={moduleName:"Touch",version:Ue,beans:[Yq]},qq=class extends Ee{constructor(){super(...arguments),this.beanName="cellNavigation"}wireBeans(e){this.rowSpanSvc=e.rowSpanSvc}getNextCellToFocus(e,t,r=!1){return r?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){const r=e===me.UP,n=e===me.DOWN,i=e===me.LEFT;let s,o;const{pageBounds:a,gos:u,visibleCols:d,pinnedRowModel:h}=this.beans,{rowPinned:g}=t;if(r||n)g&&h?r?o=0:o=g==="top"?h.getPinnedTopRowCount()-1:h.getPinnedBottomRowCount()-1:o=r?a.getFirstRow():a.getLastRow(),s=t.column;else{const m=u.get("enableRtl");o=t.rowIndex,s=(i!==m?d.allCols:[...d.allCols].reverse()).find(w=>this.isCellGoodToFocusOn({rowIndex:o,rowPinned:null,column:w}))}return s?{rowIndex:o,rowPinned:g,column:s}:null}getNextCellToFocusWithoutCtrlPressed(e,t){let r=t,n=!1;for(;!n;){switch(e){case me.UP:r=this.getCellAbove(r);break;case me.DOWN:r=this.getCellBelow(r);break;case me.RIGHT:r=this.gos.get("enableRtl")?this.getCellToLeft(r):this.getCellToRight(r);break;case me.LEFT:r=this.gos.get("enableRtl")?this.getCellToRight(r):this.getCellToLeft(r);break;default:r=null,Me(8,{key:e});break}r?n=this.isCellGoodToFocusOn(r):n=!0}return r}isCellGoodToFocusOn(e){const t=e.column;let r;const{pinnedRowModel:n,rowModel:i}=this.beans;switch(e.rowPinned){case"top":r=n?.getPinnedTopRow(e.rowIndex);break;case"bottom":r=n?.getPinnedBottomRow(e.rowIndex);break;default:r=i.getRow(e.rowIndex);break}return r?!this.isSuppressNavigable(t,r):!1}getCellToLeft(e){if(!e)return null;const t=this.beans.visibleCols.getColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;const t=this.beans.visibleCols.getColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellBelow(e){if(!e)return null;const t=this.rowSpanSvc?.getCellEnd(e)??e,r=RD(this.beans,t,!0);return r?{rowIndex:r.rowIndex,column:e.column,rowPinned:r.rowPinned}:null}getCellAbove(e){if(!e)return null;const t=this.rowSpanSvc?.getCellStart(e)??e,r=z0(this.beans,{rowIndex:t.rowIndex,rowPinned:t.rowPinned},!0);return r?{rowIndex:r.rowIndex,column:e.column,rowPinned:r.rowPinned}:null}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){const{visibleCols:t,pagination:r}=this.beans,n=t.allCols;let i=e.rowIndex,s=e.rowPinned,o=t.getColAfter(e.column);if(!o){o=n[0];const a=RD(this.beans,e,!0);if(xr(a)||!a.rowPinned&&!(r?.isRowInPage(a.rowIndex)??!0))return null;i=a?a.rowIndex:null,s=a?a.rowPinned:null}return{rowIndex:i,column:o,rowPinned:s}}getNextTabbedCellBackwards(e){const{beans:t}=this,{visibleCols:r,pagination:n}=t,i=r.allCols;let s=e.rowIndex,o=e.rowPinned,a=r.getColBefore(e.column);if(!a){a=ir(i);const u=z0(t,{rowIndex:e.rowIndex,rowPinned:e.rowPinned},!0);if(xr(u)||!u.rowPinned&&!(n?.isRowInPage(u.rowIndex)??!0))return null;s=u?u.rowIndex:null,o=u?u.rowPinned:null}return{rowIndex:s,column:a,rowPinned:o}}isSuppressNavigable(e,t){const{suppressNavigable:r}=e.colDef;if(typeof r=="boolean")return r;if(typeof r=="function"){const n=e.createColumnFunctionCallbackParams(t);return r(n)}return!1}};function Xq(e){return e.focusSvc.getFocusedCell()}function Qq(e){return e.focusSvc.clearFocusedCell()}function Zq(e,t,r,n){e.focusSvc.setFocusedCell({rowIndex:t,column:r,rowPinned:n,forceBrowserFocus:!0})}function Jq(e,t){return e.navigation?.tabToNextCell(!1,t)??!1}function eX(e,t){return e.navigation?.tabToNextCell(!0,t)??!1}function tX(e,t,r=!1){const n=e.headerNavigation?.getHeaderPositionForColumn(t,r);n&&e.focusSvc.focusHeaderPosition({headerPosition:n})}var rX=class extends Ee{constructor(){super(...arguments),this.beanName="editModelSvc",this.edits=new Map,this.cellValidations=new IL,this.rowValidations=new OL,this.suspendEdits=!1}suspend(e){this.suspendEdits=e}removeEdits({rowNode:e,column:t}){if(!this.hasEdits({rowNode:e})||!e)return;const r=this.getEditRow(e);t?r.delete(t):r.clear(),r.size===0&&this.edits.delete(e)}getEditRow(e,t={}){if(this.suspendEdits||this.edits.size===0)return;const r=e&&this.edits.get(e);if(r)return r;if(t.checkSiblings){const n=e.pinnedSibling;if(n)return this.getEditRow(n)}}getEditRowDataValue(e,{checkSiblings:t}={}){if(!e||this.edits.size===0)return;const r=this.getEditRow(e),n=e.pinnedSibling,i=t&&n&&this.getEditRow(n);if(!r&&!i)return;const s=Object.assign({},e.data),o=(a,u)=>a.forEach(({pendingValue:d},h)=>{d!==is&&(u[h.getColId()]=d)});return r&&o(r,s),i&&o(i,s),s}getEdit(e,t){const r=this._getEdit(e);return t&&r?{...r}:r}_getEdit(e){if(!this.suspendEdits&&this.edits.size!==0)return e.rowNode&&e.column&&this.getEditRow(e.rowNode)?.get(e.column)}getEditMap(e=!0){if(this.suspendEdits||this.edits.size===0)return new Map;if(!e)return this.edits;const t=new Map;return this.edits.forEach((r,n)=>{const i=new Map;r.forEach(({editorState:s,...o},a)=>i.set(a,{...o})),t.set(n,i)}),t}setEditMap(e){this.edits.clear(),e.forEach((t,r)=>{const n=new Map;t.forEach((i,s)=>n.set(s,{...i})),this.edits.set(r,n)})}setEdit(e,t){(this.edits.size===0||!this.edits.has(e.rowNode))&&this.edits.set(e.rowNode,new Map);const r=this._getEdit(e),n=Object.assign({editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0},...r,...t});return this.getEditRow(e.rowNode).set(e.column,n),n}clearEditValue(e){const{rowNode:t,column:r}=e;if(t)if(r){const n=this._getEdit(e);n&&(n.editorValue=void 0,n.pendingValue=n.sourceValue,n.state="changed")}else this.getEditRow(t)?.forEach(n=>{n.editorValue=void 0,n.pendingValue=n.sourceValue,n.state="changed"})}getState(e){if(!this.suspendEdits)return this.getEdit(e)?.state}getEditPositions(e){if(this.suspendEdits||(e??this.edits).size===0)return[];const t=[];return(e??this.edits).forEach((r,n)=>{for(const i of r.keys()){const{editorState:s,...o}=r.get(i);t.push({rowNode:n,column:i,...o})}}),t}hasRowEdits(e,t){return this.suspendEdits||this.edits.size===0?!1:!!this.getEditRow(e,t)}hasEdits(e={},t={}){if(this.suspendEdits||this.edits.size===0)return!1;const{rowNode:r,column:n}=e,{withOpenEditor:i}=t;if(r){const s=this.getEditRow(r,t);return s?n?i?this.getEdit(e)?.state==="editing":s.has(n)??!1:s.size!==0?i?Array.from(s.values()).some(({state:o})=>o==="editing"):!0:!1:!1}return i?this.getEditPositions().some(({state:s})=>s==="editing"):this.edits.size>0}start(e){const t=this.getEditRow(e.rowNode)??new Map,{rowNode:r,column:n}=e;n&&!t.has(n)&&t.set(n,{editorValue:void 0,pendingValue:is,sourceValue:this.beans.valueSvc.getValue(n,r,!1,"api"),state:"editing",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}}),this.edits.set(r,t)}stop(e){this.hasEdits(e)&&(e?this.removeEdits(e):this.clear())}clear(){for(const e of this.edits.values())e.clear();this.edits.clear()}getCellValidationModel(){return this.cellValidations}getRowValidationModel(){return this.rowValidations}setCellValidationModel(e){this.cellValidations=e}setRowValidationModel(e){this.rowValidations=e}destroy(){super.destroy(),this.clear()}},IL=class{constructor(){this.cellValidations=new Map}getCellValidation(e){const{rowNode:t,column:r}=e||{};return this.cellValidations?.get(t)?.get(r)}hasCellValidation(e){return!e?.rowNode||!e.column?this.cellValidations.size>0:!!this.getCellValidation(e)}setCellValidation(e,t){const{rowNode:r,column:n}=e;this.cellValidations.has(r)||this.cellValidations.set(r,new Map),this.cellValidations.get(r).set(n,t)}clearCellValidation(e){const{rowNode:t,column:r}=e;this.cellValidations.get(t)?.delete(r)}setCellValidationMap(e){this.cellValidations=e}getCellValidationMap(){return this.cellValidations}clearCellValidationMap(){this.cellValidations.clear()}},OL=class{constructor(){this.rowValidations=new Map}getRowValidation(e){const{rowNode:t}=e||{};return this.rowValidations.get(t)}hasRowValidation(e){return e?.rowNode?!!this.getRowValidation(e):this.rowValidations.size>0}setRowValidation({rowNode:e},t){this.rowValidations.set(e,t)}clearRowValidation({rowNode:e}){this.rowValidations.delete(e)}setRowValidationMap(e){this.rowValidations=e}getRowValidationMap(){return this.rowValidations}clearRowValidationMap(){this.rowValidations.clear()}};function Mx(e,t={}){const{rowIndex:r,rowId:n,rowCtrl:i,rowPinned:s}=t;if(i)return i;const{rowModel:o,rowRenderer:a}=e;let{rowNode:u}=t;return u||(n?u=Tj(e,n,s):r!=null&&(u=o.getRow(r))),a.getRowCtrls(u?[u]:[])?.[0]}function Sr(e,t={}){const{cellCtrl:r,colId:n,columnId:i,column:s}=t;if(r)return r;const o=e.colModel.getCol(n??i??Wb(s)),a=t.rowCtrl??Mx(e,t),u=a?.getCellCtrl(o)??void 0;if(u)return u;const d=t.rowNode??a?.rowNode;if(d)return e.rowRenderer.getCellCtrls([d],[o])?.[0]}function GD(e){const{editSvc:t}=e;t?.isBatchEditing()?Bu(e):t?.stopEditing(void 0,{source:"api"})}function nX(e,t,r){const{gos:n,popupSvc:i}=t;if(!n.get("stopEditingWhenCellsLoseFocus"))return;const s=o=>{const a=o.relatedTarget;if(Db(a)===null){GD(t);return}let u=r.some(d=>d.contains(a))&&n.isElementInThisInstance(a);u||(u=!!i&&(i.getActivePopups().some(d=>d.contains(a))||i.isElementWithinCustomPopup(a))),u||GD(t)};for(const o of r)e.addManagedElementListeners(o,{focusout:s})}function Wb(e){if(e)return typeof e=="string"?e:e.getColId()}var is=Symbol("unedited");function NL(e,t={}){const r=[],n=e.rowRenderer.getCellCtrls(t.rowNodes,t.columns);for(const i of n){const s=i.comp?.getCellEditor();s&&r.push({ctrl:i,editor:hf(s)})}return r}var iX=(e,t={})=>NL(e,t).map(r=>r.editor);function sX(e,t,r,n,i,s){t.length===0&&r?.rowNode&&r?.column&&rd(e,r,{key:n,event:i,cellStartedEdit:s});const{valueSvc:o,editSvc:a,editModelSvc:u}=e,{rowNode:d,column:h}=r??{};for(const g of t){const{rowNode:m,column:v}=g,w=Sr(e,g);if(!w){if(m&&v){const b=o.getValue(v,m,void 0,"api"),E=(r?.rowNode===m&&r?.column===v&&n||void 0)??a?.getCellDataValue(g,!1)??o.getValueForDisplay(v,m)?.value??b??is;u?.setEdit(g,{pendingValue:E,sourceValue:b,state:"editing"})}continue}const C=s&&d===w.rowNode&&w.column===h;rd(e,{rowNode:d,column:w.column},{key:C?n:null,event:C?i:null,cellStartedEdit:C&&s})}}function Oo({pendingValue:e,sourceValue:t}){return e===is&&(e=t),e!==t}function rd(e,t,r){const n=e.gos.get("enableGroupEdit"),{key:i,event:s,cellStartedEdit:o,silent:a}=r??{},u=Sr(e,t),d=u?.comp?.getCellEditor(),h=HL(e,t,i,o&&!a),g=e.editModelSvc?.getEdit(t);let m=h.value;if(m===void 0&&(m=g?.sourceValue),e.editModelSvc?.setEdit(t,{editorValue:m,state:"editing"}),d){d.refresh?.(h);return}const v=t.column.getColDef(),w=E_(e.userCompFactory,v,h),C=w?.popupFromSelector!=null?w.popupFromSelector:!!v.cellEditorPopup,b=w?.popupPositionFromSelector!=null?w.popupPositionFromSelector:v.cellEditorPopupPosition;if(GL(w.params,s),u){u.editCompDetails=w,u.onEditorAttachedFuncs.push(()=>u.rangeFeature?.unsetComp()),u.comp?.setEditDetails(w,C,b,e.gos.get("reactiveCustomComponents")),u?.rowCtrl?.refreshRow({suppressFlash:!0});const x=e.editModelSvc?.getEdit(t,!0);!a&&!x?.editorState?.cellStartedEditing&&(e.editSvc?.dispatchCellEvent(t,s,"cellEditingStarted",n?{value:m}:{}),e.editModelSvc?.setEdit(t,{editorState:{cellStartedEditing:!0}}))}}function BL(e,t,r){const n={editorValueExists:!1};if(_x(e)&&(t.getValidationErrors?.()?.length??0)>0||r?.isCancelling)return n;if(r?.isStopping){const s=t?.isCancelAfterEnd?.();if(s)return{...n,isCancelAfterEnd:s}}return{editorValue:t.getValue(),editorValueExists:!0}}function HL(e,t,r,n){const{valueSvc:i,gos:s,editSvc:o}=e,a=e.gos.get("enableGroupEdit"),u=Sr(e,t),d=t.rowNode?.rowIndex??void 0,h=o?.isBatchEditing(),g=e.colModel.getCol(t.column.getId()),{rowNode:m,column:v}=t,w=u.comp?.getCellEditor(),C=o?.getCellDataValue(t,!1),b=C===void 0?w?BL(e,w)?.editorValue:void 0:C,x=b===is?i.getValueForDisplay(g,m)?.value:b;return it(s,{value:a?b:x,eventKey:r??null,column:v,colDef:v.getColDef(),rowIndex:d,node:m,data:m.data,cellStartedEdit:n??!1,onKeyDown:u?.onKeyDown.bind(u),stopEditing:R=>{o.stopEditing(t,{source:h?"ui":"api",suppressNavigateAfterEdit:R}),W0(e,t)},eGridCell:u?.eGui,parseValue:R=>i.parseValue(g,m,R,u?.value),formatValue:u?.formatValue.bind(u),validate:()=>{o?.validateEdit()}})}function Ub(e,t){const{editModelSvc:r}=e;r?.getEditMap().forEach((n,i)=>{n.forEach((s,o)=>{!t&&(s.state==="editing"||s.pendingValue===is)||!Oo(s)&&(s.state!=="editing"||t)&&r?.removeEdits({rowNode:i,column:o})})})}function oX(e,t){const r=t.comp?.getCellEditor();if(!r?.refresh)return;const{eventKey:n,cellStartedEdit:i}=t.editCompDetails.params,{column:s}=t,o=HL(e,t,n,i),a=s.getColDef(),u=E_(e.userCompFactory,a,o);r.refresh(GL(u.params,n))}function GL(e,t){return t instanceof KeyboardEvent&&e.column.getColDef().cellEditor==="agNumberCellEditor"?e.suppressPreventDefault=["-","+",".","e"].includes(t?.key??"")||e.suppressPreventDefault:t?.preventDefault?.(),e}function Ol(e,t){for(const r of e.editModelSvc?.getEditPositions()??[]){const n=Sr(e,r);if(!n)continue;const i=n.comp?.getCellEditor();if(!i)continue;const{editorValue:s,editorValueExists:o,isCancelAfterEnd:a}=BL(e,i,t);a&&e.editModelSvc?.setEdit(r,{editorState:{isCancelAfterEnd:a}}),h0(e,r,s,void 0,!o,t)}}function h0(e,t,r,n,i,s){const{editModelSvc:o,valueSvc:a}=e;if(!o)return;const{rowNode:u,column:d}=t;if(!(u&&d))return;let h=o.getEdit(t,!0);h?.sourceValue||(h=o.setEdit(t,{sourceValue:a.getValue(d,u,void 0,"api"),pendingValue:h?h.editorValue:is})),o.setEdit(t,{editorValue:i?h.sourceValue:r}),s?.persist&&aX(e,t)}function aX(e,t){const{editModelSvc:r}=e,n=r?.getEdit(t,!0);r?.setEdit(t,{pendingValue:n?.editorValue})}function Bu(e,t,r){t||(t=e.editModelSvc?.getEditPositions());for(const n of t??[])W0(e,n,r)}function W0(e,t,r){const n=e.gos.get("enableGroupEdit"),{editModelSvc:i}=e,s=Sr(e,t),o=i?.getEdit(t,!0);if(!s){o&&i?.setEdit(t,{state:"changed"});return}const{comp:a}=s;if(a&&!a.getCellEditor()){if(s?.refreshCell(),o){i?.setEdit(t,{state:"changed"});const d=n?VD(r,o):{valueChanged:!1,newValue:void 0,oldValue:o.sourceValue};zD(e,t,d,r)}return}if(_x(e)){const d=a?.getCellEditor()?.getValidationErrors?.(),h=i?.getCellValidationModel();d?.length?h?.setCellValidation(t,{errorMessages:d}):h?.clearCellValidation(t)}i?.setEdit(t,{state:"changed"}),a?.setEditDetails(),a?.refreshEditStyles(!1,!1),s?.refreshCell({force:!0,suppressFlash:!0});const u=i?.getEdit(t);if(u&&u.state==="changed"){const d=n?VD(r,u):{valueChanged:Oo(u)&&!r?.cancel,newValue:r?.cancel||u.editorState.isCancelAfterEnd?void 0:u?.editorValue??o?.pendingValue,oldValue:u?.sourceValue};zD(e,t,d,r)}}function VD(e,t){return e?.cancel?{valueChanged:!1,oldValue:t.sourceValue,newValue:void 0,value:t.sourceValue}:{valueChanged:!1,oldValue:t.sourceValue,newValue:t.pendingValue,value:t.sourceValue}}function zD(e,t,r,{silent:n,event:i}={}){const{editSvc:s,editModelSvc:o}=e,a=o?.getEdit(t),{editorState:u}=a||{},{isCancelBeforeStart:d}=u||{};!n&&!d&&(s?.dispatchCellEvent(t,i,"cellEditingStopped",r),o?.setEdit(t,{editorState:{cellStoppedEditing:!0}}))}function _x(e){const{gos:t,colModel:r}=e,n=!!t.get("getFullRowEditValidationErrors"),i=r.getColumnDefs()?.filter(o=>o.editable).some(({cellEditorParams:o})=>{const{minLength:a,maxLength:u,getValidationErrors:d,min:h,max:g}=o||{};return a!==void 0||u!==void 0||d!==void 0||h!==void 0||g!==void 0}),s=e.gridApi.getCellEditorInstances().some(o=>o.getValidationElement||o.getValidationErrors);return i||n||s}function ic(e,t){if(!(t||_x(e)))return;const r=NL(e),n=new IL,{ariaAnnounce:i,localeSvc:s,editModelSvc:o,gos:a}=e,u=a.get("editType")==="fullRow",h=zM(s)("ariaValidationErrorPrefix","Cell Editor Validation");for(const m of r){const{ctrl:v,editor:w}=m,{rowNode:C,column:b}=v,x=w.getValidationErrors?.()??[],R=w.getValidationElement?.(!1)||!w.isPopup?.()&&v.eGui;if(R){const E=x!=null&&x.length>0,A=E?x.join(". "):"";Rz(R,E),E&&i.announceValue(`${h} ${x}`,"editorValidation"),R instanceof HTMLInputElement?R.setCustomValidity(A):R.classList.toggle("invalid",E)}x?.length>0&&n.setCellValidation({rowNode:C,column:b},{errorMessages:x})}Ol(e,{persist:!1}),o?.setCellValidationModel(n);const g=new Set;for(const{ctrl:m}of r)g.add(m.rowCtrl);if(u){const m=lX(e);o?.setRowValidationModel(m)}for(const m of g.values()){m.rowEditStyleFeature?.applyRowStyles();for(const v of m.getAllCellCtrls())v.tooltipFeature?.refreshTooltip(!0),v.editorTooltipFeature?.refreshTooltip(!0),v.editStyleFeature?.applyCellStyles?.()}}var lX=e=>{const t=new OL,r=e.gos.get("getFullRowEditValidationErrors"),n=e.editModelSvc?.getEditMap();if(!n)return t;for(const i of n.keys()){const s=n.get(i);if(!s)continue;const o=[],{rowIndex:a,rowPinned:u}=i;for(const h of s.keys()){const g=s.get(h);if(!g)continue;const{editorValue:m,pendingValue:v,sourceValue:w}=g,C=m??(v===is?void 0:v)??w;o.push({column:h,colId:h.getColId(),rowIndex:a,rowPinned:u,oldValue:w,newValue:C})}const d=r?.({editorsState:o})??[];d.length>0&&t.setRowValidation({rowNode:i},{errorMessages:d})}return t};function cX(e){ic(e,!0);const t=e.editModelSvc?.getCellValidationModel().getCellValidationMap();if(!t)return null;const r=[];return t.forEach((n,i)=>{n.forEach(({errorMessages:s},o)=>{r.push({column:o,rowIndex:i.rowIndex,rowPinned:i.rowPinned,messages:s??null})})}),r}function uX(e,t,r,{rowNode:n,column:i},s){return it(e.gos,{type:r,node:n,data:n.data,value:s,column:i,colDef:i.getColDef(),rowPinned:n.rowPinned,event:t,rowIndex:n.rowIndex})}function dX(e,t=!1){return e===me.DELETE?!0:!t&&e===me.BACKSPACE?F_():!1}var hX=class extends Ee{constructor(e,t,r,n){super(),this.cellCtrl=e,this.rowNode=r,this.rowCtrl=n,this.beans=t}init(){this.eGui=this.cellCtrl.eGui}onKeyDown(e){const t=e.key;switch(t){case me.ENTER:this.onEnterKeyDown(e);break;case me.F2:this.onF2KeyDown(e);break;case me.ESCAPE:this.onEscapeKeyDown(e);break;case me.TAB:this.onTabKeyDown(e);break;case me.BACKSPACE:case me.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case me.DOWN:case me.UP:case me.RIGHT:case me.LEFT:this.onNavigationKeyDown(e,t);break}}onNavigationKeyDown(e,t){const{cellCtrl:r,beans:n}=this;if(!n.editSvc?.isEditing(r,{withOpenEditor:!0})){if(e.shiftKey&&r.isRangeSelectionEnabled())this.onShiftRangeSelect(e);else{const i=r.getFocusedCellPosition();n.navigation?.navigateToNextCell(e,t,i,!0)}e.preventDefault()}}onShiftRangeSelect(e){const{rangeSvc:t,navigation:r}=this.beans;if(!t)return;const n=t.extendLatestRangeInDirection(e);n&&(e.key===me.LEFT||e.key===me.RIGHT?r?.ensureColumnVisible(n.column):r?.ensureRowVisible(n.rowIndex))}onTabKeyDown(e){this.beans.navigation?.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){const{cellCtrl:r,beans:n,rowNode:i}=this,{gos:s,rangeSvc:o,eventSvc:a,editSvc:u}=n;if(a.dispatchEvent({type:"keyShortcutChangedCellStart"}),dX(e,s.get("enableCellEditingOnBackspace"))&&!u?.isEditing(r,{withOpenEditor:!0})){if(o&&ja(s))o.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(r.isCellEditable()){const{column:d}=r,h=this.beans.valueSvc.getDeleteValue(d,i);i.setDataValue(d,h,"cellClear")}}else u?.isEditing(r,{withOpenEditor:!0})||n.editSvc?.startEditing(r,{startedEdit:!0,event:t});a.dispatchEvent({type:"keyShortcutChangedCellEnd"})}onEnterKeyDown(e){const{cellCtrl:t,beans:r}=this,{editSvc:n,navigation:i}=r,s=n?.isEditing(t,{withOpenEditor:!0}),o=t.rowNode,a=n?.isRowEditing(o,{withOpenEditor:!0}),u=d=>{n?.startEditing(d,{startedEdit:!0,event:e,source:"edit"})&&e.preventDefault()};if(s||a){if(this.isCtrlEnter(e)){n?.applyBulkEdit(t,r?.rangeSvc?.getCellRanges()||[]);return}if(ic(r),n?.checkNavWithValidation(void 0,e)==="block-stop")return;n?.isEditing(t,{withOpenEditor:!0})?n?.stopEditing(t,{event:e,source:"edit"}):a&&!t.isCellEditable()?n?.stopEditing({rowNode:o},{event:e,source:"edit"}):u(t)}else if(r.gos.get("enterNavigatesVertically")){const d=e.shiftKey?me.UP:me.DOWN;i?.navigateToNextCell(null,d,t.cellPosition,!1)}else{if(n?.hasValidationErrors())return;n?.hasValidationErrors(t)&&n.revertSingleCellEdit(t,!0),u(t)}}isCtrlEnter(e){return(e.ctrlKey||e.metaKey)&&e.key===me.ENTER}onF2KeyDown(e){const{cellCtrl:t,beans:{editSvc:r}}=this;r?.isEditing()&&(ic(this.beans),r?.checkNavWithValidation(void 0,e)==="block-stop")||r?.startEditing(t,{startedEdit:!0,event:e})}onEscapeKeyDown(e){const{cellCtrl:t,beans:{editSvc:r}}=this;r?.checkNavWithValidation(t,e)==="block-stop"&&r.revertSingleCellEdit(t),r?.stopEditing(t,{event:e,cancel:!0})}processCharacter(e){const r=e.target!==this.eGui,{beans:{editSvc:n},cellCtrl:i}=this;if(r||n?.isEditing(i,{withOpenEditor:!0}))return;if(e.key===me.SPACE)this.onSpaceKeyDown(e);else if(n?.isCellEditable(i,"ui")){if(n?.hasValidationErrors()&&!n?.hasValidationErrors(i))return;n?.startEditing(i,{startedEdit:!0,event:e,source:"api"}),!i.editCompDetails?.params?.suppressPreventDefault&&e.preventDefault()}}onSpaceKeyDown(e){const{gos:t,editSvc:r}=this.beans,{rowNode:n}=this.cellCtrl;!r?.isEditing(this.cellCtrl,{withOpenEditor:!0})&&Vl(t)&&this.beans.selectionSvc?.handleSelectionEvent(e,n,"spaceKey"),e.preventDefault()}},fX=class extends Ee{constructor(e,t,r){super(),this.cellCtrl=e,this.column=r,this.beans=t}onMouseEvent(e,t){if(!zo(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t);break}}onCellClicked(e){if(this.beans.touchSvc?.handleCellDoubleClick(this,e))return;const{eventSvc:t,rangeSvc:r,editSvc:n,editModelSvc:i,frameworkOverrides:s,gos:o}=this.beans,a=e.ctrlKey||e.metaKey,{cellCtrl:u}=this,{column:d,cellPosition:h,rowNode:g}=u,m=a0(o,d,g,e);r&&a&&!m&&r.getCellRangeCount(h)>1&&r.intersectLastRange(!0);const v=u.createEvent(e,"cellClicked");v.isEventHandlingSuppressed=m,t.dispatchEvent(v);const w=d.getColDef();if(w.onCellClicked&&window.setTimeout(()=>{s.wrapOutgoing(()=>{w.onCellClicked(v)})},0),!m&&i?.getState(u)!=="editing"){const C=n?.isEditing(),b=i?.getCellValidationModel().getCellValidationMap().size??0,x=i?.getRowValidationModel().getRowValidationMap().size??0;if(C&&(b>0||x>0))return;n?.shouldStartEditing(u,e)?n?.startEditing(u,{event:e}):n?.shouldStopEditing(u,e)&&(this.beans.gos.get("editType")==="fullRow"?n?.stopEditing(u,{event:e,source:"edit"}):n?.stopEditing(void 0,{event:e,source:"edit"}))}}onCellDoubleClicked(e){const{column:t,beans:r,cellCtrl:n}=this,{eventSvc:i,frameworkOverrides:s,editSvc:o,editModelSvc:a,gos:u}=r,d=a0(u,n.column,n.rowNode,e),h=t.getColDef(),g=n.createEvent(e,"cellDoubleClicked");if(g.isEventHandlingSuppressed=d,i.dispatchEvent(g),typeof h.onCellDoubleClicked=="function"&&window.setTimeout(()=>{s.wrapOutgoing(()=>{h.onCellDoubleClicked(g)})},0),!d&&o?.shouldStartEditing(n,e)&&a?.getState(n)!=="editing"){const m=o?.isEditing(),v=a?.getCellValidationModel().getCellValidationMap().size??0,w=a?.getRowValidationModel().getRowValidationMap().size??0;if(m&&(v>0||w>0))return;o?.startEditing(n,{event:e})}}onMouseDown(e){const{ctrlKey:t,metaKey:r,shiftKey:n}=e,i=e.target,{cellCtrl:s,beans:o}=this,{eventSvc:a,rangeSvc:u,rowNumbersSvc:d,focusSvc:h,gos:g,editSvc:m}=o,{column:v,rowNode:w,cellPosition:C}=s,b=a0(g,v,w,e),x=()=>{const D=s.createEvent(e,"cellMouseDown");D.isEventHandlingSuppressed=b,a.dispatchEvent(D)};if(b){x();return}if(this.isRightClickInExistingRange(e))return;const R=u&&!u.isEmpty(),E=this.containsWidget(i),A=Go(v);if(d&&A&&!d.handleMouseDownOnCell(C,e)){u&&e.preventDefault(),e.stopImmediatePropagation();return}if(!n||!R){const D=m?.isEditing(s),F=g.get("enableCellTextSelection")&&e.defaultPrevented,O=(rl()||F)&&!D&&!Ih(i)&&!E;s.focusCell(O,e)}if(n&&R&&!h.isCellFocused(C)){e.preventDefault();const D=h.getFocusedCell();if(D){const{column:M,rowIndex:F,rowPinned:O}=D;m?.isEditing(D)&&m?.stopEditing(D),h.setFocusedCell({column:M,rowIndex:F,rowPinned:O,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,sourceEvent:e})}}if(!E){if(u){A&&e.preventDefault();const D=jF(o,e)&&A;if(n)u.extendLatestRangeToCell(C);else if(!D){const M=t||r;u.setRangeToCell(C,M)}}x()}}isRightClickInExistingRange(e){const{rangeSvc:t}=this.beans;if(t){const r=t.isCellInAnyRange(this.cellCtrl.cellPosition),n=jF(this.beans,e);if(r&&n)return!0}return!1}containsWidget(e){return Hl(e,"ag-selection-checkbox",3)||Hl(e,"ag-drag-handle",3)}onMouseOut(e){if(this.mouseStayingInsideCell(e))return;const{eventSvc:t,colHover:r}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOut")),r?.clearMouseOver()}onMouseOver(e){if(this.mouseStayingInsideCell(e))return;const{eventSvc:t,colHover:r}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOver")),r?.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;const t=this.cellCtrl.eGui,r=t.contains(e.target),n=t.contains(e.relatedTarget);return r&&n}},gX=class extends Ee{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.column,this.rowNode=e.rowNode}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListeners(this.beans.eventSvc,{newColumnsLoaded:()=>this.onNewColumnsLoaded()})}init(){this.eSetLeft=this.cellCtrl.getRootElement(),this.eContent=this.cellCtrl.eGui;const e=this.cellCtrl.getCellSpan();if(e||(this.setupColSpan(),this.setupRowSpan()),this.onLeftChanged(),this.onWidthChanged(),e||this._legacyApplyRowSpan(),e){const t=this.refreshSpanHeight.bind(this,e);t(),this.addManagedListeners(this.beans.eventSvc,{paginationChanged:t,recalculateRowBounds:t,pinnedHeightChanged:t})}}refreshSpanHeight(e){const t=e.getCellHeight();t!=null&&(this.eContent.style.height=`${t}px`)}onNewColumnsLoaded(){const e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this._legacyApplyRowSpan(!0))}onDisplayColumnsChanged(){const e=this.getColSpanningList();tl(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){this.column.getColDef().colSpan!=null&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onWidthChanged.bind(this)}))}onWidthChanged(){if(!this.eContent)return;const e=this.getCellWidth();this.eContent.style.width=`${e}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((e,t)=>e+t.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){const{column:e,rowNode:t}=this,r=e.getColSpan(t),n=[];if(r===1)n.push(e);else{let i=e;const s=e.getPinned();for(let o=0;i&&o<r&&(n.push(i),i=this.beans.visibleCols.getColAfter(i),!(!i||xr(i)||s!==i.getPinned()));o++);}return n}onLeftChanged(){if(!this.eSetLeft)return;const e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eSetLeft.style.left=e+"px"}getCellLeft(){let e;return this.beans.gos.get("enableRtl")&&this.colsSpanning?e=ir(this.colsSpanning):e=this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.printLayout||this.column.getPinned()==="left")return e;const{visibleCols:t}=this.beans,r=t.getColsLeftWidth();if(this.column.getPinned()==="right"){const n=t.bodyWidth;return r+n+(e||0)}return r+(e||0)}_legacyApplyRowSpan(e){if(this.rowSpan===1&&!e)return;const r=zl(this.beans)*this.rowSpan;this.eContent.style.height=`${r}px`,this.eContent.style.zIndex="1"}destroy(){super.destroy()}},pX="ag-cell",mX="ag-cell-auto-height",vX="ag-cell-normal-height",wX="ag-cell-focus",CX="ag-cell-first-right-pinned",yX="ag-cell-last-left-pinned",bX="ag-cell-not-inline-editing",SX="ag-cell-wrap-text",xX=0,Hu=class extends Ee{constructor(e,t,r,n){super(),this.column=e,this.rowNode=t,this.rowCtrl=n,this.rangeFeature=void 0,this.rowResizeFeature=void 0,this.positionFeature=void 0,this.customStyleFeature=void 0,this.editStyleFeature=void 0,this.mouseListener=void 0,this.keyboardListener=void 0,this.suppressRefreshCell=!1,this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.focusEventWhileNotReady=null,this.hasBeenFocused=!1,this.hasEdit=!1,this.tooltipFeature=void 0,this.editorTooltipFeature=void 0,this.beans=r,this.gos=r.gos,this.editSvc=r.editSvc,this.hasEdit=!!r.editSvc;const{colId:i}=e;this.instanceId=i+"-"+xX++,this.createCellPosition(),this.updateAndFormatValue(!1)}addFeatures(){const{beans:e}=this;this.positionFeature=new gX(this,e),this.customStyleFeature=e.cellStyles?.createCellCustomStyleFeature(this,e),this.editStyleFeature=e.editSvc?.createCellStyleFeature(this,e),this.mouseListener=new fX(this,e,this.column),this.keyboardListener=new hX(this,e,this.rowNode,this.rowCtrl),this.enableTooltipFeature();const{rangeSvc:t}=e;t&&ja(e.gos)&&(this.rangeFeature=t.createCellRangeFeature(e,this)),Go(this.column)&&(this.rowResizeFeature=this.beans.rowNumbersSvc.createRowNumbersRowResizerFeature(e,this))}isCellSpanning(){return!1}getCellSpan(){}removeFeatures(){const e=this.beans.context;this.positionFeature=e.destroyBean(this.positionFeature),this.editorTooltipFeature=e.destroyBean(this.editorTooltipFeature),this.customStyleFeature=e.destroyBean(this.customStyleFeature),this.editStyleFeature=e.destroyBean(this.editStyleFeature),this.mouseListener=e.destroyBean(this.mouseListener),this.keyboardListener=e.destroyBean(this.keyboardListener),this.rangeFeature=e.destroyBean(this.rangeFeature),this.rowResizeFeature=e.destroyBean(this.rowResizeFeature),this.disableTooltipFeature()}enableTooltipFeature(e,t){this.tooltipFeature=this.beans.tooltipSvc?.enableCellTooltipFeature(this,e,t)}disableTooltipFeature(){this.tooltipFeature=this.beans.context.destroyBean(this.tooltipFeature)}enableEditorTooltipFeature(e){this.editorTooltipFeature&&this.disableEditorTooltipFeature(),this.editorTooltipFeature=this.beans.tooltipSvc?.setupCellEditorTooltip(this,e),ic(this.beans)}disableEditorTooltipFeature(){this.editorTooltipFeature=this.beans.context.destroyBean(this.editorTooltipFeature)}setComp(e,t,r,n,i,s,o){if(this.comp=e,this.eGui=t,this.printLayout=i,o??(o=this),this.addDomData(o),this.addFeatures(),o.addDestroyFunc(()=>this.removeFeatures()),this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.setupFocus(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(n,o),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),this.positionFeature?.init(),this.customStyleFeature?.setComp(e),this.editStyleFeature?.setComp(e),this.tooltipFeature?.refreshTooltip(),this.keyboardListener?.init(),this.rangeFeature?.setComp(e),this.rowResizeFeature?.refreshRowResizer(),s&&this.isCellEditable()||this.hasEdit&&this.editSvc?.isEditing(this,{withOpenEditor:!0})?this.editSvc?.startEditing(this,{startedEdit:!1,source:"api",silent:!0,continueEditing:!0}):this.showValue(!1,!0),this.onCompAttachedFuncs.length){for(const a of this.onCompAttachedFuncs)a();this.onCompAttachedFuncs=[]}}setupAutoHeight(e,t){this.isAutoHeight=this.beans.rowAutoHeight?.setupCellAutoHeight(this,e,t)??!1}getCellAriaRole(){return this.column.getColDef().cellAriaRole??"gridcell"}isCellRenderer(){const e=this.column.getColDef();return e.cellRenderer!=null||e.cellRendererSelector!=null}getValueToDisplay(){return this.valueFormatted??this.value}getDeferLoadingCellRenderer(){const{beans:e,column:t}=this,{userCompFactory:r,ctrlsSvc:n,eventSvc:i}=e,s=t.getColDef(),o=this.createCellRendererParams();o.deferRender=!0;const a=ZF(r,s,o);if(n.getGridBodyCtrl()?.scrollFeature?.isScrolling()){let u;const d=new Nt(g=>{u=g}),[h]=this.addManagedListeners(i,{bodyScrollEnd:()=>{u(),h()}});return{loadingComp:a,onReady:d}}return{loadingComp:a,onReady:Nt.resolve()}}showValue(e,t){const{beans:r,column:n,rowNode:i,rangeFeature:s}=this,{userCompFactory:o}=r;let a=this.getValueToDisplay(),u;const d=i.stub&&i.groupData?.[n.getId()]==null,h=n.getColDef();if(d||this.isCellRenderer()){const g=this.createCellRendererParams();!d||Go(n)?u=QF(o,h,g):u=ZF(o,h,g)}if(!u&&!d&&r.findSvc?.isMatch(i,n)){const g=this.createCellRendererParams();u=QF(o,{...n.getColDef(),cellRenderer:"agFindCellRenderer"},g)}if(this.hasEdit&&this.editSvc.isBatchEditing()&&this.editSvc.isRowEditing(i,{checkSiblings:!0})){const g=this.editSvc.prepDetailsDuringBatch(this,{compDetails:u,valueToDisplay:a});g&&(g.compDetails?u=g.compDetails:g.valueToDisplay&&(a=g.valueToDisplay))}this.comp.setRenderDetails(u,a,e),this.customRowDragComp?.refreshVisibility(),!t&&s&&Jo(r,()=>s?.refreshHandle()),this.rowResizeFeature?.refreshRowResizer()}setupControlComps(){const e=this.column.getColDef();this.includeSelection=this.isIncludeControl(this.isCheckboxSelection(e),!0),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.comp.setIncludeSelection(this.includeSelection),this.comp.setIncludeDndSource(this.includeDndSource),this.comp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}getCellValueClass(){const e="ag-cell-value",t=this.column.getColDef().cellRenderer==="agCheckboxCellRenderer";let r="";return t&&(r=" ag-allow-overflow"),`${e}${r}`}isIncludeControl(e,t=!1){return(this.rowNode.rowPinned==null||t&&$f(this.rowNode))&&!!e}isCheckboxSelection(e){const{rowSelection:t,groupDisplayType:r}=this.beans.gridOptions,n=k0(t),i=ea(this.column);return r==="custom"&&n!=="selectionColumn"&&i?!1:e.checkboxSelection||i&&typeof t=="object"&&Mu(t)}refreshShouldDestroy(){const e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(this.isCheckboxSelection(e),!0),r=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),n=this.includeDndSource!=this.isIncludeControl(e.dndSource),i=this.isAutoHeight!=this.column.isAutoHeight();return t||r||n||i}onPopupEditorClosed(){const{editSvc:e}=this.beans;e?.isEditing(this,{withOpenEditor:!0})&&e?.stopEditing(this,{source:e?.isBatchEditing()?"ui":"api"})}stopEditing(e=!1){const{editSvc:t}=this.beans;return t?.stopEditing(this,{cancel:e,source:t?.isBatchEditing()?"ui":"api"})??!1}createCellRendererParams(){const{value:e,valueFormatted:t,column:r,rowNode:n,comp:i,eGui:s,beans:{valueSvc:o,gos:a,editSvc:u}}=this;return it(a,{value:e,valueFormatted:t,getValue:()=>o.getValueForDisplay(r,n).value,setValue:h=>u?.setDataValue({rowNode:n,column:r},h)||n.setDataValue(r,h),formatValue:this.formatValue.bind(this),data:n.data,node:n,pinned:r.getPinned(),colDef:r.getColDef(),column:r,refreshCell:this.refreshCell.bind(this),eGridCell:s,eParentOfValue:i.getParentOfValue(),registerRowDragger:(h,g,m,v)=>this.registerRowDragger(h,g,v),setTooltip:(h,g)=>{a.assertModuleRegistered("Tooltip",3),this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(h,g),this.tooltipFeature?.refreshTooltip()}})}onCellChanged(e){e.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(e){if(this.refreshShouldDestroy()?this.rowCtrl?.recreateCell(this):this.refreshCell(e),this.hasEdit&&this.editCompDetails){const{editSvc:t,comp:r}=this;!r?.getCellEditor()&&t.isEditing(this,{withOpenEditor:!0})&&t.startEditing(this,{startedEdit:!1,source:"api",silent:!0})}}refreshCell({force:e,suppressFlash:t,newData:r}={}){const{editStyleFeature:n,customStyleFeature:i,rowCtrl:{rowEditStyleFeature:s},beans:{cellFlashSvc:o,filterManager:a},column:u,comp:d,suppressRefreshCell:h,tooltipFeature:g}=this;if(h)return;const{field:m,valueGetter:v,showRowGroup:w,enableCellChangeFlash:C}=u.getColDef(),b=m==null&&v==null&&w==null,x=e||b||r,R=!!d,E=this.updateAndFormatValue(R),A=x||E;if(R){if(A){this.showValue(!!r,!1);const D=a?.isSuppressFlashingCellsBecauseFiltering();!t&&!D&&C&&o?.flashCell(this),n?.applyCellStyles?.(),i?.applyUserStyles(),i?.applyClassesFromColDef(),s?.applyRowStyles()}g?.refreshTooltip(),i?.applyCellClassRules()}}isCellEditable(){return this.column.isCellEditable(this.rowNode)}formatValue(e){return this.callValueFormatter(e)??e}callValueFormatter(e){return this.beans.valueSvc.formatValue(this.column,this.rowNode,e)}updateAndFormatValue(e){const t=this.value,r=this.valueFormatted,{value:n,valueFormatted:i}=this.beans.valueSvc.getValueForDisplay(this.column,this.rowNode,!0);return this.value=n,this.valueFormatted=i,e?!this.valuesAreEqual(t,this.value)||this.valueFormatted!=r:!0}valuesAreEqual(e,t){const r=this.column.getColDef();return r.equals?r.equals(e,t):e===t}addDomData(e){const t=this.eGui;tc(this.beans.gos,t,G0,this),e.addDestroyFunc(()=>tc(this.beans.gos,t,G0,null))}createEvent(e,t){const{rowNode:r,column:n,value:i,beans:s}=this;return uX(s,e,t,{rowNode:r,column:n},i)}processCharacter(e){this.keyboardListener?.processCharacter(e)}onKeyDown(e){this.keyboardListener?.onKeyDown(e)}onMouseEvent(e,t){this.mouseListener?.onMouseEvent(e,t)}getColSpanningList(){return this.positionFeature?.getColSpanningList()??[]}onLeftChanged(){this.comp&&this.positionFeature?.onLeftChanged()}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){const{comp:e,column:t,beans:r}=this;aL(e,t,r.visibleCols)}refreshAriaColIndex(){const e=this.beans.visibleCols.getAriaColIndex(this.column);MM(this.eGui,e)}onWidthChanged(){return this.positionFeature?.onWidthChanged()}getRowPosition(){const{rowIndex:e,rowPinned:t}=this.cellPosition;return{rowIndex:e,rowPinned:t}}updateRangeBordersIfRangeCount(){this.comp&&this.rangeFeature?.updateRangeBordersIfRangeCount()}onCellSelectionChanged(){this.comp&&this.rangeFeature?.onCellSelectionChanged()}isRangeSelectionEnabled(){return this.rangeFeature!=null}focusCell(e=!1,t){const r=this.editSvc?.allowedFocusTargetOnValidation(this);r&&r!==this||this.beans.focusSvc.setFocusedCell({...this.getFocusedCellPosition(),forceBrowserFocus:e,sourceEvent:t})}restoreFocus(e=!1){const{beans:{editSvc:t,focusSvc:r},comp:n}=this;if(!n||t?.isEditing(this)||!this.isCellFocused()||!r.shouldTakeFocus())return;const i=()=>{if(!this.isAlive())return;const s=n.getFocusableElement();this.isCellFocused()&&s.focus({preventScroll:!0})};if(e){setTimeout(i,0);return}i()}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.restoreFocus(),this.rangeFeature?.onCellSelectionChanged(),this.rowResizeFeature?.refreshRowResizer()}onSuppressCellFocusChanged(e){const t=this.eGui;t&&(Go(this.column)&&(e=!0),Ei(t,"tabindex",e?void 0:-1))}onFirstRightPinnedChanged(){if(!this.comp)return;const e=this.column.isFirstRightPinned();this.comp.toggleCss(CX,e)}onLastLeftPinnedChanged(){if(!this.comp)return;const e=this.column.isLastLeftPinned();this.comp.toggleCss(yX,e)}checkCellFocused(){return this.beans.focusSvc.isCellFocused(this.cellPosition)}isCellFocused(){const e=this.checkCellFocused();return this.hasBeenFocused||(this.hasBeenFocused=e),e}setupFocus(){this.restoreFocus(!0),this.onCellFocused(this.focusEventWhileNotReady??void 0)}onCellFocused(e){const{beans:t}=this;if(Xm(t))return;if(!this.comp){e&&(this.focusEventWhileNotReady=e);return}const r=this.isCellFocused(),n=t.editSvc?.isEditing(this)??!1;if(this.comp.toggleCss(wX,r),r&&e?.forceBrowserFocus){let i=this.comp.getFocusableElement();if(n){const s=Lu(i,null,!0);s.length&&(i=s[0])}i.focus({preventScroll:!!e.preventScrollOnBrowserFocus})}r&&e&&this.rowCtrl.announceDescription()}createCellPosition(){const{rowIndex:e,rowPinned:t}=this.rowNode;this.cellPosition={rowIndex:e,rowPinned:Ho(t),column:this.column}}applyStaticCssClasses(){const{comp:e}=this;e.toggleCss(pX,!0),e.toggleCss(bX,!0);const t=this.column.isAutoHeight()==!0;e.toggleCss(mX,t),e.toggleCss(vX,!t)}onColumnHover(){this.beans.colHover?.onCellColumnHover(this.column,this.comp)}onColDefChanged(){this.comp&&(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),this.editSvc?.isEditing(this)?this.editSvc?.handleColDefChanged(this):this.refreshOrDestroyCell({force:!0,suppressFlash:!0}))}setWrapText(){const e=this.column.getColDef().wrapText==!0;this.comp.toggleCss(SX,e)}dispatchCellContextMenuEvent(e){const t=this.column.getColDef(),r=this.createEvent(e,"cellContextMenu"),{beans:n}=this;n.eventSvc.dispatchEvent(r),t.onCellContextMenu&&window.setTimeout(()=>{n.frameworkOverrides.wrapOutgoing(()=>{t.onCellContextMenu(r)})},0)}getCellRenderer(){return this.comp?.getCellRenderer()??null}destroy(){this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.isCellFocused()&&this.hasBrowserFocus()&&this.beans.focusSvc.attemptToRecoverFocus(),super.destroy()}hasBrowserFocus(){return this.eGui?.contains(Fr(this.beans))??!1}createSelectionCheckbox(){const e=this.beans.selectionSvc?.createCheckboxSelectionComponent();if(e)return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}createDndSource(){const e=this.beans.registry.createDynamicBean("dndSourceComp",!1,this.rowNode,this.column,this.eGui);return e&&this.beans.context.createBean(e),e}registerRowDragger(e,t,r){if(this.customRowDragComp){this.customRowDragComp.setDragElement(e,t);return}const n=this.createRowDragComp(e,t,r);n&&(this.customRowDragComp=n,this.addDestroyFunc(()=>{this.beans.context.destroyBean(n),this.customRowDragComp=null}),n.refreshVisibility())}createRowDragComp(e,t,r){const n=this.beans.rowDragSvc?.createRowDragCompForCell(this.rowNode,this.column,()=>this.value,e,t,r);if(n)return this.beans.context.createBean(n),n}cellEditorAttached(){for(const e of this.onEditorAttachedFuncs)e();this.onEditorAttachedFuncs=[]}setFocusedCellPosition(e){}getFocusedCellPosition(){return this.cellPosition}refreshAriaRowIndex(){}getRootElement(){return this.eGui}};function Lx(e,t,r,n,i,s){if(r==null&&t==null)return;const o={},a={},u=(d,h)=>{for(const g of d.split(" "))g.trim()!=""&&h(g)};if(r){const d=Object.keys(r);for(let h=0;h<d.length;h++){const g=d[h],m=r[g];let v;typeof m=="string"?v=e?e.evaluate(m,n):!0:typeof m=="function"&&(v=m(n)),u(g,w=>{v?o[w]=!0:a[w]=!0})}}if(t&&s)for(const d of Object.keys(t))u(d,h=>{o[h]||(a[h]=!0)});s&&Object.keys(a).forEach(s),Object.keys(o).forEach(i)}function WD(e){if(e.group)return e.level;const t=e.parent;return t?t.level+1:0}var EX=class extends Ee{constructor(){super(...arguments),this.beanName="rowStyleSvc"}processClassesFromGridOptions(e,t){const r=this.gos,n=o=>{if(typeof o=="string")e.push(o);else if(Array.isArray(o))for(const a of o)e.push(a)},i=r.get("rowClass");i&&n(i);const s=r.getCallback("getRowClass");if(s){const o={data:t.data,node:t,rowIndex:t.rowIndex},a=s(o);n(a)}}preProcessRowClassRules(e,t){this.processRowClassRules(t,r=>{e.push(r)},()=>{})}processRowClassRules(e,t,r){const{gos:n,expressionSvc:i}=this.beans,s=it(n,{data:e.data,node:e,rowIndex:e.rowIndex});Lx(i,void 0,n.get("rowClassRules"),s,t,r)}processStylesFromGridOptions(e){const t=this.gos,r=t.get("rowStyle"),n=t.getCallback("getRowStyle");let i;if(n){const s={data:e.data,node:e,rowIndex:e.rowIndex};i=n(s)}if(i||r)return Object.assign({},r,i)}},RX=0,U0=class extends Ee{constructor(e,t,r,n,i){super(),this.rowNode=e,this.useAnimationFrameForCreate=n,this.printLayout=i,this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKey=null,this.beans=t,this.gos=t.gos,this.paginationPage=t.pagination?.getCurrentPage()??0,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=e.id+"-"+RX++,this.rowId=Lh(e.id),this.initRowBusinessKey(),this.rowFocused=t.focusSvc.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=WD(this.rowNode),this.setRowType(),this.setAnimateFlags(r),this.rowStyles=this.processStylesFromGridOptions(),this.rowEditStyleFeature=t.editSvc?.createRowStyleFeature(this,t),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if(typeof this.businessKeyForNodeFunc!="function")return;const e=this.businessKeyForNodeFunc(this.rowNode);this.businessKey=Lh(e)}updateGui(e,t){e==="left"?this.leftGui=t:e==="right"?this.rightGui=t:e==="fullWidth"?this.fullWidthGui=t:this.centerGui=t}setComp(e,t,r,n){const{context:i,focusSvc:s}=this.beans;n=Gf(this,i,n);const o={rowComp:e,element:t,containerType:r,compBean:n};this.allRowGuis.push(o),this.updateGui(r,o),this.initialiseRowComp(o);const a=this.rowNode,u=this.rowType==="FullWidthLoading"||a.stub,d=!a.data&&this.beans.rowModel.getType()==="infinite";!u&&!d&&!a.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent();const h=this.fullWidthGui?.element;h&&!this.beans.editSvc?.isEditing(this)&&s.isRowFocused(a.rowIndex,a.rowPinned)&&s.shouldTakeFocus()&&setTimeout(()=>h.focus({preventScroll:!0}),0)}unsetComp(e){this.allRowGuis=this.allRowGuis.filter(t=>t.containerType!==e),this.updateGui(e,void 0)}isCacheable(){return this.rowType==="FullWidthDetail"&&this.gos.get("keepDetailRows")}setCached(e){const t=e?"none":"";for(const r of this.allRowGuis)r.element.style.display=t}initialiseRowComp(e){const t=this.gos;this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.listenOnDomOrder(e),this.onRowHeightChanged(e),this.updateRowIndexes(e),this.setFocusedClasses(e),this.setStylesFromGridOptions(!1,e),Vl(t)&&this.rowNode.selectable&&this.onRowSelected(e),this.updateColumnLists(!this.useAnimationFrameForCreate);const r=e.rowComp,n=this.getInitialRowClasses(e.containerType);for(const i of n)r.toggleCss(i,!0);this.executeSlideAndFadeAnimations(e),this.rowNode.group&&wb(e.element,this.rowNode.expanded==!0),this.setRowCompRowId(r),this.setRowCompRowBusinessKey(r),tc(t,e.element,V0,this),e.compBean.addDestroyFunc(()=>tc(t,e.element,V0,null)),this.useAnimationFrameForCreate?this.beans.animationFrameSvc.createTask(this.addHoverFunctionality.bind(this,e),this.rowNode.rowIndex,"p2",!1):this.addHoverFunctionality(e),this.isFullWidth()&&this.setupFullWidth(e),t.get("rowDragEntireRow")&&this.addRowDraggerToRow(e),this.useAnimationFrameForCreate&&this.beans.animationFrameSvc.addDestroyTask(()=>{this.isAlive()&&e.rowComp.toggleCss("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(e){this.businessKey!=null&&e.setRowBusinessKey(this.businessKey)}setRowCompRowId(e){const t=Lh(this.rowNode.id);this.rowId=t,t!=null&&e.setRowId(t)}executeSlideAndFadeAnimations(e){const{containerType:t}=e;this.slideInAnimation[t]&&(Cb(()=>{this.onTopChanged()}),this.slideInAnimation[t]=!1),this.fadeInAnimation[t]&&(Cb(()=>{e.rowComp.toggleCss("ag-opacity-zero",!1)}),this.fadeInAnimation[t]=!1)}addRowDraggerToRow(e){const t=this.beans.rowDragSvc?.createRowDragCompForRow(this.rowNode,e.element);if(!t)return;const r=this.createBean(t,this.beans.context);this.rowDragComps.push(r),e.compBean.addDestroyFunc(()=>{this.rowDragComps=this.rowDragComps.filter(n=>n!==r),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,this.beans.context),this.destroyBean(r,this.beans.context)})}setupFullWidth(e){const t=this.getPinnedForContainer(e.containerType),r=this.createFullWidthCompDetails(e.element,t);e.rowComp.showFullWidth(r)}getFullWidthCellRenderers(){return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(e=>e?.rowComp?.getFullWidthCellRenderer()):[this.fullWidthGui?.rowComp?.getFullWidthCellRenderer()]}executeProcessRowPostCreateFunc(){const e=this.gos.getCallback("processRowPostCreate");if(!e||!this.areAllContainersReady())return;const t={eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)};e(t)}areAllContainersReady(){const{leftGui:e,centerGui:t,rightGui:r,beans:{visibleCols:n}}=this,i=!!e||!n.isPinningLeft(),s=!!t,o=!!r||!n.isPinningRight();return i&&s&&o}isNodeFullWidthCell(){if(this.rowNode.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this.rowNode}):!1}setRowType(){const e=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow")&&!this.gos.get("groupHideOpenParents"),t=this.isNodeFullWidthCell(),r=this.gos.get("masterDetail")&&this.rowNode.detail,n=this.beans.colModel.isPivotMode(),i=o_(this.gos,this.rowNode,n);e?this.rowType="FullWidthLoading":r?this.rowType="FullWidthDetail":t?this.rowType="FullWidth":i?this.rowType="FullWidthGroup":this.rowType="Normal"}updateColumnLists(e=!1,t=!1){if(this.isFullWidth())return;const{animationFrameSvc:r}=this.beans;if(!r?.active||e||this.printLayout){this.updateColumnListsImpl(t);return}this.updateColumnListsPending||(r.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"p1",!1),this.updateColumnListsPending=!0)}getNewCellCtrl(e){if(!this.beans.rowSpanSvc?.isCellSpanning(e,this.rowNode))return new Hu(e,this.rowNode,this.beans,this)}isCorrectCtrlForSpan(e){return!this.beans.rowSpanSvc?.isCellSpanning(e.column,this.rowNode)}createCellCtrls(e,t,r=null){const n={list:[],map:{}},i=(d,h,g)=>{g!=null?n.list.splice(g,0,h):n.list.push(h),n.map[d]=h},s=[];for(const d of t){const h=d.getInstanceId();let g=e.map[h];g&&!this.isCorrectCtrlForSpan(g)&&(g.destroy(),g=void 0),g||(g=this.getNewCellCtrl(d)),g&&i(h,g)}for(const d of e.list){const h=d.column.getInstanceId();if(n.map[h]!=null)continue;!this.isCellEligibleToBeRemoved(d,r)?s.push([h,d]):d.destroy()}if(s.length)for(const[d,h]of s){const g=n.list.findIndex(v=>v.column.getLeft()>h.column.getLeft()),m=g===-1?void 0:Math.max(g-1,0);i(d,h,m)}const{focusSvc:o,visibleCols:a}=this.beans,u=o.getFocusedCell();if(u&&u.column.getPinned()==r){const d=u.column.getInstanceId();if(!n.map[d]&&a.allCols.includes(u.column)){const g=this.createFocusedCellCtrl();if(g){const m=n.list.findIndex(w=>w.column.getLeft()>g.column.getLeft()),v=m===-1?void 0:Math.max(m-1,0);i(d,g,v)}}}return n}createFocusedCellCtrl(){const{focusSvc:e,rowSpanSvc:t}=this.beans,r=e.getFocusedCell();if(!r)return;const n=t?.getCellSpan(r.column,this.rowNode);if(n){if(n.firstNode!==this.rowNode||!n.doesSpanContain(r))return}else if(!e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned))return;return this.getNewCellCtrl(r.column)}updateColumnListsImpl(e){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(e)}setCellCtrls(e){for(const t of this.allRowGuis){const r=this.getCellCtrlsForContainer(t.containerType);t.rowComp.setCellCtrls(r,e)}}getCellCtrlsForContainer(e){switch(e){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list}}createAllCellCtrls(){const e=this.beans.colViewport,t=this.beans.visibleCols;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.allCols),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const r=e.getColsWithinViewport(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,r);const n=t.getLeftColsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,n,"left");const i=t.getRightColsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,i,"right")}}isCellEligibleToBeRemoved(e,t){const{column:i}=e;if(i.getPinned()!=t||!this.isCorrectCtrlForSpan(e))return!0;const{visibleCols:s,editSvc:o}=this.beans,a=o?.isEditing(e),u=e.isCellFocused();return a||u?!(s.allCols.indexOf(i)>=0):!0}getDomOrder(){return this.gos.get("ensureDomOrder")||bn(this.gos,"print")}listenOnDomOrder(e){const t=()=>{e.rowComp.setDomOrder(this.getDomOrder())};e.compBean.addManagedPropertyListeners(["domLayout","ensureDomOrder"],t)}setAnimateFlags(e){if(this.rowNode.sticky||!e)return;const t=$e(this.rowNode.oldRowTop),{visibleCols:r}=this.beans,n=r.isPinningLeft(),i=r.isPinningRight();if(t){const{slideInAnimation:s}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){s.fullWidth=!0;return}s.center=!0,s.left=n,s.right=i}else{const{fadeInAnimation:s}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){s.fullWidth=!0;return}s.center=!0,s.left=n,s.right=i}}isFullWidth(){return this.rowType!=="Normal"}refreshFullWidth(){const e=(o,a)=>o?o.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(o.element,a).params):!0,t=e(this.fullWidthGui,null),r=e(this.centerGui,null),n=e(this.leftGui,"left"),i=e(this.rightGui,"right");return t&&r&&n&&i}addListeners(){const{beans:e,gos:t,rowNode:r}=this,{expansionSvc:n,eventSvc:i,context:s,rowSpanSvc:o}=e;this.addManagedListeners(this.rowNode,{heightChanged:()=>this.onRowHeightChanged(),rowSelected:()=>this.onRowSelected(),rowIndexChanged:this.onRowIndexChanged.bind(this),topChanged:this.onTopChanged.bind(this),...n?.getRowExpandedListeners(this)??{}}),r.detail&&this.addManagedListeners(r.parent,{dataChanged:this.onRowNodeDataChanged.bind(this)}),this.addManagedListeners(r,{dataChanged:this.onRowNodeDataChanged.bind(this),cellChanged:this.postProcessCss.bind(this),rowHighlightChanged:this.onRowNodeHighlightChanged.bind(this),draggingChanged:this.postProcessRowDragging.bind(this),uiLevelChanged:this.onUiLevelChanged.bind(this),rowPinned:this.onRowPinned.bind(this)}),this.addManagedListeners(i,{paginationPixelOffsetChanged:this.onPaginationPixelOffsetChanged.bind(this),heightScaleChanged:this.onTopChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:this.onVirtualColumnsChanged.bind(this),cellFocused:this.onCellFocusChanged.bind(this),cellFocusCleared:this.onCellFocusChanged.bind(this),paginationChanged:this.onPaginationChanged.bind(this),modelUpdated:this.refreshFirstAndLastRowStyles.bind(this),columnMoved:()=>this.updateColumnLists()}),o&&this.addManagedListeners(o,{spannedCellsUpdated:({pinned:a})=>{a&&!r.rowPinned||this.updateColumnLists()}}),this.addDestroyFunc(()=>{this.rowDragComps=this.destroyBeans(this.rowDragComps,s),this.tooltipFeature=this.destroyBean(this.tooltipFeature,s),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,s)}),this.addManagedPropertyListeners(["rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules"],this.postProcessCss.bind(this)),this.addManagedPropertyListener("rowDragEntireRow",()=>{if(t.get("rowDragEntireRow")){for(const u of this.allRowGuis)this.addRowDraggerToRow(u);return}this.rowDragComps=this.destroyBeans(this.rowDragComps,s)}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListeners(this.rowNode,{rowIndexChanged:()=>{for(const e of this.getAllCellCtrls())e.onRowIndexChanged()},cellChanged:e=>{for(const t of this.getAllCellCtrls())t.onCellChanged(e)}})}onRowPinned(){for(const e of this.allRowGuis)e.rowComp.toggleCss("ag-row-pinned-source",!!this.rowNode.pinnedSibling)}onRowNodeDataChanged(e){this.refreshRow({suppressFlash:!e.update,newData:!e.update})}refreshRow(e){if(this.isFullWidth()!==!!this.isNodeFullWidthCell()){this.beans.rowRenderer.redrawRow(this.rowNode);return}if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode);return}for(const r of this.getAllCellCtrls())r.refreshCell(e);for(const r of this.allRowGuis)this.setRowCompRowId(r.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(r.rowComp);this.onRowSelected(),this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.rowEditStyleFeature?.applyRowStyles(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const e=this.beans.rowDropHighlightSvc,t=e?.row===this.rowNode?e.position:"none",r=t==="above",n=t==="inside",i=t==="below",o=this.gos.get("treeData")&&(i||r),a=this.rowNode.uiLevel.toString();for(const u of this.allRowGuis){const d=u.rowComp;d.toggleCss("ag-row-highlight-above",r),d.toggleCss("ag-row-highlight-inside",n),d.toggleCss("ag-row-highlight-below",i),d.toggleCss("ag-row-highlight-indent",o),o?u.element.style.setProperty("--ag-row-highlight-level",a):u.element.style.removeProperty("--ag-row-highlight-level")}}postProcessRowDragging(){const e=this.rowNode.dragging;for(const t of this.allRowGuis)t.rowComp.toggleCss("ag-row-dragging",e)}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.rowAutoHeight?.requestCheckAutoHeight()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:Ho(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(e){const t=this.findFullWidthInfoForEvent(e);if(!t)return;const{rowGui:r,column:n}=t;if(!(r.element===e.target))return;const o=this.rowNode,{focusSvc:a,navigation:u}=this.beans,d=a.getFocusedCell(),h={rowIndex:o.rowIndex,rowPinned:o.rowPinned,column:d?.column??n};u?.navigateToNextCell(e,e.key,h,!0),e.preventDefault()}onTabKeyDown(e){if(e.defaultPrevented||zo(e))return;const t=this.allRowGuis.find(a=>a.element.contains(e.target)),r=t?t.element:null,n=r===e.target,i=Fr(this.beans);let s=!1;r&&i&&(s=r.contains(i)&&i.classList.contains("ag-cell"));let o=null;!n&&!s&&(o=vc(this.beans,r,!1,e.shiftKey)),(this.isFullWidth()&&n||!o)&&this.beans.navigation?.onTabKeyDown(this,e)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){const e=this.allRowGuis.find(t=>Qo(t.element))?.element;return e?e.getBoundingClientRect().top:0}onSuppressCellFocusChanged(e){const t=this.isFullWidth()&&e?void 0:this.gos.get("tabIndex");for(const r of this.allRowGuis)Ei(r.element,"tabindex",t)}onFullWidthRowFocused(e){const t=this.rowNode,r=e?this.isFullWidth()&&e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned:!1;let n;if(this.fullWidthGui)n=this.fullWidthGui.element;else{const s=this.beans.colModel.getCol(e?.column)?.pinned;s?n=s==="right"?this.rightGui?.element:this.leftGui?.element:n=this.centerGui?.element}n&&(n.classList.toggle("ag-full-width-focus",r),r&&e?.forceBrowserFocus&&n.focus({preventScroll:!0}))}recreateCell(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),e.destroy(),this.updateColumnLists()}removeCellCtrl(e,t){const r={list:[],map:{}};for(const n of e.list)n!==t&&(r.list.push(n),r.map[n.column.getInstanceId()]=n);return r}onMouseEvent(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t);break}}createRowEvent(e,t){const{rowNode:r}=this;return it(this.gos,{type:e,node:r,data:r.data,rowIndex:r.rowIndex,rowPinned:r.rowPinned,event:t})}createRowEventWithSource(e,t){const r=this.createRowEvent(e,t);return r.source=this,r}onRowDblClick(e){if(zo(e))return;const t=this.createRowEventWithSource("rowDoubleClicked",e);t.isEventHandlingSuppressed=this.isSuppressMouseEvent(e),this.beans.eventSvc.dispatchEvent(t)}findFullWidthInfoForEvent(e){if(!e)return;const t=this.findFullWidthRowGui(e.target),r=this.getColumnForFullWidth(t);if(!(!t||!r))return{rowGui:t,column:r}}findFullWidthRowGui(e){return this.allRowGuis.find(t=>t.element.contains(e))}getColumnForFullWidth(e){const{visibleCols:t}=this.beans;switch(e?.containerType){case"center":return t.centerCols[0];case"left":return t.leftCols[0];case"right":return t.rightCols[0];default:return t.allCols[0]}}onRowMouseDown(e){if(this.lastMouseDownOnDragger=Hl(e.target,"ag-row-drag",3),!this.isFullWidth()||this.isSuppressMouseEvent(e))return;const{rangeSvc:t,focusSvc:r}=this.beans;t?.removeAllCellRanges();const n=this.findFullWidthInfoForEvent(e);if(!n)return;const{rowGui:i,column:s}=n,o=i.element,a=e.target,u=this.rowNode;let d=e.defaultPrevented||rl();o&&o.contains(a)&&Ih(a)&&(d=!1),r.setFocusedCell({rowIndex:u.rowIndex,column:s,rowPinned:u.rowPinned,forceBrowserFocus:d})}isSuppressMouseEvent(e){const{gos:t,rowNode:r}=this;if(this.isFullWidth()){const i=this.findFullWidthRowGui(e.target);return FU(t,i?.rowComp.getFullWidthCellRendererParams(),r,e)}const n=Rx(t,e.target);return n!=null&&a0(t,n.column,r,e)}onRowClick(e){if(zo(e)||this.lastMouseDownOnDragger)return;const r=this.isSuppressMouseEvent(e),{eventSvc:n,selectionSvc:i}=this.beans,s=this.createRowEventWithSource("rowClicked",e);s.isEventHandlingSuppressed=r,n.dispatchEvent(s),!r&&i?.handleSelectionEvent(e,this.rowNode,"rowClicked")}setupDetailRowAutoHeight(e){this.rowType==="FullWidthDetail"&&this.beans.masterDetailSvc?.setupDetailRowAutoHeight(this,e)}createFullWidthCompDetails(e,t){const{gos:r,rowNode:n}=this,i=it(r,{fullWidth:!0,data:n.data,node:n,value:n.key,valueFormatted:n.key,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(o,a,u,d)=>this.addFullWidthRowDragging(o,a,u,d),setTooltip:(o,a)=>{r.assertModuleRegistered("Tooltip",3),this.setupFullWidthRowTooltip(o,a)}}),s=this.beans.userCompFactory;switch(this.rowType){case"FullWidthDetail":return _W(s,i);case"FullWidthGroup":{const{value:o,valueFormatted:a}=this.beans.valueSvc.getValueForDisplay(void 0,this.rowNode,!0);return i.value=o,i.valueFormatted=a,MW(s,i)}case"FullWidthLoading":return PW(s,i);default:return kW(s,i)}}setupFullWidthRowTooltip(e,t){this.fullWidthGui&&(this.tooltipFeature=this.beans.tooltipSvc?.setupFullWidthRowTooltip(this.tooltipFeature,this,e,t))}addFullWidthRowDragging(e,t,r="",n){const{rowDragSvc:i,context:s}=this.beans;if(!i||!this.isFullWidth())return;const o=i.createRowDragComp(()=>r,this.rowNode,void 0,e,t,n);this.createBean(o,s),this.addDestroyFunc(()=>{this.destroyBean(o,s)})}onUiLevelChanged(){const e=WD(this.rowNode);if(this.rowLevel!=e){const t="ag-row-level-"+e,r="ag-row-level-"+this.rowLevel;for(const n of this.allRowGuis)n.rowComp.toggleCss(t,!0),n.rowComp.toggleCss(r,!1)}this.rowLevel=e}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getLastRow()}refreshFirstAndLastRowStyles(){const e=this.isFirstRowOnPage(),t=this.isLastRowOnPage();if(this.firstRowOnPage!==e){this.firstRowOnPage=e;for(const r of this.allRowGuis)r.rowComp.toggleCss("ag-row-first",e)}if(this.lastRowOnPage!==t){this.lastRowOnPage=t;for(const r of this.allRowGuis)r.rowComp.toggleCss("ag-row-last",t)}}getAllCellCtrls(){return this.leftCellCtrls.list.length===0&&this.rightCellCtrls.list.length===0?this.centerCellCtrls.list:[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){const e=[];if(this.beans.rowStyleSvc?.processClassesFromGridOptions(e,this.rowNode),!!e.length)for(const t of e)for(const r of this.allRowGuis)r.rowComp.toggleCss(t,!0)}postProcessRowClassRules(){this.beans.rowStyleSvc?.processRowClassRules(this.rowNode,e=>{for(const t of this.allRowGuis)t.rowComp.toggleCss(e,!0)},e=>{for(const t of this.allRowGuis)t.rowComp.toggleCss(e,!1)})}setStylesFromGridOptions(e,t){e&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(t,r=>r.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(e){return e==="left"||e==="right"?e:null}getInitialRowClasses(e){const t=this.getPinnedForContainer(e),r=this.isFullWidth(),{rowNode:n,beans:i}=this,s=[];s.push("ag-row"),s.push(this.rowFocused?"ag-row-focus":"ag-row-no-focus"),this.fadeInAnimation[e]&&s.push("ag-opacity-zero"),s.push(n.rowIndex%2===0?"ag-row-even":"ag-row-odd"),n.isRowPinned()&&(s.push("ag-row-pinned"),i.pinnedRowModel?.isManual()&&s.push("ag-row-pinned-manual")),!n.isRowPinned()&&n.pinnedSibling&&s.push("ag-row-pinned-source"),n.isSelected()&&s.push("ag-row-selected"),n.footer&&s.push("ag-row-footer"),s.push("ag-row-level-"+this.rowLevel),n.stub&&s.push("ag-row-loading"),r&&s.push("ag-full-width-row"),i.expansionSvc?.addExpandedCss(s,n),n.dragging&&s.push("ag-row-dragging");const{rowStyleSvc:o}=i;return o&&(o.processClassesFromGridOptions(s,n),o.preProcessRowClassRules(s,n)),s.push(this.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),this.isFirstRowOnPage()&&s.push("ag-row-first"),this.isLastRowOnPage()&&s.push("ag-row-last"),r&&(t==="left"&&s.push("ag-cell-last-left-pinned"),t==="right"&&s.push("ag-cell-first-right-pinned")),s}processStylesFromGridOptions(){return this.beans.rowStyleSvc?.processStylesFromGridOptions(this.rowNode)??this.emptyStyle}onRowSelected(e){this.beans.selectionSvc?.onRowCtrlSelected(this,t=>{(t===this.centerGui||t===this.fullWidthGui)&&this.announceDescription()},e)}announceDescription(){this.beans.selectionSvc?.announceAriaRowSelection(this.rowNode)}addHoverFunctionality(e){if(!this.active)return;const{element:t,compBean:r}=e,{rowNode:n,beans:i,gos:s}=this;r.addManagedListeners(t,{pointerenter:o=>{o.pointerType==="mouse"&&n.dispatchRowEvent("mouseEnter")},pointerleave:o=>{o.pointerType==="mouse"&&n.dispatchRowEvent("mouseLeave")}}),r.addManagedListeners(n,{mouseEnter:()=>{!i.dragSvc?.dragging&&!s.get("suppressRowHoverHighlight")&&(t.classList.add("ag-row-hover"),n.setHovered(!0))},mouseLeave:()=>{this.resetHoveredStatus(t)}})}resetHoveredStatus(e){const t=e?[e]:this.allRowGuis.map(r=>r.element);for(const r of t)r.classList.remove("ag-row-hover");this.rowNode.setHovered(!1)}roundRowTopToBounds(e){const t=this.beans.ctrlsSvc.getScrollFeature().getApproximateVScollPosition(),r=this.applyPaginationOffset(t.top,!0)-100,n=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(r,e),n)}forEachGui(e,t){if(e)t(e);else for(const r of this.allRowGuis)t(r)}isRowRendered(){return this.allRowGuis.length>0}onRowHeightChanged(e){if(this.rowNode.rowHeight==null)return;const t=this.rowNode.rowHeight,r=this.beans.environment.getDefaultRowHeight(),i=t_(this.gos)?$a(this.beans,this.rowNode).height:void 0,s=i?`${Math.min(r,i)-2}px`:void 0;this.forEachGui(e,o=>{o.element.style.height=`${t}px`,s&&o.element.style.setProperty("--ag-line-height",s)})}destroyFirstPass(e=!1){this.active=!1;const{rowNode:t}=this;if(!e&&Pu(this.gos)&&!t.sticky)if(t.rowTop!=null){const i=this.roundRowTopToBounds(t.rowTop);this.setRowTop(i)}else for(const i of this.allRowGuis)i.rowComp.toggleCss("ag-opacity-zero",!0);this.fullWidthGui?.element.contains(Fr(this.beans))&&this.beans.focusSvc.attemptToRecoverFocus(),t.setHovered(!1);const r=this.createRowEvent("virtualRowRemoved");this.dispatchLocalEvent(r),this.beans.eventSvc.dispatchEvent(r),super.destroy()}destroySecondPass(){this.allRowGuis.length=0;const e=t=>{for(const r of t.list)r.destroy();return{list:[],map:{}}};this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}setFocusedClasses(e){this.forEachGui(e,t=>{t.rowComp.toggleCss("ag-row-focus",this.rowFocused),t.rowComp.toggleCss("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){const{focusSvc:e}=this.beans,t=e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);t!==this.rowFocused&&(this.rowFocused=t,this.setFocusedClasses())}onPaginationChanged(){const e=this.beans.pagination?.getCurrentPage()??0;this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(e,t=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return e;const r=this.beans.pageBounds.getPixelOffset();return e+r*(t?1:-1)}setRowTop(e){if(!this.printLayout&&$e(e)){const t=this.applyPaginationOffset(e),i=`${this.rowNode.isRowPinned()||this.rowNode.sticky?t:this.beans.rowContainerHeight.getRealPixelPosition(t)}px`;this.setRowTopStyle(i)}}getInitialRowTop(e){return this.suppressRowTransform?this.getInitialRowTopShared(e):void 0}getInitialTransform(e){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(e)})`}getInitialRowTopShared(e){if(this.printLayout)return"";const t=this.rowNode;let r;if(t.sticky)r=t.stickyRowTop;else{const n=this.slideInAnimation[e]?this.roundRowTopToBounds(t.oldRowTop):t.rowTop,i=this.applyPaginationOffset(n);r=t.isRowPinned()?i:this.beans.rowContainerHeight.getRealPixelPosition(i)}return r+"px"}setRowTopStyle(e){for(const t of this.allRowGuis)this.suppressRowTransform?t.rowComp.setTop(e):t.rowComp.setTransform(`translateY(${e})`)}getCellCtrl(e,t=!1){let r=null;for(const n of this.getAllCellCtrls())n.column==e&&(r=n);if(r!=null||t)return r;for(const n of this.getAllCellCtrls())n?.getColSpanningList().indexOf(e)>=0&&(r=n);return r}onRowIndexChanged(){this.rowNode.rowIndex!=null&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}updateRowIndexes(e){const t=this.rowNode.getRowIndexString();if(t===null)return;const r=(this.beans.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.beans.filterManager?.getHeaderRowCount()??0),n=this.rowNode.rowIndex%2===0,i=r+this.rowNode.rowIndex+1;this.forEachGui(e,s=>{s.rowComp.setRowIndex(t),s.rowComp.toggleCss("ag-row-even",n),s.rowComp.toggleCss("ag-row-odd",!n),PM(s.element,i)})}},TX=class extends Ee{constructor(){super(),this.beanName="navigation",this.onPageDown=VF(this.onPageDown,100),this.onPageUp=VF(this.onPageUp,100)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}handlePageScrollingKey(e,t=!1){const r=e.key,n=e.altKey,i=e.ctrlKey||e.metaKey,s=!!this.beans.rangeSvc&&e.shiftKey,o=e$(this.gos,e);let a=!1;switch(r){case me.PAGE_HOME:case me.PAGE_END:!i&&!n&&(this.onHomeOrEndKey(r),a=!0);break;case me.LEFT:case me.RIGHT:case me.UP:case me.DOWN:if(!o)return!1;i&&!n&&!s&&(this.onCtrlUpDownLeftRight(r,o),a=!0);break;case me.PAGE_DOWN:case me.PAGE_UP:!i&&!n&&(a=this.handlePageUpDown(r,o,t));break}return a&&e.preventDefault(),a}handlePageUpDown(e,t,r){return r&&(t=this.beans.focusSvc.getFocusedCell()),t?(e===me.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0):!1}navigateTo({scrollIndex:e,scrollType:t,scrollColumn:r,focusIndex:n,focusColumn:i,isAsync:s,rowPinned:o}){const{scrollFeature:a}=this.gridBodyCon;$e(r)&&!r.isPinned()&&a.ensureColumnVisible(r),$e(e)&&a.ensureIndexVisible(e,t),s||a.ensureIndexVisible(n);const{focusSvc:u,rangeSvc:d}=this.beans;u.setFocusedCell({rowIndex:n,column:i,rowPinned:o,forceBrowserFocus:!0}),d?.setRangeToCell({rowIndex:n,rowPinned:o,column:i})}onPageDown(e){const t=this.beans,r=Ay(t),n=this.getViewportHeight(),{pageBounds:i,rowModel:s,rowAutoHeight:o}=t,a=i.getPixelOffset(),u=r.top+n,d=s.getRowIndexAtPixel(u+a);o?.active?this.navigateToNextPageWithAutoHeight(e,d):this.navigateToNextPage(e,d)}onPageUp(e){const t=this.beans,r=Ay(t),{pageBounds:n,rowModel:i,rowAutoHeight:s}=t,o=n.getPixelOffset(),a=r.top,u=i.getRowIndexAtPixel(a+o);s?.active?this.navigateToNextPageWithAutoHeight(e,u,!0):this.navigateToNextPage(e,u,!0)}navigateToNextPage(e,t,r=!1){const{pageBounds:n,rowModel:i}=this.beans,s=this.getViewportHeight(),o=n.getFirstRow(),a=n.getLastRow(),u=n.getPixelOffset(),d=i.getRow(e.rowIndex),h=r?d?.rowHeight-s-u:s-u,g=d?.rowTop+h;let m=i.getRowIndexAtPixel(g+u);if(m===e.rowIndex){const w=r?-1:1;t=m=e.rowIndex+w}let v;r?(v="bottom",m<o&&(m=o),t<o&&(t=o)):(v="top",m>a&&(m=a),t>a&&(t=a)),this.isRowTallerThanView(i.getRow(m))&&(t=m,v="top"),this.navigateTo({scrollIndex:t,scrollType:v,scrollColumn:null,focusIndex:m,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t,r=!1){this.navigateTo({scrollIndex:t,scrollType:r?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout(()=>{const n=this.getNextFocusIndexForAutoHeight(e,r);this.navigateTo({scrollIndex:t,scrollType:r?"bottom":"top",scrollColumn:null,focusIndex:n,focusColumn:e.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(e,t=!1){const r=t?-1:1,n=this.getViewportHeight(),{pageBounds:i,rowModel:s}=this.beans,o=i.getLastRow();let a=0,u=e.rowIndex;for(;u>=0&&u<=o;){const d=s.getRow(u);if(d){const h=d.rowHeight??0;if(a+h>n)break;a+=h}u+=r}return Math.max(0,Math.min(u,o))}getViewportHeight(){const e=this.beans,t=Ay(e),r=this.beans.scrollVisibleSvc.getScrollbarWidth();let n=t.bottom-t.top;return e.ctrlsSvc.get("center").isHorizontalScrollShowing()&&(n-=r),n}isRowTallerThanView(e){if(!e)return!1;const t=e.rowHeight;return typeof t!="number"?!1:t>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){const r=this.beans.cellNavigation.getNextCellToFocus(e,t,!0),n=this.getNormalisedPosition(r),{rowIndex:i,rowPinned:s,column:o}=n??r,a=o;this.navigateTo({scrollIndex:i,scrollType:null,scrollColumn:a,focusIndex:i,focusColumn:a,rowPinned:s})}onHomeOrEndKey(e){const t=e===me.PAGE_HOME,{visibleCols:r,pageBounds:n,rowModel:i}=this.beans,s=r.allCols,o=t?n.getFirstRow():n.getLastRow(),a=i.getRow(o);if(!a)return;const u=(t?s:[...s].reverse()).find(d=>!d.isSuppressNavigable(a));u&&this.navigateTo({scrollIndex:o,scrollType:null,scrollColumn:u,focusIndex:o,focusColumn:u})}onTabKeyDown(e,t){const r=t.shiftKey,n=this.tabToNextCellCommon(e,r,t),i=this.beans,{ctrlsSvc:s,pageBounds:o,focusSvc:a,gos:u}=i;if(n!==!1){n?t.preventDefault():n===null&&s.get("gridCtrl").allowFocusForNextCoreContainer(r);return}if(r){const{rowIndex:d,rowPinned:h}=e.getRowPosition();(h?d===0:d===o.getFirstRow())&&(u.get("headerHeight")===0||Ul(i)?td(i,!0,!0):(t.preventDefault(),a.focusPreviousFromFirstCell(t)))}else e instanceof Hu&&e.focusCell(!0),(a.focusOverlay(!1)||td(i,r))&&t.preventDefault()}tabToNextCell(e,t){const r=this.beans,{focusSvc:n,rowRenderer:i}=r,s=n.getFocusedCell();if(!s)return!1;let o=Ru(r,s);return!o&&(o=i.getRowByPosition(s),!o?.isFullWidth())?!1:!!this.tabToNextCellCommon(o,e,t,"api")}tabToNextCellCommon(e,t,r,n="ui"){const{editSvc:i,focusSvc:s}=this.beans;let o;const a=e instanceof Hu?e:e.getAllCellCtrls()?.[0];return i?.isEditing()?o=i?.moveToNextCell(a,t,r,n):o=this.moveToNextCellNotEditing(e,t,r),o===null?o:o||!!s.focusedHeader}moveToNextCellNotEditing(e,t,r){const n=this.beans.visibleCols.allCols;let i;if(e instanceof U0){if(i={...e.getRowPosition(),column:t?n[0]:ir(n)},this.gos.get("embedFullWidthRows")&&r){const o=e.findFullWidthInfoForEvent(r);o&&(i.column=o.column)}}else i=e.getFocusedCellPosition();const s=this.findNextCellToFocusOn(i,{backwards:t,startEditing:!1});if(s===!1)return null;if(s instanceof Hu)s.focusCell(!0);else if(s)return this.tryToFocusFullWidthRow(s,t);return $e(s)}findNextCellToFocusOn(e,{backwards:t,startEditing:r,skipToNextEditableCell:n}){let i=e;const s=this.beans,{cellNavigation:o,gos:a,focusSvc:u,rowRenderer:d,rangeSvc:h}=s;for(;;){e!==i&&(e=i),t||(i=this.getLastCellOfColSpan(i)),i=o.getNextTabbedCell(i,t);const g=a.getCallback("tabToNextCell");if($e(g)){const C=g({backwards:t,editing:r,previousCellPosition:e,nextCellPosition:i||null});if(C===!0)i=e;else{if(C===!1)return!1;i={rowIndex:C.rowIndex,column:C.column,rowPinned:C.rowPinned}}}if(!i)return null;if(i.rowIndex<0){const w=qs(s);return u.focusHeaderPosition({headerPosition:{headerRowIndex:w+i.rowIndex,column:i.column},fromCell:!0}),null}const m=a.get("editType")==="fullRow";if(r&&(!m||n)&&!this.isCellEditable(i))continue;this.ensureCellVisible(i);const v=Ru(s,i);if(!v){const w=d.getRowByPosition(i);if(!w||!w.isFullWidth()||r)continue;return{...w.getRowPosition(),column:i?.column}}if(!o.isSuppressNavigable(v.column,v.rowNode))return v.setFocusedCellPosition(i),h?.setRangeToCell(i),v}}isCellEditable(e){const t=this.lookupRowNodeForCell(e);return t?e.column.isCellEditable(t):!1}lookupRowNodeForCell({rowIndex:e,rowPinned:t}){const{pinnedRowModel:r,rowModel:n}=this.beans;return t==="top"?r?.getPinnedTopRow(e):t==="bottom"?r?.getPinnedBottomRow(e):n.getRow(e)}navigateToNextCell(e,t,r,n){let i=r,s=!1;const o=this.beans,{cellNavigation:a,focusSvc:u,gos:d}=o;for(;i&&(i===r||!this.isValidNavigateCell(i));)d.get("enableRtl")?t===me.LEFT&&(i=this.getLastCellOfColSpan(i)):t===me.RIGHT&&(i=this.getLastCellOfColSpan(i)),i=a.getNextCellToFocus(t,i),s=xr(i);if(s&&e&&e.key===me.UP&&(i={rowIndex:-1,rowPinned:null,column:r.column}),n){const g=d.getCallback("navigateToNextCell");if($e(g)){const v=g({key:t,previousCellPosition:r,nextCellPosition:i||null,event:e});$e(v)?i={rowPinned:v.rowPinned,rowIndex:v.rowIndex,column:v.column}:i=null}}if(!i)return;if(i.rowIndex<0){const g=qs(o);u.focusHeaderPosition({headerPosition:{headerRowIndex:g+i.rowIndex,column:r.column},event:e||void 0,fromCell:!0});return}const h=this.getNormalisedPosition(i);h?this.focusPosition(h):this.tryToFocusFullWidthRow(i)}getNormalisedPosition(e){if(!!this.beans.spannedRowRenderer?.getCellByPosition(e))return e;this.ensureCellVisible(e);const r=Ru(this.beans,e);return r?(e=r.getFocusedCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t){const{visibleCols:r,rowRenderer:n,focusSvc:i,eventSvc:s}=this.beans,o=r.allCols;if(!n.getRowByPosition(e)?.isFullWidth())return!1;const u=i.getFocusedCell(),d={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?ir(o):o[0])};this.focusPosition(d);const h=t??(u!=null&&Sj(d,u));return s.dispatchEvent({type:"fullWidthRowFocused",rowIndex:d.rowIndex,rowPinned:d.rowPinned,column:d.column,isFullWidthCell:!0,fromBelow:h}),!0}focusPosition(e){const{focusSvc:t,rangeSvc:r}=this.beans;t.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),r?.setRangeToCell(e)}isValidNavigateCell(e){return!!Yo(this.beans,e)}getLastCellOfColSpan(e){const t=Ru(this.beans,e);if(!t)return e;const r=t.getColSpanningList();return r.length===1?e:{rowIndex:e.rowIndex,column:ir(r),rowPinned:e.rowPinned}}ensureCellVisible(e){const t=n_(this.gos),r=this.beans.rowModel.getRow(e.rowIndex),n=t&&r?.sticky,{scrollFeature:i}=this.gridBodyCon;!n&&xr(e.rowPinned)&&i.ensureIndexVisible(e.rowIndex),e.column.isPinned()||i.ensureColumnVisible(e.column)}ensureColumnVisible(e){const t=this.gridBodyCon.scrollFeature;e.isPinned()||t.ensureColumnVisible(e)}ensureRowVisible(e){this.gridBodyCon.scrollFeature.ensureIndexVisible(e)}};function Ay(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}var FX={moduleName:"KeyboardNavigation",version:Ue,beans:[TX,qq,oq],apiFunctions:{getFocusedCell:Xq,clearFocusedCell:Qq,setFocusedCell:Zq,setFocusedHeader:tX,tabToNextCell:Jq,tabToPreviousCell:eX}},DX=class extends Ee{constructor(){super(...arguments),this.beanName="pageBoundsListener"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this),recalculateRowBounds:this.calculatePages.bind(this)}),this.onModelUpdated()}onModelUpdated(e){this.calculatePages(),this.eventSvc.dispatchEvent({type:"paginationChanged",animate:e?.animate??!1,newData:e?.newData??!1,newPage:e?.newPage??!1,newPageSize:e?.newPageSize??!1,keepRenderedRows:e?.keepRenderedRows??!1})}calculatePages(){const{pageBounds:e,pagination:t,rowModel:r}=this.beans;t?t.calculatePages():e.calculateBounds(0,r.getRowCount()-1)}},AX=class extends Ee{constructor(){super(...arguments),this.beanName="pageBounds",this.pixelOffset=0}getFirstRow(){return this.topRowBounds?.rowIndex??-1}getLastRow(){return this.bottomRowBounds?.rowIndex??-1}getCurrentPageHeight(){const{topRowBounds:e,bottomRowBounds:t}=this;return!e||!t?0:Math.max(t.rowTop+t.rowHeight-e.rowTop,0)}getCurrentPagePixelRange(){const{topRowBounds:e,bottomRowBounds:t}=this,r=e?.rowTop??0,n=t?t.rowTop+t.rowHeight:0;return{pageFirstPixel:r,pageLastPixel:n}}calculateBounds(e,t){const{rowModel:r}=this.beans,n=r.getRowBounds(e);n&&(n.rowIndex=e),this.topRowBounds=n;const i=r.getRowBounds(t);i&&(i.rowIndex=t),this.bottomRowBounds=i,this.calculatePixelOffset()}getPixelOffset(){return this.pixelOffset}calculatePixelOffset(){const e=this.topRowBounds?.rowTop??0;this.pixelOffset!==e&&(this.pixelOffset=e,this.eventSvc.dispatchEvent({type:"paginationPixelOffsetChanged"}))}},kX=".ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top{min-width:0;overflow:hidden;position:relative}.ag-pinned-left-sticky-top,.ag-pinned-right-sticky-top{height:100%;overflow:hidden;position:relative}.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{height:100%;overflow:hidden;width:100%}.ag-pinned-left-header,.ag-pinned-right-header{display:inline-block;height:100%;overflow:hidden;position:relative}.ag-body-horizontal-scroll:not(.ag-scrollbar-invisible){.ag-horizontal-left-spacer:not(.ag-scroller-corner){border-right:var(--ag-pinned-column-border)}.ag-horizontal-right-spacer:not(.ag-scroller-corner){border-left:var(--ag-pinned-column-border)}}.ag-pinned-right-header{border-left:var(--ag-pinned-column-border)}.ag-pinned-left-header{border-right:var(--ag-pinned-column-border)}.ag-cell.ag-cell-first-right-pinned:not(.ag-cell-range-left,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-left:var(--ag-pinned-column-border)}.ag-cell.ag-cell-last-left-pinned:not(.ag-cell-range-right,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-right:var(--ag-pinned-column-border)}.ag-pinned-left-header .ag-header-cell-resize:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}.ag-pinned-right-header .ag-header-cell-resize:after{left:50%}.ag-pinned-left-header .ag-header-cell-resize{right:-3px}.ag-pinned-right-header .ag-header-cell-resize{left:-3px}",PX=class extends Ee{constructor(e,t){super(),this.isLeft=e,this.elements=t,this.getWidth=e?()=>this.beans.pinnedCols.leftWidth:()=>this.beans.pinnedCols.rightWidth}postConstruct(){this.addManagedEventListeners({[`${this.isLeft?"left":"right"}PinnedWidthChanged`]:this.onPinnedWidthChanged.bind(this)})}onPinnedWidthChanged(){const e=this.getWidth(),t=e>0;for(const r of this.elements)r&&(Er(r,t),Js(r,e))}},MX=class extends Ee{constructor(){super(...arguments),this.beanName="pinnedCols"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,t=>{this.gridBodyCtrl=t.gridBodyCtrl});const e=this.checkContainerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){const{gos:e,visibleCols:t,eventSvc:r}=this.beans,n=bn(e,"print"),i=n?0:t.getColsLeftWidth(),s=n?0:t.getDisplayedColumnsRightWidth();i!=this.leftWidth&&(this.leftWidth=i,r.dispatchEvent({type:"leftPinnedWidthChanged"})),s!=this.rightWidth&&(this.rightWidth=s,r.dispatchEvent({type:"rightPinnedWidthChanged"}))}keepPinnedColumnsNarrowerThanViewport(){const e=this.gridBodyCtrl.eBodyViewport,t=lf(e);if(t<=50)return;const r=this.getPinnedColumnsOverflowingViewport(t-50),n=this.gos.getCallback("processUnpinnedColumns"),{columns:i,hasLockedPinned:s}=r;let o=i;!o.length&&!s||(n&&(o=n({columns:o,viewportWidth:t})),o?.length&&(o=o.filter(a=>!Go(a)),this.setColsPinned(o,null,"viewportSizeFeature")))}createPinnedWidthFeature(e,...t){return new PX(e,t)}setColsPinned(e,t,r){const{colModel:n,colAnimation:i,visibleCols:s,gos:o}=this.beans;if(!n.cols||!e?.length)return;if(bn(o,"print")){Me(37);return}i?.start();let a;t===!0||t==="left"?a="left":t==="right"?a="right":a=null;const u=[];for(const d of e){if(!d)continue;const h=n.getCol(d);h&&h.getPinned()!==a&&(this.setColPinned(h,a),u.push(h))}u.length&&(s.refresh(r),w_(this.eventSvc,u,r)),i?.finish()}initCol(e){const{pinned:t,initialPinned:r}=e.colDef;t!==void 0?this.setColPinned(e,t):this.setColPinned(e,r)}setColPinned(e,t){t===!0||t==="left"?e.pinned="left":t==="right"?e.pinned="right":e.pinned=null,e.dispatchStateUpdatedEvent("pinned")}setupHeaderPinnedWidth(e){const{scrollVisibleSvc:t}=this.beans;if(e.pinned==null)return;const r=e.pinned==="left",n=e.pinned==="right";e.hidden=!0;const i=()=>{const s=r?this.leftWidth:this.rightWidth;if(s==null)return;const o=s==0,a=e.hidden!==o,u=this.gos.get("enableRtl"),d=t.getScrollbarWidth(),g=t.verticalScrollShowing&&(u&&r||!u&&n)?s+d:s;e.comp.setPinnedContainerWidth(`${g}px`),e.comp.setDisplayed(!o),a&&(e.hidden=o,e.refresh())};e.addManagedEventListeners({leftPinnedWidthChanged:i,rightPinnedWidthChanged:i,scrollVisibilityChanged:i,scrollbarWidthChanged:i})}getHeaderResizeDiff(e,t){if(t.getPinned()){const{leftWidth:n,rightWidth:i}=this,s=lf(this.beans.ctrlsSvc.getGridBodyCtrl().eBodyViewport)-50;if(n+i+e>s)if(s>n+i)e=s-n-i;else return 0}return e}getPinnedColumnsOverflowingViewport(e){const t=this.rightWidth??0,r=this.leftWidth??0,n=t+r;let i=!1;if(n<e)return{columns:[],hasLockedPinned:i};const{visibleCols:s}=this.beans,o=[...s.leftCols],a=[...s.rightCols];let u=0,d=0;const h=0,g=[];let m=n-h-e;for(;(d<o.length||u<a.length)&&m>0;){if(u<a.length){const v=a[u++];if(v.colDef.lockPinned){i=!0;continue}m-=v.getActualWidth(),g.push(v)}if(d<o.length&&m>0){const v=o[d++];if(v.colDef.lockPinned){i=!0;continue}m-=v.getActualWidth(),g.push(v)}}return{columns:g,hasLockedPinned:i}}},_X={moduleName:"PinnedColumn",version:Ue,beans:[MX],css:[kX]},LX=class extends Ee{constructor(){super(),this.beanName="ariaAnnounce",this.descriptionContainer=null,this.pendingAnnouncements=new Map,this.lastAnnouncement="",this.updateAnnouncement=yn(this,this.updateAnnouncement.bind(this),200)}postConstruct(){const e=this.beans,t=un(e),r=this.descriptionContainer=t.createElement("div");r.classList.add("ag-aria-description-container"),AM(r,"polite"),Ez(r,"additions text"),xz(r,!0),e.eGridDiv.appendChild(r)}announceValue(e,t){this.pendingAnnouncements.set(t,e),this.updateAnnouncement()}updateAnnouncement(){if(!this.descriptionContainer)return;const e=Array.from(this.pendingAnnouncements.values()).join(". ");this.pendingAnnouncements.clear(),this.descriptionContainer.textContent="",setTimeout(()=>{this.handleAnnouncementUpdate(e)},50)}handleAnnouncementUpdate(e){if(!this.isAlive()||!this.descriptionContainer)return;let t=e;if(t==null||t.replace(/[ .]/g,"")==""){this.lastAnnouncement="";return}this.lastAnnouncement===t&&(t=`${t}`),this.lastAnnouncement=t,this.descriptionContainer.textContent=t}destroy(){super.destroy();const{descriptionContainer:e}=this;e&&(ci(e),e.remove()),this.descriptionContainer=null,this.pendingAnnouncements.clear()}},IX={moduleName:"Aria",version:Ue,beans:[LX]},OX=":where(.ag-delay-render){.ag-cell,.ag-header-cell,.ag-header-group-cell,.ag-row,.ag-spanned-cell-wrapper{visibility:hidden}}",UD="ag-delay-render",NX=class extends Ee{constructor(){super(...arguments),this.beanName="colDelayRenderSvc",this.hideRequested=!1,this.alreadyRevealed=!1,this.timesRetried=0,this.requesters=new Set}hideColumns(e){this.alreadyRevealed||this.requesters.has(e)||(this.requesters.add(e),this.hideRequested||(this.beans.ctrlsSvc.whenReady(this,t=>{t.gridBodyCtrl.eGridBody.classList.add(UD)}),this.hideRequested=!0))}revealColumns(e){if(this.alreadyRevealed||!this.isAlive()||(this.requesters.delete(e),this.requesters.size>0))return;const{renderStatus:t,ctrlsSvc:r}=this.beans;if(t){if(!t.areHeaderCellsRendered()&&this.timesRetried<5){this.timesRetried++,setTimeout(()=>this.revealColumns(e));return}this.timesRetried=0}r.getGridBodyCtrl().eGridBody.classList.remove(UD),this.alreadyRevealed=!0}},BX={moduleName:"ColumnDelayRender",version:Ue,beans:[NX],css:[OX]};function HX(e){e.overlays?.showLoadingOverlay()}function GX(e){e.overlays?.showNoRowsOverlay()}function VX(e){e.overlays?.hideOverlay()}var zX=".ag-overlay{inset:0;pointer-events:none;position:absolute;z-index:2}.ag-overlay-panel,.ag-overlay-wrapper{display:flex;height:100%;width:100%}.ag-overlay-wrapper{align-items:center;flex:none;justify-content:center;text-align:center}.ag-overlay-loading-wrapper{pointer-events:all}.ag-overlay-loading-center{background:var(--ag-background-color);border:solid var(--ag-border-width) var(--ag-border-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-popup-shadow);padding:var(--ag-spacing)}",WX={tag:"div",cls:"ag-overlay",role:"presentation",children:[{tag:"div",cls:"ag-overlay-panel",role:"presentation",children:[{tag:"div",ref:"eOverlayWrapper",cls:"ag-overlay-wrapper",role:"presentation"}]}]},VL=class extends Dr{constructor(){super(WX),this.eOverlayWrapper=tt,this.activePromise=null,this.activeOverlay=null,this.updateListenerDestroyFunc=null,this.activeCssClass=null,this.elToFocusAfter=null,this.registerCSS(zX)}handleKeyDown(e){if(e.key!==me.TAB||e.defaultPrevented||zo(e))return;const t=this.beans;if(vc(t,this.eOverlayWrapper,!1,e.shiftKey))return;let n=!1;e.shiftKey?n=t.focusSvc.focusGridView({column:ir(t.visibleCols.allCols),backwards:!0,canFocusOverlay:!1}):n=td(t,!1),n&&e.preventDefault()}updateLayoutClasses(e,t){const r=this.eOverlayWrapper.classList,{AUTO_HEIGHT:n,NORMAL:i,PRINT:s}=o0;r.toggle(n,t.autoHeight),r.toggle(i,t.normal),r.toggle(s,t.print)}postConstruct(){this.createManagedBean(new xx(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.beans.overlays.setOverlayWrapperComp(this),this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)})}setWrapperTypeClass(e){const t=this.eOverlayWrapper.classList;this.activeCssClass&&t.toggle(this.activeCssClass,!1),this.activeCssClass=e,t.toggle(e,!0)}showOverlay(e,t,r,n){if(this.setWrapperTypeClass(t),this.destroyActiveOverlay(),this.elToFocusAfter=null,this.activePromise=e,!!e){if(this.setDisplayed(!0,{skipAriaHidden:!0}),r&&this.isGridFocused()){const i=Fr(this.beans);i&&!RM(this.beans)&&(this.elToFocusAfter=i)}e.then(i=>{if(this.activePromise!==e){this.activeOverlay!==i&&(this.destroyBean(i),i=null);return}if(this.activePromise=null,!!i){if(this.activeOverlay!==i&&(this.eOverlayWrapper.appendChild(i.getGui()),this.activeOverlay=i,n)){const s=i;this.updateListenerDestroyFunc=this.addManagedPropertyListener(n,({currentValue:o})=>{s.refresh?.(it(this.gos,{...o??{}}))})}r&&this.isGridFocused()&&rc(this.eOverlayWrapper)}})}}updateOverlayWrapperPaddingTop(e){this.eOverlayWrapper.style.setProperty("padding-top",`${e}px`)}destroyActiveOverlay(){this.activePromise=null;const e=this.activeOverlay;if(!e)return;let t=this.elToFocusAfter;this.activeOverlay=null,this.elToFocusAfter=null,t&&!this.isGridFocused()&&(t=null);const r=this.updateListenerDestroyFunc;r&&(r(),this.updateListenerDestroyFunc=null),this.destroyBean(e),ci(this.eOverlayWrapper),t?.focus?.({preventScroll:!0})}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}isGridFocused(){const e=Fr(this.beans);return!!e&&this.beans.eGridDiv.contains(e)}destroy(){this.elToFocusAfter=null,this.destroyActiveOverlay(),this.beans.overlays.setOverlayWrapperComp(void 0),super.destroy()}},UX={selector:"AG-OVERLAY-WRAPPER",component:VL},$X=class extends Ee{constructor(){super(...arguments),this.beanName="overlays",this.state=0,this.showInitialOverlay=!0,this.wrapperPadding=0}postConstruct(){this.isClientSide=_r(this.gos),this.isServerSide=!this.isClientSide&&pc(this.gos);const e=()=>this.updateOverlayVisibility();this.addManagedEventListeners({newColumnsLoaded:e,rowDataUpdated:e,gridSizeChanged:this.refreshWrapperPadding.bind(this),rowCountReady:()=>{this.showInitialOverlay=!1,this.updateOverlayVisibility()}}),this.addManagedPropertyListener("loading",e)}setOverlayWrapperComp(e){this.eWrapper=e,this.updateOverlayVisibility()}isVisible(){return this.state!==0&&!!this.eWrapper}isExclusive(){return this.state===1&&!!this.eWrapper}showLoadingOverlay(){this.showInitialOverlay=!1;const e=this.gos,t=e.get("loading");!t&&(t!==void 0||e.get("suppressLoadingOverlay"))||this.doShowLoadingOverlay()}showNoRowsOverlay(){this.showInitialOverlay=!1;const e=this.gos;e.get("loading")||e.get("suppressNoRowsOverlay")||this.doShowNoRowsOverlay()}hideOverlay(){if(this.showInitialOverlay=!1,this.gos.get("loading")){Me(99);return}this.doHideOverlay()}getOverlayWrapperSelector(){return UX}getOverlayWrapperCompClass(){return VL}updateOverlayVisibility(){if(!this.eWrapper){this.state=0;return}const{state:e,isClientSide:t,isServerSide:r,beans:{gos:n,colModel:i,rowModel:s}}=this;let o=this.gos.get("loading");o!==void 0&&(this.showInitialOverlay=!1),this.showInitialOverlay&&o===void 0&&!n.get("suppressLoadingOverlay")&&(o=!n.get("columnDefs")||!i.ready||!n.get("rowData")&&t),o?e!==1&&this.doShowLoadingOverlay():(this.showInitialOverlay=!1,t&&s.isEmpty()&&!n.get("suppressNoRowsOverlay")?e!==2&&this.doShowNoRowsOverlay():(e===1||!r&&e!==0)&&this.doHideOverlay())}doShowLoadingOverlay(){this.eWrapper&&(this.state=1,this.showOverlay(OW(this.beans.userCompFactory,it(this.gos,{})),"ag-overlay-loading-wrapper","loadingOverlayComponentParams"),this.updateExclusive())}doShowNoRowsOverlay(){this.eWrapper&&(this.state=2,this.showOverlay(NW(this.beans.userCompFactory,it(this.gos,{})),"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams"),this.updateExclusive())}doHideOverlay(){this.eWrapper&&(this.state=0,this.eWrapper.hideOverlay(),this.updateExclusive())}showOverlay(e,t,r){const n=e?.newAgStackInstance()??null;this.eWrapper?.showOverlay(n,t,this.isExclusive(),r),this.refreshWrapperPadding()}updateExclusive(){const e=this.exclusive;this.exclusive=this.isExclusive(),this.exclusive!==e&&this.eventSvc.dispatchEvent({type:"overlayExclusiveChanged"})}refreshWrapperPadding(){const e=this.eWrapper;if(!e)return;let t=0;this.state===2&&(t=this.beans.ctrlsSvc.get("gridHeaderCtrl")?.headerHeight||0),this.wrapperPadding!==t&&(this.wrapperPadding=t,e.updateOverlayWrapperPaddingTop(t))}},jX={moduleName:"Overlay",version:Ue,userComponents:{agLoadingOverlay:S$,agNoRowsOverlay:E$},apiFunctions:{showLoadingOverlay:HX,showNoRowsOverlay:GX,hideOverlay:VX},beans:[$X]},YX=class extends Ee{constructor(){super(...arguments),this.beanName="rowContainerHeight",this.scrollY=0,this.uiBodyHeight=0}postConstruct(){this.addManagedEventListeners({bodyHeightChanged:this.updateOffset.bind(this)}),this.maxDivHeight=VW(),ec(this.gos,"RowContainerHeightService - maxDivHeight = "+this.maxDivHeight)}updateOffset(){if(!this.stretching)return;const e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;ec(this.gos,`RowContainerHeightService - Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventSvc.dispatchEvent({type:"rowContainerHeightChanged"}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){const t=typeof e=="number"?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventSvc.dispatchEvent({type:"heightScaleChanged"}))}setModelHeight(e){this.modelHeight=e,this.stretching=e!=null&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){const e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition();return e.bottom-e.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;const t=this.modelHeight-this.getUiBodyHeight(),r=e/t;return this.maxScrollY*r}},KX=400,qX=class extends Ee{constructor(){super(...arguments),this.beanName="rowRenderer",this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{const e=()=>{for(const s of this.getAllCellCtrls())s.onCellSelectionChanged()},t=()=>{for(const s of this.getAllCellCtrls())s.updateRangeBordersIfRangeCount()},r=()=>{this.eventSvc.addListener("cellSelectionChanged",e),this.eventSvc.addListener("columnMoved",t),this.eventSvc.addListener("columnPinned",t),this.eventSvc.addListener("columnVisible",t)},n=()=>{this.eventSvc.removeListener("cellSelectionChanged",e),this.eventSvc.removeListener("columnMoved",t),this.eventSvc.removeListener("columnPinned",t),this.eventSvc.removeListener("columnVisible",t)};this.addDestroyFunc(()=>n()),this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],()=>{ja(this.gos)?r():n()}),ja(this.gos)&&r()}}wireBeans(e){this.pageBounds=e.pageBounds,this.colModel=e.colModel,this.pinnedRowModel=e.pinnedRowModel,this.rowModel=e.rowModel,this.focusSvc=e.focusSvc,this.rowContainerHeight=e.rowContainerHeight,this.ctrlsSvc=e.ctrlsSvc,this.editSvc=e.editSvc}postConstruct(){this.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()})}initialise(){this.addManagedEventListeners({paginationChanged:this.onPageLoaded.bind(this),pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this),pinnedRowsChanged:this.onPinnedRowsChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),bodyScroll:this.onBodyScroll.bind(this),bodyHeightChanged:this.redraw.bind(this,{})}),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListener("suppressCellFocus",n=>this.onSuppressCellFocusChanged(n.currentValue)),this.addManagedPropertyListeners(["groupSuppressBlankHeader","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],()=>this.redrawRows()),this.addManagedPropertyListener("cellSelection",({currentValue:n,previousValue:i})=>{(!i&&n||i&&!n)&&this.redrawRows()});const{stickyRowSvc:e,gos:t,showRowGroupCols:r}=this.beans;if(r&&this.addManagedPropertyListener("showOpenedGroup",()=>{const n=r.getShowRowGroupCols();n.length&&this.refreshCells({columns:n,force:!0})}),e)this.stickyRowFeature=e.createStickyRowFeature(this,this.createRowCon.bind(this),this.destroyRowCtrls.bind(this));else{const n=this.gridBodyCtrl;n.setStickyTopHeight(0),n.setStickyBottomHeight(0)}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=bn(t,"print"),this.embedFullWidthRows=this.printLayout||t.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){const e=this.getKeepDetailRowsCount(),t=e??3;this.cachedRowCtrls=new XX(t)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?.stickyTopRowCtrls??[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?.stickyBottomRowCtrls??[]}updateAllRowCtrls(){const e=Object.values(this.rowCtrlsByRowIndex),t=Object.values(this.zombieRowCtrls),r=this.cachedRowCtrls?.getEntries()??[];t.length>0||r.length>0?this.allRowCtrls=[...e,...t,...r]:this.allRowCtrls=e}isCellBeingRendered(e,t){const r=this.rowCtrlsByRowIndex[e];return!t||!r?!!r:r.isFullWidth()?!0:!!this.beans.spannedRowRenderer?.getCellByPosition({rowIndex:e,column:t,rowPinned:null})||!!r.getCellCtrl(t)||!r.isRowRendered()}updateCellFocus(e){for(const t of this.getAllCellCtrls())t.onCellFocused(e);for(const t of this.getFullWidthRowCtrls())t.onFullWidthRowFocused(e)}onCellFocusChanged(e){if(e?.rowIndex!=null&&!e.rowPinned){const t=this.beans.colModel.getCol(e.column)??void 0;this.isCellBeingRendered(e.rowIndex,t)||this.redraw()}this.updateCellFocus(e)}onSuppressCellFocusChanged(e){for(const t of this.getAllCellCtrls())t.onSuppressCellFocusChanged(e);for(const t of this.getFullWidthRowCtrls())t.onSuppressCellFocusChanged(e)}registerCellEventListeners(){this.addManagedEventListeners({cellFocused:e=>this.onCellFocusChanged(e),cellFocusCleared:()=>this.updateCellFocus(),flashCells:e=>{const{cellFlashSvc:t}=this.beans;if(t)for(const r of this.getAllCellCtrls())t.onFlashCells(r,e)},columnHoverChanged:()=>{for(const e of this.getAllCellCtrls())e.onColumnHover()},displayedColumnsChanged:()=>{for(const e of this.getAllCellCtrls())e.onDisplayedColumnsChanged()},displayedColumnsWidthChanged:()=>{if(this.printLayout)for(const e of this.getAllCellCtrls())e.onLeftChanged()}}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedEventListeners({gridColumnsChanged:this.refreshListenersToColumnsForCellComps.bind(this)}),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){for(const e of this.destroyFuncsForColumnListeners)e();this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners();const e=this.colModel.getCols();for(const t of e){const r=u=>{for(const d of this.getAllCellCtrls())d.column===t&&u(d)},n=()=>{r(u=>u.onLeftChanged())},i=()=>{r(u=>u.onWidthChanged())},s=()=>{r(u=>u.onFirstRightPinnedChanged())},o=()=>{r(u=>u.onLastLeftPinnedChanged())},a=()=>{r(u=>u.onColDefChanged())};t.__addEventListener("leftChanged",n),t.__addEventListener("widthChanged",i),t.__addEventListener("firstRightPinnedChanged",s),t.__addEventListener("lastLeftPinnedChanged",o),t.__addEventListener("colDefChanged",a),this.destroyFuncsForColumnListeners.push(()=>{t.__removeEventListener("leftChanged",n),t.__removeEventListener("widthChanged",i),t.__removeEventListener("firstRightPinnedChanged",s),t.__removeEventListener("lastLeftPinnedChanged",o),t.__removeEventListener("colDefChanged",a)})}}onDomLayoutChanged(){const e=bn(this.gos,"print"),t=e||this.gos.get("embedFullWidthRows"),r=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,r&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){const t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsNotSpanningForColumn(e){const t=[];for(const r of this.getAllRowCtrls()){const n=r.getCellCtrl(e,!0)?.eGui;n&&t.push(n)}return t}refreshFloatingRowComps(e=!0){this.refreshFloatingRows(this.topRowCtrls,"top",e),this.refreshFloatingRows(this.bottomRowCtrls,"bottom",e)}refreshFloatingRows(e,t,r){const{pinnedRowModel:n,beans:i,printLayout:s}=this,o=Object.fromEntries(e.map(u=>[u.rowNode.id,u]));n?.forEachPinnedRow(t,(u,d)=>{const h=e[d];h&&n.getPinnedRowById(h.rowNode.id,t)===void 0&&(h.destroyFirstPass(),h.destroySecondPass()),u.id in o&&r?(e[d]=o[u.id],delete o[u.id]):e[d]=new U0(u,i,!1,!1,s)});const a=(t==="top"?n?.getPinnedTopRowCount():n?.getPinnedBottomRowCount())??0;e.length=a}onPinnedRowDataChanged(){const e={recycleRows:!0};this.redrawAfterModelUpdate(e)}onPinnedRowsChanged(){this.redrawAfterModelUpdate({recycleRows:!0})}redrawRow(e,t=!1){if(e.sticky)this.stickyRowFeature?.refreshStickyNode(e);else if(this.cachedRowCtrls?.has(e)){this.cachedRowCtrls.removeRow(e);return}else{const r=n=>{const i=n[e.rowIndex];i&&i.rowNode===e&&(i.destroyFirstPass(),i.destroySecondPass(),n[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":r(this.topRowCtrls);break;case"bottom":r(this.bottomRowCtrls);break;default:r(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}t||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){const{editSvc:t}=this.beans;if(t?.isEditing()&&(t.isBatchEditing()?t.cleanupEditors():t.stopEditing(void 0,{source:"api"})),e!=null){for(const n of e??[])this.redrawRow(n,!0);this.dispatchDisplayedRowsChanged(!1);return}this.redrawAfterModelUpdate()}redrawAfterModelUpdate(e={}){this.getLockOnRefresh();const t=this.beans.focusSvc?.getFocusCellToUseAfterRefresh();this.updateContainerHeights(),this.scrollToTopIfNewData(e);const r=!e.domLayoutChanged&&!!e.recycleRows,n=e.animate&&Pu(this.gos),i=r?this.getRowsToRecycle():null;r||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender();const{stickyRowFeature:s,gos:o}=this;if(s){s.checkStickyRows();const a=s.extraTopHeight+s.extraBottomHeight;a&&this.updateContainerHeights(a)}this.recycleRows(i,n),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(o.get("enableRowPinning")?r:void 0),this.dispatchDisplayedRowsChanged(),t!=null&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){const t=e.newData||e.newPage,r=this.gos.get("suppressScrollOnNewData");t&&!r&&(this.gridBodyCtrl.scrollFeature.scrollToTop(),this.stickyRowFeature?.resetOffsets())}updateContainerHeights(e=0){const{rowContainerHeight:t}=this;if(this.printLayout){t.setModelHeight(null);return}let r=this.pageBounds.getCurrentPageHeight();r===0&&(r=1),t.setModelHeight(r+e)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error(eo(252));this.refreshInProgress=!0,this.beans.frameworkOverrides.getLockOnRefresh?.()}releaseLockOnRefresh(){this.refreshInProgress=!1,this.beans.frameworkOverrides.releaseLockOnRefresh?.()}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){if(!e)return;const t=this.beans.focusSvc,r=this.findPositionToFocus(e);if(!r){t.focusHeaderPosition({headerPosition:{headerRowIndex:qs(this.beans)-1,column:e.column}});return}if(e.rowIndex!==r.rowIndex||e.rowPinned!=r.rowPinned){t.setFocusedCell({...r,preventScrollOnBrowserFocus:!0,forceBrowserFocus:!0});return}t.doesRowOrCellHaveBrowserFocus()||this.updateCellFocus(it(this.gos,{...r,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"cellFocused"}))}findPositionToFocus(e){const{pagination:t,pageBounds:r}=this.beans;let n=e;for(n.rowPinned==null&&t&&r&&!t.isRowInPage(n.rowIndex)&&(n={rowPinned:null,rowIndex:r.getFirstRow()});n;){if(n.rowPinned==null&&r)if(n.rowIndex<r.getFirstRow()){if(n=z0(this.beans,{rowPinned:null,rowIndex:0}),!n)return null}else n.rowIndex>r.getLastRow()&&(n={rowPinned:null,rowIndex:r.getLastRow()});const i=this.getRowByPosition(n);if(i?.isAlive())return{...i.getRowPosition(),column:e.column};n=z0(this.beans,n)}return null}getAllCellCtrls(){const e=[],t=this.getAllRowCtrls(),r=t.length;for(let n=0;n<r;n++){const i=t[n].getAllCellCtrls(),s=i.length;for(let o=0;o<s;o++)e.push(i[o])}return e}getAllRowCtrls(){const{spannedRowRenderer:e}=this.beans,t=this.getStickyTopRowCtrls(),r=this.getStickyBottomRowCtrls();return[...this.topRowCtrls,...this.bottomRowCtrls,...t,...r,...e?.getCtrls("top")??[],...e?.getCtrls("bottom")??[],...e?.getCtrls("center")??[],...Object.values(this.rowCtrlsByRowIndex)]}addRenderedRowListener(e,t,r){const n=this.rowCtrlsByRowIndex[t];n&&n.addEventListener(e,r)}refreshCells({rowNodes:e,columns:t,force:r,suppressFlash:n}={}){const i={force:r,newData:!1,suppressFlash:n};for(const s of this.getCellCtrls(e,t))s.refreshOrDestroyCell(i);this.refreshFullWidth(e)}refreshRows(e={}){for(const t of this.getRowCtrls(e.rowNodes))t.refreshRow(e);this.refreshFullWidth(e.rowNodes)}refreshFullWidth(e){if(!e)return;let t=!1;for(const r of this.getRowCtrls(e)){if(!r.isFullWidth())continue;r.refreshFullWidth()||(t=!0,this.redrawRow(r.rowNode,!0))}t&&this.dispatchDisplayedRowsChanged(!1)}getRowCtrls(e){const t=$b(e),r=this.getAllRowCtrls();return!e||!t?r:r.filter(n=>{const i=n.rowNode;return jb(i,t)})}getCellCtrls(e,t){let r;$e(t)&&(r={},t.forEach(i=>{const s=this.colModel.getCol(i);$e(s)&&(r[s.getId()]=!0)}));const n=[];for(const i of this.getRowCtrls(e))for(const s of i.getAllCellCtrls()){const o=s.column.getId();r&&!r[o]||n.push(s)}return n}destroy(){this.removeAllRowComps(!0),super.destroy()}removeAllRowComps(e=!1){const t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t,e),this.stickyRowFeature?.destroyStickyCtrls()}getRowsToRecycle(){const e=[];for(const r of Object.keys(this.rowCtrlsByRowIndex))this.rowCtrlsByRowIndex[r].rowNode.id==null&&e.push(r);this.removeRowCtrls(e);const t={};for(const r of Object.values(this.rowCtrlsByRowIndex)){const n=r.rowNode;t[n.id]=r}return this.rowCtrlsByRowIndex={},t}removeRowCtrls(e,t=!1){for(const r of e){const n=this.rowCtrlsByRowIndex[r];n&&(n.destroyFirstPass(t),n.destroySecondPass()),delete this.rowCtrlsByRowIndex[r]}}onBodyScroll(e){e.direction==="vertical"&&this.redraw({afterScroll:!0})}redraw(e={}){const{focusSvc:t,animationFrameSvc:r}=this.beans,{afterScroll:n}=e;let i;const s=this.stickyRowFeature;s&&(i=t?.getFocusCellToUseAfterRefresh()||void 0);const o=this.firstRenderedRow,a=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let u=!1;if(s){u=s.checkStickyRows();const h=s.extraTopHeight+s.extraBottomHeight;h&&this.updateContainerHeights(h)}const d=this.firstRenderedRow!==o||this.lastRenderedRow!==a;if(!(n&&!u&&!d)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,n),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(n&&!u),i!=null)){const h=t?.getFocusCellToUseAfterRefresh();i!=null&&h==null&&(r?.flushAllFrames(),this.restoreFocusedCell(i))}}removeRowCompsNotToDraw(e,t){const r={};for(const s of e)r[s]=!0;const i=Object.keys(this.rowCtrlsByRowIndex).filter(s=>!r[s]);this.removeRowCtrls(i,t)}calculateIndexesToDraw(e){const t=[];for(let o=this.firstRenderedRow;o<=this.lastRenderedRow;o++)t.push(o);const r=this.beans.pagination,n=this.beans.focusSvc?.getFocusedCell()?.rowIndex;n!=null&&(n<this.firstRenderedRow||n>this.lastRenderedRow)&&(!r||r.isRowInPage(n))&&n<this.rowModel.getRowCount()&&t.push(n);const i=o=>{const a=o.rowNode.rowIndex;a==null||a===n||(a<this.firstRenderedRow||a>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(o)&&t.push(a)};for(const o of Object.values(this.rowCtrlsByRowIndex))i(o);if(e)for(const o of Object.values(e))i(o);t.sort((o,a)=>o-a);const s=[];for(let o=0;o<t.length;o++){const a=t[o],u=this.rowModel.getRow(a);u&&!u.sticky&&s.push(a)}return s}recycleRows(e,t=!1,r=!1){const n=this.calculateIndexesToDraw(e);(this.printLayout||r)&&(t=!1),this.removeRowCompsNotToDraw(n,!t);for(const i of n)this.createOrUpdateRowCtrl(i,e,t,r);if(e){const{animationFrameSvc:i}=this.beans;i?.active&&r&&!this.printLayout?i.addDestroyTask(()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(e,t)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(e=!1){this.eventSvc.dispatchEvent({type:"displayedRowsChanged",afterScroll:e})}onDisplayedColumnsChanged(){const{visibleCols:e}=this.beans,t=e.isPinningLeft(),r=e.isPinningRight();(this.pinningLeft!==t||r!==this.pinningRight)&&(this.pinningLeft=t,this.pinningRight=r,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const e=[];for(const t of this.getFullWidthRowCtrls()){const r=t.rowNode.rowIndex;e.push(r.toString())}this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){const t=$b(e);return this.getAllRowCtrls().filter(r=>{if(!r.isFullWidth())return!1;const n=r.rowNode;return!(t!=null&&!jb(n,t))})}createOrUpdateRowCtrl(e,t,r,n){let i,s=this.rowCtrlsByRowIndex[e];if(s||(i=this.rowModel.getRow(e),$e(i)&&$e(t)&&t[i.id]&&i.alreadyRendered&&(s=t[i.id],t[i.id]=null)),!s)if(i||(i=this.rowModel.getRow(e)),$e(i))s=this.createRowCon(i,r,n);else return;i&&(i.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=s}destroyRowCtrls(e,t){const r=[];if(e){for(const n of Object.values(e))if(n){if(this.cachedRowCtrls&&n.isCacheable()){this.cachedRowCtrls.addRow(n);continue}if(n.destroyFirstPass(!t),t){const i=n.instanceId;this.zombieRowCtrls[i]=n,r.push(()=>{n.destroySecondPass(),delete this.zombieRowCtrls[i]})}else n.destroySecondPass()}}t&&(r.push(()=>{this.isAlive()&&(this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged())}),window.setTimeout(()=>{for(const n of r)n()},KX))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){const e=this.getRowBuffer(),t=zl(this.beans);return e*t}workOutFirstAndLastRowsToRender(){const{rowContainerHeight:e,pageBounds:t,rowModel:r}=this;e.updateOffset();let n,i;if(!r.isRowsToRender())n=0,i=-1;else if(this.printLayout)this.beans.environment.refreshRowHeightVariable(),n=t.getFirstRow(),i=t.getLastRow();else{const h=this.getRowBufferInPixels(),g=this.ctrlsSvc.getScrollFeature(),m=this.gos.get("suppressRowVirtualisation");let v=!1,w,C;do{const A=t.getPixelOffset(),{pageFirstPixel:D,pageLastPixel:M}=t.getCurrentPagePixelRange(),F=e.divStretchOffset,O=g.getVScrollPosition(),L=O.top,W=O.bottom;m?(w=D+F,C=M+F):(w=Math.max(L+A-h,D)+F,C=Math.min(W+A+h,M)+F),this.firstVisibleVPixel=Math.max(L+A,D)+F,this.lastVisibleVPixel=Math.min(W+A,M)+F,v=this.ensureAllRowsInRangeHaveHeightsCalculated(w,C)}while(v);let b=r.getRowIndexAtPixel(w),x=r.getRowIndexAtPixel(C);const R=t.getFirstRow(),E=t.getLastRow();b<R&&(b=R),x>E&&(x=E),n=b,i=x}const s=bn(this.gos,"normal"),o=this.gos.get("suppressMaxRenderedRowRestriction"),a=Math.max(this.getRowBuffer(),500);s&&!o&&i-n>a&&(i=n+a);const u=n!==this.firstRenderedRow,d=i!==this.lastRenderedRow;(u||d)&&(this.firstRenderedRow=n,this.lastRenderedRow=i,this.eventSvc.dispatchEvent({type:"viewportChanged",firstRow:n,lastRow:i}))}dispatchFirstDataRenderedEvent(){this.dataFirstRenderedFired||(this.dataFirstRenderedFired=!0,Jo(this.beans,()=>{this.beans.eventSvc.dispatchEvent({type:"firstDataRendered",firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow})}))}ensureAllRowsInRangeHaveHeightsCalculated(e,t){const r=this.pinnedRowModel?.ensureRowHeightsValid(),n=this.stickyRowFeature?.ensureRowHeightsValid(),{pageBounds:i,rowModel:s}=this,o=s.ensureRowHeightsValid(e,t,i.getFirstRow(),i.getLastRow());return(o||n)&&this.eventSvc.dispatchEvent({type:"recalculateRowBounds"}),n||o||r?(this.updateContainerHeights(),!0):!1}doNotUnVirtualiseRow(e){const n=e.rowNode,i=this.focusSvc.isRowFocused(n.rowIndex,n.rowPinned),s=this.editSvc?.isEditing(e),o=n.detail;return i||s||o?!!this.isRowPresent(n):!1}isRowPresent(e){return this.rowModel.isRowPresent(e)?this.beans.pagination?.isRowInPage(e.rowIndex)??!0:!1}createRowCon(e,t,r){const n=this.cachedRowCtrls?.getRow(e)??null;if(n)return n;const i=r&&!this.printLayout&&!!this.beans.animationFrameSvc?.active;return new U0(e,this.beans,t,i,this.printLayout)}getRenderedNodes(){const e=Object.values(this.rowCtrlsByRowIndex).map(n=>n.rowNode),t=this.getStickyTopRowCtrls().map(n=>n.rowNode),r=this.getStickyBottomRowCtrls().map(n=>n.rowNode);return[...t,...e,...r]}getRowByPosition(e){let t;const{rowIndex:r}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[r];break;case"bottom":t=this.bottomRowCtrls[r];break;default:t=this.rowCtrlsByRowIndex[r],t||(t=this.getStickyTopRowCtrls().find(n=>n.rowNode.rowIndex===r)||null,t||(t=this.getStickyBottomRowCtrls().find(n=>n.rowNode.rowIndex===r)||null));break}return t}isRangeInRenderedViewport(e,t){if(e==null||t==null)return!1;const n=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!n}},XX=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.rowNode.id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){const t=this.entriesList[0];t.destroyFirstPass(),t.destroySecondPass(),this.removeFromCache(t)}}getRow(e){if(e?.id==null)return null;const t=this.entriesMap[e.id];return t?(this.removeFromCache(t),t.setCached(!1),t.rowNode!=e?null:t):null}has(e){return this.entriesMap[e.id]!=null}removeRow(e){const t=e.id,r=this.entriesMap[t];delete this.entriesMap[t],Ds(this.entriesList,r)}removeFromCache(e){const t=e.rowNode.id;delete this.entriesMap[t],Ds(this.entriesList,e)}getEntries(){return this.entriesList}};function $b(e){if(!e)return;const t={top:{},bottom:{},normal:{}};for(const r of e){const n=r.id;switch(r.rowPinned){case"top":t.top[n]=r;break;case"bottom":t.bottom[n]=r;break;default:t.normal[n]=r;break}}return t}function jb(e,t){const r=e.id;switch(e.rowPinned){case"top":return t.top[r]!=null;case"bottom":return t.bottom[r]!=null;default:return t.normal[r]!=null}}var QX=class extends Ee{constructor(){super(...arguments),this.beanName="rowNodeSorter"}postConstruct(){const{gos:e}=this;this.isAccentedSort=e.get("accentedSort"),this.primaryColumnsSortGroups=Ys(e),this.addManagedPropertyListener("accentedSort",t=>this.isAccentedSort=t.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=Ys(e))}doFullSort(e,t){const r=e.map((n,i)=>({currentPos:i,rowNode:n}));return r.sort(this.compareRowNodes.bind(this,t)),r.map(n=>n.rowNode)}compareRowNodes(e,t,r){const n=t.rowNode,i=r.rowNode;for(let s=0,o=e.length;s<o;s++){const a=e[s],u=a.sort==="desc",d=this.getValue(n,a.column),h=this.getValue(i,a.column);let g;const m=this.getComparator(a,n);if(m?g=m(d,h,n,i,u):g=mz(d,h,this.isAccentedSort),!isNaN(g)&&g!==0)return a.sort==="asc"?g:g*-1}return t.currentPos-r.currentPos}getComparator(e,t){const r=e.column,n=r.getColDef().comparator;if(n!=null)return n;if(!r.getColDef().showRowGroup)return;const i=!t.group&&r.getColDef().field;if(!i)return;const s=this.beans.colModel.getColDefCol(i);if(s)return s.getColDef().comparator}getValue(e,t){const{valueSvc:r,colModel:n,showRowGroupCols:i,gos:s}=this.beans;if(!this.primaryColumnsSortGroups)return r.getValue(t,e,!1);if(e.rowGroupColumn===t){if(s_(s,n.isPivotActive())){const d=e.data?e:j_(e.childrenAfterGroup);return d&&r.getValue(t,d,!1)}const u=i?.getShowRowGroupCol(t.getId());return u?e.groupData?.[u.getId()]:void 0}if(!(e.group&&t.getColDef().showRowGroup))return r.getValue(t,e,!1)}};function ZX(e){e.sortSvc?.onSortChanged("api")}var zL={moduleName:"Sort",version:Ue,beans:[pq,QX],apiFunctions:{onSortChanged:ZX},userComponents:{agSortIndicator:Px},icons:{sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"}},JX=class extends Ee{constructor(){super(...arguments),this.beanName="syncSvc",this.waitingForColumns=!1}postConstruct(){this.addManagedPropertyListener("columnDefs",e=>this.setColumnDefs(e))}start(){this.beans.ctrlsSvc.whenReady(this,()=>{const e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(e){const{colModel:t,rowModel:r}=this.beans;t.setColumnDefs(e??[],"gridInitializing"),r.start()}gridReady(){const{eventSvc:e,gos:t}=this;e.dispatchEvent({type:"gridReady"}),ec(t,`initialised successfully, enterprise = ${t.isModuleRegistered("EnterpriseCore")}`)}setColumnDefs(e){const t=this.gos.get("columnDefs");if(t){if(this.waitingForColumns){this.waitingForColumns=!1,this.setColumnsAndData(t);return}this.beans.colModel.setColumnDefs(t,_u(e.source))}}};function eQ(e){e.valueCache?.expire()}function tQ(e,t){const{colKey:r,rowNode:n,useFormatter:i}=t,s=e.colModel.getColDefCol(r)??e.colModel.getCol(r);if(xr(s))return null;const o=e.valueSvc.getValueForDisplay(s,n,i);return i?o.valueFormatted??md(o.value):o.value}var rQ="paste",nQ=class extends Ee{constructor(){super(...arguments),this.beanName="changeDetectionSvc",this.clientSideRowModel=null}postConstruct(){const{gos:e,rowModel:t}=this.beans;_r(e)&&(this.clientSideRowModel=t),this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this)})}onCellValueChanged(e){const{gos:t,rowRenderer:r}=this.beans;if(e.source===rQ||t.get("suppressChangeDetection"))return;const n=e.node,i=[n],s=this.clientSideRowModel,o=s?.rootNode;if(o&&!n.isRowPinned()){const a=t.get("aggregateOnlyChangedColumns"),u=new gf(a,o);u.addParentNode(n.parent,[e.column]),s.doAggregate(u),u.forEachChangedNodeDepthFirst(d=>{i.push(d),d.sibling&&i.push(d.sibling)})}r.refreshCells({rowNodes:i})}},iQ=class extends Ee{constructor(){super(...arguments),this.beanName="expressionSvc",this.cache={}}evaluate(e,t){if(typeof e=="string")return this.evaluateExpression(e,t);Zt(15,{expression:e})}evaluateExpression(e,t){try{return this.createExpressionFunction(e)(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.getValue,t.column,t.columnGroup)}catch(r){return Zt(16,{expression:e,params:t,e:r}),null}}createExpressionFunction(e){const t=this.cache;if(t[e])return t[e];const r=this.createFunctionBody(e),n=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, getValue, column, columnGroup",r);return t[e]=n,n}createFunctionBody(e){return e.includes("return")?e:"return "+e+";"}},sQ=class extends Ee{constructor(){super(...arguments),this.beanName="valueCache",this.cacheVersion=0}postConstruct(){const e=this.gos;this.active=e.get("valueCache"),this.neverExpires=e.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,r){if(this.active){const n=this.cacheVersion;e.__cacheVersion!==n&&(e.__cacheVersion=n,e.__cacheData={}),e.__cacheData[t]=r}}getValue(e,t){if(!(!this.active||e.__cacheVersion!==this.cacheVersion))return e.__cacheData[t]}},oQ={moduleName:"ValueCache",version:Ue,beans:[sQ],apiFunctions:{expireValueCache:eQ}},aQ={moduleName:"Expression",version:Ue,beans:[iQ]},lQ={moduleName:"ChangeDetection",version:Ue,beans:[nQ]},cQ={moduleName:"CellApi",version:Ue,apiFunctions:{getCellValue:tQ}},uQ=class extends Ee{constructor(){super(...arguments),this.beanName="valueSvc",this.hasEditSvc=!1,this.initialised=!1,this.isSsrm=!1}wireBeans(e){this.expressionSvc=e.expressionSvc,this.colModel=e.colModel,this.valueCache=e.valueCache,this.dataTypeSvc=e.dataTypeSvc,this.editSvc=e.editSvc,this.hasEditSvc=!!e.editSvc}postConstruct(){this.initialised||this.init()}init(){this.executeValueGetter=this.valueCache?this.executeValueGetterWithValueCache.bind(this):this.executeValueGetterWithoutValueCache.bind(this),this.isSsrm=pc(this.gos),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;const e=t=>this.callColumnCellValueChangedHandler(t);this.eventSvc.addListener("cellValueChanged",e,!0),this.addDestroyFunc(()=>this.eventSvc.removeListener("cellValueChanged",e,!0)),this.addManagedPropertyListener("treeData",t=>this.isTreeData=t.currentValue)}getValueForDisplay(e,t,r=!1,n=!1,i="ui"){const{showRowGroupColValueSvc:s}=this.beans,o=!e&&t.group,a=e?.colDef.showRowGroup,u=!this.isTreeData||t.footer;if(s&&u&&(o||a)){const C=s.getGroupValue(t,e);if(C==null)return{value:null,valueFormatted:null};if(!r)return{value:C.value,valueFormatted:null};const b=s.formatAndPrefixGroupColValue(C,e,n);return{value:C.value,valueFormatted:b}}if(!e)return{value:t.key,valueFormatted:null};const d=t.leafGroup&&this.colModel.isPivotMode(),h=t.group&&t.expanded&&!t.footer&&!d,g=this.gos.get("groupSuppressBlankHeader")||!t.sibling,m=h&&!g,v=this.getValue(e,t,m,i),w=r&&!(n&&e.colDef.useValueFormatterForExport===!1);return{value:v,valueFormatted:w?this.formatValue(e,t,v):null}}getValue(e,t,r=!1,n="ui"){if(this.initialised||this.init(),!t)return;const i=e.getColDef(),s=i.field,o=e.getColId(),a=t.data;if(this.hasEditSvc&&n==="ui"){const C=this.editSvc;if(C.isEditing()){const b=C.getCellDataValue({rowNode:t,column:e},!0);if(b!==void 0)return b}}let u;const d=i.showRowGroup;if(typeof d=="string"&&(this.beans.rowGroupColsSvc?.getColumnIndex(d)??-1)>t.level)return null;const h=typeof d!="string"||!t.group,g=t.groupData&&o in t.groupData,m=!r&&t.aggData&&t.aggData[o]!==void 0,v=this.isSsrm&&r&&!!i.aggFunc,w=this.isSsrm&&t.footer&&t.field&&(i.showRowGroup===!0||i.showRowGroup===t.field);if(this.isTreeData&&m)u=t.aggData[o];else if(this.isTreeData&&i.valueGetter)u=this.executeValueGetter(i.valueGetter,a,e,t);else if(this.isTreeData&&s&&a)u=Vh(a,s,e.isFieldContainsDots());else if(g)u=t.groupData[o];else if(m)u=t.aggData[o];else if(i.valueGetter&&!v){if(!h)return u;u=this.executeValueGetter(i.valueGetter,a,e,t)}else if(w)u=Vh(a,t.field,e.isFieldContainsDots());else if(s&&a&&!v){if(!h)return u;u=Vh(a,s,e.isFieldContainsDots())}if(this.cellExpressions&&typeof u=="string"&&u.indexOf("=")===0){const C=u.substring(1);u=this.executeValueGetter(C,a,e,t)}return u}parseValue(e,t,r,n){const i=e.getColDef(),s=i.valueParser;if($e(s)){const o=it(this.gos,{node:t,data:t?.data,oldValue:n,newValue:r,colDef:i,column:e});return typeof s=="function"?s(o):this.expressionSvc?.evaluate(s,o)}return r}getDeleteValue(e,t){return $e(e.getColDef().valueParser)?this.parseValue(e,t,"",this.getValueForDisplay(e,t).value)??null:null}formatValue(e,t,r,n,i=!0){const{expressionSvc:s}=this.beans;let o=null,a;const u=e.getColDef();if(n?a=n:i&&(a=u.valueFormatter),a){const d=t?t.data:null,h=it(this.gos,{value:r,node:t,data:d,colDef:u,column:e});typeof a=="function"?o=a(h):o=s?s.evaluate(a,h):null}else if(u.refData)return u.refData[r]||"";return o==null&&Array.isArray(r)&&(o=r.join(", ")),o}setValue(e,t,r,n){const i=this.colModel.getColDefCol(t);if(!e||!i)return!1;xr(e.data)&&(e.data={});const{field:s,valueSetter:o}=i.getColDef();if(xr(s)&&xr(o))return Me(17),!1;if(this.dataTypeSvc&&!this.dataTypeSvc.checkType(i,r))return Me(135),!1;const a=it(this.gos,{node:e,data:e.data,oldValue:this.getValue(i,e,void 0,n),newValue:r,colDef:i.getColDef(),column:i});a.newValue=r;let u;if($e(o)?typeof o=="function"?u=o(a):u=this.expressionSvc?.evaluate(o,a):u=this.setValueUsingField(e.data,s,r,i.isFieldContainsDots()),u===void 0&&(u=!0),!u)return!1;e.resetQuickFilterAggregateText(),this.valueCache?.onDataChanged();const d=this.getValue(i,e);return this.dispatchCellValueChangedEvent(e,a,d,n),e.pinnedSibling&&this.dispatchCellValueChangedEvent(e.pinnedSibling,a,d,n),!0}dispatchCellValueChangedEvent(e,t,r,n){this.eventSvc.dispatchEvent({type:"cellValueChanged",event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:t.column,colDef:t.colDef,data:e.data,node:e,oldValue:t.oldValue,newValue:r,value:r,source:n})}callColumnCellValueChangedHandler(e){const t=e.colDef.onCellValueChanged;typeof t=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,context:e.context})})}setValueUsingField(e,t,r,n){if(!t)return!1;let i=!1;if(!n)i=e[t]===r,i||(e[t]=r);else{const s=t.split(".");let o=e;for(;s.length>0&&o;){const a=s.shift();s.length===0?(i=o[a]===r,i||(o[a]=r)):o=o[a]}}return!i}executeValueGetterWithValueCache(e,t,r,n){const i=r.getColId(),s=this.valueCache.getValue(n,i);if(s!==void 0)return s;const o=this.executeValueGetterWithoutValueCache(e,t,r,n);return this.valueCache.setValue(n,i,o),o}executeValueGetterWithoutValueCache(e,t,r,n){const i=it(this.gos,{data:t,node:n,column:r,colDef:r.getColDef(),getValue:this.getValueCallback.bind(this,n)});let s;return typeof e=="function"?s=e(i):s=this.expressionSvc?.evaluate(e,i),s}getValueCallback(e,t){const r=this.colModel.getColDefCol(t);return r?this.getValue(r,e):null}getKeyForNode(e,t){const r=this.getValue(e,t),n=e.getColDef().keyCreator;let i=r;if(n){const s=it(this.gos,{value:r,colDef:e.getColDef(),column:e,node:t,data:t.data});i=n(s)}return typeof i=="string"||i==null||(i=String(i),i==="[object Object]"&&Me(121)),i}},dQ={moduleName:"CommunityCore",version:Ue,beans:[dq,nj,mK,aW,YX,DY,sq,Iq,nW,AX,DX,qX,uQ,cq,iq,uq,wK,JX,dK,hK,jq],icons:{selectOpen:"small-down",smallDown:"small-down",colorPicker:"color-picker",smallUp:"small-up",checkboxChecked:"small-up",checkboxIndeterminate:"checkbox-indeterminate",checkboxUnchecked:"checkbox-unchecked",radioButtonOn:"radio-button-on",radioButtonOff:"radio-button-off",smallLeft:"small-left",smallRight:"small-right"},apiFunctions:{getGridId:ij,destroy:sj,isDestroyed:oj,getGridOption:aj,setGridOption:lj,updateGridOptions:vL,isModuleRegistered:cj},dependsOn:[lK,oY,fY,zL,zq,kY,Wq,jX,lQ,$q,FX,_X,IX,Kq,pK,cK,aQ,LY,BX]},WL={AdvancedFilter:1,AiToolkit:1,AllEnterprise:1,BatchEdit:1,CellSelection:1,Clipboard:1,ColumnMenu:1,ColumnsToolPanel:1,ContextMenu:1,ExcelExport:1,FiltersToolPanel:1,Find:1,GridCharts:1,IntegratedCharts:1,GroupFilter:1,MasterDetail:1,Menu:1,MultiFilter:1,NewFiltersToolPanel:1,Pivot:1,RangeSelection:1,RichSelect:1,RowNumbers:1,RowGrouping:1,RowGroupingPanel:1,ServerSideRowModelApi:1,ServerSideRowModel:1,SetFilter:1,SideBar:1,Sparklines:1,StatusBar:1,TreeData:1,ViewportRowModel:1},ky=["TextFilter","NumberFilter","DateFilter","SetFilter","MultiFilter","GroupFilter","CustomFilter"],hQ={EditCore:["TextEditor","NumberEditor","DateEditor","CheckboxEditor","LargeTextEditor","SelectEditor","RichSelect","CustomEditor"],CheckboxCellRenderer:["AllCommunity"],ClientSideRowModelHierarchy:["RowGrouping","Pivot","TreeData"],ColumnFilter:ky,ColumnGroupHeaderComp:["AllCommunity"],ColumnGroup:["AllCommunity"],ColumnHeaderComp:["AllCommunity"],ColumnMove:["AllCommunity"],ColumnResize:["AllCommunity"],CommunityCore:["AllCommunity"],CsrmSsrmSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],RowModelSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],EnterpriseCore:["AllEnterprise"],FilterCore:[...ky,"QuickFilter","ExternalFilter","AdvancedFilter"],GroupCellRenderer:["RowGrouping","Pivot","TreeData","MasterDetail","ServerSideRowModel"],KeyboardNavigation:["AllCommunity"],LoadingCellRenderer:["ServerSideRowModel"],MenuCore:["ColumnMenu","ContextMenu"],MenuItem:["ColumnMenu","ContextMenu","MultiFilter","IntegratedCharts","ColumnsToolPanel"],Overlay:["AllCommunity"],PinnedColumn:["AllCommunity"],SharedAggregation:["RowGrouping","Pivot","TreeData","ServerSideRowModel"],SharedDragAndDrop:["AllCommunity"],SharedMasterDetail:["MasterDetail","ServerSideRowModel"],SharedMenu:[...ky,"ColumnMenu","ContextMenu"],SharedPivot:["Pivot","ServerSideRowModel"],SharedRowGrouping:["RowGrouping","ServerSideRowModel"],SharedRowSelection:["RowSelection","ServerSideRowModel"],SkeletonCellRenderer:["ServerSideRowModel"],Sort:["AllCommunity"],SsrmInfiniteSharedApi:["InfiniteRowModel","ServerSideRowModelApi"],SharedTreeData:["TreeData","ServerSideRowModel"]},fQ={InfiniteRowModel:"infinite",ClientSideRowModelApi:"clientSide",ClientSideRowModel:"clientSide",ServerSideRowModelApi:"serverSide",ServerSideRowModel:"serverSide",ViewportRowModel:"viewport"};function gQ(e,t){const r=[];for(const n of Array.isArray(e)?e:[e]){const i=hQ[n];if(i)for(const s of i){const o=fQ[s];(!o||o===t)&&r.push(s)}else r.push(n)}return r}var UL=()=>`No AG Grid modules are registered! It is recommended to start with all Community features via the AllCommunityModule:
                    
    import { ModuleRegistry, AllCommunityModule } from 'ag-grid-community';
    
    ModuleRegistry.registerModules([ AllCommunityModule ]);
    `,pQ=e=>{const t=e.map(n=>`import { ${zh(n)} } from '${WL[n]?"ag-grid-enterprise":"ag-grid-community"}';`);return e.some(n=>n==="IntegratedCharts"||n==="Sparklines")&&t.push("import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';"),`import { ModuleRegistry } from 'ag-grid-community'; 
${t.join(` 
`)} 

ModuleRegistry.registerModules([ ${e.map(n=>zh(n,!0)).join(", ")} ]); 

For more info see: ${ku}/modules/`};function zh(e,t=!1){return t&&(e==="IntegratedCharts"||e==="Sparklines")?`${e}Module.with(AgChartsEnterpriseModule)`:`${e}Module`}function mQ(e,t){const r=t.filter(s=>s==="IntegratedCharts"||s==="Sparklines");let n="";return!globalThis?.agCharts&&r.length>0?n=`Unable to use ${e} as either the ag-charts-community or ag-charts-enterprise script needs to be included alongside ag-grid-enterprise.
`:t.some(s=>WL[s])&&(n=n+`Unable to use ${e} as that requires the ag-grid-enterprise script to be included.
`),n}function $L({moduleName:e,rowModelType:t}){return`To use the ${e}Module you must set the gridOption "rowModelType='${t}'"`}var $D=({reasonOrId:e,moduleName:t,gridScoped:r,gridId:n,rowModelType:i,additionalText:s,isUmd:o})=>{const a=gQ(t,i),u=typeof e=="string"?e:yQ[e];if(o)return mQ(u,a);const d=a.filter(m=>m==="IntegratedCharts"||m==="Sparklines"),h=d.length>0?`${d.map(m=>zh(m)).join()} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.`:"";return`${`Unable to use ${u} as ${a.length>1?"one of "+a.map(m=>zh(m)).join(", "):zh(a[0])} is not registered${r?" for gridId: "+n:""}. ${h} Check if you have registered the module:
`}
${pQ(a)}`+(s?` 

${s}`:"")},jD=e=>`${e} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.

import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';
import { ModuleRegistry } from 'ag-grid-community';
import { ${e} } from 'ag-grid-enterprise';
    
ModuleRegistry.registerModules([${e}.with(AgChartsEnterpriseModule)]);
    `,vQ=e=>`AG Grid: Unable to use the Clipboard API (navigator.clipboard.${e}()). The reason why it could not be used has been logged in the previous line. For this reason the grid has defaulted to using a workaround which doesn't perform as well. Either fix why Clipboard API is blocked, OR stop this message from appearing by setting grid property suppressClipboardApi=true (which will default the grid to using the workaround rather than the API.`,wQ={1:()=>"`rowData` must be an array",2:({nodeId:e})=>`Duplicate node id '${e}' detected from getRowId callback, this could cause issues in your grid.`,3:()=>"Calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.",4:({id:e})=>`Could not find row id=${e}, data item was not found for this id`,5:({data:e})=>["Could not find data item as object was not found.",e," Consider using getRowId to help the Grid find matching row data"],6:()=>"'groupHideOpenParents' only works when specifying specific columns for 'colDef.showRowGroup'",7:()=>"Pivoting is not supported with aligned grids as it may produce different columns in each grid.",8:({key:e})=>`Unknown key for navigation ${e}`,9:({variable:e})=>`No value for ${e?.cssName}. This usually means that the grid has been initialised before styles have been loaded. The default value of ${e?.defaultValue} will be used and updated when styles load.`,10:({eventType:e})=>`As of v33, the '${e}' event is deprecated. Use the global 'modelUpdated' event to determine when row children have changed.`,11:()=>"No gridOptions provided to createGrid",12:({colKey:e})=>["column ",e," not found"],13:()=>"Could not find rowIndex, this means tasks are being executed on a rowNode that has been removed from the grid.",14:({groupPrefix:e})=>`Row IDs cannot start with ${e}, this is a reserved prefix for AG Grid's row grouping feature.`,15:({expression:e})=>["value should be either a string or a function",e],16:({expression:e,params:t,e:r})=>["Processing of the expression failed","Expression = ",e,"Params = ",t,"Exception = ",r],17:()=>"you need either field or valueSetter set on colDef for editing to work",18:()=>"alignedGrids contains an undefined option.",19:()=>"alignedGrids - No api found on the linked grid.",20:()=>`You may want to configure via a callback to avoid setup race conditions:
                     "alignedGrids: () => [linkedGrid]"`,21:()=>"pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.",22:({key:e})=>`${e} is an initial property and cannot be updated.`,23:()=>"The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.",24:()=>"row height must be a number if not using standard row model",25:({id:e})=>["The getRowId callback must return a string. The ID ",e," is being cast to a string."],26:({fnName:e,preDestroyLink:t})=>`Grid API function ${e}() cannot be called as the grid has been destroyed.
 Either clear local references to the grid api, when it is destroyed, or check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.
 To run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${t}`,27:({fnName:e,module:t})=>`API function '${e}' not registered to module '${t}'`,28:()=>"setRowCount cannot be used while using row grouping.",29:()=>"tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?",30:({toIndex:e})=>["tried to insert columns in invalid location, toIndex = ",e,"remember that you should not count the moving columns when calculating the new index"],31:()=>"infinite loop in resizeColumnSets",32:()=>"applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state.",33:()=>"stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON.",34:({key:e})=>`the column type '${e}' is a default column type and cannot be overridden.`,35:()=>"Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type.",36:({t:e})=>"colDef.type '"+e+"' does not correspond to defined gridOptions.columnTypes",37:()=>"Changing the column pinning status is not allowed with domLayout='print'",38:({iconName:e})=>`provided icon '${e}' needs to be a string or a function`,39:()=>"Applying column order broke a group where columns should be married together. Applying new order has been discarded.",40:({e,method:t})=>`${e}
${vQ(t)}`,41:()=>"Browser did not allow document.execCommand('copy'). Ensure 'api.copySelectedRowsToClipboard() is invoked via a user event, i.e. button click, otherwise the browser will prevent it for security reasons.",42:()=>"Browser does not support document.execCommand('copy') for clipboard operations",43:({iconName:e})=>`As of v33, icon '${e}' is deprecated. Use the icon CSS name instead.`,44:()=>'Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.',45:({parentCellDataType:e})=>`The data type definition ${e} does not exist.`,46:()=>'The "baseDataType" property of a data type definition must match that of its parent.',47:({cellDataType:e})=>`Missing data type definition - "${e}"`,48:({property:e})=>`Cell data type is "object" but no Value ${e} has been provided. Please either provide an object data type definition with a Value ${e}, or set "colDef.value${e}"`,49:({methodName:e})=>`Framework component is missing the method ${e}()`,50:({compName:e})=>`Could not find component ${e}, did you forget to configure this component?`,51:()=>"Export cancelled. Export is not allowed as per your configuration.",52:()=>"There is no `window` associated with the current `document`",53:()=>"unknown value type during csv conversion",54:()=>"Could not find document body, it is needed for drag and drop and context menu.",55:()=>"addRowDropZone - A container target needs to be provided",56:()=>"addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.",57:()=>"unable to show popup filter, filter instantiation failed",58:()=>"no values found for select cellEditor",59:()=>"cannot select pinned rows",60:()=>"cannot select node until it has finished loading",61:()=>"since version v32.2.0, rowNode.isFullWidthCell() has been deprecated. Instead check `rowNode.detail` followed by the user provided `isFullWidthRow` grid option.",62:({colId:e})=>`setFilterModel() - no column found for colId: ${e}`,63:({colId:e})=>`setFilterModel() - unable to fully apply model, filtering disabled for colId: ${e}`,64:({colId:e})=>`setFilterModel() - unable to fully apply model, unable to create filter for colId: ${e}`,65:()=>"filter missing setModel method, which is needed for setFilterModel",66:()=>"filter API missing getModel method, which is needed for getFilterModel",67:()=>"Filter is missing isFilterActive() method",68:()=>"Column Filter API methods have been disabled as Advanced Filters are enabled.",69:({guiFromFilter:e})=>`getGui method from filter returned ${e}; it should be a DOM element.`,70:({newFilter:e})=>`Grid option quickFilterText only supports string inputs, received: ${typeof e}`,71:()=>"debounceMs is ignored when apply button is present",72:({keys:e})=>["ignoring FilterOptionDef as it doesn't contain one of ",e],73:()=>"invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'",74:()=>"no filter options for filter",75:()=>"Unknown button type specified",76:({filterModelType:e})=>['Unexpected type of filter "',e,'", it looks like the filter was configured with incorrect Filter Options'],77:()=>"Filter model is missing 'conditions'",78:()=>'Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.',79:()=>'"filterParams.maxNumConditions" must be greater than or equal to zero.',80:()=>'"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.',81:()=>'"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".',82:({param:e})=>`DateFilter ${e} is not a number`,83:()=>"DateFilter minValidYear should be <= maxValidYear",84:()=>"DateFilter minValidDate should be <= maxValidDate",85:()=>"DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored.",86:()=>"DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored.",87:()=>"DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.",88:({index:e})=>`Invalid row index for ensureIndexVisible: ${e}`,89:()=>"A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)",90:()=>"datasource is missing getRows method",91:()=>"Filter is missing method doesFilterPass",92:()=>"AnimationFrameService called but animation frames are off",93:()=>"cannot add multiple ranges when `cellSelection.suppressMultiRanges = true`",94:({paginationPageSizeOption:e,pageSizeSet:t,pageSizesSet:r,pageSizeOptions:n})=>`'paginationPageSize=${e}'${t?"":" (default value)"}, but ${e} is not included in${r?"":" the default"} paginationPageSizeSelector=[${n?.join(", ")}].`,95:({paginationPageSizeOption:e,paginationPageSizeSelector:t})=>`Either set '${t}' to an array that includes ${e} or to 'false' to disable the page size selector.`,96:({id:e,data:t})=>["Duplicate ID",e,"found for pinned row with data",t,"When `getRowId` is defined, it must return unique IDs for all pinned rows. Use the `rowPinned` parameter."],97:({colId:e})=>`cellEditor for column ${e} is missing getGui() method`,98:()=>"popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.",99:()=>"Since v32, `api.hideOverlay()` does not hide the loading overlay when `loading=true`. Set `loading=false` instead.",101:({propertyName:e,componentName:t,agGridDefaults:r,jsComps:n})=>{const i=[],s=[...Object.keys(r??[]).filter(a=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(a)),...Object.keys(n??[]).filter(a=>!!n[a])],o=kb({inputValue:t,allSuggestions:s,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return i.push(`Could not find '${t}' component. It was configured as "${e}: '${t}'" but it wasn't found in the list of registered components.
`),o.length>0&&i.push(`         Did you mean: [${o.slice(0,3)}]?
`),i.push("If using a custom component check it has been registered correctly."),i},102:()=>"selectAll: 'filtered' only works when gridOptions.rowModelType='clientSide'",103:()=>"Invalid selection state. When using client-side row model, the state must conform to `string[]`.",104:({value:e,param:t})=>`Numeric value ${e} passed to ${t} param will be interpreted as ${e} seconds. If this is intentional use "${e}s" to silence this warning.`,105:({e})=>["chart rendering failed",e],106:()=>`Theming API and Legacy Themes are both used in the same page. A Theming API theme has been provided to the 'theme' grid option, but the file (ag-grid.css) is also included and will cause styling issues. Remove ag-grid.css from the page. See the migration guide: ${ku}/theming-migration/`,107:({key:e,value:t})=>`Invalid value for theme param ${e} - ${t}`,108:({e})=>["chart update failed",e],109:({inputValue:e,allSuggestions:t})=>{const r=kb({inputValue:e,allSuggestions:t,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return[`Could not find '${e}' aggregate function. It was configured as "aggFunc: '${e}'" but it wasn't found in the list of registered aggregations.`,r.length>0?`         Did you mean: [${r.slice(0,3)}]?`:"","If using a custom aggregation function check it has been registered correctly."].join(`
`)},110:()=>"groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup",111:()=>"Invalid selection state. When `groupSelects` is enabled, the state must conform to `IServerSideGroupSelectionState`.",113:()=>"Set Filter cannot initialise because you are using a row model that does not contain all rows in the browser. Either use a different filter type, or configure Set Filter such that you provide it with values",114:({component:e})=>`Could not find component with name of ${e}. Is it in Vue.components?`,116:()=>"Invalid selection state. The state must conform to `IServerSideSelectionState`.",117:()=>"selectAll must be of boolean type.",118:()=>"Infinite scrolling must be enabled in order to set the row count.",119:()=>"Unable to instantiate filter",120:()=>"MultiFloatingFilterComp expects MultiFilter as its parent",121:()=>"a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (see AG Grid docs) or b) to toString() on the object to return a key",122:()=>"could not find the document, document is empty",123:()=>"Advanced Filter is only supported with the Client-Side Row Model or Server-Side Row Model.",124:()=>"No active charts to update.",125:({chartId:e})=>`Unable to update chart. No active chart found with ID: ${e}.`,126:()=>"unable to restore chart as no chart model is provided",127:({allRange:e})=>`unable to create chart as ${e?"there are no columns in the grid":"no range is selected"}.`,128:({feature:e})=>`${e} is only available if using 'multiRow' selection mode.`,129:({feature:e,rowModel:t})=>`${e} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${t}.`,130:()=>'cannot multi select unless selection mode is "multiRow"',132:()=>"Row selection features are not available unless `rowSelection` is enabled.",133:({iconName:e})=>`icon '${e}' function should return back a string or a dom object`,134:({iconName:e})=>`Did not find icon '${e}'`,135:()=>"Data type of the new value does not match the cell data type of the column",136:()=>"Unable to update chart as the 'type' is missing. It must be either 'rangeChartUpdate', 'pivotChartUpdate', or 'crossFilterChartUpdate'.",137:({type:e,currentChartType:t})=>`Unable to update chart as a '${e}' update type is not permitted on a ${t}.`,138:({chartType:e})=>`invalid chart type supplied: ${e}`,139:({customThemeName:e})=>`a custom chart theme with the name ${e} has been supplied but not added to the 'chartThemes' list`,140:({name:e})=>`no stock theme exists with the name '${e}' and no custom chart theme with that name was supplied to 'customChartThemes'`,141:()=>"cross filtering with row grouping is not supported.",142:()=>"cross filtering is only supported in the client side row model.",143:({panel:e})=>`'${e}' is not a valid Chart Tool Panel name`,144:({type:e})=>`Invalid charts data panel group name supplied: '${e}'`,145:({group:e})=>`As of v32, only one charts customize panel group can be expanded at a time. '${e}' will not be expanded.`,146:({comp:e})=>`Unable to instantiate component '${e}' as its module hasn't been loaded. Add 'ValidationModule' to see which module is required.`,147:({group:e})=>`Invalid charts customize panel group name supplied: '${e}'`,148:({group:e})=>`invalid chartGroupsDef config '${e}'`,149:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,150:()=>"'seriesChartTypes' are required when the 'customCombo' chart type is specified.",151:({chartType:e})=>`invalid chartType '${e}' supplied in 'seriesChartTypes', converting to 'line' instead.`,152:({colId:e})=>`no 'seriesChartType' found for colId = '${e}', defaulting to 'line'.`,153:({chartDataType:e})=>`unexpected chartDataType value '${e}' supplied, instead use 'category', 'series' or 'excluded'`,154:({colId:e})=>`cross filtering requires a 'agSetColumnFilter' or 'agMultiColumnFilter' to be defined on the column with id: ${e}`,155:({option:e})=>`'${e}' is not a valid Chart Toolbar Option`,156:({panel:e})=>`Invalid panel in chartToolPanelsDef.panels: '${e}'`,157:({unrecognisedGroupIds:e})=>["unable to find group(s) for supplied groupIds:",e],158:()=>"can not expand a column item that does not represent a column group header",159:()=>"Invalid params supplied to createExcelFileForExcel() - `ExcelExportParams.data` is empty.",160:()=>"Export cancelled. Export is not allowed as per your configuration.",161:()=>"The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'",162:({id:e,dataType:t})=>`Unrecognized data type for excel export [${e}.dataType=${t}]`,163:({featureName:e})=>`Excel table export does not work with ${e}. The exported Excel file will not contain any Excel tables.
 Please turn off ${e} to enable Excel table exports.`,164:()=>"Unable to add data table to Excel sheet: A table already exists.",165:()=>"Unable to add data table to Excel sheet: Missing required parameters.",166:({unrecognisedGroupIds:e})=>["unable to find groups for these supplied groupIds:",e],167:({unrecognisedColIds:e})=>["unable to find columns for these supplied colIds:",e],168:()=>"detailCellRendererParams.template should be function or string",169:()=>'Reference to eDetailGrid was missing from the details template. Please add data-ref="eDetailGrid" to the template.',170:({providedStrategy:e})=>`invalid cellRendererParams.refreshStrategy = ${e} supplied, defaulting to refreshStrategy = 'rows'.`,171:()=>"could not find detail grid options for master detail, please set gridOptions.detailCellRendererParams.detailGridOptions",172:()=>"could not find getDetailRowData for master / detail, please set gridOptions.detailCellRendererParams.getDetailRowData",173:({group:e})=>`invalid chartGroupsDef config '${e}'`,174:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,175:({menuTabName:e,itemsToConsider:t})=>[`Trying to render an invalid menu item '${e}'. Check that your 'menuTabs' contains one of `,t],176:({key:e})=>`unknown menu item type ${e}`,177:()=>"valid values for cellSelection.handle.direction are 'x', 'y' and 'xy'. Default to 'xy'.",178:({colId:e})=>`column ${e} is not visible`,179:()=>"totalValueGetter should be either a function or a string (expression)",180:()=>"agRichSelectCellEditor requires cellEditorParams.values to be set",181:()=>"agRichSelectCellEditor cannot have `multiSelect` and `allowTyping` set to `true`. AllowTyping has been turned off.",182:()=>'you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data',183:()=>"Group Column Filter only works on group columns. Please use a different filter.",184:({parentGroupData:e,childNodeData:t})=>["duplicate group keys for row data, keys should be unique",[e,t]],185:({data:e})=>["getDataPath() should not return an empty path",[e]],186:({rowId:e,rowData:t,duplicateRowsData:r})=>["duplicate group keys for row data, keys should be unique",e,t,...r??[]],187:({rowId:e,firstData:t,secondData:r})=>[`Duplicate node id ${e}. Row IDs are provided via the getRowId() callback. Please modify the getRowId() callback code to provide unique row id values.`,"first instance",t,"second instance",r],188:e=>`getRowId callback must be provided for Server Side Row Model ${e?.feature||"selection"} to work correctly.`,189:({startRow:e})=>`invalid value ${e} for startRow, the value should be >= 0`,190:({rowGroupId:e,data:t})=>["null and undefined values are not allowed for server side row model keys",e?`column = ${e}`:"","data is ",t],194:({method:e})=>`calling gridApi.${e}() is only possible when using rowModelType=\`clientSide\`.`,195:({justCurrentPage:e})=>`selecting just ${e?"current page":"filtered"} only works when gridOptions.rowModelType='clientSide'`,196:({key:e})=>`Provided ids must be of string type. Invalid id provided: ${e}`,197:()=>"`toggledNodes` must be an array of string ids.",199:()=>"getSelectedNodes and getSelectedRows functions cannot be used with select all functionality with the server-side row model. Use `api.getServerSideSelectionState()` instead.",200:$D,201:({rowModelType:e})=>`Could not find row model for rowModelType = ${e}`,202:()=>"`getSelectedNodes` and `getSelectedRows` functions cannot be used with `groupSelectsChildren` and the server-side row model. Use `api.getServerSideSelectionState()` instead.",203:()=>"Server Side Row Model does not support Dynamic Row Height and Cache Purging. Either a) remove getRowHeight() callback or b) remove maxBlocksInCache property. Purging has been disabled.",204:()=>"Server Side Row Model does not support Auto Row Height and Cache Purging. Either a) remove colDef.autoHeight or b) remove maxBlocksInCache property. Purging has been disabled.",205:({duplicateIdText:e})=>`Unable to display rows as duplicate row ids (${e}) were returned by the getRowId callback. Please modify the getRowId callback to provide unique ids.`,206:()=>"getRowId callback must be implemented for transactions to work. Transaction was ignored.",207:()=>'The Set Filter Parameter "defaultToNothingSelected" value was ignored because it does not work when "excelMode" is used.',208:()=>"Set Filter Value Formatter must return string values. Please ensure the Set Filter Value Formatter returns string values for complex objects.",209:()=>`Set Filter Key Creator is returning null for provided values and provided values are primitives. Please provide complex objects. See ${ku}/filter-set-filter-list/#filter-value-types`,210:()=>"Set Filter has a Key Creator, but provided values are primitives. Did you mean to provide complex objects?",211:()=>"property treeList=true for Set Filter params, but you did not provide a treeListPathGetter or values of type Date.",212:()=>"please review all your toolPanel components, it seems like at least one of them doesn't have an id",213:()=>"Advanced Filter does not work with Filters Tool Panel. Filters Tool Panel has been disabled.",214:({key:e})=>`unable to lookup Tool Panel as invalid key supplied: ${e}`,215:({key:e,defaultByKey:t})=>`the key ${e} is not a valid key for specifying a tool panel, valid keys are: ${Object.keys(t??{}).join(",")}`,216:({name:e})=>`Missing component for '${e}'`,217:({invalidColIds:e})=>["unable to find grid columns for the supplied colDef(s):",e],218:({property:e,defaultOffset:t})=>`${e} must be a number, the value you provided is not a valid number. Using the default of ${t}px.`,219:({property:e})=>`Property ${e} does not exist on the target object.`,220:({lineDash:e})=>`'${e}' is not a valid 'lineDash' option.`,221:()=>"agAggregationComponent should only be used with the client and server side row model.",222:()=>"agFilteredRowCountComponent should only be used with the client side row model.",223:()=>"agSelectedRowCountComponent should only be used with the client and server side row model.",224:()=>"agTotalAndFilteredRowCountComponent should only be used with the client side row model.",225:()=>"agTotalRowCountComponent should only be used with the client side row model.",226:()=>"viewport is missing init method.",227:()=>"menu item icon must be DOM node or string",228:({menuItemOrString:e})=>`unrecognised menu item ${e}`,229:({index:e})=>["invalid row index for ensureIndexVisible: ",e],230:()=>"detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://www.ag-grid.com/react-data-grid/master-detail-custom-detail/",231:()=>"As of v32, using custom components with `reactiveCustomComponents = false` is deprecated.",232:()=>"Using both rowData and v-model. rowData will be ignored.",233:({methodName:e})=>`Framework component is missing the method ${e}()`,234:()=>'Group Column Filter does not work with the colDef property "field". This property will be ignored.',235:()=>'Group Column Filter does not work with the colDef property "filterValueGetter". This property will be ignored.',236:()=>'Group Column Filter does not work with the colDef property "filterParams". This property will be ignored.',237:()=>"Group Column Filter does not work with Tree Data enabled. Please disable Tree Data, or use a different filter.",238:()=>"setRowCount can only accept a positive row count.",239:()=>'Theming API and CSS File Themes are both used in the same page. In v33 we released the Theming API as the new default method of styling the grid. See the migration docs https://www.ag-grid.com/react-data-grid/theming-migration/. Because no value was provided to the `theme` grid option it defaulted to themeQuartz. But the file (ag-grid.css) is also included and will cause styling issues. Either pass the string "legacy" to the theme grid option to use v32 style themes, or remove ag-grid.css from the page to use Theming API.',240:({theme:e})=>`theme grid option must be a Theming API theme object or the string "legacy", received: ${e}`,243:()=>"Failed to deserialize state - each provided state object must be an object.",244:()=>"Failed to deserialize state - `selectAllChildren` must be a boolean value or undefined.",245:()=>"Failed to deserialize state - `toggledNodes` must be an array.",246:()=>"Failed to deserialize state - Every `toggledNode` requires an associated string id.",247:()=>`Row selection state could not be parsed due to invalid data. Ensure all child state has toggledNodes or does not conform with the parent rule. 
Please rebuild the selection state and reapply it.`,248:()=>"SetFloatingFilter expects SetFilter as its parent",249:()=>"Must supply a Value Formatter in Set Filter params when using a Key Creator",250:()=>"Must supply a Key Creator in Set Filter params when `treeList = true` on a group column, and Tree Data or Row Grouping is enabled.",251:({chartType:e})=>`AG Grid: Unable to create chart as an invalid chartType = '${e}' was supplied.`,252:()=>`cannot get grid to draw rows when it is in the middle of drawing rows. 
Your code probably called a grid API method while the grid was in the render stage. 
To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). 
To see what part of your code that caused the refresh check this stacktrace.`,253:({version:e})=>["Illegal version string: ",e],254:()=>"Cannot create chart: no chart themes available.",255:({point:e})=>`Lone surrogate U+${e?.toString(16).toUpperCase()} is not a scalar value`,256:()=>"Unable to initialise. See validation error, or load ValidationModule if missing.",257:()=>jD("IntegratedChartsModule"),258:()=>jD("SparklinesModule"),259:({part:e})=>`the argument to theme.withPart must be a Theming API part object, received: ${e}`,260:({propName:e,compName:t,gridScoped:r,gridId:n,rowModelType:i})=>$D({reasonOrId:`AG Grid '${e}' component: ${t}`,moduleName:Nu[t],gridId:n,gridScoped:r,rowModelType:i}),261:()=>"As of v33, `column.isHovered()` is deprecated. Use `api.isColumnHovered(column)` instead.",262:()=>'As of v33, icon key "smallDown" is deprecated. Use "advancedFilterBuilderSelect" for Advanced Filter Builder dropdown, "selectOpen" for Select cell editor and dropdowns (e.g. Integrated Charts menu), "richSelectOpen" for Rich Select cell editor.',263:()=>'As of v33, icon key "smallLeft" is deprecated. Use "panelDelimiterRtl" for Row Group Panel / Pivot Panel, "subMenuOpenRtl" for sub-menus.',264:()=>'As of v33, icon key "smallRight" is deprecated. Use "panelDelimiter" for Row Group Panel / Pivot Panel, "subMenuOpen" for sub-menus.',265:({colId:e})=>`Unable to infer chart data type for column '${e}' if first data entry is null. Please specify "chartDataType", or a "cellDataType" in the column definition. For more information, see ${ku}/integrated-charts-range-chart#coldefchartdatatype .`,266:()=>'As of v33.1, using "keyCreator" with the Rich Select Editor has been deprecated. It now requires the "formatValue" callback to convert complex data to strings.',267:()=>"Detail grids can not use a different theme to the master grid, the `theme` detail grid option will be ignored.",268:()=>"Transactions aren't supported with tree data when using treeDataChildrenField",269:()=>"When `masterSelects: 'detail'`, detail grids must be configured with multi-row selection",270:({id:e,parentId:t})=>`Cycle detected for row with id='${e}' and parent id='${t}'. Resetting the parent for row with id='${e}' and showing it as a root-level node.`,271:({id:e,parentId:t})=>`Parent row not found for row with id='${e}' and parent id='${t}'. Showing row with id='${e}' as a root-level node.`,272:()=>UL(),273:({providedId:e,usedId:t})=>`Provided column id '${e}' was already in use, ensure all column and group ids are unique. Using '${t}' instead.`,274:({prop:e})=>{let t=`Since v33, ${e} has been deprecated.`;switch(e){case"maxComponentCreationTimeMs":t+=" This property is no longer required and so will be removed in a future version.";break;case"setGridApi":t+=" This method is not called by AG Grid. To access the GridApi see: https://ag-grid.com/react-data-grid/grid-interface/#grid-api ";break;case"children":t+=" For multiple versions AgGridReact does not support children.";break}return t},275:$L,276:()=>"Row Numbers Row Resizer cannot be used when Grid Columns have `autoHeight` enabled.",277:({colId:e})=>`'enableFilterHandlers' is set to true, but column '${e}' does not have 'filter.doesFilterPass' or 'filter.handler' set.`,278:({colId:e})=>`Unable to create filter handler for column '${e}'`,279:e=>{},280:({colId:e})=>`'name' must be provided for custom filter components for column '${e}`,281:({colId:e})=>`Filter for column '${e}' does not have 'filterParams.buttons', but the new Filters Tool Panel has buttons configured. Either configure buttons for the filter, or disable buttons on the Filters Tool Panel.`,282:()=>"New filter tool panel requires `enableFilterHandlers: true`.",283:()=>"As of v34, use the same method on the filter handler (`api.getColumnFilterHandler(colKey)`) instead.",284:()=>"As of v34, filters are active when they have a model. Use `api.getColumnFilterModel()` instead.",285:()=>"As of v34, use (`api.getColumnFilterModel()`) instead.",286:()=>"As of v34, use (`api.setColumnFilterModel()`) instead.",287:()=>"`api.doFilterAction()` requires `enableFilterHandlers = true",288:()=>"`api.getColumnFilterModel(key, true)` requires `enableFilterHandlers = true",289:({rowModelType:e})=>`Row Model '${e}' is not supported with Batch Editing`,290:({rowIndex:e,rowPinned:t})=>`Row with index '${e}' and pinned state '${t}' not found`,291:()=>"License Key being set multiple times with different values. This can result in an incorrect license key being used,",292:({colId:e})=>`The Multi Filter for column '${e}' has buttons configured against the child filters. When 'enableFilterHandlers=true', buttons must instead be provided against the parent Multi Filter params. The child filter buttons will be ignored.`};function CQ(e,t){const r=wQ[e];if(!r)return[`Missing error text for error id ${e}!`];const n=r(t),s=`
See ${JM(e,t)}`;return Array.isArray(n)?n.concat(s):[n,s]}var yQ={1:"Charting Aggregation",2:"pivotResultFields",3:"setTooltip"},YD=new WeakMap,KD=new WeakMap,bQ=1,SQ=class{create(e,t,r,n,i,s){const o=ax.applyGlobalGridOptions(t),a=o.gridId??String(bQ++),u=this.getRegisteredModules(i,a,o.rowModelType),d=this.createBeansList(o.rowModelType,u,a),h=this.createProvidedBeans(e,o,i);if(!d)return;const m={providedBeanInstances:h,beanClasses:d,id:a,beanInitComparator:J$,beanDestroyComparator:ej,derivedBeans:[Q$],destroyCallback:()=>{KD.delete(w),YD.delete(e),o7(a),s?.()}},v=new H9(m);this.registerModuleFeatures(v,u),r(v),v.getBean("syncSvc").start(),n?.(v);const w=v.getBean("gridApi");return YD.set(e,w),KD.set(w,e),w}getRegisteredModules(e,t,r){return uf(dQ,void 0,!0),e?.modules?.forEach(n=>uf(n,t)),a7(t,qD(r))}registerModuleFeatures(e,t){const r=e.getBean("registry"),n=e.getBean("apiFunctionSvc");for(const i of t){r.registerModule(i);const s=i.apiFunctions;if(s){const o=Object.keys(s);for(const a of o)n?.addFunction(a,s[a])}}}createProvidedBeans(e,t,r){let n=r?r.frameworkOverrides:null;xr(n)&&(n=new pL);const i={gridOptions:t,eGridDiv:e,eRootDiv:e,globalListener:r?r.globalListener:null,globalSyncListener:r?r.globalSyncListener:null,frameworkOverrides:n};return r?.providedBeanInstances&&Object.assign(i,r.providedBeanInstances),i}createBeansList(e,t,r){const n={clientSide:"ClientSideRowModel",infinite:"InfiniteRowModel",serverSide:"ServerSideRowModel",viewport:"ViewportRowModel"},i=qD(e),s=n[i];if(!s){Dh(201,{rowModelType:i},`Unknown rowModelType ${i}.`);return}if(!u7()){Dh(272,void 0,UL());return}if(!e){const a=Object.entries(n).filter(([u,d])=>yb(d,r,u));if(a.length==1){const[u,d]=a[0];if(u!==i){const h={moduleName:d,rowModelType:u};Dh(275,h,$L(h));return}}}if(!yb(s,r,i)){Dh(200,{reasonOrId:`rowModelType = '${i}'`,moduleName:s,gridScoped:lx(),gridId:r,rowModelType:i},`Missing module ${s}Module for rowModelType ${i}.`);return}const o=new Set;for(const a of t)for(const u of a.beans??[])o.add(u);return Array.from(o)}};function qD(e){return e??"clientSide"}function nl(e){const t=e.rowModel;return t.getType()==="clientSide"?t:void 0}function Zm(e){const t=e.rowModel;return t.getType()==="infinite"?t:void 0}function xQ(e){const t=e.rowModel;return t.getType()==="serverSide"?t:void 0}var EQ=class extends Ee{constructor(){super(...arguments),this.beanName="localeSvc"}getLocaleTextFunc(){const e=this.gos,t=e.getCallback("getLocaleText");return t?qz(t):Xz(e.get("localeText"))}};function RQ(e,t=!1){const r=[],n=[],i=[],s=[],o=[],a=[],u=[],d=[],h=[];let g=0;for(let m=0;m<e.length;m++){const{colId:v,sort:w,sortIndex:C,rowGroup:b,rowGroupIndex:x,aggFunc:R,pivot:E,pivotIndex:A,pinned:D,hide:M,width:F,flex:O}=e[m];h.push(v),w&&(r[C??g++]={colId:v,sort:w}),b&&(n[x??0]=v),typeof R=="string"&&i.push({colId:v,aggFunc:R}),E&&(s[A??0]=v),D&&(D==="right"?a:o).push(v),M&&u.push(v),(O!=null||F)&&d.push({colId:v,flex:O??void 0,width:F})}return{sort:r.length?{sortModel:Py(r)}:void 0,rowGroup:n.length?{groupColIds:Py(n)}:void 0,aggregation:i.length?{aggregationModel:i}:void 0,pivot:s.length||t?{pivotMode:t,pivotColIds:Py(s)}:void 0,columnPinning:o.length||a.length?{leftColIds:o,rightColIds:a}:void 0,columnVisibility:u.length?{hiddenColIds:u}:void 0,columnSizing:d.length?{columnSizingModel:d}:void 0,columnOrder:h.length?{orderedColIds:h}:void 0}}function Py(e){return e.filter(t=>t!=null)}function TQ(e){const t=[];for(const{groupId:r,open:n}of e)n&&t.push(r);return t.length?{openColumnGroupIds:t}:void 0}var FQ=class{wrap(e,t,r,n){const i=this.createWrapper(e,n);for(const s of t??[])this.createMethod(i,s,!0);for(const s of r??[])this.createMethod(i,s,!1);return i}createMethod(e,t,r){e.addMethod(t,this.createMethodProxy(e,t,r))}createMethodProxy(e,t,r){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(r&&Me(49,{methodName:t}),null)}}};function My(e){return e.get("tooltipShowMode")==="whenTruncated"}function DQ(e,t){if(typeof e!="number")return"";const r=t(),n=r("thousandSeparator",","),i=r("decimalSeparator",".");return e.toString().replace(".",i).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${n}`)}var AQ=class extends Ee{getFileName(e){const t=this.getDefaultFileExtension();return e?.length||(e=this.getDefaultFileName()),e.includes(".")?e:`${e}.${t}`}getData(e){const t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},kQ=class{constructor(e){const{colModel:t,rowGroupColsSvc:r,colNames:n,valueSvc:i,gos:s,processCellCallback:o,processHeaderCallback:a,processGroupHeaderCallback:u,processRowGroupCallback:d}=e;this.colModel=t,this.rowGroupColsSvc=r,this.colNames=n,this.valueSvc=i,this.gos=s,this.processCellCallback=o,this.processHeaderCallback=a,this.processGroupHeaderCallback=u,this.processRowGroupCallback=d}prepare(e){}extractHeaderValue(e){return this.getHeaderName(this.processHeaderCallback,e)??""}extractRowCellValue(e,t,r,n,i){const s=t===0&&o_(this.gos,i,this.colModel.isPivotMode());if(this.processRowGroupCallback&&(this.gos.get("treeData")||i.group)&&(e.isRowGroupDisplayed(i.rowGroupColumn?.getColId()??"")||s))return{value:this.processRowGroupCallback(it(this.gos,{column:e,node:i}))??""};if(this.processCellCallback)return{value:this.processCellCallback(it(this.gos,{accumulatedRowIndex:r,column:e,node:i,value:this.valueSvc.getValueForDisplay(e,i,void 0,void 0).value,type:n,parseValue:m=>this.valueSvc.parseValue(e,i,m,this.valueSvc.getValue(e,i,void 0)),formatValue:m=>this.valueSvc.formatValue(e,i,m)??m}))??""};const o=this.gos.get("treeData"),a=this.valueSvc,u=i.level===-1&&i.footer,d=e.colDef.showRowGroup===!0&&(i.group||o);if(!u&&(s||d)){let m="",v=i;for(;v&&v.level!==-1;){const{value:w,valueFormatted:C}=a.getValueForDisplay(s?void 0:e,v,!0,!0);m=` -> ${C??w??""}${m}`,v=v.parent}return{value:m,valueFormatted:m}}const{value:h,valueFormatted:g}=a.getValueForDisplay(e,i,!0,!0);return{value:h??"",valueFormatted:g}}getHeaderName(e,t){return e?e(it(this.gos,{column:t})):this.colNames.getDisplayNameForColumn(t,"csv",!0)}};function PQ(e,t){const r=document.defaultView||window;if(!r){Me(52);return}const n=document.createElement("a"),i=r.URL.createObjectURL(t);n.setAttribute("href",i),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:r})),n.remove(),r.setTimeout(()=>{r.URL.revokeObjectURL(i)},0)}var MQ={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,customChartThemes:!0,chartThemeOverrides:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressTouch:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,dragAndDropImageComponent:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,groupLockGroupColumns:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,renderingMode:!0,columnMenu:!0,suppressSetFilterByDefault:!0,getDataPath:!0,enableCellSpan:!0,enableFilterHandlers:!0,filterHandlers:!0},ri="clientSide",En="serverSide",gu="infinite",_Q={onGroupExpandedOrCollapsed:[ri],refreshClientSideRowModel:[ri],isRowDataEmpty:[ri],forEachLeafNode:[ri],forEachNodeAfterFilter:[ri],forEachNodeAfterFilterAndSort:[ri],resetRowHeights:[ri,En],applyTransaction:[ri],applyTransactionAsync:[ri],flushAsyncTransactions:[ri],getBestCostNodeSelection:[ri],getServerSideSelectionState:[En],setServerSideSelectionState:[En],applyServerSideTransaction:[En],applyServerSideTransactionAsync:[En],applyServerSideRowData:[En],retryServerSideLoads:[En],flushServerSideAsyncTransactions:[En],refreshServerSide:[En],getServerSideGroupLevelState:[En],refreshInfiniteCache:[gu],purgeInfiniteCache:[gu],getInfiniteRowCount:[gu],isLastRowIndexKnown:[gu,En],expandAll:[ri,En],collapseAll:[ri,En],onRowHeightChanged:[ri,En],setRowCount:[gu,En],getCacheBlockState:[gu,En]},LQ={showLoadingOverlay:{version:"v32",message:'`showLoadingOverlay` is deprecated. Use the grid option "loading"=true instead or setGridOption("loading", true).'},clearRangeSelection:{version:"v32.2",message:"Use `clearCellSelection` instead."},getInfiniteRowCount:{version:"v32.2",old:"getInfiniteRowCount()",new:"getDisplayedRowCount()"},selectAllFiltered:{version:"v33",old:"selectAllFiltered()",new:'selectAll("filtered")'},deselectAllFiltered:{version:"v33",old:"deselectAllFiltered()",new:'deselectAll("filtered")'},selectAllOnCurrentPage:{version:"v33",old:"selectAllOnCurrentPage()",new:'selectAll("currentPage")'},deselectAllOnCurrentPage:{version:"v33",old:"deselectAllOnCurrentPage()",new:'deselectAll("currentPage")'}};function IQ(e,t,r){const n=LQ[e];if(n){const{version:s,new:o,old:a,message:u}=n,d=a??e;return(...h)=>{const g=o?`Please use ${o} instead. `:"";return Bh(`Since ${s} api.${d} is deprecated. ${g}${u??""}`),t.apply(t,h)}}const i=_Q[e];return i?(...s)=>{const o=r.rowModel.getType();if(!i.includes(o)){Au(`api.${e} can only be called when gridOptions.rowModelType is ${i.join(" or ")}`);return}return t.apply(t,s)}:t}var OQ={detailCellRendererCtrl:"SharedMasterDetail",dndSourceComp:"DragAndDrop",fillHandle:"CellSelection",groupCellRendererCtrl:"GroupCellRenderer",headerFilterCellCtrl:"ColumnFilter",headerGroupCellCtrl:"ColumnGroup",rangeHandle:"CellSelection",tooltipFeature:"Tooltip",highlightTooltipFeature:"Tooltip",tooltipStateManager:"Tooltip",groupStrategy:"RowGrouping",treeGroupStrategy:"TreeData",rowNumberRowResizer:"RowNumbers",singleCell:"EditCore",fullRow:"EditCore",agSetColumnFilterHandler:"SetFilter",agMultiColumnFilterHandler:"MultiFilter",agGroupColumnFilterHandler:"GroupFilter",agNumberColumnFilterHandler:"NumberFilter",agDateColumnFilterHandler:"DateFilter",agTextColumnFilterHandler:"TextFilter"},NQ={expanded:1,contracted:1,"tree-closed":1,"tree-open":1,"tree-indeterminate":1,pin:1,"eye-slash":1,arrows:1,left:1,right:1,group:1,aggregation:1,pivot:1,"not-allowed":1,chart:1,cross:1,cancel:1,tick:1,first:1,previous:1,next:1,last:1,linked:1,unlinked:1,"color-picker":1,loading:1,menu:1,"menu-alt":1,filter:1,"filter-add":1,columns:1,maximize:1,minimize:1,copy:1,cut:1,paste:1,grip:1,save:1,csv:1,excel:1,"small-down":1,"small-left":1,"small-right":1,"small-up":1,asc:1,desc:1,none:1,up:1,down:1,plus:1,minus:1,settings:1,"checkbox-checked":1,"checkbox-indeterminate":1,"checkbox-unchecked":1,"radio-button-on":1,"radio-button-off":1,eye:1,"column-arrow":1,"un-pin":1,"pinned-top":1,"pinned-bottom":1,"chevron-up":1,"chevron-down":1,"chevron-left":1,"chevron-right":1,edit:1},BQ={chart:"MenuCore",cancel:"EnterpriseCore",first:"Pagination",previous:"Pagination",next:"Pagination",last:"Pagination",linked:"IntegratedCharts",loadingMenuItems:"MenuCore",unlinked:"IntegratedCharts",menu:"ColumnHeaderComp",legacyMenu:"ColumnMenu",filter:"ColumnFilter",filterActive:"ColumnFilter",filterAdd:"NewFiltersToolPanel",filterCardCollapse:"NewFiltersToolPanel",filterCardExpand:"NewFiltersToolPanel",filterCardEditing:"NewFiltersToolPanel",filterTab:"ColumnMenu",filtersToolPanel:"FiltersToolPanel",columns:["MenuCore"],columnsToolPanel:["ColumnsToolPanel"],maximize:"EnterpriseCore",minimize:"EnterpriseCore",save:"MenuCore",columnGroupOpened:"ColumnGroupHeaderComp",columnGroupClosed:"ColumnGroupHeaderComp",accordionOpen:"EnterpriseCore",accordionClosed:"EnterpriseCore",accordionIndeterminate:"EnterpriseCore",columnSelectClosed:["ColumnsToolPanel","ColumnMenu"],columnSelectOpen:["ColumnsToolPanel","ColumnMenu"],columnSelectIndeterminate:["ColumnsToolPanel","ColumnMenu"],columnMovePin:"SharedDragAndDrop",columnMoveHide:"SharedDragAndDrop",columnMoveMove:"SharedDragAndDrop",columnMoveLeft:"SharedDragAndDrop",columnMoveRight:"SharedDragAndDrop",columnMoveGroup:"SharedDragAndDrop",columnMoveValue:"SharedDragAndDrop",columnMovePivot:"SharedDragAndDrop",dropNotAllowed:"SharedDragAndDrop",ensureColumnVisible:["ColumnsToolPanel","ColumnMenu"],groupContracted:"GroupCellRenderer",groupExpanded:"GroupCellRenderer",setFilterGroupClosed:"SetFilter",setFilterGroupOpen:"SetFilter",setFilterGroupIndeterminate:"SetFilter",setFilterLoading:"SetFilter",close:"EnterpriseCore",check:"MenuItem",colorPicker:"CommunityCore",groupLoading:"LoadingCellRenderer",menuAlt:"ColumnHeaderComp",menuPin:"MenuCore",menuValue:"MenuCore",menuAddRowGroup:["MenuCore","ColumnsToolPanel"],menuRemoveRowGroup:["MenuCore","ColumnsToolPanel"],clipboardCopy:"MenuCore",clipboardCut:"MenuCore",clipboardPaste:"MenuCore",pivotPanel:["ColumnsToolPanel","RowGroupingPanel"],rowGroupPanel:["ColumnsToolPanel","RowGroupingPanel"],valuePanel:"ColumnsToolPanel",columnDrag:"EnterpriseCore",rowDrag:["RowDrag","DragAndDrop"],csvExport:"MenuCore",excelExport:"MenuCore",smallDown:"CommunityCore",selectOpen:"CommunityCore",richSelectOpen:"RichSelect",richSelectRemove:"RichSelect",smallLeft:"CommunityCore",smallRight:"CommunityCore",subMenuOpen:"MenuItem",subMenuOpenRtl:"MenuItem",panelDelimiter:"RowGroupingPanel",panelDelimiterRtl:"RowGroupingPanel",smallUp:"CommunityCore",sortAscending:["MenuCore","Sort"],sortDescending:["MenuCore","Sort"],sortUnSort:["MenuCore","Sort"],advancedFilterBuilder:"AdvancedFilter",advancedFilterBuilderDrag:"AdvancedFilter",advancedFilterBuilderInvalid:"AdvancedFilter",advancedFilterBuilderMoveUp:"AdvancedFilter",advancedFilterBuilderMoveDown:"AdvancedFilter",advancedFilterBuilderAdd:"AdvancedFilter",advancedFilterBuilderRemove:"AdvancedFilter",advancedFilterBuilderSelectOpen:"AdvancedFilter",chartsMenu:"IntegratedCharts",chartsMenuEdit:"IntegratedCharts",chartsMenuAdvancedSettings:"IntegratedCharts",chartsMenuAdd:"IntegratedCharts",chartsColorPicker:"IntegratedCharts",chartsThemePrevious:"IntegratedCharts",chartsThemeNext:"IntegratedCharts",chartsDownload:"IntegratedCharts",checkboxChecked:"CommunityCore",checkboxIndeterminate:"CommunityCore",checkboxUnchecked:"CommunityCore",radioButtonOn:"CommunityCore",radioButtonOff:"CommunityCore",rowPin:"PinnedRow",rowUnpin:"PinnedRow",rowPinBottom:"PinnedRow",rowPinTop:"PinnedRow"},HQ=new Set(["colorPicker","smallUp","checkboxChecked","checkboxIndeterminate","checkboxUnchecked","radioButtonOn","radioButtonOff","smallDown","smallLeft","smallRight"]),GQ=class extends Ee{constructor(){super(...arguments),this.beanName="validation"}wireBeans(e){this.gridOptions=e.gridOptions,f7(CQ)}warnOnInitialPropertyUpdate(e,t){e==="api"&&MQ[t]&&Me(22,{key:t})}processGridOptions(e){this.processOptions(e,Mq())}validateApiFunction(e,t){return IQ(e,t,this.beans)}missingUserComponent(e,t,r,n){const i=Nu[t];i?this.gos.assertModuleRegistered(i,`AG Grid '${e}' component: ${t}`):Me(101,{propertyName:e,componentName:t,agGridDefaults:r,jsComps:n})}missingDynamicBean(e){const t=OQ[e];return t?eo(200,{...this.gos.getModuleErrorParams(),moduleName:t,reasonOrId:e}):void 0}checkRowEvents(e){zQ.has(e)&&Me(10,{eventType:e})}validateIcon(e){if(HQ.has(e)&&Me(43,{iconName:e}),NQ[e])return;const t=BQ[e];if(t){Zt(200,{reasonOrId:`icon '${e}'`,moduleName:t,gridScoped:lx(),gridId:this.beans.context.getId(),rowModelType:this.gos.get("rowModelType"),additionalText:"Alternatively, use the CSS icon name directly."});return}Me(134,{iconName:e})}isProvidedUserComp(e){return!!Nu[e]}validateColDef(e){this.processOptions(e,bq())}processOptions(e,t){const{validations:r,deprecations:n,allProperties:i,propertyExceptions:s,objectName:o,docsUrl:a}=t;i&&this.gridOptions.suppressPropertyNamesCheck!==!0&&this.checkProperties(e,[...s??[],...Object.keys(n)],i,o,a);const u=new Set;if(Object.keys(e).forEach(h=>{const g=n[h];if(g){const{message:R,version:E}=g;u.add(`As of v${E}, ${String(h)} is deprecated. ${R??""}`)}const m=e[h];if(m==null||m===!1)return;const v=r[h];if(!v)return;const{dependencies:w,validate:C,supportedRowModels:b,expectedType:x}=v;if(x){const R=typeof m;if(R!==x){u.add(`${String(h)} should be of type '${x}' but received '${R}' (${m}).`);return}}if(b){const R=this.gridOptions.rowModelType??"clientSide";if(!b.includes(R)){u.add(`${String(h)} is not supported with the '${R}' row model. It is only valid with: ${b.join(", ")}.`);return}}if(w){const R=this.checkForRequiredDependencies(h,w,e);if(R){u.add(R);return}}if(C){const R=C(e,this.gridOptions,this.beans);if(R){u.add(R);return}}}),u.size>0)for(const h of u)Bh(h)}checkForRequiredDependencies(e,t,r){const i=Object.entries(t).filter(([s,o])=>{const a=r[s];return!o.required.includes(a)});return i.length===0?null:i.map(([s,o])=>`'${String(e)}' requires '${s}' to be one of [${o.required.map(a=>a===null?"null":a===void 0?"undefined":a).join(", ")}]. ${o.reason??""}`).join(`
           `)}checkProperties(e,t,r,n,i){const s=["__ob__","__v_skip","__metadata__"],o=VQ(Object.getOwnPropertyNames(e),[...s,...t,...r],r),a=Object.keys(o);for(const u of a){const d=o[u];let h=`invalid ${n} property '${u}' did you mean any of these: ${d.slice(0,8).join(", ")}.`;r.includes("context")&&(h+=`
If you are trying to annotate ${n} with application data, use the '${n}.context' property instead.`),Bh(h)}if(a.length>0&&i){const u=this.beans.frameworkOverrides.getDocLink(i);Bh(`to see all the valid ${n} properties please check: ${u}`)}}};function VQ(e,t,r){const n={},i=e.filter(s=>!t.some(o=>o===s));if(i.length>0)for(const s of i)n[s]=kb({inputValue:s,allSuggestions:r}).values;return n}var zQ=new Set(["firstChildChanged","lastChildChanged","childIndexChanged"]),WQ={moduleName:"Validation",version:Ue,beans:[GQ]};function jL(e){const t=e.sibling;t&&(t.childrenAfterFilter=e.childrenAfterFilter)}var UQ=class extends Ee{constructor(){super(...arguments),this.beanName="filterStage",this.step="filter",this.refreshProps=["excludeChildrenWhenTreeDataFiltering"]}wireBeans(e){this.filterManager=e.filterManager}execute(e){const{changedPath:t}=e;this.filter(t)}filter(e){const t=!!this.filterManager?.isChildFilterPresent();this.filterNodes(t,e)}filterNodes(e,t){const r=(n,i)=>{n.hasChildren()&&e&&!i?n.childrenAfterFilter=n.childrenAfterGroup.filter(s=>{const o=s.childrenAfterFilter&&s.childrenAfterFilter.length>0,a=s.data&&this.filterManager.doesRowPassFilter({rowNode:s});return o||a}):n.childrenAfterFilter=n.childrenAfterGroup,jL(n)};if(this.doingTreeDataFiltering()){const n=(s,o)=>{if(s.childrenAfterGroup)for(let a=0;a<s.childrenAfterGroup.length;a++){const u=s.childrenAfterGroup[a],d=o||this.filterManager.doesRowPassFilter({rowNode:u});u.childrenAfterGroup?n(s.childrenAfterGroup[a],d):r(u,d)}r(s,o)},i=s=>n(s,!1);t.executeFromRootNode(i)}else{const n=i=>r(i,!1);t.forEachChangedNodeDepthFirst(n,!0)}}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}},$Q=class extends Ax{constructor(){super(...arguments),this.iconCreated=!1}wireComp(e,t,r,n,i){this.comp=e;const s=Gf(this,this.beans.context,i);this.eButtonShowMainFilter=r,this.eFloatingFilterBody=n,this.setGui(t,s),this.setupActive(),this.refreshHeaderStyles(),this.setupWidth(s),this.setupLeft(s),this.setupHover(s),this.setupFocus(s),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(s),this.setupUi(),s.addManagedElementListeners(this.eButtonShowMainFilter,{click:this.showParentFilter.bind(this)}),this.setupFilterChangedListener(s);const o=()=>this.onColDefChanged(s);s.addManagedListeners(this.column,{colDefChanged:o}),s.addManagedEventListeners({filterSwitched:({column:a})=>{a===this.column&&o()}}),s.addDestroyFunc(()=>{this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.clearComponent()})}resizeHeader(){}moveHeader(){}getHeaderClassParams(){const{column:e,beans:t}=this,r=e.colDef;return it(t.gos,{colDef:r,column:e,floatingFilter:!0})}setupActive(){const e=this.column.getColDef(),t=!!e.filter,r=!!e.floatingFilter;this.active=t&&r}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;const e=ts("filter",this.beans,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(e){e.createManagedBean(new wd(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){const e=this.getLocaleTextFunc();Qu(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){const{beans:t}=this;if(Fr(t)===this.eGui)return;const i=vc(t,this.eGui,null,e.shiftKey);if(i){t.headerNavigation?.scrollToColumn(this.column),e.preventDefault(),i.focus();return}const s=this.findNextColumnWithFloatingFilter(e.shiftKey);s&&t.focusSvc.focusHeaderPosition({headerPosition:{headerRowIndex:this.rowCtrl.rowIndex,column:s},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){const t=this.beans.visibleCols;let r=this.column;do if(r=e?t.getColBefore(r):t.getColAfter(r),!r)break;while(!r.getColDef().filter||!r.getColDef().floatingFilter);return r}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();switch(e.key){case me.UP:case me.DOWN:case me.LEFT:case me.RIGHT:if(t)return;nc(e);case me.ENTER:t&&rc(this.eGui)&&e.preventDefault();break;case me.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;const r=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),n=!!e.relatedTarget&&Hl(e.relatedTarget,"ag-floating-filter");if(r&&n&&e.target===this.eGui){const i=this.lastFocusEvent,s=!!(i&&i.key===me.TAB);if(i&&s){const o=i.shiftKey;rc(this.eGui,o)}}this.focusThis()}setupHover(e){this.beans.colHover?.addHeaderFilterColumnHoverListener(e,this.comp,this.column,this.eGui)}setupLeft(e){const t=new Dx(this.column,this.eGui,this.beans);e.createManagedBean(t)}setupFilterButton(){this.suppressFilterButton=!this.beans.menuSvc?.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!Ri(this.gos)}setupUserComp(){if(!this.active)return;const e=this.beans.colFilter?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){const e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.beans.menuSvc?.showFilterMenu({column:this.column,buttonElement:e,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(e){if(!this.active)return;const{beans:{colFilter:t},column:r,gos:n}=this,i=s=>{if(s?.source==="filterDestroyed"&&(!this.isAlive()||!t?.isAlive()))return;const o=this.comp.getFloatingFilterComp();o&&o.then(a=>{if(a){if(n.get("enableFilterHandlers")){const h=s;let g="filter";h?.afterFloatingFilter?g="ui":h?.afterDataChange?g="dataChanged":s?.source==="api"&&(g="api"),this.updateFloatingFilterParams(this.userCompDetails,g);return}const u=t?.getCurrentFloatingFilterParentModel(r),d=s?{...s,columns:s.columns??[],source:s.source==="api"?"api":"columnFilter"}:null;a.onParentModelChanged(u,d)}})};[this.destroySyncListener]=e.addManagedListeners(r,{filterChanged:i}),t?.isFilterActive(r)&&i(null)}setupWidth(e){const t=()=>{const r=`${this.column.getActualWidth()}px`;this.comp.setWidth(r)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupFilterChangedListener(e){this.active&&([this.destroyFilterChangedListener]=e.addManagedListeners(this.column,{filterChanged:this.updateFilterButton.bind(this)}),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){const e=!!this.beans.filterManager?.isFilterAllowed(this.column);this.comp.setButtonWrapperDisplayed(e),this.highlightFilterButtonWhenActive&&e&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(e){const t=this.active;this.setupActive();const r=!t&&this.active;t&&!this.active&&(this.destroySyncListener(),this.destroyFilterChangedListener());const n=this.beans.colFilter,i=this.active?n?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,s=this.comp.getFloatingFilterComp();!s||!i?this.updateCompDetails(e,i,r):s.then(o=>{!o||n?.areFilterCompsDifferent(this.userCompDetails??null,i)?this.updateCompDetails(e,i,r):this.updateFloatingFilterParams(i,"colDef")})}updateCompDetails(e,t,r){this.isAlive()&&(this.setCompDetails(t),this.setupFilterButton(),this.setupUi(),r&&(this.setupSyncWithFilter(e),this.setupFilterChangedListener(e)))}updateFloatingFilterParams(e,t){if(!e)return;let r=e.params;this.comp.getFloatingFilterComp()?.then(n=>{typeof n?.refresh=="function"&&(this.gos.get("enableFilterHandlers")&&(r={...r,model:on(this.beans.colFilter?.model??{},this.column.getColId()),source:t}),n.refresh(r))})}addResizeAndMoveKeyboardListeners(){}destroy(){super.destroy(),this.destroySyncListener=null,this.destroyFilterChangedListener=null}};function jQ(e,t){const r=e.colModel.getCol(t);if(!r){Zt(12,{colKey:t});return}e.menuSvc?.showColumnMenu({column:r,positionBy:"auto"})}function YQ(e){e.menuSvc?.hidePopupMenu()}var KQ={moduleName:"SharedMenu",version:Ue,beans:[y$],apiFunctions:{showColumnMenu:jQ,hidePopupMenu:YQ}},qQ=class extends q9{postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridCtrl=e.gridCtrl}),this.addManagedEventListeners({gridStylesChanged:this.handleThemeChange.bind(this)})}getDefaultPopupParent(){return this.gridCtrl.getGui()}positionPopupForMenu(e){const{eventSource:t,ePopup:r,event:n}=e,i=t.getBoundingClientRect(),s=this.getParentRect();this.setAlignedTo(t,r);let o=!1;const a=()=>{const u=this.keepXYWithinBounds(r,i.top-s.top,0),d=r.clientWidth>0?r.clientWidth:200;o||(r.style.minWidth=`${d}px`,o=!0);const g=s.right-s.left-d;let m;return this.gos.get("enableRtl")?(m=w(),m<0&&(m=v(),this.setAlignedStyles(r,"left")),m>g&&(m=0,this.setAlignedStyles(r,"right"))):(m=v(),m>g&&(m=w(),this.setAlignedStyles(r,"right")),m<0&&(m=0,this.setAlignedStyles(r,"left"))),{x:m,y:u};function v(){return i.right-s.left-2}function w(){return i.left-s.left-d}};this.positionPopup({ePopup:r,keepWithinBounds:!0,updatePosition:a,postProcessCallback:()=>this.callPostProcessPopup(e,"subMenu",r,t,n instanceof MouseEvent?n:void 0)})}callPostProcessPopup(e,t,r,n,i){const s=this.gos.getCallback("postProcessPopup");if(s){const{column:o,rowNode:a}=e;s({column:o,rowNode:a,ePopup:r,type:t,eventSource:n,mouseEvent:i})}}getActivePopups(){return this.popupList.map(e=>e.element)}handleThemeChange(e){if(e.themeChanged){const t=this.beans.environment;for(const r of this.popupList)t.applyThemeClasses(r.wrapper)}}hasAnchoredPopup(){return this.popupList.some(e=>e.isAnchored)}isStopPropagation(e){return zo(e)}},Jm={moduleName:"Popup",version:Ue,beans:[qQ]},XQ=".ag-set-filter{--ag-indentation-level:0}.ag-set-filter-item{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-set-filter-item{padding-left:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}:where(.ag-rtl) .ag-set-filter-item{padding-right:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}.ag-set-filter-item-checkbox{display:flex;height:100%;width:100%}.ag-set-filter-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr) .ag-set-filter-group-icons{margin-right:var(--ag-widget-container-horizontal-padding)}:where(.ag-rtl) .ag-set-filter-group-icons{margin-left:var(--ag-widget-container-horizontal-padding)}.ag-filter-body-wrapper{display:flex;flex-direction:column}:where(.ag-menu:not(.ag-tabs) .ag-filter) .ag-filter-body-wrapper,:where(.ag-menu:not(.ag-tabs) .ag-filter)>:not(.ag-filter-wrapper){min-width:180px}.ag-filter-filter{flex:1 1 0px}.ag-filter-condition{display:flex;justify-content:center}.ag-floating-filter-body{display:flex;flex:1 1 auto;height:100%;position:relative}.ag-floating-filter-full-body{align-items:center;display:flex;flex:1 1 auto;height:100%;overflow:hidden;width:100%}:where(.ag-floating-filter-full-body)>div{flex:1 1 auto}.ag-floating-filter-input{align-items:center;display:flex;width:100%;>*{flex:1 1 auto}:where(.ag-input-field-input[type=date]),:where(.ag-input-field-input[type=datetime-local]){width:1px}}.ag-floating-filter-button{display:flex;flex:none}.ag-date-floating-filter-wrapper{display:flex}.ag-set-floating-filter-input :where(input)[disabled]{pointer-events:none}.ag-floating-filter-button-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;height:var(--ag-icon-size);width:var(--ag-icon-size)}.ag-filter-loading{align-items:unset;background-color:var(--ag-chrome-background-color);height:100%;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;width:100%;z-index:1;:where(.ag-menu) &{background-color:var(--ag-menu-background-color)}}.ag-filter-separator{border-top:solid var(--ag-border-width) var(--menu-separator-color)}:where(.ag-filter-select) .ag-picker-field-wrapper{width:0}.ag-filter-condition-operator{height:17px}:where(.ag-ltr) .ag-filter-condition-operator-or{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-condition-operator-or{margin-right:calc(var(--ag-spacing)*2)}.ag-set-filter-select-all{padding-top:var(--ag-widget-container-vertical-padding)}.ag-filter-no-matches,.ag-set-filter-list{height:calc(var(--ag-list-item-height)*6)}.ag-filter-no-matches{padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}.ag-set-filter-tree-list{height:calc(var(--ag-list-item-height)*10)}.ag-set-filter-filter{margin-left:var(--ag-widget-container-horizontal-padding);margin-right:var(--ag-widget-container-horizontal-padding);margin-top:var(--ag-widget-container-vertical-padding)}.ag-filter-to{margin-top:var(--ag-widget-vertical-spacing)}.ag-mini-filter{margin:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}:where(.ag-ltr) .ag-set-filter-add-group-indent{margin-left:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-rtl) .ag-set-filter-add-group-indent{margin-right:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-filter-menu) .ag-set-filter-list{min-width:200px}.ag-filter-virtual-list-item:focus-visible{box-shadow:inset var(--ag-focus-shadow)}.ag-filter-apply-panel{display:flex;justify-content:flex-end;overflow:hidden;padding:var(--ag-widget-vertical-spacing) var(--ag-widget-container-horizontal-padding) var(--ag-widget-container-vertical-padding)}.ag-filter-apply-panel-button{line-height:1.5}:where(.ag-ltr) .ag-filter-apply-panel-button{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-apply-panel-button{margin-right:calc(var(--ag-spacing)*2)}.ag-simple-filter-body-wrapper{display:flex;flex-direction:column;min-height:calc(var(--ag-list-item-height) + var(--ag-widget-container-vertical-padding) + var(--ag-widget-vertical-spacing));overflow-y:auto;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);padding-bottom:calc(var(--ag-widget-container-vertical-padding) - var(--ag-widget-vertical-spacing));&>*{margin-bottom:var(--ag-widget-vertical-spacing)}:where(.ag-resizer-wrapper){margin:0}}.ag-multi-filter-menu-item{margin:var(--ag-spacing) 0}.ag-multi-filter-group-title-bar{background-color:transparent;color:var(--ag-header-text-color);font-weight:500;padding:calc(var(--ag-spacing)*1.5) var(--ag-spacing)}.ag-group-filter-field-select-wrapper{display:flex;flex-direction:column;gap:var(--ag-widget-vertical-spacing);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}";function QQ(e){const t=e.filterManager;return!!t?.isColumnFilterPresent()||!!t?.isAggregateFilterPresent()}function ZQ(e,t){return e.filterManager?.getColumnFilterInstance(t)??Promise.resolve(void 0)}function JQ(e,t){const r=e.colModel.getColDefCol(t);if(r)return e.colFilter?.destroyFilter(r,"api")}function eZ(e,t){e.frameworkOverrides.wrapIncoming(()=>e.filterManager?.setFilterModel(t))}function tZ(e){return e.filterManager?.getFilterModel()??{}}function rZ(e,t,r){const{gos:n,colModel:i,colFilter:s}=e;r&&!n.get("enableFilterHandlers")&&(Me(288),r=!1);const o=i.getColDefCol(t);return o?s?.getModelForColumn(o,r)??null:null}function nZ(e,t,r){return e.filterManager?.setColumnFilterModel(t,r)??Promise.resolve()}function iZ(e,t){const r=e.colModel.getCol(t);if(!r){Zt(12,{colKey:t});return}e.menuSvc?.showFilterMenu({column:r,containerType:"columnFilter",positionBy:"auto"})}function sZ(e){e.menuSvc?.hideFilterMenu()}function oZ(e,t){const r=e.colModel.getCol(t);if(!r){Zt(12,{colKey:t});return}return e.colFilter?.getHandler(r,!0)}function aZ(e,t){const{colModel:r,colFilter:n,gos:i}=e;if(!i.get("enableFilterHandlers")){Me(287);return}const{colId:s,action:o}=t;if(s){const a=r.getColById(s);a&&n?.updateModel(a,o)}else n?.updateAllModels(o)}var lZ={filterHandler:()=>({doesFilterPass:()=>!0})},cZ=class extends Ee{constructor(){super(...arguments),this.beanName="colFilter",this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.modelUpdates=[],this.columnModelUpdates=[],this.state=new Map,this.handlerMap={...Y_},this.isGlobalButtons=!1,this.activeFilterComps=new Set}postConstruct(){this.addManagedEventListeners({gridColumnsChanged:this.onColumnsChanged.bind(this),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)});const e=this.gos,t={...e.get("initialState")?.filter?.filterModel??{}};this.initialModel=t,this.model={...t},e.get("enableFilterHandlers")||delete this.handlerMap.agMultiColumnFilter}refreshModel(){this.onNewRowsLoaded("rowDataUpdated")}setModel(e,t="api",r){const{colModel:n,dataTypeSvc:i,filterManager:s}=this.beans;if(i?.isPendingInference){this.modelUpdates.push({model:e,source:t});return}const o=[],a=this.getModel(!0);if(e){const u=new Set(Object.keys(e));this.allColumnFilters.forEach((d,h)=>{const g=e[h];o.push(this.setModelOnFilterWrapper(d,g)),u.delete(h)}),u.forEach(d=>{const h=n.getColDefCol(d)||n.getCol(d);if(!h){Me(62,{colId:d});return}if(!h.isFilterAllowed()){Me(63,{colId:d});return}const g=this.getOrCreateFilterWrapper(h,!0);if(!g){Me(64,{colId:d});return}o.push(this.setModelOnFilterWrapper(g,e[d],!0))})}else this.model={},this.allColumnFilters.forEach(u=>{o.push(this.setModelOnFilterWrapper(u,null))});Nt.all(o).then(()=>{const u=this.getModel(!0),d=[];this.allColumnFilters.forEach((h,g)=>{const m=a?a[g]:null,v=u?u[g]:null;sf(m,v)||d.push(h.column)}),d.length>0?s?.onFilterChanged({columns:d,source:t}):r&&this.updateActive("filterChanged")})}getModel(e){const t={},{allColumnFilters:r,initialModel:n,beans:{colModel:i}}=this;if(r.forEach((s,o)=>{const a=this.getModelFromFilterWrapper(s);$e(a)&&(t[o]=a)}),!e)for(const s of Object.keys(n)){const o=n[s];$e(o)&&!r.has(s)&&i.getCol(s)?.isFilterAllowed()&&(t[s]=o)}return t}setState(e,t,r="api"){if(this.state.clear(),t)for(const n of Object.keys(t)){const i=t[n];this.state.set(n,{model:on(this.model,n),state:i})}this.setModel(e,r,!0)}getState(){const e=this.state;if(!e.size)return;const t={};let r=!1;return e.forEach((n,i)=>{const s=n.state;s!=null&&(r=!0,t[i]=s)}),r?t:void 0}getModelFromFilterWrapper(e){const r=e.column.getColId();if(e.isHandler)return on(this.model,r);const n=e.filter;return n?typeof n.getModel!="function"?(Me(66),null):n.getModel():on(this.initialModel,r)}isFilterPresent(){return this.activeColumnFilters.length>0}isAggFilterPresent(){return!!this.activeAggregateFilters.length}disableFilters(){this.initialModel={};const{allColumnFilters:e}=this;return e.size?(e.forEach(t=>this.disposeFilterWrapper(t,"advancedFilterEnabled")),!0):!1}updateActiveFilters(){const e=d=>d?d.isFilterActive?d.isFilterActive():(Me(67),!1):!1,{colModel:t,gos:r}=this.beans,n=!!xb(r),i=d=>{if(!d.isPrimary())return!0;const g=!t.isPivotActive();return!d.isValueActive()||!g?!1:t.isPivotMode()?!0:n},s=[],o=[],a=(d,h,g)=>{h&&(i(d)?s.push(g):o.push(g))},u=[];return this.allColumnFilters.forEach(d=>{const h=d.column,g=h.getColId();if(d.isHandler)u.push(Nt.resolve().then(()=>{a(h,this.isHandlerActive(h),{colId:g,isHandler:!0,handler:d.handler,handlerParams:d.handlerParams})}));else{const m=Ma(d);m&&u.push(m.then(v=>{a(h,e(v),{colId:g,isHandler:!1,comp:v})}))}}),Nt.all(u).then(()=>{this.activeAggregateFilters=s,this.activeColumnFilters=o})}updateFilterFlagInColumns(e,t){const r=[];return this.allColumnFilters.forEach(n=>{const i=n.column;if(n.isHandler)r.push(Nt.resolve().then(()=>{this.setColFilterActive(i,this.isHandlerActive(i),e,t)}));else{const s=Ma(n);s&&r.push(s.then(o=>{this.setColFilterActive(i,o.isFilterActive(),e,t)}))}}),this.beans.groupFilter?.updateFilterFlags(e,t),Nt.all(r)}doFiltersPass(e,t,r){const{data:n,aggData:i}=e,s=r?this.activeAggregateFilters:this.activeColumnFilters,o=r?i:n,a=this.model;for(let u=0;u<s.length;u++){const d=s[u],{colId:h,isHandler:g}=d;if(h!==t)if(g){const{handler:m,handlerParams:v}=d;if(!m.doesFilterPass({node:e,data:o,model:on(a,h),handlerParams:v}))return!1}else{const m=d.comp;if(typeof m.doesFilterPass!="function"){Zt(91);continue}if(!m.doesFilterPass({node:e,data:o}))return!1}}return!0}getHandlerParams(e){const t=this.allColumnFilters.get(e.getColId());return t?.isHandler?t.handlerParams:void 0}callOnFilterChangedOutsideRenderCycle(e){const{rowRenderer:t,filterManager:r}=this.beans,n=()=>{this.isAlive()&&r?.onFilterChanged(e)};t.isRefreshInProgress()?setTimeout(n,0):n()}updateBeforeFilterChanged(e={}){const{column:t,additionalEventAttributes:r}=e,n=t?.getColId();return this.updateActiveFilters().then(()=>this.updateFilterFlagInColumns("filterChanged",r).then(()=>{this.allColumnFilters.forEach(i=>{const{column:s,isHandler:o}=i;n!==s.getColId()&&(o&&i.handler.onAnyFilterChanged?.(),Ma(i,o)?.then(a=>{typeof a?.onAnyFilterChanged=="function"&&a.onAnyFilterChanged()}))}),this.processingFilterChange=!0}))}updateAfterFilterChanged(){this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){return!(this.gos.get("allowShowChangeAfterFilter")??!1)&&this.processingFilterChange}onNewRowsLoaded(e){const t=[];this.allColumnFilters.forEach(r=>{const n=r.isHandler;n&&r.handler.onNewRowsLoaded?.();const i=Ma(r,n);i&&t.push(i.then(s=>{s.onNewRowsLoaded?.()}))}),Nt.all(t).then(()=>this.updateActive(e,{afterDataChange:!0}))}updateActive(e,t){this.updateFilterFlagInColumns(e,t).then(()=>this.updateActiveFilters())}createGetValue(e,t){const{filterValueSvc:r,colModel:n}=this.beans;return(i,s)=>{const o=s?n.getCol(s):e;return o?r.getValue(o,i,t):void 0}}isFilterActive(e){const t=this.cachedFilter(e);if(t?.isHandler)return this.isHandlerActive(e);const r=t?.filter;return r?r.isFilterActive():on(this.initialModel,e.getColId())!=null}isHandlerActive(e){const t=$e(on(this.model,e.getColId()));if(t)return t;const r=this.beans.groupFilter;return r?.isGroupFilter(e)?r.isFilterActive(e):!1}getOrCreateFilterUi(e){const t=this.getOrCreateFilterWrapper(e,!0);return t?Ma(t):null}getFilterUiForDisplay(e){const t=this.getOrCreateFilterWrapper(e,!0);if(!t)return null;const r=Ma(t);return r?r.then(n=>({comp:n,params:t.filterUi.filterParams,isHandler:t.isHandler})):null}getHandler(e,t){const r=this.getOrCreateFilterWrapper(e,t);return r?.isHandler?r.handler:void 0}getOrCreateFilterWrapper(e,t){if(!e.isFilterAllowed())return;let r=this.cachedFilter(e);return!r&&t&&(r=this.createFilterWrapper(e),this.setColumnFilterWrapper(e,r)),r}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(e,t=!1){return this.getDefaultFilterFromDataType(()=>this.beans.dataTypeSvc?.getBaseDataType(e),t)}getDefaultFilterFromDataType(e,t=!1){return A7(this.gos)?t?"agSetColumnFloatingFilter":"agSetColumnFilter":CU(e(),t)}getDefaultFloatingFilter(e){return this.getDefaultFilter(e,!0)}createFilterComp(e,t,r,n,i,s){const o=()=>{const d=this.createFilterCompParams(e,i,s),h=n(d,i);return LW(this.beans.userCompFactory,t,h,r)},a=o();return a?{compDetails:a,createFilterUi:d=>(d?o():a).newAgStackInstance()}:null}createFilterInstance(e,t,r,n){const i=this.beans.selectableFilter;i?.isSelectable(t)&&(t=i.getFilterDef(e,t));const{handler:s,handlerParams:o,handlerGenerator:a}=this.createHandler(e,t,r)??{},u=this.createFilterComp(e,t,r,n,!!s,"init");if(!u)return{compDetails:null,createFilterUi:null,handler:s,handlerGenerator:a,handlerParams:o};const{compDetails:d,createFilterUi:h}=u;return this.isGlobalButtons&&(d.params?.buttons?.length||Me(281,{colId:e.getColId()})),{compDetails:d,handler:s,handlerGenerator:a,handlerParams:o,createFilterUi:h}}createBaseFilterParams(e,t){const{filterManager:r,rowModel:n}=this.beans;return it(this.gos,{column:e,colDef:e.getColDef(),getValue:this.createGetValue(e),doesRowPassOtherFilter:t?()=>!0:i=>r?.doesRowPassOtherFilters(e.getColId(),i)??!0,rowModel:n})}createFilterCompParams(e,t,r,n){const i=this.filterChangedCallbackFactory(e),s=this.createBaseFilterParams(e,n);if(s.filterChangedCallback=i,s.filterModifiedCallback=n?()=>{}:o=>this.filterModified(e,o),t){const o=s,a=e.getColId(),u=on(this.model,a);o.model=u,o.state=this.state.get(a)??{model:u},o.onModelChange=(d,h)=>{this.updateStoredModel(a,d),this.refreshHandlerAndUi(e,d,"ui",!1,h).then(()=>{i({...h,source:"columnFilter"})})},o.onStateChange=d=>{this.updateState(e,d),this.updateOrRefreshFilterUi(e)},o.onAction=(d,h,g)=>{this.updateModel(e,d,h),this.dispatchLocalEvent({type:"filterAction",column:e,action:d,event:g})},o.getHandler=()=>this.getHandler(e,!0),o.onUiChange=d=>this.filterUiChanged(e,d),o.source=r}return s}createFilterUiForHandler(e,t){return t?{created:!1,create:t,filterParams:e.params,compDetails:e}:null}createFilterUiLegacy(e,t,r){const n=t(),i={created:!0,create:t,filterParams:e.params,compDetails:e,promise:n};return n.then(r),i}createFilterWrapper(e){const{compDetails:t,handler:r,handlerGenerator:n,handlerParams:i,createFilterUi:s}=this.createFilterInstance(e,e.getColDef(),this.getDefaultFilter(e),a=>a),o=e.getColId();if(r)return delete this.initialModel[o],r.init?.({...i,source:"init",model:on(this.model,o)}),{column:e,isHandler:!0,handler:r,handlerGenerator:n,handlerParams:i,filterUi:this.createFilterUiForHandler(t,s)};if(s){const a={column:e,filterUi:null,isHandler:!1};return a.filterUi=this.createFilterUiLegacy(t,s,u=>{a.filter=u??void 0}),a}return{column:e,filterUi:null,isHandler:!1}}createHandlerFunc(e,t,r){const{gos:n,frameworkOverrides:i,registry:s}=this.beans;let o;const a=v=>{const w=v.filter;if(S_(w)){const C=w.handler;return C||(o=w.doesFilterPass,o?()=>({doesFilterPass:o}):void 0)}return typeof w=="string"?w:void 0},u=n.get("enableFilterHandlers"),d=u?a(t):void 0,h=v=>()=>this.createBean(s.createDynamicBean(v,!0));let g,m;if(typeof d=="string"){const v=n.get("filterHandlers")?.[d];v!=null?g=v:aU.has(d)&&(g=h(d),m=d)}else g=d;if(!g){let v;const{compName:w,jsComp:C,fwComp:b}=R_(i,t);w?v=w:C==null&&b==null&&t.filter===!0&&(v=r),m=this.handlerMap[v],m&&(g=h(m))}return g?{filterHandler:g,handlerNameOrCallback:o??m}:u?(_r(n)&&Me(277,{colId:e.getColId()}),lZ):void 0}createHandler(e,t,r){const n=this.createHandlerFunc(e,t,r);if(!n)return;const i=sy(this.beans.userCompFactory,t,this.createFilterCompParams(e,!0,"init")),{handlerNameOrCallback:s,filterHandler:o}=n,{handler:a,handlerParams:u}=this.createHandlerFromFunc(e,o,i);return{handler:a,handlerParams:u,handlerGenerator:s??o}}createHandlerFromFunc(e,t,r){const n=e.getColDef(),i=t(it(this.gos,{column:e,colDef:n})),s=this.createHandlerParams(e,r);return{handler:i,handlerParams:s}}createHandlerParams(e,t){const r=e.getColDef(),n=e.getColId(),i=this.filterChangedCallbackFactory(e);return it(this.gos,{colDef:r,column:e,getValue:this.createGetValue(e),doesRowPassOtherFilter:s=>this.beans.filterManager?.doesRowPassOtherFilters(n,s)??!0,onModelChange:(s,o)=>{this.updateStoredModel(n,s),this.refreshHandlerAndUi(e,s,"handler",!1,o).then(()=>{i({...o,source:"columnFilter"})})},filterParams:t})}onColumnsChanged(){const e=[],{colModel:t,filterManager:r,groupFilter:n}=this.beans;this.allColumnFilters.forEach((s,o)=>{let a;s.column.isPrimary()?a=t.getColDefCol(o):a=t.getCol(o),!(a&&a===s.column)&&(e.push(s.column),this.disposeFilterWrapper(s,"columnChanged"),this.disposeColumnListener(o))});const i=n&&e.every(s=>n.isGroupFilter(s));e.length>0&&!i&&r?.onFilterChanged({columns:e,source:"api"})}isFilterAllowed(e){if(!e.isFilterAllowed())return!1;const r=this.beans.groupFilter;return r?.isGroupFilter(e)?r.isFilterAllowed(e):!0}getFloatingFilterCompDetails(e,t){const{userCompFactory:r,frameworkOverrides:n,selectableFilter:i}=this.beans,s=m=>{const v=this.getOrCreateFilterUi(e);v?.then(w=>{m(hf(w))})},o=e.getColDef(),a=i?.isSelectable(o)?i.getFilterDef(e,o):o,u=EU(n,a,()=>this.getDefaultFloatingFilter(e))??"agReadOnlyFloatingFilter",d=this.gos.get("enableFilterHandlers"),h=sy(r,a,this.createFilterCompParams(e,d,"init",!0)),g=it(this.gos,{column:e,filterParams:h,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(e),parentFilterInstance:s,showParentFilter:t});if(d){const m=g,v=e.getColId(),w=this.filterChangedCallbackFactory(e);m.onUiChange=C=>this.floatingFilterUiChanged(e,C),m.model=on(this.model,v),m.onModelChange=(C,b)=>{this.updateStoredModel(v,C),this.refreshHandlerAndUi(e,C,"floating",!0,b).then(()=>{w({...b,source:"columnFilter"})})},m.getHandler=()=>this.getHandler(e,!0),m.source="init"}return HW(r,o,g,u)}getCurrentFloatingFilterParentModel(e){return this.getModelFromFilterWrapper(this.cachedFilter(e)??{column:e})}destroyFilterUi(e,t,r,n){const i="paramsUpdated";if(e.isHandler){const s=t.getColId();delete this.initialModel[s],this.state.delete(s);const o=e.filterUi,a=this.createFilterUiForHandler(r,n);e.filterUi=a;const u=this.eventSvc;o?.created?o.promise.then(d=>{this.destroyBean(d),u.dispatchEvent({type:"filterDestroyed",source:i,column:t})}):u.dispatchEvent({type:"filterHandlerDestroyed",source:i,column:t})}else this.destroyFilter(t,i)}destroyFilter(e,t="api"){const r=e.getColId(),n=this.allColumnFilters.get(r);this.disposeColumnListener(r),delete this.initialModel[r],n&&this.disposeFilterWrapper(n,t).then(i=>{i&&this.isAlive()&&this.beans.filterManager?.onFilterChanged({columns:[e],source:"api"})})}disposeColumnListener(e){const t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(e,t){let r=!1;const{column:n,isHandler:i,filterUi:s}=e,o=n.getColId();i&&(r=this.isHandlerActive(n),this.destroyBean(e.handler),delete this.model[o],this.state.delete(o));const a=()=>{this.setColFilterActive(n,!1,"filterDestroyed"),this.allColumnFilters.delete(o),this.eventSvc.dispatchEvent({type:"filterDestroyed",source:t,column:n})};if(s){if(s.created)return s.promise.then(u=>(r=i?r:!!u?.isFilterActive(),this.destroyBean(u),a(),r));a()}return Nt.resolve(r)}filterChangedCallbackFactory(e){return t=>{this.callOnFilterChangedOutsideRenderCycle({additionalEventAttributes:t,columns:[e],column:e,source:t?.source??"columnFilter"})}}filterParamsChanged(e,t="api"){const r=this.allColumnFilters.get(e);if(!r)return;const n=this.beans,i=r.column,s=i.getColDef(),o=i.isFilterAllowed(),a=this.getDefaultFilter(i),u=n.selectableFilter,d=u?.isSelectable(s)?u.getFilterDef(i,s):s,h=o?this.createHandlerFunc(i,d,this.getDefaultFilter(i)):void 0,g=!!h,m=r.isHandler;if(m!=g){this.destroyFilter(i,"paramsUpdated");return}const{compDetails:v,createFilterUi:w}=(o?this.createFilterComp(i,d,a,b=>b,g,"colDef"):null)??{compDetails:null,createFilterUi:null},C=v?.params??sy(n.userCompFactory,d,this.createFilterCompParams(i,g,"colDef"));if(m){const b=h?.handlerNameOrCallback??h?.filterHandler,x=on(this.model,e);if(r.handlerGenerator!=b){const R=r.handler,{handler:E,handlerParams:A}=this.createHandlerFromFunc(i,h.filterHandler,C);r.handler=E,r.handlerParams=A,r.handlerGenerator=b,delete this.model[e],E.init?.({...A,source:"init",model:null}),this.destroyBean(R),x!=null&&this.beans.filterManager?.onFilterChanged({columns:[i],source:t})}else{const R=this.createHandlerParams(i,v?.params);r.handlerParams=R,r.handler.refresh?.({...R,source:"colDef",model:x})}}if(this.areFilterCompsDifferent(r.filterUi?.compDetails??null,v)||!r.filterUi||!v){this.destroyFilterUi(r,i,v,w);return}r.filterUi.filterParams=C,Ma(r,m)?.then(b=>{(b?.refresh?b.refresh(C):!0)===!1?this.destroyFilterUi(r,i,v,w):this.dispatchLocalEvent({type:"filterParamsChanged",column:i,params:C})})}refreshHandlerAndUi(e,t,r,n,i){const s=this.cachedFilter(e);if(!s)return n&&this.getOrCreateFilterWrapper(e,!0),Nt.resolve();if(!s.isHandler)return Nt.resolve();const{filterUi:o,handler:a,handlerParams:u}=s;return lU(()=>{if(o){const{created:d,filterParams:h}=o;if(d)return o.promise.then(g=>g?{filter:g,filterParams:h}:void 0);o.refreshed=!0}return Nt.resolve(void 0)},a,u,t,this.state.get(e.getColId())??{model:t},r,i)}setColumnFilterWrapper(e,t){const r=e.getColId();this.allColumnFilters.set(r,t),this.allColumnListeners.set(r,this.addManagedListeners(e,{colDefChanged:()=>this.filterParamsChanged(r)})[0])}areFilterCompsDifferent(e,t){if(!t||!e)return!0;const{componentClass:r}=e,{componentClass:n}=t;return!(r===n||r?.render&&n?.render&&r.render===n.render)}hasFloatingFilters(){return this.beans.colModel.getCols().some(t=>t.getColDef().floatingFilter)}getFilterInstance(e){const t=this.beans.colModel.getColDefCol(e);if(!t)return Promise.resolve(void 0);const r=this.getOrCreateFilterUi(t);return r?new Promise(n=>{r.then(i=>{n(hf(i))})}):Promise.resolve(null)}processFilterModelUpdateQueue(){this.modelUpdates.forEach(({model:e,source:t})=>this.setModel(e,t)),this.modelUpdates=[],this.columnModelUpdates.forEach(({key:e,model:t,resolve:r})=>{this.setModelForColumn(e,t).then(()=>r())}),this.columnModelUpdates=[]}getModelForColumn(e,t){if(t){const{state:n,model:i}=this,s=e.getColId(),o=n.get(s);return o?o.model??null:on(i,s)}const r=this.cachedFilter(e);return r?this.getModelFromFilterWrapper(r):null}setModelForColumn(e,t){if(this.beans.dataTypeSvc?.isPendingInference){let r=()=>{};const n=new Promise(i=>{r=i});return this.columnModelUpdates.push({key:e,model:t,resolve:r}),n}return new Promise(r=>{this.setModelForColumnLegacy(e,t).then(n=>r(n))})}getStateForColumn(e){return this.state.get(e)??{model:on(this.model,e)}}setModelForColumnLegacy(e,t){const r=this.beans.colModel.getColDefCol(e),n=r?this.getOrCreateFilterWrapper(r,!0):null;return n?this.setModelOnFilterWrapper(n,t):Nt.resolve()}setColDefPropsForDataType(e,t,r){const n=e.filter,i=n===!0?this.getDefaultFilterFromDataType(()=>t.baseDataType):n;if(typeof i!="string")return;let s,o;const a=this.beans,{filterParams:u,filterValueGetter:d}=e;i==="agMultiColumnFilter"?{filterParams:s,filterValueGetter:o}=a.multiFilter?.getParamsForDataType(u,d,t,r)??{}:{filterParams:s,filterValueGetter:o}=mU(i,u,d,t,r,a,this.getLocaleTextFunc()),e.filterParams=s,o&&(e.filterValueGetter=o)}setColFilterActive(e,t,r,n){e.filterActive!==t&&(e.filterActive=t,e.dispatchColEvent("filterActiveChanged",r)),e.dispatchColEvent("filterChanged",r,n)}setModelOnFilterWrapper(e,t,r){return new Nt(n=>{if(e.isHandler){const s=e.column,o=s.getColId(),a=this.model[o];if(this.updateStoredModel(o,t),r&&t===a){n();return}this.refreshHandlerAndUi(s,t,"api").then(()=>n());return}const i=Ma(e);if(i){i.then(s=>{if(typeof s?.setModel!="function"){Me(65),n();return}(s.setModel(t)||Nt.resolve()).then(()=>n())});return}n()})}updateStoredModel(e,t){$e(t)?this.model[e]=t:delete this.model[e];const r=this.state.get(e),n={model:t,state:r?.state};this.state.set(e,n)}filterModified(e,t){this.getOrCreateFilterUi(e)?.then(r=>{this.eventSvc.dispatchEvent({type:"filterModified",column:e,filterInstance:r,...t})})}filterUiChanged(e,t){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent({type:"filterUiChanged",column:e,...t})}floatingFilterUiChanged(e,t){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent({type:"floatingFilterUiChanged",column:e,...t})}updateModel(e,t,r){const n=e.getColId(),i=this.cachedFilter(e),s=()=>i?.filterUi;aD(t,s,()=>on(this.model,n),()=>this.state.get(n),o=>this.updateState(e,o),o=>s()?.filterParams?.onModelChange(o,r),i?.isHandler?i.handler.processModelToApply?.bind(i.handler):void 0)}updateAllModels(e,t){const r=[];this.allColumnFilters.forEach((n,i)=>{const s=this.beans.colModel.getColDefCol(i);s&&aD(e,()=>n.filterUi,()=>on(this.model,i),()=>this.state.get(i),o=>this.updateState(s,o),o=>{this.updateStoredModel(i,o),this.dispatchLocalEvent({type:"filterAction",column:s,action:e}),r.push(this.refreshHandlerAndUi(s,o,"ui"))},n?.isHandler?n.handler.processModelToApply?.bind(n.handler):void 0)}),r.length&&Nt.all(r).then(()=>{this.callOnFilterChangedOutsideRenderCycle({source:"columnFilter",additionalEventAttributes:t,columns:[]})})}updateOrRefreshFilterUi(e){const t=e.getColId();q_(()=>this.cachedFilter(e)?.filterUi,()=>on(this.model,t),()=>this.state.get(t))}updateState(e,t){this.state.set(e.getColId(),t),this.dispatchLocalEvent({type:"filterStateChanged",column:e,state:t})}canApplyAll(){const{state:e,model:t,activeFilterComps:r}=this;for(const i of r)if(i.source==="COLUMN_MENU")return!1;let n=!1;for(const i of e.keys()){const s=e.get(i);if(s.valid===!1)return!1;(s.model??null)!==on(t,i)&&(n=!0)}return n}hasUnappliedModel(e){const{model:t,state:r}=this;return(r.get(e)?.model??null)!==on(t,e)}setGlobalButtons(e){this.isGlobalButtons=e,this.dispatchLocalEvent({type:"filterGlobalButtons",isGlobal:e})}shouldKeepStateOnDetach(e,t){if(t==="newFiltersToolPanel")return!0;const r=this.beans.filterPanelSvc;return r?.isActive?!!r.getState(e.getColId()):!1}destroy(){super.destroy(),this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"gridDestroyed")),this.allColumnListeners.clear(),this.state.clear(),this.activeFilterComps.clear()}};function uZ(e){return!!e.filterManager?.isAnyFilterPresent()}function dZ(e,t="api"){e.filterManager?.onFilterChanged({source:t})}var hZ=class extends Ee{constructor(){super(...arguments),this.beanName="filterManager",this.advFilterModelUpdateQueue=[]}wireBeans(e){this.quickFilter=e.quickFilter,this.advancedFilter=e.advancedFilter,this.colFilter=e.colFilter}postConstruct(){const e=this.refreshFiltersForAggregations.bind(this),t=this.updateAdvFilterColumns.bind(this);this.addManagedEventListeners({columnValueChanged:e,columnPivotChanged:e,columnPivotModeChanged:e,newColumnsLoaded:t,columnVisible:t,advancedFilterEnabledChanged:({enabled:n})=>this.onAdvFilterEnabledChanged(n),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.quickFilter&&this.addManagedListeners(this.quickFilter,{quickFilterChanged:()=>this.onFilterChanged({source:"quickFilter"})});const{gos:r}=this;this.alwaysPassFilter=r.get("alwaysPassFilter"),this.addManagedPropertyListener("alwaysPassFilter",()=>{this.alwaysPassFilter=r.get("alwaysPassFilter"),this.onFilterChanged({source:"api"})})}isExternalFilterPresentCallback(){const e=this.gos.getCallback("isExternalFilterPresent");return typeof e=="function"&&e({})}doesExternalFilterPass(e){const t=this.gos.get("doesExternalFilterPass");return typeof t=="function"&&t(e)}setFilterState(e,t,r="api"){this.isAdvFilterEnabled()||this.colFilter?.setState(e,t,r)}setFilterModel(e,t="api",r){if(this.isAdvFilterEnabled()){r||this.warnAdvFilters();return}this.colFilter?.setModel(e,t)}getFilterModel(){return this.colFilter?.getModel()??{}}getFilterState(){return this.colFilter?.getState()}isColumnFilterPresent(){return!!this.colFilter?.isFilterPresent()}isAggregateFilterPresent(){return!!this.colFilter?.isAggFilterPresent()}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.externalFilterPresent||this.isAdvFilterPresent()}isAnyFilterPresent(){return this.isChildFilterPresent()||this.isAggregateFilterPresent()}isAdvFilterPresent(){return this.isAdvFilterEnabled()&&this.advancedFilter.isFilterPresent()}onAdvFilterEnabledChanged(e){e?this.colFilter?.disableFilters()&&this.onFilterChanged({source:"advancedFilter"}):this.advancedFilter?.isFilterPresent()&&(this.advancedFilter.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvFilterEnabled(){return!!this.advancedFilter?.isEnabled()}isAdvFilterHeaderActive(){return this.isAdvFilterEnabled()&&this.advancedFilter.isHeaderActive()}refreshFiltersForAggregations(){xb(this.gos)&&this.isAnyFilterPresent()&&this.onFilterChanged()}onFilterChanged(e={}){const{source:t,additionalEventAttributes:r,columns:n=[]}=e;this.externalFilterPresent=this.isExternalFilterPresentCallback(),(this.colFilter?this.colFilter.updateBeforeFilterChanged(e):Nt.resolve()).then(()=>{const i={source:t,type:"filterChanged",columns:n};r&&Wn(i,r),this.eventSvc.dispatchEvent(i),this.colFilter?.updateAfterFilterChanged()})}isSuppressFlashingCellsBecauseFiltering(){return!!this.colFilter?.isSuppressFlashingCellsBecauseFiltering()}isQuickFilterPresent(){return!!this.quickFilter?.isFilterPresent()}updateAggFiltering(){this.aggFiltering=!!xb(this.gos)}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.beans.colModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,colIdToSkip:e})}doesRowPassAggregateFilters(e){const{rowNode:t}=e;return this.alwaysPassFilter?.(t)?!0:!(this.isAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.isAggregateFilterPresent()&&!this.colFilter.doFiltersPass(t,e.colIdToSkip,!0))}doesRowPassFilter(e){const{rowNode:t}=e;return this.alwaysPassFilter?.(t)?!0:!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.externalFilterPresent&&!this.doesExternalFilterPass(t)||this.isColumnFilterPresent()&&!this.colFilter.doFiltersPass(t,e.colIdToSkip)||this.isAdvFilterPresent()&&!this.advancedFilter.doesFilterPass(t))}isFilterAllowed(e){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.isFilterAllowed(e)}getAdvFilterModel(){return this.isAdvFilterEnabled()?this.advancedFilter.getModel():null}setAdvFilterModel(e,t="api"){if(this.isAdvFilterEnabled()){if(this.beans.dataTypeSvc?.isPendingInference){this.advFilterModelUpdateQueue.push(e);return}this.advancedFilter.setModel(e??null),this.onFilterChanged({source:t})}}toggleAdvFilterBuilder(e,t){this.isAdvFilterEnabled()&&this.advancedFilter.getCtrl().toggleFilterBuilder({source:t,force:e})}updateAdvFilterColumns(){this.isAdvFilterEnabled()&&this.advancedFilter.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.hasFloatingFilters()}getColumnFilterInstance(e){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve(void 0)):this.colFilter?.getFilterInstance(e)??Promise.resolve(void 0)}warnAdvFilters(){Me(68)}setupAdvFilterHeaderComp(e){this.advancedFilter?.getCtrl().setupHeaderComp(e)}getHeaderRowCount(){return this.isAdvFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvFilterHeaderActive()?this.advancedFilter.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){for(const e of this.advFilterModelUpdateQueue)this.setAdvFilterModel(e);this.advFilterModelUpdateQueue=[]}setColumnFilterModel(e,t){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve()):this.colFilter?.setModelForColumn(e,t)??Promise.resolve()}},fZ=class extends Ee{constructor(){super(...arguments),this.beanName="filterMenuFactory"}wireBeans(e){this.popupSvc=e.popupSvc}hideActiveMenu(){this.hidePopup?.()}showMenuAfterMouseEvent(e,t,r,n){e&&!e.isColumn||this.showPopup(e,i=>{this.popupSvc?.positionPopupUnderMouseEvent({column:e,type:r,mouseEvent:t,ePopup:i})},r,t.target,Ri(this.gos),n)}showMenuAfterButtonClick(e,t,r,n){if(e&&!e.isColumn)return;let i=-1,s="left";const o=Ri(this.gos);!o&&this.gos.get("enableRtl")&&(i=1,s="right");const a=o?void 0:4*i,u=o?void 0:4;this.showPopup(e,d=>{this.popupSvc?.positionPopupByComponent({type:r,eventSource:t,ePopup:d,nudgeX:a,nudgeY:u,alignSide:s,keepWithinBounds:!0,position:"under",column:e})},r,t,o,n)}showPopup(e,t,r,n,i,s){const o=e?this.createBean(new gU(e,"COLUMN_MENU")):void 0;if(this.activeMenu=o,!o?.hasFilter()||!e){Zt(57);return}const a=jn({tag:"div",cls:`ag-menu${i?"":" ag-filter-menu"}`,role:"presentation"});[this.tabListener]=this.addManagedElementListeners(a,{keydown:C=>this.trapFocusWithin(C,a)}),a.appendChild(o?.getGui());let u;const d=()=>o?.afterGuiDetached(),h=k7(this.gos)?n??this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody:void 0,g=C=>{pD(e,!1,"contextMenu");const b=C instanceof KeyboardEvent;this.tabListener&&(this.tabListener=this.tabListener()),b&&n&&Qo(n)&&P_(n)?.focus({preventScroll:!0}),d(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,r,e),s?.()},m=this.getLocaleTextFunc(),v=i&&r!=="columnFilter"?m("ariaLabelColumnMenu","Column Menu"):m("ariaLabelColumnFilter","Column Filter"),w=this.popupSvc?.addPopup({modal:!0,eChild:a,closeOnEsc:!0,closedCallback:g,positionCallback:()=>t(a),anchorToElement:h,ariaLabel:v});w&&(this.hidePopup=u=w.hideFunc),o.afterInit().then(()=>{t(a),o.afterGuiAttached({container:r,hidePopup:u})}),pD(e,!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,r,e)}trapFocusWithin(e,t){e.key!==me.TAB||e.defaultPrevented||vc(this.beans,t,!1,e.shiftKey)||(e.preventDefault(),rc(t,e.shiftKey))}dispatchVisibleChangedEvent(e,t,r){this.eventSvc.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:!1,key:t,column:r??null,columnGroup:null})}isMenuEnabled(e){return e.isFilterAllowed()&&(e.getColDef().menuTabs??["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}},gZ=class extends Ee{constructor(){super(...arguments),this.beanName="filterValueSvc"}getValue(e,t,r){if(!t)return;const n=e.getColDef(),{selectableFilter:i,valueSvc:s}=this.beans,o=r??i?.getFilterValueGetter(e.getColId())??n.filterValueGetter;return o?this.executeFilterValueGetter(o,t.data,e,t,n):s.getValue(e,t)}executeFilterValueGetter(e,t,r,n,i){const{expressionSvc:s,valueSvc:o}=this.beans,a=it(this.gos,{data:t,node:n,column:r,colDef:i,getValue:o.getValueCallback.bind(o,n)});return typeof e=="function"?e(a):s?.evaluate(e,a)}},pZ={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eFloatingFilterText"}]},mZ=class extends Dr{constructor(){super(pZ,[Ym]),this.eFloatingFilterText=tt}init(e){this.params=e;const t=this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0);if(this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`),this.gos.get("enableFilterHandlers")){const r=e,n=r.getHandler();if(n.getModelAsString){const i=n.getModelAsString(r.model);this.eFloatingFilterText.setValue(i)}}}onParentModelChanged(e){if(e==null){this.eFloatingFilterText.setValue("");return}this.params.parentFilterInstance(t=>{if(t.getModelAsString){const r=t.getModelAsString(e);this.eFloatingFilterText.setValue(r)}})}refresh(e){this.init(e)}},Ix=class{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions??t,this.mapCustomOptions(),this.defaultOption=this.getDefaultItem(e.defaultOption)}refresh(e,t){const r=e.filterOptions??t;this.filterOptions!==r&&(this.filterOptions=r,this.customFilterOptions={},this.mapCustomOptions()),this.defaultOption=this.getDefaultItem(e.defaultOption)}mapCustomOptions(){const{filterOptions:e}=this;if(e)for(const t of e){if(typeof t=="string")continue;const r=[["displayKey"],["displayName"],["predicate","test"]],n=i=>i.some(s=>t[s]!=null)?!0:(Me(72,{keys:i}),!1);if(!r.every(n)){this.filterOptions=e.filter(i=>i===t)||[];continue}this.customFilterOptions[t.displayKey]=t}}getDefaultItem(e){const{filterOptions:t}=this;if(e)return e;if(t.length>=1){const r=t[0];if(typeof r=="string")return r;if(r.displayKey)return r.displayKey;Me(73)}else Me(74)}getCustomOption(e){return this.customFilterOptions[e]}};function Wh(e,t,r){return r==null?e.splice(t):e.splice(t,r)}function $0(e){return e==null||typeof e=="string"&&e.trim().length===0}function vZ(e){return e==="AND"||e==="OR"?e:"AND"}function wZ(e,t,r){if(e==null)return;const{predicate:n}=e;if(n!=null&&!t.some(i=>i==null))return n(t,r)}function CZ(e,t){let r=e.length;return r>t&&(e.splice(t),Me(78),r=t),r}function mf(e,t){const r=t.getCustomOption(e);if(r){const{numberOfInputs:i}=r;return i??1}return e&&["empty","notBlank","blank"].indexOf(e)>=0?0:e==="inRange"?2:1}var Ox=class extends xU{constructor(e,t,r){super(e,"simple-filter"),this.mapValuesFromModel=t,this.defaultOptions=r,this.eTypes=[],this.eJoinPanels=[],this.eJoinAnds=[],this.eJoinOrs=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}setParams(e){super.setParams(e);const t=new Ix;this.optionsFactory=t,t.init(e,this.defaultOptions),this.commonUpdateSimpleParams(e),this.createOption(),this.createMissingConditionsAndOperators()}updateParams(e,t){this.optionsFactory.refresh(e,this.defaultOptions),super.updateParams(e,t),this.commonUpdateSimpleParams(e)}commonUpdateSimpleParams(e){this.setNumConditions(e),this.defaultJoinOperator=vZ(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.createFilterListOptions();const t=this.getGui();this.isReadOnly()?t.setAttribute("tabindex","-1"):t.removeAttribute("tabindex")}onFloatingFilterChanged(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged("immediately",!0)}setTypeFromFloatingFilter(e){this.eTypes.forEach((t,r)=>{const n=r===0?e:this.optionsFactory.defaultOption;t.setValue(n,!0)})}getModelFromUi(){const e=this.getUiCompleteConditions();return e.length===0?null:this.maxNumConditions>1&&e.length>1?{filterType:this.filterType,operator:this.getJoinOperator(),conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map(e=>e.getValue())}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){const{eJoinOrs:e,defaultJoinOperator:t}=this;return e.length===0?t:e[0].getValue()===!0?"OR":"AND"}areNonNullModelsEqual(e,t){const r=!e.operator,n=!t.operator;if(!r&&n||r&&!n)return!1;let s;if(r){const o=e,a=t;s=this.areSimpleModelsEqual(o,a)}else{const o=e,a=t;s=o.operator===a.operator&&tl(o.conditions,a.conditions,(u,d)=>this.areSimpleModelsEqual(u,d))}return s}setModelIntoUi(e,t){if(e==null)return this.resetUiToDefaults(t),Nt.resolve();if(e.operator){const n=e;let i=n.conditions;i==null&&(i=[],Me(77));const s=CZ(i,this.maxNumConditions),o=this.getNumConditions();if(s<o)this.removeConditionsAndOperators(s);else if(s>o)for(let u=o;u<s;u++)this.createJoinOperatorPanel(),this.createOption();const a=n.operator==="OR";this.eJoinAnds.forEach(u=>u.setValue(!a,!0)),this.eJoinOrs.forEach(u=>u.setValue(a,!0)),i.forEach((u,d)=>{this.eTypes[d].setValue(u.type,!0),this.setConditionIntoUi(u,d)})}else{const n=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(n.type,!0),this.setConditionIntoUi(n,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.updateUiVisibility(),t||this.params.onUiChange(this.getUiChangeEventParams()),Nt.resolve()}setNumConditions(e){let t=e.maxNumConditions??2;t<1&&(Me(79),t=1),this.maxNumConditions=t;let r=e.numAlwaysVisibleConditions??1;r<1&&(Me(80),r=1),r>t&&(Me(81),r=t),this.numAlwaysVisibleConditions=r}createOption(){const e=this.getGui(),t=this.createManagedBean(new vx);this.eTypes.push(t),t.addCss("ag-filter-select"),e.appendChild(t.getGui());const r=this.createEValue();this.eConditionBodies.push(r),e.appendChild(r),this.putOptionsIntoDropdown(t),this.resetType(t);const n=this.getNumConditions()-1;this.forEachPositionInput(n,i=>this.resetInput(i)),this.addChangedListeners(t,n)}createJoinOperatorPanel(){const e=jn({tag:"div",cls:"ag-filter-condition"});this.eJoinPanels.push(e);const t=this.createJoinOperator(this.eJoinAnds,e,"and"),r=this.createJoinOperator(this.eJoinOrs,e,"or");this.getGui().appendChild(e);const n=this.eJoinPanels.length-1,i=this.joinOperatorId++;this.resetJoinOperatorAnd(t,n,i),this.resetJoinOperatorOr(r,n,i),this.isReadOnly()||(t.onValueChange(this.listener),r.onValueChange(this.listener))}createJoinOperator(e,t,r){const n=this.createManagedBean(new e9);e.push(n);const i="ag-filter-condition-operator";return n.addCss(i),n.addCss(`${i}-${r}`),t.appendChild(n.getGui()),n}createFilterListOptions(){this.filterListOptions=this.optionsFactory.filterOptions.map(e=>typeof e=="string"?this.createBoilerplateListOption(e):this.createCustomListOption(e))}putOptionsIntoDropdown(e){const{filterListOptions:t}=this;for(const r of t)e.addOption(r);e.setDisabled(t.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){const{displayKey:t}=e,r=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:r?this.getLocaleTextFunc()(r.displayKey,r.displayName):this.translate(t)}}createBodyTemplate(){return null}getAgComponents(){return[]}updateUiVisibility(){const e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){let e=-1,t=!0;for(let r=0;r<this.getNumConditions();r++)this.isConditionUiComplete(r)?e=r:t=!1;if(this.shouldAddNewConditionAtEnd(t))this.createJoinOperatorPanel(),this.createOption();else{const r=this.lastUiCompletePosition??this.getNumConditions()-2;if(e<r){this.removeConditionsAndOperators(r+1);const n=e+1,i=r-n;i>0&&this.removeConditionsAndOperators(n,i),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=e}updateConditionStatusesAndValues(e,t){this.eTypes.forEach((n,i)=>{const s=this.isConditionDisabled(i,e);n.setDisabled(s||this.filterListOptions.length<=1),i===1&&(af(this.eJoinPanels[0],s),this.eJoinAnds[0].setDisabled(s),this.eJoinOrs[0].setDisabled(s))}),this.eConditionBodies.forEach((n,i)=>{Er(n,this.isConditionBodyVisible(i))});const r=(t??this.getJoinOperator())==="OR";for(const n of this.eJoinAnds)n.setValue(!r,!0);for(const n of this.eJoinOrs)n.setValue(r,!0);this.forEachInput((n,i,s,o)=>{this.setElementDisplayed(n,i<o),this.setElementDisabled(n,this.isConditionDisabled(s,e))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,t){if(e>=this.getNumConditions())return;const{eTypes:r,eConditionBodies:n,eJoinPanels:i,eJoinAnds:s,eJoinOrs:o}=this;this.removeComponents(r,e,t),this.removeElements(n,e,t),this.removeEValues(e,t);const a=Math.max(e-1,0);this.removeElements(i,a,t),this.removeComponents(s,a,t),this.removeComponents(o,a,t)}removeElements(e,t,r){const n=Wh(e,t,r);for(const i of n)Ua(i)}removeComponents(e,t,r){const n=Wh(e,t,r);for(const i of n)Ua(i.getGui()),this.destroyBean(i)}afterGuiAttached(e){if(super.afterGuiAttached(e),this.resetPlaceholder(),!e?.suppressFocus){let t;if(!this.isReadOnly()){const r=this.getInputs(0)[0];r instanceof Il&&this.isConditionBodyVisible(0)?t=r.getInputElement():t=this.eTypes[0]?.getFocusableElement()}(t??this.getGui()).focus({preventScroll:!0})}}afterGuiDetached(){super.afterGuiDetached();const e=this.params;if(this.beans.colFilter?.shouldKeepStateOnDetach(e.column))return;e.onStateChange({model:e.model});let t=-1,r=-1,n=!1;const i=this.getJoinOperator();for(let o=this.getNumConditions()-1;o>=0;o--)if(this.isConditionUiComplete(o))t===-1&&(t=o,r=o);else{const a=o>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(o-1),u=o<t;(a||u)&&(this.removeConditionsAndOperators(o,1),n=!0,u&&r--)}let s=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),s=!0),this.shouldAddNewConditionAtEnd(r===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),s=!0),s&&this.updateConditionStatusesAndValues(r,i),n&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=r}getModelAsString(e){return this.params.getHandler()?.getModelAsString?.(e)??""}getPlaceholderText(e,t){let r=this.translate(e);if(typeof this.filterPlaceholder=="function"){const n=this.eTypes[t].getValue(),i=this.translate(n);r=this.filterPlaceholder({filterOptionKey:n,filterOption:i,placeholder:r})}else typeof this.filterPlaceholder=="string"&&(r=this.filterPlaceholder);return r}resetPlaceholder(){const e=this.getLocaleTextFunc();this.forEachInput((t,r,n,i)=>{if(!(t instanceof Il))return;const s=r===0&&i>1?"inRangeStart":r===0?"filterOoo":"inRangeEnd",o=r===0&&i>1?e("ariaFilterFromValue","Filter from value"):r===0?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value");t.setInputPlaceholder(this.getPlaceholderText(s,n)),t.setInputAriaLabel(o)})}setElementValue(e,t,r){e instanceof Il&&e.setValue(t!=null?String(t):null,!0)}setElementDisplayed(e,t){XF(e)&&Er(e.getGui(),t)}setElementDisabled(e,t){XF(e)&&af(e.getGui(),t)}attachElementOnChange(e,t){e instanceof Il&&e.onValueChange(t)}forEachInput(e){this.getConditionTypes().forEach((t,r)=>{this.forEachPositionTypeInput(r,t,e)})}forEachPositionInput(e,t){const r=this.getConditionType(e);this.forEachPositionTypeInput(e,r,t)}forEachPositionTypeInput(e,t,r){const n=mf(t,this.optionsFactory),i=this.getInputs(e);for(let s=0;s<i.length;s++){const o=i[s];o!=null&&r(o,s,e,n)}}isConditionDisabled(e,t){return this.isReadOnly()?!0:e===0?!1:e>t+1}isConditionBodyVisible(e){const t=this.getConditionType(e);return mf(t,this.optionsFactory)>0}isConditionUiComplete(e){return!(e>=this.getNumConditions()||this.getConditionType(e)==="empty"||this.getValues(e).some(r=>r==null))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){const e=[];for(let t=0;t<this.getNumConditions();t++)this.isConditionUiComplete(t)&&e.push(this.createCondition(t));return e}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(t=>this.resetType(t)),this.eJoinAnds.forEach((t,r)=>this.resetJoinOperatorAnd(t,r,this.joinOperatorId+r)),this.eJoinOrs.forEach((t,r)=>this.resetJoinOperatorOr(t,r,this.joinOperatorId+r)),this.joinOperatorId++,this.forEachInput(t=>this.resetInput(t)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,this.updateUiVisibility(),e||this.params.onUiChange(this.getUiChangeEventParams())}resetType(e){const r=this.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.defaultOption,!0).setAriaLabel(r).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,t,r){this.resetJoinOperator(e,t,this.defaultJoinOperator==="AND",this.translate("andCondition"),r)}resetJoinOperatorOr(e,t,r){this.resetJoinOperator(e,t,this.defaultJoinOperator==="OR",this.translate("orCondition"),r)}resetJoinOperator(e,t,r,n,i){this.updateJoinOperatorDisabled(e.setValue(r,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${i}`).setLabel(n),t)}updateJoinOperatorsDisabled(){const e=(t,r)=>this.updateJoinOperatorDisabled(t,r);this.eJoinAnds.forEach(e),this.eJoinOrs.forEach(e)}updateJoinOperatorDisabled(e,t){e.setDisabled(this.isReadOnly()||t>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,t){const r=this.mapValuesFromModel(e,this.optionsFactory);this.forEachInput((n,i,s)=>{s===t&&this.setElementValue(n,r[i]!=null?r[i]:null)})}setValueFromFloatingFilter(e){this.forEachInput((t,r,n)=>{this.setElementValue(t,r===0&&n===0?e:null,!0)})}addChangedListeners(e,t){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,r=>{this.attachElementOnChange(r,this.listener)}))}hasInvalidInputs(){return!1}isReadOnly(){return!!this.params.readOnly}},YL=class{constructor(e,t,r,n,i,s){this.alive=!0,this.context=e,this.eParent=i;const o=IW(t,r,n);o&&o.newAgStackInstance().then(a=>{if(!this.alive){e.destroyBean(a);return}if(this.dateComp=a,!a)return;i.appendChild(a.getGui()),a?.afterGuiAttached?.();const{tempValue:u,disabled:d}=this;u&&a.setDate(u),d!=null&&a.setDisabled?.(d),s?.(this)})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){const t=this.dateComp;t?t.setDate(e):this.tempValue=e}setDisabled(e){const t=this.dateComp;t?t.setDisabled?.(e):this.disabled=e}setDisplayed(e){Er(this.eParent,e)}setInputPlaceholder(e){this.dateComp?.setInputPlaceholder?.(e)}setInputAriaLabel(e){this.dateComp?.setInputAriaLabel?.(e)}afterGuiAttached(e){this.dateComp?.afterGuiAttached?.(e)}updateParams(e){this.dateComp?.refresh?.(e)}},Nx=["equals","notEqual","lessThan","greaterThan","inRange","blank","notBlank"];function KL(e,t){const{dateFrom:r,dateTo:n,type:i}=e||{};return[r&&ui(r,void 0,!0)||null,n&&ui(n,void 0,!0)||null].slice(0,mf(i,t))}var XD=1e3,QD=1/0,yZ=class extends Ox{constructor(){super("dateFilter",KL,Nx),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=XD,this.maxValidYear=QD,this.minValidDate=null,this.maxValidDate=null,this.filterType="date"}afterGuiAttached(e){super.afterGuiAttached(e),this.dateConditionFromComps[0].afterGuiAttached(e)}commonUpdateSimpleParams(e){super.commonUpdateSimpleParams(e);const t=(u,d)=>{const h=e[u];if(h!=null)if(isNaN(h))Me(82,{param:u});else return h==null?d:Number(h);return d},r=t("minValidYear",XD),n=t("maxValidYear",QD);this.minValidYear=r,this.maxValidYear=n,r>n&&Me(83);const{minValidDate:i,maxValidDate:s}=e,o=i instanceof Date?i:ui(i);this.minValidDate=o;const a=s instanceof Date?s:ui(s);this.maxValidDate=a,o&&a&&o>a&&Me(84)}createDateCompWrapper(e){const{beans:{userCompFactory:t,context:r,gos:n},params:i}=this,s=new YL(r,t,i.colDef,it(n,{onDateChanged:()=>this.onUiChanged(),filterParams:i,location:"filter"}),e);return this.addDestroyFunc(()=>s.destroy()),s}setElementValue(e,t){e.setDate(t)}setElementDisplayed(e,t){e.setDisplayed(t)}setElementDisabled(e,t){e.setDisabled(t)}createEValue(){const e=jn({tag:"div",cls:"ag-filter-body"});return this.createFromToElement(e,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(e,this.eConditionPanelsTo,this.dateConditionToComps,"to"),e}createFromToElement(e,t,r,n){const i=jn({tag:"div",cls:`ag-filter-${n} ag-filter-date-${n}`});t.push(i),e.appendChild(i),r.push(this.createDateCompWrapper(i))}removeEValues(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),Wh(this.eConditionPanelsFrom,e,t),Wh(this.eConditionPanelsTo,e,t)}removeDateComps(e,t,r){const n=Wh(e,t,r);for(const i of n)i.destroy()}isValidDateValue(e){if(e===null)return!1;const{minValidDate:t,maxValidDate:r,minValidYear:n,maxValidYear:i}=this;if(t){if(e<t)return!1}else if(e.getUTCFullYear()<n)return!1;if(r){if(e>r)return!1}else if(e.getUTCFullYear()>i)return!1;return!0}isConditionUiComplete(e){if(!super.isConditionUiComplete(e))return!1;let t=!0;return this.forEachInput((r,n,i,s)=>{i!==e||!t||n>=s||(t=t&&this.isValidDateValue(r.getDate()))}),t}areSimpleModelsEqual(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type}createCondition(e){const t=this.getConditionType(e),r={},n=this.getValues(e),i=this.params.useIsoSeparator?"T":" ";return n.length>0&&(r.dateFrom=Fi(n[0],!0,i)),n.length>1&&(r.dateTo=Fi(n[1],!0,i)),{dateFrom:null,dateTo:null,filterType:this.filterType,type:t,...r}}resetPlaceholder(){const e=this.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),r=e("ariaFilterValue","Filter Value");this.forEachInput(n=>{n.setInputPlaceholder(t),n.setInputAriaLabel(r)})}getInputs(e){const{dateConditionFromComps:t,dateConditionToComps:r}=this;return e>=t.length?[null,null]:[t[e],r[e]]}getValues(e){const t=[];return this.forEachPositionInput(e,(r,n,i,s)=>{n<s&&t.push(r.getDate())}),t}translate(e){return e==="lessThan"?super.translate("before"):e==="greaterThan"?super.translate("after"):super.translate(e)}},qL=class extends Ee{constructor(e,t){super(),this.mapValuesFromModel=e,this.defaultOptions=t}init(e){const t=e.filterParams,r=new Ix;this.optionsFactory=r,r.init(t,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(r,t)),this.updateParams(e),this.validateModel(e)}refresh(e){if(e.source==="colDef"){const t=e.filterParams,r=this.optionsFactory;r.refresh(t,this.defaultOptions),this.filterModelFormatter.updateParams({optionsFactory:r,filterParams:t}),this.updateParams(e)}this.validateModel(e)}updateParams(e){this.params=e}doesFilterPass(e){const t=e.model;if(t==null)return!0;const{operator:r}=t,n=[];if(r){const o=t;n.push(...o.conditions??[])}else n.push(t);const i=r&&r==="OR"?"some":"every",s=this.params.getValue(e.node);return n[i](o=>this.individualConditionPasses(e,o,s))}getModelAsString(e,t){return this.filterModelFormatter.getModelAsString(e,t)??""}validateModel(e){const{model:t,filterParams:{filterOptions:r,maxNumConditions:n}}=e;if(t==null)return;let s=Z_(t)?t.conditions:[t];const o=r?.map(h=>typeof h=="string"?h:h.displayKey)??this.defaultOptions;if(!(!s||s.every(h=>o.find(g=>g===h.type)!==void 0))){this.params={...e,model:null},e.onModelChange(null);return}let u=!1;const d=this.filterType;if((s&&!s.every(h=>h.filterType===d)||t.filterType!==d)&&(s=s.map(h=>({...h,filterType:d})),u=!0),typeof n=="number"&&s&&s.length>n&&(s=s.slice(0,n),u=!0),u){const h=s.length>1?{...t,filterType:d,conditions:s}:{...s[0],filterType:d};this.params={...e,model:h},e.onModelChange(h)}}individualConditionPasses(e,t,r){const n=this.optionsFactory,i=this.mapValuesFromModel(t,n),s=n.getCustomOption(t.type),o=wZ(s,i,r);return o??(r==null?this.evaluateNullValue(t.type):this.evaluateNonNullValue(i,r,t,e))}},XL=class extends qL{evaluateNullValue(e){const{includeBlanksInEquals:t,includeBlanksInNotEqual:r,includeBlanksInGreaterThan:n,includeBlanksInLessThan:i,includeBlanksInRange:s}=this.params.filterParams;switch(e){case"equals":if(t)return!0;break;case"notEqual":if(r)return!0;break;case"greaterThan":case"greaterThanOrEqual":if(n)return!0;break;case"lessThan":case"lessThanOrEqual":if(i)return!0;break;case"inRange":if(s)return!0;break;case"blank":return!0;case"notBlank":return!1}return!1}evaluateNonNullValue(e,t,r){const n=r.type;if(!this.isValid(t))return n==="notEqual"||n==="notBlank";const i=this.comparator(),s=e[0]!=null?i(e[0],t):0;switch(n){case"equals":return s===0;case"notEqual":return s!==0;case"greaterThan":return s>0;case"greaterThanOrEqual":return s>=0;case"lessThan":return s<0;case"lessThanOrEqual":return s<=0;case"inRange":{const o=i(e[1],t);return this.params.filterParams.inRangeInclusive?s>=0&&o<=0:s>0&&o<0}case"blank":return $0(t);case"notBlank":return!$0(t);default:return Me(76,{filterModelType:n}),!0}}},QL={equals:"Equals",notEqual:"NotEqual",greaterThan:"GreaterThan",greaterThanOrEqual:"GreaterThanOrEqual",lessThan:"LessThan",lessThanOrEqual:"LessThanOrEqual",inRange:"InRange"},bZ={contains:"Contains",notContains:"NotContains",equals:"TextEquals",notEqual:"TextNotEqual",startsWith:"StartsWith",endsWith:"EndsWith",inRange:"InRange"},Bx=class extends Ee{constructor(e,t,r){super(),this.optionsFactory=e,this.filterParams=t,this.valueFormatter=r}getModelAsString(e,t){const r=this.getLocaleTextFunc(),n=t==="filterToolPanel";if(!e)return n?Ba(this,"filterSummaryInactive"):null;if(e.operator!=null){const s=e,a=(s.conditions??[]).map(d=>this.getModelAsString(d,t)),u=s.operator==="AND"?"andCondition":"orCondition";return a.join(` ${Ba(this,u)} `)}else{if(e.type==="blank"||e.type==="notBlank")return n?Ba(this,e.type==="blank"?"filterSummaryBlank":"filterSummaryNotBlank"):r(e.type,e.type);{const s=e,o=this.optionsFactory.getCustomOption(s.type),{displayKey:a,displayName:u,numberOfInputs:d}=o||{};return a&&u&&d===0?r(a,u):this.conditionToString(s,n,s.type==="inRange"||d===2,a,u)}}}updateParams(e){const{optionsFactory:t,filterParams:r}=e;this.optionsFactory=t,this.filterParams=r}conditionForToolPanel(e,t,r,n,i,s){let o;const a=this.getTypeKey(e);return a&&(o=Ba(this,a)),i&&s&&(o=this.getLocaleTextFunc()(i,s)),o!=null?t?`${o} ${Ba(this,"filterSummaryInRangeValues",[r(),n()])}`:`${o} ${r()}`:null}getTypeKey(e){const t=this.filterTypeKeys[e];return t?`filterSummary${t}`:null}formatValue(e){const t=this.valueFormatter;return t?t(e??null)??"":String(e)}},ZL=class extends Bx{constructor(e,t){super(e,t,r=>{const{dataTypeSvc:n,valueSvc:i}=this.beans,s=t.column,o=n?.getDateFormatterFunction(s),a=o?o(r??void 0):r;return i.formatValue(s,null,a)}),this.filterTypeKeys=QL}conditionToString(e,t,r,n,i){const{type:s}=e,o=ui(e.dateFrom),a=ui(e.dateTo),u=this.filterParams.inRangeFloatingFilterDateFormat,d=t?this.formatValue.bind(this):m=>Ab(m,u),h=()=>o!==null?d(o):"null",g=()=>a!==null?d(a):"null";if(t){const m=this.conditionForToolPanel(s,r,h,g,n,i);if(m!=null)return m}return r?`${h()}-${g()}`:o!=null?d(o):`${s}`}};function SZ(e,t){const r=t;return r<e?-1:r>e?1:0}var xZ=class extends XL{constructor(){super(KL,Nx),this.filterType="date",this.FilterModelFormatterClass=ZL}comparator(){return this.params.filterParams.comparator??SZ}isValid(e){const t=this.params.filterParams.isValidDate;return!t||t(e)}},JL=class extends Dr{constructor(){super(...arguments),this.defaultDebounceMs=0}setLastTypeFromModel(e){if(!e){this.lastType=this.optionsFactory.defaultOption;return}const t=e.operator;let r;t?r=e.conditions[0]:r=e,this.lastType=r.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;const r=e;return this.isTypeEditable(r.type)}init(e){this.params=e;const t=this.gos.get("enableFilterHandlers");if(this.reactive=t,this.setParams(e),t){const r=e;this.onModelUpdated(r.model)}}setParams(e){const t=new Ix;this.optionsFactory=t,t.init(e.filterParams,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(t,e.filterParams)),this.setSimpleParams(e,!1)}setSimpleParams(e,t=!0){const r=this.optionsFactory.defaultOption;t||(this.lastType=r),this.readOnly=!!e.filterParams.readOnly;const n=this.isTypeEditable(r);this.setEditable(n)}refresh(e){this.params=e;const t=e,r=this.reactive;if((!r||t.source==="colDef")&&this.updateParams(e),r){const{source:n,model:i}=t;if(n==="dataChanged"||n==="ui")return;this.onModelUpdated(i)}}updateParams(e){const t=this.optionsFactory;t.refresh(e.filterParams,this.defaultOptions),this.setSimpleParams(e),this.filterModelFormatter.updateParams({optionsFactory:t,filterParams:e.filterParams})}onParentModelChanged(e,t){t?.afterFloatingFilter||t?.afterDataChange||this.onModelUpdated(e)}hasSingleInput(e){const t=this.optionsFactory.getCustomOption(e)?.numberOfInputs;return t==null||t==1}isTypeEditable(e){const t=["inRange","empty","blank","notBlank"];return!!e&&!this.readOnly&&this.hasSingleInput(e)&&t.indexOf(e)<0}getAriaLabel(e){return`${this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0)} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`}},EZ={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eReadOnlyText"},{tag:"div",ref:"eDateWrapper",cls:"ag-date-floating-filter-wrapper"}]},RZ=class extends JL{constructor(){super(EZ,[Ym]),this.eReadOnlyText=tt,this.eDateWrapper=tt,this.FilterModelFormatterClass=ZL,this.filterType="date",this.defaultOptions=Nx}setParams(e){super.setParams(e),this.createDateComponent();const t=this.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input"))}updateParams(e){super.updateParams(e),this.dateComp.updateParams(this.getDateComponentParams()),this.updateCompOnModelChange(e.currentParentModel())}updateCompOnModelChange(e){const t=!this.readOnly&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(t),t){const r=e?ui(e.dateFrom):null;this.dateComp.setDate(r),this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}setEditable(e){Er(this.eDateWrapper,e),Er(this.eReadOnlyText.getGui(),!e)}onModelUpdated(e){super.setLastTypeFromModel(e),this.updateCompOnModelChange(e)}onDateChanged(){const e=this.dateComp.getDate();if(this.reactive){const t=this.params;t.onUiChange();const r=t.model,n=Fi(e),i=n==null?null:{...r??{filterType:this.filterType,type:this.lastType??this.optionsFactory.defaultOption},dateFrom:n};t.onModelChange(i,{afterFloatingFilter:!0})}else this.params.parentFilterInstance(t=>{t?.onFloatingFilterChanged(this.lastType||null,e)})}getDateComponentParams(){const{filterParams:e}=this.params,t=Sx(e,this.defaultDebounceMs);return it(this.gos,{onDateChanged:yn(this,this.onDateChanged.bind(this),t),filterParams:e,location:"floatingFilter"})}createDateComponent(){const{beans:{context:e,userCompFactory:t},eDateWrapper:r,params:n}=this;this.dateComp=new YL(e,t,n.column.getColDef(),this.getDateComponentParams(),r,i=>{i.setInputAriaLabel(this.getAriaLabel(n))}),this.addDestroyFunc(()=>this.dateComp.destroy())}},TZ={tag:"div",cls:"ag-filter-filter",children:[{tag:"ag-input-text-field",ref:"eDateInput",cls:"ag-date-filter"}]},FZ=class extends Dr{constructor(){super(TZ,[Ym]),this.eDateInput=tt,this.isApply=!1,this.applyOnFocusOut=!1}init(e){this.params=e,this.setParams(e);const t=this.eDateInput.getInputElement();this.addManagedListeners(t,{mouseDown:()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||t.focus({preventScroll:!0})},input:this.handleInput.bind(this,!1),change:this.handleInput.bind(this,!0),focusout:this.handleFocusOut.bind(this)})}handleInput(e){if(!this.eDateInput.isDisabled()){if(this.isApply){this.applyOnFocusOut=!e,e&&this.params.onDateChanged();return}e||this.params.onDateChanged()}}handleFocusOut(){this.applyOnFocusOut&&(this.applyOnFocusOut=!1,this.params.onDateChanged())}setParams(e){const t=this.eDateInput.getInputElement(),r=this.shouldUseBrowserDatePicker(e);this.usingSafariDatePicker=r&&rl();const{minValidYear:n,maxValidYear:i,minValidDate:s,maxValidDate:o,buttons:a,includeTime:u,colDef:d}=e.filterParams||{},h=this.beans.dataTypeSvc,g=u??h?.getDateIncludesTimeFlag?.(d.cellDataType)??!1;if(r?g?(t.type="datetime-local",t.step="1"):t.type="date":t.type="text",s&&n&&Me(85),o&&i&&Me(86),s&&o){const[m,v]=[s,o].map(w=>w instanceof Date?w:ui(w));m&&v&&m.getTime()>v.getTime()&&Me(87)}s?s instanceof Date?t.min=Ab(s):t.min=s:n&&(t.min=`${n}-01-01`),o?o instanceof Date?t.max=Ab(o):t.max=o:i&&(t.max=`${i}-12-31`),this.isApply=e.location==="floatingFilter"&&!!a?.includes("apply")}refresh(e){this.params=e,this.setParams(e)}getDate(){return ui(this.eDateInput.getValue())}setDate(e){const t=this.params.filterParams.colDef.cellDataType,r=this.beans.dataTypeSvc?.getDateIncludesTimeFlag(t)??!1;this.eDateInput.setValue(Fi(e,r))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setInputAriaLabel(e){this.eDateInput.setAriaLabel(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){e?.suppressFocus||this.eDateInput.getInputElement().focus({preventScroll:!0})}shouldUseBrowserDatePicker(e){return e?.filterParams?.browserDatePicker??!0}},Hx=["equals","notEqual","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","inRange","blank","notBlank"];function Yb(e){const{allowedCharPattern:t}=e??{};return t??null}function Kb(e){return e==null||isNaN(e)?null:e}function eI(e,t){const{filter:r,filterTo:n,type:i}=e||{};return[Kb(r),Kb(n)].slice(0,mf(i,t))}var DZ=class extends Ox{constructor(){super("numberFilter",eI,Hx),this.eValuesFrom=[],this.eValuesTo=[],this.filterType="number",this.defaultDebounceMs=500}setElementValue(e,t,r){const{numberFormatter:n}=this.params,i=!r&&n?n(t??null):t;super.setElementValue(e,i)}createEValue(){const e=Yb(this.params),t=jn({tag:"div",cls:"ag-filter-body",role:"presentation"});return this.createFromToElement(t,this.eValuesFrom,"from",e),this.createFromToElement(t,this.eValuesTo,"to",e),t}createFromToElement(e,t,r,n){const i=this.createManagedBean(n?new wc({allowedCharPattern:n}):new mx);i.addCss(`ag-filter-${r}`),i.addCss("ag-filter-filter"),t.push(i),e.appendChild(i.getGui())}removeEValues(e,t){const r=n=>this.removeComponents(n,e,t);r(this.eValuesFrom),r(this.eValuesTo)}getValues(e){const t=[];return this.forEachPositionInput(e,(r,n,i,s)=>{n<s&&t.push(Kb(this.stringToFloat(r.getValue())))}),t}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}stringToFloat(e){if(typeof e=="number")return e;let t=Ho(e);t!=null&&t.trim()===""&&(t=null);const r=this.params.numberParser;return r?r(t):t==null||t.trim()==="-"?null:Number.parseFloat(t)}createCondition(e){const t=this.getConditionType(e),r={filterType:this.filterType,type:t},n=this.getValues(e);return n.length>0&&(r.filter=n[0]),n.length>1&&(r.filterTo=n[1]),r}getInputs(e){const{eValuesFrom:t,eValuesTo:r}=this;return e>=t.length?[null,null]:[t[e],r[e]]}hasInvalidInputs(){let e=!1;return this.forEachInput(t=>{t.getInputElement().validity.valid||(e=!0)}),e}},tI=class extends Bx{constructor(e,t){super(e,t,t.numberFormatter),this.filterTypeKeys=QL}conditionToString(e,t,r,n,i){const{filter:s,filterTo:o,type:a}=e,u=this.formatValue.bind(this);if(t){const d=this.conditionForToolPanel(a,r,()=>u(s),()=>u(o),n,i);if(d!=null)return d}return r?`${u(s)}-${u(o)}`:s!=null?u(s):`${a}`}},AZ=class extends XL{constructor(){super(eI,Hx),this.filterType="number",this.FilterModelFormatterClass=tI}comparator(){return(e,t)=>e===t?0:e<t?1:-1}isValid(e){return!isNaN(e)}},rI=class extends Ee{constructor(e){super(),this.params=e,this.eInput=tt,this.onValueChanged=()=>{}}setupGui(e){this.eInput=this.createManagedBean(new wc(this.params?.config));const t=this.eInput.getGui();e.appendChild(t);const r=n=>this.onValueChanged(n);this.addManagedListeners(t,{input:r,keydown:r})}setEditable(e){this.eInput.setDisabled(!e)}getValue(){return this.eInput.getValue()}setValue(e,t){this.eInput.setValue(e,t)}setValueChangedListener(e){this.onValueChanged=e}setParams({ariaLabel:e,autoComplete:t}){const{eInput:r}=this;r.setInputAriaLabel(e),t!==void 0&&r.setAutoComplete(t)}};function qb(e){const t=e?.trim();return t===""?e:t}function nI(e,t){const{filter:r,filterTo:n,type:i}=e||{};return[r||null,n||null].slice(0,mf(i,t))}var kZ={tag:"div",ref:"eFloatingFilterInputContainer",cls:"ag-floating-filter-input",role:"presentation"},iI=class extends JL{constructor(){super(...arguments),this.eFloatingFilterInputContainer=tt,this.defaultDebounceMs=500}postConstruct(){this.setTemplate(kZ)}onModelUpdated(e){this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.inputSvc.setValue(this.filterModelFormatter.getModelAsString(e))}setParams(e){this.setupFloatingFilterInputService(e),super.setParams(e),this.setTextInputParams(e)}setupFloatingFilterInputService(e){this.inputSvc=this.createFloatingFilterInputService(e),this.inputSvc.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(e){const t=e.browserAutoComplete??!1,{inputSvc:r,defaultDebounceMs:n,readOnly:i}=this;if(r.setParams({ariaLabel:this.getAriaLabel(e),autoComplete:t}),this.applyActive=qm(e.filterParams),!i){const s=Sx(e.filterParams,n),o=yn(this,this.syncUpWithParentFilter.bind(this),s);r.setValueChangedListener(o)}}updateParams(e){super.updateParams(e),this.setTextInputParams(e)}recreateFloatingFilterInputService(e){const{inputSvc:t}=this,r=t.getValue();ci(this.eFloatingFilterInputContainer),this.destroyBean(t),this.setupFloatingFilterInputService(e),t.setValue(r,!0)}syncUpWithParentFilter(e){const t=e.key===me.ENTER,r=this.reactive;if(r&&this.params.onUiChange(),this.applyActive&&!t)return;const{inputSvc:n,params:i,lastType:s}=this;let o=n.getValue();if(i.filterParams.trimInput&&(o=qb(o),n.setValue(o,!0)),r){const a=i,u=a.model,d=this.convertValue(o),h=d==null?null:{...u??{filterType:this.filterType,type:s??this.optionsFactory.defaultOption},filter:d};a.onModelChange(h,{afterFloatingFilter:!0})}else i.parentFilterInstance(a=>{a?.onFloatingFilterChanged(s||null,o||null)})}convertValue(e){return e||null}setEditable(e){this.inputSvc.setEditable(e)}},PZ=class extends Ee{constructor(){super(...arguments),this.onValueChanged=()=>{},this.numberInputActive=!0}setupGui(e){this.eNumberInput=this.createManagedBean(new mx),this.eTextInput=this.createManagedBean(new wc),this.eTextInput.setDisabled(!0);const t=this.eNumberInput.getGui(),r=this.eTextInput.getGui();e.appendChild(t),e.appendChild(r),this.setupListeners(t,n=>this.onValueChanged(n)),this.setupListeners(r,n=>this.onValueChanged(n))}setEditable(e){this.numberInputActive=e,this.eNumberInput.setDisplayed(this.numberInputActive),this.eTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(e){this.eNumberInput.setAutoComplete(e),this.eTextInput.setAutoComplete(e)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eNumberInput:this.eTextInput}setValueChangedListener(e){this.onValueChanged=e}setupListeners(e,t){this.addManagedListeners(e,{input:t,keydown:t})}setParams(e){this.setAriaLabel(e.ariaLabel),e.autoComplete!==void 0&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eNumberInput.setInputAriaLabel(e),this.eTextInput.setInputAriaLabel(e)}},MZ=class extends iI{constructor(){super(...arguments),this.FilterModelFormatterClass=tI,this.filterType="number",this.defaultOptions=Hx}updateParams(e){Yb(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),super.updateParams(e)}createFloatingFilterInputService(e){return this.allowedCharPattern=Yb(e.filterParams),this.allowedCharPattern?this.createManagedBean(new rI({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new PZ)}convertValue(e){return e?Number(e):null}},Gx=["contains","notContains","equals","notEqual","startsWith","endsWith","blank","notBlank"],_Z=class extends Ox{constructor(){super("textFilter",nI,Gx),this.filterType="text",this.eValuesFrom=[],this.eValuesTo=[],this.defaultDebounceMs=500}createCondition(e){const t=this.getConditionType(e),r={filterType:this.filterType,type:t},n=this.getValues(e);return n.length>0&&(r.filter=n[0]),n.length>1&&(r.filterTo=n[1]),r}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getInputs(e){const{eValuesFrom:t,eValuesTo:r}=this;return e>=t.length?[null,null]:[t[e],r[e]]}getValues(e){const t=[];return this.forEachPositionInput(e,(r,n,i,s)=>{n<s&&t.push(Ho(r.getValue()))}),t}createEValue(){const e=jn({tag:"div",cls:"ag-filter-body",role:"presentation"}),{eValuesFrom:t,eValuesTo:r}=this;return this.createFromToElement(e,t,"from"),this.createFromToElement(e,r,"to"),e}createFromToElement(e,t,r){const n=this.createManagedBean(new wc);n.addCss(`ag-filter-${r}`),n.addCss("ag-filter-filter"),t.push(n),e.appendChild(n.getGui())}removeEValues(e,t){const r=s=>this.removeComponents(s,e,t),{eValuesFrom:n,eValuesTo:i}=this;r(n),r(i)}},sI=class extends Bx{constructor(){super(...arguments),this.filterTypeKeys=bZ}conditionToString(e,t,r,n,i){const{filter:s,filterTo:o,type:a}=e;if(t){const u=h=>()=>Ba(this,"filterSummaryTextQuote",[h]),d=this.conditionForToolPanel(a,r,u(s),u(o),n,i);if(d!=null)return d}return r?`${s}-${o}`:s!=null?`${s}`:`${a}`}},LZ=({filterOption:e,value:t,filterText:r})=>{if(r==null)return!1;switch(e){case"contains":return t.includes(r);case"notContains":return!t.includes(r);case"equals":return t===r;case"notEqual":return t!=r;case"startsWith":return t.indexOf(r)===0;case"endsWith":{const n=t.lastIndexOf(r);return n>=0&&n===t.length-r.length}default:return!1}},IZ=e=>e,OZ=e=>e==null?null:e.toString().toLowerCase(),NZ=class extends qL{constructor(){super(nI,Gx),this.filterType="text",this.FilterModelFormatterClass=sI}updateParams(e){super.updateParams(e);const t=e.filterParams;this.matcher=t.textMatcher??LZ,this.formatter=t.textFormatter??(t.caseSensitive?IZ:OZ)}evaluateNullValue(e){return e?["notEqual","notContains","blank"].indexOf(e)>=0:!1}evaluateNonNullValue(e,t,r,n){const i=e.map(m=>this.formatter(m))||[],s=this.formatter(t),{api:o,colDef:a,column:u,context:d,filterParams:{textFormatter:h}}=this.params;if(r.type==="blank")return $0(t);if(r.type==="notBlank")return!$0(t);const g={api:o,colDef:a,column:u,context:d,node:n.node,data:n.data,filterOption:r.type,value:s,textFormatter:h};return i.some(m=>this.matcher({...g,filterText:m}))}processModelToApply(e){if(e&&this.params.filterParams.trimInput){const t=r=>{const n={...r},{filter:i,filterTo:s}=r;return i&&(n.filter=qb(i)??null),s&&(n.filterTo=qb(s)??null),n};return Z_(e)?{...e,conditions:e.conditions.map(t)}:t(e)}return e}},BZ=class extends iI{constructor(){super(...arguments),this.FilterModelFormatterClass=sI,this.filterType="text",this.defaultOptions=Gx}createFloatingFilterInputService(){return this.createManagedBean(new rI)}};function HZ(e){return!!e.quickFilter?.isFilterPresent()}function GZ(e){return e.quickFilter?.getText()}function VZ(e){e.quickFilter?.resetCache()}var zZ=class extends Ee{constructor(){super(...arguments),this.beanName="quickFilter",this.quickFilter=null,this.quickFilterParts=null}postConstruct(){const e=this.resetCache.bind(this),t=this.gos;this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:e,columnRowGroupChanged:e,columnVisible:()=>{t.get("includeHiddenColumnsInQuickFilter")||this.resetCache()}}),this.addManagedPropertyListener("quickFilterText",r=>this.setFilter(r.currentValue)),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],()=>this.onColumnConfigChanged()),this.quickFilter=this.parseFilter(t.get("quickFilterText")),this.parser=t.get("quickFilterParser"),this.matcher=t.get("quickFilterMatcher"),this.setFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setParserAndMatcher())}refreshCols(){const{autoColSvc:e,colModel:t,gos:r,pivotResultCols:n}=this.beans,i=t.isPivotMode(),s=e?.getColumns(),o=t.getColDefCols();let a=(i&&!r.get("applyQuickFilterBeforePivotOrAgg")?n?.getPivotResultCols()?.list:o)??[];s&&(a=a.concat(s)),this.colsToUse=r.get("includeHiddenColumnsInQuickFilter")?a:a.filter(u=>u.isVisible()||u.isRowGroupActive())}isFilterPresent(){return this.quickFilter!==null}doesRowPass(e){const t=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassMatcher(t,e):this.quickFilterParts.every(r=>t?this.doesRowPassCache(e,r):this.doesRowPassNoCache(e,r))}resetCache(){this.beans.rowModel.forEachNode(e=>e.quickFilterAggregateText=null)}getText(){return this.gos.get("quickFilterText")}setFilterParts(){const{quickFilter:e,parser:t}=this;e?this.quickFilterParts=t?t(e):e.split(" "):this.quickFilterParts=null}parseFilter(e){return $e(e)?e.toUpperCase():null}setFilter(e){if(e!=null&&typeof e!="string"){Me(70,{newFilter:e});return}const t=this.parseFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}setParserAndMatcher(){const e=this.gos.get("quickFilterParser"),t=this.gos.get("quickFilterMatcher"),r=e!==this.parser||t!==this.matcher;this.parser=e,this.matcher=t,r&&(this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}onColumnConfigChanged(){this.refreshCols(),this.resetCache(),this.isFilterPresent()&&this.dispatchLocalEvent({type:"quickFilterChanged"})}doesRowPassNoCache(e,t){return this.colsToUse.some(r=>{const n=this.getTextForColumn(r,e);return $e(n)&&n.includes(t)})}doesRowPassCache(e,t){return this.checkGenerateAggText(e),e.quickFilterAggregateText.includes(t)}doesRowPassMatcher(e,t){let r;e?(this.checkGenerateAggText(t),r=t.quickFilterAggregateText):r=this.getAggText(t);const{quickFilterParts:n,matcher:i}=this;return i(n,r)}checkGenerateAggText(e){e.quickFilterAggregateText||(e.quickFilterAggregateText=this.getAggText(e))}getTextForColumn(e,t){let r=this.beans.filterValueSvc.getValue(e,t);const n=e.getColDef();if(n.getQuickFilterText){const i=it(this.gos,{value:r,node:t,data:t.data,column:e,colDef:n});r=n.getQuickFilterText(i)}return $e(r)?r.toString().toUpperCase():null}getAggText(e){const t=[];for(const r of this.colsToUse){const n=this.getTextForColumn(r,e);$e(n)&&t.push(n)}return t.join(`
`)}},WZ={moduleName:"ClientSideRowModelFilter",version:Ue,rowModels:["clientSide"],beans:[UQ]},Vx={moduleName:"FilterCore",version:Ue,beans:[hZ],apiFunctions:{isAnyFilterPresent:uZ,onFilterChanged:dZ},css:[XQ],dependsOn:[WZ]},oI={moduleName:"FilterValue",version:Ue,beans:[gZ]},ev={moduleName:"ColumnFilter",version:Ue,beans:[cZ,fZ],dynamicBeans:{headerFilterCellCtrl:$Q},icons:{filter:"filter",filterActive:"filter"},apiFunctions:{isColumnFilterPresent:QQ,getColumnFilterInstance:ZQ,destroyFilter:JQ,setFilterModel:eZ,getFilterModel:tZ,getColumnFilterModel:rZ,setColumnFilterModel:nZ,showColumnFilter:iZ,hideColumnFilter:sZ,getColumnFilterHandler:oZ,doFilterAction:aZ},dependsOn:[Vx,Jm,oI,KQ]},UZ={moduleName:"CustomFilter",version:Ue,userComponents:{agReadOnlyFloatingFilter:mZ},dependsOn:[ev]},$Z={moduleName:"TextFilter",version:Ue,dependsOn:[ev],userComponents:{agTextColumnFilter:{classImp:_Z,params:{useForm:!0}},agTextColumnFloatingFilter:BZ},dynamicBeans:{agTextColumnFilterHandler:NZ}},jZ={moduleName:"NumberFilter",version:Ue,dependsOn:[ev],userComponents:{agNumberColumnFilter:{classImp:DZ,params:{useForm:!0}},agNumberColumnFloatingFilter:MZ},dynamicBeans:{agNumberColumnFilterHandler:AZ}},YZ={moduleName:"DateFilter",version:Ue,dependsOn:[ev],userComponents:{agDateColumnFilter:{classImp:yZ,params:{useForm:!0}},agDateInput:FZ,agDateColumnFloatingFilter:RZ},dynamicBeans:{agDateColumnFilterHandler:xZ}},KZ={moduleName:"QuickFilterCore",version:Ue,rowModels:["clientSide"],beans:[zZ],dependsOn:[Vx,oI]},qZ={moduleName:"QuickFilter",version:Ue,apiFunctions:{isQuickFilterPresent:HZ,getQuickFilter:GZ,resetQuickFilter:VZ},dependsOn:[KZ]},XZ={moduleName:"ExternalFilter",version:Ue,dependsOn:[Vx]},QZ=".ag-tooltip{background-color:var(--ag-tooltip-background-color);border:var(--ag-tooltip-border);border-radius:var(--ag-border-radius);color:var(--ag-tooltip-text-color);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;white-space:normal;z-index:99999;&:where(.ag-cell-editor-tooltip){background-color:var(--ag-tooltip-error-background-color);border:var(--ag-tooltip-error-border);color:var(--ag-tooltip-error-text-color);font-weight:500}}.ag-tooltip-custom{position:absolute;z-index:99999}.ag-tooltip-custom:where(:not(.ag-tooltip-interactive)),.ag-tooltip:where(:not(.ag-tooltip-interactive)){pointer-events:none}.ag-tooltip-animate{transition:opacity 1s;&:where(.ag-tooltip-hiding){opacity:0}}",_y=(e,t,r)=>{const{editModelSvc:n}=e,i=n?.getCellValidationModel()?.getCellValidation(t)?.errorMessages,s=n?.getRowValidationModel().getRowValidation(t)?.errorMessages,o=i||s;return o?.length?o.join(r("tooltipValidationErrorSeparator",". ")):void 0},ZZ=class extends Ee{constructor(){super(...arguments),this.beanName="tooltipSvc"}setupHeaderTooltip(e,t,r,n){e&&t.destroyBean(e);const i=this.gos,s=My(i),{column:o,eGui:a}=t,u=o.getColDef();!n&&s&&!u.headerComponent&&(n=Jp(()=>a.querySelector(".ag-header-cell-text")));const d="header",g=this.beans.colNames.getDisplayNameForColumn(o,"header",!0),m=r??g,v={getGui:()=>a,getLocation:()=>d,getTooltipValue:()=>r??u?.headerTooltipValueGetter?.(it(i,{location:d,colDef:u,column:o,value:m,valueFormatted:g}))??u?.headerTooltip,shouldDisplayTooltip:n,getAdditionalParams:()=>({column:o,colDef:o.getColDef()})};let w=this.createTooltipFeature(v);return w&&(w=t.createBean(w),t.setRefreshFunction("tooltip",()=>w.refreshTooltip())),w}setupHeaderGroupTooltip(e,t,r,n){e&&t.destroyBean(e);const i=this.gos,s=My(i),{column:o,eGui:a}=t,u=o.getColGroupDef();!n&&s&&!u?.headerGroupComponent&&(n=Jp(()=>a.querySelector(".ag-header-group-text")));const d="headerGroup",g=this.beans.colNames.getDisplayNameForColumnGroup(o,"header"),m=r??g,v={getGui:()=>a,getLocation:()=>d,getTooltipValue:()=>r??u?.headerTooltipValueGetter?.(it(i,{location:d,colDef:u,column:o,value:m,valueFormatted:g}))??u?.headerTooltip,shouldDisplayTooltip:n,getAdditionalParams:()=>{const C={column:o};return u&&(C.colDef=u),C}},w=this.createTooltipFeature(v);return w&&t.createBean(w)}enableCellTooltipFeature(e,t,r){const{beans:n}=this,{gos:i,editSvc:s}=n,{column:o,rowNode:a}=e;let u="cell";const d=()=>{const v=!!!s?.isEditing(e)&&_y(n,e,this.getLocaleTextFunc());if(v)return u="cellEditor",v;u="cell";const w=o.getColDef(),C=a.data;if(w.tooltipField&&$e(C))return Vh(C,w.tooltipField,o.isTooltipFieldContainsDots());const b=w.tooltipValueGetter;return b?b(it(i,{location:"cell",colDef:o.getColDef(),column:o,rowIndex:e.cellPosition.rowIndex,node:a,data:a.data,value:e.value,valueFormatted:e.valueFormatted})):null},h=My(i);r||(h&&!e.isCellRenderer()?r=()=>{const m=!!s?.isEditing(e);if(!m&&_y(n,e,this.getLocaleTextFunc()))return!0;if(!o.isTooltipEnabled())return!1;const C=Jp(()=>{const b=e.eGui;return b.children.length===0?b:b.querySelector(".ag-cell-value")});return!m&&C()}:r=()=>!s?.isEditing(e));const g={getGui:()=>e.eGui,getLocation:()=>u,getTooltipValue:t!=null?()=>t:d,shouldDisplayTooltip:r,getAdditionalParams:()=>({column:o,colDef:o.getColDef(),rowIndex:e.cellPosition.rowIndex,node:a,data:a.data,valueFormatted:e.valueFormatted})};return this.createTooltipFeature(g,n)}setupFullWidthRowTooltip(e,t,r,n){const i={getGui:()=>t.getFullWidthElement(),getTooltipValue:()=>r,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:n},s=this.beans,o=s.context;e&&t.destroyBean(e,o);const a=this.createTooltipFeature(i,s);if(a)return t.createBean(a,o)}setupCellEditorTooltip(e,t){const{beans:r}=this,{context:n}=r,i=t.getValidationElement?.(!0)||!t.isPopup?.()&&e.eGui;if(!i)return;const s={getGui:()=>i,getTooltipValue:()=>_y(r,e,this.getLocaleTextFunc()),getLocation:()=>"cellEditor",shouldDisplayTooltip:()=>{const{editModelSvc:a}=r,u=a?.getRowValidationModel()?.getRowValidationMap(),d=a?.getCellValidationModel()?.getCellValidationMap(),h=!!u&&u.size>0,g=!!d&&d.size>0;return h||g}},o=this.createTooltipFeature(s,r);if(o)return e.createBean(o,n)}initCol(e){const{colDef:t}=e;e.tooltipEnabled=$e(t.tooltipField)||$e(t.tooltipValueGetter)||$e(t.tooltipComponent)}createTooltipFeature(e,t){return this.beans.registry.createDynamicBean("tooltipFeature",!1,e,t)}},JZ=class extends j9{createTooltipComp(e,t){BW(this.beans.userCompFactory,e)?.newAgStackInstance().then(t)}setEventHandlers(e){[this.onColumnMovedEventCallback]=this.addManagedEventListeners({columnMoved:e})}clearEventHandlers(){this.onColumnMovedEventCallback?.(),this.onColumnMovedEventCallback=void 0}},aI={moduleName:"Tooltip",version:Ue,beans:[ZZ],dynamicBeans:{tooltipFeature:z_,highlightTooltipFeature:Y9,tooltipStateManager:JZ},userComponents:{agTooltipComponent:X9},dependsOn:[Jm],css:[QZ]},yu=class{constructor(e){this.cellValueChanges=e}},Ly=class extends yu{constructor(e,t,r,n){super(e),this.initialRange=t,this.finalRange=r,this.ranges=n}},eJ=10,ZD=class{constructor(e){this.actionStack=[],this.maxStackSize=e||eJ,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}},tJ=class extends Ee{constructor(){super(...arguments),this.beanName="undoRedo",this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.batchEditing=!1,this.bulkEditing=!1,this.onCellValueChanged=e=>{const t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},r=this.activeCellEdit!==null&&wL(this.activeCellEdit,t),n=this.activeRowEdit!==null&&xj(this.activeRowEdit,t);if(!(r||n||this.isPasting||this.isRangeInAction))return;const{rowPinned:s,rowIndex:o,column:a,oldValue:u,value:d}=e,h={rowPinned:s,rowIndex:o,columnId:a.getColId(),newValue:d,oldValue:u};this.cellValueChanges.push(h)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}postConstruct(){const{gos:e,ctrlsSvc:t}=this.beans;if(!e.get("undoRedoCellEditing"))return;const r=e.get("undoRedoCellEditingLimit");if(r<=0)return;this.undoStack=new ZD(r),this.redoStack=new ZD(r),this.addListeners();const n=this.clearStacks.bind(this);this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this),modelUpdated:i=>{i.keepUndoRedoStack||this.clearStacks()},columnPivotModeChanged:n,newColumnsLoaded:n,columnGroupOpened:n,columnRowGroupChanged:n,columnMoved:n,columnPinned:n,columnVisible:n,rowDragEnd:n}),t.whenReady(this,i=>{this.gridBodyCtrl=i.gridBodyCtrl})}getCurrentUndoStackSize(){return this.undoStack?.getCurrentStackSize()??0}getCurrentRedoStackSize(){return this.redoStack?.getCurrentStackSize()??0}undo(e){const{eventSvc:t,undoStack:r,redoStack:n}=this;t.dispatchEvent({type:"undoStarted",source:e});const i=this.undoRedo(r,n,"initialRange","oldValue","undo");t.dispatchEvent({type:"undoEnded",source:e,operationPerformed:i})}redo(e){const{eventSvc:t,undoStack:r,redoStack:n}=this;t.dispatchEvent({type:"redoStarted",source:e});const i=this.undoRedo(n,r,"finalRange","newValue","redo");t.dispatchEvent({type:"redoEnded",source:e,operationPerformed:i})}undoRedo(e,t,r,n,i){if(!e)return!1;const s=e.pop();return s?.cellValueChanges?(this.processAction(s,o=>o[n],i),s instanceof Ly?this.processRange(s.ranges||[s[r]]):this.processCell(s.cellValueChanges),t.push(s),!0):!1}processAction(e,t,r){for(const n of e.cellValueChanges){const{rowIndex:i,rowPinned:s,columnId:o}=n,a={rowIndex:i,rowPinned:s},u=Yo(this.beans,a);u.displayed&&u.setDataValue(o,t(n),r)}}processRange(e){let t;const r=this.beans.rangeSvc;r.removeAllCellRanges(!0),e.forEach((n,i)=>{if(!n)return;const s=n.startRow,o=n.endRow;i===e.length-1&&(t={rowPinned:s.rowPinned,rowIndex:s.rowIndex,columnId:n.startColumn.getColId()},this.setLastFocusedCell(t));const a={rowStartIndex:s.rowIndex,rowStartPinned:s.rowPinned,rowEndIndex:o.rowIndex,rowEndPinned:o.rowPinned,columnStart:n.startColumn,columns:n.columns};r.addCellRange(a)})}processCell(e){const t=e[0],{rowIndex:r,rowPinned:n}=t,i={rowIndex:r,rowPinned:n},s=Yo(this.beans,i),o={rowPinned:t.rowPinned,rowIndex:s.rowIndex,columnId:t.columnId};this.setLastFocusedCell(o)}setLastFocusedCell(e){const{rowIndex:t,columnId:r,rowPinned:n}=e,{colModel:i,focusSvc:s,rangeSvc:o}=this.beans,a=i.getCol(r);if(!a)return;const{scrollFeature:u}=this.gridBodyCtrl;u.ensureIndexVisible(t),u.ensureColumnVisible(a);const d={rowIndex:t,column:a,rowPinned:n};s.setFocusedCell({...d,forceBrowserFocus:!0}),o?.setRangeToCell(d)}addListeners(){this.addManagedEventListeners({rowEditingStarted:e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}},rowEditingStopped:()=>{const e=new yu(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null},cellEditingStarted:e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}},cellEditingStopped:e=>{if(this.activeCellEdit=null,e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){const r=new yu(this.cellValueChanges);this.pushActionsToUndoStack(r)}},pasteStart:()=>{this.isPasting=!0},pasteEnd:()=>{const e=new yu(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1},fillStart:()=>{this.isRangeInAction=!0},fillEnd:e=>{const t=new Ly(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1},keyShortcutChangedCellStart:()=>{this.isRangeInAction=!0},keyShortcutChangedCellEnd:()=>{let e;const{rangeSvc:t,gos:r}=this.beans;t&&ja(r)?e=new Ly(this.cellValueChanges,void 0,void 0,[...t.getCellRanges()]):e=new yu(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1},batchEditingStarted:()=>this.startBigChange("batchEditing"),batchEditingStopped:({changes:e})=>this.stopBigChange("batchEditing",e),bulkEditingStarted:()=>this.startBigChange("bulkEditing"),bulkEditingStopped:({changes:e})=>this.stopBigChange("bulkEditing",e)})}startBigChange(e){this.updateBigChange(e,!0)}updateBigChange(e,t){e==="bulkEditing"?this.bulkEditing=t:this.batchEditing=t}stopBigChange(e,t){if(e==="bulkEditing"&&!this.bulkEditing||e==="batchEditing"&&!this.batchEditing||(this.updateBigChange(e,!1),t?.length===0))return;const r=new yu(t??[]);this.pushActionsToUndoStack(r),this.cellValueChanges=[]}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}},rJ=".ag-cell-inline-editing{border:var(--ag-cell-editing-border)!important;border-radius:var(--ag-border-radius);box-shadow:var(--ag-cell-editing-shadow);padding:0;z-index:1;.ag-cell-edit-wrapper,.ag-cell-editor,.ag-cell-wrapper,:where(.ag-cell-editor) .ag-input-field-input,:where(.ag-cell-editor) .ag-wrapper{height:100%;line-height:normal;min-height:100%;width:100%}&.ag-cell-editing-error{border-color:var(--ag-invalid-color)!important}}:where(.ag-popup-editor) .ag-large-text{background-color:var(--ag-background-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);padding:0}.ag-large-text-input{display:block;height:auto;padding:var(--ag-cell-horizontal-padding)}:where(.ag-rtl .ag-large-text-input) textarea{resize:none}:where(.ag-ltr) .ag-checkbox-edit{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-checkbox-edit{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-row.ag-row-editing-invalid .ag-cell-inline-editing){opacity:.8}.ag-popup-editor{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}",nJ={tag:"div",cls:"ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit",children:[{tag:"ag-checkbox",ref:"eEditor",role:"presentation"}]},iJ=class extends Qm{constructor(){super(nJ,[px]),this.eEditor=tt}initialiseEditor(e){const t=e.value??void 0,r=this.eEditor;r.setValue(t),r.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(t),this.addManagedListeners(r,{fieldValueChanged:i=>this.setAriaLabel(i.selected)})}getValue(){return this.eEditor.getValue()}focusIn(){this.eEditor.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){const t=this.getLocaleTextFunc(),r=$m(t,e),n=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eEditor.setInputAriaLabel(`${n} (${r})`)}getValidationElement(e){return e?this.params.eGridCell:this.eEditor.getInputElement()}getValidationErrors(){const{params:e}=this,{getValidationErrors:t}=e,r=this.getValue();return t?t({value:r,internalErrors:null,cellEditorParams:e}):null}},tv=class extends Qm{constructor(e){super(),this.cellEditorInput=e,this.eEditor=tt}initialiseEditor(e){const{cellEditorInput:t}=this;this.setTemplate({tag:"div",cls:"ag-cell-edit-wrapper",children:[t.getTemplate()]},t.getAgComponents());const{eEditor:r}=this,{cellStartedEdit:n,eventKey:i,suppressPreventDefault:s}=e;r.getInputElement().setAttribute("title",""),t.init(r,e);let o,a=!0;n?(this.focusAfterAttached=!0,i===me.BACKSPACE||i===me.DELETE?o="":i&&i.length===1?s?a=!1:o=i:(o=t.getStartValue(),i!==me.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,o=t.getStartValue()),a&&o!=null&&r.setStartValue(o),this.addGuiEventListener("keydown",u=>{const{key:d}=u;(d===me.PAGE_UP||d===me.PAGE_DOWN)&&u.preventDefault()})}afterGuiAttached(){const e=this.getLocaleTextFunc(),t=this.eEditor;if(t.setInputAriaLabel(e("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;rl()||t.getFocusableElement().focus();const r=t.getInputElement();this.highlightAllOnFocus?r.select():this.cellEditorInput.setCaret?.()}focusIn(){const{eEditor:e}=this,t=e.getFocusableElement(),r=e.getInputElement();t.focus(),r.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){return this.cellEditorInput.getValidationErrors()}},sJ={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},oJ=class{constructor(e,t){this.getDataTypeService=e,this.getLocaleTextFunc=t}getTemplate(){return sJ}getAgComponents(){return[__]}init(e,t){this.eEditor=e,this.params=t;const{min:r,max:n,step:i,colDef:s}=t;r!=null&&e.setMin(r),n!=null&&e.setMax(n),i!=null&&e.setStep(i),this.includeTime=t.includeTime??this.getDataTypeService()?.getDateIncludesTimeFlag?.(s.cellDataType),this.includeTime!=null&&e.setIncludeTime(this.includeTime)}getValidationErrors(){const t=this.eEditor.getInputElement().valueAsDate,{params:r}=this,{min:n,max:i,getValidationErrors:s}=r;let o=[];const a=this.getLocaleTextFunc();if(t instanceof Date&&!isNaN(t.getTime())){if(n){const u=n instanceof Date?n:new Date(n);if(t<u){const d=u.toLocaleDateString();o.push(a("minDateValidation",`Date must be after ${d}`,[d]))}}if(i){const u=i instanceof Date?i:new Date(i);if(t>u){const d=u.toLocaleDateString();o.push(a("maxDateValidation",`Date must be before ${d}`,[d]))}}}return o.length||(o=null),s?s({value:t,cellEditorParams:r,internalErrors:o}):o}getValue(){const{eEditor:e,params:t}=this,r=e.getDate();return!$e(r)&&!$e(t.value)?t.value:r??null}getStartValue(){const{value:e}=this.params;if(e instanceof Date)return Fi(e,this.includeTime??!1)}},aJ=class extends tv{constructor(){super(new oJ(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},lJ={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},cJ=class{constructor(e,t){this.getDataTypeService=e,this.getLocaleTextFunc=t}getTemplate(){return lJ}getAgComponents(){return[__]}init(e,t){this.eEditor=e,this.params=t;const{min:r,max:n,step:i,colDef:s}=t;r!=null&&e.setMin(r),n!=null&&e.setMax(n),i!=null&&e.setStep(i),this.includeTime=t.includeTime??this.getDataTypeService()?.getDateIncludesTimeFlag?.(s.cellDataType),this.includeTime!=null&&e.setIncludeTime(this.includeTime)}getValidationErrors(){const{eEditor:e,params:t}=this,r=e.getInputElement().value,n=this.formatDate(this.parseDate(r??void 0)),{min:i,max:s,getValidationErrors:o}=t;let a=[];if(n){const u=new Date(n),d=this.getLocaleTextFunc();if(i){const h=new Date(i);if(u<h){const g=h.toLocaleDateString();a.push(d("minDateValidation",`Date must be after ${g}`,[g]))}}if(s){const h=new Date(s);if(u>h){const g=h.toLocaleDateString();a.push(d("maxDateValidation",`Date must be before ${g}`,[g]))}}}return a.length||(a=null),o?o({value:this.getValue(),cellEditorParams:t,internalErrors:a}):a}getValue(){const{params:e,eEditor:t}=this,r=this.formatDate(t.getDate());return!$e(r)&&!$e(e.value)?e.value:e.parseValue(r??"")}getStartValue(){return Fi(this.parseDate(this.params.value??void 0)??null,this.includeTime??!1)}parseDate(e){const t=this.getDataTypeService();return t?t.getDateParserFunction(this.params.column)(e):ui(e)??void 0}formatDate(e){const t=this.getDataTypeService();return t?t.getDateFormatterFunction(this.params.column)(e):Fi(e??null,this.includeTime??!1)??void 0}},uJ=class extends tv{constructor(){super(new cJ(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},dJ={tag:"div",cls:"ag-large-text",children:[{tag:"ag-input-text-area",ref:"eEditor",cls:"ag-large-text-input"}]},hJ=class extends Qm{constructor(){super(dJ,[r9]),this.eEditor=tt}initialiseEditor(e){const{eEditor:t}=this,{cellStartedEdit:r,eventKey:n,maxLength:i,cols:s,rows:o}=e;this.focusAfterAttached=r,t.getInputElement().setAttribute("title",""),t.setMaxLength(i||200).setCols(s||60).setRows(o||10);let a;r?(this.focusAfterAttached=!0,n===me.BACKSPACE||n===me.DELETE?a="":n&&n.length===1?a=n:(a=this.getStartValue(e),n!==me.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,a=this.getStartValue(e)),a!=null&&t.setValue(a,!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}getStartValue(e){const{value:t}=e;return t?.toString()??t}onKeyDown(e){const t=e.key;(t===me.LEFT||t===me.UP||t===me.RIGHT||t===me.DOWN||e.shiftKey&&t===me.ENTER)&&e.stopPropagation()}afterGuiAttached(){const{eEditor:e,focusAfterAttached:t,highlightAllOnFocus:r}=this,n=this.getLocaleTextFunc();e.setInputAriaLabel(n("ariaInputEditor","Input Editor")),t&&(e.getFocusableElement().focus(),r&&e.getInputElement().select())}getValue(){const{eEditor:e,params:t}=this,{value:r}=t,n=e.getValue();return!$e(n)&&!$e(r)?r:t.parseValue(n)}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){const{params:e}=this,{maxLength:t,getValidationErrors:r}=e,n=this.getLocaleTextFunc(),i=this.getValue();let s=[];return typeof i=="string"&&t!=null&&i.length>t&&s.push(n("maxLengthValidation",`Must be ${t} characters or fewer.`,[String(t)])),s.length||(s=null),r?r({value:i,internalErrors:s,cellEditorParams:e}):s}},fJ={tag:"ag-input-number-field",ref:"eEditor",cls:"ag-cell-editor"},gJ=class{constructor(e){this.getLocaleTextFunc=e}getTemplate(){return fJ}getAgComponents(){return[n9]}init(e,t){this.eEditor=e,this.params=t;const{max:r,min:n,precision:i,step:s}=t;r!=null&&e.setMax(r),n!=null&&e.setMin(n),i!=null&&e.setPrecision(i),s!=null&&e.setStep(s);const o=e.getInputElement();t.preventStepping?e.addManagedElementListeners(o,{keydown:this.preventStepping}):t.showStepperButtons&&o.classList.add("ag-number-field-input-stepper")}getValidationErrors(){const{params:e}=this,{min:t,max:r,getValidationErrors:n}=e,s=this.eEditor.getInputElement().valueAsNumber,o=this.getLocaleTextFunc();let a=[];return typeof s=="number"&&(t!=null&&s<t&&a.push(o("minValueValidation",`Must be greater than or equal to ${t}.`,[String(t)])),r!=null&&s>r&&a.push(o("maxValueValidation",`Must be less than or equal to ${r}.`,[String(r)]))),a.length||(a=null),n?n({value:s,cellEditorParams:e,internalErrors:a}):a}preventStepping(e){(e.key===me.UP||e.key===me.DOWN)&&e.preventDefault()}getValue(){const{eEditor:e,params:t}=this,r=e.getValue();if(!$e(r)&&!$e(t.value))return t.value;let n=t.parseValue(r);if(n==null)return n;if(typeof n=="string"){if(n==="")return null;n=Number(n)}return isNaN(n)?null:n}getStartValue(){return this.params.value}setCaret(){rl()&&this.eEditor.getInputElement().focus({preventScroll:!0})}},pJ=class extends tv{constructor(){super(new gJ(()=>this.getLocaleTextFunc()))}},mJ={tag:"div",cls:"ag-cell-edit-wrapper",children:[{tag:"ag-select",ref:"eEditor",cls:"ag-cell-editor"}]},vJ=class extends Qm{constructor(){super(mJ,[g9]),this.eEditor=tt,this.startedByEnter=!1}wireBeans(e){this.valueSvc=e.valueSvc}initialiseEditor(e){this.focusAfterAttached=e.cellStartedEdit;const{eEditor:t,valueSvc:r,gos:n}=this,{values:i,value:s,eventKey:o}=e;if(xr(i)){Me(58);return}this.startedByEnter=o!=null?o===me.ENTER:!1;let a=!1;i.forEach(g=>{const m={value:g},v=r.formatValue(e.column,null,g),w=v!=null;m.text=w?v:g,t.addOption(m),a=a||s===g}),a?t.setValue(e.value,!0):e.values.length&&t.setValue(e.values[0],!0);const{valueListGap:u,valueListMaxWidth:d,valueListMaxHeight:h}=e;u!=null&&t.setPickerGap(u),h!=null&&t.setPickerMaxHeight(h),d!=null&&t.setPickerMaxWidth(d),n.get("editType")!=="fullRow"&&this.addManagedListeners(this.eEditor,{selectedItem:()=>e.stopEditing()})}afterGuiAttached(){this.focusAfterAttached&&this.eEditor.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eEditor.showPicker()})}focusIn(){this.eEditor.getFocusableElement().focus()}getValue(){return this.eEditor.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getAriaElement()}getValidationErrors(){const{params:e}=this,{values:t,getValidationErrors:r}=e,n=this.getValue();let i=[];if(t&&!t.includes(n)){const s=this.getLocaleTextFunc();i.push(s("invalidSelectionValidation","Invalid selection."))}else i=null;return r?r({value:n,internalErrors:i,cellEditorParams:e}):i}},wJ={tag:"ag-input-text-field",ref:"eEditor",cls:"ag-cell-editor"},CJ=class{constructor(e){this.getLocaleTextFunc=e}getTemplate(){return wJ}getAgComponents(){return[Ym]}init(e,t){this.eEditor=e,this.params=t;const r=t.maxLength;r!=null&&e.setMaxLength(r)}getValidationErrors(){const{params:e}=this,{maxLength:t,getValidationErrors:r}=e,n=this.getValue(),i=this.getLocaleTextFunc();let s=[];return t!=null&&typeof n=="string"&&n.length>t&&s.push(i("maxLengthValidation",`Must be ${t} characters or fewer.`,[String(t)])),s.length||(s=null),r?r({value:n,cellEditorParams:e,internalErrors:s}):s}getValue(){const{eEditor:e,params:t}=this,r=e.getValue();return!$e(r)&&!$e(t.value)?t.value:t.parseValue(r)}getStartValue(){const e=this.params;return e.useFormatter||e.column.getColDef().refData?e.formatValue(e.value):e.value}setCaret(){rl()&&this.eEditor.getInputElement().focus({preventScroll:!0});const e=this.eEditor,t=e.getValue(),r=$e(t)&&t.length||0;r&&e.getInputElement().setSelectionRange(r,r)}},JD=class extends tv{constructor(){super(new CJ(()=>this.getLocaleTextFunc()))}};function yJ(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}function bJ(e){return e.ctrlsSvc.getScrollFeature().getHScrollPosition()}function lI(e,t,r="auto"){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureColumnVisible(t,r),"ensureVisible")}function cI(e,t,r){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureIndexVisible(t,r),"ensureVisible")}function SJ(e,t,r=null){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureNodeVisible(t,r),"ensureVisible")}function xJ(e){e.undoRedo?.undo("api")}function EJ(e){e.undoRedo?.redo("api")}function RJ(e,t){return e.editModelSvc?.getEditRowDataValue(t,{checkSiblings:!0})}function TJ(e){const t=e.editModelSvc?.getEditMap(),r=[];return t?.forEach((n,i)=>{const{rowIndex:s,rowPinned:o}=i;n.forEach((a,u)=>{const{editorValue:d,pendingValue:h,sourceValue:g,state:m}=a,v=Oo(a);let w=d??h;w===is&&(w=void 0);const C={newValue:w,oldValue:g,state:m,column:u,colId:u.getColId(),colKey:u.getColId(),rowIndex:s,rowPinned:o};(m==="editing"||m==="changed"&&v)&&r.push(C)})}),r}function FJ(e,t=!1){const{editSvc:r}=e;if(r?.isBatchEditing()){if(t)for(const n of e.editModelSvc?.getEditPositions()??[])n.state==="editing"&&r.revertSingleCellEdit(n);else Ol(e,{persist:!0});Bu(e,void 0,{cancel:t})}else r?.stopEditing(void 0,{cancel:t,source:"edit",forceStop:!t,forceCancel:t})}function DJ(e,t){const r=Sr(e,t);return e.editSvc?.isEditing(r)??!1}function AJ(e,t){const{key:r,colKey:n,rowIndex:i,rowPinned:s}=t,{editSvc:o,colModel:a}=e,u=a.getCol(n);if(!u){Me(12,{colKey:n});return}const h=Yo(e,{rowIndex:i,rowPinned:s||null});if(!h){Me(290,{rowIndex:i,rowPinned:s});return}if(!u.isCellEditable(h))return;s==null&&cI(e,i),lI(e,n),o?.startEditing({rowNode:h,column:u},{event:r?new KeyboardEvent("keydown",{key:r}):void 0,source:"api"})}function kJ(e){return e.editSvc?.validateEdit()||null}function PJ(e){return e.undoRedo?.getCurrentUndoStackSize()??0}function MJ(e){return e.undoRedo?.getCurrentRedoStackSize()??0}var _J={tag:"div",cls:"ag-popup-editor",attrs:{tabindex:"-1"}},LJ=class extends hx{constructor(e){super(_J),this.params=e}postConstruct(){tc(this.gos,this.getGui(),"popupEditorWrapper",!0),this.addKeyDownListener()}addKeyDownListener(){const e=this.getGui(),t=this.params,r=n=>{Ob(this.gos,n,t.node,t.column,!0)||t.onKeyDown(n)};this.addManagedElementListeners(e,{keydown:r})}};function IJ(e,{column:t},r,n,i="ui"){if(r instanceof KeyboardEvent&&(r.key===me.TAB||r.key===me.ENTER||r.key===me.F2||r.key===me.BACKSPACE&&n))return!0;if(r?.shiftKey&&e.rangeSvc?.getCellRanges().length!=0)return!1;const o=t?.getColDef(),a=OJ(e.gos,o),u=r?.type;return u==="click"&&r?.detail===1&&a===1||u==="dblclick"&&r?.detail===2&&a===2?!0:i==="api"?n??!1:!1}function OJ(e,t){return e.get("suppressClickEdit")===!0?0:e.get("singleClickEdit")===!0||t?.singleClickEdit?1:2}function Xb(e,{rowNode:t,column:r},n="ui"){const i=r.getColDef().editable,s=e.editModelSvc;return r.isColumnFunc(t,i)||!!s&&s.hasEdits({rowNode:t,column:r},{withOpenEditor:!0})}function NJ(e,t,r="ui"){const n=Xb(e,t,r);return n===!0||r==="ui"?n:e.colModel.getCols().some(s=>Xb(e,{rowNode:t.rowNode,column:s},r))}var j0=(e,t=!1)=>{if(e!==void 0)return Oo(e)||t&&e.state==="editing"};function uI(e,t,r=!1){return j0(e.editModelSvc?.getEdit(t),r)}var dI=(e,t,r)=>{if(e)for(let n=0,i=e.length;n<i;++n){const s=e[n];if(s.data&&(j0(t?.getEdit({rowNode:s,column:r}))||j0(t?.getEdit({rowNode:s.pinnedSibling,column:r})))||dI(s.childrenAfterGroup,t,r))return!0}};function hI(e,t){const{column:r,rowNode:n}=t;return e.gos.get("groupTotalRow")&&!n?.footer?!1:dI(n?.childrenAfterGroup,e.editModelSvc,r)}function fI(e,{rowNode:t,column:r}){if(t=t.pinnedSibling,!!t)return j0(e.editModelSvc?.getEdit({rowNode:t,column:r}))}var BJ=class extends Ee{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.editSvc=t.editSvc,this.editModelSvc=t.editModelSvc}setComp(e){this.cellComp=e,this.applyCellStyles()}applyCellStyles(){const{cellCtrl:e,editSvc:t,beans:r}=this;if(t?.isBatchEditing()&&t.isEditing()){const i=uI(r,e)||hI(r,e)||fI(r,e);this.applyBatchingStyle(i)}else this.applyBatchingStyle(!1);const n=!!this.editModelSvc?.getCellValidationModel().hasCellValidation(this.cellCtrl);this.cellComp.toggleCss("ag-cell-editing-error",n)}applyBatchingStyle(e){this.cellComp.toggleCss("ag-cell-editing",e??!1),this.cellComp.toggleCss("ag-cell-batch-edit",(e&&this.editSvc?.isBatchEditing())??!1)}},HJ=class extends Ee{constructor(e,t){super(),this.rowCtrl=e,this.beans=t,this.gos=t.gos,this.editSvc=t.editSvc,this.editModelSvc=t.editModelSvc}applyRowStyles(){const{rowCtrl:e,editModelSvc:t,beans:r}=this;let n=e.rowNode,i=t?.getEditRow(n);const s=this.editModelSvc?.getRowValidationModel().hasRowValidation({rowNode:n});if(!i&&n.pinnedSibling&&(n=n.pinnedSibling,i=t?.getEditRow(n)),i){const o=Array.from(i.keys()).some(a=>{const u={rowNode:n,column:a};return uI(r,u,!0)||hI(r,u)||fI(r,u)});this.applyStyle(s,o);return}this.applyStyle(s)}applyStyle(e=!1,t=!1){const r=this.editSvc?.isBatchEditing()??!1,n=this.gos.get("editType")==="fullRow";this.rowCtrl?.forEachGui(void 0,({rowComp:i})=>{i.toggleCss("ag-row-editing",n&&t),i.toggleCss("ag-row-batch-edit",n&&t&&r),i.toggleCss("ag-row-inline-editing",t),i.toggleCss("ag-row-not-inline-editing",!t),i.toggleCss("ag-row-editing-invalid",n&&t&&e)})}},GJ=({rowModel:e,pinnedRowModel:t,editModelSvc:r},n)=>{const i=new Set;e.forEachNode(s=>n.has(s)&&i.add(s)),t?.forEachPinnedRow("top",s=>n.has(s)&&i.add(s)),t?.forEachPinnedRow("bottom",s=>n.has(s)&&i.add(s));for(const s of n)i.has(s)||r.removeEdits({rowNode:s});return i},VJ=({editModelSvc:e},t,r)=>{for(const n of t)e?.getEditRow(n)?.forEach((i,s)=>!r.has(s)&&e.removeEdits({rowNode:n,column:s}))},zJ=e=>()=>{const t=new Set(e.colModel.getCols()),r=e.editModelSvc.getEditMap(!0),n=new Set(r.keys());VJ(e,GJ(e,n),t)},WJ=new Set(["undo","redo","paste","bulk","rangeSvc"]),UJ=new Set(["ui","api"]),gI={paste:"api",rangeSvc:"api",fillHandle:"api",cellClear:"api",bulk:"api"},$J=new Set(Object.keys(gI)),jJ=new Set(["paste","rangeSvc","renderer","cellClear","redo","undo"]),Ip={cancel:!0,source:"api"},YJ={cancel:!1,source:"api"},pu={checkSiblings:!0},Eh={force:!0,suppressFlash:!0},KJ=class extends Ee{constructor(){super(...arguments),this.beanName="editSvc",this.batch=!1,this.stopping=!1,this.committing=!1}postConstruct(){const{beans:e}=this;this.model=e.editModelSvc,this.valueSvc=e.valueSvc,this.rangeSvc=e.rangeSvc,this.addManagedPropertyListener("editType",({currentValue:n})=>{this.stopEditing(void 0,Ip),this.createStrategy(n)});const t=zJ(e),r=()=>{const n=this.model.getCellValidationModel().getCellValidationMap().size>0,i=this.model.getRowValidationModel().getRowValidationMap().size>0;return n||i?this.stopEditing(void 0,Ip):this.isEditing()&&(this.isBatchEditing()?Bu(e,this.model.getEditPositions()):this.stopEditing(void 0,YJ)),!1};this.addManagedEventListeners({columnPinned:t,columnVisible:t,columnRowGroupChanged:t,rowExpansionStateChanged:t,pinnedRowsChanged:t,displayedRowsChanged:t,sortChanged:r,filterChanged:r,cellFocused:this.onCellFocused.bind(this)})}isBatchEditing(){return this.batch}setBatchEditing(e){e?(this.batch=!0,this.stopEditing(void 0,Ip)):(this.stopEditing(void 0,Ip),this.batch=!1)}createStrategy(e){const{beans:t,gos:r,strategy:n}=this,i=eA(r,e);if(n){if(n.beanName===i)return n;this.destroyStrategy()}return this.strategy=this.createOptionalManagedBean(t.registry.createDynamicBean(i,!0))}destroyStrategy(){this.strategy&&(this.strategy.destroy(),this.strategy=this.destroyBean(this.strategy))}shouldStartEditing(e,t,r,n="ui"){const i=IJ(this.beans,e,t,r,n);return i&&(this.strategy??(this.strategy=this.createStrategy())),i}shouldStopEditing(e,t,r="ui"){return this.strategy?.shouldStop(e,t,r)??null}shouldCancelEditing(e,t,r="ui"){return this.strategy?.shouldCancel(e,t,r)??null}validateEdit(){return cX(this.beans)}isEditing(e,t){return this.model.hasEdits(e,t??pu)}isRowEditing(e,t){return(e&&this.model.hasRowEdits(e,t))??!1}startEditing(e,t){const{startedEdit:r=!0,event:n=null,source:i="ui",ignoreEventKey:s=!1,silent:o}=t;if(this.strategy??(this.strategy=this.createStrategy()),!this.isCellEditable(e,"api"))return;const a=Sr(this.beans,e);if(a&&!a.comp){a.onCompAttachedFuncs.push(()=>this.startEditing(e,t));return}const u=this.shouldStartEditing(e,n,r,i);if(u===!1&&i!=="api"){this.isEditing(e)&&this.stopEditing();return}!this.batch&&this.shouldStopEditing(e,void 0,i)&&!t.continueEditing&&this.stopEditing(void 0,{source:i}),u&&this.isBatchEditing()&&this.dispatchBatchEvent("batchEditingStarted",new Map),this.strategy.start({position:e,event:n,source:i,ignoreEventKey:s,startedEdit:r,silent:o})}stopEditing(e,t){const{event:r,cancel:n,source:i="ui",forceCancel:s,forceStop:o}=t||{},{beans:a,model:u}=this;if($J.has(i)&&this.isBatchEditing())return this.bulkRefresh(e),!1;const d=this.committing?gI[i]:i;if(!(this.committing||this.isEditing(e)||this.isBatchEditing()&&u.hasEdits(e,pu))||!this.strategy||this.stopping)return!1;this.stopping=!0;const g=Sr(a,e);g&&(g.onEditorAttachedFuncs=[]);let m=u.getEditMap(!0),v=!1;const w=!n&&(!!this.shouldStopEditing(e,r,d)||this.committing&&!this.batch)||(o??!1),C=n&&!!this.shouldCancelEditing(e,r,d)||(s??!1);if(w||C){Ol(a,{persist:!0,isCancelling:C||n,isStopping:w});const b=u.getEditMap(),x=this.processEdits(b,n,i);this.strategy?.stop(n,r);for(const R of x)u.clearEditValue(R);this.bulkRefresh(void 0,m);for(const R of u.getEditPositions(b)){const E=Sr(a,R),A=Oo(R);E?.refreshCell({force:!0,suppressFlash:!A})}m=b,v||(v=w)}else if(r instanceof KeyboardEvent&&this.batch&&this.strategy?.midBatchInputsAllowed(e)&&this.isEditing(e,{withOpenEditor:!0})){const{key:b}=r,x=b===me.ENTER,R=b===me.ESCAPE,E=b===me.TAB;(x||E||R)&&(x||E?Ol(a,{persist:!0}):R&&this.revertSingleCellEdit(g),this.isBatchEditing()?this.strategy?.cleanupEditors():Bu(a,u.getEditPositions(),{event:r,cancel:R}),r.preventDefault(),this.bulkRefresh(e,m,{suppressFlash:!0}),m=u.getEditMap())}else Ol(a,{persist:!0}),m=u.getEditMap();return v&&e&&this.model.removeEdits(e),this.navigateAfterEdit(t,g?.cellPosition),Ub(a),this.model.hasEdits()||(this.model.getCellValidationModel().clearCellValidationMap(),this.model.getRowValidationModel().clearRowValidationMap()),this.bulkRefresh(),C&&this.beans.rowRenderer.refreshRows({rowNodes:Array.from(m.keys())}),this.isBatchEditing()&&(this.beans.rowRenderer.refreshRows({suppressFlash:!0,force:!0}),v&&w&&this.dispatchBatchEvent("batchEditingStopped",m)),this.stopping=!1,v}navigateAfterEdit(e,t){if(!e||!t)return;const{event:r,suppressNavigateAfterEdit:n}=e;if(!(r instanceof KeyboardEvent)||n)return;const{key:s,shiftKey:o}=r,a=this.gos.get("enterNavigatesVerticallyAfterEdit");if(s!==me.ENTER||!a)return;const u=o?me.UP:me.DOWN;this.beans.navigation?.navigateToNextCell(null,u,t,!1)}processEdits(e,t=!1,r){const n=Array.from(e.keys()),i=this.model.getCellValidationModel().getCellValidationMap().size>0||this.model.getRowValidationModel().getRowValidationMap().size>0,s=[];for(const o of n){const a=e.get(o);for(const u of a.keys()){const d=a.get(u),h={rowNode:o,column:u},g=Oo(d);!t&&g&&!i&&(this.setNodeDataValue(o,u,d.pendingValue,void 0,r)||s.push(h))}}return s}setNodeDataValue(e,t,r,n,i="edit"){const{beans:s}=this,o=Sr(s,{rowNode:e,column:t}),a=UJ.has(i)?"edit":i;o&&(o.suppressRefreshCell=!0),this.commitNextEdit();const u=e.setDataValue(t,r,a);return o&&(o.suppressRefreshCell=!1),n&&o?.refreshCell(Eh),u}setEditMap(e,t){this.strategy??(this.strategy=this.createStrategy()),this.strategy?.setEditMap(e,t),this.bulkRefresh();let r=Eh;t?.forceRefreshOfEditCellsOnly&&(r={...qJ(e),...Eh}),this.beans.rowRenderer.refreshCells(r)}dispatchEditValuesChanged({rowNode:e,column:t},r={}){if(!e||!t||!r)return;const{pendingValue:n,sourceValue:i}=r,{rowIndex:s,rowPinned:o,data:a}=e;this.beans.eventSvc.dispatchEvent({type:"cellEditValuesChanged",node:e,rowIndex:s,rowPinned:o,column:t,source:"api",data:a,newValue:n,oldValue:i,value:n,colDef:t.getColDef()})}bulkRefresh(e={},t,r={}){const{beans:n,gos:i}=this,{editModelSvc:s,rowModel:o}=n;_r(i)&&(e.rowNode&&e.column?this.refCell(e,this.model.getEdit(e),r):t&&s?.getEditMap(!1)?.forEach((a,u)=>{for(const d of a.keys())this.refCell({rowNode:u,column:d},a.get(d),r)}))}refCell({rowNode:e,column:t},r,n={}){const{beans:i,gos:s}=this,o=new Set([e]),a=new Set,u=e.pinnedSibling;u&&o.add(u);const d=e.sibling;d&&a.add(d);let h=e.parent;for(;h;)h.sibling?.footer&&s.get("groupTotalRow")||!h.parent&&h.sibling&&s.get("grandTotalRow")?a.add(h.sibling):a.add(h),h=h.parent;for(const g of o)this.dispatchEditValuesChanged({rowNode:g,column:t},r);for(const g of o)Sr(i,{rowNode:g,column:t})?.refreshCell(n);for(const g of a)Sr(i,{rowNode:g,column:t})?.refreshCell(n)}stopAllEditing(e=!1,t="ui"){this.isEditing()&&this.stopEditing(void 0,{cancel:e,source:t})}isCellEditable(e,t="ui"){const{rowNode:r}=e,{gos:n,beans:i}=this;if(r.group){if(n.get("treeData")){if(!r.data&&!n.get("enableGroupEdit"))return!1}else if(!n.get("enableGroupEdit"))return!1}const s=eA(n)==="fullRow"?NJ(i,e,t):Xb(i,e,t);return s&&(this.strategy??(this.strategy=this.createStrategy())),s}cellEditingInvalidCommitBlocks(){return this.gos.get("invalidEditValueMode")==="block"}checkNavWithValidation(e,t,r=!0){if(this.hasValidationErrors(e)){const n=Sr(this.beans,e);return this.cellEditingInvalidCommitBlocks()?(t?.preventDefault?.(),r&&(!n?.hasBrowserFocus()&&n?.focusCell(),n?.comp?.getCellEditor()?.focusIn?.()),"block-stop"):(n&&this.revertSingleCellEdit(n),"revert-continue")}return"continue"}revertSingleCellEdit(e,t=!1){const r=Sr(this.beans,e);r?.comp?.getCellEditor()&&(Bu(this.beans,[e],{silent:!0}),this.model.clearEditValue(e),rd(this.beans,e,{silent:!0}),ic(this.beans),r?.refreshCell(Eh),t&&(r?.focusCell(),r?.comp?.getCellEditor()?.focusIn?.()))}hasValidationErrors(e){ic(this.beans);const t=Sr(this.beans,e);t&&(t.refreshCell(Eh),t.rowCtrl.rowEditStyleFeature?.applyRowStyles());let r=!1;return e?.rowNode?(r||(r=this.model.getRowValidationModel().hasRowValidation({rowNode:e.rowNode})),e.column&&(r||(r=this.model.getCellValidationModel().hasCellValidation({rowNode:e.rowNode,column:e.column})))):(r||(r=this.model.getCellValidationModel().getCellValidationMap().size>0),r||(r=this.model.getRowValidationModel().getRowValidationMap().size>0)),r}moveToNextCell(e,t,r,n="ui"){let i;const s=this.isEditing(),o=s&&this.checkNavWithValidation(void 0,r)==="block-stop";return e instanceof Hu&&s&&(i=this.strategy?.moveToNextEditingCell(e,t,r,n,o)),i===null||(i=i||!!this.beans.focusSvc.focusedHeader,i===!1&&!o&&this.stopEditing()),i}getCellDataValue({rowNode:e,column:t},r=!0){if(!e||!t)return;let n=this.model.getEdit({rowNode:e,column:t});const i=e.pinnedSibling;if(i){const o=this.model.getEdit({rowNode:i,column:t});o&&(n=o)}const s=r?n?.editorValue??n?.pendingValue:n?.pendingValue;return s===is||!n?n?.sourceValue??this.valueSvc.getValue(t,e,!1,"api"):s}addStopEditingWhenGridLosesFocus(e){nX(this,this.beans,e)}createPopupEditorWrapper(e){return new LJ(e)}commitNextEdit(){this.committing=!0}setDataValue(e,t,r){try{if((!this.isEditing()||this.committing)&&!jJ.has(r))return;const{beans:n}=this;this.strategy??(this.strategy=this.createStrategy());const i=this.isBatchEditing()?"ui":this.committing?r??"api":"api";if(!r||WJ.has(r))return h0(n,e,t,r,void 0,{persist:!0}),this.setNodeDataValue(e.rowNode,e.column,t,!0,r);const s=this.model.getEdit(e);if(s){if(s.pendingValue===t)return!1;if(s.sourceValue!==t)return h0(n,e,t,r,void 0,{persist:!0}),this.stopEditing(e,{source:i,suppressNavigateAfterEdit:!0}),!0;if(s.sourceValue===t)return n.editModelSvc?.removeEdits(e),this.dispatchEditValuesChanged(e,{...s,pendingValue:t}),!0}return h0(n,e,t,r,void 0,{persist:!0}),this.stopEditing(e,{source:i,suppressNavigateAfterEdit:!0}),!0}finally{this.committing=!1}}handleColDefChanged(e){oX(this.beans,e)}destroy(){this.model.clear(),this.destroyStrategy(),super.destroy()}prepDetailsDuringBatch(e,t){if(!this.batch||!this.model.hasRowEdits(e.rowNode,pu))return;const{rowNode:n,column:i}=e,{compDetails:s,valueToDisplay:o}=t;if(s){const{params:u}=s;return u.data=this.model.getEditRowDataValue(n,pu),{compDetails:s}}const a=this.model.getEditRow(e.rowNode,pu);if(o!==void 0&&a?.has(i))return{valueToDisplay:this.valueSvc.getValue(i,n)}}cleanupEditors(){this.strategy?.cleanupEditors()}dispatchCellEvent(e,t,r,n){this.strategy?.dispatchCellEvent(e,t,r,n)}dispatchBatchEvent(e,t){this.eventSvc.dispatchEvent(this.createBatchEditEvent(e,t))}createBatchEditEvent(e,t){return it(this.gos,{type:e,...e==="batchEditingStopped"?{changes:this.toEventChangeList(t)}:{}})}toEventChangeList(e){return this.model.getEditPositions(e).map(t=>({rowIndex:t.rowNode.rowIndex,rowPinned:t.rowNode.rowPinned,columnId:t.column.getColId(),newValue:t.pendingValue,oldValue:t.sourceValue}))}applyBulkEdit({rowNode:e,column:t},r){if(!r||r.length===0)return;const{beans:n,rangeSvc:i,valueSvc:s}=this;Ol(n,{persist:!0});const o=this.model.getEditMap(!0),a=o.get(e)?.get(t)?.pendingValue;this.batch||this.eventSvc.dispatchEvent({type:"bulkEditingStarted"}),r.forEach(d=>{if(i?.forEachRowInRange(d,h=>{const g=Yo(n,h);if(g===void 0)return;const m=o.get(g)??new Map;for(const v of d.columns)if(v&&this.isCellEditable({rowNode:g,column:v},"api")){const w=s.getValue(v,g,!0,"api");let C=s.parseValue(v,g??null,a,w);Number.isNaN(C)&&(C=null),m.set(v,{editorValue:void 0,pendingValue:C,sourceValue:w,state:"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}m.size>0&&o.set(g,m)}),this.setEditMap(o),this.batch){this.cleanupEditors(),Ub(n),this.bulkRefresh();return}this.commitNextEdit(),this.stopEditing(void 0,{source:"bulk"}),this.eventSvc.dispatchEvent({type:"bulkEditingStopped",changes:this.toEventChangeList(o)})}),this.bulkRefresh();const u=Sr(n,{rowNode:e,column:t});u&&u.focusCell(!0)}createCellStyleFeature(e,t){return new BJ(e,t)}createRowStyleFeature(e,t){return new HJ(e,t)}setEditingCells(e,t){const{beans:r}=this,{colModel:n,valueSvc:i}=r,s=new Map;for(let{colId:o,column:a,colKey:u,rowIndex:d,rowPinned:h,newValue:g,state:m}of e){const v=o?n.getCol(o):u?n.getCol(u):a;if(!v)continue;const w=Yo(r,{rowIndex:d,rowPinned:h});if(!w)continue;const C=i.getValue(v,w,!0,"api");if(!t?.forceRefreshOfEditCellsOnly&&!Oo({pendingValue:g,sourceValue:C})&&m!=="editing")continue;let b=s.get(w);b||(b=new Map,s.set(w,b)),g===void 0&&(g=is),b.set(v,{editorValue:void 0,pendingValue:g,sourceValue:C,state:m??"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}this.setEditMap(s,t)}onCellFocused(e){const t=Sr(this.beans,e);if(!t||!this.isEditing(t,pu))return;const r=this.model.getEdit(t);if(!r||!Oo(r))return;const i=this.getLocaleTextFunc()("ariaPendingChange","Pending Change");this.beans.ariaAnnounce?.announceValue(i,"pendingChange")}allowedFocusTargetOnValidation(e){return Sr(this.beans,e)}};function qJ(e){return{rowNodes:e?Array.from(e.keys()):void 0,columns:e?[...new Set(Array.from(e.values()).flatMap(t=>Array.from(t.keys())))]:void 0}}function eA(e,t){return t??e.get("editType")??"singleCell"}var pI=class extends Ee{postConstruct(){this.model=this.beans.editModelSvc,this.editSvc=this.beans.editSvc,this.addManagedEventListeners({cellFocused:this.onCellFocusChanged?.bind(this),cellFocusCleared:this.onCellFocusChanged?.bind(this)})}clearEdits(e){this.model.clearEditValue(e)}onCellFocusChanged(e){let t;const r=e.previousParams,{editSvc:n,beans:i}=this,s=e.type==="cellFocused"?e.sourceEvent:null;r&&(t=Sr(i,r));const{gos:o,editModelSvc:a}=i,u=e.type==="cellFocusCleared";if(n.isEditing(void 0,{withOpenEditor:!0})){const{column:d,rowIndex:h,rowPinned:g}=e,m={column:d,rowNode:Yo(i,{rowIndex:h,rowPinned:g})},v=o.get("invalidEditValueMode")==="block";if(v)return;const w=!v,C=!!a?.getCellValidationModel().hasCellValidation(m),b=w&&C;(r||u?n.stopEditing(void 0,{cancel:b,source:u&&w?"api":void 0,event:s}):!0)||(n.isBatchEditing()?n.cleanupEditors():n.stopEditing(void 0,{source:"api"}))}t?.refreshCell({suppressFlash:!0,force:!0})}stop(e,t){const r=this.model.getEditPositions(),n={all:[],pass:[],fail:[]};for(const i of r){if(n.all.push(i),(this.model.getCellValidationModel().getCellValidation(i)?.errorMessages?.length??0)>0){n.fail.push(i);continue}n.pass.push(i)}if(e)for(const i of r)W0(this.beans,i,{cancel:e}),this.model.stop(i);else{const i=this.processValidationResults(n);if(i.destroy.length>0)for(const s of i.destroy)W0(this.beans,s,{event:t,cancel:e}),this.model.stop(s);if(i.keep.length>0)for(const s of i.keep){const o=Sr(this.beans,s);this.editSvc?.cellEditingInvalidCommitBlocks()||o&&this.editSvc.revertSingleCellEdit(o)}}return!0}cleanupEditors({rowNode:e}={},t){Ol(this.beans,{persist:!1});const r=this.model.getEditPositions(),n=[];if(e)for(const i of r)i.rowNode!==e&&n.push(i);else for(const i of r)n.push(i);Bu(this.beans,n),Ub(this.beans,t)}setFocusOutOnEditor(e){e.comp?.getCellEditor()?.focusOut?.()}setFocusInOnEditor(e){const t=e.comp,r=t?.getCellEditor();if(r?.focusIn)r.focusIn();else{const n=this.beans.gos.get("editType")==="fullRow";e.focusCell(n),e.onEditorAttachedFuncs.push(()=>t?.getCellEditor()?.focusIn?.())}}setupEditors(e){const{event:t,ignoreEventKey:r=!1,startedEdit:n,position:i,cells:s=this.model.getEditPositions()}=e,o=t instanceof KeyboardEvent&&!r&&t.key||void 0;sX(this.beans,s,i,o,t,n)}dispatchCellEvent(e,t,r,n){const i=Sr(this.beans,e);i&&this.eventSvc.dispatchEvent({...i.createEvent(t??null,r),...n})}dispatchRowEvent(e,t,r){if(r)return;const n=Mx(this.beans,e);n&&this.eventSvc.dispatchEvent(n.createRowEvent(t))}shouldStop(e,t,r="ui"){const n=this.editSvc.isBatchEditing();return n&&r==="api"?!0:n&&(r==="ui"||r==="edit")?!1:r==="api"?!0:t instanceof KeyboardEvent&&!n?t.key===me.ENTER:null}shouldCancel(e,t,r="ui"){const n=this.editSvc.isBatchEditing();return!!(t instanceof KeyboardEvent&&!n&&t.key===me.ESCAPE||n&&r==="api"||r==="api")}setEditMap(e,t){t?.update||this.editSvc.stopEditing(void 0,{cancel:!0,source:"api"});const r=[];if(e.forEach((n,i)=>{n.forEach((s,o)=>{s.state==="editing"&&r.push({...s,rowNode:i,column:o})})}),t?.update&&(e=new Map([...this.model.getEditMap(),...e])),this.model?.setEditMap(e),r.length>0){const n=r.at(-1),i=n.pendingValue===is?void 0:n.pendingValue;this.start({position:n,event:new KeyboardEvent("keydown",{key:i}),source:"api"});const s=Sr(this.beans,n);s&&this.setFocusInOnEditor(s)}}destroy(){this.cleanupEditors(),super.destroy()}},XJ=class extends pI{constructor(){super(...arguments),this.beanName="fullRow",this.startedRows=[]}shouldStop(e,t,r="ui"){const{rowNode:n}=e||{};if(!Mx(this.beans,{rowNode:this.rowNode}))return!0;const s=super.shouldStop({rowNode:this.rowNode},t,r);return s!==null?s:this.rowNode?n!==this.rowNode:!1}midBatchInputsAllowed({rowNode:e}){return e?this.model.hasEdits({rowNode:e}):!1}clearEdits(e){this.model.clearEditValue(e)}start(e){const{position:t,silent:r,startedEdit:n,event:i,ignoreEventKey:s}=e,{rowNode:o}=t;this.rowNode!==o&&super.cleanupEditors(t);const a=this.beans.visibleCols.allCols,u=[],d=[];for(const h of a)h.isCellEditable(o)&&d.push(h);if(d.length!=0){this.dispatchRowEvent({rowNode:o},"rowEditingStarted",r),this.startedRows.push(o);for(const h of d){const g={rowNode:o,column:h};u.push(g),this.model.hasEdits(g)||this.model.start(g)}this.rowNode=o,this.setupEditors({cells:u,position:t,startedEdit:n,event:i,ignoreEventKey:s})}}processValidationResults(e){return e.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:e.all}:{destroy:e.all,keep:[]}}stop(e,t){const{rowNode:r}=this;if(r&&!this.model.hasRowEdits(r))return!1;const n=[];if(e||this.model.getEditMap().forEach((i,s)=>{if(!(!i||i.size===0)){for(const o of i.values())if(Oo(o)){n.push(s);break}}}),ic(this.beans),!e&&this.editSvc?.checkNavWithValidation({rowNode:r})==="block-stop")return!1;super.stop(e,t);for(const i of n)this.dispatchRowEvent({rowNode:i},"rowValueChanged");return this.cleanupEditors({rowNode:r},!0),this.rowNode=void 0,!0}onCellFocusChanged(e){const{rowIndex:t}=e,r=e.previousParams;if(r?.rowIndex===t||e.sourceEvent instanceof KeyboardEvent)return;const n=Sr(this.beans,r);this.gos.get("invalidEditValueMode")==="block"&&n&&(this.model.getCellValidationModel().getCellValidation(n)||this.model.getRowValidationModel().getRowValidation(n))||super.onCellFocusChanged(e)}cleanupEditors(e={},t){super.cleanupEditors(e,t);for(const r of this.startedRows)this.dispatchRowEvent({rowNode:r},"rowEditingStopped");this.startedRows.length=0}moveToNextEditingCell(e,t,r,n="ui",i=!1){const s=e.cellPosition;let o;this.model.suspend(!0);try{o=this.beans.navigation?.findNextCellToFocusOn(s,{backwards:t,startEditing:!0,skipToNextEditableCell:!1})}finally{this.model.suspend(!1)}if(o===!1)return null;if(o==null)return!1;const a=o.cellPosition,u=e.isCellEditable(),d=o.isCellEditable(),h=a&&s.rowIndex===a.rowIndex&&s.rowPinned===a.rowPinned;u&&this.setFocusOutOnEditor(e),this.restoreEditors();const g=this.gos.get("suppressStartEditOnTab");return d&&!i?g?o.focusCell(!0,r):(o.comp?.getCellEditor()||rd(this.beans,o,{event:r,cellStartedEdit:!0}),this.setFocusInOnEditor(o),o.focusCell(!1,r)):(d&&i&&this.setFocusInOnEditor(o),o.focusCell(!0,r)),!h&&!i&&(this.editSvc?.stopEditing({rowNode:e.rowNode},{event:r}),this.cleanupEditors(o,!0),g?o.focusCell(!0,r):this.editSvc.startEditing(o,{startedEdit:!0,event:r,source:n,ignoreEventKey:!0})),e.rowCtrl?.refreshRow({suppressFlash:!0,force:!0}),!0}restoreEditors(){this.model.getEditMap().forEach((e,t)=>e.forEach(({state:r},n)=>{if(r!=="editing")return;const i=Sr(this.beans,{rowNode:t,column:n});i&&!i.comp?.getCellEditor()&&rd(this.beans,i,{silent:!0})}))}destroy(){super.destroy(),this.rowNode=void 0,this.startedRows.length=0}},QJ=class extends pI{constructor(){super(...arguments),this.beanName="singleCell"}shouldStop(e,t,r="ui"){const n=super.shouldStop(e,t,r);if(n!==null)return n;const{rowNode:i,column:s}=e||{};return(!this.rowNode||!this.column)&&i&&s?null:this.rowNode!==i||this.column!==s}midBatchInputsAllowed(e){return this.model.hasEdits(e)}start(e){const{position:t,startedEdit:r,event:n,ignoreEventKey:i}=e;(this.rowNode!==t.rowNode||this.column!==t.column)&&super.cleanupEditors(),this.rowNode=t.rowNode,this.column=t.column,this.model.start(t),this.setupEditors({cells:[t],position:t,startedEdit:r,event:n,ignoreEventKey:i})}dispatchRowEvent(e,t,r){}processValidationResults(e){return e.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:e.all}:{destroy:e.all,keep:[]}}stop(e,t){return super.stop(e,t),this.rowNode=void 0,this.column=void 0,!0}onCellFocusChanged(e){const{colModel:t,editSvc:r}=this.beans,{rowIndex:n,column:i,rowPinned:s}=e,o=Yo(this.beans,{rowIndex:n,rowPinned:s}),a=Wb(i),u=t.getCol(a),d=e.previousParams;if(d){const h=Wb(d.column);if(d?.rowIndex===n&&h===a&&d?.rowPinned===s)return}r?.isEditing({rowNode:o,column:u},{withOpenEditor:!0})&&e.type==="cellFocused"||super.onCellFocusChanged(e)}moveToNextEditingCell(e,t,r,n="ui",i=!1){const s=this.beans.focusSvc.getFocusedCell();s&&(e=Ru(this.beans,s)??e);const o=e.cellPosition;let a;const u=this.beans.gos.get("editType")==="fullRow";u&&this.model.suspend(!0),i||(e.eGui.focus(),this.editSvc?.stopEditing(e,{source:this.editSvc?.isBatchEditing()?"ui":"api",event:r}));try{a=this.beans.navigation?.findNextCellToFocusOn(o,{backwards:t,startEditing:!0})}finally{u&&this.model.suspend(!1)}if(a===!1)return null;if(a==null)return!1;const d=a.cellPosition,h=e.isCellEditable(),g=a.isCellEditable(),m=d&&o.rowIndex===d.rowIndex&&o.rowPinned===d.rowPinned;h&&!i&&this.setFocusOutOnEditor(e);const v=this.gos.get("suppressStartEditOnTab");if(!m&&!i&&(super.cleanupEditors(a,!0),v?a.focusCell(!0,r):this.editSvc.startEditing(a,{startedEdit:!0,event:r,source:n,ignoreEventKey:!0})),g&&!i){if(a.focusCell(!1,r),v)a.focusCell(!0,r);else if(!a.comp?.getCellEditor()){const w=this.editSvc?.isEditing(a,{withOpenEditor:!0});rd(this.beans,a,{event:r,cellStartedEdit:!0,silent:w}),this.setFocusInOnEditor(a),this.cleanupEditors(a)}}else g&&i&&this.setFocusInOnEditor(a),a.focusCell(!0,r);return e.rowCtrl?.refreshRow({suppressFlash:!0,force:!0}),!0}destroy(){super.destroy(),this.rowNode=void 0,this.column=void 0}},il={moduleName:"EditCore",version:Ue,beans:[rX,KJ],apiFunctions:{getEditingCells:TJ,getEditRowValues:RJ,getCellEditorInstances:iX,startEditingCell:AJ,stopEditing:FJ,isEditing:DJ,validateEdit:kJ},dynamicBeans:{singleCell:QJ,fullRow:XJ},dependsOn:[Jm,aI],css:[rJ]},ZJ={moduleName:"UndoRedoEdit",version:Ue,beans:[tJ],apiFunctions:{undoCellEditing:xJ,redoCellEditing:EJ,getCurrentUndoSize:PJ,getCurrentRedoSize:MJ},dependsOn:[il]},JJ={moduleName:"TextEditor",version:Ue,userComponents:{agCellEditor:JD,agTextCellEditor:JD},dependsOn:[il]},eee={moduleName:"NumberEditor",version:Ue,userComponents:{agNumberCellEditor:{classImp:pJ}},dependsOn:[il]},tee={moduleName:"DateEditor",version:Ue,userComponents:{agDateCellEditor:aJ,agDateStringCellEditor:uJ},dependsOn:[il]},ree={moduleName:"CheckboxEditor",version:Ue,userComponents:{agCheckboxCellEditor:iJ},dependsOn:[il]},nee={moduleName:"SelectEditor",version:Ue,userComponents:{agSelectCellEditor:vJ},dependsOn:[il]},iee={moduleName:"LargeTextEditor",version:Ue,userComponents:{agLargeTextCellEditor:hJ},dependsOn:[il]},see={moduleName:"CustomEditor",version:Ue,dependsOn:[il]},oee=class extends Ee{constructor(){super(...arguments),this.beanName="selectionColSvc"}postConstruct(){this.addManagedPropertyListener("rowSelection",e=>{this.onSelectionOptionsChanged(e.currentValue,e.previousValue,_u(e.source))}),this.addManagedPropertyListener("selectionColumnDef",this.updateColumns.bind(this))}addColumns(e){const t=this.columns;t!=null&&(e.list=t.list.concat(e.list),e.tree=t.tree.concat(e.tree),G7(e))}createColumns(e,t){const r=()=>{L0(this.beans,this.columns?.tree),this.columns=null},n=e.treeDepth,s=(this.columns?.treeDepth??-1)==n,o=this.generateSelectionCols();if(H7(o,this.columns?.list??[])&&s)return;r();const{colGroupSvc:u}=this.beans,d=u?.findDepth(e.tree)??0,h=u?.balanceTreeForAutoCols(o,d)??[];this.columns={list:o,tree:h,treeDepth:d,map:{}},t(m=>{if(!m)return null;const v=m.filter(w=>!ea(w));return[...o,...v]})}updateColumns(e){const t=_u(e.source);for(const r of this.columns?.list??[]){const n=this.createSelectionColDef(e.currentValue);r.setColDef(n,null,t),Ss(this.beans,{state:[{...n,colId:r.getColId()}]},t)}}getColumn(e){return this.columns?.list.find(t=>Hh(t,e))??null}getColumns(){return this.columns?.list??null}isSelectionColumnEnabled(){const{gos:e,beans:t}=this,r=e.get("rowSelection");if(typeof r!="object"||!Vl(e))return!1;const n=(t.autoColSvc?.getColumns()?.length??0)>0;if(r.checkboxLocation==="autoGroupColumn"&&n)return!1;const i=!!Mu(r),s=r0(r);return i||s}createSelectionColDef(e){const{gos:t}=this,r=e??t.get("selectionColumnDef"),n=t.get("enableRtl"),{rowSpan:i,spanRows:s,...o}=r??{};return{width:50,resizable:!1,suppressHeaderMenuButton:!0,sortable:!1,suppressMovable:!0,lockPosition:n?"right":"left",comparator(a,u,d,h){const g=d.isSelected(),m=h.isSelected();return g===m?0:g?1:-1},editable:!1,suppressFillHandle:!0,pinned:null,...o,colId:u_,chartDataType:"excluded"}}generateSelectionCols(){if(!this.isSelectionColumnEnabled())return[];const e=this.createSelectionColDef(),t=e.colId;this.gos.validateColDef(e,t,!0);const r=new mc(e,null,t,!1);return this.createBean(r),[r]}onSelectionOptionsChanged(e,t,r){const n=t&&typeof t!="string"?Mu(t):void 0,i=e&&typeof e!="string"?Mu(e):void 0,s=n!==i,o=t&&typeof t!="string"?r0(t):void 0,a=e&&typeof e!="string"?r0(e):void 0,u=o!==a,d=k0(e),h=k0(t);(s||u||d!==h)&&this.beans.colModel.refreshAll(r)}destroy(){L0(this.beans,this.columns?.tree),super.destroy()}refreshVisibility(e,t,r){if(!this.columns?.list.length)return;const n=e.length+t.length+r.length;if(n===0)return;const i=this.columns.list[0];if(!i.isVisible())return;const s=()=>{let u;switch(i.pinned){case"left":case!0:u=e;break;case"right":u=r;break;default:u=t}u&&Ds(u,i)};(this.beans.rowNumbersSvc?.getColumn(d_)?2:1)===n&&s()}};function aee(e,t){if(!t.nodes.every(o=>o.rowPinned&&!$f(o)?(Me(59),!1):o.id===void 0?(Me(60),!1):!0))return;const{nodes:n,source:i,newValue:s}=t;e.selectionSvc?.setNodesSelected({nodes:n,source:i??"api",newValue:s})}function lee(e,t,r="apiSelectAll"){e.selectionSvc?.selectAllRowNodes({source:r,selectAll:t})}function cee(e,t,r="apiSelectAll"){e.selectionSvc?.deselectAllRowNodes({source:r,selectAll:t})}function uee(e,t="apiSelectAllFiltered"){e.selectionSvc?.selectAllRowNodes({source:t,selectAll:"filtered"})}function dee(e,t="apiSelectAllFiltered"){e.selectionSvc?.deselectAllRowNodes({source:t,selectAll:"filtered"})}function hee(e,t="apiSelectAllCurrentPage"){e.selectionSvc?.selectAllRowNodes({source:t,selectAll:"currentPage"})}function fee(e,t="apiSelectAllCurrentPage"){e.selectionSvc?.deselectAllRowNodes({source:t,selectAll:"currentPage"})}function gee(e){return e.selectionSvc?.getSelectedNodes()??[]}function pee(e){return e.selectionSvc?.getSelectedRows()??[]}var mee=class extends U${constructor(){super(...arguments),this.beanName="selectionSvc",this.selectedNodes=new Map,this.detailSelection=new Map,this.masterSelectsDetail=!1}postConstruct(){super.postConstruct();const{gos:e}=this;this.mode=P0(e),this.groupSelectsDescendants=df(e),this.groupSelectsFiltered=_0(e)==="filteredDescendants",this.masterSelectsDetail=$F(e)==="detail",this.addManagedPropertyListeners(["groupSelectsChildren","groupSelectsFiltered","rowSelection"],()=>{const t=df(e),r=P0(e),n=_0(e)==="filteredDescendants";this.masterSelectsDetail=$F(e)==="detail",(t!==this.groupSelectsDescendants||n!==this.groupSelectsFiltered||r!==this.mode)&&(this.deselectAllRowNodes({source:"api"}),this.groupSelectsDescendants=t,this.groupSelectsFiltered=n,this.mode=r)}),this.addManagedEventListeners({rowSelected:this.onRowSelected.bind(this)})}destroy(){super.destroy(),this.resetNodes()}handleSelectionEvent(e,t,r){if(this.isRowSelectionBlocked(t))return 0;const n=this.inferNodeSelections(t,e.shiftKey,e.metaKey||e.ctrlKey,r);if(n==null)return 0;if(this.selectionCtx.selectAll=!1,"select"in n)return n.reset?this.resetNodes():this.selectRange(n.deselect,!1,r),this.selectRange(n.select,!0,r);{const i=n.checkFilteredNodes?vI(n.node):n.newValue;return this.setNodesSelected({nodes:[n.node],newValue:i,clearSelection:n.clearSelection,keepDescendants:n.keepDescendants,event:e,source:r})}}setNodesSelected({newValue:e,clearSelection:t,suppressFinishActions:r,nodes:n,event:i,source:s,keepDescendants:o=!1}){if(n.length===0)return 0;const{gos:a}=this;if(!Vl(a)&&e)return Me(132),0;if(n.length>1&&!this.isMultiSelect())return Me(130),0;let u=0;for(let d=0;d<n.length;d++){const h=n[d],g=mu(h);if(g.rowPinned&&!$f(g)){Me(59);continue}if(g.id===void 0){Me(60);continue}this.groupSelectsFiltered&&g.group&&!a.get("treeData")||this.selectRowNode(g,e,i,s)&&(this.detailSelection.delete(g.id),u++),this.groupSelectsDescendants&&g.childrenAfterGroup?.length&&(u+=this.selectChildren(g,e,s))}return r||(n.length===1&&s==="api"&&this.selectionCtx.setRoot(mu(n[0])),e&&(t||!this.isMultiSelect())&&(u+=this.clearOtherNodes(mu(n[0]),o,s)),u>0&&(this.updateGroupsFromChildrenSelections(s),this.dispatchSelectionChanged(s))),u}selectRange(e,t,r){let n=0;return e.forEach(i=>{const s=mu(i);if(s.group&&this.groupSelectsDescendants)return;this.selectRowNode(s,t,void 0,r)&&n++}),n>0&&(this.updateGroupsFromChildrenSelections(r),this.dispatchSelectionChanged(r)),n}selectChildren(e,t,r){const n=this.groupSelectsFiltered?e.childrenAfterAggFilter:e.childrenAfterGroup;return n?this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,source:r,nodes:n}):0}getSelectedNodes(){return Array.from(this.selectedNodes.values())}getSelectedRows(){const e=[];return this.selectedNodes.forEach(t=>t.data&&e.push(t.data)),e}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(e){const t=new Map;this.selectedNodes.forEach((r,n)=>{e(r)&&t.set(n,r)}),this.selectedNodes=t}updateGroupsFromChildrenSelections(e,t){if(!this.groupSelectsDescendants)return!1;const{gos:r,rowModel:n}=this.beans;if(!_r(r))return!1;const i=n.rootNode;if(!i)return!1;t||(t=new gf(!0,i),t.active=!1);let s=!1;return t.forEachChangedNodeDepthFirst(o=>{if(o!==i){const a=this.calculateSelectedFromChildren(o);s=this.selectRowNode(o,a===null?!1:a,void 0,e)||s}}),s}clearOtherNodes(e,t,r){const n=new Map;let i=0;return this.selectedNodes.forEach(s=>{const o=s.id==e.id;if((t?!wee(e,s):!0)&&!o){const u=this.selectedNodes.get(s.id);i+=this.setNodesSelected({nodes:[u],newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:r}),this.groupSelectsDescendants&&s.parent&&n.set(s.parent.id,s.parent)}}),n.forEach(s=>{const o=this.calculateSelectedFromChildren(s);this.selectRowNode(s,o===null?!1:o,void 0,r)}),i}onRowSelected(e){const t=e.node;this.groupSelectsDescendants&&t.group||(t.isSelected()?this.selectedNodes.set(t.id,t):this.selectedNodes.delete(t.id))}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}createDaemonNode(e){if(!e.id)return;const t=new Ka(this.beans);return t.id=e.id,t.data=e.data,t.__selected=e.__selected,t.level=e.level,t}syncInOldRowNode(e,t){t&&e.id!==t.id&&this.selectedNodes.get(t.id)==e&&this.selectedNodes.set(t.id,t)}syncInNewRowNode(e){this.selectedNodes.has(e.id)?(e.__selected=!0,this.selectedNodes.set(e.id,e)):e.__selected=!1}reset(e){const t=this.getSelectionCount();this.resetNodes(),t&&this.dispatchSelectionChanged(e)}resetNodes(){this.selectedNodes.forEach(e=>{this.selectRowNode(e,!1)}),this.selectedNodes.clear()}getBestCostNodeSelection(){const{gos:e,rowModel:t}=this.beans;if(!_r(e))return;const r=t.getTopLevelNodes();if(r===null)return;const n=[];function i(s){for(let o=0,a=s.length;o<a;o++){const u=s[o];u.isSelected()?n.push(u):u.group&&u.childrenAfterGroup&&i(u.childrenAfterGroup)}}return i(r),n}isEmpty(){return this.getSelectionCount()===0}deselectAllRowNodes({source:e,selectAll:t}){const r=_r(this.gos);let n=!1;const i=s=>{const o=this.selectRowNode(mu(s),!1,void 0,e);n||(n=o)};if(t==="currentPage"||t==="filtered"){if(!r){Zt(102);return}this.getNodesToSelect(t).forEach(i)}else this.selectedNodes.forEach(i),this.reset(e);if(this.selectionCtx.selectAll=!1,r&&this.groupSelectsDescendants){const s=this.updateGroupsFromChildrenSelections(e);n||(n=s)}n&&this.dispatchSelectionChanged(e)}getSelectedCounts(e){let t=0,r=0;return this.getNodesToSelect(e).forEach(n=>{this.groupSelectsDescendants&&n.group||(n.isSelected()?t++:n.selectable&&r++)}),{selectedCount:t,notSelectedCount:r}}getSelectAllState(e){const{selectedCount:t,notSelectedCount:r}=this.getSelectedCounts(e);return mI(t,r)??null}hasNodesToSelect(e){return this.getNodesToSelect(e).filter(t=>t.selectable).length>0}getNodesToSelect(e){if(!this.canSelectAll())return[];const t=[],r=i=>t.push(i);if(e==="currentPage")return this.forEachNodeOnPage(i=>{if(!i.group){r(i);return}if(!i.expanded&&!i.footer){const s=o=>{r(o),o.childrenAfterFilter?.forEach(s)};s(i);return}this.groupSelectsDescendants||r(i)}),t;const n=this.beans.rowModel;return e==="filtered"?(n.forEachNodeAfterFilter(r),t):(n.forEachNode(r),t)}forEachNodeOnPage(e){const{pageBounds:t,rowModel:r}=this.beans,n=t.getFirstRow(),i=t.getLastRow();for(let s=n;s<=i;s++){const o=r.getRow(s);o&&e(o)}}selectAllRowNodes(e){const{gos:t,selectionCtx:r}=this;if(!Vl(t)){Me(132);return}if(E7(t)&&!M0(t)){Me(130);return}if(!this.canSelectAll())return;const{source:n,selectAll:i}=e;let s=!1;if(this.getNodesToSelect(i).forEach(o=>{const a=this.selectRowNode(mu(o),!0,void 0,n);s||(s=a)}),r.selectAll=!0,_r(t)&&this.groupSelectsDescendants){const o=this.updateGroupsFromChildrenSelections(n);s||(s=o)}s&&this.dispatchSelectionChanged(n)}getSelectionState(){return this.isEmpty()?null:Array.from(this.selectedNodes.keys())}setSelectionState(e,t,r){if(e||(e=[]),!Array.isArray(e)){Zt(103);return}const n=new Set(e),i=[];this.beans.rowModel.forEachNode(s=>{n.has(s.id)&&i.push(s)}),r&&this.resetNodes(),this.setNodesSelected({newValue:!0,nodes:i,source:t})}canSelectAll(){return _r(this.beans.gos)}updateSelectable(e){const{gos:t,rowModel:r}=this.beans;if(!Vl(t))return;const n="selectableChanged",i=e!==void 0,s=_r(t)&&this.groupSelectsDescendants,o=[],a=u=>{if(i&&!u.group)return;if(s&&u.group){const h=u.childrenAfterGroup?.some(g=>g.selectable)??!1;this.setRowSelectable(u,h,!0);return}!this.updateRowSelectable(u,!0)&&u.isSelected()&&o.push(u)};if(s){if(e===void 0){const u=r.rootNode;e=u?new gf(!1,u):void 0}e?.forEachChangedNodeDepthFirst(a,!i,!i)}else r.forEachNode(a);o.length&&this.setNodesSelected({nodes:o,newValue:!1,source:n}),!i&&s&&this.updateGroupsFromChildrenSelections?.(n)}updateSelectableAfterGrouping(e){this.updateSelectable(e),this.groupSelectsDescendants&&this.updateGroupsFromChildrenSelections?.("rowGroupChanged",e)&&this.dispatchSelectionChanged("rowGroupChanged")}refreshMasterNodeState(e,t){if(!this.masterSelectsDetail)return;const r=e.detailNode?.detailGridInfo?.api;if(!r)return;const n=vee(r);if(e.isSelected()!==n&&this.selectRowNode(e,n,t,"masterDetail")&&this.dispatchSelectionChanged("masterDetail"),!n){const s=this.detailSelection.get(e.id)??new Set;for(const o of r.getSelectedNodes())s.add(o.id);this.detailSelection.set(e.id,s)}}setDetailSelectionState(e,t,r){if(this.masterSelectsDetail){if(!M0(t)){Me(269);return}switch(e.isSelected()){case!0:{r.selectAll();break}case!1:{r.deselectAll();break}case void 0:{const n=this.detailSelection.get(e.id);if(n){const i=[];for(const s of n){const o=r.getRowNode(s);o&&i.push(o)}r.setNodesSelected({nodes:i,newValue:!0,source:"masterDetail"})}break}}}}dispatchSelectionChanged(e){this.eventSvc.dispatchEvent({type:"selectionChanged",source:e,selectedNodes:this.getSelectedNodes(),serverSideState:null})}};function mu(e){return $f(e)?e.pinnedSibling:e.footer?e.sibling:e}function vee(e){let t=0,r=0;return e.forEachNode(n=>{n.isSelected()?t++:n.selectable&&r++}),mI(t,r)}function mI(e,t){if(e===0&&t===0)return!1;if(!(e>0&&t>0))return e>0}function wee(e,t){let r=t.parent;for(;r;){if(r===e)return!0;r=r.parent}return!1}function vI(e){const t=e.isSelected()===!1,r=e.childrenAfterFilter?.some(vI)??!1;return t||r}var Cee={moduleName:"SharedRowSelection",version:Ue,beans:[oee],apiFunctions:{setNodesSelected:aee,selectAll:lee,deselectAll:cee,selectAllFiltered:uee,deselectAllFiltered:dee,selectAllOnCurrentPage:hee,deselectAllOnCurrentPage:fee,getSelectedNodes:gee,getSelectedRows:pee}},yee={moduleName:"RowSelection",version:Ue,rowModels:["clientSide","infinite","viewport"],beans:[mee],dependsOn:[Cee]};function bee(e){e.expansionSvc?.expandAll(!0)}function See(e){e.expansionSvc?.expandAll(!1)}function wI(e){e.rowModel?.onRowHeightChanged()}function CI(e){if(e.rowAutoHeight?.active){Me(3);return}e.rowModel?.resetRowHeights()}function xee(e,t,r){const n=xQ(e);if(n){if(e.rowGroupColsSvc?.columns.length===0){if(t<0){Zt(238);return}n.setRowCount(t,r);return}Zt(28);return}Zm(e)?.setRowCount(t,r)}function Eee(e){return pc(e.gos)?e.rowModel.getBlockStates():e.rowNodeBlockLoader?.getBlockState()??{}}function Ree(e){return e.rowModel.isLastRowIndexKnown()}var Tee={moduleName:"CsrmSsrmSharedApi",version:Ue,apiFunctions:{expandAll:bee,collapseAll:See}},Fee={moduleName:"RowModelSharedApi",version:Ue,apiFunctions:{onRowHeightChanged:wI,resetRowHeights:CI}},Dee={moduleName:"SsrmInfiniteSharedApi",version:Ue,apiFunctions:{setRowCount:xee,getCacheBlockState:Eee,isLastRowIndexKnown:Ree}},Aee=class extends Ee{constructor(){super(...arguments),this.beanName="alignedGridsSvc",this.consuming=!1}getAlignedGridApis(){let e=this.gos.get("alignedGrids")??[];const t=typeof e=="function";return typeof e=="function"&&(e=e()),e.map(n=>{if(!n){Zt(18),t||Zt(20);return}if(this.isGridApi(n))return n;const i=n;return"current"in i?i.current?.api:(i.api||Zt(19),i.api)}).filter(n=>!!n&&!n.isDestroyed())}isGridApi(e){return!!e&&!!e.dispatchEvent}postConstruct(){const e=this.fireColumnEvent.bind(this);this.addManagedEventListeners({columnMoved:e,columnVisible:e,columnPinned:e,columnGroupOpened:e,columnResized:e,bodyScroll:this.fireScrollEvent.bind(this),alignedGridColumn:({event:t})=>this.onColumnEvent(t),alignedGridScroll:({event:t})=>this.onScrollEvent(t)})}fireEvent(e){if(!this.consuming)for(const t of this.getAlignedGridApis())t.isDestroyed()||t.dispatchEvent(e)}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(e){this.fireEvent({type:"alignedGridColumn",event:e})}fireScrollEvent(e){e.direction==="horizontal"&&this.fireEvent({type:"alignedGridScroll",event:e})}onScrollEvent(e){this.onEvent(()=>{this.beans.ctrlsSvc.getScrollFeature().setHorizontalScrollPosition(e.left,!0)})}extractDataFromEvent(e,t){const r=[];return e.columns?e.columns.forEach(n=>{r.push(t(n))}):e.column&&r.push(t(e.column)),r}getMasterColumns(e){return this.extractDataFromEvent(e,t=>t)}getColumnIds(e){return this.extractDataFromEvent(e,t=>t.getColId())}onColumnEvent(e){this.onEvent(()=>{switch(e.type){case"columnMoved":case"columnVisible":case"columnPinned":case"columnResized":{this.processColumnEvent(e);break}case"columnGroupOpened":{this.processGroupOpenedEvent(e);break}case"columnPivotChanged":Me(21);break}})}processGroupOpenedEvent(e){const{colGroupSvc:t}=this.beans;if(t)for(const r of e.columnGroups){let n=null;r&&(n=t.getProvidedColGroup(r.getGroupId())),!(r&&!n)&&t.setColumnGroupOpened(n,r.isExpanded(),"alignedGridChanged")}}processColumnEvent(e){const t=e.column;let r=null;const n=this.beans,{colResize:i,ctrlsSvc:s,colModel:o}=n;if(t&&(r=o.getColDefCol(t.getColId())),t&&!r)return;const a=this.getMasterColumns(e);switch(e.type){case"columnMoved":{const g=e.api.getColumnState().map(m=>({colId:m.colId}));Ss(n,{state:g,applyOrder:!0},"alignedGridChanged")}break;case"columnVisible":{const g=e.api.getColumnState().map(m=>({colId:m.colId,hide:m.hide}));Ss(n,{state:g},"alignedGridChanged")}break;case"columnPinned":{const g=e.api.getColumnState().map(m=>({colId:m.colId,pinned:m.pinned}));Ss(n,{state:g},"alignedGridChanged")}break;case"columnResized":{const h=e,g={};for(const m of a)g[m.getId()]={key:m.getColId(),newWidth:m.getActualWidth()};for(const m of h.flexColumns??[])g[m.getId()]&&delete g[m.getId()];i?.setColumnWidths(Object.values(g),!1,h.finished,"alignedGridChanged");break}}const d=s.getGridBodyCtrl().isVerticalScrollShowing();for(const h of this.getAlignedGridApis())h.setGridOption("alwaysShowVerticalScroll",d)}},kee={moduleName:"AlignedGrids",version:Ue,beans:[Aee],dependsOn:[RL]},Pee=class extends Ee{constructor(e){super(),this.rootNode=e,this.nextId=0,this.allNodesMap={},tA(e)}getRowNode(e){return this.allNodesMap[e]}setNewRowData(e){const{selectionSvc:t,pinnedRowModel:r,groupStage:n}=this.beans;t?.reset("rowDataChanged"),r?.isManual()&&r.reset(),this.dispatchRowDataUpdateStarted(e),this.allNodesMap=Object.create(null),this.nextId=0;const i=tA(this.rootNode),s=new Array(e.length);i._leafs=s;let o=0;const a=n?.getNestedDataGetter(),u=a?new Set:null,d=(h,g)=>{const m=h.level+1;for(let v=0,w=g.length;v<w;++v){const C=g[v];if(!C)continue;const b=this.createRowNode(C,m);if(b.sourceRowIndex=o,s[o++]=b,u&&!u.has(C)){u.add(C),b.treeParent=h;const x=a(C);x&&d(b,x)}}};d(i,e),s.length=o}setImmutableRowData(e,t){const{rootNode:r,gos:n}=this;this.dispatchRowDataUpdateStarted(t);const i=Zu(n),s=e.changedRowNodes,{adds:o,updates:a}=s,u=new Set,d=[],h=this.beans.groupStage?.getNestedDataGetter();let g=n.get("suppressMaintainUnsortedOrder")?void 0:!1,m=-1,v=!1;const w=(x,R)=>{if(!g&&g!==void 0){const E=x.sourceRowIndex;g=E<=m,m=E}x.data!==R&&(x.updateData(R),o.has(x)||a.add(x),!x.selectable&&x.isSelected()&&d.push(x))},C=(x,R,E)=>{for(let A=0,D=R.length;A<D;++A){const M=R[A];if(!M)continue;let F=this.getRowNode(i({data:M,level:E}));if(F?(w(F,M),v||(v=!!h&&F.treeParent!==x)):(F=this.createRowNode(M,E),o.add(F)),!h||u.has(F)){u.add(F);continue}u.add(F),F.treeParent=x;const O=h(M);O&&C(F,O,E+1)}};C(r,t,0);const b=this.deleteUnusedNodes(u,s,d)||g||o.size>0;if(b){const x=r._leafs??(r._leafs=[]);g===void 0?Oee(x,u,s):Iee(x,u)&&(s.reordered=!0)}(b||v||a.size)&&(e.rowDataUpdated=!0,this.deselect(d))}deleteUnusedNodes(e,{removals:t},r){const n=this.rootNode._leafs;for(let i=0,s=n.length;i<s;i++){const o=n[i];e.has(o)||(t.add(o),o.isSelected()&&r.push(o),this.deleteNode(o))}return t.size>0}updateRowData(e,t){if(this.dispatchRowDataUpdateStarted(e.add),this.beans.groupStage?.getNestedDataGetter())return Me(268),{remove:[],update:[],add:[]};const r=[],n=Zu(this.gos),i=this.executeRemove(n,e,t,r),s=this.executeUpdate(n,e,t,r),o=this.executeAdd(e,t);return this.deselect(r),{remove:i,update:s,add:o}}executeRemove(e,{remove:t},{adds:r,updates:n,removals:i},s){const o=this.rootNode._leafs,a=o?.length,u=t?.length;if(!u||!a)return[];let d=0,h=a,g=0,m;const v=new Array(u);for(let w=0;w<u;++w){const C=this.lookupNode(e,t[w]);if(!C)continue;const b=C.sourceRowIndex;b<h&&(h=b),b>g&&(g=b),C.isSelected()&&s.push(C),this.deleteNode(C),r.delete(C)?(m??(m=new Set),m.add(C)):(n.delete(C),i.add(C)),v[d++]=C}return v.length=d,d&&Lee(o,h,g,i,m),v}executeUpdate(e,{update:t},{adds:r,updates:n},i){const s=t?.length;if(!s)return[];const o=new Array(s);let a=0;for(let u=0;u<s;u++){const d=t[u],h=this.lookupNode(e,d);h&&(h.updateData(d),!h.selectable&&h.isSelected()&&i.push(h),o[a++]=h,r.has(h)||n.add(h))}return o.length=a,o}executeAdd(e,t){var r;const n=(r=this.rootNode)._leafs??(r._leafs=[]),i=n.length,s=e.add,o=s?.length;if(!o)return[];const a=i+o;let u=this.sanitizeAddIndex(n,e.addIndex);if(u<i){for(let g=i-1,m=a-1;g>=u;--g){const v=n[g];v.sourceRowIndex=m,n[m--]=v}t.reordered=!0}n.length=a;const d=new Array(o),h=t.adds;for(let g=0;g<o;g++){const m=this.createRowNode(s[g],0);h.add(m),m.sourceRowIndex=u,n[u]=m,d[g]=m,u++}return d}dispatchRowDataUpdateStarted(e){this.eventSvc.dispatchEvent({type:"rowDataUpdateStarted",firstRowData:e?.length?e[0]:null})}deselect(e){const t="rowDataChanged",r=this.beans.selectionSvc;e.length&&r?.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t}),r?.updateGroupsFromChildrenSelections?.(t),e.length&&this.eventSvc.dispatchEvent({type:"selectionChanged",source:t,selectedNodes:r?.getSelectedNodes()??null,serverSideState:null})}createRowNode(e,t){const r=new Ka(this.beans);r.parent=this.rootNode,r.level=t,r.group=!1,r.expanded=!1,r.setDataAndId(e,String(this.nextId++));const n=r.id,i=this.allNodesMap;return i[n]&&Me(2,{nodeId:n}),i[n]=r,r}deleteNode(e){e.clearRowTopAndRowIndex();const t=e.id,r=this.allNodesMap;r[t]===e&&delete r[t];const n=e.pinnedSibling;n&&this.beans.pinnedRowModel?.pinRow(n,null)}lookupNode(e,t){if(!e)return _ee(this.rootNode._leafs,t);const r=e({data:t,level:0}),n=this.allNodesMap[r];return n||(Zt(4,{id:r}),null)}sanitizeAddIndex(e,t){const r=e.length;if(typeof t!="number"||t<0||t>=r||Number.isNaN(t))return r;t=Math.ceil(t);const n=this.gos;return t>0&&n.get("treeData")&&n.get("getDataPath")&&(t=Mee(e,t)),t}},Mee=(e,t)=>{for(let r=0,n=e.length;r<n;r++)if(e[r]?.rowIndex==t-1)return r+1;return t},tA=e=>{e.group=!0,e.level=-1,e.id="ROOT_NODE_ID",e._leafs?.length!==0&&(e._leafs=[]);const t=[],r=[],n=[],i=[];e.childrenAfterGroup=t,e.childrenAfterSort=r,e.childrenAfterAggFilter=n,e.childrenAfterFilter=i;const s=e.sibling;return s&&(s.childrenAfterGroup=t,s.childrenAfterSort=r,s.childrenAfterAggFilter=n,s.childrenAfterFilter=i,s.childrenMapped=e.childrenMapped),e.updateHasChildren(),e},_ee=(e,t)=>{if(e)for(let r=0,n=e.length;r<n;r++){const i=e[r];if(i.data===t)return i}return Zt(5,{data:t}),null},Lee=(e,t,r,n,i)=>{t=Math.max(0,t);for(let s=t,o=e.length;s<o;++s){const a=e[s];s<=r&&(n.has(a)||i?.has(a))||(a.sourceRowIndex=t,e[t++]=a)}e.length=t},Iee=(e,t)=>{const r=t.size;e.length=r;let n=0,i=!1,s=!1;for(const o of t){const a=o.sourceRowIndex;a===n?s||(s=i):(a>=0?s=!0:i=!0,o.sourceRowIndex=n,e[n]=o),++n}return s},Oee=(e,t,{removals:r,adds:n})=>{const i=e.length;e.length=t.size;let s=0;for(let o=0;o<i;++o){const a=e[o];r.has(a)||(s!==o&&(a.sourceRowIndex=s,e[s]=a),++s)}for(const o of n)o.sourceRowIndex<0&&(o.sourceRowIndex=s,e[s++]=o);e.length=s},yI=e=>{const t=e.childrenAfterSort,r=e.sibling;if(r&&(r.childrenAfterSort=t),!!t)for(let n=0,i=t.length-1;n<=i;n++){const s=t[n],o=n===0,a=n===i;s.firstChild!==o&&(s.firstChild=o,s.dispatchRowEvent("firstChildChanged")),s.lastChild!==a&&(s.lastChild=a,s.dispatchRowEvent("lastChildChanged")),s.childIndex!==n&&(s.childIndex=n,s.dispatchRowEvent("childIndexChanged"))}},Nee=class extends Ee{constructor(){super(...arguments),this.beanName="sortStage",this.step="sort",this.refreshProps=["postSortRows","groupDisplayType","accentedSort"]}execute(e){const t=this.beans.sortSvc.getSortOptions(),r=t.length>0&&!!e.changedRowNodes&&this.gos.get("deltaSort");this.sort(t,r,e.changedRowNodes,e.changedPath)}sort(e,t,r,n){const{gos:i,colModel:s,rowGroupColsSvc:o,rowNodeSorter:a,rowRenderer:u,showRowGroupCols:d}=this.beans,h=i.get("groupMaintainOrder"),g=s.getCols().some(R=>R.isRowGroupActive()),m=o?.columns,v=s.isPivotMode(),w=i.getCallback("postSortRows");let C=!1,b;const x=R=>{const E=v&&R.leafGroup;let A=h&&g&&!R.leafGroup;A&&(b??(b=this.shouldSortContainsGroupCols(e)),A&&(A=!b));let D=null;if(A){let M=!1;if(m){const F=R.level+1;F<m.length&&(M=m[F].getSort()===null)}M||(D=Gee(R))}else!e.length||E||(t&&r?D=Bee(a,R,r,n,e):D=a.doFullSort(R.childrenAfterAggFilter,e));if(D||(D=R.childrenAfterAggFilter?.slice(0)??[]),C||(C=R.childrenAfterSort?.[0]!==D[0]),R.childrenAfterSort=D,yI(R),w){const M={nodes:R.childrenAfterSort};w(M)}};if(n?.forEachChangedNodeDepthFirst(x),C&&i.get("groupHideOpenParents")){const R=d?.getShowRowGroupCols();R?.length&&u.refreshCells({columns:R,force:!0})}}shouldSortContainsGroupCols(e){const t=e.length;if(!t)return!1;if(Ys(this.gos)){for(let r=0;r<t;++r){const n=e[r].column;if(n.isPrimary()&&n.isRowGroupActive())return!0}return!1}for(let r=0;r<t;++r)if(e[r].column.getColDef().showRowGroup)return!0;return!1}},Bee=(e,t,r,n,i)=>{const s=t.childrenAfterAggFilter,o=t.childrenAfterSort;if(!o)return e.doFullSort(s,i);const a=new Set,u=[],{updates:d,adds:h}=r;for(let m=0,v=s.length;m<v;++m){const w=s[m];d.has(w)||h.has(w)||n&&!n.canSkip(w)?u.push({currentPos:u.length,rowNode:w}):a.add(w)}const g=o.filter(m=>a.has(m)).map((m,v)=>({currentPos:v,rowNode:m}));return u.sort((m,v)=>e.compareRowNodes(i,m,v)),Hee(e,i,u,g)},Hee=(e,t,r,n)=>{let i=0,s=0;const o=r.length,a=n.length,u=new Array(o+a);let d=0;for(;i<o&&s<a;){const h=r[i],g=n[s];e.compareRowNodes(t,h,g)<0?(u[d++]=h.rowNode,++i):(u[d++]=g.rowNode,++s)}for(;i<o;)u[d++]=r[i++].rowNode;for(;s<a;)u[d++]=n[s++].rowNode;return u},Gee=e=>{const t=e.childrenAfterSort,r=e.childrenAfterAggFilter,n=t?.length,i=r?.length;if(!n||!i)return null;const s=new Array(i),o=new Set;for(let u=0;u<i;++u)o.add(r[u]);let a=0;for(let u=0;u<n;++u){const d=t[u];o.delete(d)&&(s[a++]=d)}if(o.size===0&&a===n)return t;for(const u of o)s[a++]=u;return s.length=a,s},Vee=class extends Ee{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null,this.rowCountReady=!1,this.nodeManager=void 0,this.rowsToDisplay=[],this.rowDataUpdatedPending=!1,this.asyncTransactions=null,this.asyncTransactionsTimer=0,this.started=!1,this.refreshingModel=!1,this.rowNodesCountReady=!1,this.stages=[],this.stagesRefreshProps=new Map,this.onRowHeightChanged_debounced=yn(this,this.onRowHeightChanged.bind(this),100)}postConstruct(){const e=this.beans,t=new Ka(e);this.rootNode=t,this.nodeManager=this.createBean(new Pee(t));const r=this.refreshModel.bind(this,{step:"group"}),n=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame")});this.addManagedEventListeners({newColumnsLoaded:n,columnRowGroupChanged:r,columnValueChanged:this.onValueChanged.bind(this),columnPivotChanged:this.refreshModel.bind(this,{step:"pivot"}),filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),columnPivotModeChanged:r,gridStylesChanged:this.onGridStylesChanges.bind(this),gridReady:this.onGridReady.bind(this),rowExpansionStateChanged:this.onRowGroupOpened.bind(this)}),this.addPropertyListeners()}addPropertyListeners(){const{beans:e,stagesRefreshProps:t}=this,r=[e.groupStage,e.filterStage,e.pivotStage,e.aggStage,e.sortStage,e.filterAggStage,e.flattenStage].filter(n=>!!n);this.stages=r;for(let n=r.length-1;n>=0;--n)for(const i of r[n].refreshProps)t.set(i,n);this.addManagedPropertyListeners([...t.keys()],n=>{const i=n.changeSet?.properties;i&&this.onPropChange(i)}),this.addManagedPropertyListener("rowData",()=>this.onPropChange(["rowData"])),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.started=!0,this.rowNodesCountReady?this.refreshModel({step:"group",rowDataUpdated:!0,newData:!0}):this.setInitialData()}setInitialData(){this.gos.get("rowData")&&this.onPropChange(["rowData"])}ensureRowHeightsValid(e,t,r,n){let i,s=!1;do{i=!1;const o=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),u=Math.max(o,r),d=Math.min(a,n);for(let h=u;h<=d;h++){const g=this.getRow(h);if(g.rowHeightEstimated){const m=$a(this.beans,g);g.setRowHeight(m.height),i=!0,s=!0}}i&&this.setRowTopAndRowIndex()}while(i);return s}onPropChange(e){const{nodeManager:t,gos:r,beans:n}=this,i=n.groupStage;if(!t)return;const s=new Set(e),o=i?.onPropChange(s);let a;s.has("rowData")?a=r.get("rowData"):o&&(a=i?.extractData()),a&&!Array.isArray(a)&&(a=null,Me(1));const u={step:"nothing",changedProps:s};a&&(!o&&!this.isEmpty()&&a.length>0&&r.exists("getRowId")&&!r.get("resetRowDataOnUpdate")?(u.keepRenderedRows=!0,u.animate=!r.get("suppressAnimationFrame"),u.changedRowNodes=new c0,t.setImmutableRowData(u,a)):(u.rowDataUpdated=!0,u.newData=!0,t.setNewRowData(a),this.rowNodesCountReady=!0));const d=u.rowDataUpdated?"group":this.getRefreshedStage(e);d&&(u.step=d,this.refreshModel(u))}getRefreshedStage(e){const{stages:t,stagesRefreshProps:r}=this,n=t.length;let i=n;for(let s=0,o=e.length;s<o&&i;++s)i=Math.min(i,r.get(e[s])??i);return i<n?t[i].step:null}setRowTopAndRowIndex(e){const{beans:t,rowsToDisplay:r}=this,n=t.environment.getDefaultRowHeight();let i=0;const s=bn(this.gos,"normal");for(let o=0,a=r.length;o<a;++o){const u=r[o],d=u.id;if(d!=null&&e?.add(d),u.rowHeight==null){const h=$a(t,u,s,n);u.setRowHeight(h.height,h.estimated)}u.setRowTop(i),u.setRowIndex(o),i+=u.rowHeight}}clearRowTopAndRowIndex(e,t){const r=e.active,n=o=>{o?.id!=null&&!t.has(o.id)&&o.clearRowTopAndRowIndex()},i=o=>{n(o),n(o.detailNode),n(o.sibling);const a=o.childrenAfterGroup;if(!o.hasChildren()||!a)return;const u=o.level==-1;if(!(r&&!u&&!o.expanded))for(let h=0,g=a.length;h<g;++h)i(a[h])},s=this.rootNode;s&&i(s)}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay.length}getTopLevelRowCount(){const{rootNode:e,rowsToDisplay:t}=this;if(!e||!t.length)return 0;if(t[0]===e)return 1;const n=e.sibling?.displayed?1:0;return(e.childrenAfterSort?.length??0)+n}getTopLevelRowDisplayedIndex(e){const{beans:t,rootNode:r,rowsToDisplay:n}=this;if(!r||!n.length||n[0]===r)return e;const s=r.childrenAfterSort,o=u=>{let d=s[u];if(this.gos.get("groupHideOpenParents"))for(;d.expanded&&d.childrenAfterSort&&d.childrenAfterSort.length>0;)d=d.childrenAfterSort[0];return d.rowIndex},a=t.footerSvc;return a?a?.getTopDisplayIndex(n,e,s,o):o(e)}getTopLevelIndexFromDisplayedIndex(e){const{rootNode:t,rowsToDisplay:r}=this;if(!t||!r.length||r[0]===t)return e;let i=this.getRow(e);i.footer&&(i=i.sibling);let s=i.parent;for(;s&&s!==t;)i=s,s=i.parent;const o=t.childrenAfterSort?.indexOf(i)??-1;return o>=0?o:e}getRowBounds(e){const t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){this.refreshModel({step:"map",keepRenderedRows:!0,animate:Pu(this.gos)})}onFilterChanged({afterDataChange:e,columns:t}){if(!e){const n=t.length===0||t.some(i=>i.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step:n,keepRenderedRows:!0,animate:Pu(this.gos)})}}onSortChanged(){this.refreshModel({step:"sort",keepRenderedRows:!0,animate:Pu(this.gos)})}getType(){return"clientSide"}onValueChanged(){this.refreshModel({step:this.beans.colModel.isPivotActive()?"pivot":"aggregate"})}createChangePath(e){const t=new gf(!1,this.rootNode);return t.active=e,t}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction"))return!1;const{changedRowNodes:t,newData:r,rowDataUpdated:n}=e;return!(!t||r||!n||t.removals.size||t.adds.size)}refreshModel(e){const{nodeManager:t,beans:r,eventSvc:n,started:i,refreshingModel:s}=this;if(!t)return;const o=!!e.rowDataUpdated,a=e.changedPath??(e.changedPath=this.createChangePath(!e.newData&&o));if(i&&o&&n.dispatchEvent({type:"rowDataUpdated"}),!i||s||r.colModel.changeEventsDispatching||this.isSuppressModelUpdateAfterUpdateTransaction(e)){this.rowDataUpdatedPending||(this.rowDataUpdatedPending=o);return}switch(this.rowDataUpdatedPending&&(this.rowDataUpdatedPending=!1,e.step="group"),this.refreshingModel=!0,r.masterDetailSvc?.refreshModel(e),o&&e.step!=="group"&&r.colFilter?.refreshModel(),e.step){case"group":this.doGrouping(e);case"filter":this.doFilter(a);case"pivot":this.doPivot(a);case"aggregate":this.doAggregate(a);case"filter_aggregates":this.doFilterAggregates(a);case"sort":this.doSort(e.changedRowNodes,a);case"map":this.doRowsToDisplay()}const u=new Set;this.setRowTopAndRowIndex(u),this.clearRowTopAndRowIndex(a,u),this.refreshingModel=!1,n.dispatchEvent({type:"modelUpdated",animate:e.animate,keepRenderedRows:e.keepRenderedRows,newData:e.newData,newPage:!1,keepUndoRedoStack:e.keepUndoRedoStack})}isEmpty(){return!this.rootNode?._leafs?.length||!this.beans.colModel?.ready}isRowsToRender(){return this.rowsToDisplay.length>0}getNodesInRangeForSelection(e,t){let r=!1,n=!1;const i=[],s=df(this.gos);return this.forEachNodeAfterFilterAndSort(o=>{if(n)return;if(r&&(o===t||o===e)&&(n=!0,s&&o.group)){bI(i,o);return}if(!r){if(o!==t&&o!==e)return;r=!0,t===e&&(n=!0)}(!o.group||!s)&&i.push(o)}),i}getTopLevelNodes(){return this.rootNode?.childrenAfterGroup??null}getRow(e){return this.rowsToDisplay[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){const t=this.rowsToDisplay,r=t.length;if(this.isEmpty()||r===0)return-1;let n=0,i=r-1;if(e<=0)return 0;if(t[i].rowTop<=e)return i;let o=-1,a=-1;for(;;){const u=Math.floor((n+i)/2),d=t[u];if(this.isRowInPixel(d,e)||(d.rowTop<e?n=u+1:d.rowTop>e&&(i=u-1),o===n&&a===i))return u;o=n,a=i}}isRowInPixel(e,t){const r=e.rowTop,n=r+e.rowHeight;return r<=t&&n>t}forEachLeafNode(e){const t=this.rootNode?._leafs;if(t)for(let r=0,n=t.length;r<n;++r)e(t[r],r)}forEachNode(e,t=!1){this.depthFirstSearchRowNodes(e,t)}forEachDisplayedNode(e){const t=this.rowsToDisplay;for(let r=0,n=t.length;r<n;++r)e(t[r],r)}forEachNodeAfterFilter(e,t=!1){this.depthFirstSearchRowNodes(e,t,r=>r.childrenAfterAggFilter)}forEachNodeAfterFilterAndSort(e,t=!1){this.depthFirstSearchRowNodes(e,t,r=>r.childrenAfterSort)}forEachPivotNode(e,t,r){const{colModel:n,rowGroupColsSvc:i}=this.beans;if(!n.isPivotMode())return;if(!i?.columns.length){e(this.rootNode,0);return}const s=r?"childrenAfterSort":"childrenAfterGroup";this.depthFirstSearchRowNodes(e,t,o=>o.leafGroup?null:o[s])}depthFirstSearchRowNodes(e,t=!1,r=s=>s.childrenAfterGroup,n=this.rootNode,i=0){let s=i;if(!n)return s;const o=n===this.rootNode;if(o||e(n,s++),n.hasChildren()&&!n.footer){const a=r(n);if(a){const u=this.beans.footerSvc;s=u?.addTotalRows(s,n,e,t,o,"top")??s;for(const d of a)s=this.depthFirstSearchRowNodes(e,t,r,d,s);return u?.addTotalRows(s,n,e,t,o,"bottom")??s}}return s}doAggregate(e){const t=this.rootNode;t&&this.beans.aggStage?.execute({rowNode:t,changedPath:e})}doFilterAggregates(e){const t=this.rootNode,r=this.beans.filterAggStage;if(r){r.execute({rowNode:t,changedPath:e});return}t.childrenAfterAggFilter=t.childrenAfterFilter}doSort(e,t){const r=this.beans.sortStage;if(r){r.execute({rowNode:this.rootNode,changedRowNodes:e,changedPath:t});return}t.forEachChangedNodeDepthFirst(n=>{n.childrenAfterSort=n.childrenAfterAggFilter.slice(0),yI(n)})}doGrouping(e){const t=this.rootNode,n=this.beans.groupStage?.execute({rowNode:t,changedRowNodes:e.changedRowNodes,changedPath:e.changedPath,afterColumnsChanged:!!e.afterColumnsChanged});if(n===void 0){const i=t._leafs;t.childrenAfterGroup=i,t.updateHasChildren();const s=t.sibling;s&&(s.childrenAfterGroup=i)}(n||e.rowDataUpdated)&&this.beans.colFilter?.refreshModel(),!this.rowCountReady&&this.rowNodesCountReady&&(this.rowCountReady=!0,this.eventSvc.dispatchEventOnce({type:"rowCountReady"}))}doFilter(e){const t=this.beans.filterStage;if(t){t.execute({rowNode:this.rootNode,changedPath:e});return}e.forEachChangedNodeDepthFirst(r=>{r.childrenAfterFilter=r.childrenAfterGroup,jL(r)},!0)}doPivot(e){this.beans.pivotStage?.execute({rowNode:this.rootNode,changedPath:e})}getRowNode(e){const t=this.nodeManager?.getRowNode(e);return typeof t=="object"?t:typeof e=="string"&&e.indexOf(_b)===0?this.beans.groupStage?.getNode(e):void 0}batchUpdateRowData(e,t){if(!this.asyncTransactionsTimer){this.asyncTransactions=[];const r=this.gos.get("asyncTransactionWaitMillis");this.asyncTransactionsTimer=setTimeout(()=>this.executeBatchUpdateRowData(),r)}this.asyncTransactions.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){const e=this.asyncTransactionsTimer;e&&(clearTimeout(e),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){const{nodeManager:e,beans:t,eventSvc:r,asyncTransactions:n}=this;if(!e)return;t.valueCache?.onDataChanged();const i=[],s=[],o=new c0;for(const{rowDataTransaction:a,callback:u}of n??[]){this.rowNodesCountReady=!0;const d=e.updateRowData(a,o);i.push(d),u&&s.push(u.bind(null,d))}this.commitTransactions(o),s.length>0&&setTimeout(()=>{for(let a=0,u=s.length;a<u;a++)s[a]()},0),i.length>0&&r.dispatchEvent({type:"asyncTransactionsFlushed",results:i}),this.asyncTransactionsTimer=0,this.asyncTransactions=null}updateRowData(e){const t=this.nodeManager;if(!t)return null;this.beans.valueCache?.onDataChanged(),this.rowNodesCountReady=!0;const r=new c0,n=t.updateRowData(e,r);return this.commitTransactions(r),n}commitTransactions(e){this.refreshModel({step:"group",rowDataUpdated:!0,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedRowNodes:e,changedPath:this.createChangePath(!0)})}doRowsToDisplay(){const{beans:e,rootNode:t}=this,r=e.flattenStage;if(r){this.rowsToDisplay=r.execute({rowNode:t});return}const n=this.rootNode.childrenAfterSort??[];for(const i of n)i.setUiLevel(0);this.rowsToDisplay=n}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepUndoRedoStack:!0})}resetRowHeights(){const e=this.rootNode;if(!e)return;const t=this.resetRowHeightsForAllRowNodes();e.setRowHeight(e.rowHeight,!0);const r=e.sibling;r?.setRowHeight(r.rowHeight,!0),t&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode(t=>{t.setRowHeight(t.rowHeight,!0);const r=t.detailNode;r?.setRowHeight(r.rowHeight,!0);const n=t.sibling;n?.setRowHeight(n.rowHeight,!0),e=!0}),e}onGridStylesChanges(e){e.rowHeightChanged&&!this.beans.rowAutoHeight?.active&&this.resetRowHeights()}onGridReady(){this.started||this.setInitialData()}destroy(){super.destroy(),this.nodeManager=this.destroyBean(this.nodeManager),this.started=!1,this.rootNode=null,this.rowsToDisplay=[],this.asyncTransactions=null,clearTimeout(this.asyncTransactionsTimer)}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}},bI=(e,t)=>{const r=t.childrenAfterGroup;if(r)for(let n=0,i=r.length;n<i;++n){const s=r[n];s.data&&e.push(s),s.group&&bI(e,s)}};function zee(e){e.expansionSvc?.onGroupExpandedOrCollapsed()}function Wee(e,t){const r=nl(e);r&&((!t||t==="everything")&&(t="group"),r.refreshModel({step:t,keepRenderedRows:!0,animate:!e.gos.get("suppressAnimationFrame")}))}function Uee(e){return nl(e)?.isEmpty()??!0}function $ee(e,t){nl(e)?.forEachLeafNode(t)}function jee(e,t){nl(e)?.forEachNodeAfterFilter(t)}function Yee(e,t){nl(e)?.forEachNodeAfterFilterAndSort(t)}function Kee(e,t){return e.frameworkOverrides.wrapIncoming(()=>nl(e)?.updateRowData(t))}function qee(e,t,r){e.frameworkOverrides.wrapIncoming(()=>nl(e)?.batchUpdateRowData(t,r))}function Xee(e){e.frameworkOverrides.wrapIncoming(()=>nl(e)?.flushAsyncTransactions())}function Qee(e){return e.selectionSvc?.getBestCostNodeSelection()}var Zee={moduleName:"ClientSideRowModel",version:Ue,rowModels:["clientSide"],beans:[Vee,Nee],dependsOn:[zL]},Jee={moduleName:"ClientSideRowModelApi",version:Ue,apiFunctions:{onGroupExpandedOrCollapsed:zee,refreshClientSideRowModel:Wee,isRowDataEmpty:Uee,forEachLeafNode:$ee,forEachNodeAfterFilter:jee,forEachNodeAfterFilterAndSort:Yee,applyTransaction:Kee,applyTransactionAsync:qee,flushAsyncTransactions:Xee,getBestCostNodeSelection:Qee,resetRowHeights:CI,onRowHeightChanged:wI},dependsOn:[Tee,Fee]},ete=class extends Ee{constructor(){super(...arguments),this.beanName="gridSerializer"}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel}serialize(e,t={}){const{allColumns:r,columnKeys:n,skipRowGroups:i,exportRowNumbers:s}=t,o=this.getColumnsToExport({allColumns:r,skipRowGroups:i,columnKeys:n,exportRowNumbers:s});return[this.prepareSession(o),this.prependContent(t),this.exportColumnGroups(t,o),this.exportHeaders(t,o),this.processPinnedTopRows(t,o),this.processRows(t,o),this.processPinnedBottomRows(t,o),this.appendContent(t)].reduce((a,u)=>u(a),e).parse()}processRow(e,t,r,n){const i=t.shouldRowBeSkipped||(()=>!1),o=t.rowPositions!=null||!!t.onlySelected,a=this.gos.get("groupHideOpenParents")&&!o,u=this.colModel.isPivotMode()?n.leafGroup:!n.group,d=!!n.footer,h=n.allChildrenCount===1&&n.childrenAfterGroup?.length===1&&S7(this.gos,n);if(!u&&!d&&(t.skipRowGroups||h||a)||t.onlySelected&&!n.isSelected()||t.skipPinnedTop&&n.rowPinned==="top"||t.skipPinnedBottom&&n.rowPinned==="bottom"||n.stub||n.level===-1&&!u&&!d||i(it(this.gos,{node:n})))return;const v=e.onNewBodyRow(n);if(r.forEach((w,C)=>{v.onColumn(w,C,n)}),t.getCustomContentBelowRow){const w=t.getCustomContentBelowRow(it(this.gos,{node:n}));w&&e.addCustomContent(w)}}appendContent(e){return t=>{const r=e.appendContent;return r&&t.addCustomContent(r),t}}prependContent(e){return t=>{const r=e.prependContent;return r&&t.addCustomContent(r),t}}prepareSession(e){return t=>(t.prepare(e),t)}exportColumnGroups(e,t){return r=>{if(!e.skipColumnGroupHeaders){const n=new b_,{colGroupSvc:i}=this.beans,s=i?i.createColumnGroups({columns:t,idCreator:n,pinned:null,isStandaloneStructure:!0}):t;this.recursivelyAddHeaderGroups(s,r,e.processGroupHeaderCallback)}return r}}exportHeaders(e,t){return r=>{if(!e.skipColumnHeaders){const n=r.onNewHeaderRow();t.forEach((i,s)=>{n.onColumn(i,s,void 0)})}return r}}processPinnedTopRows(e,t){return r=>{const n=this.processRow.bind(this,r,e,t);return e.rowPositions?e.rowPositions.filter(i=>i.rowPinned==="top").sort((i,s)=>i.rowIndex-s.rowIndex).map(i=>this.pinnedRowModel?.getPinnedTopRow(i.rowIndex)).forEach(n):this.pinnedRowModel?.isManual()||this.pinnedRowModel?.forEachPinnedRow("top",n),r}}processRows(e,t){return r=>{const n=this.rowModel,i=_r(this.gos),s=pc(this.gos),o=!i&&e.onlySelected,a=this.processRow.bind(this,r,e,t),{exportedRows:u="filteredAndSorted"}=e;if(e.rowPositions)e.rowPositions.filter(d=>d.rowPinned==null).sort((d,h)=>d.rowIndex-h.rowIndex).map(d=>n.getRow(d.rowIndex)).forEach(a);else if(this.colModel.isPivotMode())i?n.forEachPivotNode(a,!0,u==="filteredAndSorted"):s?n.forEachNodeAfterFilterAndSort(a,!0):n.forEachNode(a);else if(e.onlySelectedAllPages||o){const d=this.beans.selectionSvc?.getSelectedNodes()??[];this.replicateSortedOrder(d),d.forEach(a)}else u==="all"?n.forEachNode(a):i||s?n.forEachNodeAfterFilterAndSort(a,!0):n.forEachNode(a);return r}}replicateSortedOrder(e){const{sortSvc:t,rowNodeSorter:r}=this.beans;if(!t||!r)return;const n=t.getSortOptions(),i=(s,o)=>s.rowIndex!=null&&o.rowIndex!=null?s.rowIndex-o.rowIndex:s.level===o.level?s.parent?.id===o.parent?.id?r.compareRowNodes(n,{rowNode:s,currentPos:s.rowIndex??-1},{rowNode:o,currentPos:o.rowIndex??-1}):i(s.parent,o.parent):s.level>o.level?i(s.parent,o):i(s,o.parent);e.sort(i)}processPinnedBottomRows(e,t){return r=>{const n=this.processRow.bind(this,r,e,t);return e.rowPositions?e.rowPositions.filter(i=>i.rowPinned==="bottom").sort((i,s)=>i.rowIndex-s.rowIndex).map(i=>this.pinnedRowModel?.getPinnedBottomRow(i.rowIndex)).forEach(n):this.pinnedRowModel?.isManual()||this.pinnedRowModel?.forEachPinnedRow("bottom",n),r}}getColumnsToExport(e){const{allColumns:t=!1,skipRowGroups:r=!1,exportRowNumbers:n=!1,columnKeys:i}=e,{colModel:s,gos:o,visibleCols:a}=this,u=s.isPivotMode(),d=m=>ea(m)?!1:!Go(m)||n;if(i?.length)return s.getColsForKeys(i).filter(d);const h=o.get("treeData");let g=[];return t&&!u?g=s.getCols():g=a.allCols,g=g.filter(m=>d(m)&&(r&&!h?!ux(m):!0)),g}recursivelyAddHeaderGroups(e,t,r){const n=[];for(const i of e){const s=i;if(s.getChildren)for(const o of s.getChildren()??[])n.push(o)}e.length>0&&Vr(e[0])&&this.doAddHeaderHeader(t,e,r),n&&n.length>0&&this.recursivelyAddHeaderGroups(n,t,r)}doAddHeaderHeader(e,t,r){const n=e.onNewHeaderGroupingRow();let i=0;for(const s of t){const o=s;let a;r?a=r(it(this.gos,{columnGroup:o})):a=this.beans.colNames.getDisplayNameForColumnGroup(o,"header");const d=(o.isExpandable()?o.getLeafColumns():[]).reduce((h,g,m,v)=>{let w=ir(h);return g.getColumnGroupShow()==="open"?(!w||w[1]!=null)&&(w=[m],h.push(w)):w&&w[1]==null&&(w[1]=m-1),m===v.length-1&&w&&w[1]==null&&(w[1]=m),h},[]);n.onColumn(o,a||"",i++,o.getLeafColumns().length-1,d)}}},tte={moduleName:"SharedExport",version:Ue,beans:[ete]},rA=`\r
`,rte=class extends kQ{constructor(e){super(e),this.config=e,this.isFirstLine=!0,this.result="";const{suppressQuotes:t,columnSeparator:r}=e;this.suppressQuotes=t,this.columnSeparator=r}addCustomContent(e){e&&(typeof e=="string"?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,rA),this.result+=e):e.forEach(t=>{this.beginNewLine(),t.forEach((r,n)=>{n!==0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(r.data.value||""),r.mergeAcross&&this.appendEmptyCells(r.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,r,n){r!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(n)}appendEmptyCells(e){for(let t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){t!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,r){t!=0&&(this.result+=this.columnSeparator);const n=this.extractRowCellValue(e,t,t,"csv",r);this.result+=this.putInQuotes(n.valueFormatted??n.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(e==null)return'""';let t;return typeof e=="string"?t=e:typeof e.toString=="function"?t=e.toString():(Me(53),t=""),'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+=rA),this.isFirstLine=!1}},nte=class extends AQ{constructor(){super(...arguments),this.beanName="csvCreator"}wireBeans(e){this.colModel=e.colModel,this.colNames=e.colNames,this.rowGroupColsSvc=e.rowGroupColsSvc,this.valueSvc=e.valueSvc}getMergedParams(e){const t=this.gos.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed()){Me(51);return}const t=this.getMergedParams(e),r=this.getData(t),n=new Blob(["\uFEFF",r],{type:"text/plain"}),i=typeof t.fileName=="function"?t.fileName(it(this.gos,{})):t.fileName;PQ(this.getFileName(i),n)}exportDataAsCsv(e){this.export(e)}getDataAsCsv(e,t=!1){const r=t?Object.assign({},e):this.getMergedParams(e);return this.getData(r)}getDefaultFileExtension(){return"csv"}createSerializingSession(e){const{colModel:t,colNames:r,rowGroupColsSvc:n,valueSvc:i,gos:s}=this,{processCellCallback:o,processHeaderCallback:a,processGroupHeaderCallback:u,processRowGroupCallback:d,suppressQuotes:h,columnSeparator:g}=e;return new rte({colModel:t,colNames:r,valueSvc:i,gos:s,processCellCallback:o||void 0,processHeaderCallback:a||void 0,processGroupHeaderCallback:u||void 0,processRowGroupCallback:d||void 0,suppressQuotes:h||!1,columnSeparator:g||",",rowGroupColsSvc:n})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}};function ite(e,t){return e.csvCreator?.getDataAsCsv(t)}function ste(e,t){e.csvCreator?.exportDataAsCsv(t)}var ote={moduleName:"CsvExport",version:Ue,beans:[nte],apiFunctions:{getDataAsCsv:ite,exportDataAsCsv:ste},dependsOn:[tte]},ate=class extends Ee{constructor(e,t,r){super(),this.id=e,this.parentCache=t,this.params=r,this.state="needsLoading",this.version=0,this.startRow=e*r.blockSize,this.endRow=this.startRow+r.blockSize}load(){this.state="loading",this.loadFromDatasource()}setStateWaitingToLoad(){this.version++,this.state="needsLoading"}pageLoadFailed(e){this.isRequestMostRecentAndLive(e)&&(this.state="failed"),this.dispatchLocalEvent({type:"loadComplete"})}pageLoaded(e,t,r){this.successCommon(e,{rowData:t,rowCount:r})}isRequestMostRecentAndLive(e){const t=e===this.version,r=this.isAlive();return t&&r}successCommon(e,t){this.dispatchLocalEvent({type:"loadComplete"}),this.isRequestMostRecentAndLive(e)&&(this.state="loaded",this.processServerResult(t))}postConstruct(){this.rowNodes=[];const{params:{blockSize:e,rowHeight:t},startRow:r,beans:n,rowNodes:i}=this;for(let s=0;s<e;s++){const o=r+s,a=new Ka(n);a.setRowHeight(t),a.uiLevel=0,a.setRowIndex(o),a.setRowTop(t*o),i.push(a)}}getBlockStateJson(){const{id:e,startRow:t,endRow:r,state:n}=this;return{id:""+e,state:{blockNumber:e,startRow:t,endRow:r,pageStatus:n}}}setDataAndId(e,t,r){$e(t)?e.setDataAndId(t,r.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){const e=this.createLoadParams();if(xr(this.params.datasource.getRows)){Me(90);return}window.setTimeout(()=>{this.params.datasource.getRows(e)},0)}createLoadParams(){const{startRow:e,endRow:t,version:r,params:{sortModel:n,filterModel:i},gos:s}=this;return{startRow:e,endRow:t,successCallback:this.pageLoaded.bind(this,r),failCallback:this.pageLoadFailed.bind(this,r),sortModel:n,filterModel:i,context:it(s,{}).context}}forEachNode(e,t,r){this.rowNodes.forEach((n,i)=>{this.startRow+i<r&&e(n,t.value++)})}getRow(e,t=!1){t||(this.lastAccessed=this.params.lastAccessedSequence.value++);const r=e-this.startRow;return this.rowNodes[r]}processServerResult(e){const{rowNodes:t,beans:r}=this;t.forEach((i,s)=>{const o=e.rowData?e.rowData[s]:void 0;!i.id&&i.alreadyRendered&&o&&(t[s]=new Ka(r),t[s].setRowIndex(i.rowIndex),t[s].setRowTop(i.rowTop),t[s].setRowHeight(i.rowHeight),i.clearRowTopAndRowIndex()),this.setDataAndId(t[s],o,this.startRow+s)});const n=e.rowCount!=null&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,n)}destroy(){for(const e of this.rowNodes)e.clearRowTopAndRowIndex();super.destroy()}},lte=2,cte=class extends Ee{constructor(e){super(),this.params=e,this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=e.initialRowCount}getRow(e,t=!1){const r=Math.floor(e/this.params.blockSize);let n=this.blocks[r];if(!n){if(t)return;n=this.createBlock(r)}return n.getRow(e)}createBlock(e){const t=this.params,r=this.createBean(new ate(e,this,t));return this.blocks[r.id]=r,this.blockCount++,this.purgeBlocksIfNeeded(r),t.rowNodeBlockLoader.addBlock(r),r}refreshCache(){if(this.blockCount==0){this.purgeCache();return}for(const t of this.getBlocksInOrder())t.setStateWaitingToLoad();this.params.rowNodeBlockLoader.checkBlockToLoad()}destroy(){for(const e of this.getBlocksInOrder())this.destroyBlock(e);super.destroy()}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(e,t){this.isAlive()&&(ec(this.gos,`InfiniteCache - onPageLoaded: page = ${e.id}, lastRow = ${t}`),this.checkRowCount(e,t),this.onCacheUpdated())}purgeBlocksIfNeeded(e){const t=this.getBlocksInOrder().filter(o=>o!=e),r=(o,a)=>a.lastAccessed-o.lastAccessed;t.sort(r);const n=this.params.maxBlocksInCache>0,i=n?this.params.maxBlocksInCache-1:null,s=lte-1;t.forEach((o,a)=>{const u=o.state==="needsLoading"&&a>=s,d=n?a>=i:!1;if(u||d){if(this.isBlockCurrentlyDisplayed(o)||this.isBlockFocused(o))return;this.removeBlockFromCache(o)}})}isBlockFocused(e){const t=this.beans.focusSvc.getFocusCellToUseAfterRefresh();if(!t||t.rowPinned!=null)return!1;const{startRow:r,endRow:n}=e;return t.rowIndex>=r&&t.rowIndex<n}isBlockCurrentlyDisplayed(e){const{startRow:t,endRow:r}=e;return this.beans.rowRenderer.isRangeInRenderedViewport(t,r-1)}removeBlockFromCache(e){e&&this.destroyBlock(e)}checkRowCount(e,t){if(typeof t=="number"&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){const{blockSize:r,overflowSize:n}=this.params,s=(e.id+1)*r+n;this.rowCount<s&&(this.rowCount=s)}}setRowCount(e,t){this.rowCount=e,$e(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(e){const t={value:0};for(const r of this.getBlocksInOrder())r.forEachNode(e,t,this.rowCount)}getBlocksInOrder(){const e=(r,n)=>r.id-n.id;return Object.values(this.blocks).sort(e)}destroyBlock(e){delete this.blocks[e.id],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}onCacheUpdated(){this.isAlive()&&(this.destroyAllBlocksPastVirtualRowCount(),this.eventSvc.dispatchEvent({type:"storeUpdated"}))}destroyAllBlocksPastVirtualRowCount(){const e=[];for(const t of this.getBlocksInOrder())t.id*this.params.blockSize>=this.rowCount&&e.push(t);if(e.length>0)for(const t of e)this.destroyBlock(t)}purgeCache(){for(const e of this.getBlocksInOrder())this.removeBlockFromCache(e);this.lastRowIndexKnown=!1,this.rowCount===0&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(e,t){const r=[];let n=-1,i=!1;const s={value:0};let o=!1;for(const u of this.getBlocksInOrder())if(!o){if(i&&n+1!==u.id){o=!0;continue}n=u.id,u.forEachNode(d=>{const h=d===e||d===t;(i||h)&&r.push(d),h&&(i=!i)},s,this.rowCount)}return o||i?[]:r}},ute=class extends Ee{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null}getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(){return!1}postConstruct(){if(this.gos.get("rowModelType")!=="infinite")return;const e=this.beans,t=new Ka(e);this.rootNode=t,t.level=-1,this.rowHeight=zl(e),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache())}start(){this.setDatasource(this.gos.get("datasource"))}destroy(){this.destroyDatasource(),super.destroy(),this.rootNode=null}destroyDatasource(){this.datasource&&(this.destroyBean(this.datasource),this.beans.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedEventListeners({filterChanged:this.reset.bind(this),sortChanged:this.reset.bind(this),newColumnsLoaded:this.onColumnEverything.bind(this),storeUpdated:this.dispatchModelUpdatedEvent.bind(this)}),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gos.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=zl(this.beans),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onColumnEverything(){let e;this.cacheParams?e=!sf(this.cacheParams.sortModel,this.beans.sortSvc?.getSortModel()??[]):e=!0,e&&this.reset()}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(e,t){return this.infiniteCache?.getRowNodesInRange(e,t)??[]}reset(){if(!this.datasource)return;Zu(this.gos)!=null||this.beans.selectionSvc?.reset("rowDataChanged"),this.resetCache()}dispatchModelUpdatedEvent(){this.eventSvc.dispatchEvent({type:"modelUpdated",newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1})}resetCache(){this.destroyCache();const e=this.beans,{filterManager:t,sortSvc:r,rowNodeBlockLoader:n,eventSvc:i,gos:s}=e;this.cacheParams={datasource:this.datasource,filterModel:t?.getFilterModel()??{},sortModel:r?.getSortModel()??[],rowNodeBlockLoader:n,initialRowCount:s.get("infiniteInitialRowCount"),maxBlocksInCache:s.get("maxBlocksInCache"),rowHeight:zl(e),overflowSize:s.get("cacheOverflowSize"),blockSize:s.get("cacheBlockSize"),lastAccessedSequence:{value:0}},this.infiniteCache=this.createBean(new cte(this.cacheParams)),i.dispatchEventOnce({type:"rowCountReady"}),this.dispatchModelUpdatedEvent()}updateRowHeights(){this.forEachNode(e=>{e.setRowHeight(this.rowHeight),e.setRowTop(this.rowHeight*e.rowIndex)}),this.dispatchModelUpdatedEvent()}destroyCache(){this.infiniteCache=this.destroyBean(this.infiniteCache)}getRow(e){const t=this.infiniteCache;if(t&&!(e>=t.getRowCount()))return t.getRow(e)}getRowNode(e){let t;return this.forEachNode(r=>{r.id===e&&(t=r)}),t}forEachNode(e){this.infiniteCache?.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(e){if(this.rowHeight!==0){const t=Math.floor(e/this.rowHeight),r=this.getRowCount()-1;return t>r?r:t}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){this.infiniteCache?.refreshCache()}purgeCache(){this.infiniteCache?.purgeCache()}isLastRowIndexKnown(){return this.infiniteCache?.isLastRowIndexKnown()??!1}setRowCount(e,t){this.infiniteCache?.setRowCount(e,t)}resetRowHeights(){}onRowHeightChanged(){}};function dte(e){Zm(e)?.refreshCache()}function hte(e){Zm(e)?.purgeCache()}function fte(e){return Zm(e)?.getRowCount()}var gte=class extends Ee{constructor(){super(...arguments),this.beanName="rowNodeBlockLoader",this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}postConstruct(){this.maxConcurrentRequests=x7(this.gos);const e=this.gos.get("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=yn(this,this.performCheckBlocksToLoad.bind(this),e))}addBlock(e){this.blocks.push(e),e.addEventListener("loadComplete",this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){Ds(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad()}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),this.maxConcurrentRequests!=null&&this.activeBlockLoadsCount>=this.maxConcurrentRequests){ec(this.gos,"RowNodeBlockLoader - checkBlockToLoad: max loads exceeded");return}const e=this.maxConcurrentRequests!=null?this.maxConcurrentRequests-this.activeBlockLoadsCount:1,t=this.blocks.filter(r=>r.state==="needsLoading").slice(0,e);this.activeBlockLoadsCount+=t.length;for(const r of t)r.load();this.printCacheStatus()}getBlockState(){const e={};return this.blocks.forEach(t=>{const{id:r,state:n}=t.getBlockStateJson();e[r]=n}),e}printCacheStatus(){ec(this.gos,`RowNodeBlockLoader - printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}},pte={moduleName:"InfiniteRowModelCore",version:Ue,rowModels:["infinite"],beans:[ute,gte]},mte={moduleName:"InfiniteRowModel",version:Ue,apiFunctions:{refreshInfiniteCache:dte,purgeInfiniteCache:hte,getInfiniteRowCount:fte},dependsOn:[pte,Dee]},vte="",wte="",Cte={tag:"span",children:[{tag:"span",ref:"eDelta",cls:"ag-value-change-delta"},{tag:"span",ref:"eValue",cls:"ag-value-change-value"}]},yte=class extends Dr{constructor(){super(Cte),this.eValue=tt,this.eDelta=tt,this.refreshCount=0}init(e){this.refresh(e,!0)}showDelta(e,t){const r=Math.abs(t),n=e.formatValue(r),i=$e(n)?n:r,s=t>=0,o=this.eDelta;s?o.textContent=vte+i:o.textContent=wte+i,o.classList.toggle("ag-value-change-delta-up",s),o.classList.toggle("ag-value-change-delta-down",!s)}setTimerToRemoveDelta(){this.refreshCount++;const e=this.refreshCount;this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),ci(this.eDelta)}refresh(e,t=!1){const{value:r,valueFormatted:n}=e,{eValue:i,lastValue:s,beans:o}=this;if(r===s||($e(n)?i.textContent=n:$e(r)?i.textContent=r:ci(i),o.filterManager?.isSuppressFlashingCellsBecauseFiltering()))return!1;const a=r&&typeof r=="object"&&"toNumber"in r?r.toNumber():r,u=s&&typeof s=="object"&&"toNumber"in s?s.toNumber():s;if(a===u)return!1;if(typeof a=="number"&&typeof u=="number"){const d=a-u;this.showDelta(e,d)}return s&&i.classList.add("ag-value-change-value-highlight"),t||this.setTimerToRemoveDelta(),this.lastValue=r,!0}},bte=".ag-value-slide-out{opacity:1}:where(.ag-ltr) .ag-value-slide-out{margin-right:5px;transition:opacity 3s,margin-right 3s}:where(.ag-rtl) .ag-value-slide-out{margin-left:5px;transition:opacity 3s,margin-left 3s}:where(.ag-ltr,.ag-rtl) .ag-value-slide-out{transition-timing-function:linear}.ag-value-slide-out-end{opacity:0}:where(.ag-ltr) .ag-value-slide-out-end{margin-right:10px}:where(.ag-rtl) .ag-value-slide-out-end{margin-left:10px}",Ste={tag:"span",children:[{tag:"span",ref:"eCurrent",cls:"ag-value-slide-current"}]},xte=class extends Dr{constructor(){super(Ste),this.eCurrent=tt,this.refreshCount=0,this.registerCSS(bte)}init(e){this.refresh(e,!0)}addSlideAnimation(){this.refreshCount++;const e=this.refreshCount;this.ePrevious?.remove();const{beans:t,eCurrent:r}=this,n=jn({tag:"span",cls:"ag-value-slide-previous ag-value-slide-out"});this.ePrevious=n,n.textContent=r.textContent,this.getGui().insertBefore(n,r),t.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{e===this.refreshCount&&(this.ePrevious?.remove(),this.ePrevious=null)},3e3)})}refresh(e,t=!1){let r=e.value;if(xr(r)&&(r=""),r===this.lastValue||this.beans.filterManager?.isSuppressFlashingCellsBecauseFiltering())return!1;t||this.addSlideAnimation(),this.lastValue=r;const n=this.eCurrent;return $e(e.valueFormatted)?n.textContent=e.valueFormatted:$e(e.value)?n.textContent=r:ci(n),!0}},Ete=class extends Ee{constructor(){super(...arguments),this.beanName="cellFlashSvc",this.nextAnimationTime=null,this.nextAnimationCycle=null,this.animations={highlight:new Map,"data-changed":new Map}}animateCell(e,t,r=this.beans.gos.get("cellFlashDuration"),n=this.beans.gos.get("cellFadeDuration")){const i=this.animations[t];i.delete(e);const s=Date.now(),o=s+r,a=s+r+n,u={phase:"flash",flashEndTime:o,fadeEndTime:a};i.set(e,u);const d=`ag-cell-${t}`,h=`${d}-animation`,{comp:g,eGui:{style:m}}=e;g.toggleCss(d,!0),g.toggleCss(h,!1),m.removeProperty("transition"),m.removeProperty("transition-delay"),this.nextAnimationTime&&o+15<this.nextAnimationTime&&(clearTimeout(this.nextAnimationCycle),this.nextAnimationCycle=null,this.nextAnimationTime=null),this.nextAnimationCycle||(this.beans.frameworkOverrides.wrapIncoming(()=>{this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),r)}),this.nextAnimationTime=o)}advanceAnimations(){const e=Date.now();let t=null;for(const r of Object.keys(this.animations)){const n=this.animations[r],i=`ag-cell-${r}`,s=`${i}-animation`;for(const[o,a]of n){if(!o.isAlive()||!o.comp){n.delete(o);continue}const{phase:u,flashEndTime:d,fadeEndTime:h}=a,g=u==="flash"?d:h;if(!(e+15>=g)){t=Math.min(g,t??1/0);continue}const{comp:v,eGui:{style:w}}=o;switch(u){case"flash":v.toggleCss(i,!1),v.toggleCss(s,!0),w.transition=`background-color ${h-d}ms`,w.transitionDelay=`${d-e}ms`,t=Math.min(h,t??1/0),a.phase="fade";break;case"fade":v.toggleCss(i,!1),v.toggleCss(s,!1),w.removeProperty("transition"),w.removeProperty("transition-delay"),n.delete(o);break}}}t==null?(this.nextAnimationTime=null,this.nextAnimationCycle=null):t&&(this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),t-e),this.nextAnimationTime=t)}onFlashCells(e,t){if(!e.comp)return;const r=bj(e.cellPosition);t.cells[r]&&this.animateCell(e,"highlight")}flashCell(e,t){this.animateCell(e,"data-changed",t?.flashDuration,t?.fadeDuration)}destroy(){for(const e of Object.keys(this.animations))this.animations[e].clear()}};function Rte(e,t={}){const{cellFlashSvc:r}=e;r&&e.frameworkOverrides.wrapIncoming(()=>{for(const n of e.rowRenderer.getCellCtrls(t.rowNodes,t.columns))r.flashCell(n,t)})}var Tte={moduleName:"HighlightChanges",version:Ue,beans:[Ete],userComponents:{agAnimateShowChangeCellRenderer:yte,agAnimateSlideCellRenderer:xte},apiFunctions:{flashCells:Rte}};function Fte(e){return e.stateSvc?.getState()??{}}function Dte(e,t,r){return e.stateSvc?.setState(t,r)}function nA(e){return e={...e},e.version||(e.version="32.1.0"),e.version==="32.1.0"&&(e=Ate(e)),e.version=Ue,e}function Ate(e){return e.cellSelection=kte(e,"rangeSelection"),e}function kte(e,t){if(e&&typeof e=="object")return e[t]}var Pte=class extends Ee{constructor(){super(...arguments),this.beanName="stateSvc",this.updateRowGroupExpansionStateTimer=0,this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=yn(this,()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=yn(this,()=>{this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(this.updateCachedState("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowGroupExpansion",void 0)):(this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("ssrmRowGroupExpansion",void 0))},0),this.onRowSelectedDebounced=yn(this,()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}postConstruct(){const{gos:e,ctrlsSvc:t,colDelayRenderSvc:r}=this.beans;this.isClientSideRowModel=_r(e);const n=nA(e.get("initialState")??{}),i=n.partialColumnState;delete n.partialColumnState,this.cachedState=n;const s=this.suppressEventsAndDispatchInitEvent.bind(this);t.whenReady(this,()=>s(()=>this.setupStateOnGridReady(n))),(n.columnOrder||n.columnVisibility||n.columnSizing||n.columnPinning||n.columnGroup)&&r?.hideColumns("columnState");const[o,a,u]=this.addManagedEventListeners({newColumnsLoaded:({source:d})=>{d==="gridInitializing"&&(o(),s(()=>{this.setupStateOnColumnsInitialised(n,!!i),r?.revealColumns("columnState")}))},rowCountReady:()=>{a?.(),s(()=>this.setupStateOnRowCountReady(n))},firstDataRendered:()=>{u?.(),s(()=>this.setupStateOnFirstDataRendered(n))}})}destroy(){super.destroy(),clearTimeout(this.updateRowGroupExpansionStateTimer),this.queuedUpdateSources.clear()}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setState(e,t){const r=nA(e);delete r.partialColumnState,this.cachedState=r,this.startSuppressEvents();const n="api",i=t?new Set(t):void 0;this.setGridReadyState(r,n,i),this.setColumnsInitialisedState(r,n,!!i,i),this.setRowCountState(r,n,i),setTimeout(()=>{this.isAlive()&&this.setFirstDataRenderedState(r,n,i),this.stopSuppressEvents(n)})}setGridReadyState(e,t,r){t==="api"&&!r?.has("sideBar")&&this.beans.sideBar?.comp?.setState(e.sideBar),this.updateCachedState("sideBar",this.getSideBarState())}setupStateOnGridReady(e){this.setGridReadyState(e,"gridInitializing");const t=()=>this.updateCachedState("sideBar",this.getSideBarState());this.addManagedEventListeners({toolPanelVisibleChanged:t,sideBarUpdated:t})}updateColumnAndGroupState(){this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState())}setColumnsInitialisedState(e,t,r,n){this.setColumnState(e,t,r,n),this.setColumnGroupState(e,t,n),this.updateColumnAndGroupState()}setupStateOnColumnsInitialised(e,t){this.setColumnsInitialisedState(e,"gridInitializing",t);const r=n=>()=>this.updateColumnState([n]);this.addManagedEventListeners({columnValueChanged:r("aggregation"),columnMoved:r("columnOrder"),columnPinned:r("columnPinning"),columnResized:r("columnSizing"),columnVisible:r("columnVisibility"),columnPivotChanged:r("pivot"),columnPivotModeChanged:r("pivot"),columnRowGroupChanged:r("rowGroup"),sortChanged:r("sort"),newColumnsLoaded:this.updateColumnAndGroupState.bind(this),columnGroupOpened:()=>this.updateCachedState("columnGroup",this.getColumnGroupState())})}setRowCountState(e,t,r){const{filter:n,rowGroupExpansion:i,ssrmRowGroupExpansion:s,rowSelection:o,pagination:a}=e,u=(h,g)=>!r?.has(h)&&(g||t==="api");u("filter",n)&&this.setFilterState(n),u("rowGroupExpansion",i)&&this.setRowGroupExpansionState(s,i,t),u("rowSelection",o)&&this.setRowSelectionState(o,t),u("pagination",a)&&this.setPaginationState(a,t);const d=this.updateCachedState.bind(this);d("filter",this.getFilterState()),this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(d("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),d("rowGroupExpansion",void 0)):(d("rowGroupExpansion",this.getRowGroupExpansionState()),d("ssrmRowGroupExpansion",void 0)),d("rowSelection",this.getRowSelectionState()),d("pagination",this.getPaginationState())}setupStateOnRowCountReady(e){this.setRowCountState(e,"gridInitializing");const t=this.updateCachedState.bind(this),r=()=>{this.updateRowGroupExpansionStateTimer=0,this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(t("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),t("rowGroupExpansion",void 0)):(t("rowGroupExpansion",this.getRowGroupExpansionState()),t("ssrmRowGroupExpansion",void 0))},n=()=>t("filter",this.getFilterState()),{gos:i,colFilter:s}=this.beans;this.addManagedEventListeners({filterChanged:n,rowExpansionStateChanged:this.onRowGroupOpenedDebounced,expandOrCollapseAll:r,columnRowGroupChanged:r,rowDataUpdated:()=>{(i.get("groupDefaultExpanded")!==0||i.get("isGroupOpenByDefault"))&&(this.updateRowGroupExpansionStateTimer||(this.updateRowGroupExpansionStateTimer=setTimeout(r)))},selectionChanged:()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()},paginationChanged:o=>{(o.newPage||o.newPageSize)&&t("pagination",this.getPaginationState())}}),s&&this.addManagedListeners(s,{filterStateChanged:n})}setFirstDataRenderedState(e,t,r){const{scroll:n,cellSelection:i,focusedCell:s,columnOrder:o,rowPinning:a}=e,u=(g,m)=>!r?.has(g)&&(m||t==="api");u("focusedCell",s)&&this.setFocusedCellState(s),u("cellSelection",i)&&this.setCellSelectionState(i),u("scroll",n)&&this.setScrollState(n),u("rowPinning",a)&&this.setRowPinningState(a),this.setColumnPivotState(!!o?.orderedColIds,t);const d=this.updateCachedState.bind(this);d("sideBar",this.getSideBarState()),d("focusedCell",this.getFocusedCellState());const h=this.getRangeSelectionState();d("rangeSelection",h),d("cellSelection",h),d("scroll",this.getScrollState())}setupStateOnFirstDataRendered(e){this.setFirstDataRenderedState(e,"gridInitializing");const t=this.updateCachedState.bind(this),r=()=>t("focusedCell",this.getFocusedCellState());this.addManagedEventListeners({cellFocused:r,cellFocusCleared:r,cellSelectionChanged:n=>{if(n.finished){const i=this.getRangeSelectionState();t("rangeSelection",i),t("cellSelection",i)}},bodyScrollEnd:()=>t("scroll",this.getScrollState()),pinnedRowsChanged:()=>t("rowPinning",this.getRowPinningState())})}getColumnState(){const e=this.beans;return RQ(O0(e),e.colModel.isPivotMode())}setColumnState(e,t,r,n){const{sort:i,rowGroup:s,aggregation:o,pivot:a,columnPinning:u,columnVisibility:d,columnSizing:h,columnOrder:g}=e;let m=!1;const v=(I,G)=>{const ne=!n?.has(I)&&!!(G||t==="api");return m||(m=ne),ne},w={},C=I=>{let G=w[I];return G||(G={colId:I},w[I]=G,G)},b={},x=v("sort",i);x&&i?.sortModel.forEach(({colId:I,sort:G},ne)=>{const ie=C(I);ie.sort=G,ie.sortIndex=ne}),(x||!r)&&(b.sort=null,b.sortIndex=null);const R=v("rowGroup",s);R&&s?.groupColIds.forEach((I,G)=>{const ne=C(I);ne.rowGroup=!0,ne.rowGroupIndex=G}),(R||!r)&&(b.rowGroup=null,b.rowGroupIndex=null);const E=v("aggregation",o);E&&o?.aggregationModel.forEach(({colId:I,aggFunc:G})=>{C(I).aggFunc=G}),(E||!r)&&(b.aggFunc=null);const A=v("pivot",a);A&&(a?.pivotColIds.forEach((I,G)=>{const ne=C(I);ne.pivot=!0,ne.pivotIndex=G}),this.gos.updateGridOptions({options:{pivotMode:!!a?.pivotMode},source:t})),(A||!r)&&(b.pivot=null,b.pivotIndex=null);const D=v("columnPinning",u);if(D){for(const I of u?.leftColIds??[])C(I).pinned="left";for(const I of u?.rightColIds??[])C(I).pinned="right"}(D||!r)&&(b.pinned=null);const M=v("columnVisibility",d);if(M)for(const I of d?.hiddenColIds??[])C(I).hide=!0;(M||!r)&&(b.hide=null);const F=v("columnSizing",h);if(F)for(const{colId:I,flex:G,width:ne}of h?.columnSizingModel??[]){const ie=C(I);ie.flex=G??null,ie.width=ne}(F||!r)&&(b.flex=null);const O=g?.orderedColIds,L=!!O?.length&&!n?.has("columnOrder"),W=L?O.map(I=>C(I)):Object.values(w);(W.length||m)&&(this.columnStates=W,Ss(this.beans,{state:W,applyOrder:L,defaultState:b},t))}setColumnPivotState(e,t){const r=this.columnStates;this.columnStates=void 0;const n=this.columnGroupStates;this.columnGroupStates=void 0;const i=this.beans,{pivotResultCols:s,colGroupSvc:o}=i;if(s?.isPivotResultColsPresent()){if(r){const a=[];for(const u of r)s.getPivotResultCol(u.colId)&&a.push(u);Ss(i,{state:a,applyOrder:e},t)}n&&o?.setColumnGroupState(n,t)}}getColumnGroupState(){const e=this.beans.colGroupSvc;if(!e)return;const t=e.getColumnGroupState();return TQ(t)}setColumnGroupState(e,t,r){const n=this.beans.colGroupSvc;if(!n||r?.has("columnGroup")||t!=="api"&&!Object.prototype.hasOwnProperty.call(e,"columnGroup"))return;const i=new Set(e.columnGroup?.openColumnGroupIds),o=n.getColumnGroupState().map(({groupId:a})=>{const u=i.has(a);return u&&i.delete(a),{groupId:a,open:u}});for(const a of i)o.push({groupId:a,open:!0});o.length&&(this.columnGroupStates=o),n.setColumnGroupState(o,t)}getFilterState(){const e=this.beans.filterManager;let t=e?.getFilterModel();t&&Object.keys(t).length===0&&(t=void 0);const r=e?.getFilterState(),n=e?.getAdvFilterModel()??void 0;return t||n||r?{filterModel:t,columnFilterState:r,advancedFilterModel:n}:void 0}setFilterState(e){const t=this.beans.filterManager,{filterModel:r,columnFilterState:n,advancedFilterModel:i}=e??{filterModel:null,columnFilterState:null,advancedFilterModel:null};(r!==void 0||n!==void 0)&&t?.setFilterState(r??null,n??null,"columnFilter"),i!==void 0&&t?.setAdvFilterModel(i??null,"advancedFilter")}getRangeSelectionState(){const e=this.beans.rangeSvc?.getCellRanges().map(t=>{const{id:r,type:n,startRow:i,endRow:s,columns:o,startColumn:a}=t;return{id:r,type:n,startRow:i,endRow:s,colIds:o.map(u=>u.getColId()),startColId:a.getColId()}});return e?.length?{cellRanges:e}:void 0}setCellSelectionState(e){const{gos:t,rangeSvc:r,colModel:n,visibleCols:i}=this.beans;if(!ja(t)||!r)return;const s=[];for(const o of e?.cellRanges??[]){const a=[];for(const d of o.colIds){const h=n.getCol(d);h&&a.push(h)}if(!a.length)continue;let u=n.getCol(o.startColId);if(!u){const d=i.allCols,h=new Set(a);u=d.find(g=>h.has(g))}s.push({...o,columns:a,startColumn:u})}r.setCellRanges(s)}getScrollState(){if(!this.isClientSideRowModel)return;const e=this.beans.ctrlsSvc.getScrollFeature(),{left:t}=e?.getHScrollPosition()??{left:0},{top:r}=e?.getVScrollPosition()??{top:0};return r||t?{top:r,left:t}:void 0}setScrollState(e){if(!this.isClientSideRowModel)return;const{top:t,left:r}=e??{top:0,left:0},{frameworkOverrides:n,rowRenderer:i,animationFrameSvc:s,ctrlsSvc:o}=this.beans;n.wrapIncoming(()=>{o.get("center").setCenterViewportScrollLeft(r),o.getScrollFeature()?.setVerticalScrollPosition(t),i.redraw({afterScroll:!0}),s?.flushAllFrames()})}getSideBarState(){return this.beans.sideBar?.comp?.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;const e=this.beans.focusSvc.getFocusedCell();if(e){const{column:t,rowIndex:r,rowPinned:n}=e;return{colId:t.getColId(),rowIndex:r,rowPinned:n}}}setFocusedCellState(e){if(!this.isClientSideRowModel)return;const{focusSvc:t,colModel:r}=this.beans;if(!e){t.clearFocusedCell();return}const{colId:n,rowIndex:i,rowPinned:s}=e;t.setFocusedCell({column:r.getCol(n),rowIndex:i,rowPinned:s,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){const{pagination:e,gos:t}=this.beans;if(!e)return;const r=e.getCurrentPage(),n=t.get("paginationAutoPageSize")?void 0:e.getPageSize();if(!(!r&&!n))return{page:r,pageSize:n}}setPaginationState(e,t){const{pagination:r,gos:n}=this.beans;if(!r)return;const{pageSize:i,page:s}=e??{page:0,pageSize:n.get("paginationPageSize")},o=t==="gridInitializing";i&&!n.get("paginationAutoPageSize")&&r.setPageSize(i,o?"initialState":"pageSizeSelector"),typeof s=="number"&&(o?r.setPage(s):r.goToPage(s))}getRowSelectionState(){const e=this.beans.selectionSvc;if(!e)return;const t=e.getSelectionState();return!t||!Array.isArray(t)&&(t.selectAll===!1||t.selectAllChildren===!1)&&!t?.toggledNodes?.length?void 0:t}setRowSelectionState(e,t){this.beans.selectionSvc?.setSelectionState(e,t,t==="api")}getRowGroupExpansionState(){const{expansionSvc:e}=this.beans;if(e)return e.getExpansionState()}getRowPinningState(){return this.beans.pinnedRowModel?.getPinnedState()}setRowPinningState(e){const t=this.beans.pinnedRowModel;e?t?.setPinnedState(e):t?.reset()}setRowGroupExpansionState(e,t,r){const n=this.beans.expansionSvc;if(!n)return;const i=t??{expandedRowGroupIds:[],collapsedRowGroupIds:[]};n.setExpansionState(i,r)}updateColumnState(e){const t=this.getColumnState();let r=!1;const n=this.cachedState;for(const i of Object.keys(t)){const s=t[i];sf(s,n[i])||(r=!0)}this.cachedState={...n,...t},r&&this.dispatchStateUpdateEvent(e)}updateCachedState(e,t){const r=this.cachedState[e];this.setCachedStateValue(e,t),sf(t,r)||this.dispatchStateUpdateEvent([e])}setCachedStateValue(e,t){this.cachedState={...this.cachedState,[e]:t}}refreshStaleState(){const e=this.staleStateKeys;for(const t of e)t==="rowSelection"&&this.setCachedStateValue(t,this.getRowSelectionState());e.clear()}dispatchStateUpdateEvent(e){if(!this.suppressEvents){for(const t of e)this.queuedUpdateSources.add(t);this.dispatchStateUpdateEventDebounced()}}dispatchQueuedStateUpdateEvents(){const e=this.queuedUpdateSources,t=Array.from(e);e.clear(),this.eventSvc.dispatchEvent({type:"stateUpdated",sources:t,state:this.cachedState})}startSuppressEvents(){this.suppressEvents=!0,this.beans.colAnimation?.setSuppressAnimation(!0)}stopSuppressEvents(e){setTimeout(()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(this.beans.colAnimation?.setSuppressAnimation(!1),this.dispatchStateUpdateEvent([e]))})}suppressEventsAndDispatchInitEvent(e){this.startSuppressEvents(),e(),this.stopSuppressEvents("gridInitializing")}},Mte={moduleName:"GridState",version:Ue,beans:[Pte],apiFunctions:{getState:Fte,setState:Dte}};function _te(e){return e.rowModel.isLastRowIndexKnown()}function Lte(e){return e.pagination?.getPageSize()??100}function Ite(e){return e.pagination?.getCurrentPage()??0}function Ote(e){return e.pagination?.getTotalPages()??1}function Nte(e){return e.pagination?e.pagination.getMasterRowCount():e.rowModel.getRowCount()}function Bte(e){e.pagination?.goToNextPage()}function Hte(e){e.pagination?.goToPreviousPage()}function Gte(e){e.pagination?.goToFirstPage()}function Vte(e){e.pagination?.goToLastPage()}function zte(e,t){e.pagination?.goToPage(t)}var Wte=class extends Ee{constructor(){super(...arguments),this.beanName="paginationAutoPageSizeSvc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowsCtrl=e.center;const t=this.checkPageSize.bind(this);this.addManagedEventListeners({bodyHeightChanged:t,scrollVisibilityChanged:t}),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gos.get("paginationAutoPageSize")||this.centerRowsCtrl==null}onPaginationAutoSizeChanged(){this.notActive()?this.beans.pagination.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;const e=this.centerRowsCtrl.viewportSizeFeature.getBodyHeight();if(e>0){const t=this.beans,r=()=>{const n=Math.max(zl(t),1),i=Math.floor(e/n);t.pagination.setPageSize(i,"autoCalculated")};this.isBodyRendered?yn(this,r,50)():(r(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}},Rh="paginationPageSizeSelector",Ute={tag:"span",cls:"ag-paging-page-size"},$te=class extends Dr{constructor(){super(Ute),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;const e=this.selectPageSizeComp.getValue();if(!e)return;const t=Number(e);isNaN(t)||t<1||t===this.pagination.getPageSize()||(this.pagination.setPageSize(t,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}wireBeans(e){this.pagination=e.pagination}postConstruct(){this.addManagedPropertyListener(Rh,()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedEventListeners({paginationChanged:e=>this.handlePaginationChanged(e)})}handlePaginationChanged(e){if(!this.selectPageSizeComp||!e?.newPageSize)return;const t=this.pagination.getPageSize();this.getPageSizeSelectorValues().includes(t)?this.selectPageSizeComp.setValue(t.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(e){this.selectPageSizeComp&&!e&&this.reset(),e&&(this.reloadPageSizesSelector(),this.selectPageSizeComp)}reset(){ci(this.getGui()),this.selectPageSizeComp&&(this.selectPageSizeComp=this.destroyBean(this.selectPageSizeComp))}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&this.gos.get(Rh)!==!1}reloadPageSizesSelector(){const e=this.getPageSizeSelectorValues(),t=this.pagination.getPageSize(),r=!t||!e.includes(t);if(r){const i=this.gos.exists("paginationPageSize"),s=this.gos.get(Rh)!==!0;Me(94,{pageSizeSet:i,pageSizesSet:s,pageSizeOptions:e,paginationPageSizeOption:t}),s||Me(95,{paginationPageSizeOption:t,paginationPageSizeSelector:Rh}),e.unshift("")}const n=String(r?"":t);this.selectPageSizeComp?(tl(this.pageSizeOptions,e)||(this.selectPageSizeComp.clearOptions().addOptions(this.createPageSizeSelectOptions(e)),this.pageSizeOptions=e),this.selectPageSizeComp.setValue(n,!0)):this.createPageSizeSelectorComp(e,n),this.hasEmptyOption=r}createPageSizeSelectOptions(e){return e.map(t=>({value:String(t)}))}createPageSizeSelectorComp(e,t){const r=this.getLocaleTextFunc(),n=r("pageSizeSelectorLabel","Page Size:"),i=r("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new vx).addOptions(this.createPageSizeSelectOptions(e)).setValue(t).setAriaLabel(i).setLabel(n).onValueChange(()=>this.handlePageSizeItemSelected()),this.appendChild(this.selectPageSizeComp)}getPageSizeSelectorValues(){const e=[20,50,100],t=this.gos.get(Rh);return!Array.isArray(t)||!t?.length?e:[...t].sort((r,n)=>r-n)}destroy(){this.toggleSelectDisplay(!1),super.destroy()}},jte={selector:"AG-PAGE-SIZE-SELECTOR",component:$te},Yte=".ag-paging-panel{align-items:center;border-top:var(--ag-footer-row-border);display:flex;gap:calc(var(--ag-spacing)*4);height:var(--ag-pagination-panel-height);justify-content:flex-end;padding:0 var(--ag-cell-horizontal-padding)}:where(.ag-paging-page-size) .ag-wrapper{min-width:50px}.ag-paging-page-summary-panel{align-items:center;display:flex;gap:var(--ag-cell-widget-spacing);.ag-disabled &{pointer-events:none}}.ag-paging-button{cursor:pointer;position:relative;&.ag-disabled{cursor:default;opacity:.5}}.ag-paging-number,.ag-paging-row-summary-panel-number{font-weight:500}",Kte=class extends j${constructor(){super(),this.btFirst=tt,this.btPrevious=tt,this.btNext=tt,this.btLast=tt,this.lbRecordCount=tt,this.lbFirstRowOnPage=tt,this.lbLastRowOnPage=tt,this.lbCurrent=tt,this.lbTotal=tt,this.pageSizeComp=tt,this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1,this.allowFocusInnerElement=!1,this.registerCSS(Yte)}wireBeans(e){this.rowModel=e.rowModel,this.pagination=e.pagination,this.ariaAnnounce=e.ariaAnnounce}postConstruct(){const e=this.gos.get("enableRtl");this.setTemplate(this.getTemplate(),[jte]);const{btFirst:t,btPrevious:r,btNext:n,btLast:i}=this;this.activateTabIndex([t,r,n,i]),t.insertAdjacentElement("afterbegin",ts(e?"last":"first",this.beans)),r.insertAdjacentElement("afterbegin",ts(e?"next":"previous",this.beans)),n.insertAdjacentElement("afterbegin",ts(e?"previous":"next",this.beans)),i.insertAdjacentElement("afterbegin",ts(e?"first":"last",this.beans)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:s=>this.allowFocusInnerElement?this.tabGuardFeature.getTabGuardCtrl().focusInnerElement(s):u$(this.beans,s),forceFocusOutWhenTabGuardsAreEmpty:!0}),this.onPaginationChanged()}setAllowFocus(e){this.allowFocusInnerElement=e}onPaginationChanged(){const t=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(t),t&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){if(!this.areListenersSetup){this.addManagedEventListeners({paginationChanged:this.onPaginationChanged.bind(this)});for(const e of[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}]){const{el:t,fn:r}=e;this.addManagedListeners(t,{click:r,keydown:n=>{(n.key===me.ENTER||n.key===me.SPACE)&&(n.preventDefault(),r())}})}c$(this.beans,this,this.getGui()),this.areListenersSetup=!0}}onBtFirst(){this.previousAndFirstButtonsDisabled||this.pagination.goToFirstPage()}formatNumber(e){const t=this.gos.getCallback("paginationNumberFormatter");return t?t({value:e}):DQ(e,this.getLocaleTextFunc.bind(this))}getTemplate(){const e=this.getLocaleTextFunc(),t=`ag-${this.getCompId()}`;return{tag:"div",cls:"ag-paging-panel ag-unselectable",attrs:{id:`${t}`},children:[{tag:"ag-page-size-selector",ref:"pageSizeComp"},{tag:"span",cls:"ag-paging-row-summary-panel",children:[{tag:"span",ref:"lbFirstRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-first-row`}},{tag:"span",attrs:{id:`${t}-to`},children:e("to","to")},{tag:"span",ref:"lbLastRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-last-row`}},{tag:"span",attrs:{id:`${t}-of`},children:e("of","of")},{tag:"span",ref:"lbRecordCount",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-row-count`}}]},{tag:"span",cls:"ag-paging-page-summary-panel",role:"presentation",children:[{tag:"div",ref:"btFirst",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("firstPage","First Page")}},{tag:"div",ref:"btPrevious",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("previousPage","Previous Page")}},{tag:"span",cls:"ag-paging-description",children:[{tag:"span",attrs:{id:`${t}-start-page`},children:e("page","Page")},{tag:"span",ref:"lbCurrent",cls:"ag-paging-number",attrs:{id:`${t}-start-page-number`}},{tag:"span",attrs:{id:`${t}-of-page`},children:e("of","of")},{tag:"span",ref:"lbTotal",cls:"ag-paging-number",attrs:{id:`${t}-of-page-number`}}]},{tag:"div",ref:"btNext",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("nextPage","Next Page")}},{tag:"div",ref:"btLast",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("lastPage","Last Page")}}]}]}}onBtNext(){this.nextButtonDisabled||this.pagination.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.pagination.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.pagination.goToLastPage()}enableOrDisableButtons(){const e=this.pagination.getCurrentPage(),t=this.rowModel.isLastRowIndexKnown(),r=this.pagination.getTotalPages();this.previousAndFirstButtonsDisabled=e===0,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);const n=this.isZeroPagesToDisplay(),i=e===r-1;this.nextButtonDisabled=i||n,this.lastButtonDisabled=!t||n||e===r-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){Tz(e,t),e.classList.toggle("ag-disabled",t)}isZeroPagesToDisplay(){const e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages();return e&&t===0}updateLabels(){const e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages(),r=this.pagination.getMasterRowCount(),n=e?r:null,i=this.pagination.getCurrentPage(),s=this.pagination.getPageSize();let o,a;this.isZeroPagesToDisplay()?o=a=0:(o=s*i+1,a=o+s-1,e&&a>n&&(a=n));const u=o+s-1,d=!e&&r<u,h=this.formatNumber(o);this.lbFirstRowOnPage.textContent=h;let g;const m=this.getLocaleTextFunc();d?g=m("pageLastRowUnknown","?"):g=this.formatNumber(a),this.lbLastRowOnPage.textContent=g;const w=t>0?i+1:0,C=this.formatNumber(w);this.lbCurrent.textContent=C;let b,x;if(e)b=this.formatNumber(t),x=this.formatNumber(n);else{const R=m("more","more");b=R,x=R}this.lbTotal.textContent=b,this.lbRecordCount.textContent=x,this.announceAriaStatus(h,g,x,C,b)}announceAriaStatus(e,t,r,n,i){const s=this.getLocaleTextFunc(),o=s("page","Page"),a=s("to","to"),u=s("of","of"),d=`${e} ${a} ${t} ${u} ${r}`,h=`${o} ${n} ${u} ${i}`;d!==this.ariaRowStatus&&(this.ariaRowStatus=d,this.ariaAnnounce?.announceValue(d,"paginationRow")),h!==this.ariaPageStatus&&(this.ariaPageStatus=h,this.ariaAnnounce?.announceValue(h,"paginationPage"))}},qte={selector:"AG-PAGINATION",component:Kte},Xte=class extends Ee{constructor(){super(...arguments),this.beanName="pagination",this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.masterRowCount=0}postConstruct(){const e=this.gos;this.active=e.get("pagination"),this.pageSizeFromGridOptions=e.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this))}getPaginationSelector(){return qte}isPaginateChildRows(){const e=this.gos;return e.get("groupHideParentOfSingleChild")||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")?!0:e.get("paginateChildRows")}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages(),this.dispatchPaginationChangedEvent({keepRenderedRows:!0})}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(e){const t=this.currentPage;if(!this.active||t===e||typeof t!="number")return;const{editSvc:r}=this.beans;r?.isEditing()&&(r.isBatchEditing()?r.cleanupEditors():r.stopEditing(void 0,{source:"api"})),this.currentPage=e,this.calculatePages(),this.dispatchPaginationChangedEvent({newPage:!0})}goToPageWithIndex(e){if(!this.active)return;let t=e;this.paginateChildRows||(t=this.beans.rowModel.getTopLevelIndexFromDisplayedIndex?.(e)??e),this.goToPage(Math.floor(t/this.pageSize))}isRowInPage(e){return this.active?e>=this.topDisplayedRowIndex&&e<=this.bottomDisplayedRowIndex:!0}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){const e=this.beans.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(e){this.currentPage=e}get pageSize(){return $e(this.pageSizeAutoCalculated)&&this.gos.get("paginationAutoPageSize")?this.pageSizeAutoCalculated:$e(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:$e(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:$e(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.beans.pageBounds.calculateBounds(this.topDisplayedRowIndex,this.bottomDisplayedRowIndex)}unsetAutoCalculatedPageSize(){if(this.pageSizeAutoCalculated===void 0)return;const e=this.pageSizeAutoCalculated;this.pageSizeAutoCalculated=void 0,this.pageSize!==e&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0}))}setPageSize(e,t){const r=this.pageSize;switch(t){case"autoCalculated":this.pageSizeAutoCalculated=e;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=e,this.currentPage!==0&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=e;break;case"gridOptions":this.pageSizeFromGridOptions=e,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,this.currentPage!==0&&this.goToFirstPage();break}r!==this.pageSize&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0,keepRenderedRows:!0}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){const e=this.totalPages;this.currentPage>=e&&(this.currentPage=e-1);const t=this.currentPage;(!isFinite(t)||isNaN(t)||t<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){const e=this.beans.rowModel,t=e.getTopLevelRowCount();if(this.masterRowCount=t,t<=0){this.setZeroRows();return}const r=this.pageSize,n=t-1;this.totalPages=Math.floor(n/r)+1,this.adjustCurrentPageIfInvalid();const i=this.currentPage,s=r*i;let o=r*(i+1)-1;if(o>n&&(o=n),this.topDisplayedRowIndex=e.getTopLevelRowDisplayedIndex(s),o===n)this.bottomDisplayedRowIndex=e.getRowCount()-1;else{const a=e.getTopLevelRowDisplayedIndex(o+1);this.bottomDisplayedRowIndex=a-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){const e=this.beans.rowModel.getRowCount();if(this.masterRowCount=e,e===0){this.setZeroRows();return}const{pageSize:t,currentPage:r}=this,n=e-1;this.totalPages=Math.floor(n/t)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=t*r,this.bottomDisplayedRowIndex=t*(r+1)-1,this.bottomDisplayedRowIndex>n&&(this.bottomDisplayedRowIndex=n)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.beans.rowModel.getRowCount()-1}dispatchPaginationChangedEvent(e){const{keepRenderedRows:t=!1,newPage:r=!1,newPageSize:n=!1}=e;this.eventSvc.dispatchEvent({type:"paginationChanged",animate:!1,newData:!1,newPage:r,newPageSize:n,keepRenderedRows:t})}},Qte={moduleName:"Pagination",version:Ue,beans:[Xte,Wte],icons:{first:"first",previous:"previous",next:"next",last:"last"},apiFunctions:{paginationIsLastPageFound:_te,paginationGetPageSize:Lte,paginationGetCurrentPage:Ite,paginationGetTotalPages:Ote,paginationGetRowCount:Nte,paginationGoToNextPage:Bte,paginationGoToPreviousPage:Hte,paginationGoToFirstPage:Gte,paginationGoToLastPage:Vte,paginationGoToPage:zte},dependsOn:[Jm]};function Zte(e,t={}){const r=t?t.rowNodes:void 0;e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.redrawRows(r))}function SI(e,t,r,n,i){t&&(n&&t.parent&&t.parent.level!==-1&&SI(e,t.parent,r,n,i),t.setExpanded(r,void 0,i))}function Jte(e,t){return e.rowModel.getRowNode(t)}function ere(e,t,r,n){e.rowRenderer.addRenderedRowListener(t,r,n)}function tre(e){return e.rowRenderer.getRenderedNodes()}function rre(e,t,r){e.rowModel.forEachNode(t,r)}function nre(e){return e.rowRenderer.firstRenderedRow}function ire(e){return e.rowRenderer.lastRenderedRow}function sre(e,t){return e.rowModel.getRow(t)}function ore(e){return e.rowModel.getRowCount()}var are={moduleName:"RowApi",version:Ue,apiFunctions:{redrawRows:Zte,setRowNodeExpanded:SI,getRowNode:Jte,addRenderedRowListener:ere,getRenderedNodes:tre,forEachNode:rre,getFirstDisplayedRowIndex:nre,getLastDisplayedRowIndex:ire,getDisplayedRowAtIndex:sre,getDisplayedRowCount:ore}},lre={moduleName:"ScrollApi",version:Ue,apiFunctions:{getVerticalPixelRange:yJ,getHorizontalPixelRange:bJ,ensureColumnVisible:lI,ensureIndexVisible:cI,ensureNodeVisible:SJ}};function cre(e,t,r){if(!t)return;const n=e.ctrlsSvc.getGridBodyCtrl().eGridBody,i=`aria-${t}`;r===null?n.removeAttribute(i):n.setAttribute(i,r)}function ure(e,t={}){e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.refreshCells(t))}function dre(e){e.frameworkOverrides.wrapIncoming(()=>{for(const t of e.ctrlsSvc.getHeaderRowContainerCtrls())t.refresh()})}function hre(e){return e.animationFrameSvc?.isQueueEmpty()??!0}function fre(e){e.animationFrameSvc?.flushAllFrames()}function gre(e){return{rowHeight:zl(e),headerHeight:Uf(e)}}function pre(e,t={}){const r=[];for(const s of e.rowRenderer.getCellCtrls(t.rowNodes,t.columns)){const o=s.getCellRenderer();o!=null&&r.push(hf(o))}if(t.columns?.length)return r;const n=[],i=$b(t.rowNodes);for(const s of e.rowRenderer.getAllRowCtrls()){if(i&&!jb(s.rowNode,i)||!s.isFullWidth())continue;const o=s.getFullWidthCellRenderers();for(let a=0;a<o.length;a++){const u=o[a];u!=null&&n.push(hf(u))}}return[...n,...r]}var mre={moduleName:"RenderApi",version:Ue,apiFunctions:{setGridAriaProperty:cre,refreshCells:ure,refreshHeader:dre,isAnimationFrameQueueEmpty:hre,flushAllAnimationFrames:fre,getSizesForCurrentTheme:gre,getCellRendererInstances:pre}};function vre(e,t){typeof t=="number"?e.colAutosize?.sizeColumnsToFit(t,"api"):e.colAutosize?.sizeColumnsToFitGridBody(t)}function xI({colAutosize:e,visibleCols:t},r,n){Array.isArray(r)?e?.autoSizeCols({colKeys:r,skipHeader:n,source:"api"}):e?.autoSizeCols({...r,colKeys:r.colIds??t.allCols,source:"api"})}function wre(e,t){t&&typeof t=="object"?xI(e,t):e.colAutosize?.autoSizeAllColumns({source:"api",skipHeader:t})}var Cre=class extends Ee{constructor(){super(...arguments),this.beanName="colAutosize",this.timesDelayed=0,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}postConstruct(){const{gos:e}=this,t=e.get("autoSizeStrategy");if(t){let r=!1;const n=t.type;if(n==="fitGridWidth"||n==="fitProvidedWidth")r=!0;else if(n==="fitCellContents"){this.addManagedEventListeners({firstDataRendered:()=>this.onFirstDataRendered(t)});const i=e.get("rowData");r=i!=null&&i.length>0&&_r(e)}r&&this.beans.colDelayRenderSvc?.hideColumns(n)}}autoSizeCols(e){const{eventSvc:t,visibleCols:r}=this.beans;this.innerAutoSizeCols(e).then(n=>{const i=d=>Ju(t,Array.from(d),!0,"autosizeColumns");if(!e.scaleUpToFitGridWidth)return i(n);const s=iA(this.beans),o=d=>r.leftCols.some(h=>Hh(h,d)),a=d=>r.rightCols.some(h=>Hh(h,d)),u=e.colKeys.filter(d=>!ea(d)&&!Go(d)&&!o(d)&&!a(d));this.sizeColumnsToFit(s,e.source,!0,{defaultMaxWidth:e.defaultMaxWidth,defaultMinWidth:e.defaultMinWidth,columnLimits:e.columnLimits?.map(d=>({...d,key:d.colId})),colKeys:u,onlyScaleUp:!0}),i(n)})}innerAutoSizeCols(e){return new Promise((t,r)=>{if(this.shouldQueueResizeOperations)return this.pushResizeOperation(()=>this.innerAutoSizeCols(e).then(t,r));const{colKeys:n,skipHeader:i,skipHeaderGroups:s,stopAtGroup:o,defaultMaxWidth:a,defaultMinWidth:u,columnLimits:d=[],source:h="api"}=e,{animationFrameSvc:g,renderStatus:m,colModel:v,autoWidthCalc:w,visibleCols:C}=this.beans;if(g?.flushAllFrames(),this.timesDelayed<5&&m&&(!m.areHeaderCellsRendered()||!m.areCellsRendered())){this.timesDelayed++,setTimeout(()=>{this.isAlive()&&this.innerAutoSizeCols(e).then(t,r)});return}this.timesDelayed=0;const b=new Set;let x=-1;const R=Object.fromEntries(d.map(({colId:D,...M})=>[D,M])),E=i??this.gos.get("skipHeaderOnAutoSize"),A=s??E;for(;x!==0;){x=0;const D=[];for(const M of n){if(!M||B7(M))continue;const F=v.getCol(M);if(!F||b.has(F))continue;const O=w.getPreferredWidthForColumn(F,E);if(O>0){const L=R[F.colId]??{};L.minWidth??(L.minWidth=u),L.maxWidth??(L.maxWidth=a);const W=yre(F,O,L);F.setActualWidth(W,h),b.add(F),x++}D.push(F)}D.length&&C.refresh(h)}A||this.autoSizeColumnGroupsByColumns(n,h,o),t(b)})}autoSizeColumn(e,t,r){this.autoSizeCols({colKeys:[e],skipHeader:r,skipHeaderGroups:!0,source:t})}autoSizeColumnGroupsByColumns(e,t,r){const{colModel:n,ctrlsSvc:i}=this.beans,s=new Set,o=n.getColsForKeys(e);for(const u of o){let d=u.getParent();for(;d&&d!=r;)d.isPadding()||s.add(d),d=d.getParent()}let a;for(const u of s){for(const d of i.getHeaderRowContainerCtrls())if(a=d.getHeaderCtrlForColumn(u),a)break;a?.resizeLeafColumnsToFit(t)}}autoSizeAllColumns(e){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.autoSizeAllColumns(e));return}this.autoSizeCols({colKeys:this.beans.visibleCols.allCols,...e})}addColumnAutosizeListeners(e,t){const r=this.gos.get("skipHeaderOnAutoSize"),n=()=>{this.autoSizeColumn(t,"uiColumnResized",r)};e.addEventListener("dblclick",n);const i=new Pl(e);return i.addEventListener("doubleTap",n),()=>{e.removeEventListener("dblclick",n),i.destroy()}}addColumnGroupResize(e,t,r){const n=this.gos.get("skipHeaderOnAutoSize"),i=()=>{const s=[],o=t.getDisplayedLeafColumns();for(const a of o)a.getColDef().suppressAutoSize||s.push(a.getColId());s.length>0&&this.autoSizeCols({colKeys:s,skipHeader:n,stopAtGroup:t,source:"uiColumnResized"}),r()};return e.addEventListener("dblclick",i),()=>e.removeEventListener("dblclick",i)}sizeColumnsToFitGridBody(e,t){if(!this.isAlive())return;const r=iA(this.beans);if(r>0){this.sizeColumnsToFit(r,"sizeColumnsToFit",!1,e);return}t===void 0?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,100)},0):t===100?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,500)},100):t===500?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,-1)},500):Me(29)}sizeColumnsToFit(e,t="sizeColumnsToFit",r,n){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.sizeColumnsToFit(e,t,r,n));return}const i={};for(const{key:w,...C}of n?.columnLimits??[])i[typeof w=="string"?w:w.getColId()]=C;const s=this.beans.visibleCols.allCols;if(e<=0||!s.length)return;const o=Lo(s);if(n?.onlyScaleUp&&o>e||e===o&&s.every(C=>{if(C.colDef.suppressSizeToFit)return!0;const b=i?.[C.getId()],x=b?.minWidth??n?.defaultMinWidth,R=b?.maxWidth??n?.defaultMaxWidth,E=C.getActualWidth();return(x==null||E>=x)&&(R==null||E<=R)}))return;const u=[],d=[];for(const w of s){const C=n?.colKeys?.some(b=>Hh(w,b))??!0;w.getColDef().suppressSizeToFit||!C?d.push(w):u.push(w)}const h=u.slice(0);let g=!1;const m=w=>{Ds(u,w),d.push(w)};for(const w of u){w.resetActualWidth(t);const C=i?.[w.getId()],b=C?.minWidth??n?.defaultMinWidth,x=C?.maxWidth??n?.defaultMaxWidth,R=w.getActualWidth();typeof b=="number"&&R<b?w.setActualWidth(b,t,!0):typeof x=="number"&&R>x&&w.setActualWidth(x,t,!0)}for(;!g;){g=!0;const w=e-Lo(d);if(w<=0)for(const C of u){const b=i?.[C.getId()]?.minWidth??n?.defaultMinWidth??C.minWidth;C.setActualWidth(b,t,!0)}else{const C=w/Lo(u);let b=w;for(let x=u.length-1;x>=0;x--){const R=u[x],E=i?.[R.getId()],A=E?.minWidth??n?.defaultMinWidth,D=E?.maxWidth??n?.defaultMaxWidth,M=R.getMinWidth(),F=R.getMaxWidth(),O=typeof A=="number"&&A>M?A:M,L=typeof D=="number"&&D<F?D:F;let W=Math.round(R.getActualWidth()*C);W<O?(W=O,m(R),g=!1):W>L?(W=L,m(R),g=!1):x===0&&(W=b),R.setActualWidth(W,t,!0),b-=W}}}for(const w of h)w.fireColumnWidthChangedEvent(t);const v=this.beans.visibleCols;v.setLeftValues(t),v.updateBodyWidths(),!r&&Ju(this.eventSvc,h,!0,t)}applyAutosizeStrategy(){const{gos:e,colDelayRenderSvc:t}=this.beans,r=e.get("autoSizeStrategy");r?.type!=="fitGridWidth"&&r?.type!=="fitProvidedWidth"||setTimeout(()=>{if(!this.isAlive())return;const n=r.type;if(n==="fitGridWidth"){const{columnLimits:i,defaultMinWidth:s,defaultMaxWidth:o}=r,a=i?.map(({colId:u,minWidth:d,maxWidth:h})=>({key:u,minWidth:d,maxWidth:h}));this.sizeColumnsToFitGridBody({defaultMinWidth:s,defaultMaxWidth:o,columnLimits:a})}else n==="fitProvidedWidth"&&this.sizeColumnsToFit(r.width,"sizeColumnsToFit");t?.revealColumns(n)})}onFirstDataRendered({colIds:e,...t}){setTimeout(()=>{if(!this.isAlive())return;const r="autosizeColumns";e?this.autoSizeCols({...t,source:r,colKeys:e}):this.autoSizeAllColumns({...t,source:r}),this.beans.colDelayRenderSvc?.revealColumns(t.type)})}processResizeOperations(){this.shouldQueueResizeOperations=!1;for(const e of this.resizeOperationQueue)e();this.resizeOperationQueue=[]}pushResizeOperation(e){this.resizeOperationQueue.push(e)}destroy(){this.resizeOperationQueue.length=0,super.destroy()}};function yre(e,t,r={}){const n=r.minWidth??e.getMinWidth();t<n&&(t=n);const i=r.maxWidth??e.getMaxWidth();return t>i&&(t=i),t}function iA({ctrlsSvc:e,scrollVisibleSvc:t}){const r=e.getGridBodyCtrl(),i=r.isVerticalScrollShowing()?t.getScrollbarWidth():0;return lf(r.eGridBody)-i}var bre={moduleName:"ColumnAutoSize",version:Ue,beans:[Cre],apiFunctions:{sizeColumnsToFit:vre,autoSizeColumns:xI,autoSizeAllColumns:wre},dependsOn:[EL]},Sre=".ag-row-pinned-source{background-color:var(--ag-pinned-source-row-background-color);color:var(--ag-pinned-source-row-text-color);font-weight:var(--ag-pinned-source-row-font-weight)}.ag-row-pinned-manual{background-color:var(--ag-pinned-row-background-color);color:var(--ag-pinned-row-text-color);font-weight:var(--ag-pinned-row-font-weight)}";function xre(e){return e.pinnedRowModel?.getPinnedTopRowCount()??0}function Ere(e){return e.pinnedRowModel?.getPinnedBottomRowCount()??0}function Rre(e,t){return e.pinnedRowModel?.getPinnedTopRow(t)}function Tre(e,t){return e.pinnedRowModel?.getPinnedBottomRow(t)}function Fre(e,t,r){return e.pinnedRowModel?.forEachPinnedRow(t,r)}var Dre={moduleName:"PinnedRow",version:Ue,beans:[H$],css:[Sre],apiFunctions:{getPinnedTopRowCount:xre,getPinnedBottomRowCount:Ere,getPinnedTopRow:Rre,getPinnedBottomRow:Tre,forEachPinnedRow:Fre},icons:{rowPin:"pin",rowPinTop:"pinned-top",rowPinBottom:"pinned-bottom",rowUnpin:"un-pin"}},Are=class{constructor(e,t){this.col=e,this.firstNode=t,this.cellSpan=!0,this.spannedNodes=new Set,this.addSpannedNode(t)}reset(){this.spannedNodes.clear(),this.addSpannedNode(this.firstNode)}addSpannedNode(e){this.spannedNodes.add(e),this.lastNode=e}getLastNode(){return this.lastNode}getCellHeight(){return this.lastNode.rowTop+this.lastNode.rowHeight-this.firstNode.rowTop-1}doesSpanContain(e){return e.column!==this.col||e.rowPinned!=this.firstNode.rowPinned?!1:this.firstNode.rowIndex<=e.rowIndex&&e.rowIndex<=this.lastNode.rowIndex}getLastNodeAutoHeight(){const e=this.firstNode.__autoHeights?.[this.col.getColId()];if(e==null)return;let t=0;for(const r of this.spannedNodes)r!==this.lastNode&&(t+=r.rowHeight);return e-t}},kre=class extends Ee{constructor(e){super(),this.column=e}buildCache(e){const{column:t,beans:{gos:r,pinnedRowModel:n,rowModel:i,valueSvc:s,pagination:o}}=this,{colDef:a}=t,u=this.getNodeMap(e),d=new Map,h=r.getCallback("isFullWidthRow"),g=a.equals,m=a.spanRows,v=typeof m=="function";let w=null,C=null,b;const x=(E,A)=>{w=E,C=null,b=A},R=E=>{const A=!E.isExpandable()&&!E.group&&!E.detail&&(h?!h({rowNode:E}):!0);if(E.rowIndex==null||!A){x(null,null);return}if(w==null||E.level!==w.level||E.footer||C&&E.rowIndex-1!==C?.getLastNode().rowIndex){x(E,s.getValue(t,E));return}const D=s.getValue(t,E);if(v){const M=it(r,{valueA:b,nodeA:w,valueB:D,nodeB:E,column:t,colDef:a});if(!m(M)){x(E,D);return}}else if(g?!g(b,D):b!==D){x(E,D);return}if(!C){const M=u?.get(w);M?.firstNode===w?(M.reset(),C=M):C=new Are(t,w),d.set(w,C)}C.addSpannedNode(E),d.set(E,C)};switch(e){case"center":i.forEachDisplayedNode?.(E=>{(!o||o.isRowInPage(E.rowIndex))&&R(E)}),this.centerValueNodeMap=d;break;case"top":n?.forEachPinnedRow("top",R),this.topValueNodeMap=d;break;case"bottom":n?.forEachPinnedRow("bottom",R),this.bottomValueNodeMap=d;break}}isCellSpanning(e){return!!this.getCellSpan(e)}getCellSpan(e){return this.getNodeMap(e.rowPinned).get(e)}getNodeMap(e){switch(e){case"top":return this.topValueNodeMap;case"bottom":return this.bottomValueNodeMap;default:return this.centerValueNodeMap}}},Pre=class extends Ee{constructor(){super(...arguments),this.beanName="rowSpanSvc",this.spanningColumns=new Map,this.debouncePinnedEvent=yn(this,this.dispatchCellsUpdatedEvent.bind(this,!0),0),this.debounceModelEvent=yn(this,this.dispatchCellsUpdatedEvent.bind(this,!1),0),this.pinnedTimeout=null,this.modelTimeout=null}postConstruct(){const e=this.onRowDataUpdated.bind(this),t=this.buildPinnedCaches.bind(this);this.addManagedEventListeners({paginationChanged:this.buildModelCaches.bind(this),pinnedRowDataChanged:t,pinnedRowsChanged:t,rowNodeDataChanged:e,cellValueChanged:e})}register(e){const{gos:t}=this.beans;if(!t.get("enableCellSpan")||this.spanningColumns.has(e))return;const r=this.createManagedBean(new kre(e));this.spanningColumns.set(e,r),r.buildCache("top"),r.buildCache("bottom"),r.buildCache("center"),this.debouncePinnedEvent(),this.debounceModelEvent()}dispatchCellsUpdatedEvent(e){this.dispatchLocalEvent({type:"spannedCellsUpdated",pinned:e})}deregister(e){this.spanningColumns.delete(e)}onRowDataUpdated({node:e}){const{spannedRowRenderer:t}=this.beans;if(e.rowPinned){if(this.pinnedTimeout!=null)return;this.pinnedTimeout=window.setTimeout(()=>{this.pinnedTimeout=null,this.buildPinnedCaches(),t?.createCtrls("top"),t?.createCtrls("bottom")},0);return}this.modelTimeout==null&&(this.modelTimeout=window.setTimeout(()=>{this.modelTimeout=null,this.buildModelCaches(),t?.createCtrls("center")},0))}buildModelCaches(){this.modelTimeout!=null&&clearTimeout(this.modelTimeout),this.spanningColumns.forEach(e=>e.buildCache("center")),this.debounceModelEvent()}buildPinnedCaches(){this.pinnedTimeout!=null&&clearTimeout(this.pinnedTimeout),this.spanningColumns.forEach(e=>{e.buildCache("top"),e.buildCache("bottom")}),this.debouncePinnedEvent()}isCellSpanning(e,t){const r=this.spanningColumns.get(e);return r?r.isCellSpanning(t):!1}getCellSpanByPosition(e){const{pinnedRowModel:t,rowModel:r}=this.beans,n=e.column,i=e.rowIndex,s=this.spanningColumns.get(n);if(!s)return;let o;switch(e.rowPinned){case"top":o=t?.getPinnedTopRow(i);break;case"bottom":o=t?.getPinnedBottomRow(i);break;default:o=r.getRow(i)}if(o)return s.getCellSpan(o)}getCellStart(e){const t=this.getCellSpanByPosition(e);return t?{...e,rowIndex:t.firstNode.rowIndex}:e}getCellEnd(e){const t=this.getCellSpanByPosition(e);return t?{...e,rowIndex:t.getLastNode().rowIndex}:e}getCellSpan(e,t){const r=this.spanningColumns.get(e);if(r)return r.getCellSpan(t)}forEachSpannedColumn(e,t){for(const[r,n]of this.spanningColumns)if(n.isCellSpanning(e)){const i=n.getCellSpan(e);t(r,i)}}destroy(){super.destroy(),this.spanningColumns.clear()}},Mre=class extends Hu{constructor(e,t,r){super(e.col,e.firstNode,r,t),this.cellSpan=e,this.SPANNED_CELL_CSS_CLASS="ag-spanned-cell"}setComp(e,t,r,n,i,s,o){this.eWrapper=r,super.setComp(e,t,r,n,i,s,o),this.setAriaRowSpan(),this.refreshAriaRowIndex()}isCellSpanning(){return!0}getCellSpan(){return this.cellSpan}refreshAriaRowIndex(){const{eGui:e,rowNode:t}=this;!e||t.rowIndex==null||PM(e,t.rowIndex)}setAriaRowSpan(){kz(this.eGui,this.cellSpan.spannedNodes.size)}setFocusedCellPosition(e){this.focusedCellPosition=e}getFocusedCellPosition(){return this.focusedCellPosition??this.cellPosition}checkCellFocused(){const e=this.beans.focusSvc.getFocusedCell();return!!e&&this.cellSpan.doesSpanContain(e)}applyStaticCssClasses(){super.applyStaticCssClasses(),this.comp.toggleCss(this.SPANNED_CELL_CSS_CLASS,!0)}onCellFocused(e){const{beans:t}=this;if(Xm(t)){this.focusedCellPosition=void 0;return}const r=this.isCellFocused();r||(this.focusedCellPosition=void 0),e&&r&&(this.focusedCellPosition={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column}),super.onCellFocused(e)}getRootElement(){return this.eWrapper}},_re=class extends U0{onRowIndexChanged(){super.onRowIndexChanged();for(const e of this.getAllCellCtrls())e.refreshAriaRowIndex()}getInitialRowClasses(e){return["ag-spanned-row"]}getNewCellCtrl(e){const t=this.beans.rowSpanSvc?.getCellSpan(e,this.rowNode);if(!(!t||t.firstNode!==this.rowNode))return new Mre(t,this,this.beans)}isCorrectCtrlForSpan(e){const t=this.beans.rowSpanSvc?.getCellSpan(e.column,this.rowNode);return!t||t.firstNode!==this.rowNode?!1:e.getCellSpan()===t}onRowHeightChanged(){}refreshFirstAndLastRowStyles(){}addHoverFunctionality(){}resetHoveredStatus(){}},Lre=class extends Ee{constructor(){super(...arguments),this.beanName="spannedRowRenderer",this.topCtrls=new Map,this.bottomCtrls=new Map,this.centerCtrls=new Map}postConstruct(){this.addManagedEventListeners({displayedRowsChanged:this.createAllCtrls.bind(this)})}createAllCtrls(){this.createCtrls("top"),this.createCtrls("bottom"),this.createCtrls("center")}createCtrls(e){const{rowSpanSvc:t}=this.beans,r=this.getCtrlsMap(e),n=r.size,i=this.getAllRelevantRowControls(e),s=new Map;let o=!1;for(const u of i)u.isAlive()&&t?.forEachSpannedColumn(u.rowNode,(d,h)=>{if(s.has(h.firstNode))return;const g=r.get(h.firstNode);if(g){s.set(h.firstNode,g),r.delete(h.firstNode);return}o=!0;const m=new _re(h.firstNode,this.beans,!1,!1,!1);s.set(h.firstNode,m)});this.setCtrlsMap(e,s);const a=s.size===n;if(!(!o&&a)){for(const u of r.values())u.destroyFirstPass(!0),u.destroySecondPass();this.dispatchLocalEvent({type:"spannedRowsUpdated",ctrlsKey:e})}}getAllRelevantRowControls(e){const{rowRenderer:t}=this.beans;switch(e){case"top":return t.topRowCtrls;case"bottom":return t.bottomRowCtrls;case"center":return t.allRowCtrls}}getCellByPosition(e){const{rowSpanSvc:t}=this.beans,r=t?.getCellSpanByPosition(e);if(!r)return;const n=this.getCtrlsMap(e.rowPinned).get(r.firstNode);if(n)return n.getAllCellCtrls().find(i=>i.column===e.column)}getCtrls(e){return[...this.getCtrlsMap(e).values()]}destroyRowCtrls(e){for(const t of this.getCtrlsMap(e).values())t.destroyFirstPass(!0),t.destroySecondPass();this.setCtrlsMap(e,new Map)}getCtrlsMap(e){switch(e){case"top":return this.topCtrls;case"bottom":return this.bottomCtrls;default:return this.centerCtrls}}setCtrlsMap(e,t){switch(e){case"top":this.topCtrls=t;break;case"bottom":this.bottomCtrls=t;break;default:this.centerCtrls=t;break}}destroy(){super.destroy(),this.destroyRowCtrls("top"),this.destroyRowCtrls("bottom"),this.destroyRowCtrls("center")}},Ire={moduleName:"CellSpan",version:Ue,beans:[Pre,Lre]},Ore=class extends Ee{constructor(e,t){super(),this.cellCtrl=e,this.staticClasses=[],this.beans=t,this.column=e.column}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){const{column:e,cellComp:t}=this,r=e.colDef,n=r.cellClassRules,i=this.getCellClassParams(e,r);Lx(this.beans.expressionSvc,n===this.cellClassRules?void 0:this.cellClassRules,n,i,s=>t.toggleCss(s,!0),s=>t.toggleCss(s,!1)),this.cellClassRules=n}applyUserStyles(){const e=this.column,t=e.colDef,r=t.cellStyle;if(!r)return;let n;if(typeof r=="function"){const i=this.getCellClassParams(e,t);n=r(i)}else n=r;n&&this.cellComp.setUserStyles(n)}applyClassesFromColDef(){const{column:e,cellComp:t}=this,r=e.colDef,n=this.getCellClassParams(e,r);for(const s of this.staticClasses)t.toggleCss(s,!1);const i=this.beans.cellStyles.getStaticCellClasses(r,n);this.staticClasses=i;for(const s of i)t.toggleCss(s,!0)}getCellClassParams(e,t){const{value:r,rowNode:n}=this.cellCtrl;return it(this.beans.gos,{value:r,data:n.data,node:n,colDef:t,column:e,rowIndex:n.rowIndex})}},Nre=class extends Ee{constructor(){super(...arguments),this.beanName="cellStyles"}processAllCellClasses(e,t,r,n){Lx(this.beans.expressionSvc,void 0,e.cellClassRules,t,r,n),this.processStaticCellClasses(e,t,r)}getStaticCellClasses(e,t){const{cellClass:r}=e;if(!r)return[];let n;return typeof r=="function"?n=r(t):n=r,typeof n=="string"&&(n=[n]),n||[]}createCellCustomStyleFeature(e,t){return new Ore(e,t)}processStaticCellClasses(e,t,r){this.getStaticCellClasses(e,t).forEach(i=>{r(i)})}},Bre={moduleName:"CellStyle",version:Ue,beans:[Nre]},Hre={moduleName:"RowStyle",version:Ue,beans:[EX]};function Gre(e,t){return!!e.colHover?.isHovered(t)}var Vre=class extends Ee{constructor(e,t){super(),this.columns=e,this.element=t,this.destroyManagedListeners=[],this.enableFeature=r=>{const{beans:n,gos:i,element:s,columns:o}=this,a=n.colHover;if(r??!!i.get("columnHoverHighlight"))this.destroyManagedListeners=this.addManagedElementListeners(s,{mouseover:a.setMouseOver.bind(a,o),mouseout:a.clearMouseOver.bind(a)});else{for(const d of this.destroyManagedListeners)d();this.destroyManagedListeners=[]}}}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{this.enableFeature(e)}),this.enableFeature()}destroy(){super.destroy(),this.destroyManagedListeners=null}},zre="ag-column-hover",Wre=class extends Ee{constructor(){super(...arguments),this.beanName="colHover"}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{e||this.clearMouseOver()})}setMouseOver(e){this.updateState(e)}clearMouseOver(){this.updateState(null)}isHovered(e){if(!this.gos.get("columnHoverHighlight"))return!1;const t=this.selectedColumns;return!!t&&t.indexOf(e)>=0}addHeaderColumnHoverListener(e,t,r){const n=()=>{const i=this.isHovered(r);t.toggleCss("ag-column-hover",i)};e.addManagedEventListeners({columnHoverChanged:n}),n()}onCellColumnHover(e,t){if(!t)return;const r=this.isHovered(e);t.toggleCss(zre,r)}addHeaderFilterColumnHoverListener(e,t,r,n){this.createHoverFeature(e,[r],n);const i=()=>{const s=this.isHovered(r);t.toggleCss("ag-column-hover",s)};e.addManagedEventListeners({columnHoverChanged:i}),i()}createHoverFeature(e,t,r){e.createManagedBean(new Vre(t,r))}updateState(e){this.selectedColumns=e,this.eventSvc.dispatchEvent({type:"columnHoverChanged"})}},Ure={moduleName:"ColumnHover",version:Ue,beans:[Wre],apiFunctions:{isColumnHovered:Gre}},$re=class extends Ee{constructor(){super(...arguments),this.beanName="apiEventSvc",this.syncListeners=new Map,this.asyncListeners=new Map,this.syncGlobalListeners=new Set,this.globalListenerPairs=new Map}postConstruct(){this.wrapSvc=this.beans.frameworkOverrides.createGlobalEventListenerWrapper?.()}addListener(e,t){const r=this.wrapSvc?.wrap(e,t)??t,n=!d0.has(e),i=n?this.asyncListeners:this.syncListeners;i.has(e)||i.set(e,new Set),i.get(e).add(r),this.eventSvc.addListener(e,r,n)}removeListener(e,t){const r=this.wrapSvc?.unwrap(e,t)??t,i=!!this.asyncListeners.get(e)?.delete(r);i||this.syncListeners.get(e)?.delete(r),this.eventSvc.removeListener(e,r,i)}addGlobalListener(e){const t=this.wrapSvc?.wrapGlobal(e)??e,r=(s,o)=>{d0.has(s)&&t(s,o)},n=(s,o)=>{d0.has(s)||t(s,o)};this.globalListenerPairs.set(e,{syncListener:r,asyncListener:n});const i=this.eventSvc;i.addGlobalListener(r,!1),i.addGlobalListener(n,!0)}removeGlobalListener(e){const{eventSvc:t,wrapSvc:r,globalListenerPairs:n}=this,i=r?.unwrapGlobal(e)??e;if(n.has(i)){const{syncListener:o,asyncListener:a}=n.get(i);t.removeGlobalListener(o,!1),t.removeGlobalListener(a,!0),n.delete(e)}else this.syncGlobalListeners.delete(i),t.removeGlobalListener(i,!1)}destroyEventListeners(e,t){e.forEach((r,n)=>{r.forEach(i=>this.eventSvc.removeListener(n,i,t)),r.clear()}),e.clear()}destroyGlobalListeners(e,t){for(const r of e)this.eventSvc.removeGlobalListener(r,t);e.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncListeners,!1),this.destroyEventListeners(this.asyncListeners,!0),this.destroyGlobalListeners(this.syncGlobalListeners,!1);const{globalListenerPairs:e,eventSvc:t}=this;e.forEach(({syncListener:r,asyncListener:n})=>{t.removeGlobalListener(r,!1),t.removeGlobalListener(n,!0)}),e.clear()}};function jre(e,t,r){e.apiEventSvc?.addListener(t,r)}function Yre(e,t,r){e.apiEventSvc?.removeListener(t,r)}function Kre(e,t){e.apiEventSvc?.addGlobalListener(t)}function qre(e,t){e.apiEventSvc?.removeGlobalListener(t)}var Xre={moduleName:"EventApi",version:Ue,apiFunctions:{addEventListener:jre,addGlobalListener:Kre,removeEventListener:Yre,removeGlobalListener:qre},beans:[$re]},Qre={moduleName:"Locale",version:Ue,beans:[EQ]},Zre=class extends Ee{constructor(){super(...arguments),this.beanName="rowAutoHeight",this.wasEverActive=!1,this._debouncedCalculateRowHeights=yn(this,this.calculateRowHeights.bind(this),1)}requestCheckAutoHeight(){this.wasEverActive&&this._debouncedCalculateRowHeights()}calculateRowHeights(){const{visibleCols:e,rowModel:t,rowSpanSvc:r,pinnedRowModel:n}=this.beans,i=e.autoHeightCols;let s=!1;const o=a=>{const u=a.__autoHeights;let d=$a(this.beans,a).height;for(const h of i){let g=u?.[h.getColId()];const m=r?.getCellSpan(h,a);if(m){if(m.getLastNode()!==a)continue;if(g=r?.getCellSpan(h,a)?.getLastNodeAutoHeight(),!g)return}if(g==null){if(this.colSpanSkipCell(h,a))continue;return}d=Math.max(g,d)}d!==a.rowHeight&&(a.setRowHeight(d),s=!0)};n?.forEachPinnedRow?.("top",o),n?.forEachPinnedRow?.("bottom",o),t.forEachDisplayedNode?.(o),s&&t.onRowHeightChanged?.()}setRowAutoHeight(e,t,r){if(e.__autoHeights??(e.__autoHeights={}),t==null){delete e.__autoHeights[r.getId()];return}const n=e.__autoHeights[r.getId()];e.__autoHeights[r.getId()]=t,n!==t&&this.requestCheckAutoHeight()}colSpanSkipCell(e,t){const{colModel:r,colViewport:n,visibleCols:i}=this.beans;if(!r.colSpanActive)return!1;let s=[];switch(e.getPinned()){case"left":s=i.getLeftColsForRow(t);break;case"right":s=i.getRightColsForRow(t);break;case null:s=n.getColsWithinViewport(t);break}return!s.includes(e)}setupCellAutoHeight(e,t,r){if(!e.column.isAutoHeight()||!t)return!1;this.wasEverActive=!0;const n=t.parentElement,{rowNode:i,column:s}=e,o=this.beans,a=h=>{if(this.beans.editSvc?.isEditing(e)||!e.isAlive()||!r.isAlive())return;const{paddingTop:g,paddingBottom:m,borderBottomWidth:v,borderTopWidth:w}=gc(n),C=g+m+v+w,x=t.offsetHeight+C;if(h<5){const E=!un(o)?.contains(t),A=x==0;if(E||A){window.setTimeout(()=>a(h+1),0);return}}this.setRowAutoHeight(i,x,s)},u=()=>a(0);u();const d=Zo(o,t,u);return r.addDestroyFunc(()=>{d(),this.setRowAutoHeight(i,void 0,s)}),!0}setAutoHeightActive(e){this.active=e.list.some(t=>t.isVisible()&&t.isAutoHeight())}areRowsMeasured(){if(!this.active)return!0;const e=this.beans.rowRenderer.getAllRowCtrls();let t=null;for(const{rowNode:r}of e)if((!t||this.beans.colModel.colSpanActive)&&(t=this.beans.colViewport.getColsWithinViewport(r).filter(i=>i.isAutoHeight())),t.length!==0){if(!r.__autoHeights)return!1;for(const n of t){const i=r.__autoHeights[n.getColId()];if(!i||r.rowHeight<i)return!1}}return!0}},Jre={moduleName:"RowAutoHeight",version:Ue,beans:[Zre]},ene={moduleName:"AllCommunity",version:Ue,dependsOn:[Zee,ote,mte,WQ,JJ,eee,tee,ree,nee,iee,see,ZJ,$Z,jZ,YZ,UZ,qZ,XZ,Mte,kee,Qte,RL,are,lre,mre,bre,Nj,Dre,yee,oQ,Bre,Ure,Hre,Xre,cQ,Tte,aI,Qre,Jre,Oj,Jee,Ire]},On=Oe.createContext({}),EI=Oe.createContext("default"),jf=(e,t,r,n)=>{if(!e||e.componentFromFramework||t.isDestroyed())return;const s=e.newAgStackInstance();let o,a,u=!1;return s.then(d=>{if(u){t.destroyBean(d);return}o=d,a=o.getGui(),r.appendChild(a),sA(n,o)}),()=>{u=!0,o&&(a?.remove(),t.destroyBean(o),n&&sA(n,void 0))}},sA=(e,t)=>{if(e)if(e instanceof Function)e(t);else{const r=e;r.current=t}},Ji=(...e)=>e.filter(r=>r!=null&&r!=="").join(" "),rs=class RI{constructor(...t){this.classesMap={};for(const r of t)this.classesMap[r]=!0}setClass(t,r){if(!!this.classesMap[t]==r)return this;const i=new RI;return i.classesMap={...this.classesMap},i.classesMap[t]=r,i}toString(){return Object.keys(this.classesMap).filter(r=>this.classesMap[r]).join(" ")}},Cd=e=>{const t=()=>typeof Symbol=="function"&&Symbol.for,r=()=>t()?Symbol.for("react.memo"):60115;return typeof e=="function"&&!(e.prototype&&e.prototype.isReactComponent)||typeof e=="object"&&e.$$typeof===r()},Qb=Oe.version?.split(".")[0],TI=Qb==="16"||Qb==="17";function tne(){return Qb==="19"}var f0=!1;function rne(e){return f0||setTimeout(()=>f0=!1,0),f0=!0,e()}var vf=(e,t)=>{!TI&&e&&!f0?bP.flushSync(t):t()},nne=e=>{TI?e():Oe.startTransition(e)};function ine(e,t,r){return Oe.useSyncExternalStore?Oe.useSyncExternalStore(e,t):r}function Y0(e,t,r){if(t==null||e==null)return t;if(e===t||t.length===0&&e.length===0)return e;if(r||e.length===0&&t.length>0||e.length>0&&t.length===0)return t;const n=[],i=[],s=new Map,o=new Map;for(let a=0;a<t.length;a++){const u=t[a];o.set(u.instanceId,u)}for(let a=0;a<e.length;a++){const u=e[a];s.set(u.instanceId,u),o.has(u.instanceId)&&n.push(u)}for(let a=0;a<t.length;a++){const u=t[a],d=u.instanceId;s.has(d)||i.push(u)}return n.length===e.length&&i.length===0?e:n.length===0&&i.length===t.length?t:n.length===0?i:i.length===0?n:[...n,...i]}var FI=T.forwardRef((e,t)=>{const{registry:r,context:n}=T.useContext(On),i=T.useRef(null),s=T.useRef(null),o=T.useRef(null),a=T.useRef(null),u=T.useRef(null),d=T.useRef(),[h,g]=T.useState(),[m,v]=T.useState(),[w,C]=T.useState(),[b,x]=T.useState(()=>new rs),[R,E]=T.useState(()=>new rs("ag-hidden")),[A,D]=T.useState(()=>new rs("ag-hidden")),[M,F]=T.useState(()=>new rs("ag-invisible"));T.useImperativeHandle(t,()=>({refresh(){return!1}})),T.useLayoutEffect(()=>jf(h,n,s.current),[h]);const O=T.useCallback(Y=>{if(i.current=Y,!Y||n.isDestroyed()){d.current=n.destroyBean(d.current);return}const Q={setInnerRenderer:(se,N)=>{g(se),C(N)},setChildCount:se=>v(se),toggleCss:(se,N)=>x(P=>P.setClass(se,N)),setContractedDisplayed:se=>D(N=>N.setClass("ag-hidden",!se)),setExpandedDisplayed:se=>E(N=>N.setClass("ag-hidden",!se)),setCheckboxVisible:se=>F(N=>N.setClass("ag-invisible",!se)),setCheckboxSpacing:se=>F(N=>N.setClass("ag-group-checkbox-spacing",se))},U=r.createDynamicBean("groupCellRendererCtrl",!0);U&&(d.current=n.createBean(U),d.current.init(Q,Y,o.current,a.current,u.current,FI,e))},[]),L=T.useMemo(()=>`ag-cell-wrapper ${b.toString()}`,[b]),W=T.useMemo(()=>`ag-group-expanded ${R.toString()}`,[R]),I=T.useMemo(()=>`ag-group-contracted ${A.toString()}`,[A]),G=T.useMemo(()=>`ag-group-checkbox ${M.toString()}`,[M]),ne=h?.componentFromFramework,ie=ne?h.componentClass:void 0,J=h==null&&w!=null,_=md(w);return Oe.createElement("span",{className:L,ref:O,...e.colDef?{}:{role:d.current?.getCellAriaRole()}},Oe.createElement("span",{className:W,ref:a}),Oe.createElement("span",{className:I,ref:u}),Oe.createElement("span",{className:G,ref:o}),Oe.createElement("span",{className:"ag-group-value",ref:s},J?_:ne?Oe.createElement(ie,{...h.params}):null),Oe.createElement("span",{className:"ag-group-child-count"},m))}),oA=FI,zx=T.createContext({setMethods:()=>{}}),sne=e=>{const{initialProps:t,addUpdateCallback:r,CustomComponentClass:n,setMethods:i}=e,[{key:s,...o},a]=T.useState(t);return T.useEffect(()=>{r(u=>a(u))},[]),Oe.createElement(zx.Provider,{value:{setMethods:i}},Oe.createElement(n,{key:s,...o}))},one=T.memo(sne),ane=0;function aA(){return`agPortalKey_${++ane}`}var DI=class{constructor(e,t,r,n){this.portal=null,this.oldPortal=null,this.reactComponent=e,this.portalManager=t,this.componentType=r,this.suppressFallbackMethods=!!n,this.statelessComponent=this.isStateless(this.reactComponent),this.key=aA(),this.portalKey=aA(),this.instanceCreated=this.isStatelessComponent()?Nt.resolve(!1):new Nt(i=>{this.resolveInstanceCreated=i})}getGui(){return this.eParentElement}getRootElement(){return this.eParentElement.firstChild}destroy(){this.componentInstance&&typeof this.componentInstance.destroy=="function"&&this.componentInstance.destroy();const e=this.portal;e&&this.portalManager.destroyPortal(e)}createParentElement(e){const t=this.portalManager.getComponentWrappingElement(),r=document.createElement(t||"div");return r.classList.add("ag-react-container"),e.reactContainer=r,r}statelessComponentRendered(){return this.eParentElement.childElementCount>0||this.eParentElement.childNodes.length>0}getFrameworkComponentInstance(){return this.componentInstance}isStatelessComponent(){return this.statelessComponent}getReactComponentName(){return this.reactComponent.name}getMemoType(){return this.hasSymbol()?Symbol.for("react.memo"):60115}hasSymbol(){return typeof Symbol=="function"&&Symbol.for}isStateless(e){return typeof e=="function"&&!(e.prototype&&e.prototype.isReactComponent)||typeof e=="object"&&e.$$typeof===this.getMemoType()}hasMethod(e){const t=this.getFrameworkComponentInstance();return!!t&&t[e]!=null||this.fallbackMethodAvailable(e)}callMethod(e,t){const r=this.getFrameworkComponentInstance();if(this.isStatelessComponent())return this.fallbackMethod(e,t&&t[0]?t[0]:{});if(!r){setTimeout(()=>this.callMethod(e,t));return}const n=r[e];if(n)return n.apply(r,t);if(this.fallbackMethodAvailable(e))return this.fallbackMethod(e,t&&t[0]?t[0]:{})}addMethod(e,t){this[e]=t}init(e){return this.eParentElement=this.createParentElement(e),this.createOrUpdatePortal(e),new Nt(t=>this.createReactComponent(t))}createOrUpdatePortal(e){this.isStatelessComponent()||(this.ref=t=>{this.componentInstance=t,this.resolveInstanceCreated?.(!0),this.resolveInstanceCreated=void 0},e.ref=this.ref),this.reactElement=this.createElement(this.reactComponent,{...e,key:this.key}),this.portal=Of.createPortal(this.reactElement,this.eParentElement,this.portalKey)}createElement(e,t){return T.createElement(e,t)}createReactComponent(e){this.portalManager.mountReactPortal(this.portal,this,e)}rendered(){return this.isStatelessComponent()&&this.statelessComponentRendered()||!!(!this.isStatelessComponent()&&this.getFrameworkComponentInstance())}refreshComponent(e){this.oldPortal=this.portal,this.createOrUpdatePortal(e),this.portalManager.updateReactPortal(this.oldPortal,this.portal)}fallbackMethod(e,t){const r=this[`${e}Component`];if(!this.suppressFallbackMethods&&r)return r.bind(this)(t)}fallbackMethodAvailable(e){return this.suppressFallbackMethods?!1:!!this[`${e}Component`]}};function rv(e,t,r){for(const n of e){const i=t[n];i&&(r[n]=i)}}var Pi=class extends DI{constructor(){super(...arguments),this.awaitUpdateCallback=new Nt(e=>{this.resolveUpdateCallback=e}),this.wrapperComponent=one}init(e){return this.sourceParams=e,super.init(this.getProps())}addMethod(){}getInstance(){return this.instanceCreated.then(()=>this.componentInstance)}getFrameworkComponentInstance(){return this}createElement(e,t){return super.createElement(this.wrapperComponent,{initialProps:t,CustomComponentClass:e,setMethods:r=>this.setMethods(r),addUpdateCallback:r=>{this.updateCallback=()=>(r(this.getProps()),new Nt(n=>{setTimeout(()=>{n()})})),this.resolveUpdateCallback()}})}setMethods(e){this.providedMethods=e,rv(this.getOptionalMethods(),this.providedMethods,this)}getOptionalMethods(){return[]}getProps(){return{...this.sourceParams,key:this.key,ref:this.ref}}refreshProps(){return this.updateCallback?this.updateCallback():new Nt(e=>this.awaitUpdateCallback.then(()=>{this.updateCallback().then(()=>e())}))}},lne=class extends Pi{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},cne=class extends Pi{constructor(){super(...arguments),this.date=null,this.onDateChange=e=>this.updateDate(e)}getDate(){return this.date}setDate(e){this.date=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled"]}updateDate(e){this.setDate(e),this.sourceParams.onDateChanged()}getProps(){const e=super.getProps();return e.date=this.date,e.onDateChange=this.onDateChange,delete e.onDateChanged,e}},une=class extends Pi{constructor(){super(...arguments),this.label="",this.icon=null,this.shake=!1}setIcon(e,t){this.icon=e,this.shake=t,this.refreshProps()}setLabel(e){this.label=e,this.refreshProps()}getProps(){const e=super.getProps(),{label:t,icon:r,shake:n}=this;return e.label=t,e.icon=r,e.shake=n,e}},dne=class extends Pi{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e),this.onUiChange=()=>this.sourceParams.filterModifiedCallback(),this.expectingNewMethods=!0,this.hasBeenActive=!1,this.awaitSetMethodsCallback=new Nt(e=>{this.resolveSetMethodsCallback=e})}isFilterActive(){return this.model!=null}doesFilterPass(e){return this.providedMethods.doesFilterPass(e)}getModel(){return this.model}setModel(e){return this.expectingNewMethods=!0,this.model=e,this.hasBeenActive||(this.hasBeenActive=this.isFilterActive()),this.refreshProps()}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}afterGuiAttached(e){const t=this.providedMethods;t?t.afterGuiAttached?.(e):this.awaitSetMethodsCallback.then(()=>this.providedMethods?.afterGuiAttached?.(e))}getOptionalMethods(){return["afterGuiDetached","onNewRowsLoaded","getModelAsString","onAnyFilterChanged"]}setMethods(e){this.expectingNewMethods===!1&&this.hasBeenActive&&this.providedMethods?.doesFilterPass!==e?.doesFilterPass&&setTimeout(()=>{this.sourceParams.filterChangedCallback()}),this.expectingNewMethods=!1,super.setMethods(e),this.resolveSetMethodsCallback(),this.resolveFilterPassCallback?.(),this.resolveFilterPassCallback=void 0}updateModel(e){this.resolveFilterPassCallback?.();const t=new Nt(r=>{this.resolveFilterPassCallback=r});this.setModel(e).then(()=>{t.then(()=>{this.sourceParams.filterChangedCallback()})})}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e.onUiChange=this.onUiChange,delete e.filterChangedCallback,e}},hne=class extends Pi{constructor(){super(...arguments),this.awaitSetMethodsCallback=new Nt(e=>{this.resolveSetMethodsCallback=e})}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}afterGuiAttached(e){const t=this.providedMethods;t?t.afterGuiAttached?.(e):this.awaitSetMethodsCallback.then(()=>this.providedMethods?.afterGuiAttached?.(e))}getOptionalMethods(){return["afterGuiDetached","onNewRowsLoaded","onAnyFilterChanged"]}setMethods(e){super.setMethods(e),this.resolveSetMethodsCallback()}};function AI(e,t){e.parentFilterInstance(r=>{(r.setModel(t)||Nt.resolve()).then(()=>{e.filterParams.filterChangedCallback()})})}var fne=class{constructor(e,t){this.floatingFilterParams=e,this.refreshProps=t,this.model=null,this.onModelChange=r=>this.updateModel(r)}getProps(){return{...this.floatingFilterParams,model:this.model,onModelChange:this.onModelChange}}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.floatingFilterParams=e,this.refreshProps()}setMethods(e){rv(this.getOptionalMethods(),e,this)}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),AI(this.floatingFilterParams,e)}},gne=class extends Pi{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e)}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),AI(this.sourceParams,e)}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e}},pne=class extends Pi{refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached"]}},mne=class extends Pi{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},vne=class extends Pi{refresh(e){this.sourceParams=e,this.refreshProps()}},wne=class extends Pi{constructor(){super(...arguments),this.active=!1,this.expanded=!1,this.onActiveChange=e=>this.updateActive(e)}setActive(e){this.awaitSetActive(e)}setExpanded(e){this.expanded=e,this.refreshProps()}getOptionalMethods(){return["select","configureDefaults"]}awaitSetActive(e){return this.active=e,this.refreshProps()}updateActive(e){const t=this.awaitSetActive(e);e&&t.then(()=>this.sourceParams.onItemActivated())}getProps(){const e=super.getProps();return e.active=this.active,e.expanded=this.expanded,e.onActiveChange=this.onActiveChange,delete e.onItemActivated,e}},Cne=class extends Pi{refresh(e){this.sourceParams=e,this.refreshProps()}},yne=class extends Pi{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},bne=class extends Pi{constructor(){super(...arguments),this.onStateChange=e=>this.updateState(e)}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}getState(){return this.state}updateState(e){this.state=e,this.refreshProps(),this.sourceParams.onStateUpdated()}getProps(){const e=super.getProps();return e.state=this.state,e.onStateChange=this.onStateChange,e}};function Wx(){Me(231)}var Sne=1e3,xne=class{constructor(e,t,r){this.destroyed=!1,this.portals=[],this.hasPendingPortalUpdate=!1,this.wrappingElement=t||"div",this.refresher=e,this.maxComponentCreationTimeMs=r||Sne}getPortals(){return this.portals}destroy(){this.destroyed=!0}destroyPortal(e){this.portals=this.portals.filter(t=>t!==e),this.batchUpdate()}getComponentWrappingElement(){return this.wrappingElement}mountReactPortal(e,t,r){this.portals=[...this.portals,e],this.waitForInstance(t,r),this.batchUpdate()}updateReactPortal(e,t){this.portals[this.portals.indexOf(e)]=t,this.batchUpdate()}batchUpdate(){this.hasPendingPortalUpdate||(setTimeout(()=>{this.destroyed||(this.refresher(),this.hasPendingPortalUpdate=!1)}),this.hasPendingPortalUpdate=!0)}waitForInstance(e,t,r=Date.now()){if(this.destroyed){t(null);return}if(e.rendered())t(e);else{if(Date.now()-r>=this.maxComponentCreationTimeMs&&!this.hasPendingPortalUpdate){vf(!0,()=>this.refresher()),e.rendered()&&t(e);return}window.setTimeout(()=>{this.waitForInstance(e,t,r)})}}},Ene=({ctrl:e})=>{const t=e.isAlive(),{context:r}=T.useContext(On),[n,i]=T.useState(),[s,o]=T.useState(),a=T.useRef(),u=T.useRef(null),d=T.useRef(null),h=T.useRef(null),g=T.useRef(),m=T.useRef();t&&!m.current&&(m.current=new Vf(()=>u.current));const v=T.useCallback(x=>{if(u.current=x,!x||!e.isAlive()||r.isDestroyed()){a.current=r.destroyBean(a.current);return}a.current=r.createBean(new vd);const R=()=>{const A=e.getSelectAllGui();A&&(d.current?.insertAdjacentElement("afterend",A),a.current.addDestroyFunc(()=>A.remove()))},E={setWidth:A=>{u.current&&(u.current.style.width=A)},toggleCss:(A,D)=>m.current.toggleCss(A,D),setUserStyles:A=>o(A),setAriaSort:A=>{u.current&&(A?_z(u.current,A):Lz(u.current))},setUserCompDetails:A=>i(A),getUserCompInstance:()=>g.current||void 0,refreshSelectAllGui:R,removeSelectAllGui:()=>e.getSelectAllGui()?.remove()};e.setComp(E,x,d.current,h.current,a.current),R()},[]);T.useLayoutEffect(()=>jf(n,r,h.current,g),[n]),T.useEffect(()=>{e.setDragSource(u.current)},[n]);const w=T.useMemo(()=>!!(n?.componentFromFramework&&Cd(n.componentClass)),[n]),C=n?.componentFromFramework,b=n?.componentClass;return Oe.createElement("div",{ref:v,style:s,className:"ag-header-cell",role:"columnheader"},Oe.createElement("div",{ref:d,className:"ag-header-cell-resize",role:"presentation"}),Oe.createElement("div",{ref:h,className:"ag-header-cell-comp-wrapper",role:"presentation"},C?w?Oe.createElement(b,{...n.params}):Oe.createElement(b,{...n.params,ref:g}):null))},Rne=T.memo(Ene),Tne=class{constructor(e,t){this.floatingFilterParams=e,this.refreshProps=t}getProps(){return this.floatingFilterParams}refresh(e){this.floatingFilterParams=e,this.refreshProps()}setMethods(e){rv(this.getOptionalMethods(),e,this)}getOptionalMethods(){return["afterGuiAttached"]}},Fne=({ctrl:e})=>{const{context:t,gos:r}=T.useContext(On),[n,i]=T.useState(),[s,o]=T.useState(()=>new rs("ag-header-cell","ag-floating-filter")),[a,u]=T.useState(()=>new rs),[d,h]=T.useState(()=>new rs("ag-floating-filter-button","ag-hidden")),[g,m]=T.useState("false"),[v,w]=T.useState(),[,C]=T.useState(1),b=T.useRef(),x=T.useRef(null),R=T.useRef(null),E=T.useRef(null),A=T.useRef(null),D=T.useRef(),M=T.useRef(),F=se=>{se!=null&&D.current&&D.current(se)},O=T.useCallback(se=>{if(x.current=se,!se||!e.isAlive()||t.isDestroyed()){b.current=t.destroyBean(b.current);return}b.current=t.createBean(new vd),M.current=new Nt(P=>{D.current=P});const N={toggleCss:(P,V)=>o(H=>H.setClass(P,V)),setUserStyles:P=>i(P),addOrRemoveBodyCssClass:(P,V)=>u(H=>H.setClass(P,V)),setButtonWrapperDisplayed:P=>{h(V=>V.setClass("ag-hidden",!P)),m(P?"false":"true")},setWidth:P=>{x.current&&(x.current.style.width=P)},setCompDetails:P=>w(P),getFloatingFilterComp:()=>M.current?M.current:null,setMenuIcon:P=>A.current?.appendChild(P)};e.setComp(N,se,A.current,R.current,b.current)},[]);T.useLayoutEffect(()=>jf(v,t,R.current,F),[v]);const L=T.useMemo(()=>s.toString(),[s]),W=T.useMemo(()=>a.toString(),[a]),I=T.useMemo(()=>d.toString(),[d]),G=T.useMemo(()=>!!(v&&v.componentFromFramework&&Cd(v.componentClass)),[v]),ne=T.useMemo(()=>r.get("reactiveCustomComponents"),[]),ie=T.useMemo(()=>r.get("enableFilterHandlers"),[]),[J,_]=T.useState();T.useEffect(()=>{if(v?.componentFromFramework)if(ne){const se=ie?Tne:fne,N=new se(v.params,()=>C(P=>P+1));F(N),_(N)}else Wx()},[v]);const Y=J?.getProps(),Q=v?.componentFromFramework,U=v?.componentClass;return Oe.createElement("div",{ref:O,style:n,className:L,role:"gridcell"},Oe.createElement("div",{ref:R,className:W,role:"presentation"},Q?ne?Y&&Oe.createElement(zx.Provider,{value:{setMethods:se=>J.setMethods(se)}},Oe.createElement(U,{...Y})):Oe.createElement(U,{...v.params,ref:G?()=>{}:F}):null),Oe.createElement("div",{ref:E,"aria-hidden":g,className:I,role:"presentation"},Oe.createElement("button",{ref:A,type:"button",className:"ag-button ag-floating-filter-button-button",tabIndex:-1})))},Dne=T.memo(Fne),Ane=({ctrl:e})=>{const{context:t}=T.useContext(On),[r,n]=T.useState(),[i,s]=T.useState(()=>new rs),[o,a]=T.useState(()=>new rs),[u,d]=T.useState("false"),[h,g]=T.useState(),[m,v]=T.useState(),w=T.useRef(),C=T.useRef(null),b=T.useRef(null),x=T.useRef(null),R=T.useRef(),E=T.useCallback(L=>{if(C.current=L,!L||!e.isAlive()||t.isDestroyed()){w.current=t.destroyBean(w.current);return}w.current=t.createBean(new vd);const W={setWidth:I=>{C.current&&(C.current.style.width=I)},toggleCss:(I,G)=>s(ne=>ne.setClass(I,G)),setUserStyles:I=>n(I),setHeaderWrapperHidden:I=>{const G=x.current;G&&(I?G.style.setProperty("display","none"):G.style.removeProperty("display"))},setHeaderWrapperMaxHeight:I=>{const G=x.current;G&&(I!=null?G.style.setProperty("max-height",`${I}px`):G.style.removeProperty("max-height"),G.classList.toggle("ag-header-cell-comp-wrapper-limited-height",I!=null))},setUserCompDetails:I=>v(I),setResizableDisplayed:I=>{a(G=>G.setClass("ag-hidden",!I)),d(I?"false":"true")},setAriaExpanded:I=>g(I),getUserCompInstance:()=>R.current||void 0};e.setComp(W,L,b.current,x.current,w.current)},[]);T.useLayoutEffect(()=>jf(m,t,x.current),[m]),T.useEffect(()=>{C.current&&e.setDragSource(C.current)},[m]);const A=T.useMemo(()=>!!(m?.componentFromFramework&&Cd(m.componentClass)),[m]),D=T.useMemo(()=>"ag-header-group-cell "+i.toString(),[i]),M=T.useMemo(()=>"ag-header-cell-resize "+o.toString(),[o]),F=m?.componentFromFramework,O=m?.componentClass;return Oe.createElement("div",{ref:E,style:r,className:D,role:"columnheader","aria-expanded":h},Oe.createElement("div",{ref:x,className:"ag-header-cell-comp-wrapper",role:"presentation"},F?A?Oe.createElement(O,{...m.params}):Oe.createElement(O,{...m.params,ref:R}):null),Oe.createElement("div",{ref:b,"aria-hidden":u,className:M}))},kne=T.memo(Ane),Pne=({ctrl:e})=>{const{gos:t,context:r}=T.useContext(On),{topOffset:n,rowHeight:i}=T.useMemo(()=>e.getTopAndHeight(),[]),s=T.useMemo(()=>t.get("tabIndex"),[]),[o,a]=T.useState(()=>e.getAriaRowIndex()),u=e.headerRowClass,[d,h]=T.useState(()=>i+"px"),[g,m]=T.useState(()=>n+"px"),v=T.useRef(null),[w,C]=T.useState(()=>e.getUpdatedHeaderCtrls()),b=T.useRef(),x=T.useRef(null),R=T.useCallback(D=>{if(x.current=D,!D||!e.isAlive()||r.isDestroyed()){b.current=r.destroyBean(b.current);return}b.current=r.createBean(new vd);const M={setHeight:F=>h(F),setTop:F=>m(F),setHeaderCtrls:(F,O,L)=>{const W=v.current,I=Y0(W,F,O);I!==W&&(v.current=I,vf(L,()=>C(I)))},setWidth:F=>{x.current&&(x.current.style.width=F)},setRowIndex:F=>{a(F)}};e.setComp(M,b.current,!1)},[]),E=T.useMemo(()=>({height:d,top:g}),[d,g]),A=T.useCallback(D=>{switch(e.type){case"group":return Oe.createElement(kne,{ctrl:D,key:D.instanceId});case"filter":return Oe.createElement(Dne,{ctrl:D,key:D.instanceId});default:return Oe.createElement(Rne,{ctrl:D,key:D.instanceId})}},[]);return Oe.createElement("div",{ref:R,className:u,role:"row",style:E,tabIndex:s,"aria-rowindex":o},w.map(A))},Mne=T.memo(Pne),_ne=({pinned:e})=>{const[t,r]=T.useState(!0),[n,i]=T.useState([]),{context:s}=T.useContext(On),o=T.useRef(null),a=T.useRef(null),u=T.useRef(),d=e==="left",h=e==="right",g=!d&&!h,m=T.useCallback(C=>{if(o.current=C,!C||s.isDestroyed()){u.current=s.destroyBean(u.current);return}u.current=s.createBean(new C$(e));const b={setDisplayed:r,setCtrls:x=>i(x),setCenterWidth:x=>{a.current&&(a.current.style.width=x)},setViewportScrollLeft:x=>{o.current&&(o.current.scrollLeft=x)},setPinnedContainerWidth:x=>{o.current&&(o.current.style.width=x,o.current.style.minWidth=x,o.current.style.maxWidth=x)}};u.current.setComp(b,o.current)},[]),v=t?"":"ag-hidden",w=()=>n.map(C=>Oe.createElement(Mne,{ctrl:C,key:C.instanceId}));return d?Oe.createElement("div",{ref:m,className:"ag-pinned-left-header "+v,"aria-hidden":!t,role:"rowgroup"},w()):h?Oe.createElement("div",{ref:m,className:"ag-pinned-right-header "+v,"aria-hidden":!t,role:"rowgroup"},w()):g?Oe.createElement("div",{ref:m,className:"ag-header-viewport "+v,role:"rowgroup",tabIndex:-1},Oe.createElement("div",{ref:a,className:"ag-header-container",role:"presentation"},w())):null},Iy=T.memo(_ne),Lne=()=>{const[e,t]=T.useState(()=>new rs),[r,n]=T.useState(),{context:i}=T.useContext(On),s=T.useRef(null),o=T.useRef(),a=T.useCallback(h=>{if(s.current=h,!h||i.isDestroyed()){o.current=i.destroyBean(o.current);return}o.current=i.createBean(new p$);const g={toggleCss:(m,v)=>t(w=>w.setClass(m,v)),setHeightAndMinHeight:m=>n(m)};o.current.setComp(g,h,h)},[]),u=T.useMemo(()=>"ag-header "+e.toString(),[e]),d=T.useMemo(()=>({height:r,minHeight:r}),[r]);return Oe.createElement("div",{ref:a,className:u,style:d,role:"presentation"},Oe.createElement(Iy,{pinned:"left"}),Oe.createElement(Iy,{pinned:null}),Oe.createElement(Iy,{pinned:"right"}))},Ine=T.memo(Lne),One=(e,t)=>{T.useEffect(()=>{const r=t.current;if(r){const n=r.parentElement;if(n){const i=document.createComment(e);return n.insertBefore(i,r),()=>{i.remove()}}}},[e])},_l=One,Nne=class{constructor(e,t){this.cellEditorParams=e,this.refreshProps=t,this.instanceCreated=new Nt(r=>{this.resolveInstanceCreated=r}),this.onValueChange=r=>this.updateValue(r),this.value=e.value}getProps(){return{...this.cellEditorParams,initialValue:this.cellEditorParams.value,value:this.value,onValueChange:this.onValueChange}}getValue(){return this.value}refresh(e){this.cellEditorParams=e,this.refreshProps()}setMethods(e){rv(this.getOptionalMethods(),e,this)}getInstance(){return this.instanceCreated.then(()=>this.componentInstance)}setRef(e){this.componentInstance=e,this.resolveInstanceCreated?.(),this.resolveInstanceCreated=void 0}getOptionalMethods(){return["isCancelBeforeStart","isCancelAfterEnd","focusIn","focusOut","afterGuiAttached","getValidationErrors","getValidationElement"]}updateValue(e){this.value=e,this.refreshProps()}},Bne=e=>{const t=T.useRef(e),r=T.useRef(),n=T.useRef(!1),i=T.useRef(!1),[,s]=T.useState(0);n.current&&(i.current=!0),T.useEffect(()=>(n.current||(r.current=t.current(),n.current=!0),s(o=>o+1),()=>{i.current&&r.current?.()}),[])},Hne=e=>{const[t,r]=T.useState(),n=T.useContext(On),{context:i,popupSvc:s,gos:o,editSvc:a}=n,{editDetails:u,cellCtrl:d,eParentCell:h}=e;return Bne(()=>{const{compDetails:g}=u,m=o.get("stopEditingWhenCellsLoseFocus");let v,w;if(!i.isDestroyed()){w=i.createBean(a.createPopupEditorWrapper(g.params));const C=w.getGui();if(e.jsChildComp){const D=e.jsChildComp.getGui();D&&C.appendChild(D)}const{column:b,rowNode:x}=d,R={column:b,rowNode:x,type:"popupCellEditor",eventSource:h,ePopup:C,position:u.popupPosition,keepWithinBounds:!0},E=s?.positionPopupByComponent.bind(s,R),A=s?.addPopup({modal:m,eChild:C,closeOnEsc:!0,closedCallback:()=>{d.onPopupEditorClosed()},anchorToElement:h,positionCallback:E,ariaOwns:h});v=A?A.hideFunc:void 0,r(w),e.jsChildComp?.afterGuiAttached?.()}return()=>{v?.(),i.destroyBean(w)}}),T.useLayoutEffect(()=>()=>{d.isCellFocused()&&t?.getGui().contains(Fr(n))&&h.focus({preventScroll:!0})},[t]),t&&e.wrappedContent?Of.createPortal(e.wrappedContent,t.getGui()):null},lA=T.memo(Hne),Gne=(e,t,r)=>{const{compProxy:n}=e;r(n);const i=n.getProps(),s=Cd(t);return Oe.createElement(zx.Provider,{value:{setMethods:o=>n.setMethods(o)}},s?Oe.createElement(t,{...i}):Oe.createElement(t,{...i,ref:o=>n.setRef(o)}))},cA=(e,t,r)=>e.compProxy?Gne(e,t,r):Oe.createElement(t,{...e.compDetails.params,ref:r}),Vne=(e,t,r,n,i)=>{const s=e.compDetails,o=s.componentClass,a=s.componentFromFramework&&!e.popup,u=s.componentFromFramework&&e.popup,d=!s.componentFromFramework&&e.popup;return a?cA(e,o,t):u?Oe.createElement(lA,{editDetails:e,cellCtrl:n,eParentCell:r,wrappedContent:cA(e,o,t)}):d&&i?Oe.createElement(lA,{editDetails:e,cellCtrl:n,eParentCell:r,jsChildComp:i}):null},zne=(e,t,r,n,i,s)=>{const{context:o}=T.useContext(On),a=T.useCallback(()=>{const u=i.current;if(!u)return;const d=u.getGui();d&&d.parentElement&&d.remove(),o.destroyBean(u),i.current=void 0},[]);T.useEffect(()=>{const u=e!=null,d=e?.compDetails&&!e.compDetails.componentFromFramework,h=t&&r==null;if(!(u&&d&&!h)){a();return}const m=e.compDetails;if(i.current){const w=i.current,b=w.refresh!=null&&e.force==!1?w.refresh(m.params):!1;if(b===!0||b===void 0)return;a()}m.newAgStackInstance().then(w=>{if(!w)return;const C=w.getGui();if(!C)return;(t?r:s.current).appendChild(C),i.current=w})},[e,t,n]),T.useEffect(()=>a,[])},kI=zne,Wne=({cellCtrl:e,parent:t})=>{const r=T.useRef(),n=T.useMemo(()=>{const{loadingComp:i}=e.getDeferLoadingCellRenderer();return i?{value:void 0,compDetails:i,force:!1}:void 0},[e]);if(kI(n,!1,void 0,1,r,t),n?.compDetails?.componentFromFramework){const i=n.compDetails.componentClass;return Oe.createElement(i,{...n.compDetails.params})}return Oe.createElement(Oe.Fragment,null)},Une=({cellCtrl:e,printLayout:t,editingCell:r})=>{const n=T.useContext(On),{context:i}=n,{column:{colIdSanitised:s},instanceId:o}=e,a=T.useRef(),[u,d]=T.useState(()=>e.isCellRenderer()?void 0:{compDetails:void 0,value:e.getValueToDisplay(),force:!1}),[h,g]=T.useState(),[m,v]=T.useState(1),[w,C]=T.useState(),[b,x]=T.useState(!1),[R,E]=T.useState(!1),[A,D]=T.useState(!1),[M,F]=T.useState(),O=T.useMemo(()=>e.isForceWrapper(),[e]),L=T.useMemo(()=>e.getCellAriaRole(),[e]),W=T.useRef(null),I=T.useRef(null),G=T.useRef(null),ne=T.useRef(),ie=T.useRef(),J=T.useRef(),_=T.useRef([]),Y=T.useRef(),Q=T.useRef(),[U,se]=T.useState(0),N=T.useCallback(ke=>{Q.current=ke,se(De=>De+1)},[]),P=u!=null&&(b||A||R)&&(h==null||!!h.popup),V=O||P,H=T.useMemo(()=>e.getCellValueClass(),[e]),j=T.useCallback(ke=>{if(ie.current=ke,ke){const De=ke.isCancelBeforeStart&&ke.isCancelBeforeStart();setTimeout(()=>{De?(e.stopEditing(!0),e.focusCell(!0)):(e.cellEditorAttached(),e.enableEditorTooltipFeature(ke))})}},[e]),ae=T.useRef();ae.current||(ae.current=new Vf(()=>W.current)),kI(u,V,Q.current,U,ne,W);const fe=T.useRef();T.useLayoutEffect(()=>{const ke=fe.current,De=u;if(fe.current=u,ke==null||ke.compDetails==null||De==null||De.compDetails==null)return;Y.current?.refreshVisibility();const nt=ke.compDetails,vt=De.compDetails;if(nt.componentClass!=vt.componentClass||G.current?.refresh==null)return;G.current.refresh(vt.params)!=!0&&v(st=>st+1)},[u]),T.useLayoutEffect(()=>{if(!(h&&!h.compDetails.componentFromFramework)||i.isDestroyed())return;const De=h.compDetails,nt=h.popup===!0,vt=De.newAgStackInstance();return vt.then(Xe=>{if(!Xe)return;const st=Xe.getGui();j(Xe),nt||((O?J:W).current?.appendChild(st),Xe.afterGuiAttached?.()),F(Xe)}),()=>{vt.then(Xe=>{const st=Xe.getGui();e.disableEditorTooltipFeature(),i.destroyBean(Xe),j(void 0),F(void 0),st?.remove()})}},[h]);const le=T.useCallback(ke=>{if(J.current=ke,!ke||i.isDestroyed()||!e.isAlive()){const vt=_.current;_.current=[];for(const Xe of vt)Xe();return}let De;const nt=vt=>{vt&&(ke.insertAdjacentElement("afterbegin",vt.getGui()),_.current.push(()=>{Ua(vt.getGui()),i.destroyBean(vt),Y.current===De&&(Y.current=void 0)}))};b&&nt(e.createSelectionCheckbox()),A&&nt(e.createDndSource()),R&&(De=e.createRowDragComp(),Y.current=De,De&&(nt(De),De.refreshVisibility()))},[e,i,A,R,b]),de=T.useCallback(()=>{const ke=!e.isCellSpanning()||I.current,De=W.current;if(!De||!ke||!e||!e.isAlive()||i.isDestroyed()){a.current=i.destroyBean(a.current);return}a.current=i.createBean(new vd);const nt={toggleCss:(Xe,st)=>ae.current.toggleCss(Xe,st),setUserStyles:Xe=>C(Xe),getFocusableElement:()=>W.current,setIncludeSelection:Xe=>x(Xe),setIncludeRowDrag:Xe=>E(Xe),setIncludeDndSource:Xe=>D(Xe),getCellEditor:()=>ie.current??null,getCellRenderer:()=>G.current??ne.current,getParentOfValue:()=>Q.current??J.current??W.current,setRenderDetails:(Xe,st,Ct)=>{const ar=()=>{d(qe=>qe?.compDetails!==Xe||qe?.value!==st||qe?.force!==Ct?{value:st,compDetails:Xe,force:Ct}:qe)};if(Xe?.params?.deferRender&&!e.rowNode.group){const{loadingComp:qe,onReady:hr}=e.getDeferLoadingCellRenderer();if(qe){d({value:void 0,compDetails:qe,force:!1}),hr.then(()=>nne(ar));return}}ar()},setEditDetails:(Xe,st,Ct,ar)=>{if(Xe){let qe;Xe.componentFromFramework&&(ar?qe=new Nne(Xe.params,()=>v(hr=>hr+1)):Wx()),g({compDetails:Xe,popup:st,popupPosition:Ct,compProxy:qe}),st||d(void 0)}else e.hasBrowserFocus()&&nt.getFocusableElement().focus({preventScroll:!0}),ie.current=void 0,g(void 0)},refreshEditStyles:(Xe,st)=>{if(!W.current)return;const{current:Ct}=ae;Ct.toggleCss("ag-cell-value",!V),Ct.toggleCss("ag-cell-inline-editing",!!Xe&&!st),Ct.toggleCss("ag-cell-popup-editing",!!Xe&&!!st),Ct.toggleCss("ag-cell-not-inline-editing",!Xe||!!st)}},vt=J.current||void 0;e.setComp(nt,De,I.current??void 0,vt,t,r,a.current)},[]),ue=T.useCallback(ke=>{W.current=ke,de()},[]),Ie=T.useCallback(ke=>{I.current=ke,de()},[]),q=T.useMemo(()=>!!(u?.compDetails?.componentFromFramework&&Cd(u.compDetails.componentClass)),[u]);T.useLayoutEffect(()=>{if(!W.current)return;const{current:ke}=ae;ke.toggleCss("ag-cell-value",!V),ke.toggleCss("ag-cell-inline-editing",!!h&&!h.popup),ke.toggleCss("ag-cell-popup-editing",!!h&&!!h.popup),ke.toggleCss("ag-cell-not-inline-editing",!h||!!h.popup)});const Ge=()=>{const{compDetails:ke,value:De}=u;if(!ke)return De?.toString?.()??De;if(ke.componentFromFramework){const nt=ke.componentClass;return Oe.createElement(T.Suspense,{fallback:Oe.createElement(Wne,{cellCtrl:e,parent:W})},q?Oe.createElement(nt,{...ke.params,key:m}):Oe.createElement(nt,{...ke.params,key:m,ref:G}))}},Ye=()=>{const ke=()=>u==null?null:V?Oe.createElement("span",{role:"presentation",id:`cell-${o}`,className:H,ref:N},Ge()):Ge(),De=nt=>Vne(nt,j,W.current,e,M);return h!=null?h.popup?Oe.createElement(Oe.Fragment,null,ke(),De(h)):De(h):ke()},Ze=()=>Oe.createElement("div",{ref:ue,style:w,role:L,"col-id":s},V?Oe.createElement("div",{className:"ag-cell-wrapper",role:"presentation",ref:le},Ye()):Ye());return e.isCellSpanning()?Oe.createElement("div",{ref:Ie,className:"ag-spanned-cell-wrapper",role:"presentation"},Ze()):Ze()},$ne=T.memo(Une),jne=({rowCtrl:e,containerType:t})=>{const{context:r,gos:n,editSvc:i}=T.useContext(On),s=T.useContext(EI)==="default",o=T.useRef(),a=T.useRef(e.getDomOrder()),u=e.isFullWidth(),d=e.rowNode.displayed,[h,g]=T.useState(()=>d?e.rowNode.getRowIndexString():null),[m,v]=T.useState(()=>e.rowId),[w,C]=T.useState(()=>e.businessKey),[b,x]=T.useState(()=>e.rowStyles),R=T.useRef(null),[E,A]=T.useState(()=>null),[D,M]=T.useState(),[F,O]=T.useState(()=>d?e.getInitialRowTop(t):void 0),[L,W]=T.useState(()=>d?e.getInitialTransform(t):void 0),I=T.useRef(null),G=T.useRef(),ne=T.useRef(),ie=T.useRef(!1),[J,_]=T.useState(0);T.useEffect(()=>{if(ie.current||!D||J>10)return;const ue=I.current?.firstChild;ue?(e.setupDetailRowAutoHeight(ue),ie.current=!0):_(Ie=>Ie+1)},[D,J]);const Y=T.useRef();Y.current||(Y.current=new Vf(()=>I.current));const Q=T.useRef(()=>{}),U=T.useCallback(ue=>(Q.current=ue,()=>{Q.current=()=>{}}),[]),se=ine(U,()=>R.current,[]),N=s?se:E,P=T.useCallback(ue=>{if(I.current=ue,o.current=ue?r.createBean(new vd):r.destroyBean(o.current),!ue){e.unsetComp(t);return}if(!e.isAlive()||r.isDestroyed())return;const Ie={setTop:O,setTransform:W,toggleCss:(q,Ge)=>Y.current.toggleCss(q,Ge),setDomOrder:q=>a.current=q,setRowIndex:g,setRowId:v,setRowBusinessKey:C,setUserStyles:x,setCellCtrls:(q,Ge)=>{const Ye=R.current,Ze=Y0(Ye,q,a.current);Ze!==Ye&&(R.current=Ze,s?Q.current():vf(Ge,()=>A(Ze)))},showFullWidth:q=>{ne.current=q.params,M(q)},getFullWidthCellRenderer:()=>G.current,getFullWidthCellRendererParams:()=>ne.current,refreshFullWidth:q=>{const Ge=q();return ne.current=Ge,fe.current?(M(Ye=>({...Ye,params:Ge})),!0):!G.current||!G.current.refresh?!1:G.current.refresh(Ge)}};e.setComp(Ie,ue,t,o.current)},[]);T.useLayoutEffect(()=>jf(D,r,I.current,G),[D]);const V=T.useMemo(()=>{const ue={top:F,transform:L};return Object.assign(ue,b),ue},[F,L,b]),H=u&&D?.componentFromFramework,j=!u&&N!=null,ae=T.useMemo(()=>!!(D?.componentFromFramework&&Cd(D.componentClass)),[D]),fe=T.useRef(!1);T.useEffect(()=>{fe.current=ae&&!!D&&!!n.get("reactiveCustomComponents")},[ae,D]);const le=()=>N?.map(ue=>Oe.createElement($ne,{cellCtrl:ue,editingCell:i?.isEditing(ue,{withOpenEditor:!0})??!1,printLayout:e.printLayout,key:ue.instanceId})),de=()=>{const ue=D.componentClass;return ae?Oe.createElement(ue,{...D.params}):Oe.createElement(ue,{...D.params,ref:G})};return Oe.createElement("div",{ref:P,role:"row",style:V,"row-index":h,"row-id":m,"row-business-key":w},j?le():H?de():null)},uA=T.memo(jne),Yne=({name:e})=>{const{context:t,gos:r}=T.useContext(On),n=T.useMemo(()=>Wf(e),[e]),i=T.useRef(null),s=T.useRef(null),o=T.useRef(null),a=T.useRef([]),u=T.useRef([]),[d,h]=T.useState(()=>[]),g=!!r.get("enableCellSpan")&&!!n.getSpannedRowCtrls,m=T.useRef([]),v=T.useRef([]),[w,C]=T.useState(()=>[]),b=T.useRef(!1),x=T.useRef(),R=T.useMemo(()=>Ji("ag-viewport",rL(e)),[e]),E=T.useMemo(()=>Ji(l0(e)),[e]),A=T.useMemo(()=>Ji("ag-spanning-container",HU(e)),[e]),D=n.type==="center"||g,M=D?i:s;_l(" AG Row Container "+e+" ",M);const F=T.useCallback(()=>{const J=!D||i.current!=null,_=s.current!=null,Y=!g||o.current!=null;return J&&_&&Y},[]),O=T.useCallback(()=>i.current==null&&s.current==null&&o.current==null,[]),L=T.useCallback(()=>{if(O()&&(x.current=t.destroyBean(x.current)),!t.isDestroyed()&&F()){const J=Q=>{const U=Y0(u.current,a.current,b.current);U!==u.current&&(u.current=U,vf(Q,()=>h(U)))},_=Q=>{const U=Y0(v.current,m.current,b.current);U!==v.current&&(v.current=U,vf(Q,()=>C(U)))},Y={setHorizontalScroll:Q=>{i.current&&(i.current.scrollLeft=Q)},setViewportHeight:Q=>{i.current&&(i.current.style.height=Q)},setRowCtrls:({rowCtrls:Q,useFlushSync:U})=>{const se=!!U&&a.current.length>0&&Q.length>0;a.current=Q,J(se)},setSpannedRowCtrls:(Q,U)=>{const se=!!U&&m.current.length>0&&Q.length>0;m.current=Q,_(se)},setDomOrder:Q=>{b.current!=Q&&(b.current=Q,J(!1))},setContainerWidth:Q=>{s.current&&(s.current.style.width=Q)},setOffsetTop:Q=>{s.current&&(s.current.style.transform=`translateY(${Q})`)}};x.current=t.createBean(new qU(e)),x.current.setComp(Y,s.current,o.current??void 0,i.current)}},[F,O]),W=T.useCallback(J=>{s.current=J,L()},[L]),I=T.useCallback(J=>{o.current=J,L()},[L]),G=T.useCallback(J=>{i.current=J,L()},[L]),ne=()=>Oe.createElement("div",{className:E,ref:W,role:D?"presentation":"rowgroup"},d.map(J=>Oe.createElement(uA,{rowCtrl:J,containerType:n.type,key:J.instanceId})));if(!D)return ne();const ie=()=>Oe.createElement("div",{className:A,ref:I,role:"presentation"},w.map(J=>Oe.createElement(uA,{rowCtrl:J,containerType:n.type,key:J.instanceId})));return Oe.createElement("div",{className:R,ref:G,role:"rowgroup"},ne(),g?ie():null)},Kne=T.memo(Yne),qne=()=>{const e=T.useContext(On),{context:t,overlays:r}=e,[n,i]=T.useState(""),[s,o]=T.useState(0),[a,u]=T.useState(0),[d,h]=T.useState("0px"),[g,m]=T.useState("0px"),[v,w]=T.useState("100%"),[C,b]=T.useState("0px"),[x,R]=T.useState("0px"),[E,A]=T.useState("100%"),[D,M]=T.useState(!0),[F,O]=T.useState(!0),[L,W]=T.useState(null),[I,G]=T.useState(""),[ne,ie]=T.useState(null),[J,_]=T.useState("ag-layout-normal"),Y=T.useRef();Y.current||(Y.current=new Vf(()=>Q.current));const Q=T.useRef(null),U=T.useRef(null),se=T.useRef(null),N=T.useRef(null),P=T.useRef(null),V=T.useRef(null),H=T.useRef(null),j=T.useRef([]),ae=T.useRef([]);_l(" AG Grid Body ",Q),_l(" AG Pinned Top ",U),_l(" AG Sticky Top ",se),_l(" AG Middle ",V),_l(" AG Pinned Bottom ",H);const fe=T.useCallback(st=>{if(Q.current=st,!st||t.isDestroyed()){j.current=t.destroyBeans(j.current);for(const dt of ae.current)dt();ae.current=[];return}const Ct=(dt,At)=>{dt.appendChild(At),ae.current.push(()=>At.remove())},ar=dt=>{const At=t.createBean(new dt);return j.current.push(At),At},qe=(dt,At,ht)=>{Ct(dt,document.createComment(ht)),Ct(dt,ar(At).getGui())};qe(st,r$," AG Fake Horizontal Scroll ");const hr=r?.getOverlayWrapperCompClass();hr&&qe(st,hr," AG Overlay Wrapper "),P.current&&qe(P.current,i$," AG Fake Vertical Scroll ");const Or={setRowAnimationCssOnBodyViewport:i,setColumnCount:dt=>{Q.current&&Pz(Q.current,dt)},setRowCount:dt=>{Q.current&&Az(Q.current,dt)},setTopHeight:o,setBottomHeight:u,setStickyTopHeight:h,setStickyTopTop:m,setStickyTopWidth:w,setTopInvisible:M,setBottomInvisible:O,setColumnMovingCss:(dt,At)=>Y.current.toggleCss(dt,At),updateLayoutClasses:_,setAlwaysVerticalScrollClass:W,setPinnedTopBottomOverflowY:G,setCellSelectableCss:(dt,At)=>ie(At?dt:null),setBodyViewportWidth:dt=>{V.current&&(V.current.style.width=dt)},registerBodyViewportResizeListener:dt=>{if(V.current){const At=Zo(e,V.current,dt);ae.current.push(()=>At())}},setStickyBottomHeight:b,setStickyBottomBottom:R,setStickyBottomWidth:A,setGridRootRole:dt=>st.setAttribute("role",dt)},Et=t.createBean(new JU);j.current.push(Et),Et.setComp(Or,st,V.current,U.current,H.current,se.current,N.current)},[]),le=T.useMemo(()=>Ji("ag-root","ag-unselectable",J),[J]),de=T.useMemo(()=>Ji("ag-body-viewport",n,J,L,ne),[n,J,L,ne]),ue=T.useMemo(()=>Ji("ag-body",J),[J]),Ie=T.useMemo(()=>Ji("ag-floating-top",D?"ag-invisible":null,ne),[ne,D]),q=T.useMemo(()=>Ji("ag-sticky-top",ne),[ne]),Ge=T.useMemo(()=>Ji("ag-sticky-bottom",C==="0px"?"ag-invisible":null,ne),[ne,C]),Ye=T.useMemo(()=>Ji("ag-floating-bottom",F?"ag-invisible":null,ne),[ne,F]),Ze=T.useMemo(()=>({height:s,minHeight:s,overflowY:I}),[s,I]),ke=T.useMemo(()=>({height:d,top:g,width:v}),[d,g,v]),De=T.useMemo(()=>({height:C,bottom:x,width:E}),[C,x,E]),nt=T.useMemo(()=>({height:a,minHeight:a,overflowY:I}),[a,I]),vt=st=>Oe.createElement(Kne,{name:st,key:`${st}-container`}),Xe=({section:st,children:Ct,className:ar,style:qe})=>Oe.createElement("div",{ref:st,className:ar,role:"presentation",style:qe},Ct.map(vt));return Oe.createElement("div",{ref:fe,className:le},Oe.createElement(Ine,null),Xe({section:U,className:Ie,style:Ze,children:["topLeft","topCenter","topRight","topFullWidth"]}),Oe.createElement("div",{className:ue,ref:P,role:"presentation"},Xe({section:V,className:de,children:["left","center","right","fullWidth"]})),Xe({section:se,className:q,style:ke,children:["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"]}),Xe({section:N,className:Ge,style:De,children:["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"]}),Xe({section:H,className:Ye,style:nt,children:["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"]}))},Xne=T.memo(qne),Qne=(e,t)=>{const{children:r,eFocusableElement:n,onTabKeyDown:i,gridCtrl:s,forceFocusOutWhenTabGuardsAreEmpty:o,isEmpty:a}=e,{context:u}=T.useContext(On),d=T.useRef(null),h=T.useRef(null),g=T.useRef(),m=x=>{const R=x==null?void 0:parseInt(x,10).toString();for(const E of[d,h])R===void 0?E.current?.removeAttribute("tabindex"):E.current?.setAttribute("tabindex",R)};T.useImperativeHandle(t,()=>({forceFocusOutOfContainer(x){g.current?.forceFocusOutOfContainer(x)}}));const v=T.useCallback(()=>{const x=d.current,R=h.current;if(!x&&!R||u.isDestroyed()){g.current=u.destroyBean(g.current);return}if(x&&R){const E={setTabIndex:m};g.current=u.createBean(new gL({comp:E,eTopGuard:x,eBottomGuard:R,eFocusableElement:n,onTabKeyDown:i,forceFocusOutWhenTabGuardsAreEmpty:o,focusInnerElement:A=>s.focusInnerElement(A),isEmpty:a}))}},[]),w=T.useCallback(x=>{d.current=x,v()},[v]),C=T.useCallback(x=>{h.current=x,v()},[v]),b=x=>{const R=x==="top"?Ou.TAB_GUARD_TOP:Ou.TAB_GUARD_BOTTOM;return Oe.createElement("div",{className:`${Ou.TAB_GUARD} ${R}`,role:"presentation",ref:x==="top"?w:C})};return Oe.createElement(Oe.Fragment,null,b("top"),r,b("bottom"))},Zne=T.forwardRef(Qne),Jne=T.memo(Zne),eie=({context:e})=>{const[t,r]=T.useState(""),[n,i]=T.useState(""),[s,o]=T.useState(null),[a,u]=T.useState(null),[d,h]=T.useState(!1),[g,m]=T.useState(),v=T.useRef(),w=T.useRef(null),C=T.useRef(),[b,x]=T.useState(null),R=T.useRef(()=>{}),E=T.useRef(),A=T.useRef([]),D=T.useCallback(()=>{},[]);_l(" AG Grid ",w);const M=T.useCallback(G=>{if(w.current=G,v.current=G?e.createBean(new tj):e.destroyBean(v.current),!G||e.isDestroyed())return;const ne=v.current;R.current=ne.focusInnerElement.bind(ne);const ie={destroyGridUi:()=>{},setRtlClass:r,forceFocusOutOfContainer:J=>{if(!J&&E.current?.isDisplayed()){E.current.forceFocusOutOfContainer(J);return}C.current?.forceFocusOutOfContainer(J)},updateLayoutClasses:i,getFocusableContainers:()=>{const J=[],_=w.current?.querySelector(".ag-root");_&&J.push({getGui:()=>_});for(const Y of A.current)Y.isDisplayed()&&J.push(Y);return J},setCursor:o,setUserSelect:u};ne.setComp(ie,G,G),h(!0)},[]);T.useEffect(()=>{const G=v.current,ne=w.current;if(!g||!G||!b||!ne||e.isDestroyed())return;const ie=[],{watermarkSelector:J,paginationSelector:_,sideBarSelector:Y,statusBarSelector:Q,gridHeaderDropZonesSelector:U}=G.getOptionalSelectors(),se=[];if(U){const P=e.createBean(new U.component),V=P.getGui();ne.insertAdjacentElement("afterbegin",V),se.push(V),ie.push(P)}if(Y){const P=e.createBean(new Y.component),V=P.getGui(),H=b.querySelector(".ag-tab-guard-bottom");H&&(H.insertAdjacentElement("beforebegin",V),se.push(V)),ie.push(P),A.current.push(P)}const N=P=>{const V=e.createBean(new P),H=V.getGui();return ne.insertAdjacentElement("beforeend",H),se.push(H),ie.push(V),V};if(Q&&N(Q.component),_){const P=N(_.component);E.current=P,A.current.push(P)}return J&&N(J.component),()=>{e.destroyBeans(ie);for(const P of se)P.remove()}},[g,b,e]);const F=T.useMemo(()=>Ji("ag-root-wrapper",t,n),[t,n]),O=T.useMemo(()=>Ji("ag-root-wrapper-body","ag-focus-managed",n),[n]),L=T.useMemo(()=>({userSelect:a??"",WebkitUserSelect:a??"",cursor:s??""}),[a,s]),W=T.useCallback(G=>{C.current=G,m(G!==null)},[]),I=T.useCallback(()=>!v.current?.isFocusable(),[]);return Oe.createElement("div",{ref:M,className:F,style:L,role:"presentation"},Oe.createElement("div",{className:O,ref:x,role:"presentation"},d&&b&&!e.isDestroyed()&&Oe.createElement(On.Provider,{value:e.getBeans()},Oe.createElement(Jne,{ref:W,eFocusableElement:b,onTabKeyDown:D,gridCtrl:v.current,forceFocusOutWhenTabGuardsAreEmpty:!0,isEmpty:I},Oe.createElement(Xne,null)))))},tie=T.memo(eie),rie=class extends Ee{postConstruct(){if(this.beans.colAutosize){const e=this.queueResizeOperationsForTick.bind(this);this.addManagedEventListeners({rowExpansionStateChanged:e,expandOrCollapseAll:e,cellValueChanged:e,rowNodeDataChanged:e,rowDataUpdated:e})}}queueResizeOperationsForTick(){const e=this.beans.colAutosize;e.shouldQueueResizeOperations=!0,setTimeout(()=>{e.processResizeOperations()},0)}areHeaderCellsRendered(){return this.beans.ctrlsSvc.getHeaderRowContainerCtrls().every(e=>e.getAllCtrls().every(t=>t.areCellsRendered()))}areCellsRendered(){return this.beans.rowRenderer.getAllRowCtrls().every(e=>e.isRowRendered()&&e.getAllCellCtrls().every(t=>!!t.eGui))}},PI={setGridApi:void 0,maxComponentCreationTimeMs:void 0,children:void 0},nie={gridOptions:void 0,modules:void 0,containerStyle:void 0,className:void 0,passGridApi:void 0,componentWrappingElement:void 0,...PI},MI=new Set(Object.keys(nie)),iie=new Set(Object.keys(PI)),_I=e=>{const t=T.useRef(),r=T.useRef(null),n=T.useRef(null),i=T.useRef([]),s=T.useRef([]),o=T.useRef(e),a=T.useRef(),u=T.useRef(),d=T.useRef(!1),[h,g]=T.useState(void 0),[,m]=T.useState(0),v=T.useCallback(x=>{if(r.current=x,!x){for(const I of i.current)I();i.current.length=0;return}const R=e.modules||[];n.current||(n.current=new xne(()=>m(I=>I+1),e.componentWrappingElement,e.maxComponentCreationTimeMs),i.current.push(()=>{n.current?.destroy(),n.current=null}));const E=M7(e.gridOptions,e,Object.keys(e).filter(I=>!MI.has(I))),A=()=>{if(d.current){const I=()=>a.current?.shouldQueueUpdates()?void 0:s.current.shift();let G=I();for(;G;)G(),G=I()}},D=new lie(A);a.current=D;const M=new rie,F={providedBeanInstances:{frameworkCompWrapper:new oie(n.current,E),renderStatus:M},modules:R,frameworkOverrides:D,setThemeOnGridDiv:!0},O=I=>{g(I),I.createBean(M),i.current.push(()=>{I.destroy()}),I.getBean("ctrlsSvc").whenReady({addDestroyFunc:G=>{i.current.push(G)}},()=>{if(I.isDestroyed())return;const G=t.current;G&&e.passGridApi?.(G)})},L=I=>{I.getBean("ctrlsSvc").whenReady({addDestroyFunc:G=>{i.current.push(G)}},()=>{for(const G of s.current)G();s.current.length=0,d.current=!0})},W=new SQ;E.gridId??(E.gridId=u.current),t.current=W.create(x,E,O,L,F),i.current.push(()=>{t.current=void 0}),t.current&&(u.current=t.current.getGridId())},[]),w=T.useMemo(()=>({height:"100%",...e.containerStyle||{}}),[e.containerStyle]),C=T.useCallback(x=>{d.current&&!a.current?.shouldQueueUpdates()?x():s.current.push(x)},[]);T.useEffect(()=>{const x=sie(o.current,e);o.current=e,C(()=>{t.current&&_7(x,t.current)})},[e]);const b=!Oe.useSyncExternalStore||n0(e,"renderingMode")==="legacy"?"legacy":"default";return Oe.createElement("div",{style:w,className:e.className,ref:v},Oe.createElement(EI.Provider,{value:b},h&&!h.isDestroyed()?Oe.createElement(tie,{key:h.instanceId,context:h}):null,n.current?.getPortals()??null))};function sie(e,t){const r={};for(const n of Object.keys(t)){if(MI.has(n)){iie.has(n)&&Me(274,{prop:n});continue}const i=t[n];e[n]!==i&&(r[n]=i)}return r}var oie=class extends FQ{constructor(e,t){super(),this.parent=e,this.gridOptions=t}createWrapper(e,t){const r=this.gridOptions;if(n0(r,"reactiveCustomComponents")){const o=(a=>{switch(a){case"filter":return n0(r,"enableFilterHandlers")?hne:dne;case"floatingFilterComponent":return n0(r,"enableFilterHandlers")?pne:gne;case"dateComponent":return cne;case"dragAndDropImageComponent":return une;case"loadingOverlayComponent":return vne;case"noRowsOverlayComponent":return Cne;case"statusPanel":return yne;case"toolPanel":return bne;case"menuItem":return wne;case"cellRenderer":return lne;case"innerHeaderComponent":return mne}})(t.name);if(o)return new o(e,this.parent,t)}else switch(t.name){case"filter":case"floatingFilterComponent":case"dateComponent":case"dragAndDropImageComponent":case"loadingOverlayComponent":case"noRowsOverlayComponent":case"statusPanel":case"toolPanel":case"menuItem":case"cellRenderer":Wx();break}const i=!t.cellRenderer&&t.name!=="toolPanel";return new DI(e,this.parent,t,i)}},aie=T.forwardRef((e,t)=>{const r=T.useContext(On),{registry:n,context:i,gos:s,rowModel:o}=r,[a,u]=T.useState(()=>new rs),[d,h]=T.useState(()=>new rs),[g,m]=T.useState(),[v,w]=T.useState(),C=T.useRef(),b=T.useRef(null),x=T.useRef(),R=T.useMemo(()=>c7(e.api.getGridId(),g?.rowModelType??"clientSide"),[e]),E=T.useMemo(()=>a.toString()+" ag-details-row",[a]),A=T.useMemo(()=>d.toString()+" ag-details-grid",[d]);t&&T.useImperativeHandle(t,()=>({refresh(){return C.current?.refresh()??!1}})),e.template&&Me(230);const D=T.useCallback(F=>{if(b.current=F,!F||i.isDestroyed()){C.current=i.destroyBean(C.current),x.current?.();return}const O={toggleCss:(W,I)=>u(G=>G.setClass(W,I)),toggleDetailGridCss:(W,I)=>h(G=>G.setClass(W,I)),setDetailGrid:W=>m(W),setRowData:W=>w(W),getGui:()=>b.current},L=n.createDynamicBean("detailCellRendererCtrl",!0);if(L&&(i.createBean(L),L.init(O,e),C.current=L,s.get("detailRowAutoHeight"))){const W=()=>{if(b.current==null)return;const I=b.current.clientHeight;I!=null&&I>0&&setTimeout(()=>{e.node.setRowHeight(I),(_r(s)||pc(s))&&o.onRowHeightChanged()},0)};x.current=Zo(r,F,W),W()}},[]),M=T.useCallback(F=>{C.current?.registerDetailWithMaster(F)},[]);return Oe.createElement("div",{className:E,ref:D},g&&Oe.createElement(_I,{className:A,...g,modules:R,rowData:v,passGridApi:M}))}),lie=class extends pL{constructor(e){super("react"),this.processQueuedUpdates=e,this.queueUpdates=!1,this.renderingEngine="react",this.frameworkComponents={agGroupCellRenderer:oA,agGroupRowRenderer:oA,agDetailCellRenderer:aie},this.wrapIncoming=(t,r)=>r==="ensureVisible"?rne(t):t()}frameworkComponent(e){return this.frameworkComponents[e]}isFrameworkComponent(e){if(!e)return!1;const t=e.prototype;return!(t&&"getGui"in t)}getLockOnRefresh(){this.queueUpdates=!0}releaseLockOnRefresh(){this.queueUpdates=!1,this.processQueuedUpdates()}shouldQueueUpdates(){return this.queueUpdates}runWhenReadyAsync(){return tne()}},cie=class extends T.Component{constructor(){super(...arguments),this.apiListeners=[],this.setGridApi=e=>{this.api=e;for(const t of this.apiListeners)t(e)}}registerApiListener(e){this.apiListeners.push(e)}componentWillUnmount(){this.apiListeners.length=0}render(){return Oe.createElement(_I,{...this.props,passGridApi:this.setGridApi})}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var K0={};K0.version="0.18.5";var LI=1252,uie=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ux={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},$x=function(e){uie.indexOf(e)!=-1&&(LI=Ux[0]=e)};function die(){$x(1252)}var Cs=function(e){$x(e)};function jx(){Cs(1200),die()}function dA(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function hie(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function II(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var kh=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?hie(e.slice(2)):t==254&&r==255?II(e.slice(2)):t==65279?e.slice(1):e},Op=function(t){return String.fromCharCode(t)},hA=function(t){return String.fromCharCode(t)},wf,Ha="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Cf(e){for(var t="",r=0,n=0,i=0,s=0,o=0,a=0,u=0,d=0;d<e.length;)r=e.charCodeAt(d++),s=r>>2,n=e.charCodeAt(d++),o=(r&3)<<4|n>>4,i=e.charCodeAt(d++),a=(n&15)<<2|i>>6,u=i&63,isNaN(n)?a=u=64:isNaN(i)&&(u=64),t+=Ha.charAt(s)+Ha.charAt(o)+Ha.charAt(a)+Ha.charAt(u);return t}function Ai(e){var t="",r=0,n=0,i=0,s=0,o=0,a=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)s=Ha.indexOf(e.charAt(d++)),o=Ha.indexOf(e.charAt(d++)),r=s<<2|o>>4,t+=String.fromCharCode(r),a=Ha.indexOf(e.charAt(d++)),n=(o&15)<<4|a>>2,a!==64&&(t+=String.fromCharCode(n)),u=Ha.indexOf(e.charAt(d++)),i=(a&3)<<6|u,u!==64&&(t+=String.fromCharCode(i));return t}var Rt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ta=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function qa(e){return Rt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function fA(e){return Rt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Si=function(t){return Rt?ta(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function nv(e){if(typeof ArrayBuffer>"u")return Si(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function sl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function fie(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Yx(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Yx(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ln=Rt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ta(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function gie(e){for(var t=[],r=0,n=e.length+250,i=qa(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=e.charCodeAt(++s)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|a>>6&15|(o&3)<<4,i[r++]=128|a&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(t.push(i.slice(0,r)),r=0,i=qa(65535),n=65530)}return t.push(i.slice(0,r)),ln(t)}var Un=/\u0000/g,Ph=/[\u0001-\u0006]/g;function Gu(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ys(e,t){var r=""+e;return r.length>=t?r:Mr("0",t-r.length)+r}function Kx(e,t){var r=""+e;return r.length>=t?r:Mr(" ",t-r.length)+r}function q0(e,t){var r=""+e;return r.length>=t?r:r+Mr(" ",t-r.length)}function pie(e,t){var r=""+Math.round(e);return r.length>=t?r:Mr("0",t-r.length)+r}function mie(e,t){var r=""+e;return r.length>=t?r:Mr("0",t-r.length)+r}var gA=Math.pow(2,32);function vu(e,t){if(e>gA||e<-gA)return pie(e,t);var r=Math.round(e);return mie(r,t)}function X0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var pA=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Oy=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function vie(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var gt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},mA={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},wie={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Q0(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,o=1,a=0,u=1,d=0,h=0,g=Math.floor(i);d<t&&(g=Math.floor(i),a=g*o+s,h=g*d+u,!(i-g<5e-8));)i=1/(i-g),s=o,o=a,u=d,d=h;if(h>t&&(d>t?(h=u,a=s):(h=d,a=o)),!r)return[0,n*a,h];var m=Math.floor(n*a/h);return[m,n*a-m*h,h]}function Nl(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,o=[],a={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),t&&t.date1904&&(n+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++n,++a.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],s=u.getDay(),n<60&&(s=(s+6)%7),r&&(s=Eie(u,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}var OI=new Date(1899,11,31,0,0,0),Cie=OI.getTime(),yie=new Date(1900,2,1,0,0,0);function NI(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=yie&&(r+=1440*60*1e3),(r-(Cie+(e.getTimezoneOffset()-OI.getTimezoneOffset())*6e4))/(1440*60*1e3)}function qx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function bie(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Sie(e){var t=e<0?12:11,r=qx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function xie(e){var t=qx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function yf(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Sie(e):t===10?r=e.toFixed(10).substr(0,12):r=xie(e),qx(bie(r.toUpperCase()))}function sc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):yf(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ss(14,NI(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Eie(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Rie(e,t,r,n){var i="",s=0,o=0,a=r.y,u,d=0;switch(e){case 98:a=r.y+543;case 121:switch(t.length){case 1:case 2:u=a%100,d=2;break;default:u=a%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,d=t.length;break;case 3:return Oy[r.m-1][1];case 5:return Oy[r.m-1][0];default:return Oy[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,d=t.length;break;case 3:return pA[r.q][0];default:return pA[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ys(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(i=ys(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:u=a,d=1;break}var h=d>0?ys(u,d):"";return h}function Ga(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var BI=/%/g;function Tie(e,t,r){var n=t.replace(BI,""),i=t.length-n.length;return Wo(e,n,r*Math.pow(10,2*i))+Mr("%",i)}function Fie(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Wo(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function HI(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+HI(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,u,d,h){return u+d+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var GI=/# (\?+)( ?)\/( ?)(\d+)/;function Die(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),o=i-s*n,a=n;return r+(s===0?"":""+s)+" "+(o===0?Mr(" ",e[1].length+1+e[4].length):Kx(o,e[1].length)+e[2]+"/"+e[3]+ys(a,e[4].length))}function Aie(e,t,r){return r+(t===0?"":""+t)+Mr(" ",e[1].length+2+e[4].length)}var VI=/^#*0*\.([0#]+)/,zI=/\).*[0#]/,WI=/\(###\) ###\\?-####/;function Hn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function vA(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function wA(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function kie(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Pie(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ji(e,t,r){if(e.charCodeAt(0)===40&&!t.match(zI)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ji("n",n,r):"("+ji("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Fie(e,t,r);if(t.indexOf("%")!==-1)return Tie(e,t,r);if(t.indexOf("E")!==-1)return HI(t,r);if(t.charCodeAt(0)===36)return"$"+ji(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,a,u=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+vu(u,t.length);if(t.match(/^[#?]+$/))return i=vu(r,0),i==="0"&&(i=""),i.length>t.length?i:Hn(t.substr(0,t.length-i.length))+i;if(s=t.match(GI))return Die(s,u,d);if(t.match(/^#+0+$/))return d+vu(u,t.length-t.indexOf("0"));if(s=t.match(VI))return i=vA(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Hn(s[1])).replace(/\.$/,"."+Hn(s[1])).replace(/\.(\d*)$/,function(w,C){return"."+C+Mr("0",Hn(s[1]).length-C.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return d+vA(u,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return d+Ga(vu(u,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ji(e,t,-r):Ga(""+(Math.floor(r)+kie(r,s[1].length)))+"."+ys(wA(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return ji(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Gu(ji(e,t.replace(/[\\-]/g,""),r)),o=0,Gu(Gu(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<i.length?i.charAt(o++):w==="0"?"0":""}));if(t.match(WI))return i=ji(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=Q0(u,Math.pow(10,o)-1,!1),i=""+d,h=Wo("n",s[1],a[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=q0(a[2],o),h.length<s[4].length&&(h=Hn(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=Q0(u,Math.pow(10,o)-1,!0),d+(a[0]||(a[1]?"":"0"))+" "+(a[1]?Kx(a[1],o)+s[2]+"/"+s[3]+q0(a[2],o):Mr(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=vu(r,0),t.length<=i.length?i:Hn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var g=t.indexOf(".")-o,m=t.length-i.length-g;return Hn(t.substr(0,g)+i+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=wA(r,s[1].length),r<0?"-"+ji(e,t,-r):Ga(Pie(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?ys(0,3-w.length):"")+w})+"."+ys(o,s[1].length);switch(t){case"###,##0.00":return ji(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=Ga(vu(u,0));return v!=="0"?d+v:"";case"###,###.00":return ji(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ji(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Mie(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Wo(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function _ie(e,t,r){var n=t.replace(BI,""),i=t.length-n.length;return Wo(e,n,r*Math.pow(10,2*i))+Mr("%",i)}function UI(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+UI(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,u,d,h){return u+d+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Gs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(zI)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Gs("n",n,r):"("+Gs("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Mie(e,t,r);if(t.indexOf("%")!==-1)return _ie(e,t,r);if(t.indexOf("E")!==-1)return UI(t,r);if(t.charCodeAt(0)===36)return"$"+Gs(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,a,u=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+ys(u,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Hn(t.substr(0,t.length-i.length))+i;if(s=t.match(GI))return Aie(s,u,d);if(t.match(/^#+0+$/))return d+ys(u,t.length-t.indexOf("0"));if(s=t.match(VI))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Hn(s[1])).replace(/\.$/,"."+Hn(s[1])),i=i.replace(/\.(\d*)$/,function(w,C){return"."+C+Mr("0",Hn(s[1]).length-C.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return d+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return d+Ga(""+u);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Gs(e,t,-r):Ga(""+r)+"."+Mr("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Gs(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Gu(Gs(e,t.replace(/[\\-]/g,""),r)),o=0,Gu(Gu(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<i.length?i.charAt(o++):w==="0"?"0":""}));if(t.match(WI))return i=Gs(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=Q0(u,Math.pow(10,o)-1,!1),i=""+d,h=Wo("n",s[1],a[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=q0(a[2],o),h.length<s[4].length&&(h=Hn(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=Q0(u,Math.pow(10,o)-1,!0),d+(a[0]||(a[1]?"":"0"))+" "+(a[1]?Kx(a[1],o)+s[2]+"/"+s[3]+q0(a[2],o):Mr(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Hn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var g=t.indexOf(".")-o,m=t.length-i.length-g;return Hn(t.substr(0,g)+i+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Gs(e,t,-r):Ga(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?ys(0,3-w.length):"")+w})+"."+ys(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=Ga(""+u);return v!=="0"?d+v:"";default:if(t.match(/\.[0#?]*$/))return Gs(e,t.slice(0,t.lastIndexOf(".")),r)+Hn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Wo(e,t,r){return(r|0)===r?Gs(e,t,r):ji(e,t,r)}function Lie(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var $I=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function yd(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":X0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match($I))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Iie(e,t,r,n){for(var i=[],s="",o=0,a="",u="t",d,h,g,m="H";o<e.length;)switch(a=e.charAt(o)){case"G":if(!X0(e,o))throw new Error("unrecognized character "+a+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(g=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(g);i[i.length]={t:"t",v:s},++o;break;case"\\":var v=e.charAt(++o),w=v==="("||v===")"?v:"t";i[i.length]={t:w,v},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=Nl(t,r,e.charAt(o+1)==="2"),d==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},u=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Nl(t,r),d==null))return"";for(s=a;++o<e.length&&e.charAt(o).toLowerCase()===a;)s+=a;a==="m"&&u.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=m),i[i.length]={t:a,v:s},u=a;break;case"A":case"a":case"":var C={t:a,v:a};if(d==null&&(d=Nl(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(C.v=d.H>=12?"P":"A"),C.t="T",m="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(C.v=d.H>=12?"PM":"AM"),C.t="T",o+=5,m="h"):e.substr(o,5).toUpperCase()==="/"?(d!=null&&(C.v=d.H>=12?"":""),C.t="T",o+=5,m="h"):(C.t="t",++o),d==null&&C.t==="T")return"";i[i.length]=C,u=a;break;case"[":for(s=a;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match($I)){if(d==null&&(d=Nl(t,r),d==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},u=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",yd(e)||(i[i.length]={t:"t",v:s}));break;case".":if(d!=null){for(s=a;++o<e.length&&(a=e.charAt(o))==="0";)s+=a;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=a;++o<e.length&&"0#?.,E+-%".indexOf(a=e.charAt(o))>-1;)s+=a;i[i.length]={t:"n",v:s};break;case"?":for(s=a;e.charAt(++o)===a;)s+=a;i[i.length]={t:a,v:s},u=a;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=a;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:a,v:a},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+e);i[i.length]={t:"t",v:a},++o;break}var b=0,x=0,R;for(o=i.length-1,u="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=m,u="h",b<1&&(b=1);break;case"s":(R=i[o].v.match(/\.0+$/))&&(x=Math.max(x,R[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":u=i[o].t;break;case"m":u==="s"&&(i[o].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&i[o].v.match(/[Hh]/)&&(b=1),b<2&&i[o].v.match(/[Mm]/)&&(b=2),b<3&&i[o].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var E="",A;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=Rie(i[o].t.charCodeAt(0),i[o].v,d,x),i[o].t="t";break;case"n":case"?":for(A=o+1;i[A]!=null&&((a=i[A].t)==="?"||a==="D"||(a===" "||a==="t")&&i[A+1]!=null&&(i[A+1].t==="?"||i[A+1].t==="t"&&i[A+1].v==="/")||i[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[A].v==="/"||i[A].v===" "&&i[A+1]!=null&&i[A+1].t=="?"));)i[o].v+=i[A].v,i[A]={v:"",t:";"},++A;E+=i[o].v,o=A-1;break;case"G":i[o].t="t",i[o].v=sc(t,r);break}var D="",M,F;if(E.length>0){E.charCodeAt(0)==40?(M=t<0&&E.charCodeAt(0)===45?-t:t,F=Wo("n",E,M)):(M=t<0&&n>1?-t:t,F=Wo("n",E,M),M<0&&i[0]&&i[0].t=="t"&&(F=F.substr(1),i[0].v="-"+i[0].v)),A=F.length-1;var O=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){O=o;break}var L=i.length;if(O===i.length&&F.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(A>=i[o].v.length-1?(A-=i[o].v.length,i[o].v=F.substr(A+1,i[o].v.length)):A<0?i[o].v="":(i[o].v=F.substr(0,A+1),A=-1),i[o].t="t",L=o);A>=0&&L<i.length&&(i[L].v=F.substr(0,A+1)+i[L].v)}else if(O!==i.length&&F.indexOf("E")===-1){for(A=F.indexOf(".")-1,o=O;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(h=i[o].v.indexOf(".")>-1&&o===O?i[o].v.indexOf(".")-1:i[o].v.length-1,D=i[o].v.substr(h+1);h>=0;--h)A>=0&&(i[o].v.charAt(h)==="0"||i[o].v.charAt(h)==="#")&&(D=F.charAt(A--)+D);i[o].v=D,i[o].t="t",L=o}for(A>=0&&L<i.length&&(i[L].v=F.substr(0,A+1)+i[L].v),A=F.indexOf(".")+1,o=O;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==O)){for(h=i[o].v.indexOf(".")>-1&&o===O?i[o].v.indexOf(".")+1:0,D=i[o].v.substr(0,h);h<i[o].v.length;++h)A<F.length&&(D+=F.charAt(A++));i[o].v=D,i[o].t="t",L=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(M=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=Wo(i[o].t,i[o].v,M),i[o].t="t");var W="";for(o=0;o!==i.length;++o)i[o]!=null&&(W+=i[o].v);return W}var CA=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function yA(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Oie(e,t){var r=Lie(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(CA),a=r[1].match(CA);return yA(t,o)?[n,r[0]]:yA(t,a)?[n,r[1]]:[n,r[o!=null&&a!=null?2:1]]}return[n,s]}function ss(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:gt)[e],n==null&&(n=r.table&&r.table[mA[e]]||gt[mA[e]]),n==null&&(n=wie[e]||"General");break}if(X0(n,0))return sc(t,r);t instanceof Date&&(t=NI(t,r.date1904));var i=Oie(n,t);if(X0(i[1]))return sc(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Iie(i[1],t,r,i[0])}function Uo(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(gt[r]==null){t<0&&(t=r);continue}if(gt[r]==e){t=r;break}}t<0&&(t=391)}return gt[t]=e,t}function iv(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Uo(e[t],t)}function bd(){gt=vie()}var Nie={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},jI=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Bie(e){var t=typeof e=="number"?gt[e]:e;return t=t.replace(jI,"(\\d+)"),new RegExp("^"+t+"$")}function Hie(e,t,r){var n=-1,i=-1,s=-1,o=-1,a=-1,u=-1;(t.match(jI)||[]).forEach(function(g,m){var v=parseInt(r[m+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=v;break;case"d":s=v;break;case"h":o=v;break;case"s":u=v;break;case"m":o>=0?a=v:i=v;break}}),u>=0&&a==-1&&i>=0&&(a=i,i=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&a==-1&&u==-1?d:n==-1&&i==-1&&s==-1?h:d+"T"+h}var Gie=(function(){var e={};e.version="1.2.0";function t(){for(var F=0,O=new Array(256),L=0;L!=256;++L)F=L,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,O[L]=F;return typeof Int32Array<"u"?new Int32Array(O):O}var r=t();function n(F){var O=0,L=0,W=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)I[W]=F[W];for(W=0;W!=256;++W)for(L=F[W],O=256+W;O<4096;O+=256)L=I[O]=L>>>8^F[L&255];var G=[];for(W=1;W!=16;++W)G[W-1]=typeof Int32Array<"u"?I.subarray(W*256,W*256+256):I.slice(W*256,W*256+256);return G}var i=n(r),s=i[0],o=i[1],a=i[2],u=i[3],d=i[4],h=i[5],g=i[6],m=i[7],v=i[8],w=i[9],C=i[10],b=i[11],x=i[12],R=i[13],E=i[14];function A(F,O){for(var L=O^-1,W=0,I=F.length;W<I;)L=L>>>8^r[(L^F.charCodeAt(W++))&255];return~L}function D(F,O){for(var L=O^-1,W=F.length-15,I=0;I<W;)L=E[F[I++]^L&255]^R[F[I++]^L>>8&255]^x[F[I++]^L>>16&255]^b[F[I++]^L>>>24]^C[F[I++]]^w[F[I++]]^v[F[I++]]^m[F[I++]]^g[F[I++]]^h[F[I++]]^d[F[I++]]^u[F[I++]]^a[F[I++]]^o[F[I++]]^s[F[I++]]^r[F[I++]];for(W+=15;I<W;)L=L>>>8^r[(L^F[I++])&255];return~L}function M(F,O){for(var L=O^-1,W=0,I=F.length,G=0,ne=0;W<I;)G=F.charCodeAt(W++),G<128?L=L>>>8^r[(L^G)&255]:G<2048?(L=L>>>8^r[(L^(192|G>>6&31))&255],L=L>>>8^r[(L^(128|G&63))&255]):G>=55296&&G<57344?(G=(G&1023)+64,ne=F.charCodeAt(W++)&1023,L=L>>>8^r[(L^(240|G>>8&7))&255],L=L>>>8^r[(L^(128|G>>2&63))&255],L=L>>>8^r[(L^(128|ne>>6&15|(G&3)<<4))&255],L=L>>>8^r[(L^(128|ne&63))&255]):(L=L>>>8^r[(L^(224|G>>12&15))&255],L=L>>>8^r[(L^(128|G>>6&63))&255],L=L>>>8^r[(L^(128|G&63))&255]);return~L}return e.table=r,e.bstr=A,e.buf=D,e.str=M,e})(),at=(function(){var t={};t.version="1.2.1";function r(B,te){for(var K=B.split("/"),X=te.split("/"),ee=0,re=0,ve=Math.min(K.length,X.length);ee<ve;++ee){if(re=K[ee].length-X[ee].length)return re;if(K[ee]!=X[ee])return K[ee]<X[ee]?-1:1}return K.length-X.length}function n(B){if(B.charAt(B.length-1)=="/")return B.slice(0,-1).indexOf("/")===-1?B:n(B.slice(0,-1));var te=B.lastIndexOf("/");return te===-1?B:B.slice(0,te+1)}function i(B){if(B.charAt(B.length-1)=="/")return i(B.slice(0,-1));var te=B.lastIndexOf("/");return te===-1?B:B.slice(te+1)}function s(B,te){typeof te=="string"&&(te=new Date(te));var K=te.getHours();K=K<<6|te.getMinutes(),K=K<<5|te.getSeconds()>>>1,B.write_shift(2,K);var X=te.getFullYear()-1980;X=X<<4|te.getMonth()+1,X=X<<5|te.getDate(),B.write_shift(2,X)}function o(B){var te=B.read_shift(2)&65535,K=B.read_shift(2)&65535,X=new Date,ee=K&31;K>>>=5;var re=K&15;K>>>=4,X.setMilliseconds(0),X.setFullYear(K+1980),X.setMonth(re-1),X.setDate(ee);var ve=te&31;te>>>=5;var Fe=te&63;return te>>>=6,X.setHours(te),X.setMinutes(Fe),X.setSeconds(ve<<1),X}function a(B){wn(B,0);for(var te={},K=0;B.l<=B.length-4;){var X=B.read_shift(2),ee=B.read_shift(2),re=B.l+ee,ve={};switch(X){case 21589:K=B.read_shift(1),K&1&&(ve.mtime=B.read_shift(4)),ee>5&&(K&2&&(ve.atime=B.read_shift(4)),K&4&&(ve.ctime=B.read_shift(4))),ve.mtime&&(ve.mt=new Date(ve.mtime*1e3));break}B.l=re,te[X]=ve}return te}var u;function d(){return u||(u={})}function h(B,te){if(B[0]==80&&B[1]==75)return nn(B,te);if((B[0]|32)==109&&(B[1]|32)==105)return hs(B,te);if(B.length<512)throw new Error("CFB file size "+B.length+" < 512");var K=3,X=512,ee=0,re=0,ve=0,Fe=0,we=0,Ce=[],be=B.slice(0,512);wn(be,0);var Ne=g(be);switch(K=Ne[0],K){case 3:X=512;break;case 4:X=4096;break;case 0:if(Ne[1]==0)return nn(B,te);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}X!==512&&(be=B.slice(0,X),wn(be,28));var Ve=B.slice(0,X);m(be,K);var Ke=be.read_shift(4,"i");if(K===3&&Ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ke);be.l+=4,ve=be.read_shift(4,"i"),be.l+=4,be.chk("00100000","Mini Stream Cutoff Size: "),Fe=be.read_shift(4,"i"),ee=be.read_shift(4,"i"),we=be.read_shift(4,"i"),re=be.read_shift(4,"i");for(var Be=-1,je=0;je<109&&(Be=be.read_shift(4,"i"),!(Be<0));++je)Ce[je]=Be;var Je=v(B,X);b(we,re,Je,X,Ce);var cr=R(Je,ve,Ce,X);cr[ve].name="!Directory",ee>0&&Fe!==ne&&(cr[Fe].name="!MiniFAT"),cr[Ce[0]].name="!FAT",cr.fat_addrs=Ce,cr.ssz=X;var ur={},yr=[],Li=[],fl=[];E(ve,cr,Je,yr,ee,ur,Li,Fe),w(Li,fl,yr),yr.shift();var la={FileIndex:Li,FullPaths:fl};return te&&te.raw&&(la.raw={header:Ve,sectors:Je}),la}function g(B){if(B[B.l]==80&&B[B.l+1]==75)return[0,0];B.chk(ie,"Header Signature: "),B.l+=16;var te=B.read_shift(2,"u");return[B.read_shift(2,"u"),te]}function m(B,te){var K=9;switch(B.l+=2,K=B.read_shift(2)){case 9:if(te!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(te!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}B.chk("0600","Mini Sector Shift: "),B.chk("000000000000","Reserved: ")}function v(B,te){for(var K=Math.ceil(B.length/te)-1,X=[],ee=1;ee<K;++ee)X[ee-1]=B.slice(ee*te,(ee+1)*te);return X[K-1]=B.slice(K*te),X}function w(B,te,K){for(var X=0,ee=0,re=0,ve=0,Fe=0,we=K.length,Ce=[],be=[];X<we;++X)Ce[X]=be[X]=X,te[X]=K[X];for(;Fe<be.length;++Fe)X=be[Fe],ee=B[X].L,re=B[X].R,ve=B[X].C,Ce[X]===X&&(ee!==-1&&Ce[ee]!==ee&&(Ce[X]=Ce[ee]),re!==-1&&Ce[re]!==re&&(Ce[X]=Ce[re])),ve!==-1&&(Ce[ve]=X),ee!==-1&&X!=Ce[X]&&(Ce[ee]=Ce[X],be.lastIndexOf(ee)<Fe&&be.push(ee)),re!==-1&&X!=Ce[X]&&(Ce[re]=Ce[X],be.lastIndexOf(re)<Fe&&be.push(re));for(X=1;X<we;++X)Ce[X]===X&&(re!==-1&&Ce[re]!==re?Ce[X]=Ce[re]:ee!==-1&&Ce[ee]!==ee&&(Ce[X]=Ce[ee]));for(X=1;X<we;++X)if(B[X].type!==0){if(Fe=X,Fe!=Ce[Fe])do Fe=Ce[Fe],te[X]=te[Fe]+"/"+te[X];while(Fe!==0&&Ce[Fe]!==-1&&Fe!=Ce[Fe]);Ce[X]=-1}for(te[0]+="/",X=1;X<we;++X)B[X].type!==2&&(te[X]+="/")}function C(B,te,K){for(var X=B.start,ee=B.size,re=[],ve=X;K&&ee>0&&ve>=0;)re.push(te.slice(ve*G,ve*G+G)),ee-=G,ve=Ll(K,ve*4);return re.length===0?Re(0):ln(re).slice(0,B.size)}function b(B,te,K,X,ee){var re=ne;if(B===ne){if(te!==0)throw new Error("DIFAT chain shorter than expected")}else if(B!==-1){var ve=K[B],Fe=(X>>>2)-1;if(!ve)return;for(var we=0;we<Fe&&(re=Ll(ve,we*4))!==ne;++we)ee.push(re);b(Ll(ve,X-4),te-1,K,X,ee)}}function x(B,te,K,X,ee){var re=[],ve=[];ee||(ee=[]);var Fe=X-1,we=0,Ce=0;for(we=te;we>=0;){ee[we]=!0,re[re.length]=we,ve.push(B[we]);var be=K[Math.floor(we*4/X)];if(Ce=we*4&Fe,X<4+Ce)throw new Error("FAT boundary crossed: "+we+" 4 "+X);if(!B[be])break;we=Ll(B[be],Ce)}return{nodes:re,data:MA([ve])}}function R(B,te,K,X){var ee=B.length,re=[],ve=[],Fe=[],we=[],Ce=X-1,be=0,Ne=0,Ve=0,Ke=0;for(be=0;be<ee;++be)if(Fe=[],Ve=be+te,Ve>=ee&&(Ve-=ee),!ve[Ve]){we=[];var Be=[];for(Ne=Ve;Ne>=0;){Be[Ne]=!0,ve[Ne]=!0,Fe[Fe.length]=Ne,we.push(B[Ne]);var je=K[Math.floor(Ne*4/X)];if(Ke=Ne*4&Ce,X<4+Ke)throw new Error("FAT boundary crossed: "+Ne+" 4 "+X);if(!B[je]||(Ne=Ll(B[je],Ke),Be[Ne]))break}re[Ve]={nodes:Fe,data:MA([we])}}return re}function E(B,te,K,X,ee,re,ve,Fe){for(var we=0,Ce=X.length?2:0,be=te[B].data,Ne=0,Ve=0,Ke;Ne<be.length;Ne+=128){var Be=be.slice(Ne,Ne+128);wn(Be,64),Ve=Be.read_shift(2),Ke=r1(Be,0,Ve-Ce),X.push(Ke);var je={name:Ke,type:Be.read_shift(1),color:Be.read_shift(1),L:Be.read_shift(4,"i"),R:Be.read_shift(4,"i"),C:Be.read_shift(4,"i"),clsid:Be.read_shift(16),state:Be.read_shift(4,"i"),start:0,size:0},Je=Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2);Je!==0&&(je.ct=A(Be,Be.l-8));var cr=Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2);cr!==0&&(je.mt=A(Be,Be.l-8)),je.start=Be.read_shift(4,"i"),je.size=Be.read_shift(4,"i"),je.size<0&&je.start<0&&(je.size=je.type=0,je.start=ne,je.name=""),je.type===5?(we=je.start,ee>0&&we!==ne&&(te[we].name="!StreamData")):je.size>=4096?(je.storage="fat",te[je.start]===void 0&&(te[je.start]=x(K,je.start,te.fat_addrs,te.ssz)),te[je.start].name=je.name,je.content=te[je.start].data.slice(0,je.size)):(je.storage="minifat",je.size<0?je.size=0:we!==ne&&je.start!==ne&&te[we]&&(je.content=C(je,te[we].data,(te[Fe]||{}).data))),je.content&&wn(je.content,0),re[Ke]=je,ve.push(je)}}function A(B,te){return new Date((bi(B,te+4)/1e7*Math.pow(2,32)+bi(B,te)/1e7-11644473600)*1e3)}function D(B,te){return d(),h(u.readFileSync(B),te)}function M(B,te){var K=te&&te.type;switch(K||Rt&&Buffer.isBuffer(B)&&(K="buffer"),K||"base64"){case"file":return D(B,te);case"base64":return h(Si(Ai(B)),te);case"binary":return h(Si(B),te)}return h(B,te)}function F(B,te){var K=te||{},X=K.root||"Root Entry";if(B.FullPaths||(B.FullPaths=[]),B.FileIndex||(B.FileIndex=[]),B.FullPaths.length!==B.FileIndex.length)throw new Error("inconsistent CFB structure");B.FullPaths.length===0&&(B.FullPaths[0]=X+"/",B.FileIndex[0]={name:X,type:5}),K.CLSID&&(B.FileIndex[0].clsid=K.CLSID),O(B)}function O(B){var te="Sh33tJ5";if(!at.find(B,"/"+te)){var K=Re(4);K[0]=55,K[1]=K[3]=50,K[2]=54,B.FileIndex.push({name:te,type:2,content:K,size:4,L:69,R:69,C:69}),B.FullPaths.push(B.FullPaths[0]+te),L(B)}}function L(B,te){F(B);for(var K=!1,X=!1,ee=B.FullPaths.length-1;ee>=0;--ee){var re=B.FileIndex[ee];switch(re.type){case 0:X?K=!0:(B.FileIndex.pop(),B.FullPaths.pop());break;case 1:case 2:case 5:X=!0,isNaN(re.R*re.L*re.C)&&(K=!0),re.R>-1&&re.L>-1&&re.R==re.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!te)){var ve=new Date(1987,1,19),Fe=0,we=Object.create?Object.create(null):{},Ce=[];for(ee=0;ee<B.FullPaths.length;++ee)we[B.FullPaths[ee]]=!0,B.FileIndex[ee].type!==0&&Ce.push([B.FullPaths[ee],B.FileIndex[ee]]);for(ee=0;ee<Ce.length;++ee){var be=n(Ce[ee][0]);X=we[be],X||(Ce.push([be,{name:i(be).replace("/",""),type:1,clsid:_,ct:ve,mt:ve,content:null}]),we[be]=!0)}for(Ce.sort(function(Ke,Be){return r(Ke[0],Be[0])}),B.FullPaths=[],B.FileIndex=[],ee=0;ee<Ce.length;++ee)B.FullPaths[ee]=Ce[ee][0],B.FileIndex[ee]=Ce[ee][1];for(ee=0;ee<Ce.length;++ee){var Ne=B.FileIndex[ee],Ve=B.FullPaths[ee];if(Ne.name=i(Ve).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||_,ee===0)Ne.C=Ce.length>1?1:-1,Ne.size=0,Ne.type=5;else if(Ve.slice(-1)=="/"){for(Fe=ee+1;Fe<Ce.length&&n(B.FullPaths[Fe])!=Ve;++Fe);for(Ne.C=Fe>=Ce.length?-1:Fe,Fe=ee+1;Fe<Ce.length&&n(B.FullPaths[Fe])!=n(Ve);++Fe);Ne.R=Fe>=Ce.length?-1:Fe,Ne.type=1}else n(B.FullPaths[ee+1]||"")==n(Ve)&&(Ne.R=ee+1),Ne.type=2}}}function W(B,te){var K=te||{};if(K.fileType=="mad")return Fc(B,K);switch(L(B),K.fileType){case"zip":return ia(B,K)}var X=(function(Ke){for(var Be=0,je=0,Je=0;Je<Ke.FileIndex.length;++Je){var cr=Ke.FileIndex[Je];if(cr.content){var ur=cr.content.length;ur>0&&(ur<4096?Be+=ur+63>>6:je+=ur+511>>9)}}for(var yr=Ke.FullPaths.length+3>>2,Li=Be+7>>3,fl=Be+127>>7,la=Li+je+yr+fl,_s=la+127>>7,Dd=_s<=109?0:Math.ceil((_s-109)/127);la+_s+Dd+127>>7>_s;)Dd=++_s<=109?0:Math.ceil((_s-109)/127);var qn=[1,Dd,_s,fl,yr,je,Be,0];return Ke.FileIndex[0].size=Be<<6,qn[7]=(Ke.FileIndex[0].start=qn[0]+qn[1]+qn[2]+qn[3]+qn[4]+qn[5])+(qn[6]+7>>3),qn})(B),ee=Re(X[7]<<9),re=0,ve=0;{for(re=0;re<8;++re)ee.write_shift(1,J[re]);for(re=0;re<8;++re)ee.write_shift(2,0);for(ee.write_shift(2,62),ee.write_shift(2,3),ee.write_shift(2,65534),ee.write_shift(2,9),ee.write_shift(2,6),re=0;re<3;++re)ee.write_shift(2,0);for(ee.write_shift(4,0),ee.write_shift(4,X[2]),ee.write_shift(4,X[0]+X[1]+X[2]+X[3]-1),ee.write_shift(4,0),ee.write_shift(4,4096),ee.write_shift(4,X[3]?X[0]+X[1]+X[2]-1:ne),ee.write_shift(4,X[3]),ee.write_shift(-4,X[1]?X[0]-1:ne),ee.write_shift(4,X[1]),re=0;re<109;++re)ee.write_shift(-4,re<X[2]?X[1]+re:-1)}if(X[1])for(ve=0;ve<X[1];++ve){for(;re<236+ve*127;++re)ee.write_shift(-4,re<X[2]?X[1]+re:-1);ee.write_shift(-4,ve===X[1]-1?ne:ve+1)}var Fe=function(Ke){for(ve+=Ke;re<ve-1;++re)ee.write_shift(-4,re+1);Ke&&(++re,ee.write_shift(-4,ne))};for(ve=re=0,ve+=X[1];re<ve;++re)ee.write_shift(-4,Y.DIFSECT);for(ve+=X[2];re<ve;++re)ee.write_shift(-4,Y.FATSECT);Fe(X[3]),Fe(X[4]);for(var we=0,Ce=0,be=B.FileIndex[0];we<B.FileIndex.length;++we)be=B.FileIndex[we],be.content&&(Ce=be.content.length,!(Ce<4096)&&(be.start=ve,Fe(Ce+511>>9)));for(Fe(X[6]+7>>3);ee.l&511;)ee.write_shift(-4,Y.ENDOFCHAIN);for(ve=re=0,we=0;we<B.FileIndex.length;++we)be=B.FileIndex[we],be.content&&(Ce=be.content.length,!(!Ce||Ce>=4096)&&(be.start=ve,Fe(Ce+63>>6)));for(;ee.l&511;)ee.write_shift(-4,Y.ENDOFCHAIN);for(re=0;re<X[4]<<2;++re){var Ne=B.FullPaths[re];if(!Ne||Ne.length===0){for(we=0;we<17;++we)ee.write_shift(4,0);for(we=0;we<3;++we)ee.write_shift(4,-1);for(we=0;we<12;++we)ee.write_shift(4,0);continue}be=B.FileIndex[re],re===0&&(be.start=be.size?be.start-1:ne);var Ve=re===0&&K.root||be.name;if(Ce=2*(Ve.length+1),ee.write_shift(64,Ve,"utf16le"),ee.write_shift(2,Ce),ee.write_shift(1,be.type),ee.write_shift(1,be.color),ee.write_shift(-4,be.L),ee.write_shift(-4,be.R),ee.write_shift(-4,be.C),be.clsid)ee.write_shift(16,be.clsid,"hex");else for(we=0;we<4;++we)ee.write_shift(4,0);ee.write_shift(4,be.state||0),ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(4,be.start),ee.write_shift(4,be.size),ee.write_shift(4,0)}for(re=1;re<B.FileIndex.length;++re)if(be=B.FileIndex[re],be.size>=4096)if(ee.l=be.start+1<<9,Rt&&Buffer.isBuffer(be.content))be.content.copy(ee,ee.l,0,be.size),ee.l+=be.size+511&-512;else{for(we=0;we<be.size;++we)ee.write_shift(1,be.content[we]);for(;we&511;++we)ee.write_shift(1,0)}for(re=1;re<B.FileIndex.length;++re)if(be=B.FileIndex[re],be.size>0&&be.size<4096)if(Rt&&Buffer.isBuffer(be.content))be.content.copy(ee,ee.l,0,be.size),ee.l+=be.size+63&-64;else{for(we=0;we<be.size;++we)ee.write_shift(1,be.content[we]);for(;we&63;++we)ee.write_shift(1,0)}if(Rt)ee.l=ee.length;else for(;ee.l<ee.length;)ee.write_shift(1,0);return ee}function I(B,te){var K=B.FullPaths.map(function(we){return we.toUpperCase()}),X=K.map(function(we){var Ce=we.split("/");return Ce[Ce.length-(we.slice(-1)=="/"?2:1)]}),ee=!1;te.charCodeAt(0)===47?(ee=!0,te=K[0].slice(0,-1)+te):ee=te.indexOf("/")!==-1;var re=te.toUpperCase(),ve=ee===!0?K.indexOf(re):X.indexOf(re);if(ve!==-1)return B.FileIndex[ve];var Fe=!re.match(Ph);for(re=re.replace(Un,""),Fe&&(re=re.replace(Ph,"!")),ve=0;ve<K.length;++ve)if((Fe?K[ve].replace(Ph,"!"):K[ve]).replace(Un,"")==re||(Fe?X[ve].replace(Ph,"!"):X[ve]).replace(Un,"")==re)return B.FileIndex[ve];return null}var G=64,ne=-2,ie="d0cf11e0a1b11ae1",J=[208,207,17,224,161,177,26,225],_="00000000000000000000000000000000",Y={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ne,FREESECT:-1,HEADER_SIGNATURE:ie,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:_,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Q(B,te,K){d();var X=W(B,K);u.writeFileSync(te,X)}function U(B){for(var te=new Array(B.length),K=0;K<B.length;++K)te[K]=String.fromCharCode(B[K]);return te.join("")}function se(B,te){var K=W(B,te);switch(te&&te.type||"buffer"){case"file":return d(),u.writeFileSync(te.filename,K),K;case"binary":return typeof K=="string"?K:U(K);case"base64":return Cf(typeof K=="string"?K:U(K));case"buffer":if(Rt)return Buffer.isBuffer(K)?K:ta(K);case"array":return typeof K=="string"?Si(K):K}return K}var N;function P(B){try{var te=B.InflateRaw,K=new te;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)N=B;else throw new Error("zlib does not expose bytesRead")}catch(X){console.error("cannot use native zlib: "+(X.message||X))}}function V(B,te){if(!N)return Yt(B,te);var K=N.InflateRaw,X=new K,ee=X._processChunk(B.slice(B.l),X._finishFlushFlag);return B.l+=X.bytesRead,ee}function H(B){return N?N.deflateRawSync(B):ht(B)}var j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function le(B){var te=(B<<1|B<<11)&139536|(B<<5|B<<15)&558144;return(te>>16|te>>8|te)&255}for(var de=typeof Uint8Array<"u",ue=de?new Uint8Array(256):[],Ie=0;Ie<256;++Ie)ue[Ie]=le(Ie);function q(B,te){var K=ue[B&255];return te<=8?K>>>8-te:(K=K<<8|ue[B>>8&255],te<=16?K>>>16-te:(K=K<<8|ue[B>>16&255],K>>>24-te))}function Ge(B,te){var K=te&7,X=te>>>3;return(B[X]|(K<=6?0:B[X+1]<<8))>>>K&3}function Ye(B,te){var K=te&7,X=te>>>3;return(B[X]|(K<=5?0:B[X+1]<<8))>>>K&7}function Ze(B,te){var K=te&7,X=te>>>3;return(B[X]|(K<=4?0:B[X+1]<<8))>>>K&15}function ke(B,te){var K=te&7,X=te>>>3;return(B[X]|(K<=3?0:B[X+1]<<8))>>>K&31}function De(B,te){var K=te&7,X=te>>>3;return(B[X]|(K<=1?0:B[X+1]<<8))>>>K&127}function nt(B,te,K){var X=te&7,ee=te>>>3,re=(1<<K)-1,ve=B[ee]>>>X;return K<8-X||(ve|=B[ee+1]<<8-X,K<16-X)||(ve|=B[ee+2]<<16-X,K<24-X)||(ve|=B[ee+3]<<24-X),ve&re}function vt(B,te,K){var X=te&7,ee=te>>>3;return X<=5?B[ee]|=(K&7)<<X:(B[ee]|=K<<X&255,B[ee+1]=(K&7)>>8-X),te+3}function Xe(B,te,K){var X=te&7,ee=te>>>3;return K=(K&1)<<X,B[ee]|=K,te+1}function st(B,te,K){var X=te&7,ee=te>>>3;return K<<=X,B[ee]|=K&255,K>>>=8,B[ee+1]=K,te+8}function Ct(B,te,K){var X=te&7,ee=te>>>3;return K<<=X,B[ee]|=K&255,K>>>=8,B[ee+1]=K&255,B[ee+2]=K>>>8,te+16}function ar(B,te){var K=B.length,X=2*K>te?2*K:te+5,ee=0;if(K>=te)return B;if(Rt){var re=fA(X);if(B.copy)B.copy(re);else for(;ee<B.length;++ee)re[ee]=B[ee];return re}else if(de){var ve=new Uint8Array(X);if(ve.set)ve.set(B);else for(;ee<K;++ee)ve[ee]=B[ee];return ve}return B.length=X,B}function qe(B){for(var te=new Array(B),K=0;K<B;++K)te[K]=0;return te}function hr(B,te,K){var X=1,ee=0,re=0,ve=0,Fe=0,we=B.length,Ce=de?new Uint16Array(32):qe(32);for(re=0;re<32;++re)Ce[re]=0;for(re=we;re<K;++re)B[re]=0;we=B.length;var be=de?new Uint16Array(we):qe(we);for(re=0;re<we;++re)Ce[ee=B[re]]++,X<ee&&(X=ee),be[re]=0;for(Ce[0]=0,re=1;re<=X;++re)Ce[re+16]=Fe=Fe+Ce[re-1]<<1;for(re=0;re<we;++re)Fe=B[re],Fe!=0&&(be[re]=Ce[Fe+16]++);var Ne=0;for(re=0;re<we;++re)if(Ne=B[re],Ne!=0)for(Fe=q(be[re],X)>>X-Ne,ve=(1<<X+4-Ne)-1;ve>=0;--ve)te[Fe|ve<<Ne]=Ne&15|re<<4;return X}var Or=de?new Uint16Array(512):qe(512),Et=de?new Uint16Array(32):qe(32);if(!de){for(var dt=0;dt<512;++dt)Or[dt]=0;for(dt=0;dt<32;++dt)Et[dt]=0}(function(){for(var B=[],te=0;te<32;te++)B.push(5);hr(B,Et,32);var K=[];for(te=0;te<=143;te++)K.push(8);for(;te<=255;te++)K.push(9);for(;te<=279;te++)K.push(7);for(;te<=287;te++)K.push(8);hr(K,Or,288)})();var At=(function(){for(var te=de?new Uint8Array(32768):[],K=0,X=0;K<fe.length-1;++K)for(;X<fe[K+1];++X)te[X]=K;for(;X<32768;++X)te[X]=29;var ee=de?new Uint8Array(259):[];for(K=0,X=0;K<ae.length-1;++K)for(;X<ae[K+1];++X)ee[X]=K;function re(Fe,we){for(var Ce=0;Ce<Fe.length;){var be=Math.min(65535,Fe.length-Ce),Ne=Ce+be==Fe.length;for(we.write_shift(1,+Ne),we.write_shift(2,be),we.write_shift(2,~be&65535);be-- >0;)we[we.l++]=Fe[Ce++]}return we.l}function ve(Fe,we){for(var Ce=0,be=0,Ne=de?new Uint16Array(32768):[];be<Fe.length;){var Ve=Math.min(65535,Fe.length-be);if(Ve<10){for(Ce=vt(we,Ce,+(be+Ve==Fe.length)),Ce&7&&(Ce+=8-(Ce&7)),we.l=Ce/8|0,we.write_shift(2,Ve),we.write_shift(2,~Ve&65535);Ve-- >0;)we[we.l++]=Fe[be++];Ce=we.l*8;continue}Ce=vt(we,Ce,+(be+Ve==Fe.length)+2);for(var Ke=0;Ve-- >0;){var Be=Fe[be];Ke=(Ke<<5^Be)&32767;var je=-1,Je=0;if((je=Ne[Ke])&&(je|=be&-32768,je>be&&(je-=32768),je<be))for(;Fe[je+Je]==Fe[be+Je]&&Je<250;)++Je;if(Je>2){Be=ee[Je],Be<=22?Ce=st(we,Ce,ue[Be+1]>>1)-1:(st(we,Ce,3),Ce+=5,st(we,Ce,ue[Be-23]>>5),Ce+=3);var cr=Be<8?0:Be-4>>2;cr>0&&(Ct(we,Ce,Je-ae[Be]),Ce+=cr),Be=te[be-je],Ce=st(we,Ce,ue[Be]>>3),Ce-=3;var ur=Be<4?0:Be-2>>1;ur>0&&(Ct(we,Ce,be-je-fe[Be]),Ce+=ur);for(var yr=0;yr<Je;++yr)Ne[Ke]=be&32767,Ke=(Ke<<5^Fe[be])&32767,++be;Ve-=Je-1}else Be<=143?Be=Be+48:Ce=Xe(we,Ce,1),Ce=st(we,Ce,ue[Be]),Ne[Ke]=be&32767,++be}Ce=st(we,Ce,0)-1}return we.l=(Ce+7)/8|0,we.l}return function(we,Ce){return we.length<8?re(we,Ce):ve(we,Ce)}})();function ht(B){var te=Re(50+Math.floor(B.length*1.1)),K=At(B,te);return te.slice(0,K)}var jt=de?new Uint16Array(32768):qe(32768),Tt=de?new Uint16Array(32768):qe(32768),It=de?new Uint16Array(128):qe(128),lr=1,$r=1;function Cr(B,te){var K=ke(B,te)+257;te+=5;var X=ke(B,te)+1;te+=5;var ee=Ze(B,te)+4;te+=4;for(var re=0,ve=de?new Uint8Array(19):qe(19),Fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],we=1,Ce=de?new Uint8Array(8):qe(8),be=de?new Uint8Array(8):qe(8),Ne=ve.length,Ve=0;Ve<ee;++Ve)ve[j[Ve]]=re=Ye(B,te),we<re&&(we=re),Ce[re]++,te+=3;var Ke=0;for(Ce[0]=0,Ve=1;Ve<=we;++Ve)be[Ve]=Ke=Ke+Ce[Ve-1]<<1;for(Ve=0;Ve<Ne;++Ve)(Ke=ve[Ve])!=0&&(Fe[Ve]=be[Ke]++);var Be=0;for(Ve=0;Ve<Ne;++Ve)if(Be=ve[Ve],Be!=0){Ke=ue[Fe[Ve]]>>8-Be;for(var je=(1<<7-Be)-1;je>=0;--je)It[Ke|je<<Be]=Be&7|Ve<<3}var Je=[];for(we=1;Je.length<K+X;)switch(Ke=It[De(B,te)],te+=Ke&7,Ke>>>=3){case 16:for(re=3+Ge(B,te),te+=2,Ke=Je[Je.length-1];re-- >0;)Je.push(Ke);break;case 17:for(re=3+Ye(B,te),te+=3;re-- >0;)Je.push(0);break;case 18:for(re=11+De(B,te),te+=7;re-- >0;)Je.push(0);break;default:Je.push(Ke),we<Ke&&(we=Ke);break}var cr=Je.slice(0,K),ur=Je.slice(K);for(Ve=K;Ve<286;++Ve)cr[Ve]=0;for(Ve=X;Ve<30;++Ve)ur[Ve]=0;return lr=hr(cr,jt,286),$r=hr(ur,Tt,30),te}function dl(B,te){if(B[0]==3&&!(B[1]&3))return[qa(te),2];for(var K=0,X=0,ee=fA(te||1<<18),re=0,ve=ee.length>>>0,Fe=0,we=0;(X&1)==0;){if(X=Ye(B,K),K+=3,X>>>1)X>>1==1?(Fe=9,we=5):(K=Cr(B,K),Fe=lr,we=$r);else{K&7&&(K+=8-(K&7));var Ce=B[K>>>3]|B[(K>>>3)+1]<<8;if(K+=32,Ce>0)for(!te&&ve<re+Ce&&(ee=ar(ee,re+Ce),ve=ee.length);Ce-- >0;)ee[re++]=B[K>>>3],K+=8;continue}for(;;){!te&&ve<re+32767&&(ee=ar(ee,re+32767),ve=ee.length);var be=nt(B,K,Fe),Ne=X>>>1==1?Or[be]:jt[be];if(K+=Ne&15,Ne>>>=4,(Ne>>>8&255)===0)ee[re++]=Ne;else{if(Ne==256)break;Ne-=257;var Ve=Ne<8?0:Ne-4>>2;Ve>5&&(Ve=0);var Ke=re+ae[Ne];Ve>0&&(Ke+=nt(B,K,Ve),K+=Ve),be=nt(B,K,we),Ne=X>>>1==1?Et[be]:Tt[be],K+=Ne&15,Ne>>>=4;var Be=Ne<4?0:Ne-2>>1,je=fe[Ne];for(Be>0&&(je+=nt(B,K,Be),K+=Be),!te&&ve<Ke&&(ee=ar(ee,Ke+100),ve=ee.length);re<Ke;)ee[re]=ee[re-je],++re}}}return te?[ee,K+7>>>3]:[ee.slice(0,re),K+7>>>3]}function Yt(B,te){var K=B.slice(B.l||0),X=dl(K,te);return B.l+=X[1],X[0]}function Sn(B,te){if(B)typeof console<"u"&&console.error(te);else throw new Error(te)}function nn(B,te){var K=B;wn(K,0);var X=[],ee=[],re={FileIndex:X,FullPaths:ee};F(re,{root:te.root});for(var ve=K.length-4;(K[ve]!=80||K[ve+1]!=75||K[ve+2]!=5||K[ve+3]!=6)&&ve>=0;)--ve;K.l=ve+4,K.l+=4;var Fe=K.read_shift(2);K.l+=6;var we=K.read_shift(4);for(K.l=we,ve=0;ve<Fe;++ve){K.l+=20;var Ce=K.read_shift(4),be=K.read_shift(4),Ne=K.read_shift(2),Ve=K.read_shift(2),Ke=K.read_shift(2);K.l+=8;var Be=K.read_shift(4),je=a(K.slice(K.l+Ne,K.l+Ne+Ve));K.l+=Ne+Ve+Ke;var Je=K.l;K.l=Be+4,uo(K,Ce,be,re,je),K.l=Je}return re}function uo(B,te,K,X,ee){B.l+=2;var re=B.read_shift(2),ve=B.read_shift(2),Fe=o(B);if(re&8257)throw new Error("Unsupported ZIP encryption");for(var we=B.read_shift(4),Ce=B.read_shift(4),be=B.read_shift(4),Ne=B.read_shift(2),Ve=B.read_shift(2),Ke="",Be=0;Be<Ne;++Be)Ke+=String.fromCharCode(B[B.l++]);if(Ve){var je=a(B.slice(B.l,B.l+Ve));(je[21589]||{}).mt&&(Fe=je[21589].mt),((ee||{})[21589]||{}).mt&&(Fe=ee[21589].mt)}B.l+=Ve;var Je=B.slice(B.l,B.l+Ce);switch(ve){case 8:Je=V(B,be);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ve)}var cr=!1;re&8&&(we=B.read_shift(4),we==134695760&&(we=B.read_shift(4),cr=!0),Ce=B.read_shift(4),be=B.read_shift(4)),Ce!=te&&Sn(cr,"Bad compressed size: "+te+" != "+Ce),be!=K&&Sn(cr,"Bad uncompressed size: "+K+" != "+be),kt(X,Ke,Je,{unsafe:!0,mt:Fe})}function ia(B,te){var K=te||{},X=[],ee=[],re=Re(1),ve=K.compression?8:0,Fe=0,we=0,Ce=0,be=0,Ne=0,Ve=B.FullPaths[0],Ke=Ve,Be=B.FileIndex[0],je=[],Je=0;for(we=1;we<B.FullPaths.length;++we)if(Ke=B.FullPaths[we].slice(Ve.length),Be=B.FileIndex[we],!(!Be.size||!Be.content||Ke=="Sh33tJ5")){var cr=be,ur=Re(Ke.length);for(Ce=0;Ce<Ke.length;++Ce)ur.write_shift(1,Ke.charCodeAt(Ce)&127);ur=ur.slice(0,ur.l),je[Ne]=Gie.buf(Be.content,0);var yr=Be.content;ve==8&&(yr=H(yr)),re=Re(30),re.write_shift(4,67324752),re.write_shift(2,20),re.write_shift(2,Fe),re.write_shift(2,ve),Be.mt?s(re,Be.mt):re.write_shift(4,0),re.write_shift(-4,je[Ne]),re.write_shift(4,yr.length),re.write_shift(4,Be.content.length),re.write_shift(2,ur.length),re.write_shift(2,0),be+=re.length,X.push(re),be+=ur.length,X.push(ur),be+=yr.length,X.push(yr),re=Re(46),re.write_shift(4,33639248),re.write_shift(2,0),re.write_shift(2,20),re.write_shift(2,Fe),re.write_shift(2,ve),re.write_shift(4,0),re.write_shift(-4,je[Ne]),re.write_shift(4,yr.length),re.write_shift(4,Be.content.length),re.write_shift(2,ur.length),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(4,0),re.write_shift(4,cr),Je+=re.l,ee.push(re),Je+=ur.length,ee.push(ur),++Ne}return re=Re(22),re.write_shift(4,101010256),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,Ne),re.write_shift(2,Ne),re.write_shift(4,Je),re.write_shift(4,be),re.write_shift(2,0),ln([ln(X),ln(ee),re])}var Ar={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function sa(B,te){if(B.ctype)return B.ctype;var K=B.name||"",X=K.match(/\.([^\.]+)$/);return X&&Ar[X[1]]||te&&(X=(K=te).match(/[\.\\]([^\.\\])+$/),X&&Ar[X[1]])?Ar[X[1]]:"application/octet-stream"}function ho(B){for(var te=Cf(B),K=[],X=0;X<te.length;X+=76)K.push(te.slice(X,X+76));return K.join(`\r
`)+`\r
`}function hl(B){var te=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ce){var be=Ce.charCodeAt(0).toString(16).toUpperCase();return"="+(be.length==1?"0"+be:be)});te=te.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),te.charAt(0)==`
`&&(te="=0D"+te.slice(1)),te=te.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],X=te.split(`\r
`),ee=0;ee<X.length;++ee){var re=X[ee];if(re.length==0){K.push("");continue}for(var ve=0;ve<re.length;){var Fe=76,we=re.slice(ve,ve+Fe);we.charAt(Fe-1)=="="?Fe--:we.charAt(Fe-2)=="="?Fe-=2:we.charAt(Fe-3)=="="&&(Fe-=3),we=re.slice(ve,ve+Fe),ve+=Fe,ve<re.length&&(we+="="),K.push(we)}}return K.join(`\r
`)}function oa(B){for(var te=[],K=0;K<B.length;++K){for(var X=B[K];K<=B.length&&X.charAt(X.length-1)=="=";)X=X.slice(0,X.length-1)+B[++K];te.push(X)}for(var ee=0;ee<te.length;++ee)te[ee]=te[ee].replace(/[=][0-9A-Fa-f]{2}/g,function(re){return String.fromCharCode(parseInt(re.slice(1),16))});return Si(te.join(`\r
`))}function fo(B,te,K){for(var X="",ee="",re="",ve,Fe=0;Fe<10;++Fe){var we=te[Fe];if(!we||we.match(/^\s*$/))break;var Ce=we.match(/^(.*?):\s*([^\s].*)$/);if(Ce)switch(Ce[1].toLowerCase()){case"content-location":X=Ce[2].trim();break;case"content-type":re=Ce[2].trim();break;case"content-transfer-encoding":ee=Ce[2].trim();break}}switch(++Fe,ee.toLowerCase()){case"base64":ve=Si(Ai(te.slice(Fe).join("")));break;case"quoted-printable":ve=oa(te.slice(Fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ee)}var be=kt(B,X.slice(K.length),ve,{unsafe:!0});re&&(be.ctype=re)}function hs(B,te){if(U(B.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=te&&te.root||"",X=(Rt&&Buffer.isBuffer(B)?B.toString("binary"):U(B)).split(`\r
`),ee=0,re="";for(ee=0;ee<X.length;++ee)if(re=X[ee],!!/^Content-Location:/i.test(re)&&(re=re.slice(re.indexOf("file")),K||(K=re.slice(0,re.lastIndexOf("/")+1)),re.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),re.slice(0,K.length)!=K););var ve=(X[1]||"").match(/boundary="(.*?)"/);if(!ve)throw new Error("MAD cannot find boundary");var Fe="--"+(ve[1]||""),we=[],Ce=[],be={FileIndex:we,FullPaths:Ce};F(be);var Ne,Ve=0;for(ee=0;ee<X.length;++ee){var Ke=X[ee];Ke!==Fe&&Ke!==Fe+"--"||(Ve++&&fo(be,X.slice(Ne,ee),K),Ne=ee)}return be}function Fc(B,te){var K=te||{},X=K.boundary||"SheetJS";X="------="+X;for(var ee=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+X.slice(2)+'"',"","",""],re=B.FullPaths[0],ve=re,Fe=B.FileIndex[0],we=1;we<B.FullPaths.length;++we)if(ve=B.FullPaths[we].slice(re.length),Fe=B.FileIndex[we],!(!Fe.size||!Fe.content||ve=="Sh33tJ5")){ve=ve.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Je){return"_x"+Je.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Je){return"_u"+Je.charCodeAt(0).toString(16)+"_"});for(var Ce=Fe.content,be=Rt&&Buffer.isBuffer(Ce)?Ce.toString("binary"):U(Ce),Ne=0,Ve=Math.min(1024,be.length),Ke=0,Be=0;Be<=Ve;++Be)(Ke=be.charCodeAt(Be))>=32&&Ke<128&&++Ne;var je=Ne>=Ve*4/5;ee.push(X),ee.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+ve),ee.push("Content-Transfer-Encoding: "+(je?"quoted-printable":"base64")),ee.push("Content-Type: "+sa(Fe,ve)),ee.push(""),ee.push(je?hl(be):ho(be))}return ee.push(X+`--\r
`),ee.join(`\r
`)}function Dc(B){var te={};return F(te,B),te}function kt(B,te,K,X){var ee=X&&X.unsafe;ee||F(B);var re=!ee&&at.find(B,te);if(!re){var ve=B.FullPaths[0];te.slice(0,ve.length)==ve?ve=te:(ve.slice(-1)!="/"&&(ve+="/"),ve=(ve+te).replace("//","/")),re={name:i(te),type:2},B.FileIndex.push(re),B.FullPaths.push(ve),ee||at.utils.cfb_gc(B)}return re.content=K,re.size=K?K.length:0,X&&(X.CLSID&&(re.clsid=X.CLSID),X.mt&&(re.mt=X.mt),X.ct&&(re.ct=X.ct)),re}function jr(B,te){F(B);var K=at.find(B,te);if(K){for(var X=0;X<B.FileIndex.length;++X)if(B.FileIndex[X]==K)return B.FileIndex.splice(X,1),B.FullPaths.splice(X,1),!0}return!1}function Ms(B,te,K){F(B);var X=at.find(B,te);if(X){for(var ee=0;ee<B.FileIndex.length;++ee)if(B.FileIndex[ee]==X)return B.FileIndex[ee].name=i(K),B.FullPaths[ee]=K,!0}return!1}function aa(B){L(B,!0)}return t.find=I,t.read=M,t.parse=h,t.write=se,t.writeFile=Q,t.utils={cfb_new:Dc,cfb_add:kt,cfb_del:jr,cfb_mov:Ms,cfb_gc:aa,ReadShift:Uh,CheckField:gO,prep_blob:wn,bconcat:ln,use_zlib:P,_deflateRaw:ht,_inflateRaw:Yt,consts:Y},t})();function Vie(e){return typeof e=="string"?nv(e):Array.isArray(e)?fie(e):e}function Yf(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=nv(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Xs(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([Vie(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(e);return a.open("w"),a.encoding="binary",Array.isArray(t)&&(t=sl(t)),a.write(t),a.close(),t}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+e)}function zie(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Ir(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function bA(e,t){for(var r=[],n=Ir(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function sv(e){for(var t=[],r=Ir(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function ov(e){for(var t=[],r=Ir(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function Wie(e){for(var t=[],r=Ir(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Z0=new Date(1899,11,30,0,0,0);function rn(e,t){var r=e.getTime(),n=Z0.getTime()+(e.getTimezoneOffset()-Z0.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var YI=new Date,Uie=Z0.getTime()+(YI.getTimezoneOffset()-Z0.getTimezoneOffset())*6e4,SA=YI.getTimezoneOffset();function av(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Uie),t.getTimezoneOffset()!==SA&&t.setTime(t.getTime()+(t.getTimezoneOffset()-SA)*6e4),t}function $ie(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var xA=new Date("2017-02-19T19:06:09.000Z"),KI=isNaN(xA.getFullYear())?new Date("2/19/17"):xA,jie=KI.getFullYear()==2017;function mr(e,t){var r=new Date(e);if(jie)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(KI.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function oc(e,t){if(Rt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Xs(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Xs(II(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Xs(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Xs(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function vr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=vr(e[r]));return t}function Mr(e,t){for(var r="";r.length<t;)r+=e;return r}function xs(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var Yie=["january","february","march","april","may","june","july","august","september","october","november","december"];function nd(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&Yie.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Kie=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],a=1;a<s.length;++a)o.push(i),o.push(s[a]);return o}})();function qI(e){return e?e.content&&e.type?oc(e.content,!0):e.data?kh(e.data):e.asNodeBuffer&&Rt?kh(e.asNodeBuffer().toString("binary")):e.asBinary?kh(e.asBinary()):e._data&&e._data.getContent?kh(oc(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function XI(e){if(!e)return null;if(e.data)return dA(e.data);if(e.asNodeBuffer&&Rt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?dA(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function qie(e){return e&&e.name.slice(-4)===".bin"?XI(e):qI(e)}function Qi(e,t){for(var r=e.FullPaths||Ir(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Xx(e,t){var r=Qi(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Zr(e,t,r){if(!r)return qie(Xx(e,t));if(!t)return null;try{return Zr(e,t)}catch{return null}}function xi(e,t,r){if(!r)return qI(Xx(e,t));if(!t)return null;try{return xi(e,t)}catch{return null}}function Xie(e,t,r){return XI(Xx(e,t))}function EA(e){for(var t=e.FullPaths||Ir(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function xt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Rt?n=ta(r):n=gie(r),at.utils.cfb_add(e,t,n)}at.utils.cfb_add(e,t,r)}else e.file(t,r)}function Qx(){return at.utils.cfb_new()}function QI(e,t){switch(t.type){case"base64":return at.read(e,{type:"base64"});case"binary":return at.read(e,{type:"binary"});case"buffer":case"array":return at.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Mh(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Wr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Qie=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,RA=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Zie=/<[^>]*>/g,Nn=Wr.match(RA)?RA:Zie,Jie=/<\w*:/,ese=/<(\/?)\w+:/;function mt(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(Qie),a=0,u="",d=0,h="",g="",m=1;if(o)for(d=0;d!=o.length;++d){for(g=o[d],s=0;s!=g.length&&g.charCodeAt(s)!==61;++s);for(h=g.slice(0,s).trim();g.charCodeAt(s+1)==32;)++s;for(m=(i=g.charCodeAt(s+1))==34||i==39?1:0,u=g.slice(s+1+m,g.length-m),a=0;a!=h.length&&h.charCodeAt(a)!==58;++a);if(a===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=u,n[h.toLowerCase()]=u;else{var v=(a===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(a+1);if(n[v]&&h.slice(a-3,a)=="ext")continue;n[v]=u,n[v.toLowerCase()]=u}}return n}function lo(e){return e.replace(ese,"<$1")}var ZI={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Zx=sv(ZI),Bt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(a,u){return ZI[a]||String.fromCharCode(parseInt(u,a.indexOf("x")>-1?16:10))||a}).replace(t,function(a,u){return String.fromCharCode(parseInt(u,16))});var o=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,o)+r(i.slice(o+3))}})(),Jx=/[&<>'"]/g,tse=/[\u0000-\u0008\u000b-\u001f]/g;function Jt(e){var t=e+"";return t.replace(Jx,function(r){return Zx[r]}).replace(tse,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function TA(e){return Jt(e).replace(/ /g,"_x0020_")}var JI=/[\u0000-\u001f]/g;function e1(e){var t=e+"";return t.replace(Jx,function(r){return Zx[r]}).replace(/\n/g,"<br/>").replace(JI,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function rse(e){var t=e+"";return t.replace(Jx,function(r){return Zx[r]}).replace(JI,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var FA=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function nse(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function pr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ny(e){for(var t="",r=0,n=0,i=0,s=0,o=0,a=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}o=e.charCodeAt(r++),a=((n&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(a>>>10&1023)),t+=String.fromCharCode(56320+(a&1023))}return t}function DA(e){var t=qa(2*e.length),r,n,i=1,s=0,o=0,a;for(n=0;n<e.length;n+=i)i=1,(a=e.charCodeAt(n))<128?r=a:a<224?(r=(a&31)*64+(e.charCodeAt(n+1)&63),i=2):a<240?(r=(a&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(a&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function AA(e){return ta(e,"binary").toString("utf8")}var Np="foo bar baz",sr=Rt&&(AA(Np)==Ny(Np)&&AA||DA(Np)==Ny(Np)&&DA)||Ny,Xs=Rt?function(e){return ta(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},bf=(function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),eO=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}})(),ise=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),sse=/<\/?(?:vt:)?variant>/g,ose=/<(?:vt:)([^>]*)>([\s\S]*)</;function kA(e,t){var r=mt(e),n=e.match(ise(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var o=s.replace(sse,"").match(ose);o&&i.push({v:sr(o[2]),t:o[1]})}),i}var tO=/(^\s|\s$|\n)/;function Cn(e,t){return"<"+e+(t.match(tO)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Sf(e){return Ir(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ze(e,t,r){return"<"+e+(r!=null?Sf(r):"")+(t!=null?(t.match(tO)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Zb(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function ase(e,t){switch(typeof e){case"string":var r=ze("vt:lpwstr",Jt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ze((e|0)==e?"vt:i4":"vt:r8",Jt(String(e)));case"boolean":return ze("vt:bool",e?"true":"false")}if(e instanceof Date)return ze("vt:filetime",Zb(e));throw new Error("Unable to serialize "+e)}function t1(e){if(Rt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return sr(sl(Yx(e)));throw new Error("Bad input format: expected Buffer or string")}var xf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,tn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Cc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],yi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function lse(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function cse(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=n?-t:t;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var a=0;a<=5;++a,s/=256)e[r+a]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var PA=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},MA=Rt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ta(t)})):PA(e)}:PA,_A=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(No(e,i)));return n.join("").replace(Un,"")},r1=Rt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Un,""):_A(e,t,r)}:_A,LA=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},rO=Rt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):LA(e,t,r)}:LA,IA=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(bu(e,i)));return n.join("")},Kf=Rt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):IA(t,r,n)}:IA,nO=function(e,t){var r=bi(e,t);return r>0?Kf(e,t+4,t+4+r-1):""},iO=nO,sO=function(e,t){var r=bi(e,t);return r>0?Kf(e,t+4,t+4+r-1):""},oO=sO,aO=function(e,t){var r=2*bi(e,t);return r>0?Kf(e,t+4,t+4+r-1):""},lO=aO,cO=function(t,r){var n=bi(t,r);return n>0?r1(t,r+4,r+4+n):""},uO=cO,dO=function(e,t){var r=bi(e,t);return r>0?Kf(e,t+4,t+4+r):""},hO=dO,fO=function(e,t){return lse(e,t)},J0=fO,n1=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Rt&&(iO=function(t,r){if(!Buffer.isBuffer(t))return nO(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},oO=function(t,r){if(!Buffer.isBuffer(t))return sO(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},lO=function(t,r){if(!Buffer.isBuffer(t))return aO(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},uO=function(t,r){if(!Buffer.isBuffer(t))return cO(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},hO=function(t,r){if(!Buffer.isBuffer(t))return dO(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},J0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):fO(t,r)},n1=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var bu=function(e,t){return e[t]},No=function(e,t){return e[t+1]*256+e[t]},use=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},bi=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ll=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},dse=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Uh(e,t){var r="",n,i,s=[],o,a,u,d;switch(t){case"dbcs":if(d=this.l,Rt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(No(this,d)),d+=2;e*=2;break;case"utf8":r=Kf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=r1(this,this.l,this.l+e);break;case"wstr":return Uh.call(this,e,"dbcs");case"lpstr-ansi":r=iO(this,this.l),e=4+bi(this,this.l);break;case"lpstr-cp":r=oO(this,this.l),e=4+bi(this,this.l);break;case"lpwstr":r=lO(this,this.l),e=4+2*bi(this,this.l);break;case"lpp4":e=4+bi(this,this.l),r=uO(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+bi(this,this.l),r=hO(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=bu(this,this.l+e++))!==0;)s.push(Op(o));r=s.join("");break;case"_wstr":for(e=0,r="";(o=No(this,this.l+e))!==0;)s.push(Op(o)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",d=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(d)!==-1)return o=bu(this,d),this.l=d+1,a=Uh.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(Op(No(this,d))),d+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(d)!==-1)return o=bu(this,d),this.l=d+1,a=Uh.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(Op(bu(this,d))),d+=1}r=s.join("");break;default:switch(e){case 1:return n=bu(this,this.l),this.l++,n;case 2:return n=(t==="i"?use:No)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Ll:dse)(this,this.l),this.l+=4,n):(i=bi(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=J0(this,this.l):i=J0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=rO(this,this.l,e);break}}return this.l+=e,r}var hse=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},fse=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},gse=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function pse(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)gse(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,hse(this,t,this.l);break;case 8:if(n=8,r==="f"){cse(this,t,this.l);break}case 16:break;case-4:n=4,fse(this,t,this.l);break}return this.l+=n,this}function gO(e,t){var r=rO(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function wn(e,t){e.l=t,e.read_shift=Uh,e.chk=gO,e.write_shift=pse}function Ln(e,t){e.l+=t}function Re(e){var t=qa(e);return wn(t,0),t}function ra(e,t,r){if(e){var n,i,s;wn(e,e.l||0);for(var o=e.length,a=0,u=0;e.l<o;){a=e.read_shift(1),a&128&&(a=(a&127)+((e.read_shift(1)&127)<<7));var d=Af[a]||Af[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;u=e.l+s;var h=d.f&&d.f(e,s,r);if(e.l=u,t(h,d,a))return}}}function oi(){var e=[],t=Rt?256:2048,r=function(d){var h=Re(d);return wn(h,0),h},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(d){return n&&d<n.length-n.l?n:(i(),n=r(Math.max(d+1,t)))},o=function(){return i(),ln(e)},a=function(d){i(),n=d,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:a,end:o,_bufs:e}}function _e(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=Af[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=e.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var a=0;a!=4;++a)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&n1(r)&&e.push(r)}}function $h(e,t,r){var n=vr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function OA(e,t,r){var n=vr(e);return n.s=$h(n.s,t.s,r),n.e=$h(n.e,t.s,r),n}function jh(e,t){if(e.cRel&&e.c<0)for(e=vr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=vr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=pt(e);return!e.cRel&&e.cRel!=null&&(r=wse(r)),!e.rRel&&e.rRel!=null&&(r=mse(r)),r}function By(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Rr(e.s.c)+":"+(e.e.cRel?"":"$")+Rr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+zr(e.s.r)+":"+(e.e.rRel?"":"$")+zr(e.e.r):jh(e.s,t.biff)+":"+jh(e.e,t.biff)}function i1(e){return parseInt(vse(e),10)-1}function zr(e){return""+(e+1)}function mse(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function vse(e){return e.replace(/\$(\d+)$/,"$1")}function s1(e){for(var t=Cse(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Rr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function wse(e){return e.replace(/^([A-Z])/,"$$$1")}function Cse(e){return e.replace(/^\$([A-Z])/,"$1")}function yse(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Tr(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function pt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function di(e){var t=e.indexOf(":");return t==-1?{s:Tr(e),e:Tr(e)}:{s:Tr(e.slice(0,t)),e:Tr(e.slice(t+1))}}function bt(e,t){return typeof t>"u"||typeof t=="number"?bt(e.s,e.e):(typeof e!="string"&&(e=pt(e)),typeof t!="string"&&(t=pt(t)),e==t?e:e+":"+t)}function Ht(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function NA(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ss(e.z,r?rn(t):t)}catch{}try{return e.w=ss((e.XF||{}).numFmtId||(r?14:0),r?rn(t):t)}catch{return""+t}}function Ko(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?na[e.v]||e.v:t==null?NA(e,e.v):NA(e,t))}function ol(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function pO(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),o=0,a=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Tr(n.origin):n.origin;o=u.r,a=u.c}s["!ref"]||(s["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=Ht(s["!ref"]);d.s.c=h.s.c,d.s.r=h.s.r,d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),o==-1&&(d.e.r=o=h.e.r+1)}for(var g=0;g!=t.length;++g)if(t[g]){if(!Array.isArray(t[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[g].length;++m)if(!(typeof t[g][m]>"u")){var v={v:t[g][m]},w=o+g,C=a+m;if(d.s.r>w&&(d.s.r=w),d.s.c>C&&(d.s.c=C),d.e.r<w&&(d.e.r=w),d.e.c<C&&(d.e.c=C),t[g][m]&&typeof t[g][m]=="object"&&!Array.isArray(t[g][m])&&!(t[g][m]instanceof Date))v=t[g][m];else if(Array.isArray(v.v)&&(v.f=t[g][m][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(n.nullError)v.t="e",v.v=0;else if(n.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=n.dateNF||gt[14],n.cellDates?(v.t="d",v.w=ss(v.z,rn(v.v))):(v.t="n",v.v=rn(v.v),v.w=ss(v.z,v.v))):v.t="s";if(i)s[w]||(s[w]=[]),s[w][C]&&s[w][C].z&&(v.z=s[w][C].z),s[w][C]=v;else{var b=pt({c:C,r:w});s[b]&&s[b].z&&(v.z=s[b].z),s[b]=v}}}return d.s.c<1e7&&(s["!ref"]=bt(d)),s}function Sd(e,t){return pO(null,e,t)}function bse(e){return e.read_shift(4,"i")}function Es(e,t){return t||(t=Re(4)),t.write_shift(4,e),t}function _n(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function dn(e,t){var r=!1;return t==null&&(r=!0,t=Re(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Sse(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function xse(e,t){return t||(t=Re(4)),t.write_shift(2,0),t.write_shift(2,0),t}function o1(e,t){var r=e.l,n=e.read_shift(1),i=_n(e),s=[],o={t:i,h:i};if((n&1)!==0){for(var a=e.read_shift(4),u=0;u!=a;++u)s.push(Sse(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function Ese(e,t){var r=!1;return t==null&&(r=!0,t=Re(15+4*e.t.length)),t.write_shift(1,0),dn(e.t,t),r?t.slice(0,t.l):t}var Rse=o1;function Tse(e,t){var r=!1;return t==null&&(r=!0,t=Re(23+4*e.t.length)),t.write_shift(1,1),dn(e.t,t),t.write_shift(4,1),xse({},t),r?t.slice(0,t.l):t}function ds(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function yc(e,t){return t==null&&(t=Re(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function bc(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Sc(e,t){return t==null&&(t=Re(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Fse=_n,mO=dn;function a1(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function em(e,t){var r=!1;return t==null&&(r=!0,t=Re(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Dse=_n,Jb=a1,l1=em;function c1(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?J0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ll(t,0)>>2;return r?i/100:i}function vO(e,t){t==null&&(t=Re(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function wO(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Ase(e,t){return t||(t=Re(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var xc=wO,xd=Ase;function Pn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ac(e,t){return(t||Re(8)).write_shift(8,e,"f")}function kse(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),a=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var d=jl[i];d&&(t.rgb=Rf(d));break;case 2:t.rgb=Rf([o,a,u]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function tm(e,t){if(t||(t=Re(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function Pse(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Mse(e,t){t||(t=Re(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function CO(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function _se(e){return CO(e,1)}function Lse(e){return CO(e,2)}var u1=2,ni=3,Bp=11,BA=12,rm=19,Hp=64,Ise=65,Ose=71,Nse=4108,Bse=4126,an=80,yO=81,Hse=[an,yO],eS={1:{n:"CodePage",t:u1},2:{n:"Category",t:an},3:{n:"PresentationFormat",t:an},4:{n:"ByteCount",t:ni},5:{n:"LineCount",t:ni},6:{n:"ParagraphCount",t:ni},7:{n:"SlideCount",t:ni},8:{n:"NoteCount",t:ni},9:{n:"HiddenCount",t:ni},10:{n:"MultimediaClipCount",t:ni},11:{n:"ScaleCrop",t:Bp},12:{n:"HeadingPairs",t:Nse},13:{n:"TitlesOfParts",t:Bse},14:{n:"Manager",t:an},15:{n:"Company",t:an},16:{n:"LinksUpToDate",t:Bp},17:{n:"CharacterCount",t:ni},19:{n:"SharedDoc",t:Bp},22:{n:"HyperlinksChanged",t:Bp},23:{n:"AppVersion",t:ni,p:"version"},24:{n:"DigSig",t:Ise},26:{n:"ContentType",t:an},27:{n:"ContentStatus",t:an},28:{n:"Language",t:an},29:{n:"Version",t:an},255:{},2147483648:{n:"Locale",t:rm},2147483651:{n:"Behavior",t:rm},1919054434:{}},tS={1:{n:"CodePage",t:u1},2:{n:"Title",t:an},3:{n:"Subject",t:an},4:{n:"Author",t:an},5:{n:"Keywords",t:an},6:{n:"Comments",t:an},7:{n:"Template",t:an},8:{n:"LastAuthor",t:an},9:{n:"RevNumber",t:an},10:{n:"EditTime",t:Hp},11:{n:"LastPrinted",t:Hp},12:{n:"CreatedDate",t:Hp},13:{n:"ModifiedDate",t:Hp},14:{n:"PageCount",t:ni},15:{n:"WordCount",t:ni},16:{n:"CharCount",t:ni},17:{n:"Thumbnail",t:Ose},18:{n:"Application",t:an},19:{n:"DocSecurity",t:ni},255:{},2147483648:{n:"Locale",t:rm},2147483651:{n:"Behavior",t:rm},1919054434:{}},HA={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Gse=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Vse(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var zse=Vse([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),jl=vr(zse),na={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},bO={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},rS={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Gp={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function d1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Wse(e){var t=d1();if(!e||!e.match)return t;var r={};if((e.match(Nn)||[]).forEach(function(n){var i=mt(n);switch(i[0].replace(Jie,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[rS[i.ContentType]]!==void 0&&t[rS[i.ContentType]].push(i.PartName);break}}),t.xmlns!==tn.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function SO(e,t){var r=Wie(rS),n=[],i;n[n.length]=Wr,n[n.length]=ze("Types",null,{xmlns:tn.CT,"xmlns:xsd":tn.xsd,"xmlns:xsi":tn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return ze("Default",null,{Extension:u[0],ContentType:u[1]})}));var s=function(u){e[u]&&e[u].length>0&&(i=e[u][0],n[n.length]=ze("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Gp[u][t.bookType]||Gp[u].xlsx}))},o=function(u){(e[u]||[]).forEach(function(d){n[n.length]=ze("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Gp[u][t.bookType]||Gp[u].xlsx})})},a=function(u){(e[u]||[]).forEach(function(d){n[n.length]=ze("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[u][0]})})};return s("workbooks"),o("sheets"),o("charts"),a("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),o("metadata"),a("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ft={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ef(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Yh(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Nn)||[]).forEach(function(i){var s=mt(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var a=s.TargetMode==="External"?s.Target:Mh(s.Target,t);r[a]=o,n[s.Id]=o}}),r["!id"]=n,r}function Vu(e){var t=[Wr,ze("Relationships",null,{xmlns:tn.RELS})];return Ir(e["!id"]).forEach(function(r){t[t.length]=ze("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Qt(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[Ft.HLINK,Ft.XPATH,Ft.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var Use="application/vnd.oasis.opendocument.spreadsheet";function $se(e,t){for(var r=t1(e),n,i;n=xf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=mt(n[0],!1),i.path=="/"&&i.type!==Use)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function jse(e){var t=[Wr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function GA(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Yse(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Kse(e){var t=[Wr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(GA(e[r][0],e[r][1])),t.push(Yse("",e[r][0]));return t.push(GA("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function xO(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+K0.version+"</meta:generator></office:meta></office:document-meta>"}var ns=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],qse=(function(){for(var e=new Array(ns.length),t=0;t<ns.length;++t){var r=ns[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function EO(e){var t={};e=sr(e);for(var r=0;r<ns.length;++r){var n=ns[r],i=e.match(qse[r]);i!=null&&i.length>0&&(t[n[1]]=Bt(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=mr(t[n[1]]))}return t}function Hy(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Jt(t),n[n.length]=r?ze(e,t,r):Cn(e,t))}function RO(e,t){var r=t||{},n=[Wr,ze("cp:coreProperties",null,{"xmlns:cp":tn.CORE_PROPS,"xmlns:dc":tn.dc,"xmlns:dcterms":tn.dcterms,"xmlns:dcmitype":tn.dcmitype,"xmlns:xsi":tn.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Hy("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Zb(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&Hy("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Zb(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=ns.length;++s){var o=ns[s],a=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&Hy(o[0],a,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Yl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],TO=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function FO(e,t,r,n){var i=[];if(typeof e=="string")i=kA(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(h){return{v:h}}));var o=typeof t=="string"?kA(t,n).map(function(h){return h.v}):t,a=0,u=0;if(o.length>0)for(var d=0;d!==i.length;d+=2){switch(u=+i[d+1].v,i[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=o.slice(a,a+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=o.slice(a,a+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=o.slice(a,a+u);break}a+=u}}function Xse(e,t,r){var n={};return t||(t={}),e=sr(e),Yl.forEach(function(i){var s=(e.match(bf(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=Bt(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&FO(n.HeadingPairs,n.TitlesOfParts,t,r),t}function DO(e){var t=[],r=ze;return e||(e={}),e.Application="SheetJS",t[t.length]=Wr,t[t.length]=ze("Properties",null,{xmlns:tn.EXT_PROPS,"xmlns:vt":tn.vt}),Yl.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Jt(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Jt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Qse=/<[^>]+>[^<]*/g;function Zse(e,t){var r={},n="",i=e.match(Qse);if(i)for(var s=0;s!=i.length;++s){var o=i[s],a=mt(o);switch(a[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Bt(a.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),d=u[0].slice(4),h=u[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=Bt(h);break;case"bool":r[n]=pr(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=mr(h);break;case"cy":case"error":r[n]=Bt(h);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,u)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function AO(e){var t=[Wr,ze("Properties",null,{xmlns:tn.CUST_PROPS,"xmlns:vt":tn.vt})];if(!e)return t.join("");var r=1;return Ir(e).forEach(function(i){++r,t[t.length]=ze("property",ase(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Jt(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var nS={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Gy;function Jse(e,t,r){Gy||(Gy=sv(nS)),t=Gy[t]||t,e[t]=r}function eoe(e,t){var r=[];return Ir(nS).map(function(n){for(var i=0;i<ns.length;++i)if(ns[i][1]==n)return ns[i];for(i=0;i<Yl.length;++i)if(Yl[i][1]==n)return Yl[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Cn(nS[n[1]]||n[1],i))}}),ze("DocumentProperties",r.join(""),{xmlns:yi.o})}function toe(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&Ir(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<ns.length;++o)if(s==ns[o][1])return;for(o=0;o<Yl.length;++o)if(s==Yl[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var a=e[s],u="string";typeof a=="number"?(u="float",a=String(a)):a===!0||a===!1?(u="boolean",a=a?"1":"0"):a=String(a),i.push(ze(TA(s),a,{"dt:dt":u}))}}),t&&Ir(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o instanceof Date?(a="dateTime.tz",o=o.toISOString()):o=String(o),i.push(ze(TA(s),o,{"dt:dt":a}))}}),"<"+n+' xmlns="'+yi.o+'">'+i.join("")+"</"+n+">"}function h1(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function roe(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var o=Re(8);return o.write_shift(4,n),o.write_shift(4,i),o}function kO(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function PO(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function MO(e,t,r){return t===31?PO(e):kO(e,t,r)}function iS(e,t,r){return MO(e,t,r===!1?0:4)}function noe(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return MO(e,t,0)}function ioe(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Un,""),e.l-i&2&&(e.l+=2)}return r}function soe(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Un,"");return r}function ooe(e){var t=e.l,r=nm(e,yO);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=nm(e,ni);return[r,n]}function aoe(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(ooe(e));return r}function VA(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),o=e.read_shift(4);n[s]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Un,"").replace(Ph,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function _O(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function loe(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function nm(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==BA&&n!==t&&Hse.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===BA?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return kO(e,n,4).replace(Un,"");case 31:return PO(e);case 64:return h1(e);case 65:return _O(e);case 71:return loe(e);case 80:return iS(e,n,!s.raw).replace(Un,"");case 81:return noe(e,n).replace(Un,"");case 4108:return aoe(e);case 4126:case 4127:return n==4127?ioe(e):soe(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function zA(e,t){var r=Re(4),n=Re(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Re(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=roe(t);break;case 31:case 80:for(n=Re(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return ln([r,n])}function WA(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0,a=0,u=-1,d={};for(o=0;o!=i;++o){var h=e.read_shift(4),g=e.read_shift(4);s[o]=[h,g+r]}s.sort(function(R,E){return R[1]-E[1]});var m={};for(o=0;o!=i;++o){if(e.l!==s[o][1]){var v=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,v=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],v=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],v=!1);break}if((!t||o==0)&&e.l<=s[o][1]&&(v=!1,e.l=s[o][1]),v)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var w=t[s[o][0]];if(m[w.n]=nm(e,w.t,{raw:!0}),w.p==="version"&&(m[w.n]=String(m[w.n]>>16)+"."+("0000"+String(m[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(m[w.n]){case 0:m[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Cs(a=m[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[w.n])}}else if(s[o][0]===1){if(a=m.CodePage=nm(e,u1),Cs(a),u!==-1){var C=e.l;e.l=s[u][1],d=VA(e,a),e.l=C}}else if(s[o][0]===0){if(a===0){u=o,e.l=s[o+1][1];continue}d=VA(e,a)}else{var b=d[s[o][0]],x;switch(e[e.l]){case 65:e.l+=4,x=_O(e);break;case 30:e.l+=4,x=iS(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,x=iS(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,x=e.read_shift(4,"i");break;case 19:e.l+=4,x=e.read_shift(4);break;case 5:e.l+=4,x=e.read_shift(8,"f");break;case 11:e.l+=4,x=Hr(e,4);break;case 64:e.l+=4,x=mr(h1(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[b]=x}}return e.l=r+n,m}var LO=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function coe(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function UA(e,t,r){var n=Re(8),i=[],s=[],o=8,a=0,u=Re(8),d=Re(8);if(u.write_shift(4,2),u.write_shift(4,1200),d.write_shift(4,1),s.push(u),i.push(d),o+=8+u.length,!t){d=Re(8),d.write_shift(4,0),i.unshift(d);var h=[Re(4)];for(h[0].write_shift(4,e.length),a=0;a<e.length;++a){var g=e[a][0];for(u=Re(8+2*(g.length+1)+(g.length%2?0:2)),u.write_shift(4,a+2),u.write_shift(4,g.length+1),u.write_shift(0,g,"dbcs");u.l!=u.length;)u.write_shift(1,0);h.push(u)}u=ln(h),s.unshift(u),o+=8+u.length}for(a=0;a<e.length;++a)if(!(t&&!t[e[a][0]])&&!(LO.indexOf(e[a][0])>-1||TO.indexOf(e[a][0])>-1)&&e[a][1]!=null){var m=e[a][1],v=0;if(t){v=+t[e[a][0]];var w=r[v];if(w.p=="version"&&typeof m=="string"){var C=m.split(".");m=(+C[0]<<16)+(+C[1]||0)}u=zA(w.t,m)}else{var b=coe(m);b==-1&&(b=31,m=String(m)),u=zA(b,m)}s.push(u),d=Re(8),d.write_shift(4,t?v:2+a),i.push(d),o+=8+u.length}var x=8*(s.length+1);for(a=0;a<s.length;++a)i[a].write_shift(4,x),x+=s[a].length;return n.write_shift(4,o),n.write_shift(4,s.length),ln([n].concat(i).concat(s))}function $A(e,t,r){var n=e.content;if(!n)return{};wn(n,0);var i,s,o,a,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),h=n.read_shift(16);if(h!==at.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),a=n.read_shift(4),i===1&&a!==n.l)throw new Error("Length mismatch: "+a+" !== "+n.l);i===2&&(o=n.read_shift(16),u=n.read_shift(4));var g=WA(n,t),m={SystemIdentifier:d};for(var v in g)m[v]=g[v];if(m.FMTID=s,i===1)return m;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var w;try{w=WA(n,null)}catch{}for(v in w)m[v]=w[v];return m.FMTID=[s,o],m}function jA(e,t,r,n,i,s){var o=Re(i?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,at.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var u=UA(e,r,n);if(a.push(u),i){var d=UA(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+u.length),a.push(d)}return ln(a)}function Ia(e,t){return e.read_shift(t),null}function uoe(e,t){t||(t=Re(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function doe(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Hr(e,t){return e.read_shift(t)===1}function Gn(e,t){return t||(t=Re(2)),t.write_shift(2,+!!e),t}function Jr(e){return e.read_shift(2,"u")}function Zi(e,t){return t||(t=Re(2)),t.write_shift(2,e),t}function IO(e,t){return doe(e,t,Jr)}function hoe(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function OO(e,t,r){return r||(r=Re(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function qf(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return o}function foe(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),o=0,a,u={};i&&(o=e.read_shift(2)),n&&(a=e.read_shift(4));var d=s==2?"dbcs-cont":"sbcs-cont",h=t===0?"":e.read_shift(t,d);return i&&(e.l+=4*o),n&&(e.l+=a),u.t=h,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function goe(e){var t=e.t||"",r=Re(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Re(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return ln(i)}function lc(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Xf(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):lc(e,n,r)}function Ec(e,t,r){if(r.biff>5)return Xf(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function NO(e,t,r){return r||(r=Re(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function poe(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function moe(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Un,"");return n&&(e.l+=24),i}function voe(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(Un,"");return r+o}function woe(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return moe(e);case"0303000000000000c000000000000046":return voe(e);default:throw new Error("Unsupported Moniker "+r)}}function Vp(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Un,""):"";return r}function YA(e,t){t||(t=Re(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Coe(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,o,a,u,d="",h,g;i&16&&(s=Vp(e,r-e.l)),i&128&&(o=Vp(e,r-e.l)),(i&257)===257&&(a=Vp(e,r-e.l)),(i&257)===1&&(u=woe(e,r-e.l)),i&8&&(d=Vp(e,r-e.l)),i&32&&(h=e.read_shift(16)),i&64&&(g=h1(e)),e.l=r;var m=o||a||u||"";m&&d&&(m+="#"+d),m||(m="#"+d),i&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var v={Target:m};return h&&(v.guid=h),g&&(v.time=g),s&&(v.Tooltip=s),v}function yoe(e){var t=Re(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(s==28)n=n.slice(1),YA(n,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var a=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(a.length+1)),r=0;r<a.length;++r)t.write_shift(2,a.charCodeAt(r));t.write_shift(2,0),s&8&&YA(i>-1?n.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var u=0;n.slice(u*3,u*3+3)=="../"||n.slice(u*3,u*3+3)=="..\\";)++u;for(t.write_shift(2,u),t.write_shift(4,n.length-3*u+1),r=0;r<n.length-3*u;++r)t.write_shift(1,n.charCodeAt(r+3*u)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function BO(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function HO(e,t){var r=BO(e);return r[3]=0,r}function co(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function cc(e,t,r,n){return n||(n=Re(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function boe(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Soe(e,t,r){return t===0?"":Ec(e,t,r)}function xoe(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,s,o]}function GO(e){var t=e.read_shift(2),r=c1(e);return[t,r]}function Eoe(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=qf(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function lv(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function VO(e,t){return t||(t=Re(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function zO(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var Roe=zO;function WO(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function Toe(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Foe(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Rn(e){e.l+=2,e.l+=e.read_shift(2)}var Doe={0:Rn,4:Rn,5:Rn,6:Rn,7:Foe,8:Rn,9:Rn,10:Rn,11:Rn,12:Rn,13:Toe,14:Rn,15:Rn,16:Rn,17:Rn,18:Rn,19:Rn,20:Rn,21:WO};function Aoe(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(Doe[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function zp(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function f1(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Re(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function koe(e,t){return t===0||e.read_shift(2),1200}function Poe(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=Ec(e,0,r);return e.read_shift(t+n-e.l),i}function Moe(e,t){var r=!t||t.biff==8,n=Re(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function _oe(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Loe(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=qf(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:s,name:o}}function Ioe(e,t){var r=!t||t.biff>=8?2:1,n=Re(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function Ooe(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0;o!=i&&e.l<r;++o)s.push(foe(e));return s.Count=n,s.Unique=i,s}function Noe(e,t){var r=Re(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=goe(e[i]);var s=ln([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function Boe(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Hoe(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function Goe(e){var t=boe(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Voe(e){return e.read_shift(2),e.read_shift(4)}function KA(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function zoe(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),a=e.read_shift(2),u=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:o,FirstTab:a,Selected:u,TabRatio:d}}function Woe(){var e=Re(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Uoe(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function $oe(e){var t=Re(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function joe(){}function Yoe(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=qf(e,0,r),n}function Koe(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=Re(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function qoe(e){var t=co(e);return t.isst=e.read_shift(4),t}function Xoe(e,t,r,n){var i=Re(10);return cc(e,t,n,i),i.write_shift(4,r),i}function Qoe(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=co(e);r.biff==2&&e.l++;var s=Xf(e,n-e.l,r);return i.val=s,i}function Zoe(e,t,r,n,i){var s=!i||i.biff==8,o=Re(8+ +s+(1+s)*r.length);return cc(e,t,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function Joe(e,t,r){var n=e.read_shift(2),i=Ec(e,0,r);return[n,i]}function eae(e,t,r,n){var i=r&&r.biff==5;n||(n=Re(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var tae=Ec;function qA(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),o=e.read_shift(i),a=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:s,c:a},e:{r:o,c:u}}}function rae(e,t){var r=t.biff==8||!t.biff?4:2,n=Re(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function nae(e){var t=e.read_shift(2),r=e.read_shift(2),n=GO(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function iae(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(GO(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:s}}function sae(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:s}}function oae(e,t,r,n){var i={},s=e.read_shift(4),o=e.read_shift(4),a=e.read_shift(4),u=e.read_shift(2);return i.patternType=Gse[a>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=a&127,i.icvBottom=a>>7&127,i.icvDiag=a>>14&127,i.dgDiag=a>>21&15,i.icvFore=u&127,i.icvBack=u>>7&127,i.fsxButton=u>>14&1),i}function aae(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=oae(e,t,n.fStyle,r),n}function XA(e,t,r,n){var i=r&&r.biff==5;n||(n=Re(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function lae(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function cae(e){var t=Re(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function QA(e,t,r){var n=co(e);(r.biff==2||t==9)&&++e.l;var i=hoe(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function uae(e,t,r,n,i,s){var o=Re(8);return cc(e,t,n,o),OO(r,s,o),o}function dae(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=co(e),i=Pn(e);return n.val=i,n}function hae(e,t,r,n){var i=Re(14);return cc(e,t,n,i),ac(r,i),i}var ZA=Soe;function fae(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=lc(e,s),a=[];n>e.l;)a.push(Xf(e));return[s,i,o,a]}function JA(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=Eoe(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var gae=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ek(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),a=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=lc(e,o,r);i&32&&(d=gae[d.charCodeAt(0)]);var h=n-e.l;r&&r.biff==2&&--h;var g=n==e.l||a===0||!(h>0)?[]:Ade(e,h,r,a);return{chKey:s,Name:d,itab:u,rgce:g}}function UO(e,t,r){if(r.biff<8)return pae(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(xoe(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function pae(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=qf(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function mae(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=lc(e,n,r),o=lc(e,i,r);return[s,o]}function vae(e,t,r){var n=zO(e);e.l++;var i=e.read_shift(1);return t-=8,[kde(e,t,r),i,n]}function tk(e,t,r){var n=Roe(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Fde(e,t,r)]}function wae(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Cae(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),a=Ec(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},a,o,s]}}function yae(e,t,r){return Cae(e,t,r)}function bae(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(lv(e));return r}function Sae(e){var t=Re(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)VO(e[r],t);return t}function xae(e,t,r){if(r&&r.biff<8)return Rae(e,t,r);var n=WO(e),i=Aoe(e,t-22,n[1]);return{cmo:n,ft:i}}var Eae={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function Rae(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((Eae[n]||Ln)(e,t,r)),{cmo:[i,n,s],ft:o}}function Tae(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=poe(e,6,r);var a=e.read_shift(2);e.read_shift(2),Jr(e,2);var u=e.read_shift(2);e.l+=u;for(var d=1;d<e.lens.length-1;++d){if(e.l-n!=e.lens[d])throw new Error("TxO: bad continue record");var h=e[e.l],g=lc(e,e.lens[d+1]-e.lens[d]-1);if(i+=g,i.length>=(h?a:2*a))break}if(i.length!==a&&i.length!==a*2)throw new Error("cchText: "+a+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function Fae(e,t){var r=lv(e);e.l+=16;var n=Coe(e,t-24);return[r,n]}function Dae(e){var t=Re(24),r=Tr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return ln([t,yoe(e[1])])}function Aae(e,t){e.read_shift(2);var r=lv(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Un,""),[r,n]}function kae(e){var t=e[1].Tooltip,r=Re(10+2*(t.length+1));r.write_shift(2,2048);var n=Tr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function Pae(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=HA[r]||r,r=e.read_shift(2),t[1]=HA[r]||r,t}function Mae(e){return e||(e=Re(4)),e.write_shift(2,1),e.write_shift(2,1),e}function _ae(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(HO(e));return r}function Lae(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(HO(e));return r}function Iae(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function $O(e,t,r){if(!r.cellStyles)return Ln(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),a=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var d={s:i,e:s,w:o,ixfe:a,flags:u};return(r.biff>=5||!r.biff)&&(d.level=u>>8&7),d}function Oae(e,t){var r=Re(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Nae(e,t){var r={};return t<32||(e.l+=16,r.header=Pn(e),r.footer=Pn(e),e.l+=2),r}function Bae(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}function Hae(e){for(var t=Re(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Gae=co,Vae=IO,zae=Xf;function Wae(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function Uae(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=co(e);++e.l;var i=Ec(e,t-7,r);return n.t="str",n.val=i,n}function $ae(e){var t=co(e);++e.l;var r=Pn(e);return t.t="n",t.val=r,t}function jae(e,t,r){var n=Re(15);return eg(n,e,t),n.write_shift(8,r,"f"),n}function Yae(e){var t=co(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Kae(e,t,r){var n=Re(9);return eg(n,e,t),n.write_shift(2,r),n}function qae(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Xae(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function Qae(e,t,r){var n=e.l+t,i=co(e),s=e.read_shift(2),o=lc(e,s,r);return e.l=n,i.t="str",i.val=o,i}var Zae=[2,3,48,49,131,139,140,245],sS=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=sv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(a,u){var d=[],h=qa(1);switch(u.type){case"base64":h=Si(Ai(a));break;case"binary":h=Si(a);break;case"buffer":case"array":h=a;break}wn(h,0);var g=h.read_shift(1),m=!!(g&136),v=!1,w=!1;switch(g){case 2:break;case 3:break;case 48:v=!0,m=!0;break;case 49:v=!0,m=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var C=0,b=521;g==2&&(C=h.read_shift(2)),h.l+=3,g!=2&&(C=h.read_shift(4)),C>1048576&&(C=1e6),g!=2&&(b=h.read_shift(2));var x=h.read_shift(2),R=u.codepage||1252;g!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(R=e[h[h.l]]),h.l+=1,h.l+=2),w&&(h.l+=36);for(var E=[],A={},D=Math.min(h.length,g==2?521:b-10-(v?264:0)),M=w?32:11;h.l<D&&h[h.l]!=13;)switch(A={},A.name=wf.utils.decode(R,h.slice(h.l,h.l+M)).replace(/[\u0000\r\n].*$/g,""),h.l+=M,A.type=String.fromCharCode(h.read_shift(1)),g!=2&&!w&&(A.offset=h.read_shift(4)),A.len=h.read_shift(1),g==2&&(A.offset=h.read_shift(2)),A.dec=h.read_shift(1),A.name.length&&E.push(A),g!=2&&(h.l+=w?13:14),A.type){case"B":(!v||A.len!=8)&&u.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+A.type)}if(h[h.l]!==13&&(h.l=b-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=b;var F=0,O=0;for(d[0]=[],O=0;O!=E.length;++O)d[0][O]=E[O].name;for(;C-- >0;){if(h[h.l]===42){h.l+=x;continue}for(++h.l,d[++F]=[],O=0,O=0;O!=E.length;++O){var L=h.slice(h.l,h.l+E[O].len);h.l+=E[O].len,wn(L,0);var W=wf.utils.decode(R,L);switch(E[O].type){case"C":W.trim().length&&(d[F][O]=W.replace(/\s+$/,""));break;case"D":W.length===8?d[F][O]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):d[F][O]=W;break;case"F":d[F][O]=parseFloat(W.trim());break;case"+":case"I":d[F][O]=w?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":d[F][O]=!0;break;case"N":case"F":d[F][O]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));d[F][O]="##MEMO##"+(w?parseInt(W.trim(),10):L.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(d[F][O]=+W||0);break;case"@":d[F][O]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":d[F][O]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":d[F][O]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[F][O]=-L.read_shift(-8,"f");break;case"B":if(v&&E[O].len==8){d[F][O]=L.read_shift(8,"f");break}case"G":case"P":L.l+=E[O].len;break;case"0":if(E[O].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[O].type)}}}if(g!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return u&&u.sheetRows&&(d=d.slice(0,u.sheetRows)),u.DBF=E,d}function n(a,u){var d=u||{};d.dateNF||(d.dateNF="yyyymmdd");var h=Sd(r(a,d),d);return h["!cols"]=d.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete d.DBF,h}function i(a,u){try{return ol(n(a,u),u)}catch(d){if(u&&u.WTF)throw d}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,u){var d=u||{};if(+d.codepage>=0&&Cs(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var h=oi(),g=om(a,{header:1,raw:!0,cellDates:!0}),m=g[0],v=g.slice(1),w=a["!cols"]||[],C=0,b=0,x=0,R=1;for(C=0;C<m.length;++C){if(((w[C]||{}).DBF||{}).name){m[C]=w[C].DBF.name,++x;continue}if(m[C]!=null){if(++x,typeof m[C]=="number"&&(m[C]=m[C].toString(10)),typeof m[C]!="string")throw new Error("DBF Invalid column name "+m[C]+" |"+typeof m[C]+"|");if(m.indexOf(m[C])!==C){for(b=0;b<1024;++b)if(m.indexOf(m[C]+"_"+b)==-1){m[C]+="_"+b;break}}}}var E=Ht(a["!ref"]),A=[],D=[],M=[];for(C=0;C<=E.e.c-E.s.c;++C){var F="",O="",L=0,W=[];for(b=0;b<v.length;++b)v[b][C]!=null&&W.push(v[b][C]);if(W.length==0||m[C]==null){A[C]="?";continue}for(b=0;b<W.length;++b){switch(typeof W[b]){case"number":O="B";break;case"string":O="C";break;case"boolean":O="L";break;case"object":O=W[b]instanceof Date?"D":"C";break;default:O="C"}L=Math.max(L,String(W[b]).length),F=F&&F!=O?"C":O}L>250&&(L=250),O=((w[C]||{}).DBF||{}).type,O=="C"&&w[C].DBF.len>L&&(L=w[C].DBF.len),F=="B"&&O=="N"&&(F="N",M[C]=w[C].DBF.dec,L=w[C].DBF.len),D[C]=F=="C"||O=="N"?L:s[F]||0,R+=D[C],A[C]=F}var I=h.next(32);for(I.write_shift(4,318902576),I.write_shift(4,v.length),I.write_shift(2,296+32*x),I.write_shift(2,R),C=0;C<4;++C)I.write_shift(4,0);for(I.write_shift(4,0|(+t[LI]||3)<<8),C=0,b=0;C<m.length;++C)if(m[C]!=null){var G=h.next(32),ne=(m[C].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);G.write_shift(1,ne,"sbcs"),G.write_shift(1,A[C]=="?"?"C":A[C],"sbcs"),G.write_shift(4,b),G.write_shift(1,D[C]||s[A[C]]||0),G.write_shift(1,M[C]||0),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(1,0),G.write_shift(4,0),G.write_shift(4,0),b+=D[C]||s[A[C]]||0}var ie=h.next(264);for(ie.write_shift(4,13),C=0;C<65;++C)ie.write_shift(4,0);for(C=0;C<v.length;++C){var J=h.next(R);for(J.write_shift(1,0),b=0;b<m.length;++b)if(m[b]!=null)switch(A[b]){case"L":J.write_shift(1,v[C][b]==null?63:v[C][b]?84:70);break;case"B":J.write_shift(8,v[C][b]||0,"f");break;case"N":var _="0";for(typeof v[C][b]=="number"&&(_=v[C][b].toFixed(M[b]||0)),x=0;x<D[b]-_.length;++x)J.write_shift(1,32);J.write_shift(1,_,"sbcs");break;case"D":v[C][b]?(J.write_shift(4,("0000"+v[C][b].getFullYear()).slice(-4),"sbcs"),J.write_shift(2,("00"+(v[C][b].getMonth()+1)).slice(-2),"sbcs"),J.write_shift(2,("00"+v[C][b].getDate()).slice(-2),"sbcs")):J.write_shift(8,"00000000","sbcs");break;case"C":var Y=String(v[C][b]!=null?v[C][b]:"").slice(0,D[b]);for(J.write_shift(1,Y,"sbcs"),x=0;x<D[b]-Y.length;++x)J.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}})(),jO=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ir(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,v){var w=e[v];return typeof w=="number"?hA(w):w},n=function(m,v,w){var C=v.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return C==59?m:hA(C)};e["|"]=254;function i(m,v){switch(v.type){case"base64":return s(Ai(m),v);case"binary":return s(m,v);case"buffer":return s(Rt&&Buffer.isBuffer(m)?m.toString("binary"):sl(m),v);case"array":return s(oc(m),v)}throw new Error("Unrecognized type "+v.type)}function s(m,v){var w=m.split(/[\n\r]+/),C=-1,b=-1,x=0,R=0,E=[],A=[],D=null,M={},F=[],O=[],L=[],W=0,I;for(+v.codepage>=0&&Cs(+v.codepage);x!==w.length;++x){W=0;var G=w[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ne=G.replace(/;;/g,"\0").split(";").map(function(j){return j.replace(/\u0000/g,";")}),ie=ne[0],J;if(G.length>0)switch(ie){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ne[1].charAt(0)=="P"&&A.push(G.slice(3).replace(/;;/g,";"));break;case"C":var _=!1,Y=!1,Q=!1,U=!1,se=-1,N=-1;for(R=1;R<ne.length;++R)switch(ne[R].charAt(0)){case"A":break;case"X":b=parseInt(ne[R].slice(1))-1,Y=!0;break;case"Y":for(C=parseInt(ne[R].slice(1))-1,Y||(b=0),I=E.length;I<=C;++I)E[I]=[];break;case"K":J=ne[R].slice(1),J.charAt(0)==='"'?J=J.slice(1,J.length-1):J==="TRUE"?J=!0:J==="FALSE"?J=!1:isNaN(xs(J))?isNaN(nd(J).getDate())||(J=mr(J)):(J=xs(J),D!==null&&yd(D)&&(J=av(J))),_=!0;break;case"E":U=!0;var P=zu(ne[R].slice(1),{r:C,c:b});E[C][b]=[E[C][b],P];break;case"S":Q=!0,E[C][b]=[E[C][b],"S5S"];break;case"G":break;case"R":se=parseInt(ne[R].slice(1))-1;break;case"C":N=parseInt(ne[R].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+G)}if(_&&(E[C][b]&&E[C][b].length==2?E[C][b][0]=J:E[C][b]=J,D=null),Q){if(U)throw new Error("SYLK shared formula cannot have own formula");var V=se>-1&&E[se][N];if(!V||!V[1])throw new Error("SYLK shared formula cannot find base");E[C][b][1]=uN(V[1],{r:C-se,c:b-N})}break;case"F":var H=0;for(R=1;R<ne.length;++R)switch(ne[R].charAt(0)){case"X":b=parseInt(ne[R].slice(1))-1,++H;break;case"Y":for(C=parseInt(ne[R].slice(1))-1,I=E.length;I<=C;++I)E[I]=[];break;case"M":W=parseInt(ne[R].slice(1))/20;break;case"F":break;case"G":break;case"P":D=A[parseInt(ne[R].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=ne[R].slice(1).split(" "),I=parseInt(L[0],10);I<=parseInt(L[1],10);++I)W=parseInt(L[2],10),O[I-1]=W===0?{hidden:!0}:{wch:W},Xa(O[I-1]);break;case"C":b=parseInt(ne[R].slice(1))-1,O[b]||(O[b]={});break;case"R":C=parseInt(ne[R].slice(1))-1,F[C]||(F[C]={}),W>0?(F[C].hpt=W,F[C].hpx=sd(W)):W===0&&(F[C].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+G)}H<1&&(D=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+G)}}return F.length>0&&(M["!rows"]=F),O.length>0&&(M["!cols"]=O),v&&v.sheetRows&&(E=E.slice(0,v.sheetRows)),[E,M]}function o(m,v){var w=i(m,v),C=w[0],b=w[1],x=Sd(C,v);return Ir(b).forEach(function(R){x[R]=b[R]}),x}function a(m,v){return ol(o(m,v),v)}function u(m,v,w,C){var b="C;Y"+(w+1)+";X"+(C+1)+";K";switch(m.t){case"n":b+=m.v||0,m.f&&!m.F&&(b+=";E"+C1(m.f,{r:w,c:C}));break;case"b":b+=m.v?"TRUE":"FALSE";break;case"e":b+=m.w||m.v;break;case"d":b+='"'+(m.w||m.v)+'"';break;case"s":b+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function d(m,v){v.forEach(function(w,C){var b="F;W"+(C+1)+" "+(C+1)+" ";w.hidden?b+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=Tf(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=Ff(w.wpx)),typeof w.wch=="number"&&(b+=Math.round(w.wch))),b.charAt(b.length-1)!=" "&&m.push(b)})}function h(m,v){v.forEach(function(w,C){var b="F;";w.hidden?b+="M0;":w.hpt?b+="M"+20*w.hpt+";":w.hpx&&(b+="M"+20*Df(w.hpx)+";"),b.length>2&&m.push(b+"R"+(C+1))})}function g(m,v){var w=["ID;PWXL;N;E"],C=[],b=Ht(m["!ref"]),x,R=Array.isArray(m),E=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),m["!cols"]&&d(w,m["!cols"]),m["!rows"]&&h(w,m["!rows"]),w.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var A=b.s.r;A<=b.e.r;++A)for(var D=b.s.c;D<=b.e.c;++D){var M=pt({r:A,c:D});x=R?(m[A]||[])[D]:m[M],!(!x||x.v==null&&(!x.f||x.F))&&C.push(u(x,m,A,D))}return w.join(E)+E+C.join(E)+E+"E"+E}return{to_workbook:a,to_sheet:o,from_sheet:g}})(),YO=(function(){function e(s,o){switch(o.type){case"base64":return t(Ai(s),o);case"binary":return t(s,o);case"buffer":return t(Rt&&Buffer.isBuffer(s)?s.toString("binary"):sl(s),o);case"array":return t(oc(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var a=s.split(`
`),u=-1,d=-1,h=0,g=[];h!==a.length;++h){if(a[h].trim()==="BOT"){g[++u]=[],d=0;continue}if(!(u<0)){var m=a[h].trim().split(","),v=m[0],w=m[1];++h;for(var C=a[h]||"";(C.match(/["]/g)||[]).length&1&&h<a.length-1;)C+=`
`+a[++h];switch(C=C.trim(),+v){case-1:if(C==="BOT"){g[++u]=[],d=0;continue}else if(C!=="EOD")throw new Error("Unrecognized DIF special command "+C);break;case 0:C==="TRUE"?g[u][d]=!0:C==="FALSE"?g[u][d]=!1:isNaN(xs(w))?isNaN(nd(w).getDate())?g[u][d]=w:g[u][d]=mr(w):g[u][d]=xs(w),++d;break;case 1:C=C.slice(1,C.length-1),C=C.replace(/""/g,'"'),C&&C.match(/^=".*"$/)&&(C=C.slice(2,-1)),g[u][d++]=C!==""?C:null;break}if(C==="EOD")break}}return o&&o.sheetRows&&(g=g.slice(0,o.sheetRows)),g}function r(s,o){return Sd(e(s,o),o)}function n(s,o){return ol(r(s,o),o)}var i=(function(){var s=function(u,d,h,g,m){u.push(d),u.push(h+","+g),u.push('"'+m.replace(/"/g,'""')+'"')},o=function(u,d,h,g){u.push(d+","+h),u.push(d==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(u){var d=[],h=Ht(u["!ref"]),g,m=Array.isArray(u);s(d,"TABLE",0,1,"sheetjs"),s(d,"VECTORS",0,h.e.r-h.s.r+1,""),s(d,"TUPLES",0,h.e.c-h.s.c+1,""),s(d,"DATA",0,0,"");for(var v=h.s.r;v<=h.e.r;++v){o(d,-1,0,"BOT");for(var w=h.s.c;w<=h.e.c;++w){var C=pt({r:v,c:w});if(g=m?(u[v]||[])[w]:u[C],!g){o(d,1,0,"");continue}switch(g.t){case"n":var b=g.w;!b&&g.v!=null&&(b=g.v),b==null?g.f&&!g.F?o(d,1,0,"="+g.f):o(d,1,0,""):o(d,0,b,"V");break;case"b":o(d,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=ss(g.z||gt[14],rn(mr(g.v)))),o(d,0,g.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var x=`\r
`,R=d.join(x);return R}})();return{to_workbook:n,to_sheet:r,from_sheet:i}})(),KO=(function(){function e(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(g,m){for(var v=g.split(`
`),w=-1,C=-1,b=0,x=[];b!==v.length;++b){var R=v[b].trim().split(":");if(R[0]==="cell"){var E=Tr(R[1]);if(x.length<=E.r)for(w=x.length;w<=E.r;++w)x[w]||(x[w]=[]);switch(w=E.r,C=E.c,R[2]){case"t":x[w][C]=e(R[3]);break;case"v":x[w][C]=+R[3];break;case"vtf":var A=R[R.length-1];case"vtc":switch(R[3]){case"nl":x[w][C]=!!+R[4];break;default:x[w][C]=+R[4];break}R[2]=="vtf"&&(x[w][C]=[x[w][C],A])}}}return m&&m.sheetRows&&(x=x.slice(0,m.sheetRows)),x}function n(g,m){return Sd(r(g,m),m)}function i(g,m){return ol(n(g,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function d(g){if(!g||!g["!ref"])return"";for(var m=[],v=[],w,C="",b=di(g["!ref"]),x=Array.isArray(g),R=b.s.r;R<=b.e.r;++R)for(var E=b.s.c;E<=b.e.c;++E)if(C=pt({r:R,c:E}),w=x?(g[R]||[])[E]:g[C],!(!w||w.v==null||w.t==="z")){switch(v=["cell",C,"t"],w.t){case"s":case"str":v.push(t(w.v));break;case"n":w.f?(v[2]="vtf",v[3]="n",v[4]=w.v,v[5]=t(w.f)):(v[2]="v",v[3]=w.v);break;case"b":v[2]="vt"+(w.f?"f":"c"),v[3]="nl",v[4]=w.v?"1":"0",v[5]=t(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var A=rn(mr(w.v));v[2]="vtc",v[3]="nd",v[4]=""+A,v[5]=w.w||ss(w.z||gt[14],A);break;case"e":continue}m.push(v.join(":"))}return m.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function h(g){return[s,o,a,o,d(g),u].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:h}})(),id=(function(){function e(h,g,m,v,w){w.raw?g[m][v]=h:h===""||(h==="TRUE"?g[m][v]=!0:h==="FALSE"?g[m][v]=!1:isNaN(xs(h))?isNaN(nd(h).getDate())?g[m][v]=h:g[m][v]=mr(h):g[m][v]=xs(h))}function t(h,g){var m=g||{},v=[];if(!h||h.length===0)return v;for(var w=h.split(/[\r\n]/),C=w.length-1;C>=0&&w[C].length===0;)--C;for(var b=10,x=0,R=0;R<=C;++R)x=w[R].indexOf(" "),x==-1?x=w[R].length:x++,b=Math.max(b,x);for(R=0;R<=C;++R){v[R]=[];var E=0;for(e(w[R].slice(0,b).trim(),v,R,E,m),E=1;E<=(w[R].length-b)/10+1;++E)e(w[R].slice(b+(E-1)*10,b+E*10).trim(),v,R,E,m)}return m.sheetRows&&(v=v.slice(0,m.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(h){for(var g={},m=!1,v=0,w=0;v<h.length;++v)(w=h.charCodeAt(v))==34?m=!m:!m&&w in r&&(g[w]=(g[w]||0)+1);w=[];for(v in g)Object.prototype.hasOwnProperty.call(g,v)&&w.push([g[v],v]);if(!w.length){g=n;for(v in g)Object.prototype.hasOwnProperty.call(g,v)&&w.push([g[v],v])}return w.sort(function(C,b){return C[0]-b[0]||n[C[1]]-n[b[1]]}),r[w.pop()[1]]||44}function s(h,g){var m=g||{},v="",w=m.dense?[]:{},C={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(v=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(v=h.charAt(4),h=h.slice(6)):v=i(h.slice(0,1024)):m&&m.FS?v=m.FS:v=i(h.slice(0,1024));var b=0,x=0,R=0,E=0,A=0,D=v.charCodeAt(0),M=!1,F=0,O=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var L=m.dateNF!=null?Bie(m.dateNF):null;function W(){var I=h.slice(E,A),G={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)G.t="z";else if(m.raw)G.t="s",G.v=I;else if(I.trim().length===0)G.t="s",G.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(G.t="s",G.v=I.slice(2,-1).replace(/""/g,'"')):fue(I)?(G.t="n",G.f=I.slice(1)):(G.t="s",G.v=I);else if(I=="TRUE")G.t="b",G.v=!0;else if(I=="FALSE")G.t="b",G.v=!1;else if(!isNaN(R=xs(I)))G.t="n",m.cellText!==!1&&(G.w=I),G.v=R;else if(!isNaN(nd(I).getDate())||L&&I.match(L)){G.z=m.dateNF||gt[14];var ne=0;L&&I.match(L)&&(I=Hie(I,m.dateNF,I.match(L)||[]),ne=1),m.cellDates?(G.t="d",G.v=mr(I,ne)):(G.t="n",G.v=rn(mr(I,ne))),m.cellText!==!1&&(G.w=ss(G.z,G.v instanceof Date?rn(G.v):G.v)),m.cellNF||delete G.z}else G.t="s",G.v=I;if(G.t=="z"||(m.dense?(w[b]||(w[b]=[]),w[b][x]=G):w[pt({c:x,r:b})]=G),E=A+1,O=h.charCodeAt(E),C.e.c<x&&(C.e.c=x),C.e.r<b&&(C.e.r=b),F==D)++x;else if(x=0,++b,m.sheetRows&&m.sheetRows<=b)return!0}e:for(;A<h.length;++A)switch(F=h.charCodeAt(A)){case 34:O===34&&(M=!M);break;case D:case 10:case 13:if(!M&&W())break e;break}return A-E>0&&W(),w["!ref"]=bt(C),w}function o(h,g){return!(g&&g.PRN)||g.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,g):Sd(t(h,g),g)}function a(h,g){var m="",v=g.type=="string"?[0,0,0,0]:F1(h,g);switch(g.type){case"base64":m=Ai(h);break;case"binary":m=h;break;case"buffer":g.codepage==65001?m=h.toString("utf8"):g.codepage&&typeof wf<"u"||(m=Rt&&Buffer.isBuffer(h)?h.toString("binary"):sl(h));break;case"array":m=oc(h);break;case"string":m=h;break;default:throw new Error("Unrecognized type "+g.type)}return v[0]==239&&v[1]==187&&v[2]==191?m=sr(m.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?m=sr(m):g.type=="binary"&&typeof wf<"u",m.slice(0,19)=="socialcalc:version:"?KO.to_sheet(g.type=="string"?m:sr(m),g):o(m,g)}function u(h,g){return ol(a(h,g),g)}function d(h){for(var g=[],m=Ht(h["!ref"]),v,w=Array.isArray(h),C=m.s.r;C<=m.e.r;++C){for(var b=[],x=m.s.c;x<=m.e.c;++x){var R=pt({r:C,c:x});if(v=w?(h[C]||[])[x]:h[R],!v||v.v==null){b.push("          ");continue}for(var E=(v.w||(Ko(v),v.w)||"").slice(0,10);E.length<10;)E+=" ";b.push(E+(x===0?" ":""))}g.push(b.join(""))}return g.join(`
`)}return{to_workbook:u,to_sheet:a,from_sheet:d}})();function Jae(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=jO.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return id.to_workbook(e,t)}}var Kl=(function(){function e(P,V,H){if(P){wn(P,P.l||0);for(var j=H.Enum||se;P.l<P.length;){var ae=P.read_shift(2),fe=j[ae]||j[65535],le=P.read_shift(2),de=P.l+le,ue=fe.f&&fe.f(P,le,H);if(P.l=de,V(ue,fe,ae))return}}}function t(P,V){switch(V.type){case"base64":return r(Si(Ai(P)),V);case"binary":return r(Si(P),V);case"buffer":case"array":return r(P,V)}throw"Unsupported type "+V.type}function r(P,V){if(!P)return P;var H=V||{},j=H.dense?[]:{},ae="Sheet1",fe="",le=0,de={},ue=[],Ie=[],q={s:{r:0,c:0},e:{r:0,c:0}},Ge=H.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)H.Enum=se,e(P,function(De,nt,vt){switch(vt){case 0:H.vers=De,De>=4096&&(H.qpro=!0);break;case 6:q=De;break;case 204:De&&(fe=De);break;case 222:fe=De;break;case 15:case 51:H.qpro||(De[1].v=De[1].v.slice(1));case 13:case 14:case 16:vt==14&&(De[2]&112)==112&&(De[2]&15)>1&&(De[2]&15)<15&&(De[1].z=H.dateNF||gt[14],H.cellDates&&(De[1].t="d",De[1].v=av(De[1].v))),H.qpro&&De[3]>le&&(j["!ref"]=bt(q),de[ae]=j,ue.push(ae),j=H.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},le=De[3],ae=fe||"Sheet"+(le+1),fe="");var Xe=H.dense?(j[De[0].r]||[])[De[0].c]:j[pt(De[0])];if(Xe){Xe.t=De[1].t,Xe.v=De[1].v,De[1].z!=null&&(Xe.z=De[1].z),De[1].f!=null&&(Xe.f=De[1].f);break}H.dense?(j[De[0].r]||(j[De[0].r]=[]),j[De[0].r][De[0].c]=De[1]):j[pt(De[0])]=De[1];break}},H);else if(P[2]==26||P[2]==14)H.Enum=N,P[2]==14&&(H.qpro=!0,P.l=0),e(P,function(De,nt,vt){switch(vt){case 204:ae=De;break;case 22:De[1].v=De[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(De[3]>le&&(j["!ref"]=bt(q),de[ae]=j,ue.push(ae),j=H.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},le=De[3],ae="Sheet"+(le+1)),Ge>0&&De[0].r>=Ge)break;H.dense?(j[De[0].r]||(j[De[0].r]=[]),j[De[0].r][De[0].c]=De[1]):j[pt(De[0])]=De[1],q.e.c<De[0].c&&(q.e.c=De[0].c),q.e.r<De[0].r&&(q.e.r=De[0].r);break;case 27:De[14e3]&&(Ie[De[14e3][0]]=De[14e3][1]);break;case 1537:Ie[De[0]]=De[1],De[0]==le&&(ae=De[1]);break}},H);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(j["!ref"]=bt(q),de[fe||ae]=j,ue.push(fe||ae),!Ie.length)return{SheetNames:ue,Sheets:de};for(var Ye={},Ze=[],ke=0;ke<Ie.length;++ke)de[ue[ke]]?(Ze.push(Ie[ke]||ue[ke]),Ye[Ie[ke]]=de[Ie[ke]]||de[ue[ke]]):(Ze.push(Ie[ke]),Ye[Ie[ke]]={"!ref":"A1"});return{SheetNames:Ze,Sheets:Ye}}function n(P,V){var H=V||{};if(+H.codepage>=0&&Cs(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var j=oi(),ae=Ht(P["!ref"]),fe=Array.isArray(P),le=[];We(j,0,s(1030)),We(j,6,u(ae));for(var de=Math.min(ae.e.r,8191),ue=ae.s.r;ue<=de;++ue)for(var Ie=zr(ue),q=ae.s.c;q<=ae.e.c;++q){ue===ae.s.r&&(le[q]=Rr(q));var Ge=le[q]+Ie,Ye=fe?(P[ue]||[])[q]:P[Ge];if(!(!Ye||Ye.t=="z"))if(Ye.t=="n")(Ye.v|0)==Ye.v&&Ye.v>=-32768&&Ye.v<=32767?We(j,13,v(ue,q,Ye.v)):We(j,14,C(ue,q,Ye.v));else{var Ze=Ko(Ye);We(j,15,g(ue,q,Ze.slice(0,239)))}}return We(j,1),j.end()}function i(P,V){var H=V||{};if(+H.codepage>=0&&Cs(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var j=oi();We(j,0,o(P));for(var ae=0,fe=0;ae<P.SheetNames.length;++ae)(P.Sheets[P.SheetNames[ae]]||{})["!ref"]&&We(j,27,U(P.SheetNames[ae],fe++));var le=0;for(ae=0;ae<P.SheetNames.length;++ae){var de=P.Sheets[P.SheetNames[ae]];if(!(!de||!de["!ref"])){for(var ue=Ht(de["!ref"]),Ie=Array.isArray(de),q=[],Ge=Math.min(ue.e.r,8191),Ye=ue.s.r;Ye<=Ge;++Ye)for(var Ze=zr(Ye),ke=ue.s.c;ke<=ue.e.c;++ke){Ye===ue.s.r&&(q[ke]=Rr(ke));var De=q[ke]+Ze,nt=Ie?(de[Ye]||[])[ke]:de[De];if(!(!nt||nt.t=="z"))if(nt.t=="n")We(j,23,W(Ye,ke,le,nt.v));else{var vt=Ko(nt);We(j,22,F(Ye,ke,le,vt.slice(0,239)))}}++le}}return We(j,1),j.end()}function s(P){var V=Re(2);return V.write_shift(2,P),V}function o(P){var V=Re(26);V.write_shift(2,4096),V.write_shift(2,4),V.write_shift(4,0);for(var H=0,j=0,ae=0,fe=0;fe<P.SheetNames.length;++fe){var le=P.SheetNames[fe],de=P.Sheets[le];if(!(!de||!de["!ref"])){++ae;var ue=di(de["!ref"]);H<ue.e.r&&(H=ue.e.r),j<ue.e.c&&(j=ue.e.c)}}return H>8191&&(H=8191),V.write_shift(2,H),V.write_shift(1,ae),V.write_shift(1,j),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(1,1),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(4,0),V}function a(P,V,H){var j={s:{c:0,r:0},e:{c:0,r:0}};return V==8&&H.qpro?(j.s.c=P.read_shift(1),P.l++,j.s.r=P.read_shift(2),j.e.c=P.read_shift(1),P.l++,j.e.r=P.read_shift(2),j):(j.s.c=P.read_shift(2),j.s.r=P.read_shift(2),V==12&&H.qpro&&(P.l+=2),j.e.c=P.read_shift(2),j.e.r=P.read_shift(2),V==12&&H.qpro&&(P.l+=2),j.s.c==65535&&(j.s.c=j.e.c=j.s.r=j.e.r=0),j)}function u(P){var V=Re(8);return V.write_shift(2,P.s.c),V.write_shift(2,P.s.r),V.write_shift(2,P.e.c),V.write_shift(2,P.e.r),V}function d(P,V,H){var j=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(j[0].c=P.read_shift(1),j[3]=P.read_shift(1),j[0].r=P.read_shift(2),P.l+=2):(j[2]=P.read_shift(1),j[0].c=P.read_shift(2),j[0].r=P.read_shift(2)),j}function h(P,V,H){var j=P.l+V,ae=d(P,V,H);if(ae[1].t="s",H.vers==20768){P.l++;var fe=P.read_shift(1);return ae[1].v=P.read_shift(fe,"utf8"),ae}return H.qpro&&P.l++,ae[1].v=P.read_shift(j-P.l,"cstr"),ae}function g(P,V,H){var j=Re(7+H.length);j.write_shift(1,255),j.write_shift(2,V),j.write_shift(2,P),j.write_shift(1,39);for(var ae=0;ae<j.length;++ae){var fe=H.charCodeAt(ae);j.write_shift(1,fe>=128?95:fe)}return j.write_shift(1,0),j}function m(P,V,H){var j=d(P,V,H);return j[1].v=P.read_shift(2,"i"),j}function v(P,V,H){var j=Re(7);return j.write_shift(1,255),j.write_shift(2,V),j.write_shift(2,P),j.write_shift(2,H,"i"),j}function w(P,V,H){var j=d(P,V,H);return j[1].v=P.read_shift(8,"f"),j}function C(P,V,H){var j=Re(13);return j.write_shift(1,255),j.write_shift(2,V),j.write_shift(2,P),j.write_shift(8,H,"f"),j}function b(P,V,H){var j=P.l+V,ae=d(P,V,H);if(ae[1].v=P.read_shift(8,"f"),H.qpro)P.l=j;else{var fe=P.read_shift(2);A(P.slice(P.l,P.l+fe),ae),P.l+=fe}return ae}function x(P,V,H){var j=V&32768;return V&=-32769,V=(j?P:0)+(V>=8192?V-16384:V),(j?"":"$")+(H?Rr(V):zr(V))}var R={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function A(P,V){wn(P,0);for(var H=[],j=0,ae="",fe="",le="",de="";P.l<P.length;){var ue=P[P.l++];switch(ue){case 0:H.push(P.read_shift(8,"f"));break;case 1:fe=x(V[0].c,P.read_shift(2),!0),ae=x(V[0].r,P.read_shift(2),!1),H.push(fe+ae);break;case 2:{var Ie=x(V[0].c,P.read_shift(2),!0),q=x(V[0].r,P.read_shift(2),!1);fe=x(V[0].c,P.read_shift(2),!0),ae=x(V[0].r,P.read_shift(2),!1),H.push(Ie+q+":"+fe+ae)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(P.read_shift(2));break;case 6:{for(var Ge="";ue=P[P.l++];)Ge+=String.fromCharCode(ue);H.push('"'+Ge.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:de=H.pop(),le=H.pop(),H.push(["AND","OR"][ue-20]+"("+le+","+de+")");break;default:if(ue<32&&E[ue])de=H.pop(),le=H.pop(),H.push(le+E[ue]+de);else if(R[ue]){if(j=R[ue][1],j==69&&(j=P[P.l++]),j>H.length){console.error("WK1 bad formula parse 0x"+ue.toString(16)+":|"+H.join("|")+"|");return}var Ye=H.slice(-j);H.length-=j,H.push(R[ue][0]+"("+Ye.join(",")+")")}else return ue<=7?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=24?console.error("WK1 unsupported op "+ue.toString(16)):ue<=30?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=115?console.error("WK1 unsupported function opcode "+ue.toString(16)):console.error("WK1 unrecognized opcode "+ue.toString(16))}}H.length==1?V[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function D(P){var V=[{c:0,r:0},{t:"n",v:0},0];return V[0].r=P.read_shift(2),V[3]=P[P.l++],V[0].c=P[P.l++],V}function M(P,V){var H=D(P);return H[1].t="s",H[1].v=P.read_shift(V-4,"cstr"),H}function F(P,V,H,j){var ae=Re(6+j.length);ae.write_shift(2,P),ae.write_shift(1,H),ae.write_shift(1,V),ae.write_shift(1,39);for(var fe=0;fe<j.length;++fe){var le=j.charCodeAt(fe);ae.write_shift(1,le>=128?95:le)}return ae.write_shift(1,0),ae}function O(P,V){var H=D(P);H[1].v=P.read_shift(2);var j=H[1].v>>1;if(H[1].v&1)switch(j&7){case 0:j=(j>>3)*5e3;break;case 1:j=(j>>3)*500;break;case 2:j=(j>>3)/20;break;case 3:j=(j>>3)/200;break;case 4:j=(j>>3)/2e3;break;case 5:j=(j>>3)/2e4;break;case 6:j=(j>>3)/16;break;case 7:j=(j>>3)/64;break}return H[1].v=j,H}function L(P,V){var H=D(P),j=P.read_shift(4),ae=P.read_shift(4),fe=P.read_shift(2);if(fe==65535)return j===0&&ae===3221225472?(H[1].t="e",H[1].v=15):j===0&&ae===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var le=fe&32768;return fe=(fe&32767)-16446,H[1].v=(1-le*2)*(ae*Math.pow(2,fe+32)+j*Math.pow(2,fe)),H}function W(P,V,H,j){var ae=Re(14);if(ae.write_shift(2,P),ae.write_shift(1,H),ae.write_shift(1,V),j==0)return ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(2,65535),ae;var fe=0,le=0,de=0,ue=0;return j<0&&(fe=1,j=-j),le=Math.log2(j)|0,j/=Math.pow(2,le-31),ue=j>>>0,(ue&2147483648)==0&&(j/=2,++le,ue=j>>>0),j-=ue,ue|=2147483648,ue>>>=0,j*=Math.pow(2,32),de=j>>>0,ae.write_shift(4,de),ae.write_shift(4,ue),le+=16383+(fe?32768:0),ae.write_shift(2,le),ae}function I(P,V){var H=L(P);return P.l+=V-14,H}function G(P,V){var H=D(P),j=P.read_shift(4);return H[1].v=j>>6,H}function ne(P,V){var H=D(P),j=P.read_shift(8,"f");return H[1].v=j,H}function ie(P,V){var H=ne(P);return P.l+=V-10,H}function J(P,V){return P[P.l+V-1]==0?P.read_shift(V,"cstr"):""}function _(P,V){var H=P[P.l++];H>V-1&&(H=V-1);for(var j="";j.length<H;)j+=String.fromCharCode(P[P.l++]);return j}function Y(P,V,H){if(!(!H.qpro||V<21)){var j=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var ae=P.read_shift(V-21,"cstr");return[j,ae]}}function Q(P,V){for(var H={},j=P.l+V;P.l<j;){var ae=P.read_shift(2);if(ae==14e3){for(H[ae]=[0,""],H[ae][0]=P.read_shift(2);P[P.l];)H[ae][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return H}function U(P,V){var H=Re(5+P.length);H.write_shift(2,14e3),H.write_shift(2,V);for(var j=0;j<P.length;++j){var ae=P.charCodeAt(j);H[H.l++]=ae>127?95:ae}return H[H.l++]=0,H}var se={0:{n:"BOF",f:Jr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:J},222:{n:"SHEETNAMELP",f:_},65535:{n:""}},N={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:M},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:O},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:G},38:{n:"??"},39:{n:"NUMBER27",f:ne},40:{n:"FORMULA28",f:ie},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:J},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Y},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}})();function ele(e){var t={},r=e.match(Nn),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=mt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Ux[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var tle=(function(){var e=bf("t"),t=bf("rPr");function r(s){var o=s.match(e);if(!o)return{t:"s",v:""};var a={t:"s",v:Bt(o[1])},u=s.match(t);return u&&(a.s=ele(u[1])),a}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(a){return a.v})}})(),rle=(function(){var t=/(\r\n|\n)/g;function r(i,s,o){var a=[];i.u&&a.push("text-decoration: underline;"),i.uval&&a.push("text-underline-style:"+i.uval+";"),i.sz&&a.push("font-size:"+i.sz+"pt;"),i.outline&&a.push("text-effect: outline;"),i.shadow&&a.push("text-shadow: auto;"),s.push('<span style="'+a.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var u=i.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(s.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}})(),nle=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,ile=/<(?:\w+:)?r>/,sle=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function g1(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Bt(sr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=sr(e),r&&(n.h=e1(n.t))):e.match(ile)&&(n.r=sr(e),n.t=Bt(sr((e.replace(sle,"").match(nle)||[]).join("").replace(Nn,""))),r&&(n.h=rle(tle(n.r)))),n):{t:""}}var ole=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,ale=/<(?:\w+:)?(?:si|sstItem)>/g,lle=/<\/(?:\w+:)?(?:si|sstItem)>/;function cle(e,t){var r=[],n="";if(!e)return r;var i=e.match(ole);if(i){n=i[2].replace(ale,"").split(lle);for(var s=0;s!=n.length;++s){var o=g1(n[s].trim(),t);o!=null&&(r[r.length]=o)}i=mt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var ule=/^\s|\s$|[\t\n\r]/;function qO(e,t){if(!t.bookSST)return"";var r=[Wr];r[r.length]=ze("sst",null,{xmlns:Cc[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(ule)&&(s+=' xml:space="preserve"'),s+=">"+Jt(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function dle(e){return[e.read_shift(4),e.read_shift(4)]}function hle(e,t){var r=[],n=!1;return ra(e,function(s,o,a){switch(a){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}}),r}function fle(e,t){return t||(t=Re(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var gle=Ese;function ple(e){var t=oi();_e(t,159,fle(e));for(var r=0;r<e.length;++r)_e(t,19,gle(e[r]));return _e(t,160),t.end()}function XO(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function $o(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function mle(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=$o(e,4),t.U=$o(e,4),t.W=$o(e,4),t}function vle(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function wle(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(vle(e));return t}function Cle(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function yle(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=$o(e,4),t.U=$o(e,4),t.W=$o(e,4),t}function ble(e){var t=yle(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function QO(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function ZO(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Sle(e){var t=$o(e);switch(t.Minor){case 2:return[t.Minor,xle(e)];case 3:return[t.Minor,Ele()];case 4:return[t.Minor,Rle(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function xle(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=QO(e,r),i=ZO(e,e.length-e.l);return{t:"Std",h:n,v:i}}function Ele(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Rle(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Nn,function(s){var o=mt(s);switch(lo(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(a){n[a]=o[a]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function Tle(e,t){var r={},n=r.EncryptionVersionInfo=$o(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=QO(e,i),t-=i,r.EncryptionVerifier=ZO(e,t),r}function Fle(e){var t={},r=t.EncryptionVersionInfo=$o(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function p1(e){var t=0,r,n=XO(e),i=n.length+1,s,o,a,u,d;for(r=qa(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)o=r[s],a=(t&16384)===0?0:1,u=t<<1&32767,d=a|u,t=d^o;return t^52811}var JO=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,a){return n(o^a)},s=function(o){for(var a=t[o.length-1],u=104,d=o.length-1;d>=0;--d)for(var h=o[d],g=0;g!=7;++g)h&64&&(a^=r[u]),h*=2,--u;return a};return function(o){for(var a=XO(o),u=s(a),d=a.length,h=qa(16),g=0;g!=16;++g)h[g]=0;var m,v,w;for((d&1)===1&&(m=u>>8,h[d]=i(e[0],m),--d,m=u&255,v=a[a.length-1],h[d]=i(v,m));d>0;)--d,m=u>>8,h[d]=i(a[d],m),--d,m=u&255,h[d]=i(a[d],m);for(d=15,w=15-a.length;w>0;)m=u>>8,h[d]=i(e[w],m),--d,--w,m=u&255,h[d]=i(a[d],m),--d,--w;return h}})(),Dle=function(e,t,r,n,i){i||(i=t),n||(n=JO(e));var s,o;for(s=0;s!=t.length;++s)o=t[s],o^=n[r],o=(o>>5|o<<3)&255,i[s]=o,++r;return[i,r,n]},Ale=function(e){var t=0,r=JO(e);return function(n){var i=Dle("",n,t,r);return t=i[1],i[0]}};function kle(e,t,r,n){var i={key:Jr(e),verificationBytes:Jr(e)};return r.password&&(i.verifier=p1(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=Ale(r.password)),i}function Ple(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Fle(e):n.Data=Tle(e,t),n}function Mle(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Ple(e,t-2,n):kle(e,r.biff>=8?t:t-2,r,n),n}var eN=(function(){function e(i,s){switch(s.type){case"base64":return t(Ai(i),s);case"binary":return t(i,s);case"buffer":return t(Rt&&Buffer.isBuffer(i)?i.toString("binary"):sl(i),s);case"array":return t(oc(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var o=s||{},a=o.dense?[]:{},u=i.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(h,g){Array.isArray(a)&&(a[g]=[]);for(var m=/\\\w+\b/g,v=0,w,C=-1;w=m.exec(h);){switch(w[0]){case"\\cell":var b=h.slice(v,m.lastIndex-w[0].length);if(b[0]==" "&&(b=b.slice(1)),++C,b.length){var x={v:b,t:"s"};Array.isArray(a)?a[g][C]=x:a[pt({r:g,c:C})]=x}break}v=m.lastIndex}C>d.e.c&&(d.e.c=C)}),a["!ref"]=bt(d),a}function r(i,s){return ol(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],o=Ht(i["!ref"]),a,u=Array.isArray(i),d=o.s.r;d<=o.e.r;++d){s.push("\\trowd\\trautofit1");for(var h=o.s.c;h<=o.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=o.s.c;h<=o.e.c;++h){var g=pt({r:d,c:h});a=u?(i[d]||[])[h]:i[g],!(!a||a.v==null&&(!a.f||a.F))&&(s.push(" "+(a.w||(Ko(a),a.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function _le(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Rf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Lle(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),o=i-s;if(o===0)return[0,0,t];var a=0,u=0,d=i+s;switch(u=o/(d>1?2-d:d),i){case t:a=((r-n)/o+6)%6;break;case r:a=(n-t)/o+2;break;case n:a=(t-r)/o+4;break}return[a/6,u,d/2]}function Ile(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,o=[s,s,s],a=6*t,u;if(r!==0)switch(a|0){case 0:case 6:u=i*a,o[0]+=i,o[1]+=u;break;case 1:u=i*(2-a),o[0]+=u,o[1]+=i;break;case 2:u=i*(a-2),o[1]+=i,o[2]+=u;break;case 3:u=i*(4-a),o[1]+=u,o[2]+=i;break;case 4:u=i*(a-4),o[2]+=i,o[0]+=u;break;case 5:u=i*(6-a),o[2]+=u,o[0]+=i;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function im(e,t){if(t===0)return e;var r=Lle(_le(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Rf(Ile(r))}var tN=6,Ole=15,Nle=1,kn=tN;function Tf(e){return Math.floor((e+Math.round(128/kn)/256)*kn)}function Ff(e){return Math.floor((e-5)/kn*100+.5)/100}function sm(e){return Math.round((e*kn+5)/kn*256)/256}function Vy(e){return sm(Ff(Tf(e)))}function m1(e){var t=Math.abs(e-Vy(e)),r=kn;if(t>.005)for(kn=Nle;kn<Ole;++kn)Math.abs(e-Vy(e))<=t&&(t=Math.abs(e-Vy(e)),r=kn);kn=r}function Xa(e){e.width?(e.wpx=Tf(e.width),e.wch=Ff(e.wpx),e.MDW=kn):e.wpx?(e.wch=Ff(e.wpx),e.width=sm(e.wch),e.MDW=kn):typeof e.wch=="number"&&(e.width=sm(e.wch),e.wpx=Tf(e.width),e.MDW=kn),e.customWidth&&delete e.customWidth}var Ble=96,rN=Ble;function Df(e){return e*96/rN}function sd(e){return e*rN/96}var Hle={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Gle(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(Nn)||[]).forEach(function(o){var a=mt(o);switch(lo(a[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},a.diagonalUp&&(i.diagonalUp=pr(a.diagonalUp)),a.diagonalDown&&(i.diagonalDown=pr(a.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in borders")}})}function Vle(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(Nn)||[]).forEach(function(o){var a=mt(o);switch(lo(a[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":a.patternType&&(i.patternType=a.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),a.indexed&&(i.bgColor.indexed=parseInt(a.indexed,10)),a.theme&&(i.bgColor.theme=parseInt(a.theme,10)),a.tint&&(i.bgColor.tint=parseFloat(a.tint)),a.rgb&&(i.bgColor.rgb=a.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),a.theme&&(i.fgColor.theme=parseInt(a.theme,10)),a.tint&&(i.fgColor.tint=parseFloat(a.tint)),a.rgb!=null&&(i.fgColor.rgb=a.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in fills")}})}function zle(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(Nn)||[]).forEach(function(o){var a=mt(o);switch(lo(a[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":a.val&&(i.name=sr(a.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=a.val?pr(a.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=a.val?pr(a.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(a.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=a.val?pr(a.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=a.val?pr(a.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=a.val?pr(a.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=a.val?pr(a.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=a.val?pr(a.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":a.val&&(i.sz=+a.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":a.val&&(i.vertAlign=a.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":a.val&&(i.family=parseInt(a.val,10));break;case"<family/>":case"</family>":break;case"<scheme":a.val&&(i.scheme=a.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(a.val=="1")break;a.codepage=Ux[parseInt(a.val,10)];break;case"<color":if(i.color||(i.color={}),a.auto&&(i.color.auto=pr(a.auto)),a.rgb)i.color.rgb=a.rgb.slice(-6);else if(a.indexed){i.color.index=parseInt(a.indexed,10);var u=jl[i.color.index];i.color.index==81&&(u=jl[1]),u||(u=jl[1]),i.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else a.theme&&(i.color.theme=parseInt(a.theme,10),a.tint&&(i.color.tint=parseFloat(a.tint)),a.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=im(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in fonts")}})}function Wle(e,t,r){t.NumberFmt=[];for(var n=Ir(gt),i=0;i<n.length;++i)t.NumberFmt[n[i]]=gt[n[i]];var s=e[0].match(Nn);if(s)for(i=0;i<s.length;++i){var o=mt(s[i]);switch(lo(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var a=Bt(sr(o.formatCode)),u=parseInt(o.numFmtId,10);if(t.NumberFmt[u]=a,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=a}Uo(a,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Ule(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=ze("numFmt",null,{numFmtId:n,formatCode:Jt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ze("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Wp=["numFmtId","fillId","fontId","borderId","xfId"],Up=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function $le(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Nn)||[]).forEach(function(s){var o=mt(s),a=0;switch(lo(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],a=0;a<Wp.length;++a)n[Wp[a]]&&(n[Wp[a]]=parseInt(n[Wp[a]],10));for(a=0;a<Up.length;++a)n[Up[a]]&&(n[Up[a]]=pr(n[Up[a]]));if(t.NumberFmt&&n.numFmtId>392){for(a=392;a>60;--a)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[a]){n.numFmtId=a;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=pr(o.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function jle(e){var t=[];return t[t.length]=ze("cellXfs",null),e.forEach(function(r){t[t.length]=ze("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ze("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Yle=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(a,u,d){var h={};if(!a)return h;a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=a.match(t))&&Wle(g,h,d),(g=a.match(i))&&zle(g,h,u,d),(g=a.match(n))&&Vle(g,h,u,d),(g=a.match(s))&&Gle(g,h,u,d),(g=a.match(r))&&$le(g,h,d),h}})();function nN(e,t){var r=[Wr,ze("styleSheet",null,{xmlns:Cc[0],"xmlns:vt":tn.vt})],n;return e.SSF&&(n=Ule(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=jle(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Kle(e,t){var r=e.read_shift(2),n=_n(e);return[r,n]}function qle(e,t,r){r||(r=Re(6+4*t.length)),r.write_shift(2,e),dn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Xle(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=Pse(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var a=e.read_shift(1);a>0&&(n.family=a);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=kse(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=_n(e),n}function Qle(e,t){t||(t=Re(153)),t.write_shift(2,e.sz*20),Mse(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),tm(e.color,t);var n=0;return n=2,t.write_shift(1,n),dn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Zle=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],zy,Jle=Ln;function rk(e,t){t||(t=Re(84)),zy||(zy=sv(Zle));var r=zy[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(tm({auto:1},t),tm({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function ece(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function iN(e,t,r){r||(r=Re(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Th(e,t){return t||(t=Re(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var tce=Ln;function rce(e,t){return t||(t=Re(51)),t.write_shift(1,0),Th(null,t),Th(null,t),Th(null,t),Th(null,t),Th(null,t),t.length>t.l?t.slice(0,t.l):t}function nce(e,t){return t||(t=Re(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),em(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function ice(e,t,r){var n=Re(2052);return n.write_shift(4,e),em(t,n),em(r,n),n.length>n.l?n.slice(0,n.l):n}function sce(e,t,r){var n={};n.NumberFmt=[];for(var i in gt)n.NumberFmt[i]=gt[i];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return ra(e,function(u,d,h){switch(h){case 44:n.NumberFmt[u[0]]=u[1],Uo(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=im(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(h),o=!0;break;case 38:s.pop(),o=!1;break;default:if(d.T>0)s.push(h);else if(d.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function oce(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(_e(e,615,Es(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&_e(e,44,qle(i,t[i]))}),_e(e,616))}}function ace(e){var t=1;_e(e,611,Es(t)),_e(e,43,Qle({sz:12,color:{theme:1},name:"Calibri",family:2})),_e(e,612)}function lce(e){var t=2;_e(e,603,Es(t)),_e(e,45,rk({patternType:"none"})),_e(e,45,rk({patternType:"gray125"})),_e(e,604)}function cce(e){var t=1;_e(e,613,Es(t)),_e(e,46,rce()),_e(e,614)}function uce(e){var t=1;_e(e,626,Es(t)),_e(e,47,iN({numFmtId:0},65535)),_e(e,627)}function dce(e,t){_e(e,617,Es(t.length)),t.forEach(function(r){_e(e,47,iN(r,0))}),_e(e,618)}function hce(e){var t=1;_e(e,619,Es(t)),_e(e,48,nce({xfId:0,name:"Normal"})),_e(e,620)}function fce(e){var t=0;_e(e,505,Es(t)),_e(e,506)}function gce(e){var t=0;_e(e,508,ice(t,"TableStyleMedium9","PivotStyleMedium4")),_e(e,509)}function pce(e,t){var r=oi();return _e(r,278),oce(r,e.SSF),ace(r),lce(r),cce(r),uce(r),dce(r,t.cellXfs),hce(r),fce(r),gce(r),_e(r,279),r.end()}var mce=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function vce(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Nn)||[]).forEach(function(i){var s=mt(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[mce.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function wce(){}function Cce(){}var yce=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,bce=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Sce=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function xce(e,t,r){t.themeElements={};var n;[["clrScheme",yce,vce],["fontScheme",bce,wce],["fmtScheme",Sce,Cce]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var Ece=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function sN(e,t){(!e||e.length===0)&&(e=v1());var r,n={};if(!(r=e.match(Ece)))throw new Error("themeElements not found in theme");return xce(r[0],n,t),n.raw=e,n}function v1(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Wr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Rce(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var o;try{o=QI(s,{type:"array"})}catch{return}var a=xi(o,"theme/theme/theme1.xml",!0);if(a)return sN(a,r)}}function Tce(e){return e.read_shift(4)}function Fce(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Dce(e,4);break;case 2:t.xclrValue=BO(e);break;case 3:t.xclrValue=Tce(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Dce(e,t){return Ln(e,t)}function Ace(e,t){return Ln(e,t)}function kce(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Fce(e);break;case 6:n[1]=Ace(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Pce(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(kce(e,r-e.l));return{ixfe:n,ext:s}}function Mce(e,t){t.forEach(function(r){r[0]})}function _ce(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:_n(e)}}function Lce(e){var t=Re(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),dn(e.name,t),t.slice(0,t.l)}function Ice(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Oce(e){var t=Re(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Nce(e,t){var r=Re(8+2*t.length);return r.write_shift(4,e),dn(t,r),r.slice(0,r.l)}function Bce(e){return e.l+=4,e.read_shift(4)!=0}function Hce(e,t){var r=Re(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Gce(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],o=!1,a=2;return ra(e,function(u,d,h){switch(h){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(g){a==1?n.Cell.push({type:n.Types[g[0]-1].name,index:g[1]}):a==0&&n.Value.push({type:n.Types[g[0]-1].name,index:g[1]})});break;case 337:a=u?1:0;break;case 338:a=2;break;case 35:s.push(h),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!d.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function Vce(){var e=oi();return _e(e,332),_e(e,334,Es(1)),_e(e,335,Lce({name:"XLDAPR",version:12e4,flags:3496657072})),_e(e,336),_e(e,339,Nce(1,"XLDAPR")),_e(e,52),_e(e,35,Es(514)),_e(e,4096,Es(0)),_e(e,4097,Zi(1)),_e(e,36),_e(e,53),_e(e,340),_e(e,337,Hce(1)),_e(e,51,Oce([[1,0]])),_e(e,338),_e(e,333),e.end()}function zce(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,o;return e.replace(Nn,function(a){var u=mt(a);switch(lo(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==u.name&&(o=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):s==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return a}),n}function oN(){var e=[Wr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Wce(e){var t=[];if(!e)return t;var r=1;return(e.match(Nn)||[]).forEach(function(n){var i=mt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function Uce(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=pt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function $ce(e,t,r){var n=[];return ra(e,function(s,o,a){switch(a){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+a.toString(16))}}),n}function jce(e,t,r,n){if(!e)return e;var i=n||{},s=!1;ra(e,function(a,u,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!u.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},i)}function Yce(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Tu=1024;function aN(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[ze("xml",null,{"xmlns:v":yi.v,"xmlns:o":yi.o,"xmlns:x":yi.x,"xmlns:mv":yi.mv}).replace(/\/>/,">"),ze("o:shapelayout",ze("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ze("v:shapetype",[ze("v:stroke",null,{joinstyle:"miter"}),ze("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Tu<e*1e3;)Tu+=1e3;return t.forEach(function(s){var o=Tr(s[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var u=a.type=="gradient"?ze("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=ze("v:fill",u,a),h={on:"t",obscured:"t"};++Tu,i=i.concat(["<v:shape"+Sf({id:"_x0000_s"+Tu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,ze("v:shadow",null,h),ze("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Cn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Cn("x:AutoFill","False"),Cn("x:Row",String(o.r)),Cn("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function nk(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(o){var a=Tr(o.ref);if(i?(e[a.r]||(e[a.r]=[]),s=e[a.r][a.c]):s=e[o.ref],!s){s={t:"z"},i?e[a.r][a.c]=s:e[o.ref]=s;var u=Ht(e["!ref"]||"BDWGO1000001:A1");u.s.r>a.r&&(u.s.r=a.r),u.e.r<a.r&&(u.e.r=a.r),u.s.c>a.c&&(u.s.c=a.c),u.e.c<a.c&&(u.e.c=a.c);var d=bt(u);d!==e["!ref"]&&(e["!ref"]=d)}s.c||(s.c=[]);var h={a:o.author,t:o.t,r:o.r,T:r};o.h&&(h.h=o.h);for(var g=s.c.length-1;g>=0;--g){if(!r&&s.c[g].T)return;r&&!s.c[g].T&&s.c.splice(g,1)}if(r&&n){for(g=0;g<n.length;++g)if(h.a==n[g].id){h.a=n[g].name||h.a;break}}s.c.push(h)})}function Kce(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?author[^>]*>(.*)/);a&&r.push(a[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?comment[^>]*>/);if(a){var u=mt(a[0]),d={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},h=Tr(u.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var g=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!g&&!!g[1]&&g1(g[1])||{r:"",t:"",h:""};d.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),d.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=m.h),n.push(d)}}}}),n}function lN(e){var t=[Wr,ze("comments",null,{xmlns:Cc[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=Jt(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(u){u.a&&(i=r.indexOf(Jt(u.a))),s.push(u.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(Cn("t",Jt(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,a=1;a<s.length;++a)o+=`Reply:
    `+s[a]+`
`;t.push(Cn("t",Jt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function qce(e,t){var r=[],n=!1,i={},s=0;return e.replace(Nn,function(a,u){var d=mt(a);switch(lo(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=u+a.length;break;case"</text>":i.t=e.slice(s,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return a}),r}function Xce(e,t,r){var n=[Wr,ze("ThreadedComments",null,{xmlns:tn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,a){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var u={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};a==0?s=u.id:u.parentId=s,o.ID=u.id,o.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(ze("threadedComment",Cn("text",o.t||""),u))})}),n.push("</ThreadedComments>"),n.join("")}function Qce(e,t){var r=[],n=!1;return e.replace(Nn,function(s){var o=mt(s);switch(lo(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function Zce(e){var t=[Wr,ze("personList",null,{xmlns:tn.TCMNT,"xmlns:x":Cc[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(ze("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Jce(e){var t={};t.iauthor=e.read_shift(4);var r=xc(e);return t.rfx=r.s,t.ref=pt(r.s),e.l+=16,t}function eue(e,t){return t==null&&(t=Re(36)),t.write_shift(4,e[1].iauthor),xd(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var tue=_n;function rue(e){return dn(e.slice(0,54))}function nue(e,t){var r=[],n=[],i={},s=!1;return ra(e,function(a,u,d){switch(d){case 632:n.push(a);break;case 635:i=a;break;case 637:i.t=a.t,i.h=a.h,i.r=a.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function iue(e){var t=oi(),r=[];return _e(t,628),_e(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),_e(t,632,rue(i.a)))})}),_e(t,631),_e(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Tr(n[0]),e:Tr(n[0])};_e(t,635,eue([s,i])),i.t&&i.t.length>0&&_e(t,637,Tse(i)),_e(t,636),delete i.iauthor})}),_e(t,634),_e(t,629),t.end()}var sue="application/vnd.ms-office.vbaProject";function oue(e){var t=at.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");at.utils.cfb_add(t,i,e.FileIndex[n].content)}}),at.write(t)}function aue(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&at.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var cN=["xlsb","xlsm","xlam","biff8","xla"];function lue(){return{"!type":"dialog"}}function cue(){return{"!type":"dialog"}}function uue(){return{"!type":"macro"}}function due(){return{"!type":"macro"}}var zu=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,o){var a=!1,u=!1;s.length==0?u=!0:s.charAt(0)=="["&&(u=!0,s=s.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var d=s.length>0?parseInt(s,10)|0:0,h=o.length>0?parseInt(o,10)|0:0;return a?h+=t.c:--h,u?d+=t.r:--d,i+(a?"":"$")+Rr(h)+(u?"":"$")+zr(d)}return function(i,s){return t=s,i.replace(e,r)}})(),w1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,C1=(function(){return function(t,r){return t.replace(w1,function(n,i,s,o,a,u){var d=s1(o)-(s?0:r.c),h=i1(u)-(a?0:r.r),g=h==0?"":a?h+1:"["+h+"]",m=d==0?"":s?d+1:"["+d+"]";return i+"R"+g+"C"+m})}})();function uN(e,t){return e.replace(w1,function(r,n,i,s,o,a){return n+(i=="$"?i+s:Rr(s1(s)+t.c))+(o=="$"?o+a:zr(i1(a)+t.r))})}function hue(e,t,r){var n=di(t),i=n.s,s=Tr(r),o={r:s.r-i.r,c:s.c-i.c};return uN(e,o)}function fue(e){return e.length!=1}function ik(e){return e.replace(/_xlfn\./g,"")}function Qr(e){e.l+=1}function Qa(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function dN(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return hN(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),o=Qa(e),a=Qa(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function hN(e){var t=Qa(e),r=Qa(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function gue(e,t,r){if(r.biff<8)return hN(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=Qa(e),o=Qa(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function fN(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return pue(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Qa(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function pue(e){var t=Qa(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function mue(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function vue(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return wue(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,a=(s&32768)>>15;if(s&=16383,a==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:a}}function wue(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function Cue(e,t,r){var n=(e[e.l++]&96)>>5,i=dN(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function yue(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=dN(e,s,r);return[n,i,o]}function bue(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Sue(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function xue(e,t,r){var n=(e[e.l++]&96)>>5,i=gue(e,t-1,r);return[n,i]}function Eue(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function sk(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Rue(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function Tue(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Fue(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Due(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Aue(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function gN(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function kue(e){return e.read_shift(2),gN(e)}function Pue(e){return e.read_shift(2),gN(e)}function Mue(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=fN(e,0,r);return[n,i]}function _ue(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=vue(e,0,r);return[n,i]}function Lue(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=fN(e,0,r);return[n,i,s]}function Iue(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[Bde[i],vN[i],n]}function Oue(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Nue(e);return[i,(s[0]===0?vN:Nde)[s[1]]]}function Nue(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Bue(e,t,r){e.l+=r&&r.biff==2?3:4}function Hue(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Gue(e){return e.l++,na[e.read_shift(1)]}function Vue(e){return e.l++,e.read_shift(2)}function zue(e){return e.l++,e.read_shift(1)!==0}function Wue(e){return e.l++,Pn(e)}function Uue(e,t,r){return e.l++,qf(e,t-1,r)}function $ue(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Hr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=na[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Pn(e);break;case 2:r[1]=Ec(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function jue(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?xc:lv)(e));return i}function Yue(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=$ue(e,r.biff);return o}function Kue(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function que(e,t,r){if(r.biff==5)return Xue(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function Xue(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Que(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Zue(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Jue(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function ede(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var tde=Ln,rde=Ln,nde=Ln;function Qf(e,t,r){return e.l+=2,[mue(e)]}function y1(e){return e.l+=6,[]}var ide=Qf,sde=y1,ode=y1,ade=Qf;function pN(e){return e.l+=2,[Jr(e),e.read_shift(2)&1]}var lde=Qf,cde=pN,ude=y1,dde=Qf,hde=Qf,fde=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function gde(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),o=fde[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:s}}function pde(e){return e.l+=2,[e.read_shift(4)]}function mde(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function vde(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function wde(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Cde(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function yde(e){return e.l+=4,[0,0]}var ok={1:{n:"PtgExp",f:Hue},2:{n:"PtgTbl",f:nde},3:{n:"PtgAdd",f:Qr},4:{n:"PtgSub",f:Qr},5:{n:"PtgMul",f:Qr},6:{n:"PtgDiv",f:Qr},7:{n:"PtgPower",f:Qr},8:{n:"PtgConcat",f:Qr},9:{n:"PtgLt",f:Qr},10:{n:"PtgLe",f:Qr},11:{n:"PtgEq",f:Qr},12:{n:"PtgGe",f:Qr},13:{n:"PtgGt",f:Qr},14:{n:"PtgNe",f:Qr},15:{n:"PtgIsect",f:Qr},16:{n:"PtgUnion",f:Qr},17:{n:"PtgRange",f:Qr},18:{n:"PtgUplus",f:Qr},19:{n:"PtgUminus",f:Qr},20:{n:"PtgPercent",f:Qr},21:{n:"PtgParen",f:Qr},22:{n:"PtgMissArg",f:Qr},23:{n:"PtgStr",f:Uue},26:{n:"PtgSheet",f:mde},27:{n:"PtgEndSheet",f:vde},28:{n:"PtgErr",f:Gue},29:{n:"PtgBool",f:zue},30:{n:"PtgInt",f:Vue},31:{n:"PtgNum",f:Wue},32:{n:"PtgArray",f:Eue},33:{n:"PtgFunc",f:Iue},34:{n:"PtgFuncVar",f:Oue},35:{n:"PtgName",f:Kue},36:{n:"PtgRef",f:Mue},37:{n:"PtgArea",f:Cue},38:{n:"PtgMemArea",f:Que},39:{n:"PtgMemErr",f:tde},40:{n:"PtgMemNoMem",f:rde},41:{n:"PtgMemFunc",f:Zue},42:{n:"PtgRefErr",f:Jue},43:{n:"PtgAreaErr",f:bue},44:{n:"PtgRefN",f:_ue},45:{n:"PtgAreaN",f:xue},46:{n:"PtgMemAreaN",f:wde},47:{n:"PtgMemNoMemN",f:Cde},57:{n:"PtgNameX",f:que},58:{n:"PtgRef3d",f:Lue},59:{n:"PtgArea3d",f:yue},60:{n:"PtgRefErr3d",f:ede},61:{n:"PtgAreaErr3d",f:Sue},255:{}},bde={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Sde={1:{n:"PtgElfLel",f:pN},2:{n:"PtgElfRw",f:dde},3:{n:"PtgElfCol",f:ide},6:{n:"PtgElfRwV",f:hde},7:{n:"PtgElfColV",f:ade},10:{n:"PtgElfRadical",f:lde},11:{n:"PtgElfRadicalS",f:ude},13:{n:"PtgElfColS",f:sde},15:{n:"PtgElfColSV",f:ode},16:{n:"PtgElfRadicalLel",f:cde},25:{n:"PtgList",f:gde},29:{n:"PtgSxName",f:pde},255:{}},xde={0:{n:"PtgAttrNoop",f:yde},1:{n:"PtgAttrSemi",f:Aue},2:{n:"PtgAttrIf",f:Fue},4:{n:"PtgAttrChoose",f:Rue},8:{n:"PtgAttrGoto",f:Tue},16:{n:"PtgAttrSum",f:Bue},32:{n:"PtgAttrBaxcel",f:sk},33:{n:"PtgAttrBaxcel",f:sk},64:{n:"PtgAttrSpace",f:kue},65:{n:"PtgAttrSpaceSemi",f:Pue},128:{n:"PtgAttrIfError",f:Due},255:{}};function Zf(e,t,r,n){if(n.biff<8)return Ln(e,t);for(var i=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=Yue(e,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=jue(e,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&s.push(Ln(e,t)),s}function Jf(e,t,r){for(var n=e.l+t,i,s,o=[];n!=e.l;)t=n-e.l,s=e[e.l],i=ok[s]||ok[bde[s]],(s===24||s===25)&&(i=(s===24?Sde:xde)[e[e.l+1]]),!i||!i.f?Ln(e,t):o.push([i.n,i.f(e,t,r)]);return o}function Ede(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var Rde={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Tde(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function mN(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ak(e,t,r){var n=mN(e,t,r);return n=="#REF"?n:Tde(n,r)}function Dn(e,t,r,n,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},a=[],u,d,h,g=0,m=0,v,w="";if(!e[0]||!e[0][0])return"";for(var C=-1,b="",x=0,R=e[0].length;x<R;++x){var E=e[0][x];switch(E[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=a.pop(),d=a.pop(),C>=0){switch(e[0][C][1][0]){case 0:b=Mr(" ",e[0][C][1][1]);break;case 1:b=Mr("\r",e[0][C][1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][C][1][0])}d=d+b,C=-1}a.push(d+Rde[E[0]]+u);break;case"PtgIsect":u=a.pop(),d=a.pop(),a.push(d+" "+u);break;case"PtgUnion":u=a.pop(),d=a.pop(),a.push(d+","+u);break;case"PtgRange":u=a.pop(),d=a.pop(),a.push(d+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=$h(E[1][1],o,i),a.push(jh(h,s));break;case"PtgRefN":h=r?$h(E[1][1],r,i):E[1][1],a.push(jh(h,s));break;case"PtgRef3d":g=E[1][1],h=$h(E[1][2],o,i),w=ak(n,g,i),a.push(w+"!"+jh(h,s));break;case"PtgFunc":case"PtgFuncVar":var A=E[1][0],D=E[1][1];A||(A=0),A&=127;var M=A==0?[]:a.slice(-A);a.length-=A,D==="User"&&(D=M.shift()),a.push(D+"("+M.join(",")+")");break;case"PtgBool":a.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(E[1]);break;case"PtgNum":a.push(String(E[1]));break;case"PtgStr":a.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(E[1]);break;case"PtgAreaN":v=OA(E[1][1],r?{s:r}:o,i),a.push(By(v,i));break;case"PtgArea":v=OA(E[1][1],o,i),a.push(By(v,i));break;case"PtgArea3d":g=E[1][1],v=E[1][2],w=ak(n,g,i),a.push(w+"!"+By(v,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=E[1][2];var F=(n.names||[])[m-1]||(n[0]||[])[m],O=F?F.Name:"SH33TJSNAME"+String(m);O&&O.slice(0,6)=="_xlfn."&&!i.xlfn&&(O=O.slice(6)),a.push(O);break;case"PtgNameX":var L=E[1][1];m=E[1][2];var W;if(i.biff<=5)L<0&&(L=-L),n[L]&&(W=n[L][m]);else{var I="";if(((n[L]||[])[0]||[])[0]==14849||(((n[L]||[])[0]||[])[0]==1025?n[L][m]&&n[L][m].itab>0&&(I=n.SheetNames[n[L][m].itab-1]+"!"):I=n.SheetNames[m-1]+"!"),n[L]&&n[L][m])I+=n[L][m].Name;else if(n[0]&&n[0][m])I+=n[0][m].Name;else{var G=(mN(n,L,i)||"").split(";;");G[m-1]?I=G[m-1]:I+="SH33TJSERRX"}a.push(I);break}W||(W={Name:"SH33TJSERRY"}),a.push(W.Name);break;case"PtgParen":var ne="(",ie=")";if(C>=0){switch(b="",e[0][C][1][0]){case 2:ne=Mr(" ",e[0][C][1][1])+ne;break;case 3:ne=Mr("\r",e[0][C][1][1])+ne;break;case 4:ie=Mr(" ",e[0][C][1][1])+ie;break;case 5:ie=Mr("\r",e[0][C][1][1])+ie;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][C][1][0])}C=-1}a.push(ne+a.pop()+ie);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":h={c:E[1][1],r:E[1][0]};var J={c:r.c,r:r.r};if(n.sharedf[pt(h)]){var _=n.sharedf[pt(h)];a.push(Dn(_,o,J,n,i))}else{var Y=!1;for(u=0;u!=n.arrayf.length;++u)if(d=n.arrayf[u],!(h.c<d[0].s.c||h.c>d[0].e.c)&&!(h.r<d[0].s.r||h.r>d[0].e.r)){a.push(Dn(d[1],o,J,n,i)),Y=!0;break}Y||a.push(E[1])}break;case"PtgArray":a.push("{"+Ede(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":C=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var Q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&C>=0&&Q.indexOf(e[0][x][0])==-1){E=e[0][C];var U=!0;switch(E[1][0]){case 4:U=!1;case 0:b=Mr(" ",E[1][1]);break;case 5:U=!1;case 1:b=Mr("\r",E[1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}a.push((U?b:"")+a.pop()+(U?"":b)),C=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function Fde(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],Ln(e,t-2)];var a=Jf(e,o,r);return t!==o+i&&(s=Zf(e,t-o-i,a,r)),e.l=n,[a,s]}function Dde(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],Ln(e,t-2)];var a=Jf(e,o,r);return t!==o+i&&(s=Zf(e,t-o-i,a,r)),e.l=n,[a,s]}function Ade(e,t,r,n){var i=e.l+t,s=Jf(e,n,r),o;return i!==e.l&&(o=Zf(e,i-e.l,s,r)),[s,o]}function kde(e,t,r){var n=e.l+t,i,s=e.read_shift(2),o=Jf(e,s,r);return s==65535?[[],Ln(e,t-2)]:(t!==s+2&&(i=Zf(e,n-s-2,o,r)),[o,i])}function Pde(e){var t;if(No(e,e.l+6)!==65535)return[Pn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Mde(e){if(e==null){var t=Re(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ac(e);return ac(0)}function Wy(e,t,r){var n=e.l+t,i=co(e);r.biff==2&&++e.l;var s=Pde(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var a=Dde(e,n-e.l,r);return{cell:i,val:s[0],formula:a,shared:o>>3&1,tt:s[1]}}function _de(e,t,r,n,i){var s=cc(t,r,i),o=Mde(e.v),a=Re(6),u=33;a.write_shift(2,u),a.write_shift(4,0);for(var d=Re(e.bf.length),h=0;h<e.bf.length;++h)d[h]=e.bf[h];var g=ln([s,o,a,d]);return g}function cv(e,t,r){var n=e.read_shift(4),i=Jf(e,n,r),s=e.read_shift(4),o=s>0?Zf(e,s,i,r):null;return[i,o]}var Lde=cv,uv=cv,Ide=cv,Ode=cv,Nde={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},vN={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Bde={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function lk(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Hde(e){var t="of:="+e.replace(w1,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Uy(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Gde(e){return e.replace(/\./,"!")}var Kh={},Wu={},qh=typeof Map<"u";function b1(e,t,r){var n=0,i=e.length;if(r){if(qh?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=qh?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(qh?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function dv(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(kn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Ff(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=sm(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function ql(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function al(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Uo(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function wN(e,t,r,n,i,s){try{n.cellNF&&(e.z=gt[t])}catch(a){if(n.WTF)throw a}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=mr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(gt[t]==null&&Uo(Nie[t]||"General",t),e.t==="e")e.w=e.w||na[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yf(e.v);else if(e.t==="d"){var o=rn(e.v);(o|0)===o?e.w=o.toString(10):e.w=yf(o)}else{if(e.v===void 0)return"";e.w=sc(e.v,Wu)}else e.t==="d"?e.w=ss(t,rn(e.v),Wu):e.w=ss(t,e.v,Wu)}catch(a){if(n.WTF)throw a}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=im(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=im(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(a){if(n.WTF&&s.Fills)throw a}}}function Vde(e,t,r){if(e&&e["!ref"]){var n=Ht(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function zde(e,t){var r=Ht(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=bt(r))}var Wde=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Ude=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,$de=/<(?:\w:)?hyperlink [^>]*>/mg,jde=/"(\w*:\w*)"/,Yde=/<(?:\w:)?col\b[^>]*[\/]?>/g,Kde=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,qde=/<(?:\w:)?pageMargins[^>]*\/>/g,CN=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Xde=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Qde=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Zde(e,t,r,n,i,s,o){if(!e)return e;n||(n={"!id":{}});var a=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",h="",g=e.match(Ude);g?(d=e.slice(0,g.index),h=e.slice(g.index+g[0].length)):d=h=e;var m=d.match(CN);m?S1(m[0],a,i,r):(m=d.match(Xde))&&ehe(m[0],m[1]||"",a,i,r);var v=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var w=d.slice(v,v+50).match(jde);w&&zde(a,w[1])}var C=d.match(Qde);C&&C[1]&&fhe(C[1],i);var b=[];if(t.cellStyles){var x=d.match(Yde);x&&lhe(b,x)}g&&mhe(g[1],a,t,u,s,o);var R=h.match(Kde);R&&(a["!autofilter"]=uhe(R[0]));var E=[],A=h.match(Wde);if(A)for(v=0;v!=A.length;++v)E[v]=Ht(A[v].slice(A[v].indexOf('"')+1));var D=h.match($de);D&&she(a,D,n);var M=h.match(qde);if(M&&(a["!margins"]=ohe(mt(M[0]))),!a["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(a["!ref"]=bt(u)),t.sheetRows>0&&a["!ref"]){var F=Ht(a["!ref"]);t.sheetRows<=+F.e.r&&(F.e.r=t.sheetRows-1,F.e.r>u.e.r&&(F.e.r=u.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>u.e.c&&(F.e.c=u.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),a["!fullref"]=a["!ref"],a["!ref"]=bt(F))}return b.length>0&&(a["!cols"]=b),E.length>0&&(a["!merges"]=E),a}function Jde(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+bt(e[r])+'"/>';return t+"</mergeCells>"}function S1(e,t,r,n){var i=mt(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Bt(sr(i.codeName)))}function ehe(e,t,r,n,i){S1(e.slice(0,e.indexOf(">")),r,n,i)}function the(e,t,r,n,i){var s=!1,o={},a=null;if(n.bookType!=="xlsx"&&t.vbaraw){var u=t.SheetNames[r];try{t.Workbook&&(u=t.Workbook.Sheets[r].CodeName||u)}catch{}s=!0,o.codeName=Xs(Jt(u))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),a=(a||"")+ze("outlinePr",null,d)}!s&&!a||(i[i.length]=ze("sheetPr",a,o))}var rhe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],nhe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function ihe(e){var t={sheet:1};return rhe.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),nhe.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=p1(e.password).toString(16).toUpperCase()),ze("sheetProtection",null,t)}function she(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=mt(sr(t[i]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+Bt(s.location))):(s.Target="#"+Bt(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var a=Ht(s.ref),u=a.s.r;u<=a.e.r;++u)for(var d=a.s.c;d<=a.e.c;++d){var h=pt({c:d,r:u});n?(e[u]||(e[u]=[]),e[u][d]||(e[u][d]={t:"z",v:void 0}),e[u][d].l=s):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=s)}}}function ohe(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function ahe(e){return ql(e),ze("pageMargins",null,e)}function lhe(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=mt(t[n],!0);i.hidden&&(i.hidden=pr(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,m1(i.width)),Xa(i);s<=o;)e[s++]=vr(i)}}function che(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=ze("col",null,dv(i,n)));return r[r.length]="</cols>",r.join("")}function uhe(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function dhe(e,t,r,n){var i=typeof e.ref=="string"?e.ref:bt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=di(i);o.s.r==o.e.r&&(o.e.r=di(t["!ref"]).e.r,i=bt(o));for(var a=0;a<s.length;++a){var u=s[a];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return a==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ze("autoFilter",null,{ref:i})}var hhe=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function fhe(e,t){t.Views||(t.Views=[{}]),(e.match(hhe)||[]).forEach(function(r,n){var i=mt(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),pr(i.rightToLeft)&&(t.Views[n].RTL=!0)})}function ghe(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ze("sheetViews",ze("sheetView",null,i),{})}function phe(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=na[e.v];break;case"d":n&&n.cellDates?i=mr(e.v,-1).toISOString():(e=vr(e),e.t="n",i=""+(e.v=rn(mr(e.v)))),typeof e.z>"u"&&(e.z=gt[14]);break;default:i=e.v;break}var a=Cn("v",Jt(i)),u={r:t},d=al(n.cellXfs,e,n);switch(d!==0&&(u.s=d),e.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){a=Cn("v",""+b1(n.Strings,e.v,n.revStrings)),u.t="s";break}u.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var h=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;a=ze("f",Jt(e.f),h)+(e.v!=null?a:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(u.cm=1),ze("c",a,u)}var mhe=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=bf("v"),o=bf("f");return function(u,d,h,g,m,v){for(var w=0,C="",b=[],x=[],R=0,E=0,A=0,D="",M,F,O=0,L=0,W,I,G=0,ne=0,ie=Array.isArray(v.CellXf),J,_=[],Y=[],Q=Array.isArray(d),U=[],se={},N=!1,P=!!h.sheetStubs,V=u.split(t),H=0,j=V.length;H!=j;++H){C=V[H].trim();var ae=C.length;if(ae!==0){var fe=0;e:for(w=0;w<ae;++w)switch(C[w]){case">":if(C[w-1]!="/"){++w;break e}if(h&&h.cellStyles){if(F=mt(C.slice(fe,w),!0),O=F.r!=null?parseInt(F.r,10):O+1,L=-1,h.sheetRows&&h.sheetRows<O)continue;se={},N=!1,F.ht&&(N=!0,se.hpt=parseFloat(F.ht),se.hpx=sd(se.hpt)),F.hidden=="1"&&(N=!0,se.hidden=!0),F.outlineLevel!=null&&(N=!0,se.level=+F.outlineLevel),N&&(U[O-1]=se)}break;case"<":fe=w;break}if(fe>=w)break;if(F=mt(C.slice(fe,w),!0),O=F.r!=null?parseInt(F.r,10):O+1,L=-1,!(h.sheetRows&&h.sheetRows<O)){g.s.r>O-1&&(g.s.r=O-1),g.e.r<O-1&&(g.e.r=O-1),h&&h.cellStyles&&(se={},N=!1,F.ht&&(N=!0,se.hpt=parseFloat(F.ht),se.hpx=sd(se.hpt)),F.hidden=="1"&&(N=!0,se.hidden=!0),F.outlineLevel!=null&&(N=!0,se.level=+F.outlineLevel),N&&(U[O-1]=se)),b=C.slice(w).split(e);for(var le=0;le!=b.length&&b[le].trim().charAt(0)=="<";++le);for(b=b.slice(le),w=0;w!=b.length;++w)if(C=b[w].trim(),C.length!==0){if(x=C.match(r),R=w,E=0,A=0,C="<c "+(C.slice(0,1)=="<"?">":"")+C,x!=null&&x.length===2){for(R=0,D=x[1],E=0;E!=D.length&&!((A=D.charCodeAt(E)-64)<1||A>26);++E)R=26*R+A;--R,L=R}else++L;for(E=0;E!=C.length&&C.charCodeAt(E)!==62;++E);if(++E,F=mt(C.slice(0,E),!0),F.r||(F.r=pt({r:O-1,c:L})),D=C.slice(E),M={t:""},(x=D.match(s))!=null&&x[1]!==""&&(M.v=Bt(x[1])),h.cellFormula){if((x=D.match(o))!=null&&x[1]!==""){if(M.f=Bt(sr(x[1])).replace(/\r\n/g,`
`),h.xlfn||(M.f=ik(M.f)),x[0].indexOf('t="array"')>-1)M.F=(D.match(i)||[])[1],M.F.indexOf(":")>-1&&_.push([Ht(M.F),M.F]);else if(x[0].indexOf('t="shared"')>-1){I=mt(x[0]);var de=Bt(sr(x[1]));h.xlfn||(de=ik(de)),Y[parseInt(I.si,10)]=[I,de,F.r]}}else(x=D.match(/<f[^>]*\/>/))&&(I=mt(x[0]),Y[I.si]&&(M.f=hue(Y[I.si][1],Y[I.si][2],F.r)));var ue=Tr(F.r);for(E=0;E<_.length;++E)ue.r>=_[E][0].s.r&&ue.r<=_[E][0].e.r&&ue.c>=_[E][0].s.c&&ue.c<=_[E][0].e.c&&(M.F=_[E][1])}if(F.t==null&&M.v===void 0)if(M.f||M.F)M.v=0,M.t="n";else if(P)M.t="z";else continue;else M.t=F.t||"n";switch(g.s.c>L&&(g.s.c=L),g.e.c<L&&(g.e.c=L),M.t){case"n":if(M.v==""||M.v==null){if(!P)continue;M.t="z"}else M.v=parseFloat(M.v);break;case"s":if(typeof M.v>"u"){if(!P)continue;M.t="z"}else W=Kh[parseInt(M.v,10)],M.v=W.t,M.r=W.r,h.cellHTML&&(M.h=W.h);break;case"str":M.t="s",M.v=M.v!=null?sr(M.v):"",h.cellHTML&&(M.h=e1(M.v));break;case"inlineStr":x=D.match(n),M.t="s",x!=null&&(W=g1(x[1]))?(M.v=W.t,h.cellHTML&&(M.h=W.h)):M.v="";break;case"b":M.v=pr(M.v);break;case"d":h.cellDates?M.v=mr(M.v,1):(M.v=rn(mr(M.v,1)),M.t="n");break;case"e":(!h||h.cellText!==!1)&&(M.w=M.v),M.v=bO[M.v];break}if(G=ne=0,J=null,ie&&F.s!==void 0&&(J=v.CellXf[F.s],J!=null&&(J.numFmtId!=null&&(G=J.numFmtId),h.cellStyles&&J.fillId!=null&&(ne=J.fillId))),wN(M,G,ne,h,m,v),h.cellDates&&ie&&M.t=="n"&&yd(gt[G])&&(M.t="d",M.v=av(M.v)),F.cm&&h.xlmeta){var Ie=(h.xlmeta.Cell||[])[+F.cm-1];Ie&&Ie.type=="XLDAPR"&&(M.D=!0)}if(Q){var q=Tr(F.r);d[q.r]||(d[q.r]=[]),d[q.r][q.c]=M}else d[F.r]=M}}}}U.length>0&&(d["!rows"]=U)}})();function vhe(e,t,r,n){var i=[],s=[],o=Ht(e["!ref"]),a="",u,d="",h=[],g=0,m=0,v=e["!rows"],w=Array.isArray(e),C={r:d},b,x=-1;for(m=o.s.c;m<=o.e.c;++m)h[m]=Rr(m);for(g=o.s.r;g<=o.e.r;++g){for(s=[],d=zr(g),m=o.s.c;m<=o.e.c;++m){u=h[m]+d;var R=w?(e[g]||[])[m]:e[u];R!==void 0&&(a=phe(R,u,e,t))!=null&&s.push(a)}(s.length>0||v&&v[g])&&(C={r:d},v&&v[g]&&(b=v[g],b.hidden&&(C.hidden=1),x=-1,b.hpx?x=Df(b.hpx):b.hpt&&(x=b.hpt),x>-1&&(C.ht=x,C.customHeight=1),b.level&&(C.outlineLevel=b.level)),i[i.length]=ze("row",s.join(""),C))}if(v)for(;g<v.length;++g)v&&v[g]&&(C={r:g+1},b=v[g],b.hidden&&(C.hidden=1),x=-1,b.hpx?x=Df(b.hpx):b.hpt&&(x=b.hpt),x>-1&&(C.ht=x,C.customHeight=1),b.level&&(C.outlineLevel=b.level),i[i.length]=ze("row","",C));return i.join("")}function yN(e,t,r,n){var i=[Wr,ze("worksheet",null,{xmlns:Cc[0],"xmlns:r":tn.r})],s=r.SheetNames[e],o=0,a="",u=r.Sheets[s];u==null&&(u={});var d=u["!ref"]||"A1",h=Ht(d);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),d=bt(h)}n||(n={}),u["!comments"]=[];var g=[];the(u,r,e,t,i),i[i.length]=ze("dimension",null,{ref:d}),i[i.length]=ghe(u,t,e,r),t.sheetFormat&&(i[i.length]=ze("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(i[i.length]=che(u,u["!cols"])),i[o=i.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(a=vhe(u,t),a.length>0&&(i[i.length]=a)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),u["!protect"]&&(i[i.length]=ihe(u["!protect"])),u["!autofilter"]!=null&&(i[i.length]=dhe(u["!autofilter"],u,r,e)),u["!merges"]!=null&&u["!merges"].length>0&&(i[i.length]=Jde(u["!merges"]));var m=-1,v,w=-1;return u["!links"].length>0&&(i[i.length]="<hyperlinks>",u["!links"].forEach(function(C){C[1].Target&&(v={ref:C[0]},C[1].Target.charAt(0)!="#"&&(w=Qt(n,-1,Jt(C[1].Target).replace(/#.*$/,""),Ft.HLINK),v["r:id"]="rId"+w),(m=C[1].Target.indexOf("#"))>-1&&(v.location=Jt(C[1].Target.slice(m+1))),C[1].Tooltip&&(v.tooltip=Jt(C[1].Tooltip)),i[i.length]=ze("hyperlink",null,v))}),i[i.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(i[i.length]=ahe(u["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=Cn("ignoredErrors",ze("ignoredError",null,{numberStoredAsText:1,sqref:d}))),g.length>0&&(w=Qt(n,-1,"../drawings/drawing"+(e+1)+".xml",Ft.DRAW),i[i.length]=ze("drawing",null,{"r:id":"rId"+w}),u["!drawing"]=g),u["!comments"].length>0&&(w=Qt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ft.VML),i[i.length]=ze("legacyDrawing",null,{"r:id":"rId"+w}),u["!legacy"]=w),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function whe(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function Che(e,t,r){var n=Re(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=Df(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var a=0,u=n.l;n.l+=4;for(var d={r:e,c:0},h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var g=-1,m=-1,v=h<<10;v<h+1<<10;++v){d.c=v;var w=Array.isArray(r)?(r[d.r]||[])[d.c]:r[pt(d)];w&&(g<0&&(g=v),m=v)}g<0||(++a,n.write_shift(4,g),n.write_shift(4,m))}var C=n.l;return n.l=u,n.write_shift(4,a),n.l=C,n.length>n.l?n.slice(0,n.l):n}function yhe(e,t,r,n){var i=Che(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&_e(e,0,i)}var bhe=xc,She=xd;function xhe(){}function Ehe(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Fse(e),r}function Rhe(e,t,r){r==null&&(r=Re(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return tm({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),mO(e,r),r.slice(0,r.l)}function The(e){var t=ds(e);return[t]}function Fhe(e,t,r){return r==null&&(r=Re(8)),yc(t,r)}function Dhe(e){var t=bc(e);return[t]}function Ahe(e,t,r){return r==null&&(r=Re(4)),Sc(t,r)}function khe(e){var t=ds(e),r=e.read_shift(1);return[t,r,"b"]}function Phe(e,t,r){return r==null&&(r=Re(9)),yc(t,r),r.write_shift(1,e.v?1:0),r}function Mhe(e){var t=bc(e),r=e.read_shift(1);return[t,r,"b"]}function _he(e,t,r){return r==null&&(r=Re(5)),Sc(t,r),r.write_shift(1,e.v?1:0),r}function Lhe(e){var t=ds(e),r=e.read_shift(1);return[t,r,"e"]}function Ihe(e,t,r){return r==null&&(r=Re(9)),yc(t,r),r.write_shift(1,e.v),r}function Ohe(e){var t=bc(e),r=e.read_shift(1);return[t,r,"e"]}function Nhe(e,t,r){return r==null&&(r=Re(8)),Sc(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Bhe(e){var t=ds(e),r=e.read_shift(4);return[t,r,"s"]}function Hhe(e,t,r){return r==null&&(r=Re(12)),yc(t,r),r.write_shift(4,t.v),r}function Ghe(e){var t=bc(e),r=e.read_shift(4);return[t,r,"s"]}function Vhe(e,t,r){return r==null&&(r=Re(8)),Sc(t,r),r.write_shift(4,t.v),r}function zhe(e){var t=ds(e),r=Pn(e);return[t,r,"n"]}function Whe(e,t,r){return r==null&&(r=Re(16)),yc(t,r),ac(e.v,r),r}function bN(e){var t=bc(e),r=Pn(e);return[t,r,"n"]}function Uhe(e,t,r){return r==null&&(r=Re(12)),Sc(t,r),ac(e.v,r),r}function $he(e){var t=ds(e),r=c1(e);return[t,r,"n"]}function jhe(e,t,r){return r==null&&(r=Re(12)),yc(t,r),vO(e.v,r),r}function Yhe(e){var t=bc(e),r=c1(e);return[t,r,"n"]}function Khe(e,t,r){return r==null&&(r=Re(8)),Sc(t,r),vO(e.v,r),r}function qhe(e){var t=ds(e),r=o1(e);return[t,r,"is"]}function Xhe(e){var t=ds(e),r=_n(e);return[t,r,"str"]}function Qhe(e,t,r){return r==null&&(r=Re(12+4*e.v.length)),yc(t,r),dn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Zhe(e){var t=bc(e),r=_n(e);return[t,r,"str"]}function Jhe(e,t,r){return r==null&&(r=Re(8+4*e.v.length)),Sc(t,r),dn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function efe(e,t,r){var n=e.l+t,i=ds(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"b"];if(r.cellFormula){e.l+=2;var a=uv(e,n-e.l,r);o[3]=Dn(a,null,i,r.supbooks,r)}else e.l=n;return o}function tfe(e,t,r){var n=e.l+t,i=ds(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"e"];if(r.cellFormula){e.l+=2;var a=uv(e,n-e.l,r);o[3]=Dn(a,null,i,r.supbooks,r)}else e.l=n;return o}function rfe(e,t,r){var n=e.l+t,i=ds(e);i.r=r["!row"];var s=Pn(e),o=[i,s,"n"];if(r.cellFormula){e.l+=2;var a=uv(e,n-e.l,r);o[3]=Dn(a,null,i,r.supbooks,r)}else e.l=n;return o}function nfe(e,t,r){var n=e.l+t,i=ds(e);i.r=r["!row"];var s=_n(e),o=[i,s,"str"];if(r.cellFormula){e.l+=2;var a=uv(e,n-e.l,r);o[3]=Dn(a,null,i,r.supbooks,r)}else e.l=n;return o}var ife=xc,sfe=xd;function ofe(e,t){return t==null&&(t=Re(4)),t.write_shift(4,e),t}function afe(e,t){var r=e.l+t,n=xc(e),i=a1(e),s=_n(e),o=_n(e),a=_n(e);e.l=r;var u={rfx:n,relId:i,loc:s,display:a};return o&&(u.Tooltip=o),u}function lfe(e,t){var r=Re(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));xd({s:Tr(e[0]),e:Tr(e[0])},r),l1("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return dn(i||"",r),dn(e[1].Tooltip||"",r),dn("",r),r.slice(0,r.l)}function cfe(){}function ufe(e,t,r){var n=e.l+t,i=wO(e),s=e.read_shift(1),o=[i];if(o[2]=s,r.cellFormula){var a=Lde(e,n-e.l,r);o[1]=a}else e.l=n;return o}function dfe(e,t,r){var n=e.l+t,i=xc(e),s=[i];if(r.cellFormula){var o=Ode(e,n-e.l,r);s[1]=o,e.l=n}else e.l=n;return s}function hfe(e,t,r){r==null&&(r=Re(18));var n=dv(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var SN=["left","right","top","bottom","header","footer"];function ffe(e){var t={};return SN.forEach(function(r){t[r]=Pn(e)}),t}function gfe(e,t){return t==null&&(t=Re(48)),ql(e),SN.forEach(function(r){ac(e[r],t)}),t}function pfe(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function mfe(e,t,r){r==null&&(r=Re(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function vfe(e){var t=Re(24);return t.write_shift(4,4),t.write_shift(4,1),xd(e,t),t}function wfe(e,t){return t==null&&(t=Re(66)),t.write_shift(2,e.password?p1(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Cfe(){}function yfe(){}function bfe(e,t,r,n,i,s,o){if(!e)return e;var a=t||{};n||(n={"!id":{}});var u=a.dense?[]:{},d,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,m=!1,v,w,C,b,x,R,E,A,D,M=[];a.biff=12,a["!row"]=0;var F=0,O=!1,L=[],W={},I=a.supbooks||i.supbooks||[[]];if(I.sharedf=W,I.arrayf=L,I.SheetNames=i.SheetNames||i.Sheets.map(function(Q){return Q.name}),!a.supbooks&&(a.supbooks=I,i.Names))for(var G=0;G<i.Names.length;++G)I[0][G+1]=i.Names[G];var ne=[],ie=[],J=!1;Af[16]={n:"BrtShortReal",f:bN};var _;if(ra(e,function(U,se,N){if(!m)switch(N){case 148:d=U;break;case 0:v=U,a.sheetRows&&a.sheetRows<=v.r&&(m=!0),A=zr(b=v.r),a["!row"]=v.r,(U.hidden||U.hpt||U.level!=null)&&(U.hpt&&(U.hpx=sd(U.hpt)),ie[U.r]=U);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:U[2]},U[2]){case"n":w.v=U[1];break;case"s":E=Kh[U[1]],w.v=E.t,w.r=E.r;break;case"b":w.v=!!U[1];break;case"e":w.v=U[1],a.cellText!==!1&&(w.w=na[w.v]);break;case"str":w.t="s",w.v=U[1];break;case"is":w.t="s",w.v=U[1].t;break}if((C=o.CellXf[U[0].iStyleRef])&&wN(w,C.numFmtId,null,a,s,o),x=U[0].c==-1?x+1:U[0].c,a.dense?(u[b]||(u[b]=[]),u[b][x]=w):u[Rr(x)+A]=w,a.cellFormula){for(O=!1,F=0;F<L.length;++F){var P=L[F];v.r>=P[0].s.r&&v.r<=P[0].e.r&&x>=P[0].s.c&&x<=P[0].e.c&&(w.F=bt(P[0]),O=!0)}!O&&U.length>3&&(w.f=U[3])}if(h.s.r>v.r&&(h.s.r=v.r),h.s.c>x&&(h.s.c=x),h.e.r<v.r&&(h.e.r=v.r),h.e.c<x&&(h.e.c=x),a.cellDates&&C&&w.t=="n"&&yd(gt[C.numFmtId])){var V=Nl(w.v);V&&(w.t="d",w.v=new Date(V.y,V.m-1,V.d,V.H,V.M,V.S,V.u))}_&&(_.type=="XLDAPR"&&(w.D=!0),_=void 0);break;case 1:case 12:if(!a.sheetStubs||g)break;w={t:"z",v:void 0},x=U[0].c==-1?x+1:U[0].c,a.dense?(u[b]||(u[b]=[]),u[b][x]=w):u[Rr(x)+A]=w,h.s.r>v.r&&(h.s.r=v.r),h.s.c>x&&(h.s.c=x),h.e.r<v.r&&(h.e.r=v.r),h.e.c<x&&(h.e.c=x),_&&(_.type=="XLDAPR"&&(w.D=!0),_=void 0);break;case 176:M.push(U);break;case 49:_=((a.xlmeta||{}).Cell||[])[U-1];break;case 494:var H=n["!id"][U.relId];for(H?(U.Target=H.Target,U.loc&&(U.Target+="#"+U.loc),U.Rel=H):U.relId==""&&(U.Target="#"+U.loc),b=U.rfx.s.r;b<=U.rfx.e.r;++b)for(x=U.rfx.s.c;x<=U.rfx.e.c;++x)a.dense?(u[b]||(u[b]=[]),u[b][x]||(u[b][x]={t:"z",v:void 0}),u[b][x].l=U):(R=pt({c:x,r:b}),u[R]||(u[R]={t:"z",v:void 0}),u[R].l=U);break;case 426:if(!a.cellFormula)break;L.push(U),D=a.dense?u[b][x]:u[Rr(x)+A],D.f=Dn(U[1],h,{r:v.r,c:x},I,a),D.F=bt(U[0]);break;case 427:if(!a.cellFormula)break;W[pt(U[0].s)]=U[1],D=a.dense?u[b][x]:u[Rr(x)+A],D.f=Dn(U[1],h,{r:v.r,c:x},I,a);break;case 60:if(!a.cellStyles)break;for(;U.e>=U.s;)ne[U.e--]={width:U.w/256,hidden:!!(U.flags&1),level:U.level},J||(J=!0,m1(U.w/256)),Xa(ne[U.e+1]);break;case 161:u["!autofilter"]={ref:bt(U)};break;case 476:u["!margins"]=U;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),U.name&&(i.Sheets[r].CodeName=U.name),(U.above||U.left)&&(u["!outline"]={above:U.above,left:U.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),U.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!se.T){if(!g||a.WTF)throw new Error("Unexpected record 0x"+N.toString(16))}}},a),delete a.supbooks,delete a["!row"],!u["!ref"]&&(h.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(u["!ref"]=bt(d||h)),a.sheetRows&&u["!ref"]){var Y=Ht(u["!ref"]);a.sheetRows<=+Y.e.r&&(Y.e.r=a.sheetRows-1,Y.e.r>h.e.r&&(Y.e.r=h.e.r),Y.e.r<Y.s.r&&(Y.s.r=Y.e.r),Y.e.c>h.e.c&&(Y.e.c=h.e.c),Y.e.c<Y.s.c&&(Y.s.c=Y.e.c),u["!fullref"]=u["!ref"],u["!ref"]=bt(Y))}return M.length>0&&(u["!merges"]=M),ne.length>0&&(u["!cols"]=ne),ie.length>0&&(u["!rows"]=ie),u}function Sfe(e,t,r,n,i,s,o){if(t.v===void 0)return!1;var a="";switch(t.t){case"b":a=t.v?"1":"0";break;case"d":t=vr(t),t.z=t.z||gt[14],t.v=rn(mr(t.v)),t.t="n";break;case"n":case"e":a=""+t.v;break;default:a=t.v;break}var u={r,c:n};switch(u.s=al(i.cellXfs,t,i),t.l&&s["!links"].push([pt(u),t.l]),t.c&&s["!comments"].push([pt(u),t.c]),t.t){case"s":case"str":return i.bookSST?(a=b1(i.Strings,t.v,i.revStrings),u.t="s",u.v=a,o?_e(e,18,Vhe(t,u)):_e(e,7,Hhe(t,u))):(u.t="str",o?_e(e,17,Jhe(t,u)):_e(e,6,Qhe(t,u))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?_e(e,13,Khe(t,u)):_e(e,2,jhe(t,u)):o?_e(e,16,Uhe(t,u)):_e(e,5,Whe(t,u)),!0;case"b":return u.t="b",o?_e(e,15,_he(t,u)):_e(e,4,Phe(t,u)),!0;case"e":return u.t="e",o?_e(e,14,Nhe(t,u)):_e(e,3,Ihe(t,u)),!0}return o?_e(e,12,Ahe(t,u)):_e(e,1,Fhe(t,u)),!0}function xfe(e,t,r,n){var i=Ht(t["!ref"]||"A1"),s,o="",a=[];_e(e,145);var u=Array.isArray(t),d=i.e.r;t["!rows"]&&(d=Math.max(i.e.r,t["!rows"].length-1));for(var h=i.s.r;h<=d;++h){o=zr(h),yhe(e,t,i,h);var g=!1;if(h<=i.e.r)for(var m=i.s.c;m<=i.e.c;++m){h===i.s.r&&(a[m]=Rr(m)),s=a[m]+o;var v=u?(t[h]||[])[m]:t[s];if(!v){g=!1;continue}g=Sfe(e,v,h,m,n,t,g)}}_e(e,146)}function Efe(e,t){!t||!t["!merges"]||(_e(e,177,ofe(t["!merges"].length)),t["!merges"].forEach(function(r){_e(e,176,sfe(r))}),_e(e,178))}function Rfe(e,t){!t||!t["!cols"]||(_e(e,390),t["!cols"].forEach(function(r,n){r&&_e(e,60,hfe(n,r))}),_e(e,391))}function Tfe(e,t){!t||!t["!ref"]||(_e(e,648),_e(e,649,vfe(Ht(t["!ref"]))),_e(e,650))}function Ffe(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=Qt(r,-1,n[1].Target.replace(/#.*$/,""),Ft.HLINK);_e(e,494,lfe(n,i))}}),delete t["!links"]}function Dfe(e,t,r,n){if(t["!comments"].length>0){var i=Qt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ft.VML);_e(e,551,l1("rId"+i)),t["!legacy"]=i}}function Afe(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:bt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,a=di(s);a.s.r==a.e.r&&(a.e.r=di(t["!ref"]).e.r,s=bt(a));for(var u=0;u<o.length;++u){var d=o[u];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+s;break}}u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),_e(e,161,xd(Ht(s))),_e(e,162)}}function kfe(e,t,r){_e(e,133),_e(e,137,mfe(t,r)),_e(e,138),_e(e,134)}function Pfe(e,t){t["!protect"]&&_e(e,535,wfe(t["!protect"]))}function Mfe(e,t,r,n){var i=oi(),s=r.SheetNames[e],o=r.Sheets[s]||{},a=s;try{r&&r.Workbook&&(a=r.Workbook.Sheets[e].CodeName||a)}catch{}var u=Ht(o["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],_e(i,129),(r.vbaraw||o["!outline"])&&_e(i,147,Rhe(a,o["!outline"])),_e(i,148,She(u)),kfe(i,o,r.Workbook),Rfe(i,o),xfe(i,o,e,t),Pfe(i,o),Afe(i,o,r,e),Efe(i,o),Ffe(i,o,n),o["!margins"]&&_e(i,476,gfe(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Tfe(i,o),Dfe(i,o,e,n),_e(i,130),i.end()}function _fe(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=Bt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function Lfe(e,t,r,n,i,s){var o=s||{"!type":"chart"};if(!e)return s;var a=0,u=0,d="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var m=_fe(g);h.s.r=h.s.c=0,h.e.c=a,d=Rr(a),m[0].forEach(function(v,w){o[d+zr(w)]={t:"n",v,z:m[1]},u=w}),h.e.r<u&&(h.e.r=u),++a}),a>0&&(o["!ref"]=bt(h)),o}function Ife(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,a=e.match(CN);return a&&S1(a[0],s,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Ofe(e,t){e.l+=10;var r=_n(e);return{name:r}}function Nfe(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return ra(e,function(u,d,h){switch(h){case 550:s["!rel"]=u;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),u.name&&(i.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var x1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Bfe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Hfe=[],Gfe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function ck(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=pr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function uk(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=pr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function xN(e){uk(e.WBProps,x1),uk(e.CalcPr,Gfe),ck(e.WBView,Bfe),ck(e.Sheets,Hfe),Wu.date1904=pr(e.WBProps.date1904)}function Vfe(e){return!e.Workbook||!e.Workbook.WBProps?"false":pr(e.Workbook.WBProps.date1904)?"true":"false"}var zfe="][*?/\\".split("");function EN(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return zfe.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Wfe(e,t,r){e.forEach(function(n,i){EN(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[i]&&t[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Ufe(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Wfe(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Vde(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var $fe=/<\w+:workbook/;function jfe(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},o=0;if(e.replace(Nn,function(u,d){var h=mt(u);switch(lo(h[0])){case"<?xml":break;case"<workbook":u.match($fe)&&(i="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=h[i];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":x1.forEach(function(g){if(h[g[0]]!=null)switch(g[2]){case"bool":r.WBProps[g[0]]=pr(h[g[0]]);break;case"int":r.WBProps[g[0]]=parseInt(h[g[0]],10);break;default:r.WBProps[g[0]]=h[g[0]]}}),h.codeName&&(r.WBProps.CodeName=sr(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=Bt(sr(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=sr(h.name),h.comment&&(s.Comment=h.comment),h.localSheetId&&(s.Sheet=+h.localSheetId),pr(h.hidden||"0")&&(s.Hidden=!0),o=d+u.length;break;case"</definedName>":s.Ref=Bt(sr(e.slice(o,d))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return u}),Cc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return xN(r),r}function RN(e){var t=[Wr];t[t.length]=ze("workbook",null,{xmlns:Cc[0],"xmlns:r":tn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(x1.forEach(function(a){e.Workbook.WBProps[a[0]]!=null&&e.Workbook.WBProps[a[0]]!=a[1]&&(n[a[0]]=e.Workbook.WBProps[a[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ze("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:Jt(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=ze("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(a){var u={name:a.Name};a.Comment&&(u.comment=a.Comment),a.Sheet!=null&&(u.localSheetId=""+a.Sheet),a.Hidden&&(u.hidden="1"),a.Ref&&(t[t.length]=ze("definedName",Jt(a.Ref),u))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Yfe(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Jb(e),r.name=_n(e),r}function Kfe(e,t){return t||(t=Re(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),l1(e.strRelID,t),dn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function qfe(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?_n(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Xfe(e,t){t||(t=Re(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),mO(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Qfe(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Zfe(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=Dse(e),o=Ide(e,0,r),a=a1(e);e.l=n;var u={Name:s,Ptg:o};return i<268435455&&(u.Sheet=i),a&&(u.Comment=a),u}function Jfe(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],Af[16]={n:"BrtFRTArchID$",f:Qfe},ra(e,function(u,d,h){switch(h){case 156:o.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=Dn(u.Ptg,null,null,o,t),delete t.SID,delete u.Ptg,s.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([h,u]):o[0]=[h,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(h),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!d.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),xN(r),r.Names=s,r.supbooks=o,r}function ege(e,t){_e(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};_e(e,156,Kfe(i))}_e(e,144)}function tge(e,t){t||(t=Re(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return dn("SheetJS",t),dn(K0.version,t),dn(K0.version,t),dn("7262",t),t.length>t.l?t.slice(0,t.l):t}function rge(e,t){t||(t=Re(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function nge(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(_e(e,135),_e(e,158,rge(i)),_e(e,136))}}function ige(e,t){var r=oi();return _e(r,131),_e(r,128,tge()),_e(r,153,Xfe(e.Workbook&&e.Workbook.WBProps||null)),nge(r,e),ege(r,e),_e(r,132),r.end()}function sge(e,t,r){return t.slice(-4)===".bin"?Jfe(e,r):jfe(e,r)}function oge(e,t,r,n,i,s,o,a){return t.slice(-4)===".bin"?bfe(e,n,r,i,s,o,a):Zde(e,n,r,i,s,o,a)}function age(e,t,r,n,i,s,o,a){return t.slice(-4)===".bin"?Nfe(e,n,r,i,s):Ife(e,n,r,i,s)}function lge(e,t,r,n,i,s,o,a){return t.slice(-4)===".bin"?uue():due()}function cge(e,t,r,n,i,s,o,a){return t.slice(-4)===".bin"?lue():cue()}function uge(e,t,r,n){return t.slice(-4)===".bin"?sce(e,r,n):Yle(e,r,n)}function dge(e,t,r){return sN(e,r)}function hge(e,t,r){return t.slice(-4)===".bin"?hle(e,r):cle(e,r)}function fge(e,t,r){return t.slice(-4)===".bin"?nue(e,r):Kce(e,r)}function gge(e,t,r){return t.slice(-4)===".bin"?$ce(e):Wce(e)}function pge(e,t,r,n){return r.slice(-4)===".bin"?jce(e,t,r,n):void 0}function mge(e,t,r){return t.slice(-4)===".bin"?Gce(e,t,r):zce(e,t,r)}function vge(e,t,r){return(t.slice(-4)===".bin"?ige:RN)(e)}function wge(e,t,r,n,i){return(t.slice(-4)===".bin"?Mfe:yN)(e,r,n,i)}function Cge(e,t,r){return(t.slice(-4)===".bin"?pce:nN)(e,r)}function yge(e,t,r){return(t.slice(-4)===".bin"?ple:qO)(e,r)}function bge(e,t,r){return(t.slice(-4)===".bin"?iue:lN)(e)}function Sge(e){return(e.slice(-4)===".bin"?Vce:oN)()}var TN=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,FN=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ms(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(TN),s,o,a,u;if(i)for(u=0;u!=i.length;++u)s=i[u].match(FN),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(o+1),n[a]=s[2].slice(1,s[2].length-1));return n}function xge(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(TN),i,s,o,a;if(n)for(a=0;a!=n.length;++a)i=n[a].match(FN),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),r[o]=i[2].slice(1,i[2].length-1));return r}var Xh;function Ege(e,t){var r=Xh[e]||Bt(e);return r==="General"?sc(t):ss(r,t)}function Rge(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=pr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=mr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Bt(t)]=i}function Tge(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||na[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yf(e.v):e.w=sc(e.v):e.w=Ege(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Xh[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&yd(n)){var i=Nl(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function Fge(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Hle[n.Pattern]||n.Pattern)}e[t.ID]=t}function Dge(e,t,r,n,i,s,o,a,u,d){var h="General",g=n.StyleID,m={};d=d||{};var v=[],w=0;for(g===void 0&&a&&(g=a.StyleID),g===void 0&&o&&(g=o.StyleID);s[g]!==void 0&&(s[g].nf&&(h=s[g].nf),s[g].Interior&&v.push(s[g].Interior),!!s[g].Parent);)g=s[g].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=pr(e);break;case"String":n.t="s",n.r=FA(Bt(e)),n.v=e.indexOf("<")>-1?Bt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(mr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Bt(e):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=bO[e],d.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=FA(t||e));break}if(Tge(n,h,d),d.cellFormula!==!1)if(n.Formula){var C=Bt(n.Formula);C.charCodeAt(0)==61&&(C=C.slice(1)),n.f=zu(C,i),delete n.Formula,n.ArrayRange=="RC"?n.F=zu("RC:RC",i):n.ArrayRange&&(n.F=zu(n.ArrayRange,i),u.push([Ht(n.F),n.F]))}else for(w=0;w<u.length;++w)i.r>=u[w][0].s.r&&i.r<=u[w][0].e.r&&i.c>=u[w][0].s.c&&i.c<=u[w][0].e.c&&(n.F=u[w][1]);d.cellStyles&&(v.forEach(function(b){!m.patternType&&b.patternType&&(m.patternType=b.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Age(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function $y(e,t){var r=t||{};bd();var n=kh(t1(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=sr(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=vr(r);return o.type="string",id.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(nt){i.indexOf("<"+nt)>=0&&(s=!0)}),s)return gpe(n,r);Xh={"General Number":"General","General Date":gt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":gt[15],"Short Date":gt[14],"Long Time":gt[19],"Medium Time":gt[18],"Short Time":gt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:gt[2],Standard:gt[4],Percent:gt[10],Scientific:gt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var a,u=[],d,h={},g=[],m=r.dense?[]:{},v="",w={},C={},b=ms('<Data ss:Type="String">'),x=0,R=0,E=0,A={s:{r:2e6,c:2e6},e:{r:0,c:0}},D={},M={},F="",O=0,L=[],W={},I={},G=0,ne=[],ie=[],J={},_=[],Y,Q=!1,U=[],se=[],N={},P=0,V=0,H={Sheets:[],WBProps:{date1904:!1}},j={};xf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ae="";a=xf.exec(n);)switch(a[3]=(ae=a[3]).toLowerCase()){case"data":if(ae=="data"){if(a[1]==="/"){if((d=u.pop())[0]!==a[3])throw new Error("Bad state: "+d.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&u.push([a[3],!0]);break}if(u[u.length-1][1])break;a[1]==="/"?Dge(n.slice(x,a.index),F,b,u[u.length-1][0]=="comment"?J:w,{c:R,r:E},D,_[R],C,U,r):(F="",b=ms(a[0]),x=a.index+a[0].length);break;case"cell":if(a[1]==="/")if(ie.length>0&&(w.c=ie),(!r.sheetRows||r.sheetRows>E)&&w.v!==void 0&&(r.dense?(m[E]||(m[E]=[]),m[E][R]=w):m[Rr(R)+zr(E)]=w),w.HRef&&(w.l={Target:Bt(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(P=R+(parseInt(w.MergeAcross,10)|0),V=E+(parseInt(w.MergeDown,10)|0),L.push({s:{c:R,r:E},e:{c:P,r:V}})),!r.sheetStubs)w.MergeAcross?R=P+1:++R;else if(w.MergeAcross||w.MergeDown){for(var fe=R;fe<=P;++fe)for(var le=E;le<=V;++le)(fe>R||le>E)&&(r.dense?(m[le]||(m[le]=[]),m[le][fe]={t:"z"}):m[Rr(fe)+zr(le)]={t:"z"});R=P+1}else++R;else w=xge(a[0]),w.Index&&(R=+w.Index-1),R<A.s.c&&(A.s.c=R),R>A.e.c&&(A.e.c=R),a[0].slice(-2)==="/>"&&++R,ie=[];break;case"row":a[1]==="/"||a[0].slice(-2)==="/>"?(E<A.s.r&&(A.s.r=E),E>A.e.r&&(A.e.r=E),a[0].slice(-2)==="/>"&&(C=ms(a[0]),C.Index&&(E=+C.Index-1)),R=0,++E):(C=ms(a[0]),C.Index&&(E=+C.Index-1),N={},(C.AutoFitHeight=="0"||C.Height)&&(N.hpx=parseInt(C.Height,10),N.hpt=Df(N.hpx),se[E]=N),C.Hidden=="1"&&(N.hidden=!0,se[E]=N));break;case"worksheet":if(a[1]==="/"){if((d=u.pop())[0]!==a[3])throw new Error("Bad state: "+d.join("|"));g.push(v),A.s.r<=A.e.r&&A.s.c<=A.e.c&&(m["!ref"]=bt(A),r.sheetRows&&r.sheetRows<=A.e.r&&(m["!fullref"]=m["!ref"],A.e.r=r.sheetRows-1,m["!ref"]=bt(A))),L.length&&(m["!merges"]=L),_.length>0&&(m["!cols"]=_),se.length>0&&(m["!rows"]=se),h[v]=m}else A={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=R=0,u.push([a[3],!1]),d=ms(a[0]),v=Bt(d.Name),m=r.dense?[]:{},L=[],U=[],se=[],j={name:v,Hidden:0},H.Sheets.push(j);break;case"table":if(a[1]==="/"){if((d=u.pop())[0]!==a[3])throw new Error("Bad state: "+d.join("|"))}else{if(a[0].slice(-2)=="/>")break;u.push([a[3],!1]),_=[],Q=!1}break;case"style":a[1]==="/"?Fge(D,M,r):M=ms(a[0]);break;case"numberformat":M.nf=Bt(ms(a[0]).Format||"General"),Xh[M.nf]&&(M.nf=Xh[M.nf]);for(var de=0;de!=392&&gt[de]!=M.nf;++de);if(de==392){for(de=57;de!=392;++de)if(gt[de]==null){Uo(M.nf,de);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(Y=ms(a[0]),Y.Hidden&&(Y.hidden=!0,delete Y.Hidden),Y.Width&&(Y.wpx=parseInt(Y.Width,10)),!Q&&Y.wpx>10){Q=!0,kn=tN;for(var ue=0;ue<_.length;++ue)_[ue]&&Xa(_[ue])}Q&&Xa(Y),_[Y.Index-1||_.length]=Y;for(var Ie=0;Ie<+Y.Span;++Ie)_[_.length]=vr(Y);break;case"namedrange":if(a[1]==="/")break;H.Names||(H.Names=[]);var q=mt(a[0]),Ge={Name:q.Name,Ref:zu(q.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(Ge.Sheet=H.Sheets.length-1),H.Names.push(Ge);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(a[0].slice(-2)==="/>")break;a[1]==="/"?F+=n.slice(O,a.index):O=a.index+a[0].length;break;case"interior":if(!r.cellStyles)break;M.Interior=ms(a[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(a[0].slice(-2)==="/>")break;a[1]==="/"?Jse(W,ae,n.slice(G,a.index)):G=a.index+a[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(a[1]==="/"){if((d=u.pop())[0]!==a[3])throw new Error("Bad state: "+d.join("|"))}else u.push([a[3],!1]);break;case"comment":if(a[1]==="/"){if((d=u.pop())[0]!==a[3])throw new Error("Bad state: "+d.join("|"));Age(J),ie.push(J)}else u.push([a[3],!1]),d=ms(a[0]),J={a:d.Author};break;case"autofilter":if(a[1]==="/"){if((d=u.pop())[0]!==a[3])throw new Error("Bad state: "+d.join("|"))}else if(a[0].charAt(a[0].length-2)!=="/"){var Ye=ms(a[0]);m["!autofilter"]={ref:zu(Ye.Range).replace(/\$/g,"")},u.push([a[3],!0])}break;case"name":break;case"datavalidation":if(a[1]==="/"){if((d=u.pop())[0]!==a[3])throw new Error("Bad state: "+d.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&u.push([a[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(a[1]==="/"){if((d=u.pop())[0]!==a[3])throw new Error("Bad state: "+d.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&u.push([a[3],!0]);break;case"null":break;default:if(u.length==0&&a[3]=="document"||u.length==0&&a[3]=="uof")return pk(n,r);var Ze=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ze=!1}break;case"componentoptions":switch(a[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ze=!1}break;case"excelworkbook":switch(a[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ze=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":break;case"height":break;case"width":break;default:Ze=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if(a[0].slice(-2)!=="/>")if(a[1]==="/")switch(n.slice(G,a.index)){case"SheetHidden":j.Hidden=1;break;case"SheetVeryHidden":j.Hidden=2;break}else G=a.index+a[0].length;break;case"header":m["!margins"]||ql(m["!margins"]={},"xlml"),isNaN(+mt(a[0]).Margin)||(m["!margins"].header=+mt(a[0]).Margin);break;case"footer":m["!margins"]||ql(m["!margins"]={},"xlml"),isNaN(+mt(a[0]).Margin)||(m["!margins"].footer=+mt(a[0]).Margin);break;case"pagemargins":var ke=mt(a[0]);m["!margins"]||ql(m["!margins"]={},"xlml"),isNaN(+ke.Top)||(m["!margins"].top=+ke.Top),isNaN(+ke.Left)||(m["!margins"].left=+ke.Left),isNaN(+ke.Right)||(m["!margins"].right=+ke.Right),isNaN(+ke.Bottom)||(m["!margins"].bottom=+ke.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ze=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ze=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ze=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ze=!1}break;case"querytable":switch(a[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ze=!1}break;case"datavalidation":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ze=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ze=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ze=!1}break;case"smarttags":break;default:Ze=!1;break}if(Ze||a[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(a[0].slice(-2)==="/>")break;a[1]==="/"?Rge(I,ae,ne,n.slice(G,a.index)):(ne=a,G=a.index+a[0].length);break}if(r.WTF)throw"Unrecognized tag: "+a[3]+"|"+u.join("|")}var De={};return!r.bookSheets&&!r.bookProps&&(De.Sheets=h),De.SheetNames=g,De.Workbook=H,De.SSF=vr(gt),De.Props=W,De.Custprops=I,De}function oS(e,t){switch(R1(t=t||{}),t.type||"base64"){case"base64":return $y(Ai(e),t);case"binary":case"buffer":case"file":return $y(e,t);case"array":return $y(sl(e),t)}}function kge(e,t){var r=[];return e.Props&&r.push(eoe(e.Props,t)),e.Custprops&&r.push(toe(e.Props,e.Custprops)),r.join("")}function Pge(){return""}function Mge(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(ze("NumberFormat",null,{"ss:Format":Jt(gt[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(ze("Style",s.join(""),o))}),ze("Styles",r.join(""))}function DN(e){return ze("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+C1(e.Ref,{r:0,c:0})})}function _ge(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(DN(i)))}return ze("Names",r.join(""))}function Lge(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],o=0;o<i.length;++o){var a=i[o];a.Sheet==r&&(a.Name.match(/^_xlfn\./)||s.push(DN(a)))}return s.join("")}function Ige(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(ze("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(ze("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(ze("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(ze("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(Cn("ProtectContents","True")),e["!protect"].objects&&i.push(Cn("ProtectObjects","True")),e["!protect"].scenarios&&i.push(Cn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(Cn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(Cn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":ze("WorksheetOptions",i.join(""),{xmlns:yi.x})}function Oge(e){return e.map(function(t){var r=nse(t.t||""),n=ze("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ze("Comment",n,{"ss:Author":t.a})}).join("")}function Nge(e,t,r,n,i,s,o){if(!e||e.v==null&&e.f==null)return"";var a={};if(e.f&&(a["ss:Formula"]="="+Jt(C1(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var u=Tr(e.F.slice(t.length+1));a["ss:ArrayRange"]="RC:R"+(u.r==o.r?"":"["+(u.r-o.r)+"]")+"C"+(u.c==o.c?"":"["+(u.c-o.c)+"]")}if(e.l&&e.l.Target&&(a["ss:HRef"]=Jt(e.l.Target),e.l.Tooltip&&(a["x:HRefScreenTip"]=Jt(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],h=0;h!=d.length;++h)d[h].s.c!=o.c||d[h].s.r!=o.r||(d[h].e.c>d[h].s.c&&(a["ss:MergeAcross"]=d[h].e.c-d[h].s.c),d[h].e.r>d[h].s.r&&(a["ss:MergeDown"]=d[h].e.r-d[h].s.r));var g="",m="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":g="Number",m=String(e.v);break;case"b":g="Boolean",m=e.v?"1":"0";break;case"e":g="Error",m=na[e.v];break;case"d":g="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||gt[14]);break;case"s":g="String",m=rse(e.v||"");break}var v=al(n.cellXfs,e,n);a["ss:StyleID"]="s"+(21+v),a["ss:Index"]=o.c+1;var w=e.v!=null?m:"",C=e.t=="z"?"":'<Data ss:Type="'+g+'">'+w+"</Data>";return(e.c||[]).length>0&&(C+=Oge(e.c)),ze("Cell",C,a)}function Bge(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=sd(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Hge(e,t,r,n){if(!e["!ref"])return"";var i=Ht(e["!ref"]),s=e["!merges"]||[],o=0,a=[];e["!cols"]&&e["!cols"].forEach(function(b,x){Xa(b);var R=!!b.width,E=dv(x,b),A={"ss:Index":x+1};R&&(A["ss:Width"]=Tf(E.width)),b.hidden&&(A["ss:Hidden"]="1"),a.push(ze("Column",null,A))});for(var u=Array.isArray(e),d=i.s.r;d<=i.e.r;++d){for(var h=[Bge(d,(e["!rows"]||[])[d])],g=i.s.c;g<=i.e.c;++g){var m=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>g)&&!(s[o].s.r>d)&&!(s[o].e.c<g)&&!(s[o].e.r<d)){(s[o].s.c!=g||s[o].s.r!=d)&&(m=!0);break}if(!m){var v={r:d,c:g},w=pt(v),C=u?(e[d]||[])[g]:e[w];h.push(Nge(C,w,e,t,r,n,v))}}h.push("</Row>"),h.length>2&&a.push(h.join(""))}return a.join("")}function Gge(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],o=s?Lge(s,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?Hge(s,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(Ige(s,t,e,r)),n.join("")}function Vge(e,t){t||(t={}),e.SSF||(e.SSF=vr(gt)),e.SSF&&(bd(),iv(e.SSF),t.revssf=ov(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],al(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(kge(e,t)),r.push(Pge()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(ze("Worksheet",Gge(n,t,e),{"ss:Name":Jt(e.SheetNames[n])}));return r[2]=Mge(e,t),r[3]=_ge(e),Wr+ze("Workbook",r.join(""),{xmlns:yi.ss,"xmlns:o":yi.o,"xmlns:x":yi.x,"xmlns:ss":yi.ss,"xmlns:dt":yi.dt,"xmlns:html":yi.html})}function zge(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=_se(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Lse(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Wge=[60,1084,2066,2165,2175];function Uge(e,t,r,n,i){var s=n,o=[],a=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&a.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(a)}o.push(a),r.l+=s;for(var u=No(r,r.l),d=aS[u],h=0;d!=null&&Wge.indexOf(u)>-1;)s=No(r,r.l+2),h=r.l+4,u==2066?h+=4:(u==2165||u==2175)&&(h+=12),a=r.slice(h,r.l+4+s),o.push(a),r.l+=4+s,d=aS[u=No(r,r.l)];var g=ln(o);wn(g,0);var m=0;g.lens=[];for(var v=0;v<o.length;++v)g.lens.push(m),m+=o[v].length;if(g.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+g.length+" < "+n;return t.f(g,g.length,i)}function Hs(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=gt[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||na[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yf(e.v):e.w=sc(e.v):e.w=ss(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&yd(gt[n]||String(n))){var i=Nl(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function $p(e,t,r){return{v:e,ixfe:t,t:r}}function $ge(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},o={},a=null,u=[],d="",h={},g,m="",v,w,C,b,x={},R=[],E,A,D=[],M=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},O={},L=function(ht){return ht<8?jl[ht]:ht<64&&M[ht-8]||jl[ht]},W=function(ht,jt,Tt){var It=jt.XF.data;if(!(!It||!It.patternType||!Tt||!Tt.cellStyles)){jt.s={},jt.s.patternType=It.patternType;var lr;(lr=Rf(L(It.icvFore)))&&(jt.s.fgColor={rgb:lr}),(lr=Rf(L(It.icvBack)))&&(jt.s.bgColor={rgb:lr})}},I=function(ht,jt,Tt){if(!(N>1)&&!(Tt.sheetRows&&ht.r>=Tt.sheetRows)){if(Tt.cellStyles&&jt.XF&&jt.XF.data&&W(ht,jt,Tt),delete jt.ixfe,delete jt.XF,g=ht,m=pt(ht),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ht.r<o.s.r&&(o.s.r=ht.r),ht.c<o.s.c&&(o.s.c=ht.c),ht.r+1>o.e.r&&(o.e.r=ht.r+1),ht.c+1>o.e.c&&(o.e.c=ht.c+1),Tt.cellFormula&&jt.f){for(var It=0;It<R.length;++It)if(!(R[It][0].s.c>ht.c||R[It][0].s.r>ht.r)&&!(R[It][0].e.c<ht.c||R[It][0].e.r<ht.r)){jt.F=bt(R[It][0]),(R[It][0].s.c!=ht.c||R[It][0].s.r!=ht.r)&&delete jt.f,jt.f&&(jt.f=""+Dn(R[It][1],o,ht,U,G));break}}Tt.dense?(i[ht.r]||(i[ht.r]=[]),i[ht.r][ht.c]=jt):i[m]=jt}},G={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:R,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(G.password=t.password);var ne,ie=[],J=[],_=[],Y=[],Q=!1,U=[];U.SheetNames=G.snames,U.sharedf=G.sharedf,U.arrayf=G.arrayf,U.names=[],U.XTI=[];var se=0,N=0,P=0,V=[],H=[],j;G.codepage=1200,Cs(1200);for(var ae=!1;e.l<e.length-1;){var fe=e.l,le=e.read_shift(2);if(le===0&&se===10)break;var de=e.l===e.length?0:e.read_shift(2),ue=aS[le];if(ue&&ue.f){if(t.bookSheets&&se===133&&le!==133)break;if(se=le,ue.r===2||ue.r==12){var Ie=e.read_shift(2);if(de-=2,!G.enc&&Ie!==le&&((Ie&255)<<8|Ie>>8)!==le)throw new Error("rt mismatch: "+Ie+"!="+le);ue.r==12&&(e.l+=10,de-=10)}var q={};if(le===10?q=ue.f(e,de,G):q=Uge(le,ue,e,de,G),N==0&&[9,521,1033,2057].indexOf(se)===-1)continue;switch(le){case 34:r.opts.Date1904=F.WBProps.date1904=q;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(G.enc||(e.l=0),G.enc=q,!t.password)throw new Error("File is password-protected");if(q.valid==null)throw new Error("Encryption scheme unsupported");if(!q.valid)throw new Error("Password is incorrect");break;case 92:G.lastuser=q;break;case 66:var Ge=Number(q);switch(Ge){case 21010:Ge=1200;break;case 32768:Ge=1e4;break;case 32769:Ge=1252;break}Cs(G.codepage=Ge),ae=!0;break;case 317:G.rrtabid=q;break;case 25:G.winlocked=q;break;case 439:r.opts.RefreshAll=q;break;case 12:r.opts.CalcCount=q;break;case 16:r.opts.CalcDelta=q;break;case 17:r.opts.CalcIter=q;break;case 13:r.opts.CalcMode=q;break;case 14:r.opts.CalcPrecision=q;break;case 95:r.opts.CalcSaveRecalc=q;break;case 15:G.CalcRefMode=q;break;case 2211:r.opts.FullCalc=q;break;case 129:q.fDialog&&(i["!type"]="dialog"),q.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),q.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:D.push(q);break;case 430:U.push([q]),U[U.length-1].XTI=[];break;case 35:case 547:U[U.length-1].push(q);break;case 24:case 536:j={Name:q.Name,Ref:Dn(q.rgce,o,null,U,G)},q.itab>0&&(j.Sheet=q.itab-1),U.names.push(j),U[0]||(U[0]=[],U[0].XTI=[]),U[U.length-1].push(q),q.Name=="_xlnm._FilterDatabase"&&q.itab>0&&q.rgce&&q.rgce[0]&&q.rgce[0][0]&&q.rgce[0][0][0]=="PtgArea3d"&&(H[q.itab-1]={ref:bt(q.rgce[0][0][1][2])});break;case 22:G.ExternCount=q;break;case 23:U.length==0&&(U[0]=[],U[0].XTI=[]),U[U.length-1].XTI=U[U.length-1].XTI.concat(q),U.XTI=U.XTI.concat(q);break;case 2196:if(G.biff<8)break;j!=null&&(j.Comment=q[1]);break;case 18:i["!protect"]=q;break;case 19:q!==0&&G.WTF&&console.error("Password verifier: "+q);break;case 133:s[q.pos]=q,G.snames.push(q.name);break;case 10:{if(--N)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=bt(o),t.sheetRows&&t.sheetRows<=o.e.r){var Ye=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=bt(o),o.e.r=Ye}o.e.r++,o.e.c++}ie.length>0&&(i["!merges"]=ie),J.length>0&&(i["!objects"]=J),_.length>0&&(i["!cols"]=_),Y.length>0&&(i["!rows"]=Y),F.Sheets.push(O)}d===""?h=i:n[d]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(G.biff===8&&(G.biff={9:2,521:3,1033:4}[le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8),G.biffguess=q.BIFFVer==0,q.BIFFVer==0&&q.dt==4096&&(G.biff=5,ae=!0,Cs(G.codepage=28591)),G.biff==8&&q.BIFFVer==0&&q.dt==16&&(G.biff=2),N++)break;if(i=t.dense?[]:{},G.biff<8&&!ae&&(ae=!0,Cs(G.codepage=t.codepage||1252)),G.biff<5||q.BIFFVer==0&&q.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Ze={pos:e.l-de,name:d};s[Ze.pos]=Ze,G.snames.push(d)}else d=(s[fe]||{name:""}).name;q.dt==32&&(i["!type"]="chart"),q.dt==64&&(i["!type"]="macro"),ie=[],J=[],G.arrayf=R=[],_=[],Y=[],Q=!1,O={Hidden:(s[fe]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[q.r]||[])[q.c]:i[pt({c:q.c,r:q.r})])&&++q.c,E={ixfe:q.ixfe,XF:D[q.ixfe]||{},v:q.val,t:"n"},P>0&&(E.z=V[E.ixfe>>8&63]),Hs(E,t,r.opts.Date1904),I({c:q.c,r:q.r},E,t);break;case 5:case 517:E={ixfe:q.ixfe,XF:D[q.ixfe],v:q.val,t:q.t},P>0&&(E.z=V[E.ixfe>>8&63]),Hs(E,t,r.opts.Date1904),I({c:q.c,r:q.r},E,t);break;case 638:E={ixfe:q.ixfe,XF:D[q.ixfe],v:q.rknum,t:"n"},P>0&&(E.z=V[E.ixfe>>8&63]),Hs(E,t,r.opts.Date1904),I({c:q.c,r:q.r},E,t);break;case 189:for(var ke=q.c;ke<=q.C;++ke){var De=q.rkrec[ke-q.c][0];E={ixfe:De,XF:D[De],v:q.rkrec[ke-q.c][1],t:"n"},P>0&&(E.z=V[E.ixfe>>8&63]),Hs(E,t,r.opts.Date1904),I({c:ke,r:q.r},E,t)}break;case 6:case 518:case 1030:{if(q.val=="String"){a=q;break}if(E=$p(q.val,q.cell.ixfe,q.tt),E.XF=D[E.ixfe],t.cellFormula){var nt=q.formula;if(nt&&nt[0]&&nt[0][0]&&nt[0][0][0]=="PtgExp"){var vt=nt[0][0][1][0],Xe=nt[0][0][1][1],st=pt({r:vt,c:Xe});x[st]?E.f=""+Dn(q.formula,o,q.cell,U,G):E.F=((t.dense?(i[vt]||[])[Xe]:i[st])||{}).F}else E.f=""+Dn(q.formula,o,q.cell,U,G)}P>0&&(E.z=V[E.ixfe>>8&63]),Hs(E,t,r.opts.Date1904),I(q.cell,E,t),a=q}break;case 7:case 519:if(a)a.val=q,E=$p(q,a.cell.ixfe,"s"),E.XF=D[E.ixfe],t.cellFormula&&(E.f=""+Dn(a.formula,o,a.cell,U,G)),P>0&&(E.z=V[E.ixfe>>8&63]),Hs(E,t,r.opts.Date1904),I(a.cell,E,t),a=null;else throw new Error("String record expects Formula");break;case 33:case 545:{R.push(q);var Ct=pt(q[0].s);if(v=t.dense?(i[q[0].s.r]||[])[q[0].s.c]:i[Ct],t.cellFormula&&v){if(!a||!Ct||!v)break;v.f=""+Dn(q[1],o,q[0],U,G),v.F=bt(q[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!a)break;x[pt(a.cell)]=q[0],v=t.dense?(i[a.cell.r]||[])[a.cell.c]:i[pt(a.cell)],(v||{}).f=""+Dn(q[0],o,g,U,G)}}break;case 253:E=$p(u[q.isst].t,q.ixfe,"s"),u[q.isst].h&&(E.h=u[q.isst].h),E.XF=D[E.ixfe],P>0&&(E.z=V[E.ixfe>>8&63]),Hs(E,t,r.opts.Date1904),I({c:q.c,r:q.r},E,t);break;case 513:t.sheetStubs&&(E={ixfe:q.ixfe,XF:D[q.ixfe],t:"z"},P>0&&(E.z=V[E.ixfe>>8&63]),Hs(E,t,r.opts.Date1904),I({c:q.c,r:q.r},E,t));break;case 190:if(t.sheetStubs)for(var ar=q.c;ar<=q.C;++ar){var qe=q.ixfe[ar-q.c];E={ixfe:qe,XF:D[qe],t:"z"},P>0&&(E.z=V[E.ixfe>>8&63]),Hs(E,t,r.opts.Date1904),I({c:ar,r:q.r},E,t)}break;case 214:case 516:case 4:E=$p(q.val,q.ixfe,"s"),E.XF=D[E.ixfe],P>0&&(E.z=V[E.ixfe>>8&63]),Hs(E,t,r.opts.Date1904),I({c:q.c,r:q.r},E,t);break;case 0:case 512:N===1&&(o=q);break;case 252:u=q;break;case 1054:if(G.biff==4){V[P++]=q[1];for(var hr=0;hr<P+163&&gt[hr]!=q[1];++hr);hr>=163&&Uo(q[1],P+163)}else Uo(q[1],q[0]);break;case 30:{V[P++]=q;for(var Or=0;Or<P+163&&gt[Or]!=q;++Or);Or>=163&&Uo(q,P+163)}break;case 229:ie=ie.concat(q);break;case 93:J[q.cmo[0]]=G.lastobj=q;break;case 438:G.lastobj.TxO=q;break;case 127:G.lastobj.ImData=q;break;case 440:for(b=q[0].s.r;b<=q[0].e.r;++b)for(C=q[0].s.c;C<=q[0].e.c;++C)v=t.dense?(i[b]||[])[C]:i[pt({c:C,r:b})],v&&(v.l=q[1]);break;case 2048:for(b=q[0].s.r;b<=q[0].e.r;++b)for(C=q[0].s.c;C<=q[0].e.c;++C)v=t.dense?(i[b]||[])[C]:i[pt({c:C,r:b})],v&&v.l&&(v.l.Tooltip=q[1]);break;case 28:{if(G.biff<=5&&G.biff>=2)break;v=t.dense?(i[q[0].r]||[])[q[0].c]:i[pt(q[0])];var Et=J[q[2]];v||(t.dense?(i[q[0].r]||(i[q[0].r]=[]),v=i[q[0].r][q[0].c]={t:"z"}):v=i[pt(q[0])]={t:"z"},o.e.r=Math.max(o.e.r,q[0].r),o.s.r=Math.min(o.s.r,q[0].r),o.e.c=Math.max(o.e.c,q[0].c),o.s.c=Math.min(o.s.c,q[0].c)),v.c||(v.c=[]),w={a:q[1],t:Et.TxO.t},v.c.push(w)}break;case 2173:Mce(D[q.ixfe],q.ext);break;case 125:{if(!G.cellStyles)break;for(;q.e>=q.s;)_[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(q.flags&1)},Q||(Q=!0,m1(q.w/256)),Xa(_[q.e+1])}break;case 520:{var dt={};q.level!=null&&(Y[q.r]=dt,dt.level=q.level),q.hidden&&(Y[q.r]=dt,dt.hidden=!0),q.hpt&&(Y[q.r]=dt,dt.hpt=q.hpt,dt.hpx=sd(q.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||ql(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[le]]=q;break;case 161:i["!margins"]||ql(i["!margins"]={}),i["!margins"].header=q.header,i["!margins"].footer=q.footer;break;case 574:q.RTL&&(F.Views[0].RTL=!0);break;case 146:M=q;break;case 2198:ne=q;break;case 140:A=q;break;case 442:d?O.CodeName=q||O.name:F.WBProps.CodeName=q||"ThisWorkbook";break}}else ue||console.error("Missing Info for XLS Record 0x"+le.toString(16)),e.l+=de}return r.SheetNames=Ir(s).sort(function(At,ht){return Number(At)-Number(ht)}).map(function(At){return s[At].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&H.forEach(function(At,ht){r.Sheets[r.SheetNames[ht]]["!autofilter"]=At}),r.Strings=u,r.SSF=vr(gt),G.enc&&(r.Encryption=G.enc),ne&&(r.Themes=ne),r.Metadata={},A!==void 0&&(r.Metadata.Country=A),U.names.length>0&&(F.Names=U.names),r.Workbook=F,r}var Qh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function jge(e,t,r){var n=at.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=$A(n,eS,Qh.DSI);for(var s in i)t[s]=i[s]}catch(d){if(r.WTF)throw d}var o=at.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var a=$A(o,tS,Qh.SI);for(var u in a)t[u]==null&&(t[u]=a[u])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(FO(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Yge(e,t){var r=[],n=[],i=[],s=0,o,a=bA(eS,"n"),u=bA(tS,"n");if(e.Props)for(o=Ir(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(a,o[s])?r:Object.prototype.hasOwnProperty.call(u,o[s])?n:i).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=Ir(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(a,o[s])?r:Object.prototype.hasOwnProperty.call(u,o[s])?n:i).push([o[s],e.Custprops[o[s]]]);var d=[];for(s=0;s<i.length;++s)LO.indexOf(i[s][0])>-1||TO.indexOf(i[s][0])>-1||i[s][1]!=null&&d.push(i[s]);n.length&&at.utils.cfb_add(t,"/SummaryInformation",jA(n,Qh.SI,u,tS)),(r.length||d.length)&&at.utils.cfb_add(t,"/DocumentSummaryInformation",jA(r,Qh.DSI,a,eS,d.length?d:null,Qh.UDI))}function AN(e,t){t||(t={}),R1(t),jx(),t.codepage&&$x(t.codepage);var r,n;if(e.FullPaths){if(at.find(e,"/encryption"))throw new Error("File is password-protected");r=at.find(e,"!CompObj"),n=at.find(e,"/Workbook")||at.find(e,"/Book")}else{switch(t.type){case"base64":e=Si(Ai(e));break;case"binary":e=Si(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}wn(e,0),n={content:e}}var i,s;if(r&&zge(r),t.bookProps&&!t.bookSheets)i={};else{var o=Rt?"buffer":"array";if(n&&n.content)i=$ge(n.content,t);else if((s=at.find(e,"PerfectOffice_MAIN"))&&s.content)i=Kl.to_workbook(s.content,(t.type=o,t));else if((s=at.find(e,"NativeContent_MAIN"))&&s.content)i=Kl.to_workbook(s.content,(t.type=o,t));else throw(s=at.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&at.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=oue(e))}var a={};return e.FullPaths&&jge(e,a,t),i.Props=i.Custprops=a,t.bookFiles&&(i.cfb=e),i}function Kge(e,t){var r=t||{},n=at.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return at.utils.cfb_add(n,i,kN(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Yge(e,n),r.biff==8&&e.vbaraw&&aue(n,at.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Af={0:{f:whe},1:{f:The},2:{f:$he},3:{f:Lhe},4:{f:khe},5:{f:zhe},6:{f:Xhe},7:{f:Bhe},8:{f:nfe},9:{f:rfe},10:{f:efe},11:{f:tfe},12:{f:Dhe},13:{f:Yhe},14:{f:Ohe},15:{f:Mhe},16:{f:bN},17:{f:Zhe},18:{f:Ghe},19:{f:o1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Zfe},40:{},42:{},43:{f:Xle},44:{f:Kle},45:{f:Jle},46:{f:tce},47:{f:ece},48:{},49:{f:bse},50:{},51:{f:Ice},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:$O},62:{f:qhe},63:{f:Uce},64:{f:Cfe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ln,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:pfe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Ehe},148:{f:bhe,p:16},151:{f:cfe},152:{},153:{f:qfe},154:{},155:{},156:{f:Yfe},157:{},158:{},159:{T:1,f:dle},160:{T:-1},161:{T:1,f:xc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:ife},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:_ce},336:{T:-1},337:{f:Bce,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Jb},357:{},358:{},359:{},360:{T:1},361:{},362:{f:UO},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ufe},427:{f:dfe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:ffe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:xhe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:afe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Jb},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:tue},633:{T:1},634:{T:-1},635:{T:1,f:Jce},636:{T:-1},637:{f:Rse},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Ofe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:yfe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},aS={6:{f:Wy},10:{f:Ia},12:{f:Jr},13:{f:Jr},14:{f:Hr},15:{f:Hr},16:{f:Pn},17:{f:Hr},18:{f:Hr},19:{f:Jr},20:{f:ZA},21:{f:ZA},23:{f:UO},24:{f:ek},25:{f:Hr},26:{},27:{},28:{f:yae},29:{},34:{f:Hr},35:{f:JA},38:{f:Pn},39:{f:Pn},40:{f:Pn},41:{f:Pn},42:{f:Hr},43:{f:Hr},47:{f:Mle},49:{f:Yoe},51:{f:Jr},60:{},61:{f:zoe},64:{f:Hr},65:{f:joe},66:{f:Jr},77:{},80:{},81:{},82:{},85:{f:Jr},89:{},90:{},91:{},92:{f:Poe},93:{f:xae},94:{},95:{f:Hr},96:{},97:{},99:{f:Hr},125:{f:$O},128:{f:lae},129:{f:_oe},130:{f:Jr},131:{f:Hr},132:{f:Hr},133:{f:Loe},134:{},140:{f:Pae},141:{f:Jr},144:{},146:{f:Lae},151:{},152:{},153:{},154:{},155:{},156:{f:Jr},157:{},158:{},160:{f:Vae},161:{f:Nae},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:iae},190:{f:sae},193:{f:Ia},197:{},198:{},199:{},200:{},201:{},202:{f:Hr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Jr},220:{},221:{f:Hr},222:{},224:{f:aae},225:{f:koe},226:{f:Ia},227:{},229:{f:bae},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Ooe},253:{f:qoe},255:{f:Boe},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:IO},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Hr},353:{f:Ia},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:fae},431:{f:Hr},432:{},433:{},434:{},437:{},438:{f:Tae},439:{f:Hr},440:{f:Fae},441:{},442:{f:Xf},443:{},444:{f:Jr},445:{},446:{},448:{f:Ia},449:{f:Voe,r:2},450:{f:Ia},512:{f:qA},513:{f:Gae},515:{f:dae},516:{f:Qoe},517:{f:QA},519:{f:zae},520:{f:Hoe},523:{},545:{f:tk},549:{f:KA},566:{},574:{f:Uoe},638:{f:nae},659:{},1048:{},1054:{f:Joe},1084:{},1212:{f:vae},2048:{f:Aae},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:zp},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ia},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Iae,r:12},2173:{f:Pce,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Hr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:mae,r:12},2197:{},2198:{f:Rce,r:12},2199:{},2200:{},2201:{},2202:{f:wae,r:12},2203:{f:Ia},2204:{},2205:{},2206:{},2207:{},2211:{f:Goe},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Jr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Bae},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:_ae},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:qA},1:{},2:{f:Yae},3:{f:$ae},4:{f:Uae},5:{f:QA},7:{f:qae},8:{},9:{f:zp},11:{},22:{f:Jr},30:{f:tae},31:{},32:{},33:{f:tk},36:{},37:{f:KA},50:{f:Xae},62:{},52:{},67:{},68:{f:Jr},69:{},86:{},126:{},127:{f:Wae},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Qae},223:{},234:{},354:{},421:{},518:{f:Wy},521:{f:zp},536:{f:ek},547:{f:JA},561:{},579:{},1030:{f:Wy},1033:{f:zp},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function We(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&n1(r)&&e.push(r)}}function qge(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return We(e,t,r,i);var s=t;if(!isNaN(s)){for(var o=r.parts||[],a=0,u=0,d=0;d+(o[a]||8224)<=8224;)d+=o[a]||8224,a++;var h=e.next(4);for(h.write_shift(2,s),h.write_shift(2,d),e.push(r.slice(u,u+d)),u+=d;u<i;){for(h=e.next(4),h.write_shift(2,60),d=0;d+(o[a]||8224)<=8224;)d+=o[a]||8224,a++;h.write_shift(2,d),e.push(r.slice(u,u+d)),u+=d}}}function eg(e,t,r){return e||(e=Re(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Xge(e,t,r,n){var i=Re(9);return eg(i,e,t),OO(r,n||"b",i),i}function Qge(e,t,r){var n=Re(8+2*r.length);return eg(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Zge(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?rn(mr(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?We(e,2,Kae(r,n,i)):We(e,3,jae(r,n,i));return;case"b":case"e":We(e,5,Xge(r,n,t.v,t.t));return;case"s":case"str":We(e,4,Qge(r,n,(t.v||"").slice(0,255)));return}We(e,1,eg(null,r,n))}function Jge(e,t,r,n){var i=Array.isArray(t),s=Ht(t["!ref"]||"A1"),o,a="",u=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=bt(s)}for(var d=s.s.r;d<=s.e.r;++d){a=zr(d);for(var h=s.s.c;h<=s.e.c;++h){d===s.s.r&&(u[h]=Rr(h)),o=u[h]+a;var g=i?(t[d]||[])[h]:t[o];g&&Zge(e,g,d,h)}}}function epe(e,t){for(var r=t||{},n=oi(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return We(n,r.biff==4?1033:r.biff==3?521:9,f1(e,16,r)),Jge(n,e.Sheets[e.SheetNames[i]],i,r),We(n,10),n.end()}function tpe(e,t,r){We(e,49,Koe({sz:12,name:"Arial"},r))}function rpe(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&We(e,1054,eae(i,t[i],r))})}function npe(e,t){var r=Re(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),We(e,2151,r),r=Re(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),VO(Ht(t["!ref"]||"A1"),r),r.write_shift(4,4),We(e,2152,r)}function ipe(e,t){for(var r=0;r<16;++r)We(e,224,XA({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){We(e,224,XA(n,0,t))})}function spe(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];We(e,440,Dae(n)),n[1].Tooltip&&We(e,2048,kae(n))}delete t["!links"]}function ope(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&We(e,125,Oae(dv(i,n),i))})}}function ape(e,t,r,n,i){var s=16+al(i.cellXfs,t,i);if(t.v==null&&!t.bf){We(e,513,cc(r,n,s));return}if(t.bf)We(e,6,_de(t,r,n,i,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?rn(mr(t.v)):t.v;We(e,515,hae(r,n,o,s));break;case"b":case"e":We(e,517,uae(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var a=b1(i.Strings,t.v,i.revStrings);We(e,253,Xoe(r,n,a,s))}else We(e,516,Zoe(r,n,(t.v||"").slice(0,255),s,i));break;default:We(e,513,cc(r,n,s))}}function lpe(e,t,r){var n=oi(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=(r||{}).Workbook||{},a=(o.Sheets||[])[e]||{},u=Array.isArray(s),d=t.biff==8,h,g="",m=[],v=Ht(s["!ref"]||"A1"),w=d?65536:16384;if(v.e.c>255||v.e.r>=w){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");v.e.c=Math.min(v.e.c,255),v.e.r=Math.min(v.e.c,w-1)}We(n,2057,f1(r,16,t)),We(n,13,Zi(1)),We(n,12,Zi(100)),We(n,15,Gn(!0)),We(n,17,Gn(!1)),We(n,16,ac(.001)),We(n,95,Gn(!0)),We(n,42,Gn(!1)),We(n,43,Gn(!1)),We(n,130,Zi(1)),We(n,128,cae()),We(n,131,Gn(!1)),We(n,132,Gn(!1)),d&&ope(n,s["!cols"]),We(n,512,rae(v,t)),d&&(s["!links"]=[]);for(var C=v.s.r;C<=v.e.r;++C){g=zr(C);for(var b=v.s.c;b<=v.e.c;++b){C===v.s.r&&(m[b]=Rr(b)),h=m[b]+g;var x=u?(s[C]||[])[b]:s[h];x&&(ape(n,x,C,b,t),d&&x.l&&s["!links"].push([h,x.l]))}}var R=a.CodeName||a.name||i;return d&&We(n,574,$oe((o.Views||[])[0])),d&&(s["!merges"]||[]).length&&We(n,229,Sae(s["!merges"])),d&&spe(n,s),We(n,442,NO(R)),d&&npe(n,s),We(n,10),n.end()}function cpe(e,t,r){var n=oi(),i=(e||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},a=r.biff==8,u=r.biff==5;if(We(n,2057,f1(e,5,r)),r.bookType=="xla"&&We(n,135),We(n,225,a?Zi(1200):null),We(n,193,uoe(2)),u&&We(n,191),u&&We(n,192),We(n,226),We(n,92,Moe("SheetJS",r)),We(n,66,Zi(a?1200:1252)),a&&We(n,353,Zi(0)),a&&We(n,448),We(n,317,Hae(e.SheetNames.length)),a&&e.vbaraw&&We(n,211),a&&e.vbaraw){var d=o.CodeName||"ThisWorkbook";We(n,442,NO(d))}We(n,156,Zi(17)),We(n,25,Gn(!1)),We(n,18,Gn(!1)),We(n,19,Zi(0)),a&&We(n,431,Gn(!1)),a&&We(n,444,Zi(0)),We(n,61,Woe()),We(n,64,Gn(!1)),We(n,141,Zi(0)),We(n,34,Gn(Vfe(e)=="true")),We(n,14,Gn(!0)),a&&We(n,439,Gn(!1)),We(n,218,Zi(0)),tpe(n,e,r),rpe(n,e.SSF,r),ipe(n,r),a&&We(n,352,Gn(!1));var h=n.end(),g=oi();a&&We(g,140,Mae()),a&&r.Strings&&qge(g,252,Noe(r.Strings)),We(g,10);var m=g.end(),v=oi(),w=0,C=0;for(C=0;C<e.SheetNames.length;++C)w+=(a?12:11)+(a?2:1)*e.SheetNames[C].length;var b=h.length+w+m.length;for(C=0;C<e.SheetNames.length;++C){var x=s[C]||{};We(v,133,Ioe({pos:b,hs:x.Hidden||0,dt:0,name:e.SheetNames[C]},r)),b+=t[C].length}var R=v.end();if(w!=R.length)throw new Error("BS8 "+w+" != "+R.length);var E=[];return h.length&&E.push(h),R.length&&E.push(R),m.length&&E.push(m),ln(E)}function upe(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=vr(gt)),e&&e.SSF&&(bd(),iv(e.SSF),r.revssf=ov(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,T1(r),r.cellXfs=[],al(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=lpe(i,r,e);return n.unshift(cpe(e,n,r)),ln(n)}function kN(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=di(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return upe(e,t);case 4:case 3:case 2:return epe(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function dk(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=i.index,a=s&&s.index||e.length,u=Kie(e.slice(o,a),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,h=0,g=0,m=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(o=0;o<u.length;++o){var C=u[o].trim(),b=C.slice(0,3).toLowerCase();if(b=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}h=0;continue}if(!(b!="<td"&&b!="<th")){var x=C.split(/<\/t[dh]>/i);for(a=0;a<x.length;++a){var R=x[a].trim();if(R.match(/<t[dh]/i)){for(var E=R,A=0;E.charAt(0)=="<"&&(A=E.indexOf(">"))>-1;)E=E.slice(A+1);for(var D=0;D<w.length;++D){var M=w[D];M.s.c==h&&M.s.r<d&&d<=M.e.r&&(h=M.e.c+1,D=-1)}var F=mt(R.slice(0,R.indexOf(">")));m=F.colspan?+F.colspan:1,((g=+F.rowspan)>1||m>1)&&w.push({s:{r:d,c:h},e:{r:d+(g||1)-1,c:h+m-1}});var O=F.t||F["data-t"]||"";if(!E.length){h+=m;continue}if(E=eO(E),v.s.r>d&&(v.s.r=d),v.e.r<d&&(v.e.r=d),v.s.c>h&&(v.s.c=h),v.e.c<h&&(v.e.c=h),!E.length){h+=m;continue}var L={t:"s",v:E};r.raw||!E.trim().length||O=="s"||(E==="TRUE"?L={t:"b",v:!0}:E==="FALSE"?L={t:"b",v:!1}:isNaN(xs(E))?isNaN(nd(E).getDate())||(L={t:"d",v:mr(E)},r.cellDates||(L={t:"n",v:rn(L.v)}),L.z=r.dateNF||gt[14]):L={t:"n",v:xs(E)}),r.dense?(n[d]||(n[d]=[]),n[d][h]=L):n[pt({r:d,c:h})]=L,h+=m}}}}return n["!ref"]=bt(v),w.length&&(n["!merges"]=w),n}function dpe(e,t,r,n){for(var i=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var a=0,u=0,d=0;d<i.length;++d)if(!(i[d].s.r>r||i[d].s.c>o)&&!(i[d].e.r<r||i[d].e.c<o)){if(i[d].s.r<r||i[d].s.c<o){a=-1;break}a=i[d].e.r-i[d].s.r+1,u=i[d].e.c-i[d].s.c+1;break}if(!(a<0)){var h=pt({r,c:o}),g=n.dense?(e[r]||[])[o]:e[h],m=g&&g.v!=null&&(g.h||e1(g.w||(Ko(g),g.w)||""))||"",v={};a>1&&(v.rowspan=a),u>1&&(v.colspan=u),n.editable?m='<span contenteditable="true">'+m+"</span>":g&&(v["data-t"]=g&&g.t||"z",g.v!=null&&(v["data-v"]=g.v),g.z!=null&&(v["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+g.l.Target+'">'+m+"</a>")),v.id=(n.id||"sjs")+"-"+h,s.push(ze("td",m,v))}}var w="<tr>";return w+s.join("")+"</tr>"}var hpe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',fpe="</body></html>";function gpe(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ol(dk(r[0],t),t);var n=A1();return r.forEach(function(i,s){k1(n,dk(i,t),"Sheet"+(s+1))}),n}function ppe(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function PN(e,t){var r=t||{},n=r.header!=null?r.header:hpe,i=r.footer!=null?r.footer:fpe,s=[n],o=di(e["!ref"]);r.dense=Array.isArray(e),s.push(ppe(e,o,r));for(var a=o.s.r;a<=o.e.r;++a)s.push(dpe(e,o,a,r));return s.push("</table>"+i),s.join("")}function MN(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?Tr(n.origin):n.origin;i=o.r,s=o.c}var a=t.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,a.length),d={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var h=di(e["!ref"]);d.s.r=Math.min(d.s.r,h.s.r),d.s.c=Math.min(d.s.c,h.s.c),d.e.r=Math.max(d.e.r,h.e.r),d.e.c=Math.max(d.e.c,h.e.c),i==-1&&(d.e.r=i=h.e.r+1)}var g=[],m=0,v=e["!rows"]||(e["!rows"]=[]),w=0,C=0,b=0,x=0,R=0,E=0;for(e["!cols"]||(e["!cols"]=[]);w<a.length&&C<u;++w){var A=a[w];if(hk(A)){if(n.display)continue;v[C]={hidden:!0}}var D=A.children;for(b=x=0;b<D.length;++b){var M=D[b];if(!(n.display&&hk(M))){var F=M.hasAttribute("data-v")?M.getAttribute("data-v"):M.hasAttribute("v")?M.getAttribute("v"):eO(M.innerHTML),O=M.getAttribute("data-z")||M.getAttribute("z");for(m=0;m<g.length;++m){var L=g[m];L.s.c==x+s&&L.s.r<C+i&&C+i<=L.e.r&&(x=L.e.c+1-s,m=-1)}E=+M.getAttribute("colspan")||1,((R=+M.getAttribute("rowspan")||1)>1||E>1)&&g.push({s:{r:C+i,c:x+s},e:{r:C+i+(R||1)-1,c:x+s+(E||1)-1}});var W={t:"s",v:F},I=M.getAttribute("data-t")||M.getAttribute("t")||"";F!=null&&(F.length==0?W.t=I||"z":n.raw||F.trim().length==0||I=="s"||(F==="TRUE"?W={t:"b",v:!0}:F==="FALSE"?W={t:"b",v:!1}:isNaN(xs(F))?isNaN(nd(F).getDate())||(W={t:"d",v:mr(F)},n.cellDates||(W={t:"n",v:rn(W.v)}),W.z=n.dateNF||gt[14]):W={t:"n",v:xs(F)})),W.z===void 0&&O!=null&&(W.z=O);var G="",ne=M.getElementsByTagName("A");if(ne&&ne.length)for(var ie=0;ie<ne.length&&!(ne[ie].hasAttribute("href")&&(G=ne[ie].getAttribute("href"),G.charAt(0)!="#"));++ie);G&&G.charAt(0)!="#"&&(W.l={Target:G}),n.dense?(e[C+i]||(e[C+i]=[]),e[C+i][x+s]=W):e[pt({c:x+s,r:C+i})]=W,d.e.c<x+s&&(d.e.c=x+s),x+=E}}++C}return g.length&&(e["!merges"]=(e["!merges"]||[]).concat(g)),d.e.r=Math.max(d.e.r,C-1+i),e["!ref"]=bt(d),C>=u&&(e["!fullref"]=bt((d.e.r=a.length-w+C-1+i,d))),e}function _N(e,t){var r=t||{},n=r.dense?[]:{};return MN(n,e,t)}function mpe(e,t){return ol(_N(e,t),t)}function hk(e){var t="",r=vpe(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function vpe(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function wpe(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Bt(t.replace(/<[^>]*>/g,""));return[r]}var fk={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function LN(e,t){var r=t||{},n=t1(e),i=[],s,o,a={name:""},u="",d=0,h,g,m={},v=[],w=r.dense?[]:{},C,b,x={value:""},R="",E=0,A=[],D=-1,M=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},O=0,L={},W=[],I={},G=0,ne=0,ie=[],J=1,_=1,Y=[],Q={Names:[]},U={},se=["",""],N=[],P={},V="",H=0,j=!1,ae=!1,fe=0;for(xf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");C=xf.exec(n);)switch(C[3]=C[3].replace(/_.*$/,"")){case"table":case"":C[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?w["!ref"]=bt(F):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=F.e.r&&(w["!fullref"]=w["!ref"],F.e.r=r.sheetRows-1,w["!ref"]=bt(F)),W.length&&(w["!merges"]=W),ie.length&&(w["!rows"]=ie),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),v.push(h.name),m[h.name]=w,ae=!1):C[0].charAt(C[0].length-2)!=="/"&&(h=mt(C[0],!1),D=M=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,w=r.dense?[]:{},W=[],ie=[],ae=!0);break;case"table-row-group":C[1]==="/"?--O:++O;break;case"table-row":case"":if(C[1]==="/"){D+=J,J=1;break}if(g=mt(C[0],!1),g.?D=g.-1:D==-1&&(D=0),J=+g["number-rows-repeated"]||1,J<10)for(fe=0;fe<J;++fe)O>0&&(ie[D+fe]={level:O});M=-1;break;case"covered-table-cell":C[1]!=="/"&&++M,r.sheetStubs&&(r.dense?(w[D]||(w[D]=[]),w[D][M]={t:"z"}):w[pt({r:D,c:M})]={t:"z"}),R="",A=[];break;case"table-cell":case"":if(C[0].charAt(C[0].length-2)==="/")++M,x=mt(C[0],!1),_=parseInt(x["number-columns-repeated"]||"1",10),b={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(b.f=lk(Bt(x.formula))),(x.||x["value-type"])=="string"&&(b.t="s",b.v=Bt(x["string-value"]||""),r.dense?(w[D]||(w[D]=[]),w[D][M]=b):w[pt({r:D,c:M})]=b),M+=_-1;else if(C[1]!=="/"){++M,R="",E=0,A=[],_=1;var le=J?D+J-1:D;if(M>F.e.c&&(F.e.c=M),M<F.s.c&&(F.s.c=M),D<F.s.r&&(F.s.r=D),le>F.e.r&&(F.e.r=le),x=mt(C[0],!1),N=[],P={},b={t:x.||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=Bt(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(G=parseInt(x["number-matrix-rows-spanned"],10)||0,ne=parseInt(x["number-matrix-columns-spanned"],10)||0,I={s:{r:D,c:M},e:{r:D+G-1,c:M+ne-1}},b.F=bt(I),Y.push([I,b.F])),x.formula)b.f=lk(x.formula);else for(fe=0;fe<Y.length;++fe)D>=Y[fe][0].s.r&&D<=Y[fe][0].e.r&&M>=Y[fe][0].s.c&&M<=Y[fe][0].e.c&&(b.F=Y[fe][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(G=parseInt(x["number-rows-spanned"],10)||0,ne=parseInt(x["number-columns-spanned"],10)||0,I={s:{r:D,c:M},e:{r:D+G-1,c:M+ne-1}},W.push(I)),x["number-columns-repeated"]&&(_=parseInt(x["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=pr(x["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(x.value);break;case"percentage":b.t="n",b.v=parseFloat(x.value);break;case"currency":b.t="n",b.v=parseFloat(x.value);break;case"date":b.t="d",b.v=mr(x["date-value"]),r.cellDates||(b.t="n",b.v=rn(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=$ie(x["time-value"])/86400,r.cellDates&&(b.t="d",b.v=av(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(x.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",x["string-value"]!=null&&(R=Bt(x["string-value"]),A=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(j=!1,b.t==="s"&&(b.v=R||"",A.length&&(b.R=A),j=E==0),U.Target&&(b.l=U),N.length>0&&(b.c=N,N=[]),R&&r.cellText!==!1&&(b.w=R),j&&(b.t="z",delete b.v),(!j||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=D))for(var de=0;de<J;++de){if(_=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(w[D+de]||(w[D+de]=[]),w[D+de][M]=de==0?b:vr(b);--_>0;)w[D+de][M+_]=vr(b);else for(w[pt({r:D+de,c:M})]=b;--_>0;)w[pt({r:D+de,c:M+_})]=vr(b);F.e.c<=M&&(F.e.c=M)}_=parseInt(x["number-columns-repeated"]||"1",10),M+=_-1,_=0,b={},R="",A=[]}U={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(C[1]==="/"){if((s=i.pop())[0]!==C[3])throw"Bad state: "+s}else C[0].charAt(C[0].length-2)!=="/"&&i.push([C[3],!0]);break;case"annotation":if(C[1]==="/"){if((s=i.pop())[0]!==C[3])throw"Bad state: "+s;P.t=R,A.length&&(P.R=A),P.a=V,N.push(P)}else C[0].charAt(C[0].length-2)!=="/"&&i.push([C[3],!1]);V="",H=0,R="",E=0,A=[];break;case"creator":C[1]==="/"?V=n.slice(H,C.index):H=C.index+C[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(C[1]==="/"){if((s=i.pop())[0]!==C[3])throw"Bad state: "+s}else C[0].charAt(C[0].length-2)!=="/"&&i.push([C[3],!1]);R="",E=0,A=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(C[1]==="/"){if(L[a.name]=u,(s=i.pop())[0]!==C[3])throw"Bad state: "+s}else C[0].charAt(C[0].length-2)!=="/"&&(u="",a=mt(C[0],!1),i.push([C[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=mt(C[0],!1),u+=fk[C[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=mt(C[0],!1),u+=fk[C[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(C[0].slice(-2)==="/>")break;if(C[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(d,C.index);break}else d=C.index+C[0].length;break;case"named-range":o=mt(C[0],!1),se=Uy(o["cell-range-address"]);var ue={Name:o.name,Ref:se[0]+"!"+se[1]};ae&&(ue.Sheet=v.length),Q.Names.push(ue);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(C[1]==="/"&&(!x||!x["string-value"])){var Ie=wpe(n.slice(E,C.index));R=(R.length>0?R+`
`:"")+Ie[0]}else mt(C[0],!1),E=C.index+C[0].length;break;case"s":break;case"database-range":if(C[1]==="/")break;try{se=Uy(mt(C[0])["target-range-address"]),m[se[0]]["!autofilter"]={ref:se[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(C[1]!=="/"){if(U=mt(C[0],!1),!U.href)break;U.Target=Bt(U.href),delete U.href,U.Target.charAt(0)=="#"&&U.Target.indexOf(".")>-1?(se=Uy(U.Target.slice(1)),U.Target="#"+se[0]+"!"+se[1]):U.Target.match(/^\.\.[\\\/]/)&&(U.Target=U.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(C[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(C)}}var q={Sheets:m,SheetNames:v,Workbook:Q};return r.bookSheets&&delete q.Sheets,q}function gk(e,t){t=t||{},Qi(e,"META-INF/manifest.xml")&&$se(Zr(e,"META-INF/manifest.xml"),t);var r=xi(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=LN(sr(r),t);return Qi(e,"meta.xml")&&(n.Props=EO(Zr(e,"meta.xml"))),n}function pk(e,t){return LN(e,t)}var Cpe=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Sf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Wr+t}})(),mk=(function(){var e=function(s){return Jt(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,a){var u=[];u.push('      <table:table table:name="'+Jt(o.SheetNames[a])+`" table:style-name="ta1">
`);var d=0,h=0,g=di(s["!ref"]||"A1"),m=s["!merges"]||[],v=0,w=Array.isArray(s);if(s["!cols"])for(h=0;h<=g.e.c;++h)u.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var C="",b=s["!rows"]||[];for(d=0;d<g.s.r;++d)C=b[d]?' table:style-name="ro'+b[d].ods+'"':"",u.push("        <table:table-row"+C+`></table:table-row>
`);for(;d<=g.e.r;++d){for(C=b[d]?' table:style-name="ro'+b[d].ods+'"':"",u.push("        <table:table-row"+C+`>
`),h=0;h<g.s.c;++h)u.push(t);for(;h<=g.e.c;++h){var x=!1,R={},E="";for(v=0;v!=m.length;++v)if(!(m[v].s.c>h)&&!(m[v].s.r>d)&&!(m[v].e.c<h)&&!(m[v].e.r<d)){(m[v].s.c!=h||m[v].s.r!=d)&&(x=!0),R["table:number-columns-spanned"]=m[v].e.c-m[v].s.c+1,R["table:number-rows-spanned"]=m[v].e.r-m[v].s.r+1;break}if(x){u.push(r);continue}var A=pt({r:d,c:h}),D=w?(s[d]||[])[h]:s[A];if(D&&D.f&&(R["table:formula"]=Jt(Hde(D.f)),D.F&&D.F.slice(0,A.length)==A)){var M=di(D.F);R["table:number-matrix-columns-spanned"]=M.e.c-M.s.c+1,R["table:number-matrix-rows-spanned"]=M.e.r-M.s.r+1}if(!D){u.push(t);continue}switch(D.t){case"b":E=D.v?"TRUE":"FALSE",R["office:value-type"]="boolean",R["office:boolean-value"]=D.v?"true":"false";break;case"n":E=D.w||String(D.v||0),R["office:value-type"]="float",R["office:value"]=D.v||0;break;case"s":case"str":E=D.v==null?"":D.v,R["office:value-type"]="string";break;case"d":E=D.w||mr(D.v).toISOString(),R["office:value-type"]="date",R["office:date-value"]=mr(D.v).toISOString(),R["table:style-name"]="ce1";break;default:u.push(t);continue}var F=e(E);if(D.l&&D.l.Target){var O=D.l.Target;O=O.charAt(0)=="#"?"#"+Gde(O.slice(1)):O,O.charAt(0)!="#"&&!O.match(/^\w+:/)&&(O="../"+O),F=ze("text:a",F,{"xlink:href":O.replace(/&/g,"&amp;")})}u.push("          "+ze("table:table-cell",ze("text:p",F,{}),R)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var a=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var h=0;h<d["!cols"].length;++h)if(d["!cols"][h]){var g=d["!cols"][h];if(g.width==null&&g.wpx==null&&g.wch==null)continue;Xa(g),g.ods=a;var m=d["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),s.push(`  </style:style>
`),++a}}});var u=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var h=0;h<d["!rows"].length;++h)if(d["!rows"][h]){d["!rows"][h].ods=u;var g=d["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),s.push(`  </style:style>
`),++u}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,a){var u=[Wr],d=Sf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=Sf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(u.push("<office:document"+d+h+`>
`),u.push(xO().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+d+`>
`),i(u,o),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var g=0;g!=o.SheetNames.length;++g)u.push(n(o.Sheets[o.SheetNames[g]],o,g));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),a.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}})();function IN(e,t){if(t.bookType=="fods")return mk(e,t);var r=Qx(),n="",i=[],s=[];return n="mimetype",xt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",xt(r,n,mk(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",xt(r,n,Cpe(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",xt(r,n,Wr+xO()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",xt(r,n,Kse(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",xt(r,n,jse(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function uc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function lS(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):sr(sl(e))}function ype(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Si(Xs(e))}function bpe(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Za(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function vk(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Spe(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function xpe(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function kf(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Xt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Lr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function zt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=kf(e,r),s=i&7;i=Math.floor(i/8);var o=0,a;if(i==0)break;switch(s){case 0:{for(var u=r[0];e[r[0]++]>=128;);a=e.slice(u,r[0])}break;case 5:o=4,a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=kf(e,r),a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var d={data:a,type:s};t[i]==null?t[i]=[d]:t[i].push(d)}return t}function vn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(Xt(n*8+i.type)),i.type==2&&t.push(Xt(i.data.length)),t.push(i.data))})}),Za(t)}function E1(e,t){return e?.map(function(r){return t(r.data)})||[]}function Yi(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=kf(e,n),s=zt(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:Lr(s[1][0].data),messages:[]};s[2].forEach(function(a){var u=zt(a.data),d=Lr(u[3][0].data);o.messages.push({meta:u,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=s[3])!=null&&t[0]&&(o.merge=Lr(s[3][0].data)>>>0>0),r.push(o)}return r}function wu(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Xt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Xt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:Xt(o.data.length)}],n[2].push({data:vn(o.meta),type:2})});var s=vn(n);t.push(Xt(s.length)),t.push(s),i.forEach(function(o){return t.push(o)})}),Za(t)}function Epe(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=kf(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var a=o-59;o=t[r[0]],a>1&&(o|=t[r[0]+1]<<8),a>2&&(o|=t[r[0]+2]<<16),a>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=a}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var u=0,d=0;if(s==1?(d=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,s==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Za(i)],u==0)throw new Error("Invalid offset 0");if(u>i[0].length)throw new Error("Invalid offset beyond length");if(d>=u)for(i.push(i[0].slice(-u)),d-=u;d>=i[i.length-1].length;)i.push(i[i.length-1]),d-=i[i.length-1].length;i.push(i[0].slice(-u,-u+d))}}var h=Za(i);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function Ki(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Epe(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Za(t)}function Cu(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=Xt(n),o=s.length;t.push(s),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=n}return Za(t)}function Rpe(e,t,r,n){var i=uc(e),s=i.getUint32(4,!0),o=(n>1?12:8)+vk(s&(n>1?3470:398))*4,a=-1,u=-1,d=NaN,h=new Date(2001,0,1);s&512&&(a=i.getUint32(o,!0),o+=4),o+=vk(s&(n>1?12288:4096))*4,s&16&&(u=i.getUint32(o,!0),o+=4),s&32&&(d=i.getFloat64(o,!0),o+=8),s&64&&(h.setTime(h.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var g;switch(e[2]){case 0:break;case 2:g={t:"n",v:d};break;case 3:g={t:"s",v:t[u]};break;case 5:g={t:"d",v:h};break;case 6:g={t:"b",v:d>0};break;case 7:g={t:"n",v:d/86400};break;case 8:g={t:"e",v:0};break;case 9:if(a>-1)g={t:"s",v:r[a]};else if(u>-1)g={t:"s",v:t[u]};else if(!isNaN(d))g={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return g}function Tpe(e,t,r){var n=uc(e),i=n.getUint32(8,!0),s=12,o=-1,a=-1,u=NaN,d=NaN,h=new Date(2001,0,1);i&1&&(u=Spe(e,s),s+=16),i&2&&(d=n.getFloat64(s,!0),s+=8),i&4&&(h.setTime(h.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(a=n.getUint32(s,!0),s+=4),i&16&&(o=n.getUint32(s,!0),s+=4);var g;switch(e[1]){case 0:break;case 2:g={t:"n",v:u};break;case 3:g={t:"s",v:t[a]};break;case 5:g={t:"d",v:h};break;case 6:g={t:"b",v:d>0};break;case 7:g={t:"n",v:d/86400};break;case 8:g={t:"e",v:0};break;case 9:if(o>-1)g={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:g={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return g}function jy(e,t){var r=new Uint8Array(32),n=uc(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,xpe(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Yy(e,t){var r=new Uint8Array(32),n=uc(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function Fpe(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Rpe(e,t,r,e[0]);case 5:return Tpe(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Fn(e){var t=zt(e);return kf(t[1][0].data)}function wk(e,t){var r=zt(t.data),n=Lr(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(o){var a=zt(o.data),u=Lr(a[1][0].data)>>>0;switch(n){case 1:s[u]=lS(a[3][0].data);break;case 8:{var d=e[Fn(a[9][0].data)][0],h=zt(d.data),g=e[Fn(h[1][0].data)][0],m=Lr(g.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var v=zt(g.data);s[u]=v[3].map(function(w){return lS(w.data)}).join("")}break}}),s}function Dpe(e,t){var r,n,i,s,o,a,u,d,h,g,m,v,w,C,b=zt(e),x=Lr(b[1][0].data)>>>0,R=Lr(b[2][0].data)>>>0,E=((n=(r=b[8])==null?void 0:r[0])==null?void 0:n.data)&&Lr(b[8][0].data)>0||!1,A,D;if((s=(i=b[7])==null?void 0:i[0])!=null&&s.data&&t!=0)A=(a=(o=b[7])==null?void 0:o[0])==null?void 0:a.data,D=(d=(u=b[6])==null?void 0:u[0])==null?void 0:d.data;else if((g=(h=b[4])==null?void 0:h[0])!=null&&g.data&&t!=1)A=(v=(m=b[4])==null?void 0:m[0])==null?void 0:v.data,D=(C=(w=b[3])==null?void 0:w[0])==null?void 0:C.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var M=E?4:1,F=uc(A),O=[],L=0;L<A.length/2;++L){var W=F.getUint16(L*2,!0);W<65535&&O.push([L,W])}if(O.length!=R)throw"Expected ".concat(R," cells, found ").concat(O.length);var I=[];for(L=0;L<O.length-1;++L)I[O[L][0]]=D.subarray(O[L][1]*M,O[L+1][1]*M);return O.length>=1&&(I[O[O.length-1][0]]=D.subarray(O[O.length-1][1]*M)),{R:x,cells:I}}function Ape(e,t){var r,n=zt(t.data),i=(r=n?.[7])!=null&&r[0]?Lr(n[7][0].data)>>>0>0?1:0:-1,s=E1(n[5],function(o){return Dpe(o,i)});return{nrows:Lr(n[4][0].data)>>>0,data:s.reduce(function(o,a){return o[a.R]||(o[a.R]=[]),a.cells.forEach(function(u,d){if(o[a.R][d])throw new Error("Duplicate cell r=".concat(a.R," c=").concat(d));o[a.R][d]=u}),o},[])}}function kpe(e,t,r){var n,i=zt(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Lr(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Lr(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=bt(s);var o=zt(i[4][0].data),a=wk(e,e[Fn(o[4][0].data)][0]),u=(n=o[17])!=null&&n[0]?wk(e,e[Fn(o[17][0].data)][0]):[],d=zt(o[3][0].data),h=0;d[1].forEach(function(g){var m=zt(g.data),v=e[Fn(m[2][0].data)][0],w=Lr(v.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var C=Ape(e,v);C.data.forEach(function(b,x){b.forEach(function(R,E){var A=pt({r:h+x,c:E}),D=Fpe(R,a,u);D&&(r[A]=D)})}),h+=C.nrows})}function Ppe(e,t){var r=zt(t.data),n={"!ref":"A1"},i=e[Fn(r[2][0].data)],s=Lr(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return kpe(e,i[0],n),n}function Mpe(e,t){var r,n=zt(t.data),i={name:(r=n[1])!=null&&r[0]?lS(n[1][0].data):"",sheets:[]},s=E1(n[2],Fn);return s.forEach(function(o){e[o].forEach(function(a){var u=Lr(a.meta[1][0].data);u==6e3&&i.sheets.push(Ppe(e,a))})}),i}function _pe(e,t){var r=A1(),n=zt(t.data),i=E1(n[1],Fn);if(i.forEach(function(s){e[s].forEach(function(o){var a=Lr(o.meta[1][0].data);if(a==2){var u=Mpe(e,o);u.sheets.forEach(function(d,h){k1(r,d,h==0?u.name:u.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Ky(e){var t,r,n,i,s={},o=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var d;try{d=Ki(u.content)}catch(g){return console.log("?? "+u.content.length+" "+(g.message||g))}var h;try{h=Yi(d)}catch(g){return console.log("## "+(g.message||g))}h.forEach(function(g){s[g.id]=g.messages,o.push(g.id)})}}),!o.length)throw new Error("File has no messages");var a=((i=(n=(r=(t=s?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Lr(s[1][0].meta[1][0].data)==1&&s[1][0];if(a||o.forEach(function(u){s[u].forEach(function(d){var h=Lr(d.meta[1][0].data)>>>0;if(h==1)if(!a)a=d;else throw new Error("Document has multiple roots")})}),!a)throw new Error("Cannot find Document root");return _pe(s,a)}function Lpe(e,t,r){var n,i,s,o;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var a=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&Lr(e[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var u=0,d=uc(e[7][0].data),h=0,g=[],m=uc(e[4][0].data),v=0,w=[],C=0;C<t.length;++C){if(t[C]==null){d.setUint16(C*2,65535,!0),m.setUint16(C*2,65535);continue}d.setUint16(C*2,h,!0),m.setUint16(C*2,v,!0);var b,x;switch(typeof t[C]){case"string":b=jy({t:"s",v:t[C]},r),x=Yy({t:"s",v:t[C]},r);break;case"number":b=jy({t:"n",v:t[C]},r),x=Yy({t:"n",v:t[C]},r);break;case"boolean":b=jy({t:"b",v:t[C]},r),x=Yy({t:"b",v:t[C]},r);break;default:throw new Error("Unsupported value "+t[C])}g.push(b),h+=b.length,w.push(x),v+=x.length,++u}for(e[2][0].data=Xt(u);C<e[7][0].data.length/2;++C)d.setUint16(C*2,65535,!0),m.setUint16(C*2,65535,!0);return e[6][0].data=Za(g),e[3][0].data=Za(w),u}function Ipe(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=di(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(bt(n)));var s=om(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(V){return V.forEach(function(H){typeof H=="string"&&o.push(H)})});var a={},u=[],d=at.read(t.numbers,{type:"base64"});d.FileIndex.map(function(V,H){return[V,d.FullPaths[H]]}).forEach(function(V){var H=V[0],j=V[1];if(H.type==2&&H.name.match(/\.iwa/)){var ae=H.content,fe=Ki(ae),le=Yi(fe);le.forEach(function(de){u.push(de.id),a[de.id]={deps:[],location:j,type:Lr(de.messages[0].meta[1][0].data)}})}}),u.sort(function(V,H){return V-H});var h=u.filter(function(V){return V>1}).map(function(V){return[V,Xt(V)]});d.FileIndex.map(function(V,H){return[V,d.FullPaths[H]]}).forEach(function(V){var H=V[0];if(V[1],!!H.name.match(/\.iwa/)){var j=Yi(Ki(H.content));j.forEach(function(ae){ae.messages.forEach(function(fe){h.forEach(function(le){ae.messages.some(function(de){return Lr(de.meta[1][0].data)!=11006&&bpe(de.data,le[1])})&&a[le[0]].deps.push(ae.id)})})})}});for(var g=at.find(d,a[1].location),m=Yi(Ki(g.content)),v,w=0;w<m.length;++w){var C=m[w];C.id==1&&(v=C)}var b=Fn(zt(v.messages[0].data)[1][0].data);for(g=at.find(d,a[b].location),m=Yi(Ki(g.content)),w=0;w<m.length;++w)C=m[w],C.id==b&&(v=C);for(b=Fn(zt(v.messages[0].data)[2][0].data),g=at.find(d,a[b].location),m=Yi(Ki(g.content)),w=0;w<m.length;++w)C=m[w],C.id==b&&(v=C);for(b=Fn(zt(v.messages[0].data)[2][0].data),g=at.find(d,a[b].location),m=Yi(Ki(g.content)),w=0;w<m.length;++w)C=m[w],C.id==b&&(v=C);var x=zt(v.messages[0].data);{x[6][0].data=Xt(n.e.r+1),x[7][0].data=Xt(n.e.c+1);var R=Fn(x[46][0].data),E=at.find(d,a[R].location),A=Yi(Ki(E.content));{for(var D=0;D<A.length&&A[D].id!=R;++D);if(A[D].id!=R)throw"Bad ColumnRowUIDMapArchive";var M=zt(A[D].messages[0].data);M[1]=[],M[2]=[],M[3]=[];for(var F=0;F<=n.e.c;++F){var O=[];O[1]=O[2]=[{type:0,data:Xt(F+420690)}],M[1].push({type:2,data:vn(O)}),M[2].push({type:0,data:Xt(F)}),M[3].push({type:0,data:Xt(F)})}M[4]=[],M[5]=[],M[6]=[];for(var L=0;L<=n.e.r;++L)O=[],O[1]=O[2]=[{type:0,data:Xt(L+726270)}],M[4].push({type:2,data:vn(O)}),M[5].push({type:0,data:Xt(L)}),M[6].push({type:0,data:Xt(L)});A[D].messages[0].data=vn(M)}E.content=Cu(wu(A)),E.size=E.content.length,delete x[46];var W=zt(x[4][0].data);{W[7][0].data=Xt(n.e.r+1);var I=zt(W[1][0].data),G=Fn(I[2][0].data);E=at.find(d,a[G].location),A=Yi(Ki(E.content));{if(A[0].id!=G)throw"Bad HeaderStorageBucket";var ne=zt(A[0].messages[0].data);for(L=0;L<s.length;++L){var ie=zt(ne[2][0].data);ie[1][0].data=Xt(L),ie[4][0].data=Xt(s[L].length),ne[2][L]={type:ne[2][0].type,data:vn(ie)}}A[0].messages[0].data=vn(ne)}E.content=Cu(wu(A)),E.size=E.content.length;var J=Fn(W[2][0].data);E=at.find(d,a[J].location),A=Yi(Ki(E.content));{if(A[0].id!=J)throw"Bad HeaderStorageBucket";for(ne=zt(A[0].messages[0].data),F=0;F<=n.e.c;++F)ie=zt(ne[2][0].data),ie[1][0].data=Xt(F),ie[4][0].data=Xt(n.e.r+1),ne[2][F]={type:ne[2][0].type,data:vn(ie)};A[0].messages[0].data=vn(ne)}E.content=Cu(wu(A)),E.size=E.content.length;var _=Fn(W[4][0].data);(function(){for(var V=at.find(d,a[_].location),H=Yi(Ki(V.content)),j,ae=0;ae<H.length;++ae){var fe=H[ae];fe.id==_&&(j=fe)}var le=zt(j.messages[0].data);{le[3]=[];var de=[];o.forEach(function(q,Ge){de[1]=[{type:0,data:Xt(Ge)}],de[2]=[{type:0,data:Xt(1)}],de[3]=[{type:2,data:ype(q)}],le[3].push({type:2,data:vn(de)})})}j.messages[0].data=vn(le);var ue=wu(H),Ie=Cu(ue);V.content=Ie,V.size=V.content.length})();var Y=zt(W[3][0].data);{var Q=Y[1][0];delete Y[2];var U=zt(Q.data);{var se=Fn(U[2][0].data);(function(){for(var V=at.find(d,a[se].location),H=Yi(Ki(V.content)),j,ae=0;ae<H.length;++ae){var fe=H[ae];fe.id==se&&(j=fe)}var le=zt(j.messages[0].data);{delete le[6],delete Y[7];var de=new Uint8Array(le[5][0].data);le[5]=[];for(var ue=0,Ie=0;Ie<=n.e.r;++Ie){var q=zt(de);ue+=Lpe(q,s[Ie],o),q[1][0].data=Xt(Ie),le[5].push({data:vn(q),type:2})}le[1]=[{type:0,data:Xt(n.e.c+1)}],le[2]=[{type:0,data:Xt(n.e.r+1)}],le[3]=[{type:0,data:Xt(ue)}],le[4]=[{type:0,data:Xt(n.e.r+1)}]}j.messages[0].data=vn(le);var Ge=wu(H),Ye=Cu(Ge);V.content=Ye,V.size=V.content.length})()}Q.data=vn(U)}W[3][0].data=vn(Y)}x[4][0].data=vn(W)}v.messages[0].data=vn(x);var N=wu(m),P=Cu(N);return g.content=P,g.size=g.content.length,d}function ON(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function R1(e){ON([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function T1(e){ON([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Ope(e){return Ft.WS.indexOf(e)>-1?"sheet":e==Ft.CS?"chart":e==Ft.DS?"dialog":e==Ft.MS?"macro":e&&e.length?e:"sheet"}function Npe(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Ope(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Bpe(e,t,r,n,i,s,o,a,u,d,h,g){try{s[n]=Yh(xi(e,r,!0),t);var m=Zr(e,t),v;switch(a){case"sheet":v=oge(m,t,i,u,s[n],d,h,g);break;case"chart":if(v=age(m,t,i,u,s[n],d,h,g),!v||!v["!drawel"])break;var w=Mh(v["!drawel"].Target,t),C=Ef(w),b=Yce(xi(e,w,!0),Yh(xi(e,C,!0),w)),x=Mh(b,w),R=Ef(x);v=Lfe(xi(e,x,!0),x,u,Yh(xi(e,R,!0),x),d,v);break;case"macro":v=lge(m,t,i,u,s[n],d,h,g);break;case"dialog":v=cge(m,t,i,u,s[n],d,h,g);break;default:throw new Error("Unrecognized sheet type "+a)}o[n]=v;var E=[];s&&s[n]&&Ir(s[n]).forEach(function(A){var D="";if(s[n][A].Type==Ft.CMNT){D=Mh(s[n][A].Target,t);var M=fge(Zr(e,D,!0),D,u);if(!M||!M.length)return;nk(v,M,!1)}s[n][A].Type==Ft.TCMNT&&(D=Mh(s[n][A].Target,t),E=E.concat(qce(Zr(e,D,!0),u)))}),E&&E.length&&nk(v,E,!0,u.people||[])}catch(A){if(u.WTF)throw A}}function $i(e){return e.charAt(0)=="/"?e.slice(1):e}function Hpe(e,t){if(bd(),t=t||{},R1(t),Qi(e,"META-INF/manifest.xml")||Qi(e,"objectdata.xml"))return gk(e,t);if(Qi(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ky<"u"){if(e.FileIndex)return Ky(e);var r=at.utils.cfb_new();return EA(e).forEach(function(ie){xt(r,ie,Xie(e,ie))}),Ky(r)}throw new Error("Unsupported NUMBERS file")}if(!Qi(e,"[Content_Types].xml"))throw Qi(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Qi(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=EA(e),i=Wse(xi(e,"[Content_Types].xml")),s=!1,o,a;if(i.workbooks.length===0&&(a="xl/workbook.xml",Zr(e,a,!0)&&i.workbooks.push(a)),i.workbooks.length===0){if(a="xl/workbook.bin",!Zr(e,a,!0))throw new Error("Could not find workbook");i.workbooks.push(a),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var u={},d={};if(!t.bookSheets&&!t.bookProps){if(Kh=[],i.sst)try{Kh=hge(Zr(e,$i(i.sst)),i.sst,t)}catch(ie){if(t.WTF)throw ie}t.cellStyles&&i.themes.length&&(u=dge(xi(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(d=uge(Zr(e,$i(i.style)),i.style,u,t))}i.links.map(function(ie){try{var J=Yh(xi(e,Ef($i(ie))),ie);return pge(Zr(e,$i(ie)),J,ie,t)}catch{}});var h=sge(Zr(e,$i(i.workbooks[0])),i.workbooks[0],t),g={},m="";i.coreprops.length&&(m=Zr(e,$i(i.coreprops[0]),!0),m&&(g=EO(m)),i.extprops.length!==0&&(m=Zr(e,$i(i.extprops[0]),!0),m&&Xse(m,g,t)));var v={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(m=xi(e,$i(i.custprops[0]),!0),m&&(v=Zse(m,t)));var w={};if((t.bookSheets||t.bookProps)&&(h.Sheets?o=h.Sheets.map(function(J){return J.name}):g.Worksheets&&g.SheetNames.length>0&&(o=g.SheetNames),t.bookProps&&(w.Props=g,w.Custprops=v),t.bookSheets&&typeof o<"u"&&(w.SheetNames=o),t.bookSheets?w.SheetNames:t.bookProps))return w;o={};var C={};t.bookDeps&&i.calcchain&&(C=gge(Zr(e,$i(i.calcchain)),i.calcchain));var b=0,x={},R,E;{var A=h.Sheets;g.Worksheets=A.length,g.SheetNames=[];for(var D=0;D!=A.length;++D)g.SheetNames[D]=A[D].name}var M=s?"bin":"xml",F=i.workbooks[0].lastIndexOf("/"),O=(i.workbooks[0].slice(0,F+1)+"_rels/"+i.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");Qi(e,O)||(O="xl/_rels/workbook."+M+".rels");var L=Yh(xi(e,O,!0),O.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=mge(Zr(e,$i(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=Qce(Zr(e,$i(i.people[0])),t)),L&&(L=Npe(L,h.Sheets));var W=Zr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=g.Worksheets;++b){var I="sheet";if(L&&L[b]?(R="xl/"+L[b][1].replace(/[\/]?xl\//,""),Qi(e,R)||(R=L[b][1]),Qi(e,R)||(R=O.replace(/_rels\/.*$/,"")+L[b][1]),I=L[b][2]):(R="xl/worksheets/sheet"+(b+1-W)+"."+M,R=R.replace(/sheet0\./,"sheet.")),E=R.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(b!=t.sheets)continue e;break;case"string":if(g.SheetNames[b].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var G=!1,ne=0;ne!=t.sheets.length;++ne)typeof t.sheets[ne]=="number"&&t.sheets[ne]==b&&(G=1),typeof t.sheets[ne]=="string"&&t.sheets[ne].toLowerCase()==g.SheetNames[b].toLowerCase()&&(G=1);if(!G)continue e}}Bpe(e,R,E,g.SheetNames[b],b,x,o,I,t,h,u,d)}return w={Directory:i,Workbook:h,Props:g,Custprops:v,Deps:C,Sheets:o,SheetNames:g.SheetNames,Strings:Kh,Styles:d,Themes:u,SSF:vr(gt)},t&&t.bookFiles&&(e.files?(w.keys=n,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(ie,J){ie=ie.replace(/^Root Entry[\/]/,""),w.keys.push(ie),w.files[ie]=e.FileIndex[J]}))),t&&t.bookVBA&&(i.vba.length>0?w.vbaraw=Zr(e,$i(i.vba[0]),!0):i.defaults&&i.defaults.bin===sue&&(w.vbaraw=Zr(e,"xl/vbaProject.bin",!0))),w}function Gpe(e,t){var r=t||{},n="Workbook",i=at.find(e,n);try{if(n="/!DataSpaces/Version",i=at.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(mle(i.content),n="/!DataSpaces/DataSpaceMap",i=at.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=wle(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=at.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Cle(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=at.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);ble(i.content)}catch{}if(n="/EncryptionInfo",i=at.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=Sle(i.content);if(n="/EncryptedPackage",i=at.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(a[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(a[1],i.content,r.password||"",r);if(a[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(a[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function Vpe(e,t){return t.bookType=="ods"?IN(e,t):t.bookType=="numbers"?Ipe(e,t):t.bookType=="xlsb"?zpe(e,t):Wpe(e,t)}function zpe(e,t){Tu=1024,e&&!e.SSF&&(e.SSF=vr(gt)),e&&e.SSF&&(bd(),iv(e.SSF),t.revssf=ov(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,qh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=cN.indexOf(t.bookType)>-1,i=d1();T1(t=t||{});var s=Qx(),o="",a=0;if(t.cellXfs=[],al(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",xt(s,o,RO(e.Props,t)),i.coreprops.push(o),Qt(t.rels,2,o,Ft.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&u.push(e.SheetNames[d]);e.Props.SheetNames=u}for(e.Props.Worksheets=e.Props.SheetNames.length,xt(s,o,DO(e.Props)),i.extprops.push(o),Qt(t.rels,3,o,Ft.EXT_PROPS),e.Custprops!==e.Props&&Ir(e.Custprops||{}).length>0&&(o="docProps/custom.xml",xt(s,o,AO(e.Custprops)),i.custprops.push(o),Qt(t.rels,4,o,Ft.CUST_PROPS)),a=1;a<=e.SheetNames.length;++a){var h={"!id":{}},g=e.Sheets[e.SheetNames[a-1]],m=(g||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+a+"."+r,xt(s,o,wge(a-1,o,t,e,h)),i.sheets.push(o),Qt(t.wbrels,-1,"worksheets/sheet"+a+"."+r,Ft.WS[0])}if(g){var v=g["!comments"],w=!1,C="";v&&v.length>0&&(C="xl/comments"+a+"."+r,xt(s,C,bge(v,C)),i.comments.push(C),Qt(h,-1,"../comments"+a+"."+r,Ft.CMNT),w=!0),g["!legacy"]&&w&&xt(s,"xl/drawings/vmlDrawing"+a+".vml",aN(a,g["!comments"])),delete g["!comments"],delete g["!legacy"]}h["!id"].rId1&&xt(s,Ef(o),Vu(h))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,xt(s,o,yge(t.Strings,o,t)),i.strs.push(o),Qt(t.wbrels,-1,"sharedStrings."+r,Ft.SST)),o="xl/workbook."+r,xt(s,o,vge(e,o)),i.workbooks.push(o),Qt(t.rels,1,o,Ft.WB),o="xl/theme/theme1.xml",xt(s,o,v1(e.Themes,t)),i.themes.push(o),Qt(t.wbrels,-1,"theme/theme1.xml",Ft.THEME),o="xl/styles."+r,xt(s,o,Cge(e,o,t)),i.styles.push(o),Qt(t.wbrels,-1,"styles."+r,Ft.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",xt(s,o,e.vbaraw),i.vba.push(o),Qt(t.wbrels,-1,"vbaProject.bin",Ft.VBA)),o="xl/metadata."+r,xt(s,o,Sge(o)),i.metadata.push(o),Qt(t.wbrels,-1,"metadata."+r,Ft.XLMETA),xt(s,"[Content_Types].xml",SO(i,t)),xt(s,"_rels/.rels",Vu(t.rels)),xt(s,"xl/_rels/workbook."+r+".rels",Vu(t.wbrels)),delete t.revssf,delete t.ssf,s}function Wpe(e,t){Tu=1024,e&&!e.SSF&&(e.SSF=vr(gt)),e&&e.SSF&&(bd(),iv(e.SSF),t.revssf=ov(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,qh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=cN.indexOf(t.bookType)>-1,i=d1();T1(t=t||{});var s=Qx(),o="",a=0;if(t.cellXfs=[],al(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",xt(s,o,RO(e.Props,t)),i.coreprops.push(o),Qt(t.rels,2,o,Ft.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&u.push(e.SheetNames[d]);e.Props.SheetNames=u}e.Props.Worksheets=e.Props.SheetNames.length,xt(s,o,DO(e.Props)),i.extprops.push(o),Qt(t.rels,3,o,Ft.EXT_PROPS),e.Custprops!==e.Props&&Ir(e.Custprops||{}).length>0&&(o="docProps/custom.xml",xt(s,o,AO(e.Custprops)),i.custprops.push(o),Qt(t.rels,4,o,Ft.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,a=1;a<=e.SheetNames.length;++a){var g={"!id":{}},m=e.Sheets[e.SheetNames[a-1]],v=(m||{})["!type"]||"sheet";switch(v){case"chart":default:o="xl/worksheets/sheet"+a+"."+r,xt(s,o,yN(a-1,t,e,g)),i.sheets.push(o),Qt(t.wbrels,-1,"worksheets/sheet"+a+"."+r,Ft.WS[0])}if(m){var w=m["!comments"],C=!1,b="";if(w&&w.length>0){var x=!1;w.forEach(function(R){R[1].forEach(function(E){E.T==!0&&(x=!0)})}),x&&(b="xl/threadedComments/threadedComment"+a+"."+r,xt(s,b,Xce(w,h,t)),i.threadedcomments.push(b),Qt(g,-1,"../threadedComments/threadedComment"+a+"."+r,Ft.TCMNT)),b="xl/comments"+a+"."+r,xt(s,b,lN(w)),i.comments.push(b),Qt(g,-1,"../comments"+a+"."+r,Ft.CMNT),C=!0}m["!legacy"]&&C&&xt(s,"xl/drawings/vmlDrawing"+a+".vml",aN(a,m["!comments"])),delete m["!comments"],delete m["!legacy"]}g["!id"].rId1&&xt(s,Ef(o),Vu(g))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,xt(s,o,qO(t.Strings,t)),i.strs.push(o),Qt(t.wbrels,-1,"sharedStrings."+r,Ft.SST)),o="xl/workbook."+r,xt(s,o,RN(e)),i.workbooks.push(o),Qt(t.rels,1,o,Ft.WB),o="xl/theme/theme1.xml",xt(s,o,v1(e.Themes,t)),i.themes.push(o),Qt(t.wbrels,-1,"theme/theme1.xml",Ft.THEME),o="xl/styles."+r,xt(s,o,nN(e,t)),i.styles.push(o),Qt(t.wbrels,-1,"styles."+r,Ft.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",xt(s,o,e.vbaraw),i.vba.push(o),Qt(t.wbrels,-1,"vbaProject.bin",Ft.VBA)),o="xl/metadata."+r,xt(s,o,oN()),i.metadata.push(o),Qt(t.wbrels,-1,"metadata."+r,Ft.XLMETA),h.length>1&&(o="xl/persons/person.xml",xt(s,o,Zce(h)),i.people.push(o),Qt(t.wbrels,-1,"persons/person.xml",Ft.PEOPLE)),xt(s,"[Content_Types].xml",SO(i,t)),xt(s,"_rels/.rels",Vu(t.rels)),xt(s,"xl/_rels/workbook."+r+".rels",Vu(t.wbrels)),delete t.revssf,delete t.ssf,s}function F1(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ai(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Upe(e,t){return at.find(e,"EncryptedPackage")?Gpe(e,t):AN(e,t)}function $pe(e,t){var r,n=e,i=t||{};return i.type||(i.type=Rt&&Buffer.isBuffer(e)?"buffer":"base64"),r=QI(n,i),Hpe(r,i)}function NN(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return oS(e.slice(r),t);default:break e}return id.to_workbook(e,t)}function jpe(e,t){var r="",n=F1(e,t);switch(t.type){case"base64":r=Ai(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=oc(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=sr(r)),t.type="binary",NN(r,t)}function Ype(e,t){var r=e;return t.type=="base64"&&(r=Ai(r)),r=wf.utils.decode(1200,r.slice(2),"str"),t.type="binary",NN(r,t)}function Kpe(e){return e.match(/[^\x00-\x7F]/)?Xs(e):e}function qy(e,t,r,n){return n?(r.type="string",id.to_workbook(e,r)):id.to_workbook(t,r)}function cS(e,t){jx();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return cS(new Uint8Array(e),(r=vr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Wu={},r.dateNF&&(Wu.dateNF=r.dateNF),r.type||(r.type=Rt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Rt?"buffer":"binary",n=zie(e),typeof Uint8Array<"u"&&!Rt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=Kpe(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),a=new Uint8Array(o);if(a.foo="bar",!a.foo)return r=vr(r),r.type="array",cS(Yx(n),r)}switch((i=F1(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return Upe(at.read(n,r),r);break;case 9:if(i[1]<=8)return AN(n,r);break;case 60:return oS(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return Jae(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return YO.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?$pe(n,r):qy(e,n,r,s);case 239:return i[3]===60?oS(n,r):qy(e,n,r,s);case 255:if(i[1]===254)return Ype(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Kl.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Kl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return sS.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return eN.to_workbook(n,r);break;case 10:case 13:case 32:return jpe(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Zae.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?sS.to_workbook(n,r):qy(e,n,r,s)}function BN(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Yf(t.file,at.write(e,{type:Rt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return at.write(e,t)}function qpe(e,t){var r=vr(t||{}),n=Vpe(e,r);return Xpe(n,r)}function Xpe(e,t){var r={},n=Rt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?at.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(nv(i))}return t.password&&typeof encrypt_agile<"u"?BN(encrypt_agile(i,t.password),t):t.type==="file"?Yf(t.file,i):t.type=="string"?sr(i):i}function Qpe(e,t){var r=t||{},n=Kge(e,r);return BN(n,r)}function Vs(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Cf(Xs(n));case"binary":return Xs(n);case"string":return e;case"file":return Yf(t.file,n,"utf8");case"buffer":return Rt?ta(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Vs(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Zpe(e,t){switch(t.type){case"base64":return Cf(e);case"binary":return e;case"string":return e;case"file":return Yf(t.file,e,"binary");case"buffer":return Rt?ta(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function jp(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Cf(r):t.type=="string"?sr(r):r;case"file":return Yf(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function HN(e,t){jx(),Ufe(e);var r=vr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=HN(e,r);return r.type="array",nv(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Vs(Vge(e,r),r);case"slk":case"sylk":return Vs(jO.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return Vs(PN(e.Sheets[e.SheetNames[i]],r),r);case"txt":return Zpe(GN(e.Sheets[e.SheetNames[i]],r),r);case"csv":return Vs(D1(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return Vs(YO.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return jp(sS.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return Vs(id.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return Vs(eN.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return Vs(KO.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return Vs(IN(e,r),r);case"wk1":return jp(Kl.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return jp(Kl.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),jp(kN(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Qpe(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return qpe(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Jpe(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function e0e(e,t,r){var n={};return n.type="file",n.file=t,Jpe(n),HN(e,n)}function t0e(e,t,r,n,i,s,o,a){var u=zr(r),d=a.defval,h=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),g=!0,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!o||e[r])for(var v=t.s.c;v<=t.e.c;++v){var w=o?e[r][v]:e[n[v]+u];if(w===void 0||w.t===void 0){if(d===void 0)continue;s[v]!=null&&(m[s[v]]=d);continue}var C=w.v;switch(w.t){case"z":if(C==null)break;continue;case"e":C=C==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(s[v]!=null){if(C==null)if(w.t=="e"&&C===null)m[s[v]]=null;else if(d!==void 0)m[s[v]]=d;else if(h&&C===null)m[s[v]]=null;else continue;else m[s[v]]=h&&(w.t!=="n"||w.t==="n"&&a.rawNumbers!==!1)?C:Ko(w,C,a);C!=null&&(g=!1)}}return{row:m,isempty:g}}function om(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],o=0,a="",u={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},h=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof h){case"string":u=Ht(h);break;case"number":u=Ht(e["!ref"]),u.s.r=h;break;default:u=h}n>0&&(i=0);var g=zr(u.s.r),m=[],v=[],w=0,C=0,b=Array.isArray(e),x=u.s.r,R=0,E={};b&&!e[x]&&(e[x]=[]);var A=d.skipHidden&&e["!cols"]||[],D=d.skipHidden&&e["!rows"]||[];for(R=u.s.c;R<=u.e.c;++R)if(!(A[R]||{}).hidden)switch(m[R]=Rr(R),r=b?e[x][R]:e[m[R]+g],n){case 1:s[R]=R-u.s.c;break;case 2:s[R]=m[R];break;case 3:s[R]=d.header[R-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),a=o=Ko(r,null,d),C=E[o]||0,!C)E[o]=1;else{do a=o+"_"+C++;while(E[a]);E[o]=C,E[a]=1}s[R]=a}for(x=u.s.r+i;x<=u.e.r;++x)if(!(D[x]||{}).hidden){var M=t0e(e,u,x,m,n,s,b,d);(M.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(v[w++]=M.row)}return v.length=w,v}var Ck=/"/g;function r0e(e,t,r,n,i,s,o,a){for(var u=!0,d=[],h="",g=zr(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var v=a.dense?(e[r]||[])[m]:e[n[m]+g];if(v==null)h="";else if(v.v!=null){u=!1,h=""+(a.rawNumbers&&v.t=="n"?v.v:Ko(v,null,a));for(var w=0,C=0;w!==h.length;++w)if((C=h.charCodeAt(w))===i||C===s||C===34||a.forceQuotes){h='"'+h.replace(Ck,'""')+'"';break}h=="ID"&&(h='"ID"')}else v.f!=null&&!v.F?(u=!1,h="="+v.f,h.indexOf(",")>=0&&(h='"'+h.replace(Ck,'""')+'"')):h="";d.push(h)}return a.blankrows===!1&&u?null:d.join(o)}function D1(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=Ht(e["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),a=n.RS!==void 0?n.RS:`
`,u=a.charCodeAt(0),d=new RegExp((s=="|"?"\\|":s)+"+$"),h="",g=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],v=n.skipHidden&&e["!rows"]||[],w=i.s.c;w<=i.e.c;++w)(m[w]||{}).hidden||(g[w]=Rr(w));for(var C=0,b=i.s.r;b<=i.e.r;++b)(v[b]||{}).hidden||(h=r0e(e,i,b,g,o,u,s,n),h!=null&&(n.strip&&(h=h.replace(d,"")),(h||n.blankrows!==!1)&&r.push((C++?a:"")+h)));return delete n.dense,r.join("")}function GN(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=D1(e,t);return r}function n0e(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=Ht(e["!ref"]),s="",o=[],a,u=[],d=Array.isArray(e);for(a=i.s.c;a<=i.e.c;++a)o[a]=Rr(a);for(var h=i.s.r;h<=i.e.r;++h)for(s=zr(h),a=i.s.c;a<=i.e.c;++a)if(t=o[a]+s,r=d?(e[h]||[])[a]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=t+"="+n}return u}function VN(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},o=0,a=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Tr(n.origin):n.origin;o=u.r,a=u.c}var d,h={s:{c:0,r:0},e:{c:a,r:o+t.length-1+i}};if(s["!ref"]){var g=Ht(s["!ref"]);h.e.c=Math.max(h.e.c,g.e.c),h.e.r=Math.max(h.e.r,g.e.r),o==-1&&(o=g.e.r+1,h.e.r=o+t.length-1+i)}else o==-1&&(o=0,h.e.r=t.length-1+i);var m=n.header||[],v=0;t.forEach(function(C,b){Ir(C).forEach(function(x){(v=m.indexOf(x))==-1&&(m[v=m.length]=x);var R=C[x],E="z",A="",D=pt({c:a+v,r:o+b+i});d=Pf(s,D),R&&typeof R=="object"&&!(R instanceof Date)?s[D]=R:(typeof R=="number"?E="n":typeof R=="boolean"?E="b":typeof R=="string"?E="s":R instanceof Date?(E="d",n.cellDates||(E="n",R=rn(R)),A=n.dateNF||gt[14]):R===null&&n.nullError&&(E="e",R=0),d?(d.t=E,d.v=R,delete d.w,delete d.R,A&&(d.z=A)):s[D]=d={t:E,v:R},A&&(d.z=A))})}),h.e.c=Math.max(h.e.c,a+m.length-1);var w=zr(o);if(i)for(v=0;v<m.length;++v)s[Rr(v+a)+w]={t:"s",v:m[v]};return s["!ref"]=bt(h),s}function i0e(e,t){return VN(null,e,t)}function Pf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Tr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Pf(e,pt(t)):Pf(e,pt({r:t,c:r||0}))}function s0e(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function A1(){return{SheetNames:[],Sheets:{}}}function k1(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(EN(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function o0e(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=s0e(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function a0e(e,t){return e.z=t,e}function zN(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function l0e(e,t,r){return zN(e,"#"+t,r)}function c0e(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function u0e(e,t,r,n){for(var i=typeof t!="string"?t:Ht(t),s=typeof t=="string"?t:bt(t),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var u=Pf(e,o,a);u.t="n",u.F=s,delete u.v,o==i.s.r&&a==i.s.c&&(u.f=r,n&&(u.D=!0))}return e}var Yp={encode_col:Rr,encode_row:zr,encode_cell:pt,encode_range:bt,decode_col:s1,decode_row:i1,split_cell:yse,decode_cell:Tr,decode_range:di,format_cell:Ko,sheet_add_aoa:pO,sheet_add_json:VN,sheet_add_dom:MN,aoa_to_sheet:Sd,json_to_sheet:i0e,table_to_sheet:_N,table_to_book:mpe,sheet_to_csv:D1,sheet_to_txt:GN,sheet_to_json:om,sheet_to_html:PN,sheet_to_formulae:n0e,sheet_to_row_object_array:om,sheet_get_cell:Pf,book_new:A1,book_append_sheet:k1,book_set_sheet_visibility:o0e,cell_set_number_format:a0e,cell_set_hyperlink:zN,cell_set_internal_link:l0e,cell_add_comment:c0e,sheet_set_array_formula:u0e,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},g0={exports:{}},d0e=g0.exports,yk;function WN(){return yk||(yk=1,(function(e,t){(function(r,n){e.exports=n()})(d0e,(function(){var r=1e3,n=6e4,i=36e5,s="millisecond",o="second",a="minute",u="hour",d="day",h="week",g="month",m="quarter",v="year",w="date",C="Invalid Date",b=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,x=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,R={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(ie){var J=["th","st","nd","rd"],_=ie%100;return"["+ie+(J[(_-20)%10]||J[_]||J[0])+"]"}},E=function(ie,J,_){var Y=String(ie);return!Y||Y.length>=J?ie:""+Array(J+1-Y.length).join(_)+ie},A={s:E,z:function(ie){var J=-ie.utcOffset(),_=Math.abs(J),Y=Math.floor(_/60),Q=_%60;return(J<=0?"+":"-")+E(Y,2,"0")+":"+E(Q,2,"0")},m:function ie(J,_){if(J.date()<_.date())return-ie(_,J);var Y=12*(_.year()-J.year())+(_.month()-J.month()),Q=J.clone().add(Y,g),U=_-Q<0,se=J.clone().add(Y+(U?-1:1),g);return+(-(Y+(_-Q)/(U?Q-se:se-Q))||0)},a:function(ie){return ie<0?Math.ceil(ie)||0:Math.floor(ie)},p:function(ie){return{M:g,y:v,w:h,d,D:w,h:u,m:a,s:o,ms:s,Q:m}[ie]||String(ie||"").toLowerCase().replace(/s$/,"")},u:function(ie){return ie===void 0}},D="en",M={};M[D]=R;var F="$isDayjsObject",O=function(ie){return ie instanceof G||!(!ie||!ie[F])},L=function ie(J,_,Y){var Q;if(!J)return D;if(typeof J=="string"){var U=J.toLowerCase();M[U]&&(Q=U),_&&(M[U]=_,Q=U);var se=J.split("-");if(!Q&&se.length>1)return ie(se[0])}else{var N=J.name;M[N]=J,Q=N}return!Y&&Q&&(D=Q),Q||!Y&&D},W=function(ie,J){if(O(ie))return ie.clone();var _=typeof J=="object"?J:{};return _.date=ie,_.args=arguments,new G(_)},I=A;I.l=L,I.i=O,I.w=function(ie,J){return W(ie,{locale:J.$L,utc:J.$u,x:J.$x,$offset:J.$offset})};var G=(function(){function ie(_){this.$L=L(_.locale,null,!0),this.parse(_),this.$x=this.$x||_.x||{},this[F]=!0}var J=ie.prototype;return J.parse=function(_){this.$d=(function(Y){var Q=Y.date,U=Y.utc;if(Q===null)return new Date(NaN);if(I.u(Q))return new Date;if(Q instanceof Date)return new Date(Q);if(typeof Q=="string"&&!/Z$/i.test(Q)){var se=Q.match(b);if(se){var N=se[2]-1||0,P=(se[7]||"0").substring(0,3);return U?new Date(Date.UTC(se[1],N,se[3]||1,se[4]||0,se[5]||0,se[6]||0,P)):new Date(se[1],N,se[3]||1,se[4]||0,se[5]||0,se[6]||0,P)}}return new Date(Q)})(_),this.init()},J.init=function(){var _=this.$d;this.$y=_.getFullYear(),this.$M=_.getMonth(),this.$D=_.getDate(),this.$W=_.getDay(),this.$H=_.getHours(),this.$m=_.getMinutes(),this.$s=_.getSeconds(),this.$ms=_.getMilliseconds()},J.$utils=function(){return I},J.isValid=function(){return this.$d.toString()!==C},J.isSame=function(_,Y){var Q=W(_);return this.startOf(Y)<=Q&&Q<=this.endOf(Y)},J.isAfter=function(_,Y){return W(_)<this.startOf(Y)},J.isBefore=function(_,Y){return this.endOf(Y)<W(_)},J.$g=function(_,Y,Q){return I.u(_)?this[Y]:this.set(Q,_)},J.unix=function(){return Math.floor(this.valueOf()/1e3)},J.valueOf=function(){return this.$d.getTime()},J.startOf=function(_,Y){var Q=this,U=!!I.u(Y)||Y,se=I.p(_),N=function(de,ue){var Ie=I.w(Q.$u?Date.UTC(Q.$y,ue,de):new Date(Q.$y,ue,de),Q);return U?Ie:Ie.endOf(d)},P=function(de,ue){return I.w(Q.toDate()[de].apply(Q.toDate("s"),(U?[0,0,0,0]:[23,59,59,999]).slice(ue)),Q)},V=this.$W,H=this.$M,j=this.$D,ae="set"+(this.$u?"UTC":"");switch(se){case v:return U?N(1,0):N(31,11);case g:return U?N(1,H):N(0,H+1);case h:var fe=this.$locale().weekStart||0,le=(V<fe?V+7:V)-fe;return N(U?j-le:j+(6-le),H);case d:case w:return P(ae+"Hours",0);case u:return P(ae+"Minutes",1);case a:return P(ae+"Seconds",2);case o:return P(ae+"Milliseconds",3);default:return this.clone()}},J.endOf=function(_){return this.startOf(_,!1)},J.$set=function(_,Y){var Q,U=I.p(_),se="set"+(this.$u?"UTC":""),N=(Q={},Q[d]=se+"Date",Q[w]=se+"Date",Q[g]=se+"Month",Q[v]=se+"FullYear",Q[u]=se+"Hours",Q[a]=se+"Minutes",Q[o]=se+"Seconds",Q[s]=se+"Milliseconds",Q)[U],P=U===d?this.$D+(Y-this.$W):Y;if(U===g||U===v){var V=this.clone().set(w,1);V.$d[N](P),V.init(),this.$d=V.set(w,Math.min(this.$D,V.daysInMonth())).$d}else N&&this.$d[N](P);return this.init(),this},J.set=function(_,Y){return this.clone().$set(_,Y)},J.get=function(_){return this[I.p(_)]()},J.add=function(_,Y){var Q,U=this;_=Number(_);var se=I.p(Y),N=function(H){var j=W(U);return I.w(j.date(j.date()+Math.round(H*_)),U)};if(se===g)return this.set(g,this.$M+_);if(se===v)return this.set(v,this.$y+_);if(se===d)return N(1);if(se===h)return N(7);var P=(Q={},Q[a]=n,Q[u]=i,Q[o]=r,Q)[se]||1,V=this.$d.getTime()+_*P;return I.w(V,this)},J.subtract=function(_,Y){return this.add(-1*_,Y)},J.format=function(_){var Y=this,Q=this.$locale();if(!this.isValid())return Q.invalidDate||C;var U=_||"YYYY-MM-DDTHH:mm:ssZ",se=I.z(this),N=this.$H,P=this.$m,V=this.$M,H=Q.weekdays,j=Q.months,ae=Q.meridiem,fe=function(ue,Ie,q,Ge){return ue&&(ue[Ie]||ue(Y,U))||q[Ie].slice(0,Ge)},le=function(ue){return I.s(N%12||12,ue,"0")},de=ae||function(ue,Ie,q){var Ge=ue<12?"AM":"PM";return q?Ge.toLowerCase():Ge};return U.replace(x,(function(ue,Ie){return Ie||(function(q){switch(q){case"YY":return String(Y.$y).slice(-2);case"YYYY":return I.s(Y.$y,4,"0");case"M":return V+1;case"MM":return I.s(V+1,2,"0");case"MMM":return fe(Q.monthsShort,V,j,3);case"MMMM":return fe(j,V);case"D":return Y.$D;case"DD":return I.s(Y.$D,2,"0");case"d":return String(Y.$W);case"dd":return fe(Q.weekdaysMin,Y.$W,H,2);case"ddd":return fe(Q.weekdaysShort,Y.$W,H,3);case"dddd":return H[Y.$W];case"H":return String(N);case"HH":return I.s(N,2,"0");case"h":return le(1);case"hh":return le(2);case"a":return de(N,P,!0);case"A":return de(N,P,!1);case"m":return String(P);case"mm":return I.s(P,2,"0");case"s":return String(Y.$s);case"ss":return I.s(Y.$s,2,"0");case"SSS":return I.s(Y.$ms,3,"0");case"Z":return se}return null})(ue)||se.replace(":","")}))},J.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},J.diff=function(_,Y,Q){var U,se=this,N=I.p(Y),P=W(_),V=(P.utcOffset()-this.utcOffset())*n,H=this-P,j=function(){return I.m(se,P)};switch(N){case v:U=j()/12;break;case g:U=j();break;case m:U=j()/3;break;case h:U=(H-V)/6048e5;break;case d:U=(H-V)/864e5;break;case u:U=H/i;break;case a:U=H/n;break;case o:U=H/r;break;default:U=H}return Q?U:I.a(U)},J.daysInMonth=function(){return this.endOf(g).$D},J.$locale=function(){return M[this.$L]},J.locale=function(_,Y){if(!_)return this.$L;var Q=this.clone(),U=L(_,Y,!0);return U&&(Q.$L=U),Q},J.clone=function(){return I.w(this.$d,this)},J.toDate=function(){return new Date(this.valueOf())},J.toJSON=function(){return this.isValid()?this.toISOString():null},J.toISOString=function(){return this.$d.toISOString()},J.toString=function(){return this.$d.toUTCString()},ie})(),ne=G.prototype;return W.prototype=ne,[["$ms",s],["$s",o],["$m",a],["$H",u],["$W",d],["$M",g],["$y",v],["$D",w]].forEach((function(ie){ne[ie[1]]=function(J){return this.$g(J,ie[0],ie[1])}})),W.extend=function(ie,J){return ie.$i||(ie(J,G,W),ie.$i=!0),W},W.locale=L,W.isDayjs=O,W.unix=function(ie){return W(1e3*ie)},W.en=M[D],W.Ls=M,W.p={},W}))})(g0)),g0.exports}var h0e=WN();const He=Mf(h0e);function f0e({type:e,date:t,locale:r,format:n,labelSeparator:i}){const s=o=>He(o).locale(r).format(n);return e==="default"?t===null?"":s(t):e==="multiple"?t.map(s).join(", "):e==="range"&&Array.isArray(t)?t[0]&&t[1]?`${s(t[0])} ${i} ${s(t[1])}`:t[0]?`${s(t[0])} ${i} `:"":""}function g0e({formatter:e,...t}){return(e||f0e)(t)}function p0e({direction:e,levelIndex:t,rowIndex:r,cellIndex:n,size:i}){switch(e){case"up":return t===0&&r===0?null:r===0?{levelIndex:t-1,rowIndex:n<=i[t-1][i[t-1].length-1]-1?i[t-1].length-1:i[t-1].length-2,cellIndex:n}:{levelIndex:t,rowIndex:r-1,cellIndex:n};case"down":return r===i[t].length-1?{levelIndex:t+1,rowIndex:0,cellIndex:n}:r===i[t].length-2&&n>=i[t][i[t].length-1]?{levelIndex:t+1,rowIndex:0,cellIndex:n}:{levelIndex:t,rowIndex:r+1,cellIndex:n};case"left":return t===0&&r===0&&n===0?null:r===0&&n===0?{levelIndex:t-1,rowIndex:i[t-1].length-1,cellIndex:i[t-1][i[t-1].length-1]-1}:n===0?{levelIndex:t,rowIndex:r-1,cellIndex:i[t][r-1]-1}:{levelIndex:t,rowIndex:r,cellIndex:n-1};case"right":return r===i[t].length-1&&n===i[t][r]-1?{levelIndex:t+1,rowIndex:0,cellIndex:0}:n===i[t][r]-1?{levelIndex:t,rowIndex:r+1,cellIndex:0}:{levelIndex:t,rowIndex:r,cellIndex:n+1};default:return{levelIndex:t,rowIndex:r,cellIndex:n}}}function UN({controlsRef:e,direction:t,levelIndex:r,rowIndex:n,cellIndex:i,size:s}){const o=p0e({direction:t,size:s,rowIndex:n,cellIndex:i,levelIndex:r});if(!o)return;const a=e.current?.[o.levelIndex]?.[o.rowIndex]?.[o.cellIndex];a&&(a.disabled||a.getAttribute("data-hidden")||a.getAttribute("data-outside")?UN({controlsRef:e,direction:t,levelIndex:o.levelIndex,cellIndex:o.cellIndex,rowIndex:o.rowIndex,size:s}):a.focus())}function m0e(e){switch(e){case"ArrowDown":return"down";case"ArrowUp":return"up";case"ArrowRight":return"right";case"ArrowLeft":return"left";default:return null}}function v0e(e){return e.current?.map(t=>t.map(r=>r.length))}function P1({controlsRef:e,levelIndex:t,rowIndex:r,cellIndex:n,event:i}){const s=m0e(i.key);if(s){i.preventDefault();const o=v0e(e);UN({controlsRef:e,direction:s,levelIndex:t,rowIndex:r,cellIndex:n,size:o})}}function Mn(e){return e==null||e===""?e:He(e).format("YYYY-MM-DD")}function $N(e){return e==null||e===""?e:He(e).format("YYYY-MM-DD HH:mm:ss")}function w0e({minDate:e,maxDate:t}){const r=He();return!e&&!t?Mn(r):e&&He(r).isBefore(e)?Mn(e):t&&He(r).isAfter(t)?Mn(t):Mn(r)}const jN={locale:"en",firstDayOfWeek:1,weekendDays:[0,6],labelSeparator:"",consistentWeeks:!1},YN=T.createContext(jN);function bk({settings:e,children:t}){return Z.jsx(YN.Provider,{value:{...jN,...e},children:t})}function ll(){const e=T.useContext(YN),t=T.useCallback(s=>s||e.locale,[e.locale]),r=T.useCallback(s=>typeof s=="number"?s:e.firstDayOfWeek,[e.firstDayOfWeek]),n=T.useCallback(s=>Array.isArray(s)?s:e.weekendDays,[e.weekendDays]),i=T.useCallback(s=>typeof s=="string"?s:e.labelSeparator,[e.labelSeparator]);return{...e,getLocale:t,getFirstDayOfWeek:r,getWeekendDays:n,getLabelSeparator:i}}function C0e({value:e,type:t,withTime:r}){const n=r?$N:Mn;if(t==="range"&&Array.isArray(e)){const i=n(e[0]),s=n(e[1]);return i?s?`${i}  ${s}`:`${i} `:""}return t==="multiple"&&Array.isArray(e)?e.filter(Boolean).join(", "):!Array.isArray(e)&&e?n(e):""}function KN({value:e,type:t,name:r,form:n,withTime:i=!1}){return Z.jsx("input",{type:"hidden",value:C0e({value:e,type:t,withTime:i}),name:r,form:n})}KN.displayName="@mantine/dates/HiddenDatesInput";var qN={day:"m_396ce5cb"};const y0e=(e,{size:t})=>({day:{"--day-size":$n(t,"day-size")}}),M1=ct((e,t)=>{const r=rt("Day",null,e),{classNames:n,className:i,style:s,styles:o,unstyled:a,vars:u,date:d,disabled:h,__staticSelector:g,weekend:m,outside:v,selected:w,renderDay:C,inRange:b,firstInRange:x,lastInRange:R,hidden:E,static:A,highlightToday:D,attributes:M,...F}=r,O=wr({name:g||"Day",classes:qN,props:r,className:i,style:s,classNames:n,styles:o,unstyled:a,attributes:M,vars:u,varsResolver:y0e,rootSelector:"day"});return Z.jsx(Bo,{...O("day",{style:E?{display:"none"}:void 0}),component:A?"div":"button",ref:t,disabled:h,"data-today":He(d).isSame(new Date,"day")||void 0,"data-hidden":E||void 0,"data-highlight-today":D||void 0,"data-disabled":h||void 0,"data-weekend":!h&&!v&&m||void 0,"data-outside":!h&&v||void 0,"data-selected":!h&&w||void 0,"data-in-range":b&&!h||void 0,"data-first-in-range":x&&!h||void 0,"data-last-in-range":R&&!h||void 0,"data-static":A||void 0,unstyled:a,...F,children:C?.(d)||He(d).date()})});M1.classes=qN;M1.displayName="@mantine/dates/Day";function b0e({locale:e,format:t="dd",firstDayOfWeek:r=1}){const n=He().day(r),i=[];for(let s=0;s<7;s+=1)typeof t=="string"?i.push(He(n).add(s,"days").locale(e).format(t)):i.push(t(He(n).add(s,"days").format("YYYY-MM-DD")));return i}var XN={weekday:"m_18a3eca"};const S0e=(e,{size:t})=>({weekdaysRow:{"--wr-fz":si(t),"--wr-spacing":iP(t)}}),_1=ct((e,t)=>{const r=rt("WeekdaysRow",null,e),{classNames:n,className:i,style:s,styles:o,unstyled:a,vars:u,locale:d,firstDayOfWeek:h,weekdayFormat:g,cellComponent:m="th",__staticSelector:v,withWeekNumbers:w,attributes:C,...b}=r,x=wr({name:v||"WeekdaysRow",classes:XN,props:r,className:i,style:s,classNames:n,styles:o,unstyled:a,attributes:C,vars:u,varsResolver:S0e,rootSelector:"weekdaysRow"}),R=ll(),E=b0e({locale:R.getLocale(d),format:g,firstDayOfWeek:R.getFirstDayOfWeek(h)}).map((A,D)=>Z.jsx(m,{...x("weekday"),children:A},D));return Z.jsxs(Dt,{component:"tr",ref:t,...x("weekdaysRow"),...b,children:[w&&Z.jsx(m,{...x("weekday"),children:"#"}),E]})});_1.classes=XN;_1.displayName="@mantine/dates/WeekdaysRow";function x0e(e,t=1){let r=He(e);if(!r.isValid())return r;const n=t===0?6:t-1;for(;r.day()!==n;)r=r.add(1,"day");return r.format("YYYY-MM-DD")}function E0e(e,t=1){let r=He(e);for(;r.day()!==t;)r=r.subtract(1,"day");return r.format("YYYY-MM-DD")}function R0e({month:e,firstDayOfWeek:t=1,consistentWeeks:r}){const n=He(e).subtract(He(e).date()-1,"day"),i=He(n.format("YYYY-M-D")),s=i.format("YYYY-MM-DD"),o=i.add(+i.daysInMonth()-1,"day").format("YYYY-MM-DD"),a=x0e(o,t),u=[];let d=He(E0e(s,t));for(;He(d).isBefore(a,"day");){const h=[];for(let g=0;g<7;g+=1)h.push(d.format("YYYY-MM-DD")),d=d.add(1,"day");u.push(h)}if(r&&u.length<6){const h=u[u.length-1],g=h[h.length-1];let m=He(g).add(1,"day");for(;u.length<6;){const v=[];for(let w=0;w<7;w+=1)v.push(m.format("YYYY-MM-DD")),m=m.add(1,"day");u.push(v)}}return u}function L1(e,t){return He(e).format("YYYY-MM")===He(t).format("YYYY-MM")}function QN(e,t){return t?He(e).isAfter(He(t).subtract(1,"day"),"day"):!0}function ZN(e,t){return t?He(e).isBefore(He(t).add(1,"day"),"day"):!0}function T0e({dates:e,minDate:t,maxDate:r,getDayProps:n,excludeDate:i,hideOutsideDates:s,month:o}){const a=e.flat().filter(h=>ZN(h,r)&&QN(h,t)&&!i?.(h)&&!n?.(h)?.disabled&&(!s||L1(h,o))),u=a.find(h=>n?.(h)?.selected);if(u)return u;const d=a.find(h=>He().isSame(h,"date"));return d||a[0]}var p0={exports:{}},F0e=p0.exports,Sk;function D0e(){return Sk||(Sk=1,(function(e,t){(function(r,n){e.exports=n()})(F0e,(function(){var r="day";return function(n,i,s){var o=function(d){return d.add(4-d.isoWeekday(),r)},a=i.prototype;a.isoWeekYear=function(){return o(this).year()},a.isoWeek=function(d){if(!this.$utils().u(d))return this.add(7*(d-this.isoWeek()),r);var h,g,m,v,w=o(this),C=(h=this.isoWeekYear(),g=this.$u,m=(g?s.utc:s)().year(h).startOf("year"),v=4-m.isoWeekday(),m.isoWeekday()>4&&(v+=7),m.add(v,r));return w.diff(C,"week")+1},a.isoWeekday=function(d){return this.$utils().u(d)?this.day()||7:this.day(this.day()%7?d:d-7)};var u=a.startOf;a.startOf=function(d,h){var g=this.$utils(),m=!!g.u(h)||h;return g.p(d)==="isoweek"?m?this.date(this.date()-(this.isoWeekday()-1)).startOf("day"):this.date(this.date()-1-(this.isoWeekday()-1)+7).endOf("day"):u.bind(this)(d,h)}}}))})(p0)),p0.exports}var A0e=D0e();const k0e=Mf(A0e);He.extend(k0e);function P0e(e){const t=e.find(r=>He(r).day()===1);return He(t).isoWeek()}var JN={month:"m_cc9820d3",monthCell:"m_8f457cd5",weekNumber:"m_6cff9dea"};const M0e={withCellSpacing:!0},_0e=(e,{size:t})=>({weekNumber:{"--wn-fz":si(t),"--wn-size":$n(t,"wn-size")}}),hv=ct((e,t)=>{const r=rt("Month",M0e,e),{classNames:n,className:i,style:s,styles:o,unstyled:a,vars:u,__staticSelector:d,locale:h,firstDayOfWeek:g,weekdayFormat:m,month:v,weekendDays:w,getDayProps:C,excludeDate:b,minDate:x,maxDate:R,renderDay:E,hideOutsideDates:A,hideWeekdays:D,getDayAriaLabel:M,static:F,__getDayRef:O,__onDayKeyDown:L,__onDayClick:W,__onDayMouseEnter:I,__preventFocus:G,__stopPropagation:ne,withCellSpacing:ie,size:J,highlightToday:_,withWeekNumbers:Y,attributes:Q,...U}=r,se=wr({name:d||"Month",classes:JN,props:r,className:i,style:s,classNames:n,styles:o,unstyled:a,attributes:Q,vars:u,varsResolver:_0e,rootSelector:"month"}),N=ll(),P=R0e({month:v,firstDayOfWeek:N.getFirstDayOfWeek(g),consistentWeeks:N.consistentWeeks}),V=T0e({dates:P,minDate:Mn(x),maxDate:Mn(R),getDayProps:C,excludeDate:b,hideOutsideDates:A,month:v}),{resolvedClassNames:H,resolvedStyles:j}=fc({classNames:n,styles:o,props:r}),ae=P.map((fe,le)=>{const de=fe.map((ue,Ie)=>{const q=!L1(ue,v),Ge=M?.(ue)||He(ue).locale(h||N.locale).format("D MMMM YYYY"),Ye=C?.(ue),Ze=He(ue).isSame(V,"date");return Z.jsx("td",{...se("monthCell"),"data-with-spacing":ie||void 0,children:Z.jsx(M1,{__staticSelector:d||"Month",classNames:H,styles:j,unstyled:a,"data-mantine-stop-propagation":ne||void 0,highlightToday:_,renderDay:E,date:ue,size:J,weekend:N.getWeekendDays(w).includes(He(ue).get("day")),outside:q,hidden:A?q:!1,"aria-label":Ge,static:F,disabled:b?.(ue)||!ZN(ue,Mn(R))||!QN(ue,Mn(x)),ref:ke=>{ke&&O?.(le,Ie,ke)},...Ye,onKeyDown:ke=>{Ye?.onKeyDown?.(ke),L?.(ke,{rowIndex:le,cellIndex:Ie,date:ue})},onMouseEnter:ke=>{Ye?.onMouseEnter?.(ke),I?.(ke,ue)},onClick:ke=>{Ye?.onClick?.(ke),W?.(ke,ue)},onMouseDown:ke=>{Ye?.onMouseDown?.(ke),G&&ke.preventDefault()},tabIndex:G||!Ze?-1:0})},ue.toString())});return Z.jsxs("tr",{...se("monthRow"),children:[Y&&Z.jsx("td",{...se("weekNumber"),children:P0e(fe)}),de]},le)});return Z.jsxs(Dt,{component:"table",...se("month"),size:J,ref:t,...U,children:[!D&&Z.jsx("thead",{...se("monthThead"),children:Z.jsx(_1,{__staticSelector:d||"Month",locale:h,firstDayOfWeek:g,weekdayFormat:m,size:J,classNames:H,styles:j,unstyled:a,withWeekNumbers:Y})}),Z.jsx("tbody",{...se("monthTbody"),children:ae})]})});hv.classes=JN;hv.displayName="@mantine/dates/Month";var e4={pickerControl:"m_dc6a3c71"};const L0e=(e,{size:t})=>({pickerControl:{"--dpc-fz":si(t),"--dpc-size":$n(t,"dpc-size")}}),fv=ct((e,t)=>{const r=rt("PickerControl",null,e),{classNames:n,className:i,style:s,styles:o,unstyled:a,vars:u,firstInRange:d,lastInRange:h,inRange:g,__staticSelector:m,selected:v,disabled:w,attributes:C,...b}=r,x=wr({name:m||"PickerControl",classes:e4,props:r,className:i,style:s,classNames:n,styles:o,unstyled:a,attributes:C,vars:u,varsResolver:L0e,rootSelector:"pickerControl"});return Z.jsx(Bo,{...x("pickerControl"),ref:t,unstyled:a,"data-picker-control":!0,"data-selected":v&&!w||void 0,"data-disabled":w||void 0,"data-in-range":g&&!w&&!v||void 0,"data-first-in-range":d&&!w||void 0,"data-last-in-range":h&&!w||void 0,disabled:w,...b})});fv.classes=e4;fv.displayName="@mantine/dates/PickerControl";function t4({year:e,minDate:t,maxDate:r}){return!t&&!r?!1:!!(t&&He(e).isBefore(t,"year")||r&&He(e).isAfter(r,"year"))}function I0e({years:e,minDate:t,maxDate:r,getYearControlProps:n}){const i=e.flat().filter(a=>!t4({year:a,minDate:t,maxDate:r})&&!n?.(a)?.disabled),s=i.find(a=>n?.(a)?.selected);if(s)return s;const o=i.find(a=>He().isSame(a,"year"));return o||i[0]}function r4(e){const t=He(e).year(),r=t-t%10;let n=0;const i=[[],[],[],[]];for(let s=0;s<4;s+=1){const o=s===3?1:3;for(let a=0;a<o;a+=1)i[s].push(He(new Date(r+n,0)).format("YYYY-MM-DD")),n+=1}return i}var n4={yearsList:"m_9206547b",yearsListCell:"m_c5a19c7d"};const O0e={yearsListFormat:"YYYY",withCellSpacing:!0},gv=ct((e,t)=>{const r=rt("YearsList",O0e,e),{classNames:n,className:i,style:s,styles:o,unstyled:a,vars:u,decade:d,yearsListFormat:h,locale:g,minDate:m,maxDate:v,getYearControlProps:w,__staticSelector:C,__getControlRef:b,__onControlKeyDown:x,__onControlClick:R,__onControlMouseEnter:E,__preventFocus:A,__stopPropagation:D,withCellSpacing:M,size:F,attributes:O,...L}=r,W=wr({name:C||"YearsList",classes:n4,props:r,className:i,style:s,classNames:n,styles:o,unstyled:a,attributes:O,vars:u,rootSelector:"yearsList"}),I=ll(),G=r4(d),ne=I0e({years:G,minDate:m,maxDate:v,getYearControlProps:w}),ie=G.map((J,_)=>{const Y=J.map((Q,U)=>{const se=w?.(Q),N=He(Q).isSame(ne,"year");return Z.jsx("td",{...W("yearsListCell"),"data-with-spacing":M||void 0,children:Z.jsx(fv,{...W("yearsListControl"),size:F,unstyled:a,"data-mantine-stop-propagation":D||void 0,disabled:t4({year:Q,minDate:m,maxDate:v}),ref:P=>{P&&b?.(_,U,P)},...se,onKeyDown:P=>{se?.onKeyDown?.(P),x?.(P,{rowIndex:_,cellIndex:U,date:Q})},onClick:P=>{se?.onClick?.(P),R?.(P,Q)},onMouseEnter:P=>{se?.onMouseEnter?.(P),E?.(P,Q)},onMouseDown:P=>{se?.onMouseDown?.(P),A&&P.preventDefault()},tabIndex:A||!N?-1:0,children:He(Q).locale(I.getLocale(g)).format(h)})},U)});return Z.jsx("tr",{...W("yearsListRow"),children:Y},_)});return Z.jsx(Dt,{component:"table",ref:t,size:F,...W("yearsList"),...L,children:Z.jsx("tbody",{children:ie})})});gv.classes=n4;gv.displayName="@mantine/dates/YearsList";function i4({month:e,minDate:t,maxDate:r}){return!t&&!r?!1:!!(t&&He(e).isBefore(t,"month")||r&&He(e).isAfter(r,"month"))}function N0e({months:e,minDate:t,maxDate:r,getMonthControlProps:n}){const i=e.flat().filter(a=>!i4({month:a,minDate:t,maxDate:r})&&!n?.(a)?.disabled),s=i.find(a=>n?.(a)?.selected);if(s)return s;const o=i.find(a=>He().isSame(a,"month"));return o||i[0]}function B0e(e){const t=He(e).startOf("year").toDate(),r=[[],[],[],[]];let n=0;for(let i=0;i<4;i+=1)for(let s=0;s<3;s+=1)r[i].push(He(t).add(n,"months").format("YYYY-MM-DD")),n+=1;return r}var s4={monthsList:"m_2a6c32d",monthsListCell:"m_fe27622f"};const H0e={monthsListFormat:"MMM",withCellSpacing:!0},pv=ct((e,t)=>{const r=rt("MonthsList",H0e,e),{classNames:n,className:i,style:s,styles:o,unstyled:a,vars:u,__staticSelector:d,year:h,monthsListFormat:g,locale:m,minDate:v,maxDate:w,getMonthControlProps:C,__getControlRef:b,__onControlKeyDown:x,__onControlClick:R,__onControlMouseEnter:E,__preventFocus:A,__stopPropagation:D,withCellSpacing:M,size:F,attributes:O,...L}=r,W=wr({name:d||"MonthsList",classes:s4,props:r,className:i,style:s,classNames:n,styles:o,unstyled:a,attributes:O,vars:u,rootSelector:"monthsList"}),I=ll(),G=B0e(h),ne=N0e({months:G,minDate:Mn(v),maxDate:Mn(w),getMonthControlProps:C}),ie=G.map((J,_)=>{const Y=J.map((Q,U)=>{const se=C?.(Q),N=He(Q).isSame(ne,"month");return Z.jsx("td",{...W("monthsListCell"),"data-with-spacing":M||void 0,children:Z.jsx(fv,{...W("monthsListControl"),size:F,unstyled:a,__staticSelector:d||"MonthsList","data-mantine-stop-propagation":D||void 0,disabled:i4({month:Q,minDate:Mn(v),maxDate:Mn(w)}),ref:P=>{P&&b?.(_,U,P)},...se,onKeyDown:P=>{se?.onKeyDown?.(P),x?.(P,{rowIndex:_,cellIndex:U,date:Q})},onClick:P=>{se?.onClick?.(P),R?.(P,Q)},onMouseEnter:P=>{se?.onMouseEnter?.(P),E?.(P,Q)},onMouseDown:P=>{se?.onMouseDown?.(P),A&&P.preventDefault()},tabIndex:A||!N?-1:0,children:He(Q).locale(I.getLocale(m)).format(g)})},U)});return Z.jsx("tr",{...W("monthsListRow"),children:Y},_)});return Z.jsx(Dt,{component:"table",ref:t,size:F,...W("monthsList"),...L,children:Z.jsx("tbody",{children:ie})})});pv.classes=s4;pv.displayName="@mantine/dates/MonthsList";var o4={calendarHeader:"m_730a79ed",calendarHeaderLevel:"m_f6645d97",calendarHeaderControl:"m_2351eeb0",calendarHeaderControlIcon:"m_367dc749"};const G0e={hasNextLevel:!0,withNext:!0,withPrevious:!0,headerControlsOrder:["previous","level","next"]},V0e=(e,{size:t})=>({calendarHeader:{"--dch-control-size":$n(t,"dch-control-size"),"--dch-fz":si(t)}}),cl=ct((e,t)=>{const r=rt("CalendarHeader",G0e,e),{classNames:n,className:i,style:s,styles:o,unstyled:a,vars:u,nextIcon:d,previousIcon:h,nextLabel:g,previousLabel:m,onNext:v,onPrevious:w,onLevelClick:C,label:b,nextDisabled:x,previousDisabled:R,hasNextLevel:E,levelControlAriaLabel:A,withNext:D,withPrevious:M,headerControlsOrder:F,__staticSelector:O,__preventFocus:L,__stopPropagation:W,attributes:I,...G}=r,ne=wr({name:O||"CalendarHeader",classes:o4,props:r,className:i,style:s,classNames:n,styles:o,unstyled:a,attributes:I,vars:u,varsResolver:V0e,rootSelector:"calendarHeader"}),ie=L?U=>U.preventDefault():void 0,J=M&&T.createElement(Bo,{...ne("calendarHeaderControl"),key:"previous","data-direction":"previous","aria-label":m,onClick:w,unstyled:a,onMouseDown:ie,disabled:R,"data-disabled":R||void 0,tabIndex:L||R?-1:0,"data-mantine-stop-propagation":W||void 0},h||Z.jsx(mb,{...ne("calendarHeaderControlIcon"),"data-direction":"previous",size:"45%"})),_=T.createElement(Bo,{component:E?"button":"div",...ne("calendarHeaderLevel"),key:"level",onClick:E?C:void 0,unstyled:a,onMouseDown:E?ie:void 0,disabled:!E,"data-static":!E||void 0,"aria-label":A,tabIndex:L||!E?-1:0,"data-mantine-stop-propagation":W||void 0},b),Y=D&&T.createElement(Bo,{...ne("calendarHeaderControl"),key:"next","data-direction":"next","aria-label":g,onClick:v,unstyled:a,onMouseDown:ie,disabled:x,"data-disabled":x||void 0,tabIndex:L||x?-1:0,"data-mantine-stop-propagation":W||void 0},d||Z.jsx(mb,{...ne("calendarHeaderControlIcon"),"data-direction":"next",size:"45%"})),Q=F.map(U=>U==="previous"?J:U==="level"?_:U==="next"?Y:null);return Z.jsx(Dt,{...ne("calendarHeader"),ref:t,...G,children:Q})});cl.classes=o4;cl.displayName="@mantine/dates/CalendarHeader";function z0e(e){const t=r4(e);return[t[0][0],t[3][0]]}const W0e={decadeLabelFormat:"YYYY"},mv=ct((e,t)=>{const r=rt("DecadeLevel",W0e,e),{decade:n,locale:i,minDate:s,maxDate:o,yearsListFormat:a,getYearControlProps:u,__getControlRef:d,__onControlKeyDown:h,__onControlClick:g,__onControlMouseEnter:m,withCellSpacing:v,__preventFocus:w,nextIcon:C,previousIcon:b,nextLabel:x,previousLabel:R,onNext:E,onPrevious:A,nextDisabled:D,previousDisabled:M,levelControlAriaLabel:F,withNext:O,withPrevious:L,headerControlsOrder:W,decadeLabelFormat:I,classNames:G,styles:ne,unstyled:ie,__staticSelector:J,__stopPropagation:_,size:Y,attributes:Q,...U}=r,se=ll(),[N,P]=z0e(n),V={__staticSelector:J||"DecadeLevel",classNames:G,styles:ne,unstyled:ie,size:Y,attributes:Q},H=typeof D=="boolean"?D:o?!He(P).endOf("year").isBefore(o):!1,j=typeof M=="boolean"?M:s?!He(N).startOf("year").isAfter(s):!1,ae=(fe,le)=>He(fe).locale(i||se.locale).format(le);return Z.jsxs(Dt,{"data-decade-level":!0,size:Y,ref:t,...U,children:[Z.jsx(cl,{label:typeof I=="function"?I(N,P):`${ae(N,I)}  ${ae(P,I)}`,__preventFocus:w,__stopPropagation:_,nextIcon:C,previousIcon:b,nextLabel:x,previousLabel:R,onNext:E,onPrevious:A,nextDisabled:H,previousDisabled:j,hasNextLevel:!1,levelControlAriaLabel:F,withNext:O,withPrevious:L,headerControlsOrder:W,...V}),Z.jsx(gv,{decade:n,locale:i,minDate:s,maxDate:o,yearsListFormat:a,getYearControlProps:u,__getControlRef:d,__onControlKeyDown:h,__onControlClick:g,__onControlMouseEnter:m,__preventFocus:w,__stopPropagation:_,withCellSpacing:v,...V})]})});mv.classes={...gv.classes,...cl.classes};mv.displayName="@mantine/dates/DecadeLevel";const U0e={yearLabelFormat:"YYYY"},vv=ct((e,t)=>{const r=rt("YearLevel",U0e,e),{year:n,locale:i,minDate:s,maxDate:o,monthsListFormat:a,getMonthControlProps:u,__getControlRef:d,__onControlKeyDown:h,__onControlClick:g,__onControlMouseEnter:m,withCellSpacing:v,__preventFocus:w,nextIcon:C,previousIcon:b,nextLabel:x,previousLabel:R,onNext:E,onPrevious:A,onLevelClick:D,nextDisabled:M,previousDisabled:F,hasNextLevel:O,levelControlAriaLabel:L,withNext:W,withPrevious:I,headerControlsOrder:G,yearLabelFormat:ne,__staticSelector:ie,__stopPropagation:J,size:_,classNames:Y,styles:Q,unstyled:U,attributes:se,...N}=r,P=ll(),V={__staticSelector:ie||"YearLevel",classNames:Y,styles:Q,unstyled:U,size:_,attributes:se},H=typeof M=="boolean"?M:o?!He(n).endOf("year").isBefore(o):!1,j=typeof F=="boolean"?F:s?!He(n).startOf("year").isAfter(s):!1;return Z.jsxs(Dt,{"data-year-level":!0,size:_,ref:t,...N,children:[Z.jsx(cl,{label:typeof ne=="function"?ne(n):He(n).locale(i||P.locale).format(ne),__preventFocus:w,__stopPropagation:J,nextIcon:C,previousIcon:b,nextLabel:x,previousLabel:R,onNext:E,onPrevious:A,onLevelClick:D,nextDisabled:H,previousDisabled:j,hasNextLevel:O,levelControlAriaLabel:L,withNext:W,withPrevious:I,headerControlsOrder:G,...V}),Z.jsx(pv,{year:n,locale:i,minDate:s,maxDate:o,monthsListFormat:a,getMonthControlProps:u,__getControlRef:d,__onControlKeyDown:h,__onControlClick:g,__onControlMouseEnter:m,__preventFocus:w,__stopPropagation:J,withCellSpacing:v,...V})]})});vv.classes={...cl.classes,...pv.classes};vv.displayName="@mantine/dates/YearLevel";const $0e={monthLabelFormat:"MMMM YYYY"},wv=ct((e,t)=>{const r=rt("MonthLevel",$0e,e),{month:n,locale:i,firstDayOfWeek:s,weekdayFormat:o,weekendDays:a,getDayProps:u,excludeDate:d,minDate:h,maxDate:g,renderDay:m,hideOutsideDates:v,hideWeekdays:w,getDayAriaLabel:C,__getDayRef:b,__onDayKeyDown:x,__onDayClick:R,__onDayMouseEnter:E,withCellSpacing:A,highlightToday:D,withWeekNumbers:M,__preventFocus:F,__stopPropagation:O,nextIcon:L,previousIcon:W,nextLabel:I,previousLabel:G,onNext:ne,onPrevious:ie,onLevelClick:J,nextDisabled:_,previousDisabled:Y,hasNextLevel:Q,levelControlAriaLabel:U,withNext:se,withPrevious:N,headerControlsOrder:P,monthLabelFormat:V,classNames:H,styles:j,unstyled:ae,__staticSelector:fe,size:le,static:de,attributes:ue,...Ie}=r,q=ll(),Ge={__staticSelector:fe||"MonthLevel",classNames:H,styles:j,unstyled:ae,size:le,attributes:ue},Ye=typeof _=="boolean"?_:g?!He(n).endOf("month").isBefore(g):!1,Ze=typeof Y=="boolean"?Y:h?!He(n).startOf("month").isAfter(h):!1;return Z.jsxs(Dt,{"data-month-level":!0,size:le,ref:t,...Ie,children:[Z.jsx(cl,{label:typeof V=="function"?V(n):He(n).locale(i||q.locale).format(V),__preventFocus:F,__stopPropagation:O,nextIcon:L,previousIcon:W,nextLabel:I,previousLabel:G,onNext:ne,onPrevious:ie,onLevelClick:J,nextDisabled:Ye,previousDisabled:Ze,hasNextLevel:Q,levelControlAriaLabel:U,withNext:se,withPrevious:N,headerControlsOrder:P,...Ge}),Z.jsx(hv,{month:n,locale:i,firstDayOfWeek:s,weekdayFormat:o,weekendDays:a,getDayProps:u,excludeDate:d,minDate:h,maxDate:g,renderDay:m,hideOutsideDates:v,hideWeekdays:w,getDayAriaLabel:C,__getDayRef:b,__onDayKeyDown:x,__onDayClick:R,__onDayMouseEnter:E,__preventFocus:F,__stopPropagation:O,static:de,withCellSpacing:A,highlightToday:D,withWeekNumbers:M,...Ge})]})});wv.classes={...hv.classes,...cl.classes};wv.displayName="@mantine/dates/MonthLevel";var a4={levelsGroup:"m_30b26e33"};const ul=ct((e,t)=>{const r=rt("LevelsGroup",null,e),{classNames:n,className:i,style:s,styles:o,unstyled:a,vars:u,__staticSelector:d,attributes:h,...g}=r,m=wr({name:d||"LevelsGroup",classes:a4,props:r,className:i,style:s,classNames:n,styles:o,unstyled:a,attributes:h,vars:u,rootSelector:"levelsGroup"});return Z.jsx(Dt,{ref:t,...m("levelsGroup"),...g})});ul.classes=a4;ul.displayName="@mantine/dates/LevelsGroup";const j0e={numberOfColumns:1},Cv=ct((e,t)=>{const r=rt("DecadeLevelGroup",j0e,e),{decade:n,locale:i,minDate:s,maxDate:o,yearsListFormat:a,getYearControlProps:u,__onControlClick:d,__onControlMouseEnter:h,withCellSpacing:g,__preventFocus:m,nextIcon:v,previousIcon:w,nextLabel:C,previousLabel:b,onNext:x,onPrevious:R,nextDisabled:E,previousDisabled:A,headerControlsOrder:D,classNames:M,styles:F,unstyled:O,__staticSelector:L,__stopPropagation:W,numberOfColumns:I,levelControlAriaLabel:G,decadeLabelFormat:ne,size:ie,vars:J,attributes:_,...Y}=r,Q=T.useRef([]),U=Array(I).fill(0).map((se,N)=>{const P=He(n).add(N*10,"years").format("YYYY-MM-DD");return Z.jsx(mv,{size:ie,yearsListFormat:a,decade:P,withNext:N===I-1,withPrevious:N===0,decadeLabelFormat:ne,__onControlClick:d,__onControlMouseEnter:h,__onControlKeyDown:(V,H)=>P1({levelIndex:N,rowIndex:H.rowIndex,cellIndex:H.cellIndex,event:V,controlsRef:Q}),__getControlRef:(V,H,j)=>{Array.isArray(Q.current[N])||(Q.current[N]=[]),Array.isArray(Q.current[N][V])||(Q.current[N][V]=[]),Q.current[N][V][H]=j},levelControlAriaLabel:typeof G=="function"?G(P):G,locale:i,minDate:s,maxDate:o,__preventFocus:m,__stopPropagation:W,nextIcon:v,previousIcon:w,nextLabel:C,previousLabel:b,onNext:x,onPrevious:R,nextDisabled:E,previousDisabled:A,getYearControlProps:u,__staticSelector:L||"DecadeLevelGroup",classNames:M,styles:F,unstyled:O,withCellSpacing:g,headerControlsOrder:D,attributes:_},N)});return Z.jsx(ul,{classNames:M,styles:F,__staticSelector:L||"DecadeLevelGroup",ref:t,size:ie,unstyled:O,attributes:_,...Y,children:U})});Cv.classes={...ul.classes,...mv.classes};Cv.displayName="@mantine/dates/DecadeLevelGroup";const Y0e={numberOfColumns:1},yv=ct((e,t)=>{const r=rt("YearLevelGroup",Y0e,e),{year:n,locale:i,minDate:s,maxDate:o,monthsListFormat:a,getMonthControlProps:u,__onControlClick:d,__onControlMouseEnter:h,withCellSpacing:g,__preventFocus:m,nextIcon:v,previousIcon:w,nextLabel:C,previousLabel:b,onNext:x,onPrevious:R,onLevelClick:E,nextDisabled:A,previousDisabled:D,hasNextLevel:M,headerControlsOrder:F,classNames:O,styles:L,unstyled:W,__staticSelector:I,__stopPropagation:G,numberOfColumns:ne,levelControlAriaLabel:ie,yearLabelFormat:J,size:_,vars:Y,attributes:Q,...U}=r,se=T.useRef([]),N=Array(ne).fill(0).map((P,V)=>{const H=He(n).add(V,"years").format("YYYY-MM-DD");return Z.jsx(vv,{size:_,monthsListFormat:a,year:H,withNext:V===ne-1,withPrevious:V===0,yearLabelFormat:J,__stopPropagation:G,__onControlClick:d,__onControlMouseEnter:h,__onControlKeyDown:(j,ae)=>P1({levelIndex:V,rowIndex:ae.rowIndex,cellIndex:ae.cellIndex,event:j,controlsRef:se}),__getControlRef:(j,ae,fe)=>{Array.isArray(se.current[V])||(se.current[V]=[]),Array.isArray(se.current[V][j])||(se.current[V][j]=[]),se.current[V][j][ae]=fe},levelControlAriaLabel:typeof ie=="function"?ie(H):ie,locale:i,minDate:s,maxDate:o,__preventFocus:m,nextIcon:v,previousIcon:w,nextLabel:C,previousLabel:b,onNext:x,onPrevious:R,onLevelClick:E,nextDisabled:A,previousDisabled:D,hasNextLevel:M,getMonthControlProps:u,classNames:O,styles:L,unstyled:W,__staticSelector:I||"YearLevelGroup",withCellSpacing:g,headerControlsOrder:F,attributes:Q},V)});return Z.jsx(ul,{classNames:O,styles:L,__staticSelector:I||"YearLevelGroup",ref:t,size:_,unstyled:W,attributes:Q,...U,children:N})});yv.classes={...vv.classes,...ul.classes};yv.displayName="@mantine/dates/YearLevelGroup";const K0e={numberOfColumns:1},bv=ct((e,t)=>{const r=rt("MonthLevelGroup",K0e,e),{month:n,locale:i,firstDayOfWeek:s,weekdayFormat:o,weekendDays:a,getDayProps:u,excludeDate:d,minDate:h,maxDate:g,renderDay:m,hideOutsideDates:v,hideWeekdays:w,getDayAriaLabel:C,__onDayClick:b,__onDayMouseEnter:x,withCellSpacing:R,highlightToday:E,withWeekNumbers:A,__preventFocus:D,nextIcon:M,previousIcon:F,nextLabel:O,previousLabel:L,onNext:W,onPrevious:I,onLevelClick:G,nextDisabled:ne,previousDisabled:ie,hasNextLevel:J,headerControlsOrder:_,classNames:Y,styles:Q,unstyled:U,numberOfColumns:se,levelControlAriaLabel:N,monthLabelFormat:P,__staticSelector:V,__stopPropagation:H,size:j,static:ae,vars:fe,attributes:le,...de}=r,ue=T.useRef([]),Ie=Array(se).fill(0).map((q,Ge)=>{const Ye=He(n).add(Ge,"months").format("YYYY-MM-DD");return Z.jsx(wv,{month:Ye,withNext:Ge===se-1,withPrevious:Ge===0,monthLabelFormat:P,__stopPropagation:H,__onDayClick:b,__onDayMouseEnter:x,__onDayKeyDown:(Ze,ke)=>P1({levelIndex:Ge,rowIndex:ke.rowIndex,cellIndex:ke.cellIndex,event:Ze,controlsRef:ue}),__getDayRef:(Ze,ke,De)=>{Array.isArray(ue.current[Ge])||(ue.current[Ge]=[]),Array.isArray(ue.current[Ge][Ze])||(ue.current[Ge][Ze]=[]),ue.current[Ge][Ze][ke]=De},levelControlAriaLabel:typeof N=="function"?N(Ye):N,locale:i,firstDayOfWeek:s,weekdayFormat:o,weekendDays:a,getDayProps:u,excludeDate:d,minDate:h,maxDate:g,renderDay:m,hideOutsideDates:v,hideWeekdays:w,getDayAriaLabel:C,__preventFocus:D,nextIcon:M,previousIcon:F,nextLabel:O,previousLabel:L,onNext:W,onPrevious:I,onLevelClick:G,nextDisabled:ne,previousDisabled:ie,hasNextLevel:J,classNames:Y,styles:Q,unstyled:U,__staticSelector:V||"MonthLevelGroup",size:j,static:ae,withCellSpacing:R,highlightToday:E,withWeekNumbers:A,headerControlsOrder:_,attributes:le},Ge)});return Z.jsx(ul,{classNames:Y,styles:Q,__staticSelector:V||"MonthLevelGroup",ref:t,size:j,attributes:le,...de,children:Ie})});bv.classes={...ul.classes,...wv.classes};bv.displayName="@mantine/dates/MonthLevelGroup";var l4={input:"m_6fa5e2aa"};const Sv=ct((e,t)=>{const{inputProps:r,wrapperProps:n,placeholder:i,classNames:s,styles:o,unstyled:a,popoverProps:u,modalProps:d,dropdownType:h,children:g,formattedValue:m,dropdownHandlers:v,dropdownOpened:w,onClick:C,clearable:b,onClear:x,clearButtonProps:R,rightSection:E,shouldClear:A,readOnly:D,disabled:M,value:F,name:O,form:L,type:W,onDropdownClose:I,withTime:G,...ne}=hM("PickerInputBase",{size:"sm"},e),ie=Z.jsx(cn.ClearButton,{onClick:x,unstyled:a,...R}),J=()=>{W==="range"&&Array.isArray(F)&&F[0]&&!F[1]&&x(),v.close()};return Z.jsxs(Z.Fragment,{children:[h==="modal"&&!D&&Z.jsx(As,{opened:w,onClose:J,withCloseButton:!1,size:"auto","data-dates-modal":!0,unstyled:a,...d,children:g}),Z.jsx(cn.Wrapper,{...n,children:Z.jsxs(bs,{position:"bottom-start",opened:w,trapFocus:!0,returnFocus:!1,unstyled:a,onClose:I,...u,disabled:u?.disabled||h==="modal"||D,onChange:_=>{_||(u?.onClose?.(),J())},children:[Z.jsx(bs.Target,{children:Z.jsx(cn,{"data-dates-input":!0,"data-read-only":D||void 0,disabled:M,component:"button",type:"button",multiline:!0,onClick:_=>{C?.(_),v.toggle()},__clearSection:ie,__clearable:b&&A&&!D&&!M,rightSection:E,...r,ref:t,classNames:{...s,input:Di(l4.input,s?.input)},...ne,children:m||Z.jsx(cn.Placeholder,{error:r.error,unstyled:a,className:s?.placeholder,style:o?.placeholder,children:i})})}),Z.jsx(bs.Dropdown,{"data-dates-dropdown":!0,children:g})]})}),Z.jsx(KN,{value:F,name:O,form:L,type:W,withTime:G})]})});Sv.classes=l4;Sv.displayName="@mantine/dates/PickerInputBase";const xk=e=>e==="range"?[null,null]:e==="multiple"?[]:null,Ek=(e,t)=>{const r=t?$N:Mn;return Array.isArray(e)?e.map(r):r(e)};function I1({type:e,value:t,defaultValue:r,onChange:n,withTime:i=!1}){const s=T.useRef(e),[o,a,u]=ju({value:Ek(t,i),defaultValue:Ek(r,i),finalValue:xk(e),onChange:n});let d=o;return s.current!==e&&(s.current=e,t===void 0&&(d=r!==void 0?r:xk(e),a(d))),[d,a,u]}function Xy(e,t){return e?e==="month"?0:e==="year"?1:2:t||0}function q0e(e){return e===0?"month":e===1?"year":"decade"}function Fh(e,t,r){return q0e(V5(Xy(e,0),Xy(t,0),Xy(r,2)))}const X0e={maxLevel:"decade",minLevel:"month",__updateDateOnYearSelect:!0,__updateDateOnMonthSelect:!0,enableKeyboardNavigation:!0},xv=ct((e,t)=>{const r=rt("Calendar",X0e,e),{vars:n,maxLevel:i,minLevel:s,defaultLevel:o,level:a,onLevelChange:u,date:d,defaultDate:h,onDateChange:g,numberOfColumns:m,columnsToScroll:v,ariaLabels:w,nextLabel:C,previousLabel:b,onYearSelect:x,onMonthSelect:R,onYearMouseEnter:E,onMonthMouseEnter:A,headerControlsOrder:D,__updateDateOnYearSelect:M,__updateDateOnMonthSelect:F,__setDateRef:O,__setLevelRef:L,firstDayOfWeek:W,weekdayFormat:I,weekendDays:G,getDayProps:ne,excludeDate:ie,renderDay:J,hideOutsideDates:_,hideWeekdays:Y,getDayAriaLabel:Q,monthLabelFormat:U,nextIcon:se,previousIcon:N,__onDayClick:P,__onDayMouseEnter:V,withCellSpacing:H,highlightToday:j,withWeekNumbers:ae,monthsListFormat:fe,getMonthControlProps:le,yearLabelFormat:de,yearsListFormat:ue,getYearControlProps:Ie,decadeLabelFormat:q,classNames:Ge,styles:Ye,unstyled:Ze,minDate:ke,maxDate:De,locale:nt,__staticSelector:vt,size:Xe,__preventFocus:st,__stopPropagation:Ct,onNextDecade:ar,onPreviousDecade:qe,onNextYear:hr,onPreviousYear:Or,onNextMonth:Et,onPreviousMonth:dt,static:At,enableKeyboardNavigation:ht,attributes:jt,...Tt}=r,{resolvedClassNames:It,resolvedStyles:lr}=fc({classNames:Ge,styles:Ye,props:r}),[$r,Cr]=ju({value:a?Fh(a,s,i):void 0,defaultValue:o?Fh(o,s,i):void 0,finalValue:Fh(void 0,s,i),onChange:u}),[dl,Yt]=I1({type:"default",value:Mn(d),defaultValue:Mn(h),onChange:g});T.useImperativeHandle(O,()=>kt=>{Yt(kt)}),T.useImperativeHandle(L,()=>kt=>{Cr(kt)});const Sn={__staticSelector:vt||"Calendar",styles:lr,classNames:It,unstyled:Ze,size:Xe,attributes:jt},nn=v||m||1,uo=new Date,ia=ke&&He(uo).isAfter(ke)?ke:He(uo).format("YYYY-MM-DD"),Ar=dl||ia,sa=()=>{const kt=He(Ar).add(nn,"month").format("YYYY-MM-DD");Et?.(kt),Yt(kt)},ho=()=>{const kt=He(Ar).subtract(nn,"month").format("YYYY-MM-DD");dt?.(kt),Yt(kt)},hl=()=>{const kt=He(Ar).add(nn,"year").format("YYYY-MM-DD");hr?.(kt),Yt(kt)},oa=()=>{const kt=He(Ar).subtract(nn,"year").format("YYYY-MM-DD");Or?.(kt),Yt(kt)},fo=()=>{const kt=He(Ar).add(10*nn,"year").format("YYYY-MM-DD");ar?.(kt),Yt(kt)},hs=()=>{const kt=He(Ar).subtract(10*nn,"year").format("YYYY-MM-DD");qe?.(kt),Yt(kt)},Fc=T.useRef(null);T.useEffect(()=>{if(!ht||At)return;const kt=jr=>{if(!Fc.current?.contains(document.activeElement))return;const Ms=jr.ctrlKey||jr.metaKey,aa=jr.shiftKey;switch(jr.key){case"ArrowUp":Ms&&aa?(jr.preventDefault(),hs()):Ms&&(jr.preventDefault(),oa());break;case"ArrowDown":Ms&&aa?(jr.preventDefault(),fo()):Ms&&(jr.preventDefault(),hl());break;case"y":case"Y":$r==="month"&&(jr.preventDefault(),Cr("year"));break}};return document.addEventListener("keydown",kt),()=>{document.removeEventListener("keydown",kt)}},[ht,At,$r,hl,oa,fo,hs]);const Dc=kt=>{Fc.current=kt,typeof t=="function"?t(kt):t&&(t.current=kt)};return Z.jsxs(Dt,{ref:Dc,size:Xe,"data-calendar":!0,...Tt,children:[$r==="month"&&Z.jsx(bv,{month:Ar,minDate:ke,maxDate:De,firstDayOfWeek:W,weekdayFormat:I,weekendDays:G,getDayProps:ne,excludeDate:ie,renderDay:J,hideOutsideDates:_,hideWeekdays:Y,getDayAriaLabel:Q,onNext:sa,onPrevious:ho,hasNextLevel:i!=="month",onLevelClick:()=>Cr("year"),numberOfColumns:m,locale:nt,levelControlAriaLabel:w?.monthLevelControl,nextLabel:w?.nextMonth??C,nextIcon:se,previousLabel:w?.previousMonth??b,previousIcon:N,monthLabelFormat:U,__onDayClick:P,__onDayMouseEnter:V,__preventFocus:st,__stopPropagation:Ct,static:At,withCellSpacing:H,highlightToday:j,withWeekNumbers:ae,headerControlsOrder:D,...Sn}),$r==="year"&&Z.jsx(yv,{year:Ar,numberOfColumns:m,minDate:ke,maxDate:De,monthsListFormat:fe,getMonthControlProps:le,locale:nt,onNext:hl,onPrevious:oa,hasNextLevel:i!=="month"&&i!=="year",onLevelClick:()=>Cr("decade"),levelControlAriaLabel:w?.yearLevelControl,nextLabel:w?.nextYear??C,nextIcon:se,previousLabel:w?.previousYear??b,previousIcon:N,yearLabelFormat:de,__onControlMouseEnter:A,__onControlClick:(kt,jr)=>{F&&Yt(jr),Cr(Fh("month",s,i)),R?.(jr)},__preventFocus:st,__stopPropagation:Ct,withCellSpacing:H,headerControlsOrder:D,...Sn}),$r==="decade"&&Z.jsx(Cv,{decade:Ar,minDate:ke,maxDate:De,yearsListFormat:ue,getYearControlProps:Ie,locale:nt,onNext:fo,onPrevious:hs,numberOfColumns:m,nextLabel:w?.nextDecade??C,nextIcon:se,previousLabel:w?.previousDecade??b,previousIcon:N,decadeLabelFormat:q,__onControlMouseEnter:E,__onControlClick:(kt,jr)=>{M&&Yt(jr),Cr(Fh("year",s,i)),x?.(jr)},__preventFocus:st,__stopPropagation:Ct,withCellSpacing:H,headerControlsOrder:D,...Sn})]})});xv.classes={...Cv.classes,...yv.classes,...bv.classes};xv.displayName="@mantine/dates/Calendar";function c4(e){const{maxLevel:t,minLevel:r,defaultLevel:n,level:i,onLevelChange:s,nextIcon:o,previousIcon:a,date:u,defaultDate:d,onDateChange:h,numberOfColumns:g,columnsToScroll:m,ariaLabels:v,nextLabel:w,previousLabel:C,onYearSelect:b,onMonthSelect:x,onYearMouseEnter:R,onMonthMouseEnter:E,onNextMonth:A,onPreviousMonth:D,onNextYear:M,onPreviousYear:F,onNextDecade:O,onPreviousDecade:L,withCellSpacing:W,highlightToday:I,__updateDateOnYearSelect:G,__updateDateOnMonthSelect:ne,__setDateRef:ie,__setLevelRef:J,withWeekNumbers:_,headerControlsOrder:Y,firstDayOfWeek:Q,weekdayFormat:U,weekendDays:se,getDayProps:N,excludeDate:P,renderDay:V,hideOutsideDates:H,hideWeekdays:j,getDayAriaLabel:ae,monthLabelFormat:fe,monthsListFormat:le,getMonthControlProps:de,yearLabelFormat:ue,yearsListFormat:Ie,getYearControlProps:q,decadeLabelFormat:Ge,allowSingleDateInRange:Ye,allowDeselect:Ze,minDate:ke,maxDate:De,locale:nt,...vt}=e;return{calendarProps:{maxLevel:t,minLevel:r,defaultLevel:n,level:i,onLevelChange:s,nextIcon:o,previousIcon:a,date:u,defaultDate:d,onDateChange:h,numberOfColumns:g,columnsToScroll:m,ariaLabels:v,nextLabel:w,previousLabel:C,onYearSelect:b,onMonthSelect:x,onYearMouseEnter:R,onMonthMouseEnter:E,onNextMonth:A,onPreviousMonth:D,onNextYear:M,onPreviousYear:F,onNextDecade:O,onPreviousDecade:L,withCellSpacing:W,highlightToday:I,__updateDateOnYearSelect:G,__updateDateOnMonthSelect:ne,__setDateRef:ie,withWeekNumbers:_,headerControlsOrder:Y,firstDayOfWeek:Q,weekdayFormat:U,weekendDays:se,getDayProps:N,excludeDate:P,renderDay:V,hideOutsideDates:H,hideWeekdays:j,getDayAriaLabel:ae,monthLabelFormat:fe,monthsListFormat:le,getMonthControlProps:de,yearLabelFormat:ue,yearsListFormat:Ie,getYearControlProps:q,decadeLabelFormat:Ge,allowSingleDateInRange:Ye,allowDeselect:Ze,minDate:ke,maxDate:De,locale:nt},others:vt}}function Rk(e,t){const r=[...t].sort((n,i)=>He(n).isAfter(He(i))?1:-1);return He(r[0]).startOf("day").subtract(1,"ms").isBefore(e)&&He(r[1]).endOf("day").add(1,"ms").isAfter(e)}function Q0e({type:e,level:t,value:r,defaultValue:n,onChange:i,allowSingleDateInRange:s,allowDeselect:o,onMouseLeave:a}){const[u,d]=I1({type:e,value:r,defaultValue:n,onChange:i}),[h,g]=T.useState(e==="range"&&u[0]&&!u[1]?u[0]:null),[m,v]=T.useState(null),w=D=>{if(e==="range"){if(h&&!u[1]){if(He(D).isSame(h,t)&&!s){g(null),v(null),d([null,null]);return}const M=[D,h];M.sort((F,O)=>He(F).isAfter(He(O))?1:-1),d(M),v(null),g(null);return}if(u[0]&&!u[1]&&He(D).isSame(u[0],t)&&!s){g(null),v(null),d([null,null]);return}d([D,null]),v(null),g(D);return}if(e==="multiple"){u.some(M=>He(M).isSame(D,t))?d(u.filter(M=>!He(M).isSame(D,t))):d([...u,D]);return}u&&o&&He(D).isSame(u,t)?d(null):d(D)},C=D=>h&&m?Rk(D,[m,h]):u[0]&&u[1]?Rk(D,u):!1,b=e==="range"?D=>{a?.(D),v(null)}:a,x=D=>u[0]&&He(D).isSame(u[0],t)?!(m&&He(m).isBefore(u[0])):!1,R=D=>u[1]?He(D).isSame(u[1],t):!u[0]||!m?!1:He(m).isBefore(u[0])&&He(D).isSame(u[0],t),E=D=>{if(e==="range")return{selected:u.some(F=>F&&He(F).isSame(D,t)),inRange:C(D),firstInRange:x(D),lastInRange:R(D),"data-autofocus":!!u[0]&&He(u[0]).isSame(D,t)||void 0};if(e==="multiple")return{selected:u.some(F=>F&&He(F).isSame(D,t)),"data-autofocus":!!u[0]&&He(u[0]).isSame(D,t)||void 0};const M=He(u).isSame(D,t);return{selected:M,"data-autofocus":M||void 0}},A=e==="range"&&h?v:()=>{};return T.useEffect(()=>{if(e==="range")if(u[0]&&!u[1])g(u[0]);else{const D=u[0]==null&&u[1]==null,M=u[0]!=null&&u[1]!=null;(D||M)&&(g(null),v(null))}},[u]),{onDateChange:w,onRootMouseLeave:b,onHoveredDateChange:A,getControlProps:E,_value:u,setValue:d}}var Z0e={datePickerRoot:"m_765a40cf",presetsList:"m_d6a681e1",presetButton:"m_acd30b22"};const J0e=(e,{size:t})=>({datePickerRoot:{"--preset-font-size":si(t)}}),eme={type:"default",defaultLevel:"month",numberOfColumns:1,size:"sm"},Ev=ct((e,t)=>{const r=rt("DatePicker",eme,e),{allowDeselect:n,allowSingleDateInRange:i,value:s,defaultValue:o,onChange:a,onMouseLeave:u,classNames:d,styles:h,__staticSelector:g,__onDayClick:m,__onDayMouseEnter:v,__onPresetSelect:w,__stopPropagation:C,presets:b,className:x,style:R,unstyled:E,size:A,vars:D,attributes:M,...F}=r,{calendarProps:O,others:L}=c4(F),W=T.useRef(null),I=T.useRef(null),G=wr({name:g||"DatePicker",classes:Z0e,props:r,className:x,style:R,classNames:d,styles:h,unstyled:E,attributes:M,rootSelector:b?"datePickerRoot":void 0,varsResolver:J0e,vars:D}),{onDateChange:ne,onRootMouseLeave:ie,onHoveredDateChange:J,getControlProps:_,_value:Y,setValue:Q}=Q0e({type:L.type,level:"day",allowDeselect:n,allowSingleDateInRange:i,value:s,defaultValue:o,onChange:a,onMouseLeave:u}),{resolvedClassNames:U,resolvedStyles:se}=fc({classNames:d,styles:h,props:r}),N=Z.jsx(xv,{ref:t,classNames:U,styles:se,__staticSelector:g||"DatePicker",onMouseLeave:ie,size:A,...O,...b?{}:L,__stopPropagation:C,__setDateRef:W,__setLevelRef:I,minLevel:O.minLevel||"month",__onDayMouseEnter:(H,j)=>{J(j),v?.(H,j)},__onDayClick:(H,j)=>{ne(j),m?.(H,j)},getDayProps:H=>({..._(H),...O.getDayProps?.(H)}),getMonthControlProps:H=>({selected:typeof Y=="string"?L1(H,Y):!1,...O.getMonthControlProps?.(H)}),getYearControlProps:H=>({selected:typeof Y=="string"?He(H).isSame(Y,"year"):!1,...O.getYearControlProps?.(H)}),hideOutsideDates:O.hideOutsideDates??O.numberOfColumns!==1,...b?{}:{className:x,style:R,attributes:M}});if(!b)return N;const P=H=>{const j=Array.isArray(H)?H[0]:H;j!==void 0&&(W.current?.(j),I.current?.("month"),w?w(j):Q(H))},V=b.map((H,j)=>Z.jsx(Bo,{...G("presetButton"),onClick:()=>P(H.value),onMouseDown:ae=>ae.preventDefault(),"data-mantine-stop-propagation":C||void 0,children:H.label},j));return Z.jsxs(Dt,{...G("datePickerRoot"),size:A,...L,children:[Z.jsx("div",{...G("presetsList"),children:V}),N]})});Ev.classes=xv.classes;Ev.displayName="@mantine/dates/DatePicker";function tme({type:e,value:t,defaultValue:r,onChange:n,locale:i,format:s,closeOnChange:o,sortDates:a,labelSeparator:u,valueFormatter:d}){const h=ll(),[g,m]=iG(!1),[v,w]=I1({type:e,value:t,defaultValue:r,onChange:n}),C=g0e({type:e,date:v,locale:h.getLocale(i),format:s,labelSeparator:h.getLabelSeparator(u),formatter:d}),b=E=>{o&&(e==="default"&&m.close(),e==="range"&&E[0]&&E[1]&&m.close()),w(a&&e==="multiple"?[...E].sort((A,D)=>He(A).isAfter(He(D))?1:-1):E)},x=()=>b(e==="range"?[null,null]:e==="multiple"?[]:null),R=e==="range"?!!v[0]:e==="multiple"?v.length>0:v!==null;return{_value:v,setValue:b,onClear:x,shouldClear:R,formattedValue:C,dropdownOpened:g,dropdownHandlers:m}}const rme={type:"default",valueFormat:"MMMM D, YYYY",closeOnChange:!0,sortDates:!0,dropdownType:"popover"},am=ct((e,t)=>{const r=rt("DatePickerInput",rme,e),{type:n,value:i,defaultValue:s,onChange:o,valueFormat:a,labelSeparator:u,locale:d,classNames:h,styles:g,unstyled:m,closeOnChange:v,size:w,variant:C,dropdownType:b,sortDates:x,minDate:R,maxDate:E,vars:A,defaultDate:D,valueFormatter:M,presets:F,attributes:O,...L}=r,{resolvedClassNames:W,resolvedStyles:I}=fc({classNames:h,styles:g,props:r}),{calendarProps:G,others:ne}=c4(L),{_value:ie,setValue:J,formattedValue:_,dropdownHandlers:Y,dropdownOpened:Q,onClear:U,shouldClear:se}=tme({type:n,value:i,defaultValue:s,onChange:o,locale:d,format:a,labelSeparator:u,closeOnChange:v,sortDates:x,valueFormatter:M}),N=Array.isArray(ie)?ie[0]||D:ie||D;return Z.jsx(Sv,{formattedValue:_,dropdownOpened:Q,dropdownHandlers:Y,classNames:W,styles:I,unstyled:m,ref:t,onClear:U,shouldClear:se,value:ie,size:w,variant:C,dropdownType:b,...ne,type:n,__staticSelector:"DatePickerInput",attributes:O,children:Z.jsx(Ev,{...G,size:w,variant:C,type:n,value:ie,defaultDate:N||w0e({maxDate:E,minDate:R}),onChange:J,locale:d,classNames:W,styles:I,unstyled:m,__staticSelector:"DatePickerInput",__stopPropagation:b==="popover",minDate:R,maxDate:E,presets:F,attributes:O})})});am.classes={...Sv.classes,...Ev.classes};am.displayName="@mantine/dates/DatePickerInput";/*!
* sweetalert2 v11.26.3
* Released under the MIT License.
*/function u4(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}function nme(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tk(e,t){return e.get(u4(e,t))}function ime(e,t,r){nme(e,t),t.set(e,r)}function sme(e,t,r){return e.set(u4(e,t),r),r}const ome=100,lt={},ame=()=>{lt.previousActiveElement instanceof HTMLElement?(lt.previousActiveElement.focus(),lt.previousActiveElement=null):document.body&&document.body.focus()},lme=e=>new Promise(t=>{if(!e)return t();const r=window.scrollX,n=window.scrollY;lt.restoreFocusTimeout=setTimeout(()=>{ame(),t()},ome),window.scrollTo(r,n)}),d4="swal2-",cme=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],xe=cme.reduce((e,t)=>(e[t]=d4+t,e),{}),ume=["success","warning","info","question","error"],lm=ume.reduce((e,t)=>(e[t]=d4+t,e),{}),h4="SweetAlert2:",O1=e=>e.charAt(0).toUpperCase()+e.slice(1),Yn=e=>{console.warn(`${h4} ${typeof e=="object"?e.join(" "):e}`)},Rc=e=>{console.error(`${h4} ${e}`)},Fk=[],dme=e=>{Fk.includes(e)||(Fk.push(e),Yn(e))},f4=(e,t=null)=>{dme(`"${e}" is deprecated and will be removed in the next major release.${t?` Use "${t}" instead.`:""}`)},Rv=e=>typeof e=="function"?e():e,N1=e=>e&&typeof e.toPromise=="function",tg=e=>N1(e)?e.toPromise():Promise.resolve(e),B1=e=>e&&Promise.resolve(e)===e,Kn=()=>document.body.querySelector(`.${xe.container}`),rg=e=>{const t=Kn();return t?t.querySelector(e):null},Mi=e=>rg(`.${e}`),Wt=()=>Mi(xe.popup),Ed=()=>Mi(xe.icon),hme=()=>Mi(xe["icon-content"]),g4=()=>Mi(xe.title),H1=()=>Mi(xe["html-container"]),p4=()=>Mi(xe.image),G1=()=>Mi(xe["progress-steps"]),Tv=()=>Mi(xe["validation-message"]),so=()=>rg(`.${xe.actions} .${xe.confirm}`),Rd=()=>rg(`.${xe.actions} .${xe.cancel}`),Tc=()=>rg(`.${xe.actions} .${xe.deny}`),fme=()=>Mi(xe["input-label"]),Td=()=>rg(`.${xe.loader}`),ng=()=>Mi(xe.actions),m4=()=>Mi(xe.footer),Fv=()=>Mi(xe["timer-progress-bar"]),V1=()=>Mi(xe.close),gme=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,z1=()=>{const e=Wt();if(!e)return[];const t=e.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),r=Array.from(t).sort((s,o)=>{const a=parseInt(s.getAttribute("tabindex")||"0"),u=parseInt(o.getAttribute("tabindex")||"0");return a>u?1:a<u?-1:0}),n=e.querySelectorAll(gme),i=Array.from(n).filter(s=>s.getAttribute("tabindex")!=="-1");return[...new Set(r.concat(i))].filter(s=>ai(s))},W1=()=>jo(document.body,xe.shown)&&!jo(document.body,xe["toast-shown"])&&!jo(document.body,xe["no-backdrop"]),Dv=()=>{const e=Wt();return e?jo(e,xe.toast):!1},pme=()=>{const e=Wt();return e?e.hasAttribute("data-loading"):!1},_i=(e,t)=>{if(e.textContent="",t){const n=new DOMParser().parseFromString(t,"text/html"),i=n.querySelector("head");i&&Array.from(i.childNodes).forEach(o=>{e.appendChild(o)});const s=n.querySelector("body");s&&Array.from(s.childNodes).forEach(o=>{o instanceof HTMLVideoElement||o instanceof HTMLAudioElement?e.appendChild(o.cloneNode(!0)):e.appendChild(o)})}},jo=(e,t)=>{if(!t)return!1;const r=t.split(/\s+/);for(let n=0;n<r.length;n++)if(!e.classList.contains(r[n]))return!1;return!0},mme=(e,t)=>{Array.from(e.classList).forEach(r=>{!Object.values(xe).includes(r)&&!Object.values(lm).includes(r)&&!Object.values(t.showClass||{}).includes(r)&&e.classList.remove(r)})},ki=(e,t,r)=>{if(mme(e,t),!t.customClass)return;const n=t.customClass[r];if(n){if(typeof n!="string"&&!n.forEach){Yn(`Invalid type of customClass.${r}! Expected string or iterable object, got "${typeof n}"`);return}$t(e,n)}},Av=(e,t)=>{if(!t)return null;switch(t){case"select":case"textarea":case"file":return e.querySelector(`.${xe.popup} > .${xe[t]}`);case"checkbox":return e.querySelector(`.${xe.popup} > .${xe.checkbox} input`);case"radio":return e.querySelector(`.${xe.popup} > .${xe.radio} input:checked`)||e.querySelector(`.${xe.popup} > .${xe.radio} input:first-child`);case"range":return e.querySelector(`.${xe.popup} > .${xe.range} input`);default:return e.querySelector(`.${xe.popup} > .${xe.input}`)}},v4=e=>{if(e.focus(),e.type!=="file"){const t=e.value;e.value="",e.value=t}},w4=(e,t,r)=>{!e||!t||(typeof t=="string"&&(t=t.split(/\s+/).filter(Boolean)),t.forEach(n=>{Array.isArray(e)?e.forEach(i=>{r?i.classList.add(n):i.classList.remove(n)}):r?e.classList.add(n):e.classList.remove(n)}))},$t=(e,t)=>{w4(e,t,!0)},os=(e,t)=>{w4(e,t,!1)},Va=(e,t)=>{const r=Array.from(e.children);for(let n=0;n<r.length;n++){const i=r[n];if(i instanceof HTMLElement&&jo(i,t))return i}},Xl=(e,t,r)=>{r===`${parseInt(`${r}`)}`&&(r=parseInt(r)),r||parseInt(`${r}`)===0?e.style.setProperty(t,typeof r=="number"?`${r}px`:r):e.style.removeProperty(t)},hn=(e,t="flex")=>{e&&(e.style.display=t)},In=e=>{e&&(e.style.display="none")},U1=(e,t="block")=>{e&&new MutationObserver(()=>{ig(e,e.innerHTML,t)}).observe(e,{childList:!0,subtree:!0})},Dk=(e,t,r,n)=>{const i=e.querySelector(t);i&&i.style.setProperty(r,n)},ig=(e,t,r="flex")=>{t?hn(e,r):In(e)},ai=e=>!!(e&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)),vme=()=>!ai(so())&&!ai(Tc())&&!ai(Rd()),uS=e=>e.scrollHeight>e.clientHeight,wme=(e,t)=>{let r=e;for(;r&&r!==t;){if(uS(r))return!0;r=r.parentElement}return!1},C4=e=>{const t=window.getComputedStyle(e),r=parseFloat(t.getPropertyValue("animation-duration")||"0"),n=parseFloat(t.getPropertyValue("transition-duration")||"0");return r>0||n>0},$1=(e,t=!1)=>{const r=Fv();r&&ai(r)&&(t&&(r.style.transition="none",r.style.width="100%"),setTimeout(()=>{r.style.transition=`width ${e/1e3}s linear`,r.style.width="0%"},10))},Cme=()=>{const e=Fv();if(!e)return;const t=parseInt(window.getComputedStyle(e).width);e.style.removeProperty("transition"),e.style.width="100%";const r=parseInt(window.getComputedStyle(e).width),n=t/r*100;e.style.width=`${n}%`},yme=()=>typeof window>"u"||typeof document>"u",bme=`
 <div aria-labelledby="${xe.title}" aria-describedby="${xe["html-container"]}" class="${xe.popup}" tabindex="-1">
   <button type="button" class="${xe.close}"></button>
   <ul class="${xe["progress-steps"]}"></ul>
   <div class="${xe.icon}"></div>
   <img class="${xe.image}" />
   <h2 class="${xe.title}" id="${xe.title}"></h2>
   <div class="${xe["html-container"]}" id="${xe["html-container"]}"></div>
   <input class="${xe.input}" id="${xe.input}" />
   <input type="file" class="${xe.file}" />
   <div class="${xe.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${xe.select}" id="${xe.select}"></select>
   <div class="${xe.radio}"></div>
   <label class="${xe.checkbox}">
     <input type="checkbox" id="${xe.checkbox}" />
     <span class="${xe.label}"></span>
   </label>
   <textarea class="${xe.textarea}" id="${xe.textarea}"></textarea>
   <div class="${xe["validation-message"]}" id="${xe["validation-message"]}"></div>
   <div class="${xe.actions}">
     <div class="${xe.loader}"></div>
     <button type="button" class="${xe.confirm}"></button>
     <button type="button" class="${xe.deny}"></button>
     <button type="button" class="${xe.cancel}"></button>
   </div>
   <div class="${xe.footer}"></div>
   <div class="${xe["timer-progress-bar-container"]}">
     <div class="${xe["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),Sme=()=>{const e=Kn();return e?(e.remove(),os([document.documentElement,document.body],[xe["no-backdrop"],xe["toast-shown"],xe["has-column"]]),!0):!1},kl=()=>{lt.currentInstance.resetValidationMessage()},xme=()=>{const e=Wt(),t=Va(e,xe.input),r=Va(e,xe.file),n=e.querySelector(`.${xe.range} input`),i=e.querySelector(`.${xe.range} output`),s=Va(e,xe.select),o=e.querySelector(`.${xe.checkbox} input`),a=Va(e,xe.textarea);t.oninput=kl,r.onchange=kl,s.onchange=kl,o.onchange=kl,a.oninput=kl,n.oninput=()=>{kl(),i.value=n.value},n.onchange=()=>{kl(),i.value=n.value}},Eme=e=>typeof e=="string"?document.querySelector(e):e,Rme=e=>{const t=Wt();t.setAttribute("role",e.toast?"alert":"dialog"),t.setAttribute("aria-live",e.toast?"polite":"assertive"),e.toast||t.setAttribute("aria-modal","true")},Tme=e=>{window.getComputedStyle(e).direction==="rtl"&&$t(Kn(),xe.rtl)},Fme=e=>{const t=Sme();if(yme()){Rc("SweetAlert2 requires document to initialize");return}const r=document.createElement("div");r.className=xe.container,t&&$t(r,xe["no-transition"]),_i(r,bme),r.dataset.swal2Theme=e.theme;const n=Eme(e.target);n.appendChild(r),e.topLayer&&(r.setAttribute("popover",""),r.showPopover()),Rme(e),Tme(n),xme()},j1=(e,t)=>{e instanceof HTMLElement?t.appendChild(e):typeof e=="object"?Dme(e,t):e&&_i(t,e)},Dme=(e,t)=>{e.jquery?Ame(t,e):_i(t,e.toString())},Ame=(e,t)=>{if(e.textContent="",0 in t)for(let r=0;r in t;r++)e.appendChild(t[r].cloneNode(!0));else e.appendChild(t.cloneNode(!0))},kme=(e,t)=>{const r=ng(),n=Td();!r||!n||(!t.showConfirmButton&&!t.showDenyButton&&!t.showCancelButton?In(r):hn(r),ki(r,t,"actions"),Pme(r,n,t),_i(n,t.loaderHtml||""),ki(n,t,"loader"))};function Pme(e,t,r){const n=so(),i=Tc(),s=Rd();!n||!i||!s||(Zy(n,"confirm",r),Zy(i,"deny",r),Zy(s,"cancel",r),Mme(n,i,s,r),r.reverseButtons&&(r.toast?(e.insertBefore(s,n),e.insertBefore(i,n)):(e.insertBefore(s,t),e.insertBefore(i,t),e.insertBefore(n,t))))}function Mme(e,t,r,n){if(!n.buttonsStyling){os([e,t,r],xe.styled);return}$t([e,t,r],xe.styled),n.confirmButtonColor&&e.style.setProperty("--swal2-confirm-button-background-color",n.confirmButtonColor),n.denyButtonColor&&t.style.setProperty("--swal2-deny-button-background-color",n.denyButtonColor),n.cancelButtonColor&&r.style.setProperty("--swal2-cancel-button-background-color",n.cancelButtonColor),Qy(e),Qy(t),Qy(r)}function Qy(e){const t=window.getComputedStyle(e);if(t.getPropertyValue("--swal2-action-button-focus-box-shadow"))return;const r=t.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");e.style.setProperty("--swal2-action-button-focus-box-shadow",t.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${r}`))}function Zy(e,t,r){const n=O1(t);ig(e,r[`show${n}Button`],"inline-block"),_i(e,r[`${t}ButtonText`]||""),e.setAttribute("aria-label",r[`${t}ButtonAriaLabel`]||""),e.className=xe[t],ki(e,r,`${t}Button`)}const _me=(e,t)=>{const r=V1();r&&(_i(r,t.closeButtonHtml||""),ki(r,t,"closeButton"),ig(r,t.showCloseButton),r.setAttribute("aria-label",t.closeButtonAriaLabel||""))},Lme=(e,t)=>{const r=Kn();r&&(Ime(r,t.backdrop),Ome(r,t.position),Nme(r,t.grow),ki(r,t,"container"))};function Ime(e,t){typeof t=="string"?e.style.background=t:t||$t([document.documentElement,document.body],xe["no-backdrop"])}function Ome(e,t){t&&(t in xe?$t(e,xe[t]):(Yn('The "position" parameter is not valid, defaulting to "center"'),$t(e,xe.center)))}function Nme(e,t){t&&$t(e,xe[`grow-${t}`])}var dr={innerParams:new WeakMap,domCache:new WeakMap};const Bme=["input","file","range","select","radio","checkbox","textarea"],Hme=(e,t)=>{const r=Wt();if(!r)return;const n=dr.innerParams.get(e),i=!n||t.input!==n.input;Bme.forEach(s=>{const o=Va(r,xe[s]);o&&(zme(s,t.inputAttributes),o.className=xe[s],i&&In(o))}),t.input&&(i&&Gme(t),Wme(t))},Gme=e=>{if(!e.input)return;if(!Gr[e.input]){Rc(`Unexpected type of input! Expected ${Object.keys(Gr).join(" | ")}, got "${e.input}"`);return}const t=y4(e.input);if(!t)return;const r=Gr[e.input](t,e);hn(t),e.inputAutoFocus&&setTimeout(()=>{v4(r)})},Vme=e=>{for(let t=0;t<e.attributes.length;t++){const r=e.attributes[t].name;["id","type","value","style"].includes(r)||e.removeAttribute(r)}},zme=(e,t)=>{const r=Wt();if(!r)return;const n=Av(r,e);if(n){Vme(n);for(const i in t)n.setAttribute(i,t[i])}},Wme=e=>{if(!e.input)return;const t=y4(e.input);t&&ki(t,e,"input")},Y1=(e,t)=>{!e.placeholder&&t.inputPlaceholder&&(e.placeholder=t.inputPlaceholder)},sg=(e,t,r)=>{if(r.inputLabel){const n=document.createElement("label"),i=xe["input-label"];n.setAttribute("for",e.id),n.className=i,typeof r.customClass=="object"&&$t(n,r.customClass.inputLabel),n.innerText=r.inputLabel,t.insertAdjacentElement("beforebegin",n)}},y4=e=>{const t=Wt();if(t)return Va(t,xe[e]||xe.input)},cm=(e,t)=>{["string","number"].includes(typeof t)?e.value=`${t}`:B1(t)||Yn(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof t}"`)},Gr={};Gr.text=Gr.email=Gr.password=Gr.number=Gr.tel=Gr.url=Gr.search=Gr.date=Gr["datetime-local"]=Gr.time=Gr.week=Gr.month=(e,t)=>(cm(e,t.inputValue),sg(e,e,t),Y1(e,t),e.type=t.input,e);Gr.file=(e,t)=>(sg(e,e,t),Y1(e,t),e);Gr.range=(e,t)=>{const r=e.querySelector("input"),n=e.querySelector("output");return cm(r,t.inputValue),r.type=t.input,cm(n,t.inputValue),sg(r,e,t),e};Gr.select=(e,t)=>{if(e.textContent="",t.inputPlaceholder){const r=document.createElement("option");_i(r,t.inputPlaceholder),r.value="",r.disabled=!0,r.selected=!0,e.appendChild(r)}return sg(e,e,t),e};Gr.radio=e=>(e.textContent="",e);Gr.checkbox=(e,t)=>{const r=Av(Wt(),"checkbox");r.value="1",r.checked=!!t.inputValue;const n=e.querySelector("span");return _i(n,t.inputPlaceholder||t.inputLabel),r};Gr.textarea=(e,t)=>{cm(e,t.inputValue),Y1(e,t),sg(e,e,t);const r=n=>parseInt(window.getComputedStyle(n).marginLeft)+parseInt(window.getComputedStyle(n).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const n=parseInt(window.getComputedStyle(Wt()).width),i=()=>{if(!document.body.contains(e))return;const s=e.offsetWidth+r(e);s>n?Wt().style.width=`${s}px`:Xl(Wt(),"width",t.width)};new MutationObserver(i).observe(e,{attributes:!0,attributeFilter:["style"]})}}),e};const Ume=(e,t)=>{const r=H1();r&&(U1(r),ki(r,t,"htmlContainer"),t.html?(j1(t.html,r),hn(r,"block")):t.text?(r.textContent=t.text,hn(r,"block")):In(r),Hme(e,t))},$me=(e,t)=>{const r=m4();r&&(U1(r),ig(r,!!t.footer,"block"),t.footer&&j1(t.footer,r),ki(r,t,"footer"))},jme=(e,t)=>{const r=dr.innerParams.get(e),n=Ed();if(!n)return;if(r&&t.icon===r.icon){kk(n,t),Ak(n,t);return}if(!t.icon&&!t.iconHtml){In(n);return}if(t.icon&&Object.keys(lm).indexOf(t.icon)===-1){Rc(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${t.icon}"`),In(n);return}hn(n),kk(n,t),Ak(n,t),$t(n,t.showClass&&t.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",b4)},Ak=(e,t)=>{for(const[r,n]of Object.entries(lm))t.icon!==r&&os(e,n);$t(e,t.icon&&lm[t.icon]),qme(e,t),b4(),ki(e,t,"icon")},b4=()=>{const e=Wt();if(!e)return;const t=window.getComputedStyle(e).getPropertyValue("background-color"),r=e.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let n=0;n<r.length;n++)r[n].style.backgroundColor=t},Yme=e=>`
  ${e.animation?'<div class="swal2-success-circular-line-left"></div>':""}
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div>
  ${e.animation?'<div class="swal2-success-fix"></div>':""}
  ${e.animation?'<div class="swal2-success-circular-line-right"></div>':""}
`,Kme=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,kk=(e,t)=>{if(!t.icon&&!t.iconHtml)return;let r=e.innerHTML,n="";t.iconHtml?n=Pk(t.iconHtml):t.icon==="success"?(n=Yme(t),r=r.replace(/ style=".*?"/g,"")):t.icon==="error"?n=Kme:t.icon&&(n=Pk({question:"?",warning:"!",info:"i"}[t.icon])),r.trim()!==n.trim()&&_i(e,n)},qme=(e,t)=>{if(t.iconColor){e.style.color=t.iconColor,e.style.borderColor=t.iconColor;for(const r of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])Dk(e,r,"background-color",t.iconColor);Dk(e,".swal2-success-ring","border-color",t.iconColor)}},Pk=e=>`<div class="${xe["icon-content"]}">${e}</div>`,Xme=(e,t)=>{const r=p4();if(r){if(!t.imageUrl){In(r);return}hn(r,""),r.setAttribute("src",t.imageUrl),r.setAttribute("alt",t.imageAlt||""),Xl(r,"width",t.imageWidth),Xl(r,"height",t.imageHeight),r.className=xe.image,ki(r,t,"image")}};let K1=!1,S4=0,x4=0,E4=0,R4=0;const Qme=e=>{e.addEventListener("mousedown",um),document.body.addEventListener("mousemove",dm),e.addEventListener("mouseup",hm),e.addEventListener("touchstart",um),document.body.addEventListener("touchmove",dm),e.addEventListener("touchend",hm)},Zme=e=>{e.removeEventListener("mousedown",um),document.body.removeEventListener("mousemove",dm),e.removeEventListener("mouseup",hm),e.removeEventListener("touchstart",um),document.body.removeEventListener("touchmove",dm),e.removeEventListener("touchend",hm)},um=e=>{const t=Wt();if(e.target===t||Ed().contains(e.target)){K1=!0;const r=T4(e);S4=r.clientX,x4=r.clientY,E4=parseInt(t.style.insetInlineStart)||0,R4=parseInt(t.style.insetBlockStart)||0,$t(t,"swal2-dragging")}},dm=e=>{const t=Wt();if(K1){let{clientX:r,clientY:n}=T4(e);t.style.insetInlineStart=`${E4+(r-S4)}px`,t.style.insetBlockStart=`${R4+(n-x4)}px`}},hm=()=>{const e=Wt();K1=!1,os(e,"swal2-dragging")},T4=e=>{let t=0,r=0;return e.type.startsWith("mouse")?(t=e.clientX,r=e.clientY):e.type.startsWith("touch")&&(t=e.touches[0].clientX,r=e.touches[0].clientY),{clientX:t,clientY:r}},Jme=(e,t)=>{const r=Kn(),n=Wt();if(!(!r||!n)){if(t.toast){Xl(r,"width",t.width),n.style.width="100%";const i=Td();i&&n.insertBefore(i,Ed())}else Xl(n,"width",t.width);Xl(n,"padding",t.padding),t.color&&(n.style.color=t.color),t.background&&(n.style.background=t.background),In(Tv()),eve(n,t),t.draggable&&!t.toast?($t(n,xe.draggable),Qme(n)):(os(n,xe.draggable),Zme(n))}},eve=(e,t)=>{const r=t.showClass||{};e.className=`${xe.popup} ${ai(e)?r.popup:""}`,t.toast?($t([document.documentElement,document.body],xe["toast-shown"]),$t(e,xe.toast)):$t(e,xe.modal),ki(e,t,"popup"),typeof t.customClass=="string"&&$t(e,t.customClass),t.icon&&$t(e,xe[`icon-${t.icon}`])},tve=(e,t)=>{const r=G1();if(!r)return;const{progressSteps:n,currentProgressStep:i}=t;if(!n||n.length===0||i===void 0){In(r);return}hn(r),r.textContent="",i>=n.length&&Yn("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),n.forEach((s,o)=>{const a=rve(s);if(r.appendChild(a),o===i&&$t(a,xe["active-progress-step"]),o!==n.length-1){const u=nve(t);r.appendChild(u)}})},rve=e=>{const t=document.createElement("li");return $t(t,xe["progress-step"]),_i(t,e),t},nve=e=>{const t=document.createElement("li");return $t(t,xe["progress-step-line"]),e.progressStepsDistance&&Xl(t,"width",e.progressStepsDistance),t},ive=(e,t)=>{const r=g4();r&&(U1(r),ig(r,!!(t.title||t.titleText),"block"),t.title&&j1(t.title,r),t.titleText&&(r.innerText=t.titleText),ki(r,t,"title"))},F4=(e,t)=>{Jme(e,t),Lme(e,t),tve(e,t),jme(e,t),Xme(e,t),ive(e,t),_me(e,t),Ume(e,t),kme(e,t),$me(e,t);const r=Wt();typeof t.didRender=="function"&&r&&t.didRender(r),lt.eventEmitter.emit("didRender",r)},sve=()=>ai(Wt()),D4=()=>{var e;return(e=so())===null||e===void 0?void 0:e.click()},ove=()=>{var e;return(e=Tc())===null||e===void 0?void 0:e.click()},ave=()=>{var e;return(e=Rd())===null||e===void 0?void 0:e.click()},Fd=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),A4=e=>{e.keydownTarget&&e.keydownHandlerAdded&&(e.keydownTarget.removeEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!1)},lve=(e,t,r)=>{A4(e),t.toast||(e.keydownHandler=n=>uve(t,n,r),e.keydownTarget=t.keydownListenerCapture?window:Wt(),e.keydownListenerCapture=t.keydownListenerCapture,e.keydownTarget.addEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!0)},dS=(e,t)=>{var r;const n=z1();if(n.length){e=e+t,e===-2&&(e=n.length-1),e===n.length?e=0:e===-1&&(e=n.length-1),n[e].focus();return}(r=Wt())===null||r===void 0||r.focus()},k4=["ArrowRight","ArrowDown"],cve=["ArrowLeft","ArrowUp"],uve=(e,t,r)=>{e&&(t.isComposing||t.keyCode===229||(e.stopKeydownPropagation&&t.stopPropagation(),t.key==="Enter"?dve(t,e):t.key==="Tab"?hve(t):[...k4,...cve].includes(t.key)?fve(t.key):t.key==="Escape"&&gve(t,e,r)))},dve=(e,t)=>{if(!Rv(t.allowEnterKey))return;const r=Av(Wt(),t.input);if(e.target&&r&&e.target instanceof HTMLElement&&e.target.outerHTML===r.outerHTML){if(["textarea","file"].includes(t.input))return;D4(),e.preventDefault()}},hve=e=>{const t=e.target,r=z1();let n=-1;for(let i=0;i<r.length;i++)if(t===r[i]){n=i;break}e.shiftKey?dS(n,-1):dS(n,1),e.stopPropagation(),e.preventDefault()},fve=e=>{const t=ng(),r=so(),n=Tc(),i=Rd();if(!t||!r||!n||!i)return;const s=[r,n,i];if(document.activeElement instanceof HTMLElement&&!s.includes(document.activeElement))return;const o=k4.includes(e)?"nextElementSibling":"previousElementSibling";let a=document.activeElement;if(a){for(let u=0;u<t.children.length;u++){if(a=a[o],!a)return;if(a instanceof HTMLButtonElement&&ai(a))break}a instanceof HTMLButtonElement&&a.focus()}},gve=(e,t,r)=>{e.preventDefault(),Rv(t.allowEscapeKey)&&r(Fd.esc)};var od={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const pve=()=>{const e=Kn();Array.from(document.body.children).forEach(r=>{r.contains(e)||(r.hasAttribute("aria-hidden")&&r.setAttribute("data-previous-aria-hidden",r.getAttribute("aria-hidden")||""),r.setAttribute("aria-hidden","true"))})},P4=()=>{Array.from(document.body.children).forEach(t=>{t.hasAttribute("data-previous-aria-hidden")?(t.setAttribute("aria-hidden",t.getAttribute("data-previous-aria-hidden")||""),t.removeAttribute("data-previous-aria-hidden")):t.removeAttribute("aria-hidden")})},M4=typeof window<"u"&&!!window.GestureEvent,mve=()=>{if(M4&&!jo(document.body,xe.iosfix)){const e=document.body.scrollTop;document.body.style.top=`${e*-1}px`,$t(document.body,xe.iosfix),vve()}},vve=()=>{const e=Kn();if(!e)return;let t;e.ontouchstart=r=>{t=wve(r)},e.ontouchmove=r=>{t&&(r.preventDefault(),r.stopPropagation())}},wve=e=>{const t=e.target,r=Kn(),n=H1();return!r||!n||Cve(e)||yve(e)?!1:t===r||!uS(r)&&t instanceof HTMLElement&&!wme(t,n)&&t.tagName!=="INPUT"&&t.tagName!=="TEXTAREA"&&!(uS(n)&&n.contains(t))},Cve=e=>e.touches&&e.touches.length&&e.touches[0].touchType==="stylus",yve=e=>e.touches&&e.touches.length>1,bve=()=>{if(jo(document.body,xe.iosfix)){const e=parseInt(document.body.style.top,10);os(document.body,xe.iosfix),document.body.style.top="",document.body.scrollTop=e*-1}},Sve=()=>{const e=document.createElement("div");e.className=xe["scrollbar-measure"],document.body.appendChild(e);const t=e.getBoundingClientRect().width-e.clientWidth;return document.body.removeChild(e),t};let Uu=null;const xve=e=>{Uu===null&&(document.body.scrollHeight>window.innerHeight||e==="scroll")&&(Uu=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Uu+Sve()}px`)},Eve=()=>{Uu!==null&&(document.body.style.paddingRight=`${Uu}px`,Uu=null)};function _4(e,t,r,n){Dv()?Mk(e,n):(lme(r).then(()=>Mk(e,n)),A4(lt)),M4?(t.setAttribute("style","display:none !important"),t.removeAttribute("class"),t.innerHTML=""):t.remove(),W1()&&(Eve(),bve(),P4()),Rve()}function Rve(){os([document.documentElement,document.body],[xe.shown,xe["height-auto"],xe["no-backdrop"],xe["toast-shown"]])}function za(e){e=Fve(e);const t=od.swalPromiseResolve.get(this),r=Tve(this);this.isAwaitingPromise?e.isDismissed||(og(this),t(e)):r&&t(e)}const Tve=e=>{const t=Wt();if(!t)return!1;const r=dr.innerParams.get(e);if(!r||jo(t,r.hideClass.popup))return!1;os(t,r.showClass.popup),$t(t,r.hideClass.popup);const n=Kn();return os(n,r.showClass.backdrop),$t(n,r.hideClass.backdrop),Dve(e,t,r),!0};function L4(e){const t=od.swalPromiseReject.get(this);og(this),t&&t(e)}const og=e=>{e.isAwaitingPromise&&(delete e.isAwaitingPromise,dr.innerParams.get(e)||e._destroy())},Fve=e=>typeof e>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},e),Dve=(e,t,r)=>{var n;const i=Kn(),s=C4(t);typeof r.willClose=="function"&&r.willClose(t),(n=lt.eventEmitter)===null||n===void 0||n.emit("willClose",t),s?Ave(e,t,i,r.returnFocus,r.didClose):_4(e,i,r.returnFocus,r.didClose)},Ave=(e,t,r,n,i)=>{lt.swalCloseEventFinishedCallback=_4.bind(null,e,r,n,i);const s=function(o){if(o.target===t){var a;(a=lt.swalCloseEventFinishedCallback)===null||a===void 0||a.call(lt),delete lt.swalCloseEventFinishedCallback,t.removeEventListener("animationend",s),t.removeEventListener("transitionend",s)}};t.addEventListener("animationend",s),t.addEventListener("transitionend",s)},Mk=(e,t)=>{setTimeout(()=>{var r;typeof t=="function"&&t.bind(e.params)(),(r=lt.eventEmitter)===null||r===void 0||r.emit("didClose"),e._destroy&&e._destroy()})},ad=e=>{let t=Wt();if(t||new Ci,t=Wt(),!t)return;const r=Td();Dv()?In(Ed()):kve(t,e),hn(r),t.setAttribute("data-loading","true"),t.setAttribute("aria-busy","true"),t.focus()},kve=(e,t)=>{const r=ng(),n=Td();!r||!n||(!t&&ai(so())&&(t=so()),hn(r),t&&(In(t),n.setAttribute("data-button-to-replace",t.className),r.insertBefore(n,t)),$t([e,r],xe.loading))},Pve=(e,t)=>{t.input==="select"||t.input==="radio"?Ove(e,t):["text","email","number","tel","textarea"].some(r=>r===t.input)&&(N1(t.inputValue)||B1(t.inputValue))&&(ad(so()),Nve(e,t))},Mve=(e,t)=>{const r=e.getInput();if(!r)return null;switch(t.input){case"checkbox":return _ve(r);case"radio":return Lve(r);case"file":return Ive(r);default:return t.inputAutoTrim?r.value.trim():r.value}},_ve=e=>e.checked?1:0,Lve=e=>e.checked?e.value:null,Ive=e=>e.files&&e.files.length?e.getAttribute("multiple")!==null?e.files:e.files[0]:null,Ove=(e,t)=>{const r=Wt();if(!r)return;const n=i=>{t.input==="select"?Bve(r,fm(i),t):t.input==="radio"&&Hve(r,fm(i),t)};N1(t.inputOptions)||B1(t.inputOptions)?(ad(so()),tg(t.inputOptions).then(i=>{e.hideLoading(),n(i)})):typeof t.inputOptions=="object"?n(t.inputOptions):Rc(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof t.inputOptions}`)},Nve=(e,t)=>{const r=e.getInput();r&&(In(r),tg(t.inputValue).then(n=>{r.value=t.input==="number"?`${parseFloat(n)||0}`:`${n}`,hn(r),r.focus(),e.hideLoading()}).catch(n=>{Rc(`Error in inputValue promise: ${n}`),r.value="",hn(r),r.focus(),e.hideLoading()}))};function Bve(e,t,r){const n=Va(e,xe.select);if(!n)return;const i=(s,o,a)=>{const u=document.createElement("option");u.value=a,_i(u,o),u.selected=I4(a,r.inputValue),s.appendChild(u)};t.forEach(s=>{const o=s[0],a=s[1];if(Array.isArray(a)){const u=document.createElement("optgroup");u.label=o,u.disabled=!1,n.appendChild(u),a.forEach(d=>i(u,d[1],d[0]))}else i(n,a,o)}),n.focus()}function Hve(e,t,r){const n=Va(e,xe.radio);if(!n)return;t.forEach(s=>{const o=s[0],a=s[1],u=document.createElement("input"),d=document.createElement("label");u.type="radio",u.name=xe.radio,u.value=o,I4(o,r.inputValue)&&(u.checked=!0);const h=document.createElement("span");_i(h,a),h.className=xe.label,d.appendChild(u),d.appendChild(h),n.appendChild(d)});const i=n.querySelectorAll("input");i.length&&i[0].focus()}const fm=e=>{const t=[];return e instanceof Map?e.forEach((r,n)=>{let i=r;typeof i=="object"&&(i=fm(i)),t.push([n,i])}):Object.keys(e).forEach(r=>{let n=e[r];typeof n=="object"&&(n=fm(n)),t.push([r,n])}),t},I4=(e,t)=>!!t&&t.toString()===e.toString(),Gve=e=>{const t=dr.innerParams.get(e);e.disableButtons(),t.input?O4(e,"confirm"):X1(e,!0)},Vve=e=>{const t=dr.innerParams.get(e);e.disableButtons(),t.returnInputValueOnDeny?O4(e,"deny"):q1(e,!1)},zve=(e,t)=>{e.disableButtons(),t(Fd.cancel)},O4=(e,t)=>{const r=dr.innerParams.get(e);if(!r.input){Rc(`The "input" parameter is needed to be set when using returnInputValueOn${O1(t)}`);return}const n=e.getInput(),i=Mve(e,r);r.inputValidator?Wve(e,i,t):n&&!n.checkValidity()?(e.enableButtons(),e.showValidationMessage(r.validationMessage||n.validationMessage)):t==="deny"?q1(e,i):X1(e,i)},Wve=(e,t,r)=>{const n=dr.innerParams.get(e);e.disableInput(),Promise.resolve().then(()=>tg(n.inputValidator(t,n.validationMessage))).then(s=>{e.enableButtons(),e.enableInput(),s?e.showValidationMessage(s):r==="deny"?q1(e,t):X1(e,t)})},q1=(e,t)=>{const r=dr.innerParams.get(e||void 0);r.showLoaderOnDeny&&ad(Tc()),r.preDeny?(e.isAwaitingPromise=!0,Promise.resolve().then(()=>tg(r.preDeny(t,r.validationMessage))).then(i=>{i===!1?(e.hideLoading(),og(e)):e.close({isDenied:!0,value:typeof i>"u"?t:i})}).catch(i=>N4(e||void 0,i))):e.close({isDenied:!0,value:t})},_k=(e,t)=>{e.close({isConfirmed:!0,value:t})},N4=(e,t)=>{e.rejectPromise(t)},X1=(e,t)=>{const r=dr.innerParams.get(e||void 0);r.showLoaderOnConfirm&&ad(),r.preConfirm?(e.resetValidationMessage(),e.isAwaitingPromise=!0,Promise.resolve().then(()=>tg(r.preConfirm(t,r.validationMessage))).then(i=>{ai(Tv())||i===!1?(e.hideLoading(),og(e)):_k(e,typeof i>"u"?t:i)}).catch(i=>N4(e||void 0,i))):_k(e,t)};function gm(){const e=dr.innerParams.get(this);if(!e)return;const t=dr.domCache.get(this);In(t.loader),Dv()?e.icon&&hn(Ed()):Uve(t),os([t.popup,t.actions],xe.loading),t.popup.removeAttribute("aria-busy"),t.popup.removeAttribute("data-loading"),t.confirmButton.disabled=!1,t.denyButton.disabled=!1,t.cancelButton.disabled=!1}const Uve=e=>{const t=e.popup.getElementsByClassName(e.loader.getAttribute("data-button-to-replace"));t.length?hn(t[0],"inline-block"):vme()&&In(e.actions)};function B4(){const e=dr.innerParams.get(this),t=dr.domCache.get(this);return t?Av(t.popup,e.input):null}function H4(e,t,r){const n=dr.domCache.get(e);t.forEach(i=>{n[i].disabled=r})}function G4(e,t){const r=Wt();if(!(!r||!e))if(e.type==="radio"){const n=r.querySelectorAll(`[name="${xe.radio}"]`);for(let i=0;i<n.length;i++)n[i].disabled=t}else e.disabled=t}function V4(){H4(this,["confirmButton","denyButton","cancelButton"],!1)}function z4(){H4(this,["confirmButton","denyButton","cancelButton"],!0)}function W4(){G4(this.getInput(),!1)}function U4(){G4(this.getInput(),!0)}function $4(e){const t=dr.domCache.get(this),r=dr.innerParams.get(this);_i(t.validationMessage,e),t.validationMessage.className=xe["validation-message"],r.customClass&&r.customClass.validationMessage&&$t(t.validationMessage,r.customClass.validationMessage),hn(t.validationMessage);const n=this.getInput();n&&(n.setAttribute("aria-invalid","true"),n.setAttribute("aria-describedby",xe["validation-message"]),v4(n),$t(n,xe.inputerror))}function j4(){const e=dr.domCache.get(this);e.validationMessage&&In(e.validationMessage);const t=this.getInput();t&&(t.removeAttribute("aria-invalid"),t.removeAttribute("aria-describedby"),os(t,xe.inputerror))}const $u={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},$ve=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],jve={allowEnterKey:void 0},Yve=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],Y4=e=>Object.prototype.hasOwnProperty.call($u,e),K4=e=>$ve.indexOf(e)!==-1,q4=e=>jve[e],Kve=e=>{Y4(e)||Yn(`Unknown parameter "${e}"`)},qve=e=>{Yve.includes(e)&&Yn(`The parameter "${e}" is incompatible with toasts`)},Xve=e=>{const t=q4(e);t&&f4(e,t)},X4=e=>{e.backdrop===!1&&e.allowOutsideClick&&Yn('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),e.theme&&!["light","dark","auto","minimal","borderless","bootstrap-4","bootstrap-4-light","bootstrap-4-dark","bootstrap-5","bootstrap-5-light","bootstrap-5-dark","material-ui","material-ui-light","material-ui-dark","embed-iframe","bulma","bulma-light","bulma-dark"].includes(e.theme)&&Yn(`Invalid theme "${e.theme}"`);for(const t in e)Kve(t),e.toast&&qve(t),Xve(t)};function Q4(e){const t=Kn(),r=Wt(),n=dr.innerParams.get(this);if(!r||jo(r,n.hideClass.popup)){Yn("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const i=Qve(e),s=Object.assign({},n,i);X4(s),t.dataset.swal2Theme=s.theme,F4(this,s),dr.innerParams.set(this,s),Object.defineProperties(this,{params:{value:Object.assign({},this.params,e),writable:!1,enumerable:!0}})}const Qve=e=>{const t={};return Object.keys(e).forEach(r=>{K4(r)?t[r]=e[r]:Yn(`Invalid parameter to update: ${r}`)}),t};function Z4(){const e=dr.domCache.get(this),t=dr.innerParams.get(this);if(!t){J4(this);return}e.popup&&lt.swalCloseEventFinishedCallback&&(lt.swalCloseEventFinishedCallback(),delete lt.swalCloseEventFinishedCallback),typeof t.didDestroy=="function"&&t.didDestroy(),lt.eventEmitter.emit("didDestroy"),Zve(this)}const Zve=e=>{J4(e),delete e.params,delete lt.keydownHandler,delete lt.keydownTarget,delete lt.currentInstance},J4=e=>{e.isAwaitingPromise?(Jy(dr,e),e.isAwaitingPromise=!0):(Jy(od,e),Jy(dr,e),delete e.isAwaitingPromise,delete e.disableButtons,delete e.enableButtons,delete e.getInput,delete e.disableInput,delete e.enableInput,delete e.hideLoading,delete e.disableLoading,delete e.showValidationMessage,delete e.resetValidationMessage,delete e.close,delete e.closePopup,delete e.closeModal,delete e.closeToast,delete e.rejectPromise,delete e.update,delete e._destroy)},Jy=(e,t)=>{for(const r in e)e[r].delete(t)};var Jve=Object.freeze({__proto__:null,_destroy:Z4,close:za,closeModal:za,closePopup:za,closeToast:za,disableButtons:z4,disableInput:U4,disableLoading:gm,enableButtons:V4,enableInput:W4,getInput:B4,handleAwaitingPromise:og,hideLoading:gm,rejectPromise:L4,resetValidationMessage:j4,showValidationMessage:$4,update:Q4});const ewe=(e,t,r)=>{e.toast?twe(e,t,r):(nwe(t),iwe(t),swe(e,t,r))},twe=(e,t,r)=>{t.popup.onclick=()=>{e&&(rwe(e)||e.timer||e.input)||r(Fd.close)}},rwe=e=>!!(e.showConfirmButton||e.showDenyButton||e.showCancelButton||e.showCloseButton);let pm=!1;const nwe=e=>{e.popup.onmousedown=()=>{e.container.onmouseup=function(t){e.container.onmouseup=()=>{},t.target===e.container&&(pm=!0)}}},iwe=e=>{e.container.onmousedown=t=>{t.target===e.container&&t.preventDefault(),e.popup.onmouseup=function(r){e.popup.onmouseup=()=>{},(r.target===e.popup||r.target instanceof HTMLElement&&e.popup.contains(r.target))&&(pm=!0)}}},swe=(e,t,r)=>{t.container.onclick=n=>{if(pm){pm=!1;return}n.target===t.container&&Rv(e.allowOutsideClick)&&r(Fd.backdrop)}},owe=e=>typeof e=="object"&&e.jquery,Lk=e=>e instanceof Element||owe(e),awe=e=>{const t={};return typeof e[0]=="object"&&!Lk(e[0])?Object.assign(t,e[0]):["title","html","icon"].forEach((r,n)=>{const i=e[n];typeof i=="string"||Lk(i)?t[r]=i:i!==void 0&&Rc(`Unexpected type of ${r}! Expected "string" or "Element", got ${typeof i}`)}),t};function lwe(...e){return new this(...e)}function cwe(e){class t extends this{_main(n,i){return super._main(n,Object.assign({},e,i))}}return t}const uwe=()=>lt.timeout&&lt.timeout.getTimerLeft(),eB=()=>{if(lt.timeout)return Cme(),lt.timeout.stop()},tB=()=>{if(lt.timeout){const e=lt.timeout.start();return $1(e),e}},dwe=()=>{const e=lt.timeout;return e&&(e.running?eB():tB())},hwe=e=>{if(lt.timeout){const t=lt.timeout.increase(e);return $1(t,!0),t}},fwe=()=>!!(lt.timeout&&lt.timeout.isRunning());let Ik=!1;const hS={};function gwe(e="data-swal-template"){hS[e]=this,Ik||(document.body.addEventListener("click",pwe),Ik=!0)}const pwe=e=>{for(let t=e.target;t&&t!==document;t=t.parentNode)for(const r in hS){const n=t.getAttribute(r);if(n){hS[r].fire({template:n});return}}};class mwe{constructor(){this.events={}}_getHandlersByEventName(t){return typeof this.events[t]>"u"&&(this.events[t]=[]),this.events[t]}on(t,r){const n=this._getHandlersByEventName(t);n.includes(r)||n.push(r)}once(t,r){const n=(...i)=>{this.removeListener(t,n),r.apply(this,i)};this.on(t,n)}emit(t,...r){this._getHandlersByEventName(t).forEach(n=>{try{n.apply(this,r)}catch(i){console.error(i)}})}removeListener(t,r){const n=this._getHandlersByEventName(t),i=n.indexOf(r);i>-1&&n.splice(i,1)}removeAllListeners(t){this.events[t]!==void 0&&(this.events[t].length=0)}reset(){this.events={}}}lt.eventEmitter=new mwe;const vwe=(e,t)=>{lt.eventEmitter.on(e,t)},wwe=(e,t)=>{lt.eventEmitter.once(e,t)},Cwe=(e,t)=>{if(!e){lt.eventEmitter.reset();return}t?lt.eventEmitter.removeListener(e,t):lt.eventEmitter.removeAllListeners(e)};var ywe=Object.freeze({__proto__:null,argsToParams:awe,bindClickHandler:gwe,clickCancel:ave,clickConfirm:D4,clickDeny:ove,enableLoading:ad,fire:lwe,getActions:ng,getCancelButton:Rd,getCloseButton:V1,getConfirmButton:so,getContainer:Kn,getDenyButton:Tc,getFocusableElements:z1,getFooter:m4,getHtmlContainer:H1,getIcon:Ed,getIconContent:hme,getImage:p4,getInputLabel:fme,getLoader:Td,getPopup:Wt,getProgressSteps:G1,getTimerLeft:uwe,getTimerProgressBar:Fv,getTitle:g4,getValidationMessage:Tv,increaseTimer:hwe,isDeprecatedParameter:q4,isLoading:pme,isTimerRunning:fwe,isUpdatableParameter:K4,isValidParameter:Y4,isVisible:sve,mixin:cwe,off:Cwe,on:vwe,once:wwe,resumeTimer:tB,showLoading:ad,stopTimer:eB,toggleTimer:dwe});class bwe{constructor(t,r){this.callback=t,this.remaining=r,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(t){const r=this.running;return r&&this.stop(),this.remaining+=t,r&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const rB=["swal-title","swal-html","swal-footer"],Swe=e=>{const t=typeof e.template=="string"?document.querySelector(e.template):e.template;if(!t)return{};const r=t.content;return kwe(r),Object.assign(xwe(r),Ewe(r),Rwe(r),Twe(r),Fwe(r),Dwe(r),Awe(r,rB))},xwe=e=>{const t={};return Array.from(e.querySelectorAll("swal-param")).forEach(n=>{dc(n,["name","value"]);const i=n.getAttribute("name"),s=n.getAttribute("value");!i||!s||(typeof $u[i]=="boolean"?t[i]=s!=="false":typeof $u[i]=="object"?t[i]=JSON.parse(s):t[i]=s)}),t},Ewe=e=>{const t={};return Array.from(e.querySelectorAll("swal-function-param")).forEach(n=>{const i=n.getAttribute("name"),s=n.getAttribute("value");!i||!s||(t[i]=new Function(`return ${s}`)())}),t},Rwe=e=>{const t={};return Array.from(e.querySelectorAll("swal-button")).forEach(n=>{dc(n,["type","color","aria-label"]);const i=n.getAttribute("type");!i||!["confirm","cancel","deny"].includes(i)||(t[`${i}ButtonText`]=n.innerHTML,t[`show${O1(i)}Button`]=!0,n.hasAttribute("color")&&(t[`${i}ButtonColor`]=n.getAttribute("color")),n.hasAttribute("aria-label")&&(t[`${i}ButtonAriaLabel`]=n.getAttribute("aria-label")))}),t},Twe=e=>{const t={},r=e.querySelector("swal-image");return r&&(dc(r,["src","width","height","alt"]),r.hasAttribute("src")&&(t.imageUrl=r.getAttribute("src")||void 0),r.hasAttribute("width")&&(t.imageWidth=r.getAttribute("width")||void 0),r.hasAttribute("height")&&(t.imageHeight=r.getAttribute("height")||void 0),r.hasAttribute("alt")&&(t.imageAlt=r.getAttribute("alt")||void 0)),t},Fwe=e=>{const t={},r=e.querySelector("swal-icon");return r&&(dc(r,["type","color"]),r.hasAttribute("type")&&(t.icon=r.getAttribute("type")),r.hasAttribute("color")&&(t.iconColor=r.getAttribute("color")),t.iconHtml=r.innerHTML),t},Dwe=e=>{const t={},r=e.querySelector("swal-input");r&&(dc(r,["type","label","placeholder","value"]),t.input=r.getAttribute("type")||"text",r.hasAttribute("label")&&(t.inputLabel=r.getAttribute("label")),r.hasAttribute("placeholder")&&(t.inputPlaceholder=r.getAttribute("placeholder")),r.hasAttribute("value")&&(t.inputValue=r.getAttribute("value")));const n=Array.from(e.querySelectorAll("swal-input-option"));return n.length&&(t.inputOptions={},n.forEach(i=>{dc(i,["value"]);const s=i.getAttribute("value");if(!s)return;const o=i.innerHTML;t.inputOptions[s]=o})),t},Awe=(e,t)=>{const r={};for(const n in t){const i=t[n],s=e.querySelector(i);s&&(dc(s,[]),r[i.replace(/^swal-/,"")]=s.innerHTML.trim())}return r},kwe=e=>{const t=rB.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(e.children).forEach(r=>{const n=r.tagName.toLowerCase();t.includes(n)||Yn(`Unrecognized element <${n}>`)})},dc=(e,t)=>{Array.from(e.attributes).forEach(r=>{t.indexOf(r.name)===-1&&Yn([`Unrecognized attribute "${r.name}" on <${e.tagName.toLowerCase()}>.`,`${t.length?`Allowed attributes are: ${t.join(", ")}`:"To set the value, use HTML within the element."}`])})},nB=10,Pwe=e=>{const t=Kn(),r=Wt();typeof e.willOpen=="function"&&e.willOpen(r),lt.eventEmitter.emit("willOpen",r);const i=window.getComputedStyle(document.body).overflowY;Lwe(t,r,e),setTimeout(()=>{Mwe(t,r)},nB),W1()&&(_we(t,e.scrollbarPadding,i),pve()),!Dv()&&!lt.previousActiveElement&&(lt.previousActiveElement=document.activeElement),typeof e.didOpen=="function"&&setTimeout(()=>e.didOpen(r)),lt.eventEmitter.emit("didOpen",r)},mm=e=>{const t=Wt();if(e.target!==t)return;const r=Kn();t.removeEventListener("animationend",mm),t.removeEventListener("transitionend",mm),r.style.overflowY="auto",os(r,xe["no-transition"])},Mwe=(e,t)=>{C4(t)?(e.style.overflowY="hidden",t.addEventListener("animationend",mm),t.addEventListener("transitionend",mm)):e.style.overflowY="auto"},_we=(e,t,r)=>{mve(),t&&r!=="hidden"&&xve(r),setTimeout(()=>{e.scrollTop=0})},Lwe=(e,t,r)=>{$t(e,r.showClass.backdrop),r.animation?(t.style.setProperty("opacity","0","important"),hn(t,"grid"),setTimeout(()=>{$t(t,r.showClass.popup),t.style.removeProperty("opacity")},nB)):hn(t,"grid"),$t([document.documentElement,document.body],xe.shown),r.heightAuto&&r.backdrop&&!r.toast&&$t([document.documentElement,document.body],xe["height-auto"])};var Ok={email:(e,t)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid email address"),url:(e,t)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid URL")};function Iwe(e){e.inputValidator||(e.input==="email"&&(e.inputValidator=Ok.email),e.input==="url"&&(e.inputValidator=Ok.url))}function Owe(e){(!e.target||typeof e.target=="string"&&!document.querySelector(e.target)||typeof e.target!="string"&&!e.target.appendChild)&&(Yn('Target parameter is not valid, defaulting to "body"'),e.target="body")}function Nwe(e){Iwe(e),e.showLoaderOnConfirm&&!e.preConfirm&&Yn(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),Owe(e),typeof e.title=="string"&&(e.title=e.title.split(`
`).join("<br />")),Fme(e)}let $s;var Kp=new WeakMap;class Ur{constructor(...t){if(ime(this,Kp,void 0),typeof window>"u")return;$s=this;const r=Object.freeze(this.constructor.argsToParams(t));this.params=r,this.isAwaitingPromise=!1,sme(Kp,this,this._main($s.params))}_main(t,r={}){if(X4(Object.assign({},r,t)),lt.currentInstance){const s=od.swalPromiseResolve.get(lt.currentInstance),{isAwaitingPromise:o}=lt.currentInstance;lt.currentInstance._destroy(),o||s({isDismissed:!0}),W1()&&P4()}lt.currentInstance=$s;const n=Hwe(t,r);Nwe(n),Object.freeze(n),lt.timeout&&(lt.timeout.stop(),delete lt.timeout),clearTimeout(lt.restoreFocusTimeout);const i=Gwe($s);return F4($s,n),dr.innerParams.set($s,n),Bwe($s,i,n)}then(t){return Tk(Kp,this).then(t)}finally(t){return Tk(Kp,this).finally(t)}}const Bwe=(e,t,r)=>new Promise((n,i)=>{const s=o=>{e.close({isDismissed:!0,dismiss:o,isConfirmed:!1,isDenied:!1})};od.swalPromiseResolve.set(e,n),od.swalPromiseReject.set(e,i),t.confirmButton.onclick=()=>{Gve(e)},t.denyButton.onclick=()=>{Vve(e)},t.cancelButton.onclick=()=>{zve(e,s)},t.closeButton.onclick=()=>{s(Fd.close)},ewe(r,t,s),lve(lt,r,s),Pve(e,r),Pwe(r),Vwe(lt,r,s),zwe(t,r),setTimeout(()=>{t.container.scrollTop=0})}),Hwe=(e,t)=>{const r=Swe(e),n=Object.assign({},$u,t,r,e);return n.showClass=Object.assign({},$u.showClass,n.showClass),n.hideClass=Object.assign({},$u.hideClass,n.hideClass),n.animation===!1&&(n.showClass={backdrop:"swal2-noanimation"},n.hideClass={}),n},Gwe=e=>{const t={popup:Wt(),container:Kn(),actions:ng(),confirmButton:so(),denyButton:Tc(),cancelButton:Rd(),loader:Td(),closeButton:V1(),validationMessage:Tv(),progressSteps:G1()};return dr.domCache.set(e,t),t},Vwe=(e,t,r)=>{const n=Fv();In(n),t.timer&&(e.timeout=new bwe(()=>{r("timer"),delete e.timeout},t.timer),t.timerProgressBar&&(hn(n),ki(n,t,"timerProgressBar"),setTimeout(()=>{e.timeout&&e.timeout.running&&$1(t.timer)})))},zwe=(e,t)=>{if(!t.toast){if(!Rv(t.allowEnterKey)){f4("allowEnterKey"),$we();return}Wwe(e)||Uwe(e,t)||dS(-1,1)}},Wwe=e=>{const t=Array.from(e.popup.querySelectorAll("[autofocus]"));for(const r of t)if(r instanceof HTMLElement&&ai(r))return r.focus(),!0;return!1},Uwe=(e,t)=>t.focusDeny&&ai(e.denyButton)?(e.denyButton.focus(),!0):t.focusCancel&&ai(e.cancelButton)?(e.cancelButton.focus(),!0):t.focusConfirm&&ai(e.confirmButton)?(e.confirmButton.focus(),!0):!1,$we=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};Ur.prototype.disableButtons=z4;Ur.prototype.enableButtons=V4;Ur.prototype.getInput=B4;Ur.prototype.disableInput=U4;Ur.prototype.enableInput=W4;Ur.prototype.hideLoading=gm;Ur.prototype.disableLoading=gm;Ur.prototype.showValidationMessage=$4;Ur.prototype.resetValidationMessage=j4;Ur.prototype.close=za;Ur.prototype.closePopup=za;Ur.prototype.closeModal=za;Ur.prototype.closeToast=za;Ur.prototype.rejectPromise=L4;Ur.prototype.update=Q4;Ur.prototype._destroy=Z4;Object.assign(Ur,ywe);Object.keys(Jve).forEach(e=>{Ur[e]=function(...t){return $s&&$s[e]?$s[e](...t):null}});Ur.DismissReason=Fd;Ur.version="11.26.3";const Ci=Ur;Ci.default=Ci;typeof document<"u"&&(function(e,t){var r=e.createElement("style");if(e.getElementsByTagName("head")[0].appendChild(r),r.styleSheet)r.styleSheet.disabled||(r.styleSheet.cssText=t);else try{r.innerHTML=t}catch{r.innerText=t}})(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.15s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border: 1px solid #d9d9d9;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.2s, box-shadow 0.2s;--swal2-input-hover-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-focus-border: 1px solid #b4dbed;--swal2-input-focus-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-footer-border-color: #eee;--swal2-footer-background: transparent;--swal2-footer-color: inherit;--swal2-timer-progress-bar-background: rgba(0, 0, 0, 0.3);--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.2s, box-shadow 0.2s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-actions-justify-content: center;--swal2-actions-width: auto;--swal2-actions-margin: 1.25em auto 0;--swal2-actions-padding: 0;--swal2-actions-border-radius: 0;--swal2-actions-background: transparent;--swal2-action-button-transition: background-color 0.2s, box-shadow 0.2s;--swal2-action-button-hover: black 10%;--swal2-action-button-active: black 10%;--swal2-confirm-button-box-shadow: none;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-confirm-button-color: #fff;--swal2-deny-button-box-shadow: none;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-deny-button-color: #fff;--swal2-cancel-button-box-shadow: none;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-cancel-button-color: #fff;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white);--swal2-timer-progress-bar-background: rgba(255, 255, 255, 0.7)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white);--swal2-timer-progress-bar-background: rgba(255, 255, 255, 0.7)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;overflow-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:var(--swal2-actions-justify-content);width:var(--swal2-actions-width);margin:var(--swal2-actions-margin);padding:var(--swal2-actions-padding);border-radius:var(--swal2-actions-border-radius);background:var(--swal2-actions-background)}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-action-button-transition);border:none;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);box-shadow:var(--swal2-confirm-button-box-shadow);color:var(--swal2-confirm-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):hover{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):active{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);box-shadow:var(--swal2-deny-button-box-shadow);color:var(--swal2-deny-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):hover{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):active{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);box-shadow:var(--swal2-cancel-button-box-shadow);color:var(--swal2-cancel-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):hover{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):active{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-styled)[disabled]:not(.swal2-loading){opacity:.4}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);background:var(--swal2-footer-background);color:var(--swal2-footer-color);font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:var(--swal2-timer-progress-bar-background)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;overflow-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:var(--swal2-input-border);border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):hover,div:where(.swal2-container) input:where(.swal2-file):hover,div:where(.swal2-container) textarea:where(.swal2-textarea):hover{box-shadow:var(--swal2-input-hover-box-shadow)}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:var(--swal2-input-focus-border);outline:none;box-shadow:var(--swal2-input-focus-box-shadow)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:translate3d(0, -50px, 0) scale(0.9);opacity:0}100%{transform:translate3d(0, 0, 0) scale(1);opacity:1}}@keyframes swal2-hide{0%{transform:translate3d(0, 0, 0) scale(1);opacity:1}100%{transform:translate3d(0, -50px, 0) scale(0.9);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');const iB={COM_CDS:"/co/cd/comCdDtls",MST_ITEMS:"/am/cmns/cmnsItems",MST_VRTYS:"/am/cmns/cmnsVrtys",MST_SPCFCTS:"/am/cmns/cmnsSpcfcts",MST_GRDS:"/am/cmns/stdGrds",APC_ITEMS:"/am/cmns/apcItems",APC_VRTYS:"/am/cmns/apcVrtys",APC_SPCFCTS:"/am/cmns/apcSpcfcts",APC_GRDS:"/am/cmns/apcGrds",APC_GDS_GRDS:"/am/cmns/apcStdGrdDtls",APC_SEEDS:"/am/cmns/apcSeeds",CNPT_INFO:"/am/cmns/cnptInfos",GDS_INFO:"/am/cmns/gdsInfos",PLT_BX_INFO:"/am/cmns/pltBxInfos",PRDCR_INFO:"/am/cmns/prdcrInfos",WRHS_VHCL:"/am/cmns/wrhsVhcls",TRSPRT_CO_INFO:"/am/spmt/spmtTrsprts",TRSPRT_CST_INFO:"/am/cmns/trsprtCsts",SPMT_PCKG_UINT:"/am/cmns/spmtPckgUnits",APC_INFO:"/am/apc/apcInfos",CRTR_YR:"/am/fclt/crtrYr",APC_RPT_KNDS:"/co/cd/apcRptKnds"};let jwe=null;const Ywe=async(e,t)=>{if(!e)return await t();const r=Date.now();try{const n=await t(),s=Date.now()-r;return s<500&&await new Promise(o=>setTimeout(o,500-s)),n}finally{}},Kwe=e=>{if(e.resultStatus!=="S"&&e.resultCode==="E0010"&&typeof window<"u"&&window.parent){const t=window.parent.lfn_redirect;typeof t=="function"?t("/main.do"):window.location.href="/main.do"}};async function qwe(e,t,r={}){const{sysPrgrmId:n,hideProgress:i=!1}=r,s=!i,o={"Content-Type":"application/json"},a=document.querySelector('meta[name="csrf-token"]')?.content;a&&(o["X-CSRF-TOKEN"]=a);const u=n||jwe;return u&&(o.sysPrgrmId=u),Ywe(s,async()=>{try{const g=await(await fetch(e,{method:"POST",headers:o,body:t?JSON.stringify(t):void 0,credentials:"same-origin"})).json();return Kwe(g),g}catch(h){throw console.error("API  :",h),h}})}const sB=(e,t)=>qwe(e,t),Xwe=async e=>{try{const t=await sB(iB.CNPT_INFO,{apcCd:e});return t.resultStatus==="S"&&t.resultList?t.resultList:[]}catch(t){return console.error("  :",t),[]}},Qwe=async(e,t="0000")=>{try{const r={cdId:e,apcCd:t,delYn:"N"},n=await sB(iB.COM_CDS,r);return n.resultStatus==="S"&&n.resultList?n.resultList:[]}catch(r){return console.error("  :",r),[]}},Zwe=Xwe,Jwe=Qwe;/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var eCe={outline:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},filled:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",stroke:"none"}};/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const tCe=(e,t,r,n)=>{const i=T.forwardRef(({color:s="currentColor",size:o=24,stroke:a=2,title:u,className:d,children:h,...g},m)=>T.createElement("svg",{ref:m,...eCe[e],width:o,height:o,className:["tabler-icon",`tabler-icon-${t}`,d].join(" "),strokeWidth:a,stroke:s,...g},[u&&T.createElement("title",{key:"svg-title"},u),...n.map(([v,w])=>T.createElement(v,w)),...Array.isArray(h)?h:[h]]));return i.displayName=`${r}`,i};/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const rCe=[["path",{d:"M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z",key:"svg-0"}],["path",{d:"M16 3v4",key:"svg-1"}],["path",{d:"M8 3v4",key:"svg-2"}],["path",{d:"M4 11h16",key:"svg-3"}],["path",{d:"M11 15h1",key:"svg-4"}],["path",{d:"M12 15v3",key:"svg-5"}]],Nk=tCe("outline","calendar","Calendar",rCe);var m0={exports:{}},nCe=m0.exports,Bk;function iCe(){return Bk||(Bk=1,(function(e,t){(function(r,n){e.exports=n(WN())})(nCe,(function(r){function n(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var i=n(r),s={name:"ko",weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),ordinal:function(o){return o+""},formats:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm",l:"YYYY.MM.DD.",ll:"YYYY MMMM D",lll:"YYYY MMMM D A h:mm",llll:"YYYY MMMM D dddd A h:mm"},meridiem:function(o){return o<12?"":""},relativeTime:{future:"%s ",past:"%s ",s:" ",m:"1",mm:"%d",h:" ",hh:"%d",d:"",dd:"%d",M:" ",MM:"%d",y:" ",yy:"%d"}};return i.default.locale(s,null,!0),s}))})(m0)),m0.exports}iCe();const sCe=(e,t="",r=!1)=>{const n=e.getFullYear(),i=(e.getMonth()+1).toString().padStart(2,"0"),s=e.getDate().toString().padStart(2,"0");let o="";return r?(o+=n+" ",o+=i+" ",o+=s+" "):(o+=n,o+=t+i,o+=t+s),o};class oCe extends Error{constructor(t,r){super(`HTTP ${t}`),this.status=t,this.body=r}}const aCe=()=>{const e={"Content-Type":"application/json"},t=document.querySelector('meta[name="csrf-token"]')?.content;return t&&(e["X-CSRF-TOKEN"]=t),e};async function qp(e,t,r={}){const n=await fetch(e,{...r,method:"POST",body:t?JSON.stringify(t):void 0,headers:{...aCe(),...r.headers||{}},credentials:"same-origin"}),i=await n.json().catch(()=>{});if(!n.ok)throw new oCe(n.status,i);return i}const Hk={outordrno:"",mrktWrhsType:"",mrktWrhsTypeNm:"",mrktGdsCd:"SKU ID",mrktGdsNm:"SKU ",otptNm:"SKU Barcode",cntrNm:"",wrhsYmd:"",outordrYmd:"",outordrQntt:"",cfmtnQntt:"",wrhsQntt:"",prchsTypeCd:"",exmptnYn:"",prdctnYr:"",mnftrYmd:"",pieceUntprc:"",txamt:"",outordrAmt:" ",wrhsAmt:""},lCe=({apcCd:e,apcNm:t,sysPrgrmId:r})=>{const[n,i]=T.useState([]),s=T.useRef(null),[o,a]=T.useState(!1),[u,d]=T.useState(""),[h,g]=T.useState(e),[m,v]=T.useState(),[w,C]=T.useState(sCe(new Date)),[b,x]=T.useState(),[R,E]=T.useState(""),[A,D]=T.useState([]),[M,F]=T.useState(""),[O,L]=T.useState([]),[W,I]=T.useState([]),G=T.useMemo(()=>{const le=new Map;return W.forEach(de=>{de.useYn==="Y"&&(le.has(de.lgszMrktCd)||le.set(de.lgszMrktCd,[]),le.get(de.lgszMrktCd).push(de))}),le},[W]),[ne,ie]=T.useState();T.useEffect(()=>{(async()=>{a(!0),d("  ...");try{const[de,ue,Ie,q]=await Promise.all([Zwe(e),Jwe("LGSZ_MRKT_CD"),qp("/am/ordr/selectMrktLgstcsCntrList.do",{apcCd:e}),qp("/am/ordr/selectMrktGdsCdList.do",{ordrApcCd:h})]);de&&D(de.map(Ge=>({label:Ge.cnptNm,value:Ge.cnptCd}))),Ie&&ie(Ie.resultList),q&&I(q.resultList)}catch(de){console.error(de),Ci.fire("","    .","error")}finally{a(!1),d("")}})()},[]);const J=le=>{E(le),F("");const de=ne.filter(q=>q.cnptCd==le)[0],Ie=(G.get(de.lgszMrktCd)||[]).map(q=>({value:q.mrktGdsCd,label:q.mrktGdsNm}));L(Ie)},_=[{field:"outordrno",headerName:"",width:100,editable:!0},{field:"mrktWrhsType",headerName:"",width:100,editable:!0},{field:"mrktWrhsTypeNm",headerName:"",width:100,editable:!0},{field:"mrktGdsCd",headerName:"SKU ID",width:100,editable:!0},{field:"mrktGdsNm",headerName:"SKU ",width:100,editable:!0},{field:"otptNm",headerName:"SKU Barcode",width:100,editable:!0},{field:"cntrNm",headerName:"",width:100,editable:!0},{field:"wrhsYmd",headerName:"",width:100,editable:!0},{field:"outordrYmd",headerName:"",width:120,editable:!0},{field:"outordrQntt",headerName:"",width:100,type:"numericColumn",editable:!0,valueFormatter:le=>le.value?le.value.toLocaleString():""},{field:"cfmtnQntt",headerName:"",width:100,type:"numericColumn",editable:!0,valueFormatter:le=>le.value?le.value.toLocaleString():""},{field:"wrhsQntt",headerName:"",width:100,type:"numericColumn",editable:!0,valueFormatter:le=>le.value?le.value.toLocaleString():""},{field:"prchsTypeCd",headerName:"",width:120,editable:!0},{field:"exmptnYn",headerName:"",width:100,editable:!0},{field:"prdctnYr",headerName:"",width:120,editable:!0},{field:"mnftrYmd",headerName:"",width:120,editable:!0},{field:"pieceUntprc",headerName:"",width:100,type:"numericColumn",editable:!0,valueFormatter:le=>le.value?le.value.toLocaleString():""},{field:"txamt",headerName:"",width:100,type:"numericColumn",editable:!0,valueFormatter:le=>le.value?le.value.toLocaleString():""},{field:"outordrAmt",headerName:" ",width:100,type:"numericColumn",editable:!0,valueFormatter:le=>le.value?le.value.toLocaleString():""},{field:"wrhsAmt",headerName:"",width:100,type:"numericColumn",editable:!0,valueFormatter:le=>le.value?le.value.toLocaleString():""}],Y={:"outordrno",:"mrktWrhsType",:"mrktWrhsTypeNm","SKU ID":"mrktGdsCd","SKU ":"mrktGdsNm","SKU Barcode":"otptNm",:"cntrNm",:"wrhsYmd",:"outordrYmd",:"outordrQntt",:"cfmtnQntt",:"wrhsQntt",:"prchsTypeCd",:"exmptnYn",:"prdctnYr",:"mnftrYmd",:"pieceUntprc",:"txamt"," ":"outordrAmt",:"wrhsAmt"},Q=le=>le.toLowerCase().replace(/_([a-z])/g,(de,ue)=>ue.toUpperCase()),U=le=>{if(le){if(typeof le=="string")return le;if(typeof le=="number"){const de=new Date((le-25569)*86400*1e3),ue=de.getFullYear(),Ie=String(de.getMonth()+1).padStart(2,"0"),q=String(de.getDate()).padStart(2,"0");return`${ue}${Ie}${q}`}}},se=le=>le.map((de,ue)=>{const Ie={};return Object.keys(de).forEach(q=>{let Ge=de[q];if(["","","","wrhsYmd","outordrYmd","mnftrYmd","WRHS_YMD","OUTORDR_YMD","MNFTR_YMD"].includes(q)&&(Ge=U(Ge)),Y[q])Ie[Y[q]]=Ge;else if(q.includes("_")){const Ze=Q(q);Ie[Ze]=Ge}else Ie[q]=Ge}),Ie.ordrApcCd=h,Ie.ordrSeq=ue,Ie}),N=le=>{const de=le.target.files;if(!de||de.length===0)return;const ue=de[0],Ie=new FileReader;Ie.onload=q=>{try{const Ge=q.target?.result,Ye=cS(Ge,{type:"binary"}),Ze=Ye.SheetNames[0],ke=Ye.Sheets[Ze],De=Yp.sheet_to_json(ke),nt=se(De);i(nt),s.current&&(s.current.value="")}catch(Ge){console.error("   :",Ge),alert("     .")}},Ie.readAsBinaryString(ue)},P=()=>{s.current?.click()},V=async()=>{if(n.length===0){Ci.fire(""," .","error");return}a(!0),d(`${n.length}  ...`);try{const le=await qp("/am/ordr/insertMrktGdsOrdrList.do",n,{headers:{sysPrgrmId:r}});if(le.resultStatus=="S"){const de=le.resultList.insertedCnt,ue=le.resultList.insertFailList;ue.length===0?(Ci.fire({icon:"success",text:`${de} `,width:"320px",showConfirmButton:!1,timer:1500}),i([])):(Ci.fire({icon:"warning",title:" ",html:`
              <div style="font-size: 14px;">
                 ${de} <br/>
                 ${ue.length} 
              </div>
            `,width:"350px",confirmButtonText:""}),i(ue))}}catch(le){console.error(le),Ci.fire("","   .","error")}finally{a(!1),d("")}},H=T.useMemo(()=>({sortable:!0,filter:!0,resizable:!0,tooltipValueGetter:le=>le.data?.failMsg?` ${le.data.failMsg}`:null}),[]),j=async()=>{a(!0),d(" ...");try{const de=await qp("/am/ordr/selectMrktGdsOrdrList.do",{ordrApcCd:e,wrhsYmd:b,outordrYmd:w,cntrCd:R,mrktGdsCd:M});de.resultStatus=="S"&&de.resultList.length>0?i(de.resultList):(Ci.fire(""," .","error"),i([]))}catch(le){console.error(le),Ci.fire("","   .","error")}finally{a(!1),d("")}},ae=le=>le.map(de=>{const ue={};return Object.keys(Hk).forEach(Ie=>{const q=Hk[Ie];ue[q]=de[Ie]??""}),ue}),fe=()=>{if(n.length===0){Ci.fire("","  .","warning");return}a(!0),d("   ..."),setTimeout(()=>{try{const le=ae(n),de=Yp.json_to_sheet(le),ue=Yp.book_new();Yp.book_append_sheet(ue,de,"");const Ie=new Date,Ge=`_${`${Ie.getFullYear()}${String(Ie.getMonth()+1).padStart(2,"0")}${String(Ie.getDate()).padStart(2,"0")}`}.xlsx`;e0e(ue,Ge),Ci.fire({icon:"success",text:`${n.length}  `,timer:1500,showConfirmButton:!1})}catch(le){console.error("  :",le),Ci.fire("","   .","error")}finally{a(!1),d("")}},100)};return Z.jsxs(Z.Fragment,{children:[Z.jsx("style",{children:`
      .box-header {
        padding-right: 15px;
        font-size: 18px;
        color: #1c54a2;
        font-family: 'LeferiPoint', sans-serif;
        font-weight: 600;
        padding: 15px 15px 12px;
      }
      .box-title{
        padding-right: 15px;
        font-size: 18px;
        color: #1c54a2;
        font-family: 'LeferiPoint', sans-serif;
        font-weight: 600;
      }
      .box-body {
        padding: 10px 15px 15px;
      }
      .table {
        margin-bottom: 0;
        width: 100%;
        border-collapse: collapse;
        border-spacing: 0;
      }
      .table-bordered {
        border: 1px solid #ddd;
      }
      .table-bordered th,
      .table-bordered td {
        border: 1px solid #ddd;
      }
      .td_input {
        padding: 6px 8px;
      }
         .table > tbody > tr > th {
        border: 1px solid #f4f4f4;
        padding: 8px;
        line-height: 1.42857143;
        background-color: #e8f1f9;
        text-align: right;
        border-color: #e8f1f9 !important;
        border-bottom: 1px solid #ffffff !important;
        word-wrap: break-word;
        font-size: 13px;
      }
      .btn-upload {
        color: #666;
        background: #fff;
        border: 1px solid #666;
        padding: 5px 9px;
        min-width: 66px;
        border-radius: 3px;
        font-size: 12px;
        cursor: pointer;
        transition: all 0.2s;
        font-weight: 500;
      }
      .btn-upload:hover {
        background-color: #2d5a9f;
      }
      .btn-save {
        background-color: #3c6dbc;
        color: white;
        border: none;
        padding: 6px 14px;
        border-radius: 3px;
        font-size: 12px;
        cursor: pointer;
        transition: all 0.2s;
      }
      .btn-save:hover {
        background-color: #2d5a9f;
      }
      .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .section-title {
        margin-right: 3px;
        font-weight: 600;
        color: #3c6dbc;
        font-size: 15px;
      }
      .button-group {
        display: flex;
        gap: 5px;
      }
      
      /* AG Grid     */
      .custom-ag-grid .ag-header,
      .custom-ag-grid .ag-header-row,
      .custom-ag-grid .ag-header-cell {
        background-color: rgb(206, 235, 255, 0.25) !important
        color: rgb(0, 96, 179) !important;
      }
      .ag-header-cell-text{
        font-size: 12px;
        color: #0e3979;
      }

      /*    */
      .custom-ag-grid .ag-icon-checkbox-checked,
      .custom-ag-grid .ag-icon-checkbox-unchecked,
      .custom-ag-grid .ag-icon-checkbox-indeterminate {
        color: rgb(0, 96, 179) !important;
      }
      .custom-ag-grid .ag-header-row.ag-header-row-column{
         background-color: rgb(206, 235, 255, 0.25) !important; 
      }
      .table > tbody > tr > td.td_input {
       padding: 3px !important;
      }
      
      /* ==========    ========== */
      .loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 9999;
      }
      
      .loading-spinner {
        width: 50px;
        height: 50px;
        border: 4px solid #f3f3f3;
        border-top: 4px solid #3c6dbc;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }
      
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      .loading-message {
        margin-top: 20px;
        color: white;
        font-size: 16px;
        font-weight: 500;
      }
      `}),o&&Z.jsxs("div",{className:"loading-overlay",children:[Z.jsx("div",{className:"loading-spinner"}),Z.jsx("div",{className:"loading-message",children:u})]}),Z.jsxs("div",{className:"min-h-screen bg-white",children:[Z.jsx("input",{ref:s,type:"file",accept:".xlsx,.xls",onChange:N,style:{display:"none"}}),Z.jsxs("div",{className:"box-header",style:{display:"flex",justifyContent:"flex-start",alignItems:"center"},children:[Z.jsx("h3",{className:"box-title",children:" "}),Z.jsx("button",{className:"btn-upload",style:{marginLeft:"auto"},onClick:j,children:""})]}),Z.jsxs("div",{className:"box-body",children:[Z.jsx("div",{className:"py-3",children:Z.jsxs("table",{className:"table table-bordered tbl_fixed",children:[Z.jsxs("colgroup",{children:[Z.jsx("col",{style:{width:"11%"}}),Z.jsx("col",{style:{width:"20%"}}),Z.jsx("col",{style:{width:"11%"}}),Z.jsx("col",{style:{width:"20%"}}),Z.jsx("col",{style:{width:"11%"}}),Z.jsx("col",{style:{width:"20%"}})]}),Z.jsxs("tbody",{children:[Z.jsxs("tr",{children:[Z.jsx("th",{scope:"row",className:"th_bg",children:"APC"}),Z.jsx("td",{className:"td_input",children:Z.jsx("input",{disabled:!0,style:{border:"1px solid #bbc4d1",height:"28px",width:"100%",padding:"4px 8px",cursor:"text",backgroundColor:"#eee",fontSize:"12px"},value:t})}),Z.jsx("th",{scope:"row",className:"th_bg",children:""}),Z.jsx("td",{className:"td_input",children:Z.jsx(bk,{settings:{locale:"ko",firstDayOfWeek:0},children:Z.jsx(am,{rightSection:Z.jsx(Nk,{size:18,stroke:1.5}),styles:{input:{borderRadius:0,fontSize:"12px",minHeight:"0",height:"28px"},root:{borderRadius:0}},valueFormat:"YYYY MM DD",clearable:!0,value:w,onChange:le=>{C(le?le.replace(/-/g,""):"")}})})}),Z.jsx("th",{scope:"row",className:"th_bg",children:""}),Z.jsx("td",{className:"td_input",children:Z.jsx(bk,{settings:{locale:"ko",firstDayOfWeek:0},children:Z.jsx(am,{rightSection:Z.jsx(Nk,{size:18,stroke:1.5}),styles:{input:{borderRadius:0,fontSize:"12px",minHeight:"0",height:"28px"},root:{borderRadius:0}},valueFormat:"YYYY MM DD",clearable:!0,value:b,onChange:le=>{x(le?le.replace(/-/g,""):"")}})})})]}),Z.jsxs("tr",{children:[Z.jsx("th",{scope:"row",className:"th_bg",children:""}),Z.jsx("td",{className:"td_input",children:Z.jsx(x0,{checkIconPosition:"right",placeholder:"",data:A,searchable:!0,clearable:!0,styles:{input:{borderRadius:0,fontSize:"12px",minHeight:"0",height:"28px"},dropdown:{borderRadius:"0"}},value:R,onChange:J})}),Z.jsx("th",{scope:"row",className:"th_bg",children:""}),Z.jsx("td",{className:"td_input",style:{borderRight:"none"},children:Z.jsx(x0,{checkIconPosition:"right",placeholder:"",data:O,searchable:!0,clearable:!0,styles:{input:{borderRadius:0,fontSize:"12px",minHeight:"0",height:"28px"},dropdown:{borderRadius:"0"}},value:M,onChange:F})})]})]})]})}),Z.jsxs("div",{className:"section-header",children:[Z.jsx("span",{className:"section-title",children:""}),Z.jsxs("div",{className:"button-group",children:[Z.jsx("button",{className:"btn-upload",onClick:P,children:""}),Z.jsx("button",{className:"btn-upload",onClick:fe,children:""}),Z.jsx("button",{className:"btn-save",onClick:V,children:""})]})]}),Z.jsx("div",{className:"py-3",children:Z.jsx("div",{className:"ag-theme-quartz custom-ag-grid",style:{height:500,width:"100%"},children:Z.jsx(cie,{theme:"legacy",rowData:n,columnDefs:_,defaultColDef:H,tooltipShowDelay:0,rowSelection:{mode:"multiRow",checkboxes:!0,headerCheckbox:!0,enableClickSelection:!1},animateRows:!0,localeText:{noRowsToShow:"  ."},onCellValueChanged:le=>{}})})}),n.length>0&&Z.jsxs("div",{style:{marginTop:"10px",fontSize:"13px",color:"#666"},children:[" ",Z.jsx("strong",{children:n.length}),""]})]})]})]})};h7.registerModules([ene]);const cCe={primaryColor:"blue",defaultRadius:"xl"},uCe=new XH,oB=document.getElementById("root"),dCe=oB.dataset.apcCd,hCe=oB.dataset.apcNm;EH.createRoot(document.getElementById("root")).render(Z.jsx(Oe.StrictMode,{children:Z.jsx(mP,{theme:cCe,children:Z.jsx(ZH,{client:uCe,children:Z.jsx(lCe,{apcCd:dCe,apcNm:hCe})})})}));
