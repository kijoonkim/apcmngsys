<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!-- ==========================================================================	-->
<!-- NAME : MdRtlFcltMapper.xml                                    				-->
<!-- DESC : APC 전수조사 대시보드 정보 mapper                                     -->
<!-- ==========================================================================	-->
<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
<!-- ===========  	============  	===========================================	-->
<!-- 2023.11.16  	김현호        	Initial Creation                            -->
<!-- ==========================================================================	-->

<mapper namespace="com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper">


	<!-- ==========================================================================	-->
	<!-- NAME :com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectMapSttn			-->
	<!-- DESC : APC현황조회.                     	 								-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<select id="selectMapSttn" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
		<![CDATA[
			SELECT pt0.CTPV_NM	/* com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectMapSttn */
			     , CASE WHEN pt0.CTPV_CD = '11'
			            THEN '11'
			            WHEN pt0.CTPV_CD = '26'
			            THEN '21'
			            WHEN pt0.CTPV_CD = '27'
			            THEN '22'
			            WHEN pt0.CTPV_CD = '28'
			            THEN '23'
			            WHEN pt0.CTPV_CD = '29'
			            THEN '24'
			            WHEN pt0.CTPV_CD = '30'
			            THEN '25'
			            WHEN pt0.CTPV_CD = '31'
			            THEN '26'
			            WHEN pt0.CTPV_CD = '36'
			            THEN '29'
			            WHEN pt0.CTPV_CD = '41'
			            THEN '31'
			            WHEN pt0.CTPV_CD = '43'
			            THEN '33'
			            WHEN pt0.CTPV_CD = '44'
			            THEN '34'
			            WHEN pt0.CTPV_CD = '45'
			            THEN '35'
			            WHEN pt0.CTPV_CD = '46'
			            THEN '36'
			            WHEN pt0.CTPV_CD = '47'
			            THEN '37'
			            WHEN pt0.CTPV_CD = '48'
			            THEN '38'
			            WHEN pt0.CTPV_CD = '50'
			            THEN '39'
			            WHEN pt0.CTPV_CD = '51'
			            THEN '32'
			        END AS CTPV_CD
			      , pt0.APC_QNTT
			  FROM (
			        SELECT CTPV_NM
			             , CTPV_CD
			             , COUNT(*) APC_QNTT
			          FROM TB_TE_APC_OPER_PRSN_OTLN
			         WHERE CTPV_CD IS NOT NULL
		]]>
		<if test='crtrYr != null and crtrYr != ""'>
					  AND CRTR_YR = #{crtrYr}
		</if>
		<![CDATA[
			        GROUP BY CTPV_CD, CTPV_NM
			        ) pt0
		]]>

	</select>
	<!-- ==========================================================================	-->
	<!-- NAME :com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectCtpvAreaList		-->
	<!-- DESC : APC지역목록조회.                     	 							-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<select id="selectCtpvAreaList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
		<![CDATA[
			SELECT /* com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectCtpvAreaLis */
				   AOO.CRTR_YR          AS CRTR_YR
			     , AOO.APC_CD           AS APC_CD
			     , AOO.APC_NM           AS APC_NM
			     , AOO.APC_BRNO         AS APC_BRNO
			     , AOO.OPER_OGNZ_CD     AS OPER_OGNZ_CD
			     , AOO.OPER_OGNZ_NM     AS OPER_OGNZ_NM
			     , AOO.OPER_OGNZ_BRNO   AS OPER_OGNZ_BRNO
			     , AOO.CTPV_CD          AS CTPV_CD
			     , AOO.CTPV_NM          AS CTPV_NM
			     , AOO.SIGUN_CD         AS SIGUN_CD
			     , AOO.SIGUN_NM         AS SIGUN_NM
			     , AOO.MB               AS MB
			     , AOO.OGNZ_TYPE_CD     AS OGNZ_TYPE_CD
			     , AOO.OGNZ_TYPE        AS OGNZ_TYPE
			     , AOO.TYPE_CD          AS TYPE_CD
			     , AOO.TYPE_NM          AS TYPE_NM
			     , AOO.OWNR             AS OWNR
			     , AOO.LOCTN            AS LOCTN
			     , AOO.RPRSV            AS RPRSV
			     , AOO.PIC              AS PIC
			     , AOO.PIC_JBPS         AS PIC_JBPS
			     , AOO.CTTPC            AS CTTPC
			     , AOO.EML              AS EML
			     , AOO.TOT_TRMT_AMT     AS TOT_TRMT_AMT
			     , AOO.GVRMNT_SPRT_YN   AS GVRMNT_SPRT_YN
			     , AOO.RMRK             AS RMRK

			  FROM TB_TE_APC_OPER_PRSN_OTLN AOO
		   	 WHERE 1=1
		]]>
		<if test='crtrYr != null and crtrYr != ""'>
			   AND AOO.CRTR_YR = #{crtrYr}
		</if>
		<if test='ctpvCd != null and ctpvCd != ""'>
			   AND AOO.CTPV_CD = #{ctpvCd}
		</if>
		<![CDATA[
			ORDER BY AOO.APC_NM
		]]>

	</select>

	<!-- ==========================================================================	-->
	<!-- NAME :com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectMdRtlOgnzGridList  -->
	<!-- DESC : 운영조직 취급실적 테이블 단건조회.                     	 		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectMdRtlOgnzGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT
				    '통합조직 운영 APC' AS TITLE
				  , '통합조직' AS SUB_TITLE
				  , '통합조직_승인형' AS S0 
			      , COUNT(1)    AS S1
			FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			WHERE   CRTR_YR         = '2023'
			AND     CTPV_CD IS NOT NULL
			AND     OGNZ_TYPE_CD    = '1'
			UNION ALL
			SELECT 
				    '통합조직 운영 APC' AS TITLE
				  , '통합조직' AS SUB_TITLE
				  , '통합조직_육성형' AS S0
			      ,COUNT(1)    AS S1
			FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			WHERE   CRTR_YR         = '2023'
			AND     CTPV_CD IS NOT NULL
			AND     OGNZ_TYPE_CD    = '2'
			UNION ALL
			SELECT 
			  		'통합조직 운영 APC' AS TITLE
				  ,'통합조직' AS SUB_TITLE
				  ,'소계(1)' AS S0
			      ,COUNT(1)    AS S1
			FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			WHERE   CRTR_YR         = '2023'
			AND     CTPV_CD IS NOT NULL
			AND     OGNZ_TYPE_CD  not  IN ('3','4','5') 
			UNION ALL
			SELECT  
					 '통합조직 운영 APC' AS TITLE
				  ,  '통합출자출하조직' AS SUB_TITLE
				  ,  '통합출자출하조직_승인형' AS S0
			      ,COUNT(1)    AS S1
			FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			WHERE   CRTR_YR         = '2023'
			AND     CTPV_CD IS NOT NULL
			AND     OGNZ_TYPE_CD    = '3'
			UNION ALL
			SELECT 
					'통합조직 운영 APC' AS TITLE
				  , '통합출자출하조직' AS SUB_TITLE
				  , '통합출자출하조직_육성형' AS S0
			      ,COUNT(1)    AS S1
			FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			WHERE   CRTR_YR         = '2023'
			AND     CTPV_CD IS NOT NULL
			AND     OGNZ_TYPE_CD    = '4'
			UNION ALL
			SELECT 
			  		'통합조직 운영 APC' AS TITLE
				  ,'통합출자출하조직' AS SUB_TITLE
				  ,'소계(2)' AS S0
			      ,COUNT(1)    AS S1
			FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			WHERE   CRTR_YR         = '2023'
			AND     CTPV_CD IS NOT NULL
			AND     OGNZ_TYPE_CD  not  IN ('1','2','5')
			UNION ALL
			SELECT 
			  		'통합조직 합계(1+2)' AS TITLE
				  ,'통합조직 합계(1+2)' AS SUB_TITLE
				  ,'통합조직 합계(1+2)' AS S0
			      ,COUNT(1)    AS S1
			FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			WHERE   CRTR_YR         = '2023'
			AND     CTPV_CD IS NOT NULL
			AND     OGNZ_TYPE_CD  not  IN ('5') 
			UNION ALL
			SELECT  
			  	   '개별조직 합계' AS TITLE
				  ,'개별조직 합계' AS SUB_TITLE
				  ,'개별조직 합계' AS S0
			      ,COUNT(1)    AS S1
			FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			WHERE   CRTR_YR         = '2023' 
			AND     CTPV_CD IS NOT NULL
			AND     OGNZ_TYPE_CD    IN ('5')
			UNION ALL
			SELECT  
			  	   '전체 합계' AS TITLE
				  ,'전체 합계' AS SUB_TITLE
				  ,'전체 합계' AS S0
			      ,COUNT(1)    AS S1
			FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			WHERE   CRTR_YR         = '2023' 
			AND     CTPV_CD IS NOT NULL
			AND     OGNZ_TYPE_CD    IN ('1','2','3','4','5')
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME :com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectOwnrAndOperGridList-->
	<!-- DESC : 개소수:소유자 및 운영자 테이블 단건조회.                     	 		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectOwnrAndOperGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0
			      , SUM(S1) AS S1
			      , SUM(S2) AS S2
			      , SUM(S3) AS S3
			      , SUM(S4) AS S4
			      , SUM(S5) AS S5
			FROM  ( SELECT '1통합조직운영 APC'                   AS S0
			              , CASE WHEN TYPE_CD = '1'   THEN 1 END AS S1
			              , CASE WHEN TYPE_CD = '2'   THEN 1 END AS S2
			              , CASE WHEN MB IS NOT NULL  THEN 1 END AS S3
			              , CASE WHEN MB IS NULL      THEN 1 END AS S4
			              , 1                                    AS S5
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			        WHERE   CRTR_YR = '2023'
			        AND     OGNZ_TYPE_CD NOT IN ('5')
			        AND     CTPV_CD IS NOT NULL
			        UNION ALL
			        SELECT '2개별조직운영 APC'                   AS S0
			              , CASE WHEN TYPE_CD = '1'   THEN 1 END AS S1
			              , CASE WHEN TYPE_CD = '2'   THEN 1 END AS S2
			              , CASE WHEN MB IS NOT NULL  THEN 1 END AS S3
			              , CASE WHEN MB IS NULL      THEN 1 END AS S4
			              , 1                                    AS S5
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			        WHERE   CRTR_YR = '2023'
			        AND     OGNZ_TYPE_CD IN ('5')
			        AND     CTPV_CD IS NOT NULL)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectAllBdarGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - 총 건춘면적 테이블 단건조회.             		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectAllBdarGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , ROUND(SUM(S1),0)            AS V1
			      , ROUND(SUM(S1) / SUM(A1),0)  AS V2
			      , ROUND(SUM(S2),0)            AS V3
			      , ROUND(SUM(S2) / SUM(A2),0)  AS V4
			      , ROUND(SUM(S3),0)            AS V5
			      , ROUND(SUM(S3) / SUM(A3),0)  AS V6
			FROM  ( SELECT '1통합조직운영 APC'                                                 AS S0
			              , CASE WHEN A.MB IS NOT NULL  THEN
			                     NVL(B.CSP_TOT_AREA,0) + NVL(B.STRG_PLC_PRC_PLC_AREA,0) + NVL(B.STRG_PLC_LWTP_STRG_AREA,0) + NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) +
			                     NVL(B.STRG_PLC_CURN_AREA,0) + NVL(B.STRG_PLC_GNRL_STRG_AREA,0) + NVL(B.STRG_PLC_ETC_AREA,0) END AS S1
			              , CASE WHEN A.MB IS NOT NULL  THEN 1 END AS A1
			              , CASE WHEN A.MB IS NULL      THEN
			                     NVL(B.CSP_TOT_AREA,0) + NVL(B.STRG_PLC_PRC_PLC_AREA,0) + NVL(B.STRG_PLC_LWTP_STRG_AREA,0) + NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) +
			                     NVL(B.STRG_PLC_CURN_AREA,0) + NVL(B.STRG_PLC_GNRL_STRG_AREA,0) + NVL(B.STRG_PLC_ETC_AREA,0) END AS S2
			              , CASE WHEN A.MB IS NULL      THEN 1 END AS A2
			              , NVL(B.CSP_TOT_AREA,0) + NVL(B.STRG_PLC_PRC_PLC_AREA,0) + NVL(B.STRG_PLC_LWTP_STRG_AREA,0) + NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) +
			                NVL(B.STRG_PLC_CURN_AREA,0) + NVL(B.STRG_PLC_GNRL_STRG_AREA,0) + NVL(B.STRG_PLC_ETC_AREA,0) AS S3
			              , 1  AS A3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '2개별조직운영 APC' AS S0
			              , CASE WHEN A.MB IS NOT NULL  THEN
			                     NVL(B.CSP_TOT_AREA,0) + NVL(B.STRG_PLC_PRC_PLC_AREA,0) + NVL(B.STRG_PLC_LWTP_STRG_AREA,0) + NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) +
			                     NVL(B.STRG_PLC_CURN_AREA,0) + NVL(B.STRG_PLC_GNRL_STRG_AREA,0) + NVL(B.STRG_PLC_ETC_AREA,0) END AS S1
			              , CASE WHEN A.MB IS NOT NULL  THEN 1 END AS A1
			              , CASE WHEN A.MB IS NULL      THEN
			                     NVL(B.CSP_TOT_AREA,0) + NVL(B.STRG_PLC_PRC_PLC_AREA,0) + NVL(B.STRG_PLC_LWTP_STRG_AREA,0) + NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) +
			                     NVL(B.STRG_PLC_CURN_AREA,0) + NVL(B.STRG_PLC_GNRL_STRG_AREA,0) + NVL(B.STRG_PLC_ETC_AREA,0) END AS S2
			              , CASE WHEN A.MB IS NULL      THEN 1 END AS A2
			              , NVL(B.CSP_TOT_AREA,0) + NVL(B.STRG_PLC_PRC_PLC_AREA,0) + NVL(B.STRG_PLC_LWTP_STRG_AREA,0) + NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) +
			                     NVL(B.STRG_PLC_CURN_AREA,0) + NVL(B.STRG_PLC_GNRL_STRG_AREA,0) + NVL(B.STRG_PLC_ETC_AREA,0) AS S3
			              , 1  AS A3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD = B.APC_CD)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectLgstcsGdsGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - 물류:상품화시설(건축면적) 테이블 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectLgstcsGdsGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , ROUND(SUM(S1),0)            AS V1
			      , ROUND(SUM(S1) / SUM(A1),0)  AS V2
			      , ROUND(SUM(S2),0)            AS V3
			      , ROUND(SUM(S2) / SUM(A2),0)  AS V4
			      , ROUND(SUM(S3),0)            AS V5
			      , ROUND(SUM(S3) / SUM(A3),0)  AS V6
			FROM  ( SELECT '1통합조직운영 APC' AS S0
			              , CASE WHEN A.MB IS NOT NULL THEN NVL(B.CSP_TOT_AREA,0) END AS S1
			              , CASE WHEN A.MB IS NOT NULL THEN 1 END AS A1
			              , CASE WHEN A.MB IS NULL     THEN NVL(B.CSP_TOT_AREA,0) END AS S2
			              , CASE WHEN A.MB IS NULL     THEN 1 END AS A2
			              , NVL(B.CSP_TOT_AREA,0) AS S3
			              , 1 AS A3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD    =  B.APC_CD
			        UNION ALL
			        SELECT '2개별조직운영 APC' AS S0
			              , CASE WHEN A.MB IS NOT NULL THEN NVL(B.CSP_TOT_AREA,0) END AS S1
			              , CASE WHEN A.MB IS NOT NULL THEN 1 END AS A1
			              , CASE WHEN A.MB IS NULL     THEN NVL(B.CSP_TOT_AREA,0) END AS S2
			              , CASE WHEN A.MB IS NULL     THEN 1 END AS A2
			              , NVL(B.CSP_TOT_AREA,0) AS S3
			              , 1 AS A3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD    =  B.APC_CD)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectLwtpStrgGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - 저온냉장고 테이블 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectLwtpStrgGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , SUM(S1)                     AS V1
			      , SUM(S2)                     AS V2
			      , ROUND(SUM(S3),0)            AS V3
			      , ROUND(SUM(S3) / SUM(S2),0)  AS V4
			FROM  ( SELECT '1통합조직운영 APC'                                                  AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) > 0 THEN 1 END           AS S2
			              , CASE WHEN A.MB IS NULL THEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) END    AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD    =  B.APC_CD
			        UNION ALL
			        SELECT '2개별조직운영 APC'                                          AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) > 0 THEN 1 END           AS S2
			              , CASE WHEN A.MB IS NULL THEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) END    AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD    =  B.APC_CD)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectPrprtnClngFcltGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - 저온냉장고 테이블 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectPrprtnClngFcltGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , SUM(S1)                     AS V1
			      , SUM(S2)                     AS V2
			      , ROUND(SUM(S3),0)            AS V3
			      , ROUND(SUM(S3) / SUM(S2),0)  AS V4
			FROM  ( SELECT '1통합조직운영 APC'                                              AS S0
			              , 1                                                               AS S1
			              , CASE WHEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) > 0 THEN 1 END         AS S2
			              , CASE WHEN A.MB IS NULL THEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) END  AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD    =  B.APC_CD
			        UNION ALL
			        SELECT '2개별조직운영 APC'                                          AS S0
			              , 1                                                               AS S1
			              , CASE WHEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) > 0 THEN 1 END         AS S2
			              , CASE WHEN A.MB IS NULL THEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) END  AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD    =  B.APC_CD)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectStrgFcltGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - CA저장시설 테이블 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectStrgFcltGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , SUM(S1)                     AS V1
			      , SUM(S2)                     AS V2
			      , ROUND(SUM(S3),0)            AS V3
			      , ROUND(SUM(S3) / SUM(S2),0)  AS V4
			FROM  ( SELECT '1통합조직운영 APC'                                                  AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) > 0 THEN 1 END         AS S2
			              , CASE WHEN A.MB IS NULL THEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) END  AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD =  B.APC_CD
			        UNION ALL
			        SELECT '2개별조직운영 APC'                                          AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) > 0 THEN 1 END         AS S2
			              , CASE WHEN A.MB IS NULL THEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) END  AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD =  B.APC_CD)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectFcltMsrmtEqpmntGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - 측정장비설치 개소수 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectFcltMsrmtEqpmntGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , SUM(S1)                     AS V1
			      , SUM(S2)                     AS V2
			      , SUM(S3)                     AS V3
			      , SUM(S4)                     AS V4
			      , SUM(S5)                     AS V5
			FROM  ( SELECT '1통합조직운영 APC'                                          AS S0
			              , 1                                                           AS S1
			              , CASE WHEN B.SORT_MCHN_SPCFCT IS NOT NULL THEN 1 END         AS S2
			              , CASE WHEN B.SORT_BRCK_MCHN   = 'Y'       THEN 1 END         AS S3
			              , CASE WHEN B.COLOR_SORT       = 'Y'       THEN 1 END         AS S4
			              , CASE WHEN B.MNFC_MCHN        IS NOT NULL THEN 1 END         AS S5

			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , MAX(SORT_MCHN_SPCFCT) AS SORT_MCHN_SPCFCT
			                      , MAX(SORT_BRCK_MCHN) AS SORT_BRCK_MCHN
			                      , MAX(COLOR_SORT) AS COLOR_SORT
			                      , MAX(MNFC_MCHN) AS MNFC_MCHN
			                FROM    USRAM.TB_TE_APC_FCLT_STTS_DTL
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        UNION ALL
			        SELECT '2개별조직운영 APC'                                          AS S0
			              , 1                                                           AS S1
			              , CASE WHEN B.SORT_MCHN_SPCFCT IS NOT NULL THEN 1 END         AS S2
			              , CASE WHEN B.SORT_BRCK_MCHN   = 'Y'       THEN 1 END         AS S3
			              , CASE WHEN B.COLOR_SORT       = 'Y'       THEN 1 END         AS S4
			              , CASE WHEN B.MNFC_MCHN        IS NOT NULL THEN 1 END         AS S5
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , MAX(SORT_MCHN_SPCFCT) AS SORT_MCHN_SPCFCT
			                      , MAX(SORT_BRCK_MCHN) AS SORT_BRCK_MCHN
			                      , MAX(COLOR_SORT) AS COLOR_SORT
			                      , MAX(MNFC_MCHN) AS MNFC_MCHN
			                FROM    USRAM.TB_TE_APC_FCLT_STTS_DTL
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD  =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectInvstAtmAllGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - 투자금액: 전체 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectInvstAtmAllGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                                          AS V0
			      , SUM(S1)                                     AS V1
			      , ROUND(SUM(S2)/1000000,0)                    AS V2
			      , ROUND((SUM(S2)/SUM(S1))/1000000,0)          AS V3

			FROM  ( SELECT '1통합조직운영 APC'                  AS S0
			              , 1                                   AS S1
			              , B.NE + B.LCLT_EXPND + B.SLF_BRDN    AS S2
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        UNION ALL
			        SELECT '2개별조직운영 APC'                  AS S0
			              , 1                                   AS S1
			              , B.NE + B.LCLT_EXPND + B.SLF_BRDN    AS S2
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectInvstAtmFundTypeGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - 투자금액: 자금유형 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectInvstAtmFundTypeGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                                  AS V0
			      , ROUND(SUM(S1)/1000000,0)            AS V1
			      , ROUND(SUM(S2)/1000000,0)            AS V2
			      , ROUND(SUM(S3)/1000000,0)            AS V3
			      , ROUND(SUM(S4)/1000000,0)            AS V4

			FROM  ( SELECT '1통합조직운영 APC'                  AS S0
			              , B.NE                                AS S1
			              , B.LCLT_EXPND                        AS S2
			              , B.SLF_BRDN                          AS S3
			              , B.NE + B.LCLT_EXPND + B.SLF_BRDN    AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        UNION ALL
			        SELECT '2개별조직운영 APC'                  AS S0
			              , B.NE                                AS S1
			              , B.LCLT_EXPND                        AS S2
			              , B.SLF_BRDN                          AS S3
			              , B.NE + B.LCLT_EXPND + B.SLF_BRDN    AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectInvstAtmOwnrGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - 투자금액: 소유자 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectInvstAtmOwnrGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                                  AS V0
			      , SUM(S1)                             AS V1
			      , ROUND(SUM(S2)/1000000,0)            AS V2
			      , ROUND((SUM(S2)/SUM(S1))/1000000,0)  AS V3
			      , SUM(S3)                             AS V4
			      , ROUND(SUM(S4)/1000000,0)            AS V5
			      , ROUND((SUM(S4)/SUM(S3))/1000000,0)  AS V6

			FROM  ( SELECT '1통합조직운영 APC'                        AS S0
			              , CASE WHEN A.TYPE_CD = '1' THEN 1 END      AS S1
			              , CASE WHEN A.TYPE_CD = '1' THEN B.AMT END  AS S2
			              , CASE WHEN A.TYPE_CD = '2' THEN 1 END      AS S3
			              , CASE WHEN A.TYPE_CD = '2' THEN B.AMT END  AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE+LCLT_EXPND+SLF_BRDN) AS AMT
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        UNION ALL
			        SELECT '2개별조직운영 APC'                  AS S0
			              , CASE WHEN A.TYPE_CD = '1' THEN 1 END      AS S1
			              , CASE WHEN A.TYPE_CD = '1' THEN B.AMT END  AS S2
			              , CASE WHEN A.TYPE_CD = '2' THEN 1 END      AS S3
			              , CASE WHEN A.TYPE_CD = '2' THEN B.AMT END  AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE+LCLT_EXPND+SLF_BRDN) AS AMT
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectInvstAtmOperPrsnGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - 투자금액: 소유자 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectInvstAtmOperPrsnGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                                  AS V0
			      , SUM(S1)                             AS V1
			      , ROUND(SUM(S2)/1000000,0)            AS V2
			      , ROUND((SUM(S2)/SUM(S1))/1000000,0)  AS V3
			      , SUM(S3)                             AS V4
			      , ROUND(SUM(S4)/1000000,0)            AS V5
			      , ROUND((SUM(S4)/SUM(S3))/1000000,0)  AS V6

			FROM  ( SELECT '1통합조직운영 APC'                          AS S0
			              , CASE WHEN A.MB IS NOT NULL THEN 1 END       AS S1
			              , CASE WHEN A.MB IS NOT NULL THEN B.AMT END   AS S2
			              , CASE WHEN A.MB IS NULL THEN 1 END           AS S3
			              , CASE WHEN A.MB IS NULL THEN B.AMT END       AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE+LCLT_EXPND+SLF_BRDN) AS AMT
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        UNION ALL
			        SELECT '2개별조직운영 APC'                  AS S0
			              , CASE WHEN A.MB IS NOT NULL THEN 1 END       AS S1
			              , CASE WHEN A.MB IS NOT NULL THEN B.AMT END   AS S2
			              , CASE WHEN A.MB IS NULL THEN 1 END           AS S3
			              , CASE WHEN A.MB IS NULL THEN B.AMT END       AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE+LCLT_EXPND+SLF_BRDN) AS AMT
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectMdRtlOgnzTypeGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - 지역별 개소수 : 산지유통조직 유형 단건조회.	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectMdRtlOgnzTypeGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0          AS V0
			      , SUM(S1)     AS V1
			      , SUM(S2)     AS V2
			      , SUM(S3)     AS V3
			      , SUM(S4)     AS V4
			      , SUM(S5)     AS V5
			      , SUM(S6)     AS V6
			      , SUM(S7)     AS V7
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','경기도','광주시','전남도','대구시','경북도','부산시','경남도','세종시','충남도','울산시','경남도', A.CTPV_NM)  AS S0
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND A.TYPE_CD = '1' THEN 1 END    AS S1
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND A.TYPE_CD = '2' THEN 1 END    AS S2
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND A.TYPE_CD = '1' THEN 1 END        AS S3
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND A.TYPE_CD = '2' THEN 1 END        AS S4
			              , CASE WHEN A.TYPE_CD = '1' THEN 1 END                                    AS S5
			              , CASE WHEN A.TYPE_CD = '2' THEN 1 END                                    AS S6
			              , 1                                                                       AS S7
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.CTPV_CD IS NOT NULL)
			GROUP BY S0
		]]>
	</select>
	
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectRgnOperPrsnGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - 지역별 개소수 : 운영자 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectRgnOperPrsnGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0          AS V0
			      , SUM(S1)     AS V1
			      , SUM(S2)     AS V2
			      , SUM(S3)     AS V3
			      , SUM(S4)     AS V4
			      , SUM(S5)     AS V5
			      , SUM(S6)     AS V6
			      , SUM(S7)     AS V7
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','경기도','광주시','전남도','대구시','경북도','부산시','경남도','세종시','충남도','울산시','경남도', A.CTPV_NM) AS S0
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND A.MB IS NOT NULL THEN 1 END   AS S1
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND A.MB IS NULL THEN 1 END       AS S2
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND A.MB IS NOT NULL THEN 1 END       AS S3
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND A.MB IS NULL THEN 1 END           AS S4
			              , CASE WHEN A.MB IS NOT NULL THEN 1 END                                   AS S5
			              , CASE WHEN A.MB IS NULL THEN 1 END                                       AS S6
			              , 1                                                                       AS S7
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.CTPV_CD IS NOT NULL)
			GROUP BY S0;      
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectLgstcsGdsFcltGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - 산지우통시설 시설·장비 : 물류·상품화 시설 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectLgstcsGdsFcltGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                                  AS V0
			      , NVL(ROUND(SUM(S1),0),0)             AS V1
			      , NVL(ROUND(SUM(S1)/SUM(S2),0),0)     AS V2
			      , NVL(ROUND(SUM(S3),0),0)             AS V3
			      , NVL(ROUND(SUM(S3)/SUM(S4),0),0)     AS V4
			      , NVL(ROUND(SUM(S5),0),0)             AS V5
			      , NVL(ROUND(SUM(S5)/SUM(S6),0),0)     AS V6
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','경기도','광주시','전남도','대구시','경북도','부산시','경남도','세종시','충남도','울산시','경남도', A.CTPV_NM) AS S0
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN 
			                     NVL(B.CSP_TOT_AREA,0) +
			                     NVL(B.STRG_PLC_PRC_PLC_AREA,0) +    
			                     NVL(B.STRG_PLC_LWTP_STRG_AREA,0) +  
			                     NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) +
			                     NVL(B.STRG_PLC_CURN_AREA,0) +       
			                     NVL(B.STRG_PLC_GNRL_STRG_AREA,0) +  
			                     NVL(B.STRG_PLC_ETC_AREA,0) END                     AS S1
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN 1 END        AS S2
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN 
			                     NVL(B.CSP_TOT_AREA,0) +
			                     NVL(B.STRG_PLC_PRC_PLC_AREA,0) +    
			                     NVL(B.STRG_PLC_LWTP_STRG_AREA,0) +  
			                     NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) +
			                     NVL(B.STRG_PLC_CURN_AREA,0) +       
			                     NVL(B.STRG_PLC_GNRL_STRG_AREA,0) +  
			                     NVL(B.STRG_PLC_ETC_AREA,0) END                     AS S3
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN 1 END            AS S4
			              , NVL(B.CSP_TOT_AREA,0) +
			                NVL(B.STRG_PLC_PRC_PLC_AREA,0) +    
			                NVL(B.STRG_PLC_LWTP_STRG_AREA,0) +  
			                NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) +
			                NVL(B.STRG_PLC_CURN_AREA,0) +       
			                NVL(B.STRG_PLC_GNRL_STRG_AREA,0) +  
			                NVL(B.STRG_PLC_ETC_AREA,0)                              AS S5
			              , 1                                                       AS S6
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.CTPV_CD   IS NOT NULL
			        AND     A.APC_CD    =  B.APC_CD(+))
			GROUP BY S0
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectLgstcsGdsFcltGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - 저온저장고 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectMdLwtpStrgGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                                 AS V0
			      , NVL(ROUND(SUM(S1),0),0)            AS V1
			      , NVL(ROUND(SUM(S2),0),0)            AS V2
			      , NVL(ROUND(SUM(S3),0),0)            AS V3
			      , NVL(ROUND(SUM(S3)/SUM(S2),0),0)    AS V4
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','경기도','광주시','전남도','대구시','경북도','부산시','경남도','세종시','충남도','울산시','경남도', A.CTPV_NM) AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) > 0 THEN 1 ELSE 0 END    AS S2
			              , CASE WHEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) > 0 THEN 
			                     NVL(B.STRG_PLC_LWTP_STRG_AREA,0) END                           AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.CTPV_CD   IS NOT NULL
			        AND     A.APC_CD    =  B.APC_CD(+))
			GROUP BY S0
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectRgnPrprtnClngFcltGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - 예냉시설 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectRgnPrprtnClngFcltGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                                 AS V0
			      , NVL(ROUND(SUM(S1),0),0)            AS V1
			      , NVL(ROUND(SUM(S2),0),0)            AS V2
			      , NVL(ROUND(SUM(S3),0),0)            AS V3
			      , NVL(ROUND(SUM(S3)/SUM(S2),0),0)    AS V4
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','경기도','광주시','전남도','대구시','경북도','부산시','경남도','세종시','충남도','울산시','경남도', A.CTPV_NM) AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) > 0 THEN 1 ELSE 0 END      AS S2
			              , CASE WHEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) > 0 THEN 
			                     NVL(B.STRG_PLC_PRC_PLC_AREA,0) END                             AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.CTPV_CD   IS NOT NULL
			        AND     A.APC_CD    =  B.APC_CD(+))
			GROUP BY S0
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectRgnStrgFcltGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - CA저장고 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectRgnStrgFcltGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                              AS V0
			      , NVL(ROUND(SUM(S1),0),0)         AS V1
			      , NVL(ROUND(SUM(S2),0),0)         AS V2
			      , NVL(ROUND(SUM(S3),0),0)         AS V3
			      , NVL(ROUND(SUM(S3)/SUM(S2),0),0) AS V4
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','경기도','광주시','전남도','대구시','경북도','부산시','경남도','세종시','충남도','울산시','경남도', A.CTPV_NM) AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) > 0 THEN 1 ELSE 0 END  AS S2
			              , CASE WHEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) > 0 THEN 
			                     NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) END                         AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.CTPV_CD   IS NOT NULL
			        AND     A.APC_CD    =  B.APC_CD(+))
			GROUP BY S0
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectRgnFcltMsrmtEqpmntGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - 선별기·측정장비 설치 개소 수 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectRgnFcltMsrmtEqpmntGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                                 AS V0
			      , NVL(ROUND(SUM(S1),0),0)            AS V1
			      , NVL(ROUND(SUM(S2),0),0)            AS V2
			      , NVL(ROUND(SUM(S3),0),0)            AS V3
			      , NVL(ROUND(SUM(S3)/SUM(S2),0),0)    AS V4
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','경기도','광주시','전남도','대구시','경북도','부산시','경남도','세종시','충남도','울산시','경남도', A.CTPV_NM) AS S0
			              , 1                                                           AS S1
			              , CASE WHEN B.SORT_MCHN_SPCFCT IS NOT NULL THEN 1 END         AS S2
			              , CASE WHEN B.SORT_BRCK_MCHN = 'Y'         THEN 1 END         AS S3
			              , CASE WHEN B.COLOR_SORT = 'Y'             THEN 1 END         AS S4
			              , CASE WHEN B.MNFC_MCHN IS NOT NULL        THEN 1 END         AS S5
			              
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			               (SELECT  APC_CD
			                      , MAX(SORT_MCHN_SPCFCT) AS SORT_MCHN_SPCFCT
			                      , MAX(SORT_BRCK_MCHN) AS SORT_BRCK_MCHN
			                      , MAX(COLOR_SORT) AS COLOR_SORT
			                      , MAX(MNFC_MCHN) AS MNFC_MCHN
			                FROM    USRAM.TB_TE_APC_FCLT_STTS_DTL
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.CTPV_CD   IS NOT NULL
			        AND     A.APC_CD    =  B.APC_CD(+))
			GROUP BY S0
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectRgnInvstAtmAllGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - 지역별 투자금액 전체 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectRgnInvstAtmAllGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                                          AS V0
			      , NVL(SUM(S1),0)                              AS V1
			      , NVL(ROUND(SUM(S2)/1000000,0),0)             AS V2
			      , NVL(ROUND(SUM(S3)/1000000,0),0)             AS V3
			      , NVL(ROUND(SUM(S4)/1000000,0),0)             AS V4
			      , NVL(ROUND(SUM(S5)/1000000,0),0)             AS V5
			      , NVL(ROUND((SUM(S5)/SUM(S1))/1000000,0),0)   AS V6
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','경기도','광주시','전남도','대구시','경북도','부산시','경남도','세종시','충남도','울산시','경남도', A.CTPV_NM) AS S0
			              , 1                               AS S1
			              , B.NE                            AS S2
			              , B.LCLT_EXPND                    AS S3
			              , B.SLF_BRDN                      AS S4
			              , B.NE+B.LCLT_EXPND+B.SLF_BRDN    AS S5
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			               (SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.CTPV_CD   IS NOT NULL
			        AND     A.APC_CD    =  B.APC_CD(+))
			GROUP BY S0
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectRgnInvstAtmOwnrGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - 지역별 투자금액 소유자 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectRgnInvstAtmOwnrGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                                          AS V0
			      , NVL(SUM(S1),0)                              AS V1
			      , NVL(ROUND(SUM(S2)/1000000,0),0)             AS V2
			      , CASE WHEN SUM(S1) > 0 THEN NVL(ROUND((SUM(S2)/SUM(S1))/1000000,0),0)   
			             ELSE 0 END                             AS V3
			      , NVL(SUM(S3),0)                              AS V4
			      , NVL(ROUND(SUM(S4)/1000000,0),0)             AS V5
			      , CASE WHEN SUM(S3) > 0 THEN NVL(ROUND((SUM(S4)/SUM(S3))/1000000,0),0) 
			             ELSE 0 END                             AS V6
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','경기도','광주시','전남도','대구시','경북도','부산시','경남도','세종시','충남도','울산시','경남도', A.CTPV_NM) AS S0
			              , CASE WHEN A.TYPE_CD = '1' THEN 1 ELSE 0 END                                 AS S1
			              , CASE WHEN A.TYPE_CD = '1' THEN B.NE + B.LCLT_EXPND + B.SLF_BRDN ELSE 0 END  AS S2
			              , CASE WHEN A.TYPE_CD = '2' THEN 1 ELSE 0 END                                 AS S3
			              , CASE WHEN A.TYPE_CD = '2' THEN B.NE + B.LCLT_EXPND + B.SLF_BRDN ELSE 0 END  AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			               (SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.CTPV_CD   IS NOT NULL
			        AND     A.APC_CD    =  B.APC_CD(+)
			      )
			GROUP BY S0
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectRgnInvstOperPrsnGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - 지역별 투자금액 운영자 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectRgnInvstOperPrsnGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                                          AS V0
			      , NVL(SUM(S1),0)                              AS V1
			      , NVL(ROUND(SUM(S2)/1000000,0),0)             AS V2
			      , CASE WHEN SUM(S1) > 0 THEN NVL(ROUND((SUM(S2)/SUM(S1))/1000000,0),0)   
			             ELSE 0 END                             AS V3
			      , NVL(SUM(S3),0)                              AS V4
			      , NVL(ROUND(SUM(S4)/1000000,0),0)             AS V5
			      , CASE WHEN SUM(S3) > 0 THEN NVL(ROUND((SUM(S4)/SUM(S3))/1000000,0),0) 
			             ELSE 0 END                             AS V6
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','경기도','광주시','전남도','대구시','경북도','부산시','경남도','세종시','충남도','울산시','경남도', A.CTPV_NM) AS S0
			              , CASE WHEN A.MB IS NOT NULL THEN 1 ELSE 0 END                                AS S1
			              , CASE WHEN A.MB IS NOT NULL THEN B.NE + B.LCLT_EXPND + B.SLF_BRDN ELSE 0 END AS S2
			              , CASE WHEN A.MB IS NULL THEN 1 ELSE 0 END                                    AS S3
			              , CASE WHEN A.MB IS NULL THEN B.NE + B.LCLT_EXPND + B.SLF_BRDN ELSE 0 END     AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			               (SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.CTPV_CD   IS NOT NULL
			        AND     A.APC_CD    =  B.APC_CD(+)
			      )
			GROUP BY S0
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectBzeatCntMdRtlOgnzTypeGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 -개소수: 개소수:산지유통조직 유형 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntMdRtlOgnzTypeGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT '통합조직 운영 APC' AS TITLE,
			        '통합조직' AS SUB_TITLE,
			        '통합조직_승인형' AS S0,
			        COUNT(1) AS S1 -- 통합조직_승인형
			   FROM USRAM.TB_TE_APC_OPER_PRSN_OTLN
			  WHERE CRTR_YR = '2023'
			    AND OGNZ_TYPE_CD = '1'
			    AND GVRMNT_SPRT_YN = 'Y'
			    AND CTPV_CD IS NOT NULL
			  UNION ALL
			 SELECT '통합조직 운영 APC' AS TITLE,
			        '통합조직' AS SUB_TITLE,
			        '통합조직_육성형' AS S0,
			        COUNT(1) AS S1 -- 통합조직_육성형
			   FROM USRAM.TB_TE_APC_OPER_PRSN_OTLN
			  WHERE CRTR_YR = '2023'
			    AND OGNZ_TYPE_CD = '2'
			    AND GVRMNT_SPRT_YN = 'Y'
			    AND CTPV_CD IS NOT NULL
			  UNION ALL
			 SELECT '통합조직 운영 APC' AS TITLE,
			        '통합조직' AS SUB_TITLE,
			        '소계(1)' AS S0,
			        COUNT(1) AS S1
			   FROM USRAM.TB_TE_APC_OPER_PRSN_OTLN
			  WHERE CRTR_YR = '2023'
			    AND OGNZ_TYPE_CD IN ('1','2')
			    AND GVRMNT_SPRT_YN = 'Y'
			    AND CTPV_CD IS NOT NULL
			  UNION ALL
			 SELECT '통합조직 운영 APC' AS TITLE,
			        '통합출자출하조직' AS SUB_TITLE,
			        '통합출자출하조직_승인형' AS S0,
			        COUNT(1) AS S1 -- 통합출자출하조직_승인형
			   FROM USRAM.TB_TE_APC_OPER_PRSN_OTLN
			  WHERE CRTR_YR = '2023'
			    AND OGNZ_TYPE_CD = '3'
			    AND GVRMNT_SPRT_YN = 'Y'
			    AND CTPV_CD IS NOT NULL
			  UNION ALL
			 SELECT '통합조직 운영 APC' AS TITLE,
			        '통합출자출하조직' AS SUB_TITLE,
			        '통합출자출하조직_육성형' AS S0,
			        COUNT(1) AS S1 -- 통합출자출하조직_육성형
			   FROM USRAM.TB_TE_APC_OPER_PRSN_OTLN
			  WHERE CRTR_YR = '2023'
			    AND OGNZ_TYPE_CD = '4'
			    AND GVRMNT_SPRT_YN = 'Y'
			    AND CTPV_CD IS NOT NULL
			  UNION ALL
			   SELECT '통합조직 운영 APC' AS TITLE,
			        '통합출자출하조직' AS SUB_TITLE,
			        '소계(2)' AS S0,
			        COUNT(1) AS S1 -- 통합조직_육성형
			   FROM USRAM.TB_TE_APC_OPER_PRSN_OTLN
			  WHERE CRTR_YR = '2023'
			    AND OGNZ_TYPE_CD IN ('3','4')
			    AND GVRMNT_SPRT_YN = 'Y'
			    AND CTPV_CD IS NOT NULL
			  UNION ALL
			 SELECT '통합조직 합계' AS TITLE,
			        '통합조직 합계' AS SUB_TITLE,
			        '통합조직 합계' AS S0,
			        COUNT(1) AS S1 -- 통합조직 합계
			   FROM USRAM.TB_TE_APC_OPER_PRSN_OTLN
			  WHERE CRTR_YR = '2023'
			    AND OGNZ_TYPE_CD IN('1',
			        '2',
			        '3',
			        '4')
			    AND GVRMNT_SPRT_YN = 'Y'
			    AND CTPV_CD IS NOT NULL
			  UNION ALL
			 SELECT '개별조직 합계' AS TITLE,
			        '개별조직 합계' AS SUB_TITLE,
			        '개별조직 합계' AS S0,
			        COUNT(1) AS S1 -- 개별조직 합계
			   FROM USRAM.TB_TE_APC_OPER_PRSN_OTLN
			  WHERE CRTR_YR = '2023'
			    AND OGNZ_TYPE_CD = '5'
			    AND GVRMNT_SPRT_YN = 'Y'
			    AND CTPV_CD IS NOT NULL
			  UNION ALL
			 SELECT '전체 합계' AS TITLE,
			        '전체 합계' AS SUB_TITLE,
			        '전체 합계' AS S0,
			        COUNT(1) AS S1 -- 전체 합계
			   FROM USRAM.TB_TE_APC_OPER_PRSN_OTLN
			  WHERE CRTR_YR = '2023'
			    AND GVRMNT_SPRT_YN = 'Y'
			    AND CTPV_CD IS NOT NULL;
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectBzeatCntOwnrAndOperGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 -개소수: 개소수:소유자 및 운영자 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntOwnrAndOperGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0
			      , SUM(S1) AS S1
			      , SUM(S2) AS S2
			      , SUM(S3) AS S3
			      , SUM(S4) AS S4
			      , SUM(S5) AS S5
			FROM  ( SELECT '1통합조직운영 APC'                   AS S0
			              , CASE WHEN TYPE_CD = '1'   THEN 1 END AS S1
			              , CASE WHEN TYPE_CD = '2'   THEN 1 END AS S2
			              , CASE WHEN MB IS NOT NULL  THEN 1 END AS S3
			              , CASE WHEN MB IS NULL      THEN 1 END AS S4
			              , 1                                    AS S5
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			        WHERE   CRTR_YR = '2023'
			        AND     GVRMNT_SPRT_YN = 'Y'
			        AND     OGNZ_TYPE_CD NOT IN ('5')
			        AND     CTPV_CD IS NOT NULL
			        UNION ALL
			        SELECT '2개별조직운영 APC'                   AS S0
			              , CASE WHEN TYPE_CD = '1'   THEN 1 END AS S1
			              , CASE WHEN TYPE_CD = '2'   THEN 1 END AS S2
			              , CASE WHEN MB IS NOT NULL  THEN 1 END AS S3
			              , CASE WHEN MB IS NULL      THEN 1 END AS S4
			              , 1                                    AS S5
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			        WHERE   CRTR_YR = '2023'
			        AND     GVRMNT_SPRT_YN = 'Y'
			        AND     OGNZ_TYPE_CD IN ('5')
			        AND     CTPV_CD IS NOT NULL)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectFcltEqpmntAllBdarGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - 총 건축면적 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectFcltEqpmntAllBdarGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , ROUND(SUM(S1),0)            AS V1
			      , ROUND(SUM(S1) / SUM(A1),0)  AS V2
			      , ROUND(SUM(S2),0)            AS V3
			      , ROUND(SUM(S2) / SUM(A2),0)  AS V4
			      , ROUND(SUM(S3),0)            AS V5
			      , ROUND(SUM(S3) / SUM(A3),0)  AS V6
			FROM  ( SELECT '1통합조직운영 APC'                                                 AS S0
			              , CASE WHEN A.MB IS NOT NULL  THEN 
			                     NVL(B.CSP_TOT_AREA,0) + NVL(B.STRG_PLC_PRC_PLC_AREA,0) + NVL(B.STRG_PLC_LWTP_STRG_AREA,0) + NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) +
			                     NVL(B.STRG_PLC_CURN_AREA,0) + NVL(B.STRG_PLC_GNRL_STRG_AREA,0) + NVL(B.STRG_PLC_ETC_AREA,0) END AS S1                           
			              , CASE WHEN A.MB IS NOT NULL  THEN 1 END AS A1
			              , CASE WHEN A.MB IS NULL      THEN 
			                     NVL(B.CSP_TOT_AREA,0) + NVL(B.STRG_PLC_PRC_PLC_AREA,0) + NVL(B.STRG_PLC_LWTP_STRG_AREA,0) + NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) +
			                     NVL(B.STRG_PLC_CURN_AREA,0) + NVL(B.STRG_PLC_GNRL_STRG_AREA,0) + NVL(B.STRG_PLC_ETC_AREA,0) END AS S2                           
			              , CASE WHEN A.MB IS NULL      THEN 1 END AS A2
			              , NVL(B.CSP_TOT_AREA,0) + NVL(B.STRG_PLC_PRC_PLC_AREA,0) + NVL(B.STRG_PLC_LWTP_STRG_AREA,0) + NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) +
			                NVL(B.STRG_PLC_CURN_AREA,0) + NVL(B.STRG_PLC_GNRL_STRG_AREA,0) + NVL(B.STRG_PLC_ETC_AREA,0) AS S3                           
			              , 1  AS A3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '2개별조직운영 APC' AS S0
			              , CASE WHEN A.MB IS NOT NULL  THEN 
			                     NVL(B.CSP_TOT_AREA,0) + NVL(B.STRG_PLC_PRC_PLC_AREA,0) + NVL(B.STRG_PLC_LWTP_STRG_AREA,0) + NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) +
			                     NVL(B.STRG_PLC_CURN_AREA,0) + NVL(B.STRG_PLC_GNRL_STRG_AREA,0) + NVL(B.STRG_PLC_ETC_AREA,0) END AS S1                           
			              , CASE WHEN A.MB IS NOT NULL  THEN 1 END AS A1
			              , CASE WHEN A.MB IS NULL      THEN 
			                     NVL(B.CSP_TOT_AREA,0) + NVL(B.STRG_PLC_PRC_PLC_AREA,0) + NVL(B.STRG_PLC_LWTP_STRG_AREA,0) + NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) +
			                     NVL(B.STRG_PLC_CURN_AREA,0) + NVL(B.STRG_PLC_GNRL_STRG_AREA,0) + NVL(B.STRG_PLC_ETC_AREA,0) END AS S2                           
			              , CASE WHEN A.MB IS NULL      THEN 1 END AS A2
			              , NVL(B.CSP_TOT_AREA,0) + NVL(B.STRG_PLC_PRC_PLC_AREA,0) + NVL(B.STRG_PLC_LWTP_STRG_AREA,0) + NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) +
			                     NVL(B.STRG_PLC_CURN_AREA,0) + NVL(B.STRG_PLC_GNRL_STRG_AREA,0) + NVL(B.STRG_PLC_ETC_AREA,0) AS S3                           
			              , 1  AS A3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD = B.APC_CD)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectLgstcsGdsFcltBdarGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - 물류,상품화 시설(건축면적) 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectLgstcsGdsFcltBdarGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , ROUND(SUM(S1),0)            AS V1 
			      , ROUND(SUM(S1) / SUM(A1),0)  AS V2
			      , ROUND(SUM(S2),0)            AS V3
			      , ROUND(SUM(S2) / SUM(A2),0)  AS V4
			      , ROUND(SUM(S3),0)            AS V5
			      , ROUND(SUM(S3) / SUM(A3),0)  AS V6
			FROM  ( SELECT '1통합조직운영 APC' AS S0
			              , CASE WHEN A.MB IS NOT NULL THEN NVL(B.CSP_TOT_AREA,0) END AS S1
			              , CASE WHEN A.MB IS NOT NULL THEN 1 END AS A1
			              , CASE WHEN A.MB IS NULL     THEN NVL(B.CSP_TOT_AREA,0) END AS S2
			              , CASE WHEN A.MB IS NULL     THEN 1 END AS A2
			              , NVL(B.CSP_TOT_AREA,0) AS S3
			              , 1 AS A3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD =  B.APC_CD
			        UNION ALL
			        SELECT '2개별조직운영 APC' AS S0
			              , CASE WHEN A.MB IS NOT NULL THEN NVL(B.CSP_TOT_AREA,0) END AS S1
			              , CASE WHEN A.MB IS NOT NULL THEN 1 END AS A1
			              , CASE WHEN A.MB IS NULL     THEN NVL(B.CSP_TOT_AREA,0) END AS S2
			              , CASE WHEN A.MB IS NULL     THEN 1 END AS A2
			              , NVL(B.CSP_TOT_AREA,0) AS S3
			              , 1 AS A3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD    =  B.APC_CD)
			GROUP BY S0
			ORDER BY S0;       
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectBzeatCntLwtpStrgGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - 저온저장고 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntLwtpStrgGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , SUM(S1)                     AS V1
			      , SUM(S2)                     AS V2
			      , ROUND(SUM(S3),0)            AS V3
			      , ROUND(SUM(S3) / SUM(S2),0)  AS V4
			FROM  ( SELECT '1통합조직운영 APC'                                                  AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) > 0 THEN 1 END           AS S2
			              , CASE WHEN A.MB IS NULL THEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) END    AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD    =  B.APC_CD
			        UNION ALL
			        SELECT '2개별조직운영 APC'                                          AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) > 0 THEN 1 END           AS S2
			              , CASE WHEN A.MB IS NULL THEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) END    AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD    =  B.APC_CD)
			GROUP BY S0
			ORDER BY S0;       
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectBzeatCntPrprtnClngFcltGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - 예냉시설 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntPrprtnClngFcltGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                          AS V0   -- 구분
			      , SUM(S1)                     AS V1   -- APC 개소수
			      , SUM(S2)                     AS V2   -- 예냉시설 개소수
			      , ROUND(SUM(S3),0)            AS V3   -- 예냉시설 면적
			      , ROUND(SUM(S3) / SUM(S2),0)  AS V4   -- 예냉시설 평균면적
			FROM  ( SELECT '1통합조직운영 APC'                                              AS S0
			              , 1                                                               AS S1
			              , CASE WHEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) > 0 THEN 1 END         AS S2
			              , CASE WHEN A.MB IS NULL THEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) END  AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD =  B.APC_CD
			        UNION ALL
			        SELECT '2개별조직운영 APC'                                          AS S0
			              , 1                                                               AS S1
			              , CASE WHEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) > 0 THEN 1 END         AS S2
			              , CASE WHEN A.MB IS NULL THEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) END  AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR   = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD    =  B.APC_CD)
			GROUP BY S0
			ORDER BY S0;   
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectBzeatCntStrgFcltGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - CA 저장시설 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntStrgFcltGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , SUM(S1)                     AS V1
			      , SUM(S2)                     AS V2
			      , ROUND(SUM(S3),0)            AS V3
			      , ROUND(SUM(S3) / SUM(S2),0)  AS V4
			FROM  ( SELECT '1통합조직운영 APC'                                                  AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) > 0 THEN 1 END         AS S2
			              , CASE WHEN A.MB IS NULL THEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) END  AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD =  B.APC_CD
			        UNION ALL
			        SELECT '2개별조직운영 APC'                                          AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) > 0 THEN 1 END         AS S2
			              , CASE WHEN A.MB IS NULL THEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) END  AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD =  B.APC_CD)
			GROUP BY S0
			ORDER BY S0;
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectBzeatCntFcltMsrmtEqpmntGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - 선별기, 측정장비 설치 개소 수 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntFcltMsrmtEqpmntGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , SUM(S1)                     AS V1
			      , SUM(S2)                     AS V2
			      , SUM(S3)                     AS V3
			      , SUM(S4)                     AS V4
			      , SUM(S5)                     AS V5
			FROM  ( SELECT '1통합조직운영 APC'                                          AS S0
			              , 1                                                           AS S1
			              , CASE WHEN B.SORT_MCHN_SPCFCT IS NOT NULL THEN 1 END         AS S2
			              , CASE WHEN B.SORT_BRCK_MCHN IS NOT NULL THEN 1 END           AS S3
			              , CASE WHEN B.COLOR_SORT IS NOT NULL THEN 1 END               AS S4
			              , CASE WHEN B.MNFC_MCHN IS NOT NULL THEN 1 END                AS S5
			              
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , MAX(SORT_MCHN_SPCFCT) AS SORT_MCHN_SPCFCT
			                      , MAX(SORT_BRCK_MCHN) AS SORT_BRCK_MCHN
			                      , MAX(COLOR_SORT) AS COLOR_SORT
			                      , MAX(MNFC_MCHN) AS MNFC_MCHN
			                FROM    USRAM.TB_TE_APC_FCLT_STTS_DTL
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)   
			        AND     A.OGNZ_TYPE_CD NOT IN ('5') 
			        UNION ALL
			        SELECT '2개별조직운영 APC'                                          AS S0
			              , 1                                                           AS S1
			              , CASE WHEN B.SORT_MCHN_SPCFCT IS NOT NULL THEN 1 END         AS S2
			              , CASE WHEN B.SORT_BRCK_MCHN IS NOT NULL THEN 1 END           AS S3
			              , CASE WHEN B.COLOR_SORT IS NOT NULL THEN 1 END               AS S4
			              , CASE WHEN B.MNFC_MCHN IS NOT NULL THEN 1 END                AS S5
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , MAX(SORT_MCHN_SPCFCT) AS SORT_MCHN_SPCFCT
			                      , MAX(SORT_BRCK_MCHN) AS SORT_BRCK_MCHN
			                      , MAX(COLOR_SORT) AS COLOR_SORT
			                      , MAX(MNFC_MCHN) AS MNFC_MCHN
			                FROM    USRAM.TB_TE_APC_FCLT_STTS_DTL
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD  =  B.APC_CD(+)  
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0;   
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectBzeatCntInvstAtmAllGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - 투자금액: 전체 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntInvstAtmAllGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                                          AS V0
			      , SUM(S1)                                     AS V1
			      , ROUND(SUM(S2)/1000000,0)                    AS V2
			      , ROUND((SUM(S2)/SUM(S1))/1000000,0)          AS V3
			      
			FROM  ( SELECT '1통합조직운영 APC'                  AS S0
			              , 1                                   AS S1
			              , B.NE + B.LCLT_EXPND + B.SLF_BRDN    AS S2
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)  
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        UNION ALL
			        SELECT '2개별조직운영 APC'                  AS S0
			              , 1                                   AS S1
			              , B.NE + B.LCLT_EXPND + B.SLF_BRDN    AS S2
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)  
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectBzeatCntInvstAtmFundTypeGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - 투자금액: 자금유형 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntInvstAtmFundTypeGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                                  AS V0
			      , ROUND(SUM(S1)/1000000,0)            AS V1
			      , ROUND(SUM(S2)/1000000,0)            AS V2
			      , ROUND(SUM(S3)/1000000,0)            AS V3
			      , ROUND(SUM(S4)/1000000,0)            AS V4 
			      
			FROM  ( SELECT '1통합조직운영 APC'                  AS S0
			              , B.NE                                AS S1
			              , B.LCLT_EXPND                        AS S2
			              , B.SLF_BRDN                          AS S3
			              , B.NE + B.LCLT_EXPND + B.SLF_BRDN    AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)  
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        UNION ALL
			        SELECT '2개별조직운영 APC'                  AS S0
			              , B.NE                                AS S1
			              , B.LCLT_EXPND                        AS S2
			              , B.SLF_BRDN                          AS S3
			              , B.NE + B.LCLT_EXPND + B.SLF_BRDN    AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)  
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectBzeatCntInvstAtmOwnrGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - 투자금액: 소유자 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntInvstAtmOwnrGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                                  AS V0
			      , SUM(S1)                             AS V1
			      , ROUND(SUM(S2)/1000000,0)            AS V2
			      , ROUND((SUM(S2)/SUM(S1))/1000000,0)  AS V3
			      , SUM(S3)                             AS V4
			      , ROUND(SUM(S4)/1000000,0)            AS V5
			      , ROUND((SUM(S4)/SUM(S3))/1000000,0)  AS V6
			      
			FROM  ( SELECT '1통합조직운영 APC'                        AS S0
			              , CASE WHEN A.TYPE_CD = '1' THEN 1 END      AS S1
			              , CASE WHEN A.TYPE_CD = '1' THEN B.AMT END  AS S2
			              , CASE WHEN A.TYPE_CD = '2' THEN 1 END      AS S3
			              , CASE WHEN A.TYPE_CD = '2' THEN B.AMT END  AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE+LCLT_EXPND+SLF_BRDN) AS AMT
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)  
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        UNION ALL
			        SELECT '2개별조직운영 APC'                  AS S0
			              , CASE WHEN A.TYPE_CD = '1' THEN 1 END      AS S1
			              , CASE WHEN A.TYPE_CD = '1' THEN B.AMT END  AS S2
			              , CASE WHEN A.TYPE_CD = '2' THEN 1 END      AS S3
			              , CASE WHEN A.TYPE_CD = '2' THEN B.AMT END  AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE+LCLT_EXPND+SLF_BRDN) AS AMT
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)  
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0; 
			]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.MdRtlFcltMapper.selectBzeatCntInvstOperPrsnGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - 투자금액: 운영자 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntInvstOperPrsnGridList" parameterType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO" resultType="com.at.apcss.fm.fclt.vo.MdRtlFcltVO">
    	<![CDATA[
			SELECT  S0                                  AS V0
			      , SUM(S1)                             AS V1
			      , ROUND(SUM(S2)/1000000,0)            AS V2
			      , ROUND((SUM(S2)/SUM(S1))/1000000,0)  AS V3
			      , SUM(S3)                             AS V4
			      , ROUND(SUM(S4)/1000000,0)            AS V5
			      , ROUND((SUM(S4)/SUM(S3))/1000000,0)  AS V6
			      
			FROM  ( SELECT '1통합조직운영 APC'                          AS S0
			              , CASE WHEN A.MB IS NOT NULL THEN 1 END       AS S1
			              , CASE WHEN A.MB IS NOT NULL THEN B.AMT END   AS S2
			              , CASE WHEN A.MB IS NULL THEN 1 END           AS S3
			              , CASE WHEN A.MB IS NULL THEN B.AMT END       AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE+LCLT_EXPND+SLF_BRDN) AS AMT
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)  
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        UNION ALL
			        SELECT '2개별조직운영 APC'                  AS S0
			              , CASE WHEN A.MB IS NOT NULL THEN 1 END       AS S1
			              , CASE WHEN A.MB IS NOT NULL THEN B.AMT END   AS S2
			              , CASE WHEN A.MB IS NULL THEN 1 END           AS S3
			              , CASE WHEN A.MB IS NULL THEN B.AMT END       AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE+LCLT_EXPND+SLF_BRDN) AS AMT
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   A.CRTR_YR = '2023'
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)  
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0; 
			]]>
    </select>

</mapper>