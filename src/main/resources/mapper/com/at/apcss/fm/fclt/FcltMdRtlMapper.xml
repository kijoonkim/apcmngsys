<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!-- ==========================================================================	-->
<!-- NAME : FcltMdRtlMapper.xml                                    				-->
<!-- DESC : APC 전수조사 대시보드 정보 mapper                                     -->
<!-- ==========================================================================	-->
<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
<!-- ===========  	============  	===========================================	-->
<!-- 2023.11.16  	김현호        	Initial Creation                            -->
<!-- ==========================================================================	-->

<mapper namespace="com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper">

	<!-- ==========================================================================	-->
	<!-- NAME :com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectCrtrYnList			-->
	<!-- DESC : 기준년도 목록 조회.                     	 							-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<select id="selectCrtrYnList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
		<![CDATA[
			SELECT
				CRTR_YR
			FROM
				USRAM.TB_TE_APC_OPER_PRSN_OTLN
			GROUP BY CRTR_YR
			ORDER BY CRTR_YR DESC
		]]>
	</select>

	<!-- ==========================================================================	-->
	<!-- NAME :com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectMapSttn			-->
	<!-- DESC : APC현황조회.                     	 								-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김호        	Initial Creation                            	-->
	<!-- ==========================================================================	-->
	<select id="selectMapSttn" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
		<![CDATA[
			SELECT pt0.CTPV_NM	/* com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectMapSttn */
			     , CASE WHEN pt0.CTPV_CD = '11'
			            THEN '11'
			            WHEN pt0.CTPV_CD = '26'
			            THEN '21'
			            WHEN pt0.CTPV_CD = '27'
			            THEN '22'
			            WHEN pt0.CTPV_CD = '28'
			            THEN '23'
			            WHEN pt0.CTPV_CD = '29'
			            THEN '24'
			            WHEN pt0.CTPV_CD = '30'
			            THEN '25'
			            WHEN pt0.CTPV_CD = '31'
			            THEN '26'
			            WHEN pt0.CTPV_CD = '36'
			            THEN '29'
			            WHEN pt0.CTPV_CD = '41'
			            THEN '31'
			            WHEN pt0.CTPV_CD = '43'
			            THEN '33'
			            WHEN pt0.CTPV_CD = '44'
			            THEN '34'
			            WHEN pt0.CTPV_CD = '45'
			            THEN '35'
			            WHEN pt0.CTPV_CD = '46'
			            THEN '36'
			            WHEN pt0.CTPV_CD = '47'
			            THEN '37'
			            WHEN pt0.CTPV_CD = '48'
			            THEN '38'
			            WHEN pt0.CTPV_CD = '50'
			            THEN '39'
			            WHEN pt0.CTPV_CD = '51'
			            THEN '32'
			        END AS CTPV_CD
			      , pt0.APC_QNTT
			  FROM (
			        SELECT CTPV_NM
			             , CTPV_CD
			             , COUNT(*) APC_QNTT
			          FROM TB_TE_APC_OPER_PRSN_OTLN
			         WHERE CTPV_CD IS NOT NULL
			         AND TOT_STTN_YN = 'Y'
		]]>
		<if test='crtrYr != null and crtrYr != ""'>
					  AND CRTR_YR = #{crtrYr}
		</if>
		<![CDATA[
			        GROUP BY CTPV_CD, CTPV_NM
			        ) pt0
		]]>

	</select>
	<!-- ==========================================================================	-->
	<!-- NAME :com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectCtpvAreaList		-->
	<!-- DESC : APC지역목록조회.                     	 							-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김호        	Initial Creation                            	-->
	<!-- ==========================================================================	-->
	<select id="selectCtpvAreaList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
		<![CDATA[
			SELECT /* com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectCtpvAreaLis */
				   AOO.CRTR_YR          AS CRTR_YR
			     , AOO.APC_CD           AS APC_CD
			     , AOO.APC_NM           AS APC_NM
			     , AOO.APC_BRNO         AS APC_BRNO
			     , AOO.OPER_OGNZ_CD     AS OPER_OGNZ_CD
			     , AOO.OPER_OGNZ_NM     AS OPER_OGNZ_NM
			     , AOO.OPER_OGNZ_BRNO   AS OPER_OGNZ_BRNO
			     , AOO.CTPV_CD          AS CTPV_CD
			     , AOO.CTPV_NM          AS CTPV_NM
			     , AOO.SIGUN_CD         AS SIGUN_CD
			     , AOO.SIGUN_NM         AS SIGUN_NM
			     , AOO.MB               AS MB
			     , AOO.OGNZ_TYPE_CD     AS OGNZ_TYPE_CD
			     , AOO.OGNZ_TYPE        AS OGNZ_TYPE
			     , AOO.TYPE_CD          AS TYPE_CD
			     , AOO.TYPE_NM          AS TYPE_NM
			     , AOO.OWNR             AS OWNR
			     , AOO.LOCTN            AS LOCTN
			     , AOO.RPRSV            AS RPRSV
			     , AOO.PIC              AS PIC
			     , AOO.PIC_JBPS         AS PIC_JBPS
			     , AOO.CTTPC            AS CTTPC
			     , AOO.EML              AS EML
			     , AOO.TOT_TRMT_AMT     AS TOT_TRMT_AMT
			     , AOO.GVRMNT_SPRT_YN   AS GVRMNT_SPRT_YN
			     , AOO.RMRK             AS RMRK

			  FROM TB_TE_APC_OPER_PRSN_OTLN AOO
		   	 WHERE 1=1
		   	 AND TOT_STTN_YN = 'Y'
		]]>
		<if test='crtrYr != null and crtrYr != ""'>
			   AND AOO.CRTR_YR = #{crtrYr}
		</if>
		<if test='ctpvCd != null and ctpvCd != ""'>
			   AND AOO.CTPV_CD = #{ctpvCd}
		</if>
		<![CDATA[
			ORDER BY AOO.APC_NM
		]]>

	</select>

	<!-- ==========================================================================	-->
	<!-- NAME :com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectMdRtlOgnzGridList  -->
	<!-- DESC : 운영조직 취급실적 테이블 단건조회.                     	 			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectMdRtlOgnzGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT
				    '통합조직 운영 APC' AS TITLE
				  , '통합조직' AS SUB_TITLE
				  , '통합조직_승인형' AS S0
			      , COUNT(1)    AS S1
			FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			WHERE	1=1
			]]>
		<if test='crtrYr != null and crtrYr != ""'>
			AND   	CRTR_YR         = #{crtrYr}
		</if>
		<![CDATA[
			AND     CTPV_CD IS NOT NULL
			AND     OGNZ_TYPE_CD    = '1'
			AND 	TOT_STTN_YN = 'Y'
			UNION ALL
			SELECT
				    '통합조직 운영 APC' AS TITLE
				  , '통합조직' AS SUB_TITLE
				  , '통합조직_육성형' AS S0
			      , COUNT(1)    AS S1
			FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			WHERE   1=1
			]]>
		<if test='crtrYr != null and crtrYr != ""'>
			AND   	CRTR_YR         = #{crtrYr}
		</if>
		<![CDATA[
			AND     CTPV_CD IS NOT NULL
			AND     OGNZ_TYPE_CD    = '2'
			AND 	TOT_STTN_YN = 'Y'
			UNION ALL
			SELECT
			  		'통합조직 운영 APC' AS TITLE
				  ,'통합조직' AS SUB_TITLE
				  ,'소계(1)' AS S0
			      , COUNT(1)    AS S1
			FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			WHERE   1=1
			]]>
		<if test='crtrYr != null and crtrYr != ""'>
			AND   	CRTR_YR         = #{crtrYr}
		</if>
		<![CDATA[
			AND     CTPV_CD IS NOT NULL
			AND     OGNZ_TYPE_CD  not  IN ('3','4','5')
			AND 	TOT_STTN_YN = 'Y'
			UNION ALL
			SELECT
					 '통합조직 운영 APC' AS TITLE
				  ,  '통합출자출하조직' AS SUB_TITLE
				  ,  '통합출자출하조직_승인형' AS S0
			      , COUNT(1)    AS S1
			FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			WHERE   1=1
			]]>
		<if test='crtrYr != null and crtrYr != ""'>
			AND   	CRTR_YR         = #{crtrYr}
		</if>
		<![CDATA[
			AND     CTPV_CD IS NOT NULL
			AND     OGNZ_TYPE_CD    = '3'
			AND 	TOT_STTN_YN = 'Y'
			UNION ALL
			SELECT
					'통합조직 운영 APC' AS TITLE
				  , '통합출자출하조직' AS SUB_TITLE
				  , '통합출자출하조직_육성형' AS S0
			      , COUNT(1)    AS S1
			FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			WHERE   1=1
			]]>
		<if test='crtrYr != null and crtrYr != ""'>
			AND   	CRTR_YR         = #{crtrYr}
		</if>
		<![CDATA[
			AND     CTPV_CD IS NOT NULL
			AND     OGNZ_TYPE_CD    = '4'
			AND 	TOT_STTN_YN = 'Y'
			UNION ALL
			SELECT
			  		'통합조직 운영 APC' AS TITLE
				  ,'통합출자출하조직' AS SUB_TITLE
				  ,'소계(2)' AS S0
			      , COUNT(1)    AS S1
			FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			WHERE   1=1
			]]>
		<if test='crtrYr != null and crtrYr != ""'>
			AND   	CRTR_YR         = #{crtrYr}
		</if>
		<![CDATA[
			AND     CTPV_CD IS NOT NULL
			AND     OGNZ_TYPE_CD  not  IN ('1','2','5')
			AND 	TOT_STTN_YN = 'Y'
			UNION ALL
			SELECT
			  		'통합조직 합계(1+2)' AS TITLE
				  ,'통합조직 합계(1+2)' AS SUB_TITLE
				  ,'통합조직 합계(1+2)' AS S0
			      , COUNT(1)    AS S1
			FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			WHERE   1=1
			]]>
		<if test='crtrYr != null and crtrYr != ""'>
			AND   	CRTR_YR         = #{crtrYr}
		</if>
		<![CDATA[
			AND     CTPV_CD IS NOT NULL
			AND     OGNZ_TYPE_CD  not  IN ('5')
			AND 	TOT_STTN_YN = 'Y'
			UNION ALL
			SELECT
			  	   '개별조직 합계' AS TITLE
				  ,'개별조직 합계' AS SUB_TITLE
				  ,'개별조직 합계' AS S0
			      , COUNT(1)    AS S1
			FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			WHERE   1=1
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			AND     CTPV_CD IS NOT NULL
			AND     OGNZ_TYPE_CD    IN ('5')
			AND 	TOT_STTN_YN = 'Y'
			UNION ALL
			SELECT
			  	   '전체 합계' AS TITLE
				  ,'전체 합계' AS SUB_TITLE
				  ,'전체 합계' AS S0
			      , COUNT(1)    AS S1
			FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			WHERE   1=1
			]]>
		<if test='crtrYr != null and crtrYr != ""'>
			AND   	CRTR_YR         = #{crtrYr}
		</if>
		<![CDATA[
			AND     CTPV_CD IS NOT NULL
			AND     OGNZ_TYPE_CD    IN ('1','2','3','4','5')
			AND 	TOT_STTN_YN = 'Y'
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME :com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectOwnrAndOperGridList-->
	<!-- DESC : 개소수:소유자 및 운영자 테이블 단건조회.                     	 		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectOwnrAndOperGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0
			      , SUM(S1) AS S1
			      , SUM(S2) AS S2
			      , SUM(S3) AS S3
			      , SUM(S4) AS S4
			      , SUM(S5) AS S5
			FROM  ( SELECT '통합조직운영 APC'                   AS S0
			              , CASE WHEN TYPE_CD = '1'   THEN 1 END AS S1
			              , CASE WHEN TYPE_CD = '2'   THEN 1 END AS S2
			              , CASE WHEN MB IS NOT NULL  THEN 1 END AS S3
			              , CASE WHEN MB IS NULL      THEN 1 END AS S4
			              , 1                                    AS S5
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			        WHERE   1=1
			        AND TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     OGNZ_TYPE_CD NOT IN ('5')
			        AND     CTPV_CD IS NOT NULL
			        UNION ALL
			        SELECT '개별조직운영 APC'                   AS S0
			              , CASE WHEN TYPE_CD = '1'   THEN 1 END AS S1
			              , CASE WHEN TYPE_CD = '2'   THEN 1 END AS S2
			              , CASE WHEN MB IS NOT NULL  THEN 1 END AS S3
			              , CASE WHEN MB IS NULL      THEN 1 END AS S4
			              , 1                                    AS S5
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			        WHERE   1=1
			        AND TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     OGNZ_TYPE_CD IN ('5')
			        AND     CTPV_CD IS NOT NULL)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectAllBdarGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - 총 건축면적 테이블 단건조회.             		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectAllBdarGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , ROUND(SUM(S1),0)            AS V1
			      , ROUND(SUM(S1) / SUM(A1),0)  AS V2
			      , ROUND(SUM(S2),0)            AS V3
			      , ROUND(SUM(S2) / SUM(A2),0)  AS V4
			      , ROUND(SUM(S3),0)            AS V5
			      , ROUND(SUM(S3) / SUM(A3),0)  AS V6
			FROM  ( SELECT '통합조직운영 APC'                                                 AS S0
			              , CASE WHEN A.MB IS NOT NULL  THEN
			                     NVL(B.CSP_TOT_AREA,0) END AS S1
			              , CASE WHEN A.MB IS NOT NULL  THEN 1 END AS A1
			              , CASE WHEN A.MB IS NULL      THEN
			                     NVL(B.CSP_TOT_AREA,0) END AS S2
			              , CASE WHEN A.MB IS NULL      THEN 1 END AS A2
			              , NVL(B.CSP_TOT_AREA,0) AS S3
			              , 1  AS A3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '개별조직운영 APC' AS S0
			              , CASE WHEN A.MB IS NOT NULL  THEN
			                     NVL(B.CSP_TOT_AREA,0) END AS S1
			              , CASE WHEN A.MB IS NOT NULL  THEN 1 END AS A1
			              , CASE WHEN A.MB IS NULL      THEN
			                     NVL(B.CSP_TOT_AREA,0) END AS S2
			              , CASE WHEN A.MB IS NULL      THEN 1 END AS A2
			              , NVL(B.CSP_TOT_AREA,0) AS S3
			              , 1  AS A3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD = B.APC_CD)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectLgstcsGdsGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - 물류:상품화시설(건축면적) 테이블 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectLgstcsGdsGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , ROUND(SUM(S1),0)            AS V1
			      , ROUND(SUM(S1) / SUM(A1),0)  AS V2
			      , ROUND(SUM(S2),0)            AS V3
			      , ROUND(SUM(S2) / SUM(A2),0)  AS V4
			      , ROUND(SUM(S3),0)            AS V5
			      , ROUND(SUM(S3) / SUM(A3),0)  AS V6
			FROM  ( SELECT '통합조직운영 APC' AS S0
			              , CASE WHEN A.MB IS NOT NULL THEN
			                NVL(B.CSP_CFPP_AREA,0) +
			                NVL(B.CSP_CLN_OPRTNG_PRCS_AREA,0)  END AS S1
			              , CASE WHEN A.MB IS NOT NULL THEN 1 END AS A1
			              , CASE WHEN A.MB IS NULL     THEN
			                NVL(B.CSP_CFPP_AREA,0) +
			                NVL(B.CSP_CLN_OPRTNG_PRCS_AREA,0)  END AS S2
			              , CASE WHEN A.MB IS NULL     THEN 1 END AS A2
			              , NVL(B.CSP_CFPP_AREA,0) +
			                NVL(B.CSP_CLN_OPRTNG_PRCS_AREA,0)  AS S3
			              , 1 AS A3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD    =  B.APC_CD
			        UNION ALL
			        SELECT '개별조직운영 APC' AS S0
			              , CASE WHEN A.MB IS NOT NULL THEN NVL(B.CSP_CFPP_AREA,0) + NVL(B.CSP_CLN_OPRTNG_PRCS_AREA,0) END AS S1
			              , CASE WHEN A.MB IS NOT NULL THEN 1 END AS A1
			              , CASE WHEN A.MB IS NULL     THEN NVL(B.CSP_CFPP_AREA,0) + NVL(B.CSP_CLN_OPRTNG_PRCS_AREA,0) END AS S2
			              , CASE WHEN A.MB IS NULL     THEN 1 END AS A2
			              , NVL(B.CSP_CFPP_AREA,0) + NVL(B.CSP_CLN_OPRTNG_PRCS_AREA,0)  AS S3
			              , 1 AS A3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD    =  B.APC_CD)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectLwtpStrgGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - 저온냉장고 테이블 단건조회.					-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectLwtpStrgGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , SUM(S1)                     AS V1
			      , SUM(S2)                     AS V2
			      , ROUND(SUM(S3),0)            AS V3
			      , ROUND(SUM(S3) / SUM(S2),0)  AS V4
			FROM  ( SELECT '통합조직운영 APC'                                                  AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) > 0 THEN 1 END           AS S2
			              , CASE WHEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) > 0 THEN
			                     NVL(B.STRG_PLC_LWTP_STRG_AREA,0) END   					    AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD    =  B.APC_CD
			        UNION ALL
			        SELECT '개별조직운영 APC'                                          AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) > 0 THEN 1 END           AS S2
			              , CASE WHEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) > 0 THEN
			                     NVL(B.STRG_PLC_LWTP_STRG_AREA,0) END						    AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD    =  B.APC_CD)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectPrprtnClngFcltGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - 예냉시설 테이블 단건조회.					-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectPrprtnClngFcltGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , SUM(S1)                     AS V1
			      , SUM(S2)                     AS V2
			      , ROUND(SUM(S3),0)            AS V3
			      , ROUND(SUM(S3) / SUM(S2),0)  AS V4
			FROM  ( SELECT '통합조직운영 APC'                                              AS S0
			              , 1                                                               AS S1
			              , CASE WHEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) > 0 THEN 1 END         AS S2
			              , CASE WHEN A.MB IS NULL THEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) END  AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD    =  B.APC_CD
			        UNION ALL
			        SELECT '개별조직운영 APC'                                          AS S0
			              , 1                                                               AS S1
			              , CASE WHEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) > 0 THEN 1 END         AS S2
			              , CASE WHEN A.MB IS NULL THEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) END  AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD    =  B.APC_CD)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectStrgFcltGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - CA저장시설 테이블 단건조회.					-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectStrgFcltGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , SUM(S1)                     AS V1
			      , SUM(S2)                     AS V2
			      , ROUND(SUM(S3),0)            AS V3
			      , ROUND(SUM(S3) / SUM(S2),0)  AS V4
			FROM  ( SELECT '통합조직운영 APC'                                                  AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) > 0 THEN 1 ELSE 0 END  AS S2
			              , CASE WHEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) > 0 THEN
			                     NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) END                         AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD =  B.APC_CD
			        UNION ALL
			        SELECT '개별조직운영 APC'                                          AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) > 0 THEN 1 ELSE 0 END  AS S2
			              , CASE WHEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) > 0 THEN
			                     NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) END                         AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD =  B.APC_CD)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectFcltMsrmtEqpmntGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - 측정장비설치 개소수 단건조회.					-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectFcltMsrmtEqpmntGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , SUM(S1)                     AS V1
			      , SUM(S2)                     AS V2
			      , SUM(S3)                     AS V3
			      , SUM(S4)                     AS V4
			      , SUM(S5)                     AS V5
			FROM  ( SELECT '통합조직운영 APC'                                          AS S0
			              , 1                                                           AS S1
			              , CASE WHEN B.SORT_MCHN_SPCFCT IS NOT NULL THEN 1 END         AS S2
			              , CASE WHEN B.SORT_BRCK_MCHN   = 'Y'       THEN 1 END         AS S3
			              , CASE WHEN B.COLOR_SORT       = 'Y'       THEN 1 END         AS S4
			              , CASE WHEN B.MNFC_MCHN        IS NOT NULL THEN 1 END         AS S5

			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , MAX(SORT_MCHN_SPCFCT) AS SORT_MCHN_SPCFCT
			                      , MAX(SORT_BRCK_MCHN) AS SORT_BRCK_MCHN
			                      , MAX(COLOR_SORT) AS COLOR_SORT
			                      , MAX(MNFC_MCHN) AS MNFC_MCHN
			                FROM    USRAM.TB_TE_APC_FCLT_STTS_DTL
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        UNION ALL
			        SELECT '개별조직운영 APC'                                          AS S0
			              , 1                                                           AS S1
			              , CASE WHEN B.SORT_MCHN_SPCFCT IS NOT NULL THEN 1 END         AS S2
			              , CASE WHEN B.SORT_BRCK_MCHN   = 'Y'       THEN 1 END         AS S3
			              , CASE WHEN B.COLOR_SORT       = 'Y'       THEN 1 END         AS S4
			              , CASE WHEN B.MNFC_MCHN        IS NOT NULL THEN 1 END         AS S5
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , MAX(SORT_MCHN_SPCFCT) AS SORT_MCHN_SPCFCT
			                      , MAX(SORT_BRCK_MCHN) AS SORT_BRCK_MCHN
			                      , MAX(COLOR_SORT) AS COLOR_SORT
			                      , MAX(MNFC_MCHN) AS MNFC_MCHN
			                FROM    USRAM.TB_TE_APC_FCLT_STTS_DTL
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD  =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectInvstAtmAllGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - 투자금액: 전체 단건조회.						-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectInvstAtmAllGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                                          AS V0
			      , SUM(S1)                                     AS V1
			      , ROUND(SUM(S2)/1000000,0)                    AS V2
			      , ROUND((SUM(S2)/SUM(S1))/1000000,0)          AS V3

			FROM  ( SELECT '통합조직운영 APC'                  AS S0
			              , 1                                   AS S1
			              , B.NE + B.LCLT_EXPND + B.SLF_BRDN    AS S2
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        UNION ALL
			        SELECT '개별조직운영 APC'                  AS S0
			              , 1                                   AS S1
			              , B.NE + B.LCLT_EXPND + B.SLF_BRDN    AS S2
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectInvstAtmFundTypeGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - 투자금액: 자금유형 단건조회.					-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectInvstAtmFundTypeGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                                  AS V0
			      , ROUND(SUM(S1)/1000000,0)            AS V1
			      , ROUND(SUM(S2)/1000000,0)            AS V2
			      , ROUND(SUM(S3)/1000000,0)            AS V3
			      , ROUND(SUM(S4)/1000000,0)            AS V4

			FROM  ( SELECT '통합조직운영 APC'                  AS S0
			              , B.NE                                AS S1
			              , B.LCLT_EXPND                        AS S2
			              , B.SLF_BRDN                          AS S3
			              , B.NE + B.LCLT_EXPND + B.SLF_BRDN    AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        UNION ALL
			        SELECT '개별조직운영 APC'                  AS S0
			              , B.NE                                AS S1
			              , B.LCLT_EXPND                        AS S2
			              , B.SLF_BRDN                          AS S3
			              , B.NE + B.LCLT_EXPND + B.SLF_BRDN    AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectInvstAtmOwnrGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - 투자금액: 소유자 단건조회.					-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectInvstAtmOwnrGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                                  AS V0
			      , SUM(S1)                             AS V1
			      , ROUND(SUM(S2)/1000000,0)            AS V2
			      , ROUND((SUM(S2)/SUM(S1))/1000000,0)  AS V3
			      , SUM(S3)                             AS V4
			      , ROUND(SUM(S4)/1000000,0)            AS V5
			      , ROUND((SUM(S4)/SUM(S3))/1000000,0)  AS V6

			FROM  ( SELECT '통합조직운영 APC'                        AS S0
			              , CASE WHEN A.TYPE_CD = '1' THEN 1 END      AS S1
			              , CASE WHEN A.TYPE_CD = '1' THEN B.AMT END  AS S2
			              , CASE WHEN A.TYPE_CD = '2' THEN 1 END      AS S3
			              , CASE WHEN A.TYPE_CD = '2' THEN B.AMT END  AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE+LCLT_EXPND+SLF_BRDN) AS AMT
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        UNION ALL
			        SELECT '개별조직운영 APC'                  AS S0
			              , CASE WHEN A.TYPE_CD = '1' THEN 1 END      AS S1
			              , CASE WHEN A.TYPE_CD = '1' THEN B.AMT END  AS S2
			              , CASE WHEN A.TYPE_CD = '2' THEN 1 END      AS S3
			              , CASE WHEN A.TYPE_CD = '2' THEN B.AMT END  AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE+LCLT_EXPND+SLF_BRDN) AS AMT
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectInvstAtmOperPrsnGridList	-->
	<!-- DESC : 산지유통시설 시설ㆍ장비 - 투자금액: 소유자 단건조회.					-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectInvstAtmOperPrsnGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                                  AS V0
			      , SUM(S1)                             AS V1
			      , ROUND(SUM(S2)/1000000,0)            AS V2
			      , ROUND((SUM(S2)/SUM(S1))/1000000,0)  AS V3
			      , SUM(S3)                             AS V4
			      , ROUND(SUM(S4)/1000000,0)            AS V5
			      , ROUND((SUM(S4)/SUM(S3))/1000000,0)  AS V6

			FROM  ( SELECT '통합조직운영 APC'                          AS S0
			              , CASE WHEN A.MB IS NOT NULL THEN 1 END       AS S1
			              , CASE WHEN A.MB IS NOT NULL THEN B.AMT END   AS S2
			              , CASE WHEN A.MB IS NULL THEN 1 END           AS S3
			              , CASE WHEN A.MB IS NULL THEN B.AMT END       AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE+LCLT_EXPND+SLF_BRDN) AS AMT
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        UNION ALL
			        SELECT '개별조직운영 APC'                  AS S0
			              , CASE WHEN A.MB IS NOT NULL THEN 1 END       AS S1
			              , CASE WHEN A.MB IS NOT NULL THEN B.AMT END   AS S2
			              , CASE WHEN A.MB IS NULL THEN 1 END           AS S3
			              , CASE WHEN A.MB IS NULL THEN B.AMT END       AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE+LCLT_EXPND+SLF_BRDN) AS AMT
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectMdRtlOgnzTypeGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - 지역별 개소수 : 산지유통조직 유형 단건조회.	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectMdRtlOgnzTypeGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)          AS V0
			      , SUM(S1)     AS V1
			      , SUM(S2)     AS V2
			      , SUM(S3)     AS V3
			      , SUM(S4)     AS V4
			      , SUM(S5)     AS V5
			      , SUM(S6)     AS V6
			      , SUM(S7)     AS V7
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM)  AS S0
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND A.TYPE_CD = '1' THEN 1 END    AS S1
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND A.TYPE_CD = '2' THEN 1 END    AS S2
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND A.TYPE_CD = '1' THEN 1 END        AS S3
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND A.TYPE_CD = '2' THEN 1 END        AS S4
			              , CASE WHEN A.TYPE_CD = '1' THEN 1 END                                    AS S5
			              , CASE WHEN A.TYPE_CD = '2' THEN 1 END                                    AS S6
			              , 1                                                                       AS S7
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL)
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
		]]>
	</select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectRgnOperPrsnGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - 지역별 개소수 : 운영자 단건조회.				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectRgnOperPrsnGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)          AS V0
			      , SUM(S1)     AS V1
			      , SUM(S2)     AS V2
			      , SUM(S3)     AS V3
			      , SUM(S4)     AS V4
			      , SUM(S5)     AS V5
			      , SUM(S6)     AS V6
			      , SUM(S7)     AS V7
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND A.MB IS NOT NULL THEN 1 END   AS S1
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND A.MB IS NULL THEN 1 END       AS S2
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND A.MB IS NOT NULL THEN 1 END       AS S3
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND A.MB IS NULL THEN 1 END           AS S4
			              , CASE WHEN A.MB IS NOT NULL THEN 1 END                                   AS S5
			              , CASE WHEN A.MB IS NULL THEN 1 END                                       AS S6
			              , 1                                                                       AS S7
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL)
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END);
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectLgstcsGdsFcltGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - 산지우통시설 시설·장비 : 물류·상품화 시설 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.16  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectLgstcsGdsFcltGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)        	AS V0
			      , NVL(ROUND(SUM(S1),0),0)             AS V1
			      , NVL(ROUND(SUM(S1)/SUM(S2),0),0)     AS V2
			      , NVL(ROUND(SUM(S3),0),0)             AS V3
			      , NVL(ROUND(SUM(S3)/SUM(S4),0),0)     AS V4
			      , NVL(ROUND(SUM(S5),0),0)             AS V5
			      , NVL(ROUND(SUM(S5)/SUM(S6),0),0)     AS V6
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN
			                     NVL(B.CSP_CFPP_AREA,0) +
			                     NVL(B.CSP_CLN_OPRTNG_PRCS_AREA,0) END              AS S1
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN 1 END        AS S2
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN
			                     NVL(B.CSP_CFPP_AREA,0) +
			                     NVL(B.CSP_CLN_OPRTNG_PRCS_AREA,0) END              AS S3
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN 1 END            AS S4
			              , NVL(B.CSP_CFPP_AREA,0) +
			                NVL(B.CSP_CLN_OPRTNG_PRCS_AREA,0)                       AS S5
			              , 1                                                       AS S6
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD   IS NOT NULL
			        AND     A.APC_CD    =  B.APC_CD(+))
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectLgstcsGdsFcltGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - 저온저장고 단건조회.							-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectMdLwtpStrgGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)		   AS V0
			      , NVL(ROUND(SUM(S1),0),0)            AS V1
			      , NVL(ROUND(SUM(S2),0),0)            AS V2
			      , NVL(ROUND(SUM(S3),0),0)            AS V3
			      , NVL(ROUND(SUM(S3)/SUM(S2),0),0)    AS V4
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) > 0 THEN 1 ELSE 0 END    AS S2
			              , CASE WHEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) > 0 THEN
			                     NVL(B.STRG_PLC_LWTP_STRG_AREA,0) END                           AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD   IS NOT NULL
			        AND     A.APC_CD    =  B.APC_CD(+))
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectRgnPrprtnClngFcltGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - 예냉시설 단건조회.							-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectRgnPrprtnClngFcltGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)		   AS V0
			      , NVL(ROUND(SUM(S1),0),0)            AS V1
			      , NVL(ROUND(SUM(S2),0),0)            AS V2
			      , NVL(ROUND(SUM(S3),0),0)            AS V3
			      , NVL(ROUND(SUM(S3)/SUM(S2),0),0)    AS V4
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) > 0 THEN 1 ELSE 0 END      AS S2
			              , CASE WHEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) > 0 THEN
			                     NVL(B.STRG_PLC_PRC_PLC_AREA,0) END                             AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD   IS NOT NULL
			        AND     A.APC_CD    =  B.APC_CD(+))
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectRgnStrgFcltGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - CA저장고 단건조회.							-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectRgnStrgFcltGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)		AS V0
			      , NVL(ROUND(SUM(S1),0),0)         AS V1
			      , NVL(ROUND(SUM(S2),0),0)         AS V2
			      , NVL(ROUND(SUM(S3),0),0)         AS V3
			      , NVL(ROUND(SUM(S3)/NULLIF(SUM(S2),0),0),0) AS V4
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) > 0 THEN 1 ELSE 0 END  AS S2
			              , NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0)                          AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD   IS NOT NULL
			        AND     A.APC_CD    =  B.APC_CD(+))
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectRgnFcltMsrmtEqpmntGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - 선별기·측정장비 설치 개소 수 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectRgnFcltMsrmtEqpmntGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)		   AS V0
			      , NVL(ROUND(SUM(S1),0),0)            AS V1
			      , NVL(ROUND(SUM(S2),0),0)            AS V2
			      , NVL(ROUND(SUM(S3),0),0)            AS V3
			      , NVL(ROUND(SUM(S3)/SUM(S2),0),0)    AS V4
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , 1                                                           AS S1
			              , CASE WHEN B.SORT_MCHN_SPCFCT IS NOT NULL THEN 1 END         AS S2
			              , CASE WHEN B.SORT_BRCK_MCHN = 'Y'         THEN 1 END         AS S3
			              , CASE WHEN B.COLOR_SORT = 'Y'             THEN 1 END         AS S4
			              , CASE WHEN B.MNFC_MCHN IS NOT NULL        THEN 1 END         AS S5

			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			               (SELECT  APC_CD
			                      , MAX(SORT_MCHN_SPCFCT) AS SORT_MCHN_SPCFCT
			                      , MAX(SORT_BRCK_MCHN) AS SORT_BRCK_MCHN
			                      , MAX(COLOR_SORT) AS COLOR_SORT
			                      , MAX(MNFC_MCHN) AS MNFC_MCHN
			                FROM    USRAM.TB_TE_APC_FCLT_STTS_DTL
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD   IS NOT NULL
			        AND     A.APC_CD    =  B.APC_CD(+))
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectRgnInvstAtmAllGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - 지역별 투자금액 전체 단건조회.				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectRgnInvstAtmAllGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)		   			AS V0
			      , NVL(SUM(S1),0)                              AS V1
			      , NVL(ROUND(SUM(S2)/1000000,0),0)             AS V2
			      , NVL(ROUND(SUM(S3)/1000000,0),0)             AS V3
			      , NVL(ROUND(SUM(S4)/1000000,0),0)             AS V4
			      , NVL(ROUND(SUM(S5)/1000000,0),0)             AS V5
			      , NVL(ROUND((SUM(S5)/SUM(S1))/1000000,0),0)   AS V6
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , 1                               AS S1
			              , B.NE                            AS S2
			              , B.LCLT_EXPND                    AS S3
			              , B.SLF_BRDN                      AS S4
			              , B.NE+B.LCLT_EXPND+B.SLF_BRDN    AS S5
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			               (SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD   IS NOT NULL
			        AND     A.APC_CD    =  B.APC_CD(+))
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectRgnInvstAtmOwnrGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - 지역별 투자금액 소유자 단건조회.				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectRgnInvstAtmOwnrGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)		   			AS V0
			      , NVL(SUM(S1),0)                              AS V1
			      , NVL(ROUND(SUM(S2)/1000000,0),0)             AS V2
			      , CASE WHEN SUM(S1) > 0 THEN NVL(ROUND((SUM(S2)/SUM(S1))/1000000,0),0)
			             ELSE 0 END                             AS V3
			      , NVL(SUM(S3),0)                              AS V4
			      , NVL(ROUND(SUM(S4)/1000000,0),0)             AS V5
			      , CASE WHEN SUM(S3) > 0 THEN NVL(ROUND((SUM(S4)/SUM(S3))/1000000,0),0)
			             ELSE 0 END                             AS V6
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , CASE WHEN A.TYPE_CD = '1' THEN 1 ELSE 0 END                                 AS S1
			              , CASE WHEN A.TYPE_CD = '1' THEN B.NE + B.LCLT_EXPND + B.SLF_BRDN ELSE 0 END  AS S2
			              , CASE WHEN A.TYPE_CD = '2' THEN 1 ELSE 0 END                                 AS S3
			              , CASE WHEN A.TYPE_CD = '2' THEN B.NE + B.LCLT_EXPND + B.SLF_BRDN ELSE 0 END  AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			               (SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD   IS NOT NULL
			        AND     A.APC_CD    =  B.APC_CD(+)
			      )
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectRgnInvstOperPrsnGridList	-->
	<!-- DESC : 산지유통시설 지역별 현황 - 지역별 투자금액 운영자 단건조회.				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectRgnInvstOperPrsnGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)		   			AS V0
			      , NVL(SUM(S1),0)                              AS V1
			      , NVL(ROUND(SUM(S2)/1000000,0),0)             AS V2
			      , CASE WHEN SUM(S1) > 0 THEN NVL(ROUND((SUM(S2)/SUM(S1))/1000000,0),0)
			             ELSE 0 END                             AS V3
			      , NVL(SUM(S3),0)                              AS V4
			      , NVL(ROUND(SUM(S4)/1000000,0),0)             AS V5
			      , CASE WHEN SUM(S3) > 0 THEN NVL(ROUND((SUM(S4)/SUM(S3))/1000000,0),0)
			             ELSE 0 END                             AS V6
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , CASE WHEN A.MB IS NOT NULL THEN 1 ELSE 0 END                                AS S1
			              , CASE WHEN A.MB IS NOT NULL THEN B.NE + B.LCLT_EXPND + B.SLF_BRDN ELSE 0 END AS S2
			              , CASE WHEN A.MB IS NULL THEN 1 ELSE 0 END                                    AS S3
			              , CASE WHEN A.MB IS NULL THEN B.NE + B.LCLT_EXPND + B.SLF_BRDN ELSE 0 END     AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			               (SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD   IS NOT NULL
			        AND     A.APC_CD    =  B.APC_CD(+)
			      )
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectBzeatCntMdRtlOgnzTypeGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 -개소수: 개소수:산지유통조직 유형 단건조회.	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntMdRtlOgnzTypeGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT '통합조직 운영 APC' AS TITLE,
			        '통합조직' AS SUB_TITLE,
			        '통합조직_승인형' AS S0,
			        COUNT(1) AS S1 -- 통합조직_승인형
			   FROM USRAM.TB_TE_APC_OPER_PRSN_OTLN
			  WHERE 1=1
			  AND 	TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			    AND OGNZ_TYPE_CD = '1'
			    AND GVRMNT_SPRT_YN = 'Y'
			    AND CTPV_CD IS NOT NULL
			  UNION ALL
			 SELECT '통합조직 운영 APC' AS TITLE,
			        '통합조직' AS SUB_TITLE,
			        '통합조직_육성형' AS S0,
			        COUNT(1) AS S1 -- 통합조직_육성형
			   FROM USRAM.TB_TE_APC_OPER_PRSN_OTLN
			  WHERE 1=1
			  AND 	TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			    AND OGNZ_TYPE_CD = '2'
			    AND GVRMNT_SPRT_YN = 'Y'
			    AND CTPV_CD IS NOT NULL
			  UNION ALL
			 SELECT '통합조직 운영 APC' AS TITLE,
			        '통합조직' AS SUB_TITLE,
			        '소계(1)' AS S0,
			        COUNT(1) AS S1
			   FROM USRAM.TB_TE_APC_OPER_PRSN_OTLN
			  WHERE 1=1
			  AND 	TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			    AND OGNZ_TYPE_CD IN ('1','2')
			    AND GVRMNT_SPRT_YN = 'Y'
			    AND CTPV_CD IS NOT NULL
			  UNION ALL
			 SELECT '통합조직 운영 APC' AS TITLE,
			        '통합출자출하조직' AS SUB_TITLE,
			        '통합출자출하조직_승인형' AS S0,
			        COUNT(1) AS S1 -- 통합출자출하조직_승인형
			   FROM USRAM.TB_TE_APC_OPER_PRSN_OTLN
			  WHERE 1=1
			  AND 	TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			    AND OGNZ_TYPE_CD = '3'
			    AND GVRMNT_SPRT_YN = 'Y'
			    AND CTPV_CD IS NOT NULL
			  UNION ALL
			 SELECT '통합조직 운영 APC' AS TITLE,
			        '통합출자출하조직' AS SUB_TITLE,
			        '통합출자출하조직_육성형' AS S0,
			        COUNT(1) AS S1 -- 통합출자출하조직_육성형
			   FROM USRAM.TB_TE_APC_OPER_PRSN_OTLN
			  WHERE 1=1
			  AND 	TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			    AND OGNZ_TYPE_CD = '4'
			    AND GVRMNT_SPRT_YN = 'Y'
			    AND CTPV_CD IS NOT NULL
			  UNION ALL
			   SELECT '통합조직 운영 APC' AS TITLE,
			        '통합출자출하조직' AS SUB_TITLE,
			        '소계(2)' AS S0,
			        COUNT(1) AS S1 -- 통합조직_육성형
			   FROM USRAM.TB_TE_APC_OPER_PRSN_OTLN
			  WHERE 1=1
			  AND 	TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			    AND OGNZ_TYPE_CD IN ('3','4')
			    AND GVRMNT_SPRT_YN = 'Y'
			    AND CTPV_CD IS NOT NULL
			  UNION ALL
			 SELECT '통합조직 합계' AS TITLE,
			        '통합조직 합계' AS SUB_TITLE,
			        '통합조직 합계' AS S0,
			        COUNT(1) AS S1 -- 통합조직 합계
			   FROM USRAM.TB_TE_APC_OPER_PRSN_OTLN
			  WHERE 1=1
			  AND 	TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			    AND OGNZ_TYPE_CD IN('1',
			        '2',
			        '3',
			        '4')
			    AND GVRMNT_SPRT_YN = 'Y'
			    AND CTPV_CD IS NOT NULL
			  UNION ALL
			 SELECT '개별조직 합계' AS TITLE,
			        '개별조직 합계' AS SUB_TITLE,
			        '개별조직 합계' AS S0,
			        COUNT(1) AS S1 -- 개별조직 합계
			   FROM USRAM.TB_TE_APC_OPER_PRSN_OTLN
			  WHERE 1=1
			  AND 	TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			    AND OGNZ_TYPE_CD = '5'
			    AND GVRMNT_SPRT_YN = 'Y'
			    AND CTPV_CD IS NOT NULL
			  UNION ALL
			 SELECT '전체 합계' AS TITLE,
			        '전체 합계' AS SUB_TITLE,
			        '전체 합계' AS S0,
			        COUNT(1) AS S1 -- 전체 합계
			   FROM USRAM.TB_TE_APC_OPER_PRSN_OTLN
			  WHERE 1=1
			  AND 	TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			    AND GVRMNT_SPRT_YN = 'Y'
			    AND CTPV_CD IS NOT NULL;
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectBzeatCntOwnrAndOperGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 -개소수: 개소수:소유자 및 운영자 단건조회.	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntOwnrAndOperGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0
			      , SUM(S1) AS S1
			      , SUM(S2) AS S2
			      , SUM(S3) AS S3
			      , SUM(S4) AS S4
			      , SUM(S5) AS S5
			FROM  ( SELECT '통합조직운영 APC'                   AS S0
			              , CASE WHEN TYPE_CD = '1'   THEN 1 END AS S1
			              , CASE WHEN TYPE_CD = '2'   THEN 1 END AS S2
			              , CASE WHEN MB IS NOT NULL  THEN 1 END AS S3
			              , CASE WHEN MB IS NULL      THEN 1 END AS S4
			              , 1                                    AS S5
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			        WHERE   1=1
			        AND 	TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     GVRMNT_SPRT_YN = 'Y'
			        AND     OGNZ_TYPE_CD NOT IN ('5')
			        AND     CTPV_CD IS NOT NULL
			        UNION ALL
			        SELECT '개별조직운영 APC'                   AS S0
			              , CASE WHEN TYPE_CD = '1'   THEN 1 END AS S1
			              , CASE WHEN TYPE_CD = '2'   THEN 1 END AS S2
			              , CASE WHEN MB IS NOT NULL  THEN 1 END AS S3
			              , CASE WHEN MB IS NULL      THEN 1 END AS S4
			              , 1                                    AS S5
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN
			        WHERE   1=1
			        AND 	TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     GVRMNT_SPRT_YN = 'Y'
			        AND     OGNZ_TYPE_CD IN ('5')
			        AND     CTPV_CD IS NOT NULL)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectFcltEqpmntAllBdarGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - 총 건축면적 단건조회.						-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectFcltEqpmntAllBdarGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , ROUND(SUM(S1),0)            AS V1
			      , ROUND(SUM(S1) / SUM(A1),0)  AS V2
			      , ROUND(SUM(S2),0)            AS V3
			      , ROUND(SUM(S2) / SUM(A2),0)  AS V4
			      , ROUND(SUM(S3),0)            AS V5
			      , ROUND(SUM(S3) / SUM(A3),0)  AS V6
			FROM  ( SELECT '통합조직운영 APC'                                                 AS S0
			              , CASE WHEN A.MB IS NOT NULL  THEN
			                     NVL(B.CSP_TOT_AREA,0)  END AS S1
			              , CASE WHEN A.MB IS NOT NULL  THEN 1 END AS A1
			              , CASE WHEN A.MB IS NULL      THEN
			                     NVL(B.CSP_TOT_AREA,0)         END AS S2
			              , CASE WHEN A.MB IS NULL      THEN 1 END AS A2
			              , NVL(B.CSP_TOT_AREA,0) AS S3
			              , 1  AS A3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '개별조직운영 APC' AS S0
			              , CASE WHEN A.MB IS NOT NULL  THEN
			                     NVL(B.CSP_TOT_AREA,0)  END AS S1
			              , CASE WHEN A.MB IS NOT NULL  THEN 1 END AS A1
			              , CASE WHEN A.MB IS NULL      THEN
			                     NVL(B.CSP_TOT_AREA,0)  END AS S2
			              , CASE WHEN A.MB IS NULL      THEN 1 END AS A2
			              , NVL(B.CSP_TOT_AREA,0)  AS S3
			              , 1  AS A3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD = B.APC_CD)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectLgstcsGdsFcltBdarGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - 물류,상품화 시설(건축면적) 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectLgstcsGdsFcltBdarGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , ROUND(SUM(S1),0)            AS V1
			      , ROUND(SUM(S1) / SUM(A1),0)  AS V2
			      , ROUND(SUM(S2),0)            AS V3
			      , ROUND(SUM(S2) / SUM(A2),0)  AS V4
			      , ROUND(SUM(S3),0)            AS V5
			      , ROUND(SUM(S3) / SUM(A3),0)  AS V6
			FROM  ( SELECT '통합조직운영 APC' AS S0
			              , CASE WHEN A.MB IS NOT NULL THEN
			                NVL(B.CSP_CFPP_AREA,0) +
			                NVL(B.CSP_CLN_OPRTNG_PRCS_AREA,0) END AS S1
			              , CASE WHEN A.MB IS NOT NULL THEN 1 END AS A1
			              , CASE WHEN A.MB IS NULL     THEN
			                NVL(B.CSP_CFPP_AREA,0) +
			                NVL(B.CSP_CLN_OPRTNG_PRCS_AREA,0) END AS S2
			              , CASE WHEN A.MB IS NULL     THEN 1 END AS A2
			              , NVL(B.CSP_CFPP_AREA,0) +
			                NVL(B.CSP_CLN_OPRTNG_PRCS_AREA,0) AS S3
			              , 1 AS A3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD =  B.APC_CD
			        UNION ALL
			        SELECT '개별조직운영 APC' AS S0
			              , CASE WHEN A.MB IS NOT NULL THEN NVL(B.CSP_TOT_AREA,0) END AS S1
			              , CASE WHEN A.MB IS NOT NULL THEN 1 END AS A1
			              , CASE WHEN A.MB IS NULL     THEN NVL(B.CSP_TOT_AREA,0) END AS S2
			              , CASE WHEN A.MB IS NULL     THEN 1 END AS A2
			              , NVL(B.CSP_TOT_AREA,0) AS S3
			              , 1 AS A3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD    =  B.APC_CD)
			GROUP BY S0
			ORDER BY S0;
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectBzeatCntLwtpStrgGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - 저온저장고 단건조회.						-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntLwtpStrgGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , SUM(S1)                     AS V1
			      , SUM(S2)                     AS V2
			      , ROUND(SUM(S3),0)            AS V3
			      , ROUND(SUM(S3) / SUM(S2),0)  AS V4
			FROM  ( SELECT '통합조직운영 APC'                                                  AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) > 0 THEN 1 END           AS S2
			              , CASE WHEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) > 0 THEN
			                     NVL(B.STRG_PLC_LWTP_STRG_AREA,0) END						    AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD    =  B.APC_CD
			        UNION ALL
			        SELECT '개별조직운영 APC'                                          AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) > 0 THEN 1 END           AS S2
			              , CASE WHEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) > 0 THEN
			                     NVL(B.STRG_PLC_LWTP_STRG_AREA,0) END    						AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD    =  B.APC_CD)
			GROUP BY S0
			ORDER BY S0;
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectBzeatCntPrprtnClngFcltGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - 예냉시설 단건조회.							-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntPrprtnClngFcltGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                          AS V0   -- 구분
			      , SUM(S1)                     AS V1   -- APC 개소수
			      , SUM(S2)                     AS V2   -- 예냉시설 개소수
			      , ROUND(SUM(S3),0)            AS V3   -- 예냉시설 면적
			      , ROUND(SUM(S3) / SUM(S2),0)  AS V4   -- 예냉시설 평균면적
			FROM  ( SELECT '통합조직운영 APC'                                              AS S0
			              , 1                                                               AS S1
			              , CASE WHEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) > 0 THEN 1 END         AS S2
			              , CASE WHEN A.MB IS NULL THEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) END  AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD =  B.APC_CD
			        UNION ALL
			        SELECT '개별조직운영 APC'                                          AS S0
			              , 1                                                               AS S1
			              , CASE WHEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) > 0 THEN 1 END         AS S2
			              , CASE WHEN A.MB IS NULL THEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) END  AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD    =  B.APC_CD)
			GROUP BY S0
			ORDER BY S0;
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectBzeatCntStrgFcltGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - CA 저장시설 단건조회.						-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntStrgFcltGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , SUM(S1)                     AS V1
			      , SUM(S2)                     AS V2
			      , ROUND(SUM(S3),0)            AS V3
			      , ROUND(SUM(S3) / SUM(S2),0)  AS V4
			FROM  ( SELECT '통합조직운영 APC'                                                  AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) > 0 THEN 1 END         AS S2
			              , CASE WHEN A.MB IS NULL THEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) END  AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        AND     A.APC_CD =  B.APC_CD
			        UNION ALL
			        SELECT '개별조직운영 APC'                                          AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) > 0 THEN 1 END         AS S2
			              , CASE WHEN A.MB IS NULL THEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) END  AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.APC_CD =  B.APC_CD)
			GROUP BY S0
			ORDER BY S0;
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectBzeatCntFcltMsrmtEqpmntGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - 선별기, 측정장비 설치 개소 수 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntFcltMsrmtEqpmntGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                          AS V0
			      , SUM(S1)                     AS V1
			      , SUM(S2)                     AS V2
			      , SUM(S3)                     AS V3
			      , SUM(S4)                     AS V4
			      , SUM(S5)                     AS V5
			FROM  ( SELECT '통합조직운영 APC'                                          AS S0
			              , 1                                                           AS S1
			              , CASE WHEN B.SORT_MCHN_SPCFCT IS NOT NULL THEN 1 END         AS S2
			              , CASE WHEN B.SORT_BRCK_MCHN IS NOT NULL THEN 1 END           AS S3
			              , CASE WHEN B.COLOR_SORT IS NOT NULL THEN 1 END               AS S4
			              , CASE WHEN B.MNFC_MCHN IS NOT NULL THEN 1 END                AS S5

			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , MAX(SORT_MCHN_SPCFCT) AS SORT_MCHN_SPCFCT
			                      , MAX(SORT_BRCK_MCHN) AS SORT_BRCK_MCHN
			                      , MAX(COLOR_SORT) AS COLOR_SORT
			                      , MAX(MNFC_MCHN) AS MNFC_MCHN
			                FROM    USRAM.TB_TE_APC_FCLT_STTS_DTL
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        UNION ALL
			        SELECT '개별조직운영 APC'                                          AS S0
			              , 1                                                           AS S1
			              , CASE WHEN B.SORT_MCHN_SPCFCT IS NOT NULL THEN 1 END         AS S2
			              , CASE WHEN B.SORT_BRCK_MCHN IS NOT NULL THEN 1 END           AS S3
			              , CASE WHEN B.COLOR_SORT IS NOT NULL THEN 1 END               AS S4
			              , CASE WHEN B.MNFC_MCHN IS NOT NULL THEN 1 END                AS S5
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , MAX(SORT_MCHN_SPCFCT) AS SORT_MCHN_SPCFCT
			                      , MAX(SORT_BRCK_MCHN) AS SORT_BRCK_MCHN
			                      , MAX(COLOR_SORT) AS COLOR_SORT
			                      , MAX(MNFC_MCHN) AS MNFC_MCHN
			                FROM    USRAM.TB_TE_APC_FCLT_STTS_DTL
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD  =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0;
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectBzeatCntInvstAtmAllGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - 투자금액: 전체 단건조회.					-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntInvstAtmAllGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                                          AS V0
			      , SUM(S1)                                     AS V1
			      , ROUND(SUM(S2)/1000000,0)                    AS V2
			      , ROUND((SUM(S2)/SUM(S1))/1000000,0)          AS V3

			FROM  ( SELECT '통합조직운영 APC'                  AS S0
			              , 1                                   AS S1
			              , B.NE + B.LCLT_EXPND + B.SLF_BRDN    AS S2
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        UNION ALL
			        SELECT '개별조직운영 APC'                  AS S0
			              , 1                                   AS S1
			              , B.NE + B.LCLT_EXPND + B.SLF_BRDN    AS S2
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectBzeatCntInvstAtmFundTypeGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - 투자금액: 자금유형 단건조회.				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntInvstAtmFundTypeGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                                  AS V0
			      , ROUND(SUM(S1)/1000000,0)            AS V1
			      , ROUND(SUM(S2)/1000000,0)            AS V2
			      , ROUND(SUM(S3)/1000000,0)            AS V3
			      , ROUND(SUM(S4)/1000000,0)            AS V4

			FROM  ( SELECT '통합조직운영 APC'                  AS S0
			              , B.NE                                AS S1
			              , B.LCLT_EXPND                        AS S2
			              , B.SLF_BRDN                          AS S3
			              , B.NE + B.LCLT_EXPND + B.SLF_BRDN    AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        UNION ALL
			        SELECT '개별조직운영 APC'                  AS S0
			              , B.NE                                AS S1
			              , B.LCLT_EXPND                        AS S2
			              , B.SLF_BRDN                          AS S3
			              , B.NE + B.LCLT_EXPND + B.SLF_BRDN    AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectBzeatCntInvstAtmOwnrGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - 투자금액: 소유자 단건조회.					-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntInvstAtmOwnrGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                                  AS V0
			      , SUM(S1)                             AS V1
			      , ROUND(SUM(S2)/1000000,0)            AS V2
			      , ROUND((SUM(S2)/SUM(S1))/1000000,0)  AS V3
			      , SUM(S3)                             AS V4
			      , ROUND(SUM(S4)/1000000,0)            AS V5
			      , ROUND((SUM(S4)/SUM(S3))/1000000,0)  AS V6

			FROM  ( SELECT '통합조직운영 APC'                        AS S0
			              , CASE WHEN A.TYPE_CD = '1' THEN 1 END      AS S1
			              , CASE WHEN A.TYPE_CD = '1' THEN B.AMT END  AS S2
			              , CASE WHEN A.TYPE_CD = '2' THEN 1 END      AS S3
			              , CASE WHEN A.TYPE_CD = '2' THEN B.AMT END  AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE+LCLT_EXPND+SLF_BRDN) AS AMT
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        UNION ALL
			        SELECT '개별조직운영 APC'                  AS S0
			              , CASE WHEN A.TYPE_CD = '1' THEN 1 END      AS S1
			              , CASE WHEN A.TYPE_CD = '1' THEN B.AMT END  AS S2
			              , CASE WHEN A.TYPE_CD = '2' THEN 1 END      AS S3
			              , CASE WHEN A.TYPE_CD = '2' THEN B.AMT END  AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE+LCLT_EXPND+SLF_BRDN) AS AMT
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0;
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectBzeatCntInvstOperPrsnGridList	-->
	<!-- DESC : 정부지원 산지유통시설 현황 - 투자금액: 운영자 단건조회.					-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.17  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectBzeatCntInvstOperPrsnGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                                  AS V0
			      , SUM(S1)                             AS V1
			      , ROUND(SUM(S2)/1000000,0)            AS V2
			      , ROUND((SUM(S2)/SUM(S1))/1000000,0)  AS V3
			      , SUM(S3)                             AS V4
			      , ROUND(SUM(S4)/1000000,0)            AS V5
			      , ROUND((SUM(S4)/SUM(S3))/1000000,0)  AS V6

			FROM  ( SELECT '통합조직운영 APC'                          AS S0
			              , CASE WHEN A.MB IS NOT NULL THEN 1 END       AS S1
			              , CASE WHEN A.MB IS NOT NULL THEN B.AMT END   AS S2
			              , CASE WHEN A.MB IS NULL THEN 1 END           AS S3
			              , CASE WHEN A.MB IS NULL THEN B.AMT END       AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE+LCLT_EXPND+SLF_BRDN) AS AMT
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD NOT IN ('5')
			        UNION ALL
			        SELECT '개별조직운영 APC'                  AS S0
			              , CASE WHEN A.MB IS NOT NULL THEN 1 END       AS S1
			              , CASE WHEN A.MB IS NOT NULL THEN B.AMT END   AS S2
			              , CASE WHEN A.MB IS NULL THEN 1 END           AS S3
			              , CASE WHEN A.MB IS NULL THEN B.AMT END       AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			              ,(SELECT  APC_CD
			                      , SUM(NE+LCLT_EXPND+SLF_BRDN) AS AMT
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			        AND     A.OGNZ_TYPE_CD IN ('5'))
			GROUP BY S0
			ORDER BY S0;
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectGvrngmtSprtMdRtlOgnzTypeGridList	-->
	<!-- DESC : 정부지원산지유통시설지역별현황 - 지역별 개소수 : 산지유통조직 유형 단건조회.-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectGvrngmtSprtMdRtlOgnzTypeGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)			AS V0
			      , SUM(S1)     						AS V1
			      , SUM(S2)     						AS V2
			      , SUM(S3)     						AS V3
			      , SUM(S4)     						AS V4
			      , SUM(S5)     						AS V5
			      , SUM(S6)     						AS V6
			      , SUM(S7)     						AS V7
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND A.TYPE_CD = '1' THEN 1 END    AS S1
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND A.TYPE_CD = '2' THEN 1 END    AS S2
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND A.TYPE_CD = '1' THEN 1 END        AS S3
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND A.TYPE_CD = '2' THEN 1 END        AS S4
			              , CASE WHEN A.TYPE_CD = '1' THEN 1 END                                    AS S5
			              , CASE WHEN A.TYPE_CD = '2' THEN 1 END                                    AS S6
			              , 1                                                                       AS S7
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL)
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectGvrngmtSprtRgnOperPrsnGridList	-->
	<!-- DESC : 정부지원산지유통시설지역별현황 - 지역별 개소수 : 운영자 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectGvrngmtSprtRgnOperPrsnGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)			AS V0
			      , SUM(S1)     						AS V1
			      , SUM(S2)     						AS V2
			      , SUM(S3)     						AS V3
			      , SUM(S4)     						AS V4
			      , SUM(S5)     						AS V5
			      , SUM(S6)     						AS V6
			      , SUM(S7)     						AS V7
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND A.MB IS NOT NULL THEN 1 END   AS S1
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND A.MB IS NULL THEN 1 END       AS S2
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND A.MB IS NOT NULL THEN 1 END       AS S3
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND A.MB IS NULL THEN 1 END           AS S4
			              , CASE WHEN A.MB IS NOT NULL THEN 1 END                                   AS S5
			              , CASE WHEN A.MB IS NULL THEN 1 END                                       AS S6
			              , 1                                                                       AS S7
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL)
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectGvrngmtSprtLgstcsGdsFcltGridList	-->
	<!-- DESC : 정부지원산지유통시설지역별현황 - 물류·상품화 시설 단건조회.				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectGvrngmtSprtLgstcsGdsFcltGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)			AS V0
			      , NVL(ROUND(SUM(S1),0),0)             AS V1
			      , NVL(ROUND(SUM(S1)/SUM(S2),0),0)     AS V2
			      , NVL(ROUND(SUM(S3),0),0)             AS V3
			      , NVL(ROUND(SUM(S3)/SUM(S4),0),0)     AS V4
			      , NVL(ROUND(SUM(S5),0),0)             AS V5
			      , NVL(ROUND(SUM(S5)/SUM(S6),0),0)     AS V6
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN
			                     NVL(B.CSP_CFPP_AREA,0) +
			                     NVL(B.CSP_CLN_OPRTNG_PRCS_AREA,0) END              AS S1
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN 1 END        AS S2
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN
			                     NVL(B.CSP_CFPP_AREA,0) +
			                     NVL(B.CSP_CLN_OPRTNG_PRCS_AREA,0) END              AS S3
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN 1 END            AS S4
			              , NVL(B.CSP_CFPP_AREA,0) +
			                NVL(B.CSP_CLN_OPRTNG_PRCS_AREA,0)                       AS S5
			              , 1                                                       AS S6
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+))
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectGvrngmtSprtLwtpStrgGridList	-->
	<!-- DESC : 정부지원산지유통시설지역별현황 - 저온저장고 단건조회.					-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectGvrngmtSprtLwtpStrgGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)		   AS V0
			      , NVL(ROUND(SUM(S1),0),0)            AS V1
			      , NVL(ROUND(SUM(S2),0),0)            AS V2
			      , NVL(ROUND(SUM(S3),0),0)            AS V3
			      , NVL(ROUND(SUM(S3)/SUM(S2),0),0)    AS V4
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			           	  , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) > 0 THEN 1 ELSE 0 END    AS S2
			              , CASE WHEN NVL(B.STRG_PLC_LWTP_STRG_AREA,0) > 0 THEN
			                     NVL(B.STRG_PLC_LWTP_STRG_AREA,0) END                           AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+))
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectGvrngmtSprtPrprtnClngFcltGridList	-->
	<!-- DESC : 정부지원산지유통시설지역별현황 - 예냉시설 단건조회.						-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectGvrngmtSprtPrprtnClngFcltGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)		   AS V0
			      , NVL(ROUND(SUM(S1),0),0)            AS V1
			      , NVL(ROUND(SUM(S2),0),0)            AS V2
			      , NVL(ROUND(SUM(S3),0),0)            AS V3
			      , NVL(ROUND(SUM(S3)/SUM(S2),0),0)    AS V4
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) > 0 THEN 1 ELSE 0 END      AS S2
			              , CASE WHEN NVL(B.STRG_PLC_PRC_PLC_AREA,0) > 0 THEN
			                     NVL(B.STRG_PLC_PRC_PLC_AREA,0) END                             AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD   IS NOT NULL
			        AND     A.APC_CD    =  B.APC_CD(+))
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectGvrngmtSprtStrgFcltGridList	-->
	<!-- DESC : 정부지원산지유통시설지역별현황 - CA저장시설 단건조회.					-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectGvrngmtSprtStrgFcltGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)		AS V0
			      , NVL(ROUND(SUM(S1),0),0)         AS V1
			      , NVL(ROUND(SUM(S2),0),0)         AS V2
			      , NVL(ROUND(SUM(S3),0),0)         AS V3
			      , NVL(ROUND(SUM(S3)/SUM(S2),0),0) AS V4
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , 1                                                                   AS S1
			              , CASE WHEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) > 0 THEN 1 ELSE 0 END  AS S2
			              , CASE WHEN NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) > 0 THEN
			                     NVL(B.STRG_PLC_CA_STRG_PLC_AREA,0) END                         AS S3
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_FCLT_STTS B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD   IS NOT NULL
			        AND     A.APC_CD    =  B.APC_CD(+))
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectGvrngmtSprtFcltMsrmtEqpmntGridList	-->
	<!-- DESC : 정부지원산지유통시설지역별현황 - 선별기, 특정장비 설치 개소수 단건조회.	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectGvrngmtSprtFcltMsrmtEqpmntGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)		   AS V0
			      , NVL(ROUND(SUM(S1),0),0)            AS V1
			      , NVL(ROUND(SUM(S2),0),0)            AS V2
			      , NVL(ROUND(SUM(S3),0),0)            AS V3
			      , NVL(ROUND(SUM(S3)/SUM(S2),0),0)    AS V4
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , 1                                                           AS S1
			              , CASE WHEN B.SORT_MCHN_SPCFCT IS NOT NULL THEN 1 END         AS S2
			              , CASE WHEN B.SORT_BRCK_MCHN = 'Y'         THEN 1 END         AS S3
			              , CASE WHEN B.COLOR_SORT = 'Y'             THEN 1 END         AS S4
			              , CASE WHEN B.MNFC_MCHN IS NOT NULL        THEN 1 END         AS S5

			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			               (SELECT  APC_CD
			                      , MAX(SORT_MCHN_SPCFCT) AS SORT_MCHN_SPCFCT
			                      , MAX(SORT_BRCK_MCHN) AS SORT_BRCK_MCHN
			                      , MAX(COLOR_SORT) AS COLOR_SORT
			                      , MAX(MNFC_MCHN) AS MNFC_MCHN
			                FROM    USRAM.TB_TE_APC_FCLT_STTS_DTL
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD = B.APC_CD(+))
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectGvrngmtSprtRgnInvstAtmAllGridList	-->
	<!-- DESC : 정부지원산지유통시설지역별현황 - 지역별 투자금액 전체 단건조회.			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectGvrngmtSprtRgnInvstAtmAllGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)					AS V0
			      , NVL(SUM(S1),0)                              AS V1
			      , NVL(ROUND(SUM(S2)/1000000,0),0)             AS V2
			      , NVL(ROUND(SUM(S3)/1000000,0),0)             AS V3
			      , NVL(ROUND(SUM(S4)/1000000,0),0)             AS V4
			      , NVL(ROUND(SUM(S5)/1000000,0),0)             AS V5
			      , NVL(ROUND((SUM(S5)/SUM(S1))/1000000,0),0)   AS V6
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , 1                               AS S1
			              , B.NE                            AS S2
			              , B.LCLT_EXPND                    AS S3
			              , B.SLF_BRDN                      AS S4
			              , B.NE+B.LCLT_EXPND+B.SLF_BRDN    AS S5
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			               (SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+))
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectMdInvstAtmOwnrGridList	-->
	<!-- DESC : 정부지원산지유통시설지역별현황 - 지역별 투자금액 : 소유자 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectMdInvstAtmOwnrGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)					AS V0
			      , NVL(SUM(S1),0)                              AS V1
			      , NVL(ROUND(SUM(S2)/1000000,0),0)             AS V2
			      , CASE WHEN SUM(S1) > 0 THEN NVL(ROUND((SUM(S2)/SUM(S1))/1000000,0),0)
			             ELSE 0 END                             AS V3
			      , NVL(SUM(S3),0)                              AS V4
			      , NVL(ROUND(SUM(S4)/1000000,0),0)             AS V5
			      , CASE WHEN SUM(S3) > 0 THEN NVL(ROUND((SUM(S4)/SUM(S3))/1000000,0),0)
			             ELSE 0 END                             AS V6   -- 공공 평균투자액
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , CASE WHEN A.TYPE_CD = '1' THEN 1 ELSE 0 END                                 AS S1
			              , CASE WHEN A.TYPE_CD = '1' THEN B.NE + B.LCLT_EXPND + B.SLF_BRDN ELSE 0 END  AS S2
			              , CASE WHEN A.TYPE_CD = '2' THEN 1 ELSE 0 END                                 AS S3
			              , CASE WHEN A.TYPE_CD = '2' THEN B.NE + B.LCLT_EXPND + B.SLF_BRDN ELSE 0 END  AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			               (SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			      )
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectMdInvstAtmOperPrsnGridList	-->
	<!-- DESC : 정부지원산지유통시설지역별현황 - 지역별 투자금액 : 운영자 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectMdInvstAtmOperPrsnGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)					AS V0
			      , NVL(SUM(S1),0)                              AS V1
			      , NVL(ROUND(SUM(S2)/1000000,0),0)             AS V2
			      , CASE WHEN SUM(S1) > 0 THEN NVL(ROUND((SUM(S2)/SUM(S1))/1000000,0),0)
			             ELSE 0 END                             AS V3
			      , NVL(SUM(S3),0)                              AS V4
			      , NVL(ROUND(SUM(S4)/1000000,0),0)             AS V5
			      , CASE WHEN SUM(S3) > 0 THEN NVL(ROUND((SUM(S4)/SUM(S3))/1000000,0),0)
			             ELSE 0 END                             AS V6   -- 법인 평균투자액
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , CASE WHEN A.MB IS NOT NULL THEN 1 ELSE 0 END                                AS S1
			              , CASE WHEN A.MB IS NOT NULL THEN B.NE + B.LCLT_EXPND + B.SLF_BRDN ELSE 0 END AS S2
			              , CASE WHEN A.MB IS NULL THEN 1 ELSE 0 END                                    AS S3
			              , CASE WHEN A.MB IS NULL THEN B.NE + B.LCLT_EXPND + B.SLF_BRDN ELSE 0 END     AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			               (SELECT  APC_CD
			                      , SUM(NE) AS NE
			                      , SUM(LCLT_EXPND) AS LCLT_EXPND
			                      , SUM(SLF_BRDN) AS SLF_BRDN
			                FROM    USRAM.TB_TE_APC_FCLT_INSTL_SPLMNT
			                GROUP BY APC_CD) B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD =  B.APC_CD(+)
			      )
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectOperOgnzTrmtPrfmncGridList	-->
	<!-- DESC : 산지유통시설운영실적 - 운영조직 취급실적 단건조회.						-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectOperOgnzTrmtPrfmncGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                              AS V0
			      , ROUND(SUM(S1),0)                AS V1
			      , ROUND(SUM(S1)/SUM(A1),0)        AS V2
			      , ROUND(SUM(S2),0)                AS V3
			      , ROUND(SUM(S2)/SUM(A1),0)        AS V4
			FROM  ( SELECT '1통합조직 농협'         AS S0
						  , (SELECT  SUM(X.APC_OPER_AMT)
                 			   FROM   USRAM.TB_TE_APC_OPER_PRFMNC_DTL X
                    		  WHERE   X.APC_CD = A.APC_CD
                 				AND   X.ITEM_NM NOT IN ('맥류-기타','미곡류-기타','버섯-기타',
                                           '벼종자',
                                           '잡곡류-기타',
                                           '특용작물류-기타',
                                           '표고버섯'
                                        		 )) AS S1
			              , 1                       AS A1
			              , B.RTL_OGNZ_OGNZ_SUM     AS S2
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('1','2','3','4')
			        AND     A.MB IS NOT NULL
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '2통합조직 농업법인'     AS S0
			              , (SELECT  SUM(X.APC_OPER_AMT)
                 			   FROM   USRAM.TB_TE_APC_OPER_PRFMNC_DTL X
                    		  WHERE   X.APC_CD = A.APC_CD
                 				AND   X.ITEM_NM NOT IN ('맥류-기타','미곡류-기타','버섯-기타',
                                           '벼종자',
                                           '잡곡류-기타',
                                           '특용작물류-기타',
                                           '표고버섯'
                                        		 )) AS S1
			              , 1                       AS A1
			              , B.RTL_OGNZ_OGNZ_SUM     AS S2
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('1','2','3','4')
			        AND     A.MB IS NULL
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '3개별조직 농협'         AS S0
			              , (SELECT  SUM(X.APC_OPER_AMT)
                 			   FROM   USRAM.TB_TE_APC_OPER_PRFMNC_DTL X
                    		  WHERE   X.APC_CD = A.APC_CD
                 				AND   X.ITEM_NM NOT IN ('맥류-기타','미곡류-기타','버섯-기타',
                                           '벼종자',
                                           '잡곡류-기타',
                                           '특용작물류-기타',
                                           '표고버섯'
                                        		 )) AS S1
			              , 1                       AS A1
			              , B.RTL_OGNZ_OGNZ_SUM     AS S2
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.MB IS NOT NULL
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '4개별조직 농업법인'     AS S0
			              , (SELECT  SUM(X.APC_OPER_AMT)
                 			   FROM   USRAM.TB_TE_APC_OPER_PRFMNC_DTL X
                    		  WHERE   X.APC_CD = A.APC_CD
                 				AND   X.ITEM_NM NOT IN ('맥류-기타','미곡류-기타','버섯-기타',
                                           '벼종자',
                                           '잡곡류-기타',
                                           '특용작물류-기타',
                                           '표고버섯'
                                        		 )) AS S1
			              , 1                       AS A1
			              , B.RTL_OGNZ_OGNZ_SUM     AS S2
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.MB IS NULL
			        AND     A.APC_CD = B.APC_CD )
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectOperOgnzPrcsPrfmncGridList	-->
	<!-- DESC : 산지유통시설운영실적 - 운영조직 처리실적 단건조회.						-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectOperOgnzPrcsPrfmncGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                              AS V0
			      , ROUND(SUM(S1),0)                AS V1
			      , ROUND(SUM(S2),0)                AS V2
			      , ROUND(SUM(S3),0)                AS V3
			      , ROUND(SUM(S4),0)                AS V4
			FROM  ( SELECT '1통합조직 농협'                 AS S0
			              , (SELECT SUM(X.APC_TRMT_AMT)
                              FROM TB_TE_APC_OPER_PRFMNC_DTL X
                             WHERE 1=1
                               AND X.APC_CD = A.APC_CD)     AS S1
			              , B.APC_GNRL_TRMT_AMT             AS S2
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST  AS S3
			              , B.APC_APC_CTRT_EMSPAP           AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'

			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[

			        AND     A.OGNZ_TYPE_CD IN ('1','2','3','4')
			        AND     A.MB IS NOT NULL
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '2통합조직 농업법인'     AS S0
			              , (SELECT SUM(X.APC_TRMT_AMT)
                              FROM TB_TE_APC_OPER_PRFMNC_DTL X
                             WHERE 1=1
                               AND X.APC_CD = A.APC_CD)     AS S1
			              , B.APC_GNRL_TRMT_AMT             AS S2
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST  AS S3
			              , B.APC_APC_CTRT_EMSPAP           AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'

			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[

			        AND     A.OGNZ_TYPE_CD IN ('1','2','3','4')
			        AND     A.MB IS NULL
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '3개별조직 농협'         AS S0
			              , (SELECT SUM(X.APC_TRMT_AMT)
                              FROM TB_TE_APC_OPER_PRFMNC_DTL X
                             WHERE 1=1
                               AND X.APC_CD = A.APC_CD)     AS S1
			              , B.APC_GNRL_TRMT_AMT             AS S2
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST  AS S3
			              , B.APC_APC_CTRT_EMSPAP           AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'

			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[

			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.MB IS NOT NULL
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '4개별조직 농업법인'     AS S0
			              , (SELECT SUM(X.APC_TRMT_AMT)
                              FROM TB_TE_APC_OPER_PRFMNC_DTL X
                             WHERE 1=1
                               AND X.APC_CD = A.APC_CD)     AS S1
			              , B.APC_GNRL_TRMT_AMT             AS S2
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST  AS S3
			              , B.APC_APC_CTRT_EMSPAP           AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'

			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[

			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.MB IS NULL
			        AND     A.APC_CD = B.APC_CD )
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectOperOgnzAvgTrmtPrfmncGridList	-->
	<!-- DESC : 산지유통시설운영실적 - 운영조직 평균 취급실적 단건조회.					-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectOperOgnzAvgTrmtPrfmncGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                              AS V0
			      , ROUND(SUM(S1)/SUM(A1),0)        AS V1
			      , ROUND(SUM(S2)/SUM(A1),0)        AS V2
			      , ROUND(SUM(S3)/SUM(A1),0)        AS V3
			      , ROUND(SUM(S4)/SUM(A1),0)        AS V4
			FROM  ( SELECT '1통합조직 농협'                 AS S0
			              , B.APC_APC_TRMT_AMT              AS S1
			              , B.APC_GNRL_TRMT_AMT             AS S2
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST  AS S3
			              , B.APC_APC_CTRT_EMSPAP           AS S4
			              , 1                               AS A1
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('1','2','3','4')
			        AND     A.MB IS NOT NULL
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '2통합조직 농업법인'             AS S0
			              , B.APC_APC_TRMT_AMT              AS S1
			              , B.APC_GNRL_TRMT_AMT             AS S2
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST  AS S3
			              , B.APC_APC_CTRT_EMSPAP           AS S4
			              , 1                               AS A1
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
			]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.MB IS NULL
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '3개별조직 농협'         AS S0
			              , B.APC_APC_TRMT_AMT              AS S1
			              , B.APC_GNRL_TRMT_AMT             AS S2
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST  AS S3
			              , B.APC_APC_CTRT_EMSPAP           AS S4
			              , 1                               AS A1
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.MB IS NOT NULL
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '4개별조직 농업법인'     AS S0
			              , B.APC_APC_TRMT_AMT              AS S1
			              , B.APC_GNRL_TRMT_AMT             AS S2
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST  AS S3
			              , B.APC_APC_CTRT_EMSPAP           AS S4
			              , 1                               AS A1
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.MB IS NULL
			        AND     A.APC_CD = B.APC_CD )
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectMdOperOgnzTrmtPrfmncGridList	-->
	<!-- DESC : 산지유통시설운영실적 - 지역별 운영조직 취급실적 단건조회.							-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectMdOperOgnzTrmtPrfmncGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)			AS V0
			      , ROUND(SUM(S1),0)     				AS V1
			      , ROUND(SUM(S2),0)     				AS V2
			      , ROUND(SUM(S1)+SUM(S2),0)     				AS V3
			      , ROUND(SUM(S4),0)     				AS V4
			      , ROUND(SUM(S5),0)     				AS V5
			      , ROUND(SUM(S6),0)     				AS V6
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN
							(SELECT  SUM(X.APC_OPER_AMT)
                 			   FROM    USRAM.TB_TE_APC_OPER_PRFMNC_DTL X
                 			   WHERE   X.APC_CD = A.APC_CD
                 			   AND     X.ITEM_NM NOT IN ('맥류-기타','미곡류-기타','버섯-기타',
                                           '벼종자',
                                           '잡곡류-기타',
                                           '특용작물류-기타',
                                           '표고버섯'
                                           )) END  AS S1
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN B.RTL_OGNZ_TOT_TRMT_AMT END      AS S2
			              , B.RTL_OGNZ_TOT_TRMT_AMT                                                 AS S3
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN B.RTL_OGNZ_OGNZ_SUM END      AS S4
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN B.RTL_OGNZ_OGNZ_SUM END          AS S5
			              , B.RTL_OGNZ_OGNZ_SUM                                                     AS S6
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD = B.APC_CD)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectMdOperOgnzTrmtPrfmncAvgGridList	-->
	<!-- DESC : 산지유통시설운영실적 - 지역별 운영조직 취급실적(평균) 단건조회.						-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectMdOperOgnzTrmtPrfmncAvgGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)			AS V0
			      , ROUND(SUM(S1)/SUM(A1),0)     		AS V1
			      , ROUND(SUM(S2)/SUM(A2),0)     		AS V2
			      , ROUND(SUM(S3)/SUM(A3),0)     		AS V3
			      , ROUND(SUM(S4)/SUM(A4),0)     		AS V4
			      , ROUND(SUM(S5)/SUM(A5),0)     		AS V5
			      , ROUND(SUM(S6)/SUM(A6),0)     		AS V6
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN (SELECT  SUM(X.APC_OPER_AMT)
                 FROM    USRAM.TB_TE_APC_OPER_PRFMNC_DTL X
                 WHERE   X.APC_CD = A.APC_CD
                 AND     X.ITEM_NM NOT IN ('맥류-기타','미곡류-기타','버섯-기타',
                                           '벼종자',
                                           '잡곡류-기타',
                                           '특용작물류-기타',
                                           '표고버섯'
                                           )) END              AS S1
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN (SELECT  SUM(X.APC_OPER_AMT)
                 FROM    USRAM.TB_TE_APC_OPER_PRFMNC_DTL X
                 WHERE   X.APC_CD = A.APC_CD
                 AND     X.ITEM_NM NOT IN ('맥류-기타','미곡류-기타','버섯-기타',
                                           '벼종자',
                                           '잡곡류-기타',
                                           '특용작물류-기타',
                                           '표고버섯'
                                           )) END                  AS S2
			              , (SELECT  SUM(X.APC_OPER_AMT)
                 FROM    USRAM.TB_TE_APC_OPER_PRFMNC_DTL X
                 WHERE   X.APC_CD = A.APC_CD
                 AND     X.ITEM_NM NOT IN ('맥류-기타','미곡류-기타','버섯-기타',
                                           '벼종자',
                                           '잡곡류-기타',
                                           '특용작물류-기타',
                                           '표고버섯'
                                           ))                                                             AS S3
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN B.RTL_OGNZ_OGNZ_SUM END                  AS S4
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN B.RTL_OGNZ_OGNZ_SUM END                      AS S5
			              , B.RTL_OGNZ_OGNZ_SUM                                                                 AS S6
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND B.RTL_OGNZ_TOT_TRMT_AMT > 0 THEN 1 END    AS A1
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND B.RTL_OGNZ_TOT_TRMT_AMT > 0  THEN 1 END       AS A2
			              , CASE WHEN B.RTL_OGNZ_TOT_TRMT_AMT > 0  THEN 1 END                                   AS A3
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND B.RTL_OGNZ_OGNZ_SUM > 0 THEN 1 END        AS A4
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND B.RTL_OGNZ_OGNZ_SUM > 0 THEN 1 END            AS A5
			              , CASE WHEN B.RTL_OGNZ_OGNZ_SUM > 0 THEN 1 END                                        AS A6
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD = B.APC_CD)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectMdApcPrcsPrfmncGridList	-->
	<!-- DESC : 산지유통시설운영실적 - 지역별 APC 처리실적 단건조회.							-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectMdApcPrcsPrfmncGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)			AS V0
			      , ROUND(SUM(S1),0)     				AS V1
			      , ROUND(SUM(S2),0)     				AS V2
			      , ROUND(SUM(S3),0)     				AS V3
			      , ROUND(SUM(S4),0)     				AS V4
			      , ROUND(SUM(S5),0)     				AS V5
			      , ROUND(SUM(S6),0)     				AS V6
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN (SELECT SUM(X.APC_TRMT_AMT)
                              FROM TB_TE_APC_OPER_PRFMNC_DTL X
                             WHERE 1=1
                               AND X.APC_CD = A.APC_CD) END                              								        AS S1
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN (SELECT SUM(X.APC_TRMT_AMT)
                              FROM TB_TE_APC_OPER_PRFMNC_DTL X
                             WHERE 1=1
                               AND X.APC_CD = A.APC_CD) END								                                        AS S2
			              , (SELECT SUM(X.APC_TRMT_AMT)
                              FROM TB_TE_APC_OPER_PRFMNC_DTL X
                             WHERE 1=1
                               AND X.APC_CD = A.APC_CD)                                                                         AS S3
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN B.APC_APC_OGNZ_CPRTN_SORT_TRST+B.APC_APC_CTRT_EMSPAP END AS S4
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN B.APC_APC_OGNZ_CPRTN_SORT_TRST+B.APC_APC_CTRT_EMSPAP END     AS S5
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST+B.APC_APC_CTRT_EMSPAP                                                AS S6
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'

		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[

			        AND     A.APC_CD = B.APC_CD)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectMdApcPrcsPrfmncAvgGridList	-->
	<!-- DESC : 산지유통시설운영실적 - 지역별 APC 처리실적(평균) 단건조회.						-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectMdApcPrcsPrfmncAvgGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)	 AS V0
			      , ROUND(SUM(S1)/SUM(A1),0)     AS V1
			      , ROUND(SUM(S2)/SUM(A1),0)     AS V2
			      , ROUND(SUM(S3)/SUM(A1),0)     AS V3
			      , ROUND(SUM(S4)/SUM(A1),0)     AS V4
			      , ROUND(SUM(S5)/SUM(A1),0)     AS V5
			      , ROUND(SUM(S6)/SUM(A1),0)     AS V6
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN (SELECT SUM(X.APC_TRMT_AMT)
                              FROM TB_TE_APC_OPER_PRFMNC_DTL X
                             WHERE 1=1
                               AND X.APC_CD = A.APC_CD) END									                                                AS S1
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN (SELECT SUM(X.APC_TRMT_AMT)
                              FROM TB_TE_APC_OPER_PRFMNC_DTL X
                             WHERE 1=1
                               AND X.APC_CD = A.APC_CD) END								                                                    AS S2
			              , (SELECT SUM(X.APC_TRMT_AMT)
                              FROM TB_TE_APC_OPER_PRFMNC_DTL X
                             WHERE 1=1
                               AND X.APC_CD = A.APC_CD)                                                                                     AS S3
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN B.APC_APC_OGNZ_CPRTN_SORT_TRST+B.APC_APC_CTRT_EMSPAP END             AS S4
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN B.APC_APC_OGNZ_CPRTN_SORT_TRST+B.APC_APC_CTRT_EMSPAP END                 AS S5
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST+B.APC_APC_CTRT_EMSPAP                                                            AS S6

			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND B.APC_APC_TRMT_AMT > 0 THEN 1 END                                     AS A1
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND B.APC_APC_TRMT_AMT > 0 THEN 1 END                                         AS A2
			              , CASE WHEN B.APC_APC_TRMT_AMT > 0 THEN 1 END                                                                     AS A3
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND B.APC_APC_OGNZ_CPRTN_SORT_TRST+B.APC_APC_CTRT_EMSPAP > 0 THEN 1 END   AS A4
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND B.APC_APC_OGNZ_CPRTN_SORT_TRST+B.APC_APC_CTRT_EMSPAP > 0 THEN 1 END       AS A5
			              , CASE WHEN B.APC_APC_OGNZ_CPRTN_SORT_TRST+B.APC_APC_CTRT_EMSPAP > 0 THEN 1 END                                   AS A6
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'

		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[

			        AND     A.APC_CD = B.APC_CD)
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectGvrngmtSprtOperOgnzTrmtPrfmncGridList	-->
	<!-- DESC : 정부지원 지역별 운영실적 - 운영조직 취급실적 단건조회.					-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectGvrngmtSprtOperOgnzTrmtPrfmncGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                              AS V0
			      , ROUND(SUM(S1),0)                AS V1
			      , ROUND(SUM(S1)/SUM(A1),0)        AS V2
			      , ROUND(SUM(S2),0)                AS V3
			      , ROUND(SUM(S2)/SUM(A1),0)        AS V4
			FROM  ( SELECT '1통합조직 농협'         AS S0
			              , B.RTL_OGNZ_TOT_TRMT_AMT AS S1
			              , 1                       AS A1
			              , B.RTL_OGNZ_OGNZ_SUM     AS S2
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('1','2','3','4')
			        AND     A.GVRMNT_SPRT_YN  = 'Y'
			        AND     A.MB IS NOT NULL
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '2통합조직 농업법인'     AS S0
			              , B.RTL_OGNZ_TOT_TRMT_AMT AS S1
			              , 1                       AS A1
			              , B.RTL_OGNZ_OGNZ_SUM     AS S2
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('1','2','3','4')
			        AND     A.GVRMNT_SPRT_YN  = 'Y'
			        AND     A.MB IS NULL
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '3개별조직 농협'         AS S0
			              , B.RTL_OGNZ_TOT_TRMT_AMT AS S1
			              , 1                       AS A1
			              , B.RTL_OGNZ_OGNZ_SUM     AS S2
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.GVRMNT_SPRT_YN  = 'Y'
			        AND     A.MB IS NOT NULL
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '4개별조직 농업법인'     AS S0
			              , B.RTL_OGNZ_TOT_TRMT_AMT AS S1
			              , 1                       AS A1
			              , B.RTL_OGNZ_OGNZ_SUM     AS S2
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.GVRMNT_SPRT_YN  = 'Y'
			        AND     A.MB IS NULL
			        AND     A.APC_CD = B.APC_CD )
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectMdRtlFcltPrcsPrfmncGridList	-->
	<!-- DESC : 정부지우너 지역별 운영실적 - 산지유통시설 처리실적 단건조회.				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectMdRtlFcltPrcsPrfmncGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                              AS V0
			      , ROUND(SUM(S1),0)                AS V1
			      , ROUND(SUM(S2),0)                AS V2
			      , ROUND(SUM(S3),0)                AS V3
			      , ROUND(SUM(S4),0)                AS V4
			FROM  ( SELECT '1통합조직 농협'                 AS S0
			              , B.APC_APC_TRMT_AMT              AS S1
			              , B.APC_GNRL_TRMT_AMT             AS S2
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST  AS S3
			              , B.APC_APC_CTRT_EMSPAP           AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('1','2','3','4')
			        AND     A.GVRMNT_SPRT_YN  = 'Y'
			        AND     A.MB IS NOT NULL
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '2통합조직 농업법인'     AS S0
			              , B.APC_APC_TRMT_AMT              AS S1
			              , B.APC_GNRL_TRMT_AMT             AS S2
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST  AS S3
			              , B.APC_APC_CTRT_EMSPAP           AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('1','2','3','4')
			        AND     A.GVRMNT_SPRT_YN  = 'Y'
			        AND     A.MB IS NULL
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '3개별조직 농협'         AS S0
			              , B.APC_APC_TRMT_AMT              AS S1
			              , B.APC_GNRL_TRMT_AMT             AS S2
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST  AS S3
			              , B.APC_APC_CTRT_EMSPAP           AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.GVRMNT_SPRT_YN  = 'Y'
			        AND     A.MB IS NOT NULL
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '4개별조직 농업법인'     AS S0
			              , B.APC_APC_TRMT_AMT              AS S1
			              , B.APC_GNRL_TRMT_AMT             AS S2
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST  AS S3
			              , B.APC_APC_CTRT_EMSPAP           AS S4
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.GVRMNT_SPRT_YN  = 'Y'
			        AND     A.MB IS NULL
			        AND     A.APC_CD = B.APC_CD )
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectMdRtlFcltPrcsPrfmncAvgcGridList	-->
	<!-- DESC : 정부지원 지역별 운영실적 - 산지유통시설 처리실적(평균) 단건조회.			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectMdRtlFcltPrcsPrfmncAvgcGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  S0                              AS V0
			      , ROUND(SUM(S1)/SUM(A1),0)        AS V1
			      , ROUND(SUM(S2)/SUM(A1),0)        AS V2
			      , ROUND(SUM(S3)/SUM(A1),0)        AS V3
			      , ROUND(SUM(S4)/SUM(A1),0)        AS V4
			FROM  ( SELECT '1통합조직 농협'                 AS S0
			              , B.APC_APC_TRMT_AMT              AS S1
			              , B.APC_GNRL_TRMT_AMT             AS S2
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST  AS S3
			              , B.APC_APC_CTRT_EMSPAP           AS S4
			              , 1                               AS A1
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('1','2','3','4')
			        AND     A.GVRMNT_SPRT_YN  = 'Y'
			        AND     A.MB IS NOT NULL
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '2통합조직 농업법인'             AS S0
			              , B.APC_APC_TRMT_AMT              AS S1
			              , B.APC_GNRL_TRMT_AMT             AS S2
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST  AS S3
			              , B.APC_APC_CTRT_EMSPAP           AS S4
			              , 1                               AS A1
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.GVRMNT_SPRT_YN  = 'Y'
			        AND     A.MB IS NULL
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '3개별조직 농협'         AS S0
			              , B.APC_APC_TRMT_AMT              AS S1
			              , B.APC_GNRL_TRMT_AMT             AS S2
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST  AS S3
			              , B.APC_APC_CTRT_EMSPAP           AS S4
			              , 1                               AS A1
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.GVRMNT_SPRT_YN  = 'Y'
			        AND     A.MB IS NOT NULL
			        AND     A.APC_CD = B.APC_CD
			        UNION ALL
			        SELECT '4개별조직 농업법인'     AS S0
			              , B.APC_APC_TRMT_AMT              AS S1
			              , B.APC_GNRL_TRMT_AMT             AS S2
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST  AS S3
			              , B.APC_APC_CTRT_EMSPAP           AS S4
			              , 1                               AS A1
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.OGNZ_TYPE_CD IN ('5')
			        AND     A.GVRMNT_SPRT_YN  = 'Y'
			        AND     A.MB IS NULL
			        AND     A.APC_CD = B.APC_CD )
			GROUP BY S0
			ORDER BY S0
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectRgnOperOgnzTrmtPrfmncGridList	-->
	<!-- DESC : 정부지원 지역별 운영실적 - 지역별 운영조직 취급실적 단건조회.			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectRgnOperOgnzTrmtPrfmncGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)			AS V0
			      , ROUND(SUM(S1),0)     				AS V1
			      , ROUND(SUM(S2),0)     				AS V2
			      , ROUND(SUM(S3),0)     				AS V3
			      , ROUND(SUM(S4),0)     				AS V4
			      , ROUND(SUM(S5),0)     				AS V5
			      , ROUND(SUM(S6),0)     				AS V6
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN B.RTL_OGNZ_TOT_TRMT_AMT END  AS S1
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN B.RTL_OGNZ_TOT_TRMT_AMT END      AS S2
			              , B.RTL_OGNZ_TOT_TRMT_AMT                                                 AS S3
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN B.RTL_OGNZ_OGNZ_SUM END      AS S4
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN B.RTL_OGNZ_OGNZ_SUM END          AS S5
			              , B.RTL_OGNZ_OGNZ_SUM                                                     AS S6
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD = B.APC_CD)
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectRgnOperOgnzTrmtPrfmncAvgGridList	-->
	<!-- DESC : 정부지원 지역별 운영실적 - 지역별 운영조직 취급실적(평균) 단건조회.		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectRgnOperOgnzTrmtPrfmncAvgGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)			AS V0
			      , ROUND(SUM(S1)/SUM(A1),0)     		AS V1
			      , ROUND(SUM(S2)/SUM(A2),0)     		AS V2
			      , ROUND(SUM(S3)/SUM(A3),0)     		AS V3
			      , ROUND(SUM(S4)/SUM(A4),0)     		AS V4
			      , ROUND(SUM(S5)/SUM(A5),0)     		AS V5
			      , ROUND(SUM(S6)/SUM(A6),0)     		AS V6
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN B.RTL_OGNZ_TOT_TRMT_AMT END              AS S1
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN B.RTL_OGNZ_TOT_TRMT_AMT END                  AS S2
			              , B.RTL_OGNZ_TOT_TRMT_AMT                                                             AS S3
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN B.RTL_OGNZ_OGNZ_SUM END                  AS S4
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN B.RTL_OGNZ_OGNZ_SUM END                      AS S5
			              , B.RTL_OGNZ_OGNZ_SUM                                                                 AS S6
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND B.RTL_OGNZ_TOT_TRMT_AMT > 0 THEN 1 END    AS A1
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND B.RTL_OGNZ_TOT_TRMT_AMT > 0  THEN 1 END       AS A2
			              , CASE WHEN B.RTL_OGNZ_TOT_TRMT_AMT > 0  THEN 1 END                                   AS A3
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND B.RTL_OGNZ_OGNZ_SUM > 0 THEN 1 END        AS A4
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND B.RTL_OGNZ_OGNZ_SUM > 0 THEN 1 END            AS A5
			              , CASE WHEN B.RTL_OGNZ_OGNZ_SUM > 0 THEN 1 END                                        AS A6
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD = B.APC_CD)
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectRgnOperOgnzApcPrcsPrfmncGridList	-->
	<!-- DESC : 정부지원 지역별 운영실적 - 지역별 APC 처리실적 단건조회.				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectRgnOperOgnzApcPrcsPrfmncGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)			AS V0
			      , ROUND(SUM(S1),0)     				AS V1
			      , ROUND(SUM(S2),0)     				AS V2
			      , ROUND(SUM(S3),0)     				AS V3
			      , ROUND(SUM(S4),0)     				AS V4
			      , ROUND(SUM(S5),0)     				AS V5
			      , ROUND(SUM(S6),0)     				AS V6
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN B.APC_APC_TRMT_AMT END                                   AS S1
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN B.APC_APC_TRMT_AMT END                                       AS S2
			              , B.APC_APC_TRMT_AMT                                                                                  AS S3
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN B.APC_APC_OGNZ_CPRTN_SORT_TRST+B.APC_APC_CTRT_EMSPAP END AS S4
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN B.APC_APC_OGNZ_CPRTN_SORT_TRST+B.APC_APC_CTRT_EMSPAP END     AS S5
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST+B.APC_APC_CTRT_EMSPAP                                                AS S6
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD = B.APC_CD)
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.fclt.mapper.FcltMdRtlMapper.selectRgnOperOgnzApcPrcsPrfmncAvgGridList	-->
	<!-- DESC : 정부지원 지역별 운영실적 - 지역별 APC 처리실적(평균) 단건조회.			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.11.18  	김현호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectRgnOperOgnzApcPrcsPrfmncAvgGridList" parameterType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO" resultType="com.at.apcss.fm.fclt.vo.FcltMdRtlVO">
    	<![CDATA[
			SELECT  DECODE(S0, '히', '기타', S0)			AS V0
			      , ROUND(SUM(S1)/SUM(A1),0)     		AS V1
			      , ROUND(SUM(S2)/SUM(A1),0)     		AS V2
			      , ROUND(SUM(S3)/SUM(A1),0)     		AS V3
			      , ROUND(SUM(S4)/SUM(A1),0)     		AS V4
			      , ROUND(SUM(S5)/SUM(A1),0)     		AS V5
			      , ROUND(SUM(S6)/SUM(A1),0)     		AS V6
			FROM  ( SELECT  DECODE(A.CTPV_NM,'서울시','히','광주시','히','대구시','히','부산시','히','세종시','히','울산시','히', A.CTPV_NM) AS S0
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN B.APC_APC_TRMT_AMT END                                               AS S1
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN B.APC_APC_TRMT_AMT END                                                   AS S2
			              , B.APC_APC_TRMT_AMT                                                                                              AS S3
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') THEN B.APC_APC_OGNZ_CPRTN_SORT_TRST+B.APC_APC_CTRT_EMSPAP END             AS S4
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') THEN B.APC_APC_OGNZ_CPRTN_SORT_TRST+B.APC_APC_CTRT_EMSPAP END                 AS S5
			              , B.APC_APC_OGNZ_CPRTN_SORT_TRST+B.APC_APC_CTRT_EMSPAP                                                            AS S6

			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND B.APC_APC_TRMT_AMT > 0 THEN 1 END                                     AS A1
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND B.APC_APC_TRMT_AMT > 0 THEN 1 END                                         AS A2
			              , CASE WHEN B.APC_APC_TRMT_AMT > 0 THEN 1 END                                                                     AS A3
			              , CASE WHEN A.OGNZ_TYPE_CD NOT IN ('5') AND B.APC_APC_OGNZ_CPRTN_SORT_TRST+B.APC_APC_CTRT_EMSPAP > 0 THEN 1 END   AS A4
			              , CASE WHEN A.OGNZ_TYPE_CD IN ('5') AND B.APC_APC_OGNZ_CPRTN_SORT_TRST+B.APC_APC_CTRT_EMSPAP > 0 THEN 1 END       AS A5
			              , CASE WHEN B.APC_APC_OGNZ_CPRTN_SORT_TRST+B.APC_APC_CTRT_EMSPAP > 0 THEN 1 END                                   AS A6
			        FROM    USRAM.TB_TE_APC_OPER_PRSN_OTLN A,
			                USRAM.TB_TE_APC_OPER_PRFMNC B
			        WHERE   1=1
			        AND A.TOT_STTN_YN = 'Y'
			        AND NVL(A.DUP_YN, 'N') != 'Y'
		]]>
				<if test='crtrYr != null and crtrYr != ""'>
					AND   	A.CRTR_YR         = #{crtrYr}
					AND     B.CRTR_YR         = #{crtrYr}
				</if>
		<![CDATA[
			        AND     A.GVRMNT_SPRT_YN = 'Y'
			        AND     A.CTPV_CD IS NOT NULL
			        AND     A.APC_CD = B.APC_CD)
			GROUP BY S0
			ORDER BY (CASE
								WHEN S0 = '경기도' THEN 1
								WHEN S0 = '강원도' THEN 2
								WHEN S0 = '충북도' THEN 3
								WHEN S0 = '충남도' THEN 4
								WHEN S0 = '전북도' THEN 5
								WHEN S0 = '전남도' THEN 6
								WHEN S0 = '경북도' THEN 7
								WHEN S0 = '경남도' THEN 8
								WHEN S0 = '제주도' THEN 9
								 ELSE 10 END)
			]]>
    </select>

</mapper>