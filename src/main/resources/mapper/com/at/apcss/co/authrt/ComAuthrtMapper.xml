<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!-- ==========================================================================	-->
<!-- NAME : ComAuthMapper.xml                                    				-->
<!-- DESC : 권한 정보 mapper                                             			-->
<!-- ==========================================================================	-->
<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
<!-- ===========  	============  	===========================================	-->
<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
<!-- ==========================================================================	-->

<mapper namespace="com.at.apcss.co.authrt.mapper.ComAuthrtMapper">

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectComAuthrt		-->
	<!-- DESC : 권한 단건조회.                                             				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectComAuthrt" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtVO" resultType="com.at.apcss.co.authrt.vo.ComAuthrtVO">
    	<![CDATA[
			SELECT /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectComAuthrt */
				  CA.AUTHRT_ID      AS AUTHRT_ID
		        , CA.AUTHRT_NM      AS AUTHRT_NM
				, CA.AUTHRT_TYPE    AS AUTHRT_TYPE
				, CA.AUTHRT_RMRK    AS AUTHRT_RMRK
				, CA.DEL_YN                 AS DEL_YN
		        , CA.SYS_FRST_INPT_DT       AS SYS_FRST_INPT_DT
		        , CA.SYS_FRST_INPT_USER_ID  AS SYS_FRST_INPT_USER_ID
		        , CA.SYS_FRST_INPT_PRGRM_ID AS SYS_FRST_INPT_PRGRM_ID
		        , CA.SYS_LAST_CHG_DT        AS SYS_LAST_CHG_DT
		        , CA.SYS_LAST_CHG_USER_ID   AS SYS_LAST_CHG_USER_ID
		        , CA.SYS_LAST_CHG_PRGRM_ID  AS SYS_LAST_CHG_PRGRM_ID
			  FROM TB_COM_AUTH CA
			 WHERE CA.AUTHRT_ID = #{authrtId}
    	]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectComAuthrtList	-->
	<!-- DESC : 권한 목록 조회.                                             			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectComAuthrtList" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtVO" resultType="com.at.apcss.co.authrt.vo.ComAuthrtVO">
    	<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    		SELECT
    			  ROWNUM AS ROW_SEQ
    			, COUNT(*) OVER() AS TOTAL_RECORD_COUNT
    			, pt0.*
    		  FROM (
    	</if>
    	<!-- End 페이징 -->
    	<![CDATA[
			SELECT /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectComAuthrtList */
				  CA.AUTHRT_ID      AS AUTHRT_ID
		        , CA.AUTHRT_NM      AS AUTHRT_NM
				, CA.AUTHRT_TYPE    AS AUTHRT_TYPE
				, CA.AUTHRT_RMRK    AS AUTHRT_RMRK
				, CA.APC_CD			AS APC_CD
				, (SELECT FN_GET_COM_CD_VL_NM('AUTHRT_TYPE', CA.AUTHRT_TYPE) FROM DUAL) AS AUTHRT_TYPE_NM
				, (SELECT X.APC_NM FROM TB_APC_INFO X WHERE X.APC_CD = CA.APC_CD) AS APC_NM
    	]]>
		<if test='sysId != null and sysId != ""'>
				, #{sysId}			AS SYS_ID
		</if>
    	<![CDATA[
			  FROM TB_COM_AUTH CA
			 WHERE CA.DEL_YN = 'N'
    	]]>
		<if test='authrtId != null and authrtId != ""'>
			   AND CA.AUTHRT_ID = #{authrtId}
		</if>
		<if test='authrtNm != null and authrtNm != ""'>
			   AND CA.AUTHRT_NM LIKE '%' || #{authrtNm} || '%'
		</if>
		<if test='authrtType != null and authrtType != ""'>
			   AND CA.AUTHRT_TYPE = #{authrtType}
		</if>
		<if test='authrtRmrk != null and authrtRmrk != ""'>
			   AND CA.AUTHRT_RMRK LIKE '%' || #{authrtRmrk} || '%'
		</if>
		<if test='apcCd != null and apcCd != ""'>
			   AND CA.APC_CD = #{apcCd}
		</if>

		<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    		  ) pt0
			OFFSET (#{currentPageNo} - 1) * #{recordCountPerPage} ROWS
			FETCH FIRST #{recordCountPerPage} ROWS ONLY
    	</if>
    	<!-- End 페이징 -->
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.insertComAuthrt		-->
	<!-- DESC : 권한 등록.                                             				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <insert id="insertComAuthrt" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtVO">
    	<![CDATA[
			INSERT /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.insertComAuthrt */
				INTO TB_COM_AUTH (
					  AUTHRT_ID
					, AUTHRT_NM
					, AUTHRT_TYPE
					, AUTHRT_RMRK
					, APC_CD
	    		  	, SYS_FRST_INPT_DT
	    		  	, SYS_FRST_INPT_USER_ID
	    		  	, SYS_FRST_INPT_PRGRM_ID
	    		  	, SYS_LAST_CHG_DT
	    		  	, SYS_LAST_CHG_USER_ID
	    		  	, SYS_LAST_CHG_PRGRM_ID
				) VALUES (
					  FN_GET_ID_COM_AUTH(#{apcCd})
					, #{authrtNm}
					, #{authrtType}
					, #{authrtRmrk}
					, #{apcCd}
					, SYSDATE
	   			  	, #{sysFrstInptUserId}
	   			  	, #{sysFrstInptPrgrmId}
	   			  	, SYSDATE
	   			  	, #{sysLastChgUserId}
	   			  	, #{sysLastChgPrgrmId}
				)
    	]]>
    </insert>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.updateComAuthrt		-->
	<!-- DESC : 권한 변경.                                             				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <update id="updateComAuthrt" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtVO">
    	<![CDATA[
			UPDATE /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.updateComAuthrt */
	    		TB_COM_AUTH
			   SET
			   	  AUTHRT_NM 	= #{authrtNm}
	    	    , AUTHRT_TYPE 	= #{authrtType}
	    	    , AUTHRT_RMRK	= #{authrtRmrk}
	    	    , SYS_LAST_CHG_DT		= SYSDATE
	    		, SYS_LAST_CHG_USER_ID	= #{sysLastChgUserId}
	    		, SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
	    	 WHERE AUTHRT_ID = #{authrtId}
    	]]>
    </update>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.deleteComAuthrt		-->
	<!-- DESC : 권한 삭제.                                             				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <delete id="deleteComAuthrt" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtVO">
    	<![CDATA[
			DELETE /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.deleteComAuthrt */
	    		FROM TB_COM_AUTH
	    	 WHERE AUTHRT_ID = #{authrtId}
    	]]>
    </delete>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.deleteComAuthrtMenuByAuthrtId		-->
	<!-- DESC : 권한메뉴 삭제 by 권한id                                       				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <delete id="deleteComAuthrtMenuByAuthrtId" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtVO">
    	<![CDATA[
			DELETE /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.deleteComAuthrtMenuByAuthrtId */
	    		FROM TB_COM_AUTH_MENU
	    	 WHERE AUTHRT_ID = #{authrtId}
    	]]>
    </delete>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.deleteComAuthrtUserByAuthrtId		-->
	<!-- DESC : 권한사용자 삭제 by 권한id                                       				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <delete id="deleteComAuthrtUserByAuthrtId" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtVO">
    	<![CDATA[
			DELETE /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.deleteComAuthrtUserByAuthrtId */
	    		FROM TB_COM_AUTH_USER
	    	 WHERE AUTHRT_ID = #{authrtId}
    	]]>
    </delete>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectComAuthrtMenu	-->
	<!-- DESC : 권한 메뉴 단건 조회.                                             			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectComAuthrtMenu" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtMenuVO" resultType="com.at.apcss.co.authrt.vo.ComAuthrtMenuVO" >
    	<![CDATA[
			SELECT /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectComAuthrtMenu */
				  AM.AUTHRT_ID		AS AUTHRT_ID
				, AM.MENU_ID		AS MENU_ID
				, AM.DEL_YN			AS DEL_YN
				, CM.UP_MENU_ID		AS UP_MENU_ID
				, CM.AUTHRT_TYPE	AS AUTHRT_TYPE
				, SUBSTR(AM.MENU_ID, 1, 2)	AS TOP_MENU_ID
			  FROM
			  	  TB_COM_AUTH_MENU AM
			  	, TB_COM_MENU CM
			 WHERE AM.MENU_ID = CM.MENU_ID
			   AND AM.AUTHRT_ID = #{authrtId}
			   AND AM.MENU_ID = #{menuId}
    	]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectComAuthrtMenuList	-->
	<!-- DESC : 권한 메뉴 목록 조회.                                             			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectComAuthrtMenuList" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtMenuVO" resultType="com.at.apcss.co.authrt.vo.ComAuthrtMenuVO" >
    	<![CDATA[
			SELECT /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectComAuthrtMenuList */
				  CA.AUTHRT_ID      AS AUTHRT_ID
		        , CA.AUTHRT_NM      AS AUTHRT_NM
				, CA.AUTHRT_TYPE    AS AUTHRT_TYPE
				, CA.AUTHRT_RMRK    AS AUTHRT_RMRK
				, AM.MENU_ID    	AS MENU_ID
				, CM.MENU_NM    	AS MENU_NM
				, CM.UP_MENU_ID 	AS UP_MENU_ID
				, CM.MENU_TYPE  	AS MENU_TYPE
				, CM.USER_TYPE  	AS USER_TYPE
				, CM.PAGE_URL   	AS PAGE_URL
				, CM.INDCT_SEQ  	AS INDCT_SEQ
				, CM.APC_CD   		AS APC_CD
			  FROM
			  	  TB_COM_AUTH CA
			  	, TB_COM_AUTH_MENU AM
				, TB_COM_MENU CM
			 WHERE CA.AUTHRT_ID = AM.AUTHRT_ID
			   AND AM.MENU_ID = CM.MENU_ID
			   AND CA.DEL_YN = 'N'
			   AND CM.DEL_YN = 'N'
			   AND CM.DEL_YN = 'N'
    	]]>
		<if test='authrtId != null and authrtId != ""'>
			   AND CA.AUTHRT_ID = #{authrtId}
		</if>
		<if test='authrtNm != null and authrtNm != ""'>
			   AND CA.AUTHRT_NM LIKE '%' || #{authrtNm} || '%'
		</if>
		<if test='authrtType != null and authrtType != ""'>
			   AND CA.AUTHRT_TYPE = #{authrtType}
		</if>
		<if test='authrtRmrk != null and authrtRmrk != ""'>
			   AND CA.AUTHRT_RMRK LIKE '%' || #{authrtRmrk} || '%'
		</if>
		<if test='menuId != null and menuId != ""'>
			AND AM.MENU_ID = #{menuId}
		</if>
		<if test='menuNm != null and menuNm != ""'>
			AND CM.MENU_NM LIKE '%' || #{menuNm} || '%'
		</if>
		<if test='upMenuId != null and upMenuId != ""'>
			AND CM.UP_MENU_ID = #{upMenuId}
		</if>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectComAuthrtUiList		-->
	<!-- DESC : 권한 화면 목록 조회.                                             			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectComAuthrtUiList" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtUiVO" resultType="com.at.apcss.co.authrt.vo.ComAuthrtUiVO" >
    	<![CDATA[
    		SELECT /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectComAuthrtUiList */
    	]]>
    	<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    			  ROWNUM AS ROW_SEQ
    			, COUNT(*) OVER() AS TOTAL_RECORD_COUNT
    			, 
    	</if>
    	<!-- End 페이징 -->
    	<![CDATA[
				  pt0.*
				, (SELECT FN_GET_COM_CD_VL_NM('ENTY_TYPE', pt0.ENTY_TYPE) FROM DUAL)	AS ENTY_TYPE_NM
				, (SELECT FN_GET_COM_CD_VL_NM('APLCN_TYPE', pt0.APLCN_TYPE) FROM DUAL)	AS APLCN_TYPE_NM
    		  FROM (
			SELECT
				  AM.AUTHRT_ID	AS AUTHRT_ID
				, SUBSTR(AM.AUTHRT_ID, 1, 4) AS APC_CD
				, AM.MENU_ID	AS MENU_ID
				, MN.MENU_NM	AS MENU_NM
				, CU.ENTY_ID	AS ENTY_ID
				, CU.ENTY_NM	AS ENTY_NM
				, CU.ENTY_TYPE	AS ENTY_TYPE
				, NVL2(UI.ENTY_ID, 'Y', 'N')	AS USE_YN
				, UI.APLCN_TYPE	AS APLCN_TYPE
				, NVL(UI.INDCT_YN, 'Y')			AS INDCT_YN
			  FROM TB_COM_AUTH_MENU AM
			  
			  JOIN TB_COM_MENU MN
			    ON MN.MENU_ID = AM.MENU_ID
			   AND MN.DEL_YN = 'N'
			  
			  JOIN TB_COM_UI CU
			    ON CU.MENU_ID = AM.MENU_ID
			   AND CU.DEL_YN = 'N'
			  
			  LEFT JOIN TB_COM_AUTH_UI UI
			    ON UI.AUTHRT_ID = AM.AUTHRT_ID
			   AND UI.MENU_ID = AM.MENU_ID
       		   AND UI.ENTY_ID = CU.ENTY_ID
			   AND UI.DEL_YN = 'N'
			   
			 WHERE AM.AUTHRT_ID = #{authrtId}
			   AND AM.MENU_ID = #{menuId}
			   AND AM.DEL_YN = 'N'
			   
			 ORDER BY
			 	  ENTY_ID
    		  ) pt0
    	]]>
		<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>

			OFFSET (#{currentPageNo} - 1) * #{recordCountPerPage} ROWS
			FETCH FIRST #{recordCountPerPage} ROWS ONLY
    	</if>
    	<!-- End 페이징 -->
    </select>

	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectComAuthrtMenuTreeList	-->
	<!-- DESC : 권한 메뉴트리 목록 조회.                                             			-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2023.05.30  	jcshin        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
    <select id="selectComAuthrtMenuTreeList" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtMenuVO" resultType="com.at.apcss.co.authrt.vo.ComAuthrtMenuVO">
    	<![CDATA[
			SELECT /* com.at.apcss.co.authrt.mapper.ComAuthMapper.selectComAuthrtMenuTreeList */
				  MN.LVL			AS MENU_LVL
				, MN.SEQ			AS MENU_SEQ
				, MN.SYS_ID			AS SYS_ID
				, MN.UP_MENU_ID		AS UP_MENU_ID
				, UM.MENU_NM		AS UP_MENU_NM
				, MN.MENU_ID		AS MENU_ID
				, MN.MENU_NM		AS MENU_NM
				, MN.MENU_TYPE  	AS MENU_TYPE
				, MN.USER_TYPE		AS USER_TYPE
				, MN.PAGE_URL		AS PAGE_URL
				, MN.APC_CD			AS APC_CD
				, MN.INDCT_SEQ		AS INDCT_SEQ
				, AM.AUTHRT_ID		AS AUTHRT_ID
				, CA.AUTHRT_NM		AS AUTHRT_NM
				, CA.AUTHRT_TYPE	AS AUTHRT_TYPE
				, NVL2(AM.MENU_ID, 'Y', 'N') AS USE_YN
				, NULL				AS ENTY_LIST
			  FROM (
				SELECT
					  LEVEL		AS LVL
					, ROWNUM 	AS SEQ
					, SUBSTR(MN.MENU_ID, 1, 2) AS SYS_ID
					, MN.UP_MENU_ID	AS UP_MENU_ID
					, MN.MENU_ID	AS MENU_ID
					, MN.MENU_NM	AS MENU_NM
					, MN.MENU_TYPE  AS MENU_TYPE
					, MN.USER_TYPE	AS USER_TYPE
					, MN.PAGE_URL	AS PAGE_URL
					, MN.APC_CD		AS APC_CD
					, MN.INDCT_SEQ	AS INDCT_SEQ
					, MN.AUTHRT_TYPE AS AUTHRT_TYPE
				  FROM TB_COM_MENU MN
				 WHERE MN.DEL_YN = 'N'
    	]]>
    	<choose>
    		<when test='authrtType != null and authrtType == "00"'>
				   AND MN.AUTHRT_TYPE IN ('00', '10', '20', '21', '30', '40')
    		</when>
    		<when test='authrtType != null and authrtType == "10"'>
				   AND MN.AUTHRT_TYPE IN ('10', '20', '21', '30', '40')
    		</when>
    		<when test='authrtType != null and authrtType == "20"'>
				   AND MN.AUTHRT_TYPE IN ('20', '21', '30', '40')
    		</when>
    		<when test='authrtType != null and authrtType == "21"'>
				   AND MN.AUTHRT_TYPE IN ('21', '30', '40')
    		</when>
    		<when test='authrtType != null and authrtType == "30"'>
				   AND MN.AUTHRT_TYPE IN ('30', '40')
    		</when>
    		<when test='authrtType != null and authrtType == "40"'>
				   AND MN.AUTHRT_TYPE IN ('40')
    		</when>
    	</choose>
    	<![CDATA[
				 START WITH MN.MENU_ID = #{sysId}
			    CONNECT BY PRIOR MN.MENU_ID = MN.UP_MENU_ID
			     ORDER SIBLINGS BY MN.INDCT_SEQ, MN.MENU_ID
			  	) MN

			  	LEFT JOIN TB_COM_MENU UM
			  	  ON UM.MENU_ID = MN.UP_MENU_ID
			  	 AND UM.DEL_YN = 'N'

			  	LEFT JOIN TB_COM_AUTH CA
			  	  ON CA.AUTHRT_ID = #{authrtId}
			  	 AND CA.DEL_YN = 'N'

			  	LEFT JOIN TB_COM_AUTH_MENU AM
			  	  ON AM.MENU_ID = MN.MENU_ID
			  	 AND AM.AUTHRT_ID = CA.AUTHRT_ID

			 WHERE 1=1
			ORDER BY MENU_SEQ
    	]]>
    </select>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectComAuthrtUser	-->
	<!-- DESC : 권한 사용자 단건 조회.                                             		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectComAuthrtUser" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtUserVO" resultType="com.at.apcss.co.authrt.vo.ComAuthrtUserVO">
    	<![CDATA[
			SELECT /* com.at.apcss.co.authrt.ComAuthMapper.selectComAuthrtUser */
				  CA.AUTHRT_ID          AS AUTHRT_ID
			    , CA.AUTHRT_NM          AS AUTHRT_NM
			    , CU.USER_ID            AS USER_ID
			    , CU.USER_NM            AS USER_NM
			    , CU.USER_TYPE          AS USER_TYPE
			    , CU.USER_STTS          AS USER_STTS
			    , CU.EML                AS EML
			    , CU.APC_CD             AS APC_CD
			    , CU.OGDP_NM            AS OGDP_NM
			    , CU.CHRGD_CERT_YN      AS CHRGD_CERT_YN
			    , CU.CHRGD_CERT_TYPE    AS CHRGD_CERT_TYPE
			    , CU.LCK_YN             AS LCK_YN
			    , CU.LGN_FAIL_NMTM      AS LGN_FAIL_NMTM
			    , CU.END_LGN_DT         AS END_LGN_DT
			    , CU.END_LGN_IP         AS END_LGN_IP
			  FROM
			      TB_COM_AUTH CA
			  	, TB_COM_AUTH_USER AU
			  	, TB_COM_USER CU
			 WHERE CA.AUTHRT_ID = AU.AUTHRT_ID
			   AND AU.USER_ID = CU.USER_ID
			   AND CA.DEL_YN = 'N'
			   AND AU.DEL_YN = 'N'
			   AND CU.DEL_YN = 'N'
			   AND CA.AUTHRT_ID = #{authrtId}
			   AND AU.USER_ID = #{userId}
    	]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectComAuthrtUserList	-->
	<!-- DESC : 권한 사용자 목록 조회.                                             		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectComAuthrtUserList" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtUserVO" resultType="com.at.apcss.co.authrt.vo.ComAuthrtUserVO">
    	<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    		SELECT
    			  ROWNUM AS ROW_SEQ
    			, COUNT(*) OVER() AS TOTAL_RECORD_COUNT
    			, pt0.*
    		  FROM (
    	</if>
    	<!-- End 페이징 -->
    	<![CDATA[
			SELECT /* com.at.apcss.co.authrt.ComAuthMapper.selectComAuthrtUserList */
				  CA.AUTHRT_ID          AS AUTHRT_ID
			    , CA.AUTHRT_NM          AS AUTHRT_NM
			    , CU.USER_ID            AS USER_ID
			    , CU.USER_NM            AS USER_NM
			    , CU.USER_TYPE          AS USER_TYPE
			    , CU.USER_STTS          AS USER_STTS
			    , CU.EML                AS EML
			    , CU.APC_CD             AS APC_CD
			    , CU.OGDP_NM            AS OGDP_NM
			    , CU.CHRGD_CERT_YN      AS CHRGD_CERT_YN
			    , CU.CHRGD_CERT_TYPE    AS CHRGD_CERT_TYPE
			    , CU.LCK_YN             AS LCK_YN
			    , CU.LGN_FAIL_NMTM      AS LGN_FAIL_NMTM
			    , CU.END_LGN_DT         AS END_LGN_DT
			    , CU.END_LGN_IP         AS END_LGN_IP
			  FROM
			      TB_COM_AUTH CA
			  	, TB_COM_AUTH_USER AU
			  	, TB_COM_USER CU
			 WHERE CA.AUTHRT_ID = AU.AUTHRT_ID
			   AND AU.USER_ID = CU.USER_ID
			   AND CA.DEL_YN = 'N'
			   AND AU.DEL_YN = 'N'
			   AND CU.DEL_YN = 'N'
    	]]>
		<if test='authrtId != null and authrtId != ""'>
			   AND CA.AUTHRT_ID = #{authrtId}
		</if>
		<if test='authrtNm != null and authrtNm != ""'>
			   AND CU.AUTHRT_NM LIKE '%' || #{authrtNm} || '%'
		</if>
		<if test='userId != null and userId != ""'>
			   AND CU.USER_ID = #{userId}
		</if>
		<if test='userNm != null and userNm != ""'>
			   AND CU.USER_NM LIKE '%' || #{userNm} || '%'
		</if>
		<if test='userType != null and userType != ""'>
			   AND CU.USER_TYPE = #{userType}
		</if>
		<if test='userStts != null and userStts != ""'>
			   AND CU.USER_STTS = #{userStts}
		</if>
		<if test='apcCd != null and apcCd != ""'>
			   AND CU.APC_CD = #{apcCd}
		</if>
		<if test='ogdpNm != null and ogdpNm != ""'>
			   AND CU.OGDP_NM LIKE '%' || #{ogdpNm} || '%'
		</if>

    	<![CDATA[
    		 ORDER BY AUTHRT_ID, USER_ID, USER_NM
    	]]>
		<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    		  ) pt0
			OFFSET (#{currentPageNo} - 1) * #{recordCountPerPage} ROWS
			FETCH FIRST #{recordCountPerPage} ROWS ONLY
    	</if>
    	<!-- End 페이징 -->
    </select>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.insertComAuthrtMenu	-->
	<!-- DESC : 권한 메뉴 등록.                                             			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <insert id="insertComAuthrtMenu" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtMenuVO">
    	<![CDATA[
			INSERT /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.insertComAuthrtMenu */
				INTO TB_COM_AUTH_MENU (
					  AUTHRT_ID
					, MENU_ID
	    		  	, SYS_FRST_INPT_DT
	    		  	, SYS_FRST_INPT_USER_ID
	    		  	, SYS_FRST_INPT_PRGRM_ID
	    		  	, SYS_LAST_CHG_DT
	    		  	, SYS_LAST_CHG_USER_ID
	    		  	, SYS_LAST_CHG_PRGRM_ID
				) VALUES (
					  #{authrtId}
					, #{menuId}
					, SYSDATE
	   			  	, #{sysFrstInptUserId}
	   			  	, #{sysFrstInptPrgrmId}
	   			  	, SYSDATE
	   			  	, #{sysLastChgUserId}
	   			  	, #{sysLastChgPrgrmId}
				)
    	]]>
    </insert>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.updateComAuthrtMenu	-->
	<!-- DESC : 권한 메뉴 변경.                                            				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <update id="updateComAuthrtMenu" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtMenuVO">
    	<![CDATA[
			UPDATE /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.updateComAuthrtMenu */
	    		TB_COM_AUTH_MENU
			   SET
	    	      SYS_LAST_CHG_DT		= SYSDATE
	    		, SYS_LAST_CHG_USER_ID	= #{sysLastChgUserId}
	    		, SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
	    	 WHERE AUTHRT_ID = #{authrtId}
	    	   AND MENU_ID = #{menuId}
    	]]>
    </update>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.deleteComAuthrtMenu	-->
	<!-- DESC : 권한 메뉴 삭제.                                             			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <delete id="deleteComAuthrtMenu" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtMenuVO">
    	<![CDATA[
			DELETE /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.deleteComAuthrtMenu */
	    		FROM TB_COM_AUTH_MENU
	    	 WHERE AUTHRT_ID = #{authrtId}
	    	   AND MENU_ID = #{menuId}
    	]]>
    </delete>

	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectTopMenuTreeList		-->
	<!-- DESC : 권한 TOP메뉴 목록 조회.                                             			-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2023.05.30  	jcshin        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
    <select id="selectTopMenuTreeList" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtMenuVO" resultType="com.at.apcss.co.authrt.vo.ComAuthrtMenuVO">
    	<![CDATA[
			SELECT /* com.at.apcss.co.authrt.mapper.ComAuthMapper.selectTopMenuTreeList */
				  MN.LVL			AS MENU_LVL
				, MN.SEQ			AS MENU_SEQ
				, MN.SYS_ID			AS SYS_ID
				, MN.UP_MENU_ID		AS UP_MENU_ID
				, UM.MENU_NM		AS UP_MENU_NM
				, MN.MENU_ID		AS MENU_ID
				, MN.MENU_NM		AS MENU_NM
				, MN.MENU_TYPE  	AS MENU_TYPE
				, MN.USER_TYPE		AS USER_TYPE
				, MN.PAGE_URL		AS PAGE_URL
				, MN.APC_CD			AS APC_CD
				, MN.INDCT_SEQ		AS INDCT_SEQ
				, AUTH.AUTHRT_ID	AS AUTHRT_ID
				, AUTH.AUTHRT_NM	AS AUTHRT_NM
				, AUTH.AUTHRT_TYPE	AS AUTHRT_TYPE
				, NVL2(AUTH.MENU_ID, 'Y', 'N') AS USE_YN
			  FROM (
				SELECT
					  LEVEL		AS LVL
					, ROWNUM 	AS SEQ
					, SUBSTR(MN.MENU_ID, 1, 2) AS SYS_ID
					, MN.UP_MENU_ID	AS UP_MENU_ID
					, MN.MENU_ID	AS MENU_ID
					, MN.MENU_NM	AS MENU_NM
					, MN.MENU_TYPE  AS MENU_TYPE
					, MN.USER_TYPE	AS USER_TYPE
					, MN.PAGE_URL	AS PAGE_URL
					, MN.APC_CD		AS APC_CD
					, MN.INDCT_SEQ	AS INDCT_SEQ
				  FROM TB_COM_MENU MN
				 WHERE MN.DEL_YN = 'N'
				 START WITH MN.UP_MENU_ID IS NULL
			    CONNECT BY PRIOR MN.MENU_ID = MN.UP_MENU_ID
			     ORDER SIBLINGS BY MN.INDCT_SEQ, MN.MENU_ID
			  	) MN

			  	LEFT JOIN TB_COM_MENU UM
			  	  ON UM.MENU_ID = MN.UP_MENU_ID
			  	 AND UM.DEL_YN = 'N'

				LEFT JOIN (
					SELECT
						  LISTAGG(CA.AUTHRT_ID, ',') WITHIN GROUP (ORDER BY CA.AUTHRT_ID) AS AUTHRT_ID
						, LISTAGG(CA.AUTHRT_NM, ',') WITHIN GROUP (ORDER BY CA.AUTHRT_ID) AS AUTHRT_NM
						, NULL AS AUTHRT_TYPE
						, AM.MENU_ID
					  FROM TB_COM_AUTH CA
					  LEFT JOIN TB_COM_AUTH_MENU AM
					    ON AM.AUTHRT_ID = CA.AUTHRT_ID
					   AND AM.DEL_YN = 'N'
					 WHERE CA.DEL_YN = 'N'
    	]]>
				<if test='authrtId != null and authrtId != ""'>
					   AND CA.AUTHRT_ID = #{authrtId}
				</if>
				<if test='authrtIdList != null and !authrtIdList.isEmpty()'>
					   AND CA.AUTHRT_ID IN
					   <foreach collection="authrtIdList" item="item" index="index" separator="," open="(" close=")">
					   	#{item}
					   </foreach>
				</if>
    	<![CDATA[

					 GROUP BY AM.MENU_ID
				) AUTH
			  ON AUTH.MENU_ID = MN.MENU_ID
		 	 WHERE MN.LVL <= 2
    	]]>
    </select>

	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectSideMenuTreeList	-->
	<!-- DESC : 권한 TOP메뉴 목록 조회.                                             			-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2023.05.30  	jcshin        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
    <select id="selectSideMenuTreeList" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtMenuVO" resultType="com.at.apcss.co.authrt.vo.ComAuthrtMenuVO">
    	<![CDATA[
			SELECT /* com.at.apcss.co.authrt.mapper.ComAuthMapper.selectSideMenuTreeList */
				  MN.LVL			AS MENU_LVL
				, MN.SEQ			AS MENU_SEQ
				, MN.SYS_ID			AS SYS_ID
				, MN.UP_MENU_ID		AS UP_MENU_ID
				, UM.MENU_NM		AS UP_MENU_NM
				, MN.MENU_ID		AS MENU_ID
				, MN.MENU_NM		AS MENU_NM
				, MN.MENU_TYPE  	AS MENU_TYPE
				, MN.USER_TYPE		AS USER_TYPE
				, MN.PAGE_URL		AS PAGE_URL
				, MN.APC_CD			AS APC_CD
				, MN.INDCT_SEQ		AS INDCT_SEQ
				, AUTH.AUTHRT_ID	AS AUTHRT_ID
				, AUTH.AUTHRT_NM	AS AUTHRT_NM
				, AUTH.AUTHRT_TYPE	AS AUTHRT_TYPE
				, NVL2(AUTH.MENU_ID, 'Y', 'N') AS USE_YN
				, MN.PRSNA_INFO_YN AS PRSNA_INFO_YN
			  FROM (
				SELECT
					  LEVEL		AS LVL
					, ROWNUM 	AS SEQ
					, SUBSTR(MN.MENU_ID, 1, 2) AS SYS_ID
					, MN.UP_MENU_ID	AS UP_MENU_ID
					, MN.MENU_ID	AS MENU_ID
					, MN.MENU_NM	AS MENU_NM
					, MN.MENU_TYPE  AS MENU_TYPE
					, MN.USER_TYPE	AS USER_TYPE
					, MN.PAGE_URL	AS PAGE_URL
					, MN.APC_CD		AS APC_CD
					, MN.INDCT_SEQ	AS INDCT_SEQ
					, MN.PRSNA_INFO_YN
				  FROM TB_COM_MENU MN
				 WHERE MN.DEL_YN = 'N'
				 START WITH MN.UP_MENU_ID = #{upMenuId}
			    CONNECT BY PRIOR MN.MENU_ID = MN.UP_MENU_ID
			     ORDER SIBLINGS BY MN.INDCT_SEQ, MN.MENU_ID
			  	) MN

			  	LEFT JOIN TB_COM_MENU UM
			  	  ON UM.MENU_ID = MN.UP_MENU_ID
			  	 AND UM.DEL_YN = 'N'

				LEFT JOIN (
					SELECT
						  LISTAGG(CA.AUTHRT_ID, ',') WITHIN GROUP (ORDER BY CA.AUTHRT_ID) AS AUTHRT_ID
						, LISTAGG(CA.AUTHRT_NM, ',') WITHIN GROUP (ORDER BY CA.AUTHRT_ID) AS AUTHRT_NM
						, NULL AS AUTHRT_TYPE
						, AM.MENU_ID
					  FROM TB_COM_AUTH CA
					  LEFT JOIN TB_COM_AUTH_MENU AM
					    ON AM.AUTHRT_ID = CA.AUTHRT_ID
					   AND AM.DEL_YN = 'N'
					 WHERE CA.DEL_YN = 'N'
    	]]>
				<if test='authrtId != null and authrtId != ""'>
					   AND CA.AUTHRT_ID = #{authrtId}
				</if>
				<if test='authrtIdList != null and !authrtIdList.isEmpty()'>
					   AND CA.AUTHRT_ID IN
					   <foreach collection="authrtIdList" item="item" index="index" separator="," open="(" close=")">
					   	#{item}
					   </foreach>
				</if>
    	<![CDATA[

					 GROUP BY AM.MENU_ID
				) AUTH
			  ON AUTH.MENU_ID = MN.MENU_ID
			 WHERE 1=1
    	]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectComAuthrtListByUserId	-->
	<!-- DESC : 권한 목록 조회.                                             			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectComAuthrtListByUserId" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtVO" resultType="com.at.apcss.co.authrt.vo.ComAuthrtVO">
    	<![CDATA[
			SELECT /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectComAuthrtListByUserId */
				  CA.AUTHRT_ID      AS AUTHRT_ID
		        , CA.AUTHRT_NM      AS AUTHRT_NM
				, CA.AUTHRT_TYPE    AS AUTHRT_TYPE
				, CA.AUTHRT_RMRK    AS AUTHRT_RMRK
				, CA.APC_CD			AS APC_CD
				, (SELECT FN_GET_COM_CD_VL_NM('AUTHRT_TYPE', CA.AUTHRT_TYPE) FROM DUAL) AS AUTHRT_TYPE_NM
				, (SELECT X.APC_NM FROM TB_APC_INFO X WHERE X.APC_CD = CA.APC_CD) AS APC_NM
    	]]>
		<if test='sysId != null and sysId != ""'>
				, #{sysId}			AS SYS_ID
		</if>
    	<![CDATA[
			  FROM TB_COM_AUTH CA
			  JOIN TB_COM_AUTH_USER AU
			    ON AU.AUTHRT_ID = CA.AUTHRT_ID
			   AND AU.DEL_YN = 'N'
			 WHERE CA.DEL_YN = 'N'
			   AND AU.USER_ID = #{userId}
    	]]>
    </select>

    <!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectAuthrtTrgtUserList	-->
	<!-- DESC : 권한 등록 대상 사용자 목록 조회.                                             -->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectAuthrtTrgtUserList" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtUserVO" resultType="com.at.apcss.co.authrt.vo.ComAuthrtUserVO">
    	<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    		SELECT
    			  ROWNUM AS ROW_SEQ
    			, COUNT(*) OVER() AS TOTAL_RECORD_COUNT
    			, pt0.*
    		  FROM (
    	</if>
    	<!-- End 페이징 -->
    	<![CDATA[
			SELECT /* com.at.apcss.co.authrt.ComAuthMapper.selectAuthrtTrgtUserList */
				  CU.USER_ID            AS USER_ID
			    , CU.USER_NM            AS USER_NM
			    , CU.USER_TYPE          AS USER_TYPE
			    , CU.USER_STTS          AS USER_STTS
			    , CU.EML                AS EML
			    , CU.APC_CD             AS APC_CD
			    , CU.OGDP_NM            AS OGDP_NM
			    , CU.CHRGD_CERT_YN      AS CHRGD_CERT_YN
			    , CU.CHRGD_CERT_TYPE    AS CHRGD_CERT_TYPE
			    , CU.LCK_YN             AS LCK_YN
			    , CU.LGN_FAIL_NMTM      AS LGN_FAIL_NMTM
			    , CU.END_LGN_DT         AS END_LGN_DT
			    , CU.END_LGN_IP         AS END_LGN_IP

				, (SELECT X.APC_NM FROM TB_APC_INFO X WHERE X.APC_CD = CU.APC_CD) AS APC_NM
				, (SELECT FN_GET_COM_CD_VL_NM('USER_TYPE', CU.USER_TYPE) FROM DUAL) AS USER_TYPE_NM
				, (SELECT FN_GET_COM_CD_VL_NM('USER_STTS', CU.USER_STTS) FROM DUAL) AS USER_STTS_NM

				, #{authrtId}			AS AUTHRT_ID

			  FROM TB_COM_USER CU
			 WHERE CU.DEL_YN = 'N'
			   AND CU.USER_STTS = '01'
			   AND NOT EXISTS (
			   		SELECT 1
			   		  FROM TB_COM_AUTH_USER X
			   		 WHERE X.AUTHRT_ID = #{authrtId}
			   		   AND X.USER_ID = CU.USER_ID
			   		   AND X.DEL_YN = 'N'
			   	)
    	]]>
		<if test='apcCd != null and apcCd != ""'>
			   AND CU.APC_CD = #{apcCd}
		</if>
		<if test='userNm != null and userNm != ""'>
			   AND CU.USER_NM LIKE '%' || #{userNm} || '%'
		</if>

    	<![CDATA[
    		 ORDER BY USER_ID, USER_NM
    	]]>
		<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    		  ) pt0
			OFFSET (#{currentPageNo} - 1) * #{recordCountPerPage} ROWS
			FETCH FIRST #{recordCountPerPage} ROWS ONLY
    	</if>
    	<!-- End 페이징 -->
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.insertComAuthrtUser	-->
	<!-- DESC : 권한 사용자 등록.                                             			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <insert id="insertComAuthrtUser" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtUserVO">
    	<![CDATA[
			INSERT /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.insertComAuthrtUser */
				INTO TB_COM_AUTH_USER (
					  AUTHRT_ID
					, USER_ID
	    		  	, SYS_FRST_INPT_DT
	    		  	, SYS_FRST_INPT_USER_ID
	    		  	, SYS_FRST_INPT_PRGRM_ID
	    		  	, SYS_LAST_CHG_DT
	    		  	, SYS_LAST_CHG_USER_ID
	    		  	, SYS_LAST_CHG_PRGRM_ID
				) VALUES (
					  #{authrtId}
					, #{userId}
					, SYSDATE
	   			  	, #{sysFrstInptUserId}
	   			  	, #{sysFrstInptPrgrmId}
	   			  	, SYSDATE
	   			  	, #{sysLastChgUserId}
	   			  	, #{sysLastChgPrgrmId}
				)
    	]]>
    </insert>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.deleteComAuthrtUser	-->
	<!-- DESC : 권한 사용자 삭제.                                             			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <delete id="deleteComAuthrtUser" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtUserVO">
    	<![CDATA[
			DELETE /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.deleteComAuthrtUser */
	    		FROM TB_COM_AUTH_USER
	    	 WHERE AUTHRT_ID = #{authrtId}
	    	   AND USER_ID = #{userId}
    	]]>
    </delete>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectUserAuthrtUiList-->
	<!-- DESC : 사용자별 화면UI 권한 목록 조회.                                         	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.10.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectUserAuthrtUiList" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtUiVO" resultType="com.at.apcss.co.authrt.vo.ComAuthrtUiVO">
    	<![CDATA[
    		SELECT /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectUserAuthrtUiList */
    	]]>
    	<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    			  ROWNUM AS ROW_SEQ
    			, COUNT(*) OVER() AS TOTAL_RECORD_COUNT
    			, 
    	</if>
    	<!-- End 페이징 -->
    	<![CDATA[
				  pt0.*
    		  FROM (
			SELECT
				  AU.USER_ID	AS USER_ID
				, SUBSTR(AU.AUTHRT_ID, 1, 4) AS APC_CD
				, AM.MENU_ID	AS MENU_ID
				, MN.MENU_NM	AS MENU_NM
				, CU.ENTY_ID	AS ENTY_ID
				, CU.ENTY_TYPE	AS ENTY_TYPE
				, NVL2(UI.ENTY_ID, 'Y', 'N')	AS USE_YN
				, UI.APLCN_TYPE	AS APLCN_TYPE
				, UI.INDCT_YN	AS INDCT_YN
			  FROM TB_COM_AUTH_USER AU
			  
			  JOIN TB_COM_AUTH_MENU AM
			    ON AM.AUTHRT_ID = AU.AUTHRT_ID
			   AND AM.MENU_ID = #{menuId}
			   AND AM.DEL_YN = 'N'
			  
			  JOIN TB_COM_MENU MN
			    ON MN.MENU_ID = AM.MENU_ID
			   AND MN.DEL_YN = 'N'
			  
			  JOIN TB_COM_UI CU
			    ON CU.MENU_ID = AM.MENU_ID
			   AND CU.DEL_YN = 'N'
			  
			  LEFT JOIN TB_COM_AUTH_UI UI
			    ON UI.AUTHRT_ID = AM.AUTHRT_ID
			   AND UI.MENU_ID = AM.MENU_ID
       		   AND UI.ENTY_ID = CU.ENTY_ID
			   AND UI.DEL_YN = 'N'
			 WHERE AU.USER_ID = #{userId}
			   AND AU.DEL_YN = 'N'
			   
			 ORDER BY
			 	  MENU_ID
			 	, ENTY_ID
			 	, NVL2(UI.ENTY_ID, 9, 1)
    		  ) pt0
    	]]>
		<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>

			OFFSET (#{currentPageNo} - 1) * #{recordCountPerPage} ROWS
			FETCH FIRST #{recordCountPerPage} ROWS ONLY
    	</if>
    	<!-- End 페이징 -->
    </select>
    
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectComAuthrtUi		-->
	<!-- DESC : 화면UI 권한 조회.	                                             		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.10.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectComAuthrtUi" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtUiVO" resultType="com.at.apcss.co.authrt.vo.ComAuthrtUiVO" >
    	<![CDATA[
			SELECT /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.selectComAuthrtUiList */
				  UI.AUTHRT_ID		AS AUTHRT_ID
				, UI.MENU_ID		AS MENU_ID
				, UI.ENTY_ID		AS ENTY_ID
				, UI.APLCN_TYPE		AS APLCN_TYPE
				, UI.INDCT_YN		AS INDCT_YN
				, UI.DEL_YN			AS DEL_YN
			  FROM TB_COM_AUTH_UI UI			   
			 WHERE UI.AUTHRT_ID = #{authrtId}
			   AND UI.MENU_ID = #{menuId}
			   AND UI.ENTY_ID = #{entyId}
    	]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.insertComAuthrtUi		-->
	<!-- DESC : 화면UI권한 등록.                                          				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.10.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <insert id="insertComAuthrtUi" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtUiVO">
    	<![CDATA[
			INSERT /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.insertComAuthrtUi */
				INTO TB_COM_AUTH_UI (
					  AUTHRT_ID
					, MENU_ID
					, ENTY_ID
					, APLCN_TYPE
					, INDCT_YN
	    		  	, SYS_FRST_INPT_DT
	    		  	, SYS_FRST_INPT_USER_ID
	    		  	, SYS_FRST_INPT_PRGRM_ID
	    		  	, SYS_LAST_CHG_DT
	    		  	, SYS_LAST_CHG_USER_ID
	    		  	, SYS_LAST_CHG_PRGRM_ID
				) VALUES (
					  #{authrtId}
					, #{menuId}
					, #{entyId}
					, #{aplcnType}
					, #{indctYn}
					, SYSDATE
	   			  	, #{sysFrstInptUserId}
	   			  	, #{sysFrstInptPrgrmId}
	   			  	, SYSDATE
	   			  	, #{sysLastChgUserId}
	   			  	, #{sysLastChgPrgrmId}
				)
    	]]>
    </insert>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.updateComAuthrtUi		-->
	<!-- DESC : 화면UI권한 변경.                                             			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.10.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <update id="updateComAuthrtUi" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtUiVO">
    	<![CDATA[
			UPDATE /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.updateComAuthrtUi */
	    		TB_COM_AUTH_UI
			   SET
			   	  APLCN_TYPE 	= #{aplcnType}
	    	    , INDCT_YN 		= #{indctYn}
	    	    , DEL_YN 		= 'N'
	    	    , SYS_LAST_CHG_DT		= SYSDATE
	    		, SYS_LAST_CHG_USER_ID	= #{sysLastChgUserId}
	    		, SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
			 WHERE AUTHRT_ID = #{authrtId}
			   AND MENU_ID = #{menuId}
			   AND ENTY_ID = #{entyId}
    	]]>
    </update>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.updateComAuthrtUiForDelY	-->
	<!-- DESC : 화면UI권한 변경: set delYn Y.											-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.10.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <update id="updateComAuthrtUiForDelY" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtUiVO">
    	<![CDATA[
			UPDATE /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.updateComAuthrtUiForDelY */
	    		TB_COM_AUTH_UI
			   SET
			   	  DEL_YN 	= 'Y'
	    	    , SYS_LAST_CHG_DT		= SYSDATE
	    		, SYS_LAST_CHG_USER_ID	= #{sysLastChgUserId}
	    		, SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
			 WHERE AUTHRT_ID = #{authrtId}
			   AND MENU_ID = #{menuId}
			   AND ENTY_ID = #{entyId}
    	]]>
    </update>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthrtMapper.deleteComAuthrtUi		-->
	<!-- DESC : 화면UI권한 삭제.                                             			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.10.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <delete id="deleteComAuthrtUi" parameterType="com.at.apcss.co.authrt.vo.ComAuthrtUiVO">
    	<![CDATA[
			DELETE /* com.at.apcss.co.authrt.mapper.ComAuthrtMapper.deleteComAuthrtUi */
	    		TB_COM_AUTH_UI
			 WHERE AUTHRT_ID = #{authrtId}
			   AND MENU_ID = #{menuId}
			   AND ENTY_ID = #{entyId}
    	]]>
    </delete>
    
</mapper>