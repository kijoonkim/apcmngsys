<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!-- ==========================================================================	-->
<!-- NAME : ComAuthMapper.xml                                    				-->
<!-- DESC : 권한 정보 mapper                                             			-->
<!-- ==========================================================================	-->
<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
<!-- ===========  	============  	===========================================	-->
<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
<!-- ==========================================================================	-->

<mapper namespace="com.at.apcss.co.authrt.mapper.ComAuthMapper">

	<!-- 권한 -->
	<resultMap type="com.at.apcss.co.authrt.vo.ComAuthVO" id="comAuthMap">
		<result property="authrtId" column="AUTHRT_ID" />
		<result property="authrtNm" column="AUTHRT_NM" />
		<result property="authrtType" column="AUTHRT_TYPE" />
		<result property="authrtRmrk" column="AUTHRT_RMRK" />
	</resultMap>
	
	<!-- 권한메뉴 -->
	<resultMap type="com.at.apcss.co.authrt.vo.ComAuthMenuVO" id="comAuthMenuMap">
		<result property="menuId" column="MENU_ID" />
		<result property="menuNm" column="MENU_NM" />
		<result property="upMenuId" column="UP_MENU_ID" />
		<result property="menuType" column="MENU_TYPE" />
		<result property="userType" column="USER_TYPE" />
		<result property="pageUrl" column="PAGE_URL" />
		<result property="indctSeq" column="INDCT_SEQ" />
		<result property="apcCd" column="APC_CD" />
		<result property="sysId" column="SYS_ID" />
		<result property="upMenuNm" column="UP_MENU_NM" />
		<result property="menuLvl" column="MENU_LVL" />
		<result property="menuSeq" column="MENU_SEQ" />
		
		<result property="authrtId" column="AUTHRT_ID" />		
	</resultMap>

	<!-- 권한 UI -->
	<resultMap type="com.at.apcss.co.authrt.vo.ComAuthUiVO" id="comAuthUiMap">
		<result property="menuId" column="MENU_ID" />
		<result property="menuNm" column="MENU_NM" />
		<result property="upMenuId" column="UP_MENU_ID" />
		<result property="menuType" column="MENU_TYPE" />
		<result property="userType" column="USER_TYPE" />
		<result property="pageUrl" column="PAGE_URL" />
		<result property="indctSeq" column="INDCT_SEQ" />
		<result property="apcCd" column="APC_CD" />
		<result property="sysId" column="SYS_ID" />
		<result property="upMenuNm" column="UP_MENU_NM" />
		<result property="menuLvl" column="MENU_LVL" />
		<result property="menuSeq" column="MENU_SEQ" />
		
		<result property="authrtId" column="AUTHRT_ID" />
		<result property="entyId" column="ENTY_ID" />
		<result property="entyType" column="ENTY_TYPE" />
		<result property="aplcnType" column="APLCN_TYPE" />
		<result property="indctYn" column="INDCT_YN" />
	</resultMap>


	<!-- 권한 User -->
	<resultMap type="com.at.apcss.co.authrt.vo.ComAuthUserVO" id="comAuthUserMap">
        <result property="userId" column="USER_ID"/>
        <result property="userNm" column="USER_NM"/>
		<result property="userType" column="USER_TYPE" />
		<result property="userStts" column="USER_STTS" />
		<result property="eml" column="EML" />
		<result property="mblTelno" column="MBL_TELNO" />
		<result property="apcCd" column="APC_CD" />
		<result property="ogdpNm" column="OGDP_NM" />
		<result property="chrgdCertYn" column="CHRGD_CERT_YN" />
		<result property="chrgdCertType" column="CHRGD_CERT_TYPE" />
		<result property="lckYn" column="LCK_YN" />
		<result property="lgnFailNmtm" column="LGN_FAIL_NMTM" />
		<result property="endLgnDt" column="END_LGN_DT" />
		<result property="endLgnIp" column="END_LGN_IP" />		

		<result property="authrtId" column="AUTHRT_ID" />
		<result property="authrtNm" column="AUTHRT_NM" />
	</resultMap>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthMapper.selectComAuth			-->
	<!-- DESC : 권한 단건조회.                                             				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectComAuth" parameterType="com.at.apcss.co.authrt.vo.ComAuthVO" resultMap="comAuthMap">
    	<![CDATA[
			SELECT /* com.at.apcss.co.authrt.mapper.ComAuthMapper.selectComAuth */
				  CA.AUTHRT_ID      AS AUTHRT_ID
		        , CA.AUTHRT_NM      AS AUTHRT_NM
				, CA.AUTHRT_TYPE    AS AUTHRT_TYPE
				, CA.AUTHRT_RMRK    AS AUTHRT_RMRK
				, CA.DEL_YN                 AS DEL_YN
		        , CA.SYS_FRST_INPT_DT       AS SYS_FRST_INPT_DT
		        , CA.SYS_FRST_INPT_USER_ID  AS SYS_FRST_INPT_USER_ID
		        , CA.SYS_FRST_INPT_PRGRM_ID AS SYS_FRST_INPT_PRGRM_ID
		        , CA.SYS_LAST_CHG_DT        AS SYS_LAST_CHG_DT
		        , CA.SYS_LAST_CHG_USER_ID   AS SYS_LAST_CHG_USER_ID
		        , CA.SYS_LAST_CHG_PRGRM_ID  AS SYS_LAST_CHG_PRGRM_ID
			  FROM TB_COM_AUTH CA
			 WHERE CA.AUTHRT_ID = #{authrtId}
    	]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthMapper.selectComAuthList		-->
	<!-- DESC : 권한 목록 조회.                                             			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectComAuthList" parameterType="com.at.apcss.co.authrt.vo.ComAuthVO" resultMap="comAuthMap">
    	<![CDATA[
			SELECT /* com.at.apcss.co.authrt.mapper.ComAuthMapper.selectComAuthList */
				  CA.AUTHRT_ID      AS AUTHRT_ID
		        , CA.AUTHRT_NM      AS AUTHRT_NM
				, CA.AUTHRT_TYPE    AS AUTHRT_TYPE
				, CA.AUTHRT_RMRK    AS AUTHRT_RMRK
			  FROM TB_COM_AUTH CA
			 WHERE CA.DEL_YN = 'N'
    	]]>
		<if test='authrtId != null and authrtId != ""'>
			   AND CA.AUTHRT_ID = #{authrtId}
		</if>
		<if test='authrtNm != null and authrtNm != ""'>
			   AND CA.AUTHRT_NM LIKE '%' || #{authrtNm} || '%'
		</if>
		<if test='authrtType != null and authrtType != ""'>
			   AND CA.AUTHRT_TYPE = #{authrtType}
		</if>
		<if test='authrtNm != null and authrtNm != ""'>
			   AND CA.AUTHRT_RMRK LIKE '%' || #{authrtNm} || '%'
		</if>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthMapper.selectComAuthMenuList	-->
	<!-- DESC : 권한 메뉴 목록 조회.                                             			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectComAuthMenuList" parameterType="com.at.apcss.co.authrt.vo.ComAuthVO" resultMap="comAuthMenuMap">
    	<![CDATA[
			SELECT /* com.at.apcss.co.authrt.mapper.ComAuthMapper.selectComAuthMenuList */
				  CA.AUTHRT_ID      AS AUTHRT_ID
		        , CA.AUTHRT_NM      AS AUTHRT_NM
				, CA.AUTHRT_TYPE    AS AUTHRT_TYPE
				, CA.AUTHRT_RMRK    AS AUTHRT_RMRK
				, CM.MENU_ID    	AS MENU_ID
				, CM.MENU_NM    	AS MENU_NM
				, CM.UP_MENU_ID 	AS UP_MENU_ID
				, CM.MENU_TYPE  	AS MENU_TYPE
				, CM.USER_TYPE  	AS USER_TYPE
				, CM.PAGE_URL   	AS PAGE_URL
				, CM.INDCT_SEQ  	AS INDCT_SEQ
				, CM.APC_CD   		AS APC_CD
			  FROM
			  	  TB_COM_AUTH CA
				, TB_COM_MENU CM
			 WHERE CA.AUTHRT_ID = CM.AUTHRT_ID(+)
			   AND CA.DEL_YN = 'N'
			   AND CM.DEL_YN(+) = 'N'			   
    	]]>
		<if test='authrtId != null and authrtId != ""'>
			   AND CA.AUTHRT_ID = #{authrtId}
		</if>
		<if test='authrtNm != null and authrtNm != ""'>
			   AND CA.AUTHRT_NM LIKE '%' || #{authrtNm} || '%'
		</if>
		<if test='authrtType != null and authrtType != ""'>
			   AND CA.AUTHRT_TYPE = #{authrtType}
		</if>
		<if test='authrtRmrk != null and authrtRmrk != ""'>
			   AND CA.AUTHRT_RMRK LIKE '%' || #{authrtRmrk} || '%'
		</if>
		<if test='menuId != null and menuId != ""'>
			AND CM.MENU_ID = #{menuId}
		</if>
		<if test='menuNm != null and menuNm != ""'>
			AND CM.MENU_NM LIKE '%' || #{menuNm} || '%'
		</if>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthMapper.selectComAuthUiList		-->
	<!-- DESC : 권한 화면 목록 조회.                                             			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectComAuthUiList" parameterType="com.at.apcss.co.authrt.vo.ComAuthVO" resultMap="comAuthUiMap">
    	<![CDATA[
			SELECT /* com.at.apcss.co.authrt.mapper.ComAuthMapper.selectComAuthUiList */
				  CA.AUTHRT_ID  	AS AUTHRT_ID
		        , CM.MENU_ID		AS MENU_ID
				, AU.ENTY_ID		AS ENTY_ID
				, AU.APLCN_TYPE 	AS APLCN_TYPE
				, AU.INDCT_YN		AS INDCT_YN
			  FROM
			  	  TB_COM_AUTH CA
				, TB_COM_MENU CM
			  	, TB_COM_AUTH_UI AU
			 WHERE CA.AUTHRT_ID = AU.AUTHRT_ID
			   AND CM.MENU_ID = AU.MENU_ID
			   AND CA.DEL_YN = 'N'
			   AND CM.DEL_YN(+) = 'N'
    	]]>
		<if test='authrtId != null and authrtId != ""'>
			   AND CA.AUTHRT_ID = #{authrtId}
		</if>
		<if test='authrtNm != null and authrtNm != ""'>
			   AND CA.AUTHRT_NM LIKE '%' || #{authrtNm} || '%'
		</if>
		<if test='authrtType != null and authrtType != ""'>
			   AND CA.AUTHRT_TYPE = #{authrtType}
		</if>
		<if test='authrtRmrk != null and authrtRmrk != ""'>
			   AND CA.AUTHRT_RMRK LIKE '%' || #{authrtRmrk} || '%'
		</if>
		<if test='menuId != null and menuId != ""'>
			AND CM.MENU_ID = #{menuId}
		</if>
		<if test='menuNm != null and menuNm != ""'>
			AND CM.MENU_NM LIKE '%' || #{menuNm} || '%'
		</if>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.co.authrt.mapper.ComAuthMapper.selectComAuthUserList	-->
	<!-- DESC : 권한 화면 목록 조회.                                             			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.05.25  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectComAuthUserList" parameterType="com.at.apcss.co.authrt.vo.ComAuthUserVO" resultMap="comAuthUserMap">
    	<![CDATA[
			SELECT /* com.at.apcss.co.user.ComAuthMapper.selectComAuthUserList */
				  CA.AUTHRT_ID          AS AUTHRT_ID
			    , CA.AUTHRT_NM          AS AUTHRT_NM
			    , CU.USER_ID            AS USER_ID
			    , CU.USER_NM            AS USER_NM
			    , CU.USER_TYPE          AS USER_TYPE
			    , CU.USER_STTS          AS USER_STTS
			    , CU.EML                AS EML
			    , CU.MBL_TELNO          AS MBL_TELNO
			    , CU.APC_CD             AS APC_CD
			    , CU.OGDP_NM            AS OGDP_NM
			    , CU.CHRGD_CERT_YN      AS CHRGD_CERT_YN
			    , CU.CHRGD_CERT_TYPE    AS CHRGD_CERT_TYPE
			    , CU.LCK_YN             AS LCK_YN
			    , CU.LGN_FAIL_NMTM      AS LGN_FAIL_NMTM
			    , CU.END_LGN_DT         AS END_LGN_DT
			    , CU.END_LGN_IP         AS END_LGN_IP
			  FROM
			      TB_COM_AUTH CA
			  	, TB_COM_AUTH_USER AU
			  	, TB_COM_USER CU
			 WHERE CA.AUTHRT_ID = AU.AUTHRT_ID
			   AND AU.USER_ID = CU.USER_ID
			   AND CA.DEL_YN = 'N'
			   AND AU.DEL_YN = 'N'
			   AND CU.DEL_YN = 'N'
    	]]>
		<if test='authrtId != null and authrtId != ""'>
			   AND CA.AUTHRT_ID = #{authrtId}
		</if>
		<if test='authrtNm != null and authrtNm != ""'>
			   AND CU.AUTHRT_NM LIKE '%' || #{authrtNm} || '%'
		</if>
		<if test='userId != null and userId != ""'>
			   AND CU.USER_ID = #{userId}
		</if>
		<if test='userNm != null and userNm != ""'>
			   AND CU.USER_NM LIKE '%' || #{userNm} || '%'
		</if>
		<if test='userType != null and userType != ""'>
			   AND CU.USER_TYPE = #{userType}
		</if>
		<if test='userStts != null and userStts != ""'>
			   AND CU.USER_STTS = #{userStts}
		</if>
		<if test='apcCd != null and apcCd != ""'>
			   AND CU.APC_CD = #{apcCd}
		</if>
		<if test='ogdpNm != null and ogdpNm != ""'>
			   AND CU.OGDP_NM LIKE '%' || #{ogdpNm} || '%'
		</if>
		
    	<![CDATA[
    		 ORDER BY AUTHRT_ID, USER_ID, USER_NM
    	]]>	
    </select>
    
</mapper>