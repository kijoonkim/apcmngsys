<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!-- ==========================================================================	-->
<!-- NAME : RawMtrWrhsPlanMapper.xml                                   			-->
<!-- DESC : 계량입고계획 mapper                                            		-->
<!-- ==========================================================================	-->
<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
<!-- ===========  	============  	===========================================	-->
<!-- 2023.08.08  	김 호        		Initial Creation                        -->
<!-- ==========================================================================	-->

<mapper namespace="com.at.apcss.am.whrs.mapper.RawMtrWrhsPlanMapper">


	<!-- ================================================================================	-->
	<!-- NAME : com.at.apcss.am.whrs.mapper.RawMtrWrhsPlanMapper.selectRawMtrWrhsPlan		-->
	<!-- DESC : 계량입고계획 단건 조회.	                                       				-->
	<!-- ================================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
	<!-- ===========  	============  	=================================================	-->
	<!-- 2023.08.08  	 김 호        		Initial Creation                        		-->
	<!-- ================================================================================	-->
    <select id="selectRawMtrWrhsPlan" parameterType="com.at.apcss.am.whrs.vo.RawMtrWrhsPlanVO" resultType="com.at.apcss.am.whrs.vo.RawMtrWrhsPlanVO">
    	<![CDATA[
	    	SELECT /* com.at.apcss.am.whrs.mapper.RawMtrWrhsPlanMapper.selectRawMtrWrhsPlan */
			       WP.APC_CD            AS APC_CD
			     , WP.PLANNO            AS PLANNO
			     , WP.PLAN_YMD          AS PLAN_YMD
			     , WP.PLAN_HR           AS PLAN_HR
			     , WP.PRDCR_CD          AS PRDCR_CD
			     , WP.PRDCR_NM          AS PRDCR_NM
			     , WP.ITEM_CD           AS ITEM_CD
			     , (SELECT FN_GET_ITEM_NM(WP.ITEM_CD, WP.APC_CD) FROM DUAL) AS ITEM_NM
			     , WP.VRTY_CD           AS VRTY_CD
			     , (SELECT FN_GET_VRTY_NM(WP.VRTY_CD, WP.APC_CD) FROM DUAL) AS VRTY_NM
			     , WP.GDS_SE_CD         AS GDS_SE_CD
			     , (SELECT FN_GET_COM_CD_VL_NM('GDS_SE_CD', WP.GDS_SE_CD ) FROM DUAL ) AS GDS_SE_NM
			     , WP.WRHS_SE_CD        AS WRHS_SE_CD
			     , (SELECT FN_GET_COM_CD_VL_NM('WRHS_SE_CD', WP.WRHS_SE_CD ) FROM DUAL ) AS WRHS_SE_NM
			     , WP.TRSPRT_SE_CD      AS TRSPRT_SE_CD
			     , (SELECT FN_GET_COM_CD_VL_NM('TRSPRT_SE_CD', WP.TRSPRT_SE_CD ) FROM DUAL ) AS TRSPRT_SE_NM
			     , WP.WAREHOUSE_SE_CD   AS WAREHOUSE_SE_CD
			     , (SELECT FN_GET_COM_CD_VL_NM('WAREHOUSE_SE_CD', WP.WAREHOUSE_SE_CD, WP.APC_CD ) FROM DUAL ) AS WAREHOUSE_SE_NM
			     , WP.PLAN_QNTT         AS PLAN_QNTT
			     , WP.PLAN_WGHT         AS PLAN_WGHT
			     , WP.RMRK              AS RMRK
			     , WP.DEL_YN            AS DEL_YN
			  FROM TB_RAW_MTR_WRHS_PLAN WP
			 WHERE WP.APC_CD	= #{apcCd}
			   AND WP.PLANNO	= #{planno}
		]]>
    </select>

	<!-- ================================================================================	-->
	<!-- NAME : com.at.apcss.am.whrs.mapper.RawMtrWrhsPlanMapper.selectRawMtrWrhsPlanList	-->
	<!-- DESC : 계량입고계획 목록 조회.	                                       				-->
	<!-- ================================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
	<!-- ===========  	============  	=================================================	-->
	<!-- 2023.08.08  	 김 호        		Initial Creation                        		-->
	<!-- ================================================================================	-->
    <select id="selectRawMtrWrhsPlanList" parameterType="com.at.apcss.am.whrs.vo.RawMtrWrhsVO" resultType="com.at.apcss.am.whrs.vo.RawMtrWrhsVO">
    	<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    		SELECT
    			  ROWNUM AS ROW_SEQ
    			, COUNT(*) OVER() AS TOTAL_RECORD_COUNT
    			, pt0.*
    		  FROM (
    	</if>
    	<!-- End 페이징 -->
    	<![CDATA[
	    	SELECT /* com.at.apcss.am.whrs.mapper.RawMtrWrhsPlanMapper.selectRawMtrWrhsPlanList */
			       WP.APC_CD            AS APC_CD
			     , WP.PLANNO            AS PLANNO
			     , WP.PLAN_YMD          AS PLAN_YMD
			     , WP.PLAN_HR           AS PLAN_HR
			     , WP.PRDCR_CD          AS PRDCR_CD
			     , WP.PRDCR_NM          AS PRDCR_NM
			     , WP.ITEM_CD           AS ITEM_CD
			     , (SELECT FN_GET_ITEM_NM(WP.ITEM_CD, WP.APC_CD) FROM DUAL) AS ITEM_NM
			     , WP.VRTY_CD           AS VRTY_CD
			     , (SELECT FN_GET_VRTY_NM(WP.VRTY_CD, WP.APC_CD) FROM DUAL) AS VRTY_NM
			     , WP.GDS_SE_CD         AS GDS_SE_CD
			     , (SELECT FN_GET_COM_CD_VL_NM('GDS_SE_CD', WP.GDS_SE_CD ) FROM DUAL ) AS GDS_SE_NM
			     , WP.WRHS_SE_CD        AS WRHS_SE_CD
			     , (SELECT FN_GET_COM_CD_VL_NM('WRHS_SE_CD', WP.WRHS_SE_CD ) FROM DUAL ) AS WRHS_SE_NM
			     , WP.TRSPRT_SE_CD      AS TRSPRT_SE_CD
			     , (SELECT FN_GET_COM_CD_VL_NM('TRSPRT_SE_CD', WP.TRSPRT_SE_CD ) FROM DUAL ) AS TRSPRT_SE_NM
			     , WP.WAREHOUSE_SE_CD   AS WAREHOUSE_SE_CD
			     , (SELECT FN_GET_COM_CD_VL_NM('WAREHOUSE_SE_CD', WP.WAREHOUSE_SE_CD, WP.APC_CD ) FROM DUAL ) AS WAREHOUSE_SE_NM
			     , WP.PLAN_QNTT         AS PLAN_QNTT
			     , WP.PLAN_WGHT         AS PLAN_WGHT
			     , WP.RMRK              AS RMRK
			     , WP.DEL_YN            AS DEL_YN
			  FROM TB_RAW_MTR_WRHS_PLAN WP
			 WHERE WP.APC_CD	= #{apcCd}
		]]>

		<if test='prdcrCd != null and prdcrCd != ""'>
			   AND WP.PRDCR_CD = #{prdcrCd}
		</if>
		<if test='planYmdFrom != null and planYmdFrom != ""'>
			   AND WP.PLAN_YMD <![CDATA[>=]]> #{planYmdFrom}
		</if>
		<if test='planYmdTo != null and planYmdTo != ""'>
			   AND WP.PLAN_YMD <![CDATA[<=]]> #{planYmdTo}
		</if>

		<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    		  ) pt0
			OFFSET (#{currentPageNo} - 1) * #{recordCountPerPage} ROWS
			FETCH FIRST #{recordCountPerPage} ROWS ONLY
    	</if>
    	<!-- End 페이징 -->
    </select>


	<!-- ================================================================================	-->
	<!-- NAME : com.at.apcss.am.whrs.mapper.RawMtrWrhsPlanMapper.selectRawMtrWrhsPlanList	-->
	<!-- DESC : 계량입고계획 목록 조회.	                                       				-->
	<!-- ================================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
	<!-- ===========  	============  	=================================================	-->
	<!-- 2023.08.08  	 김 호        		Initial Creation                        		-->
	<!-- ================================================================================	-->
    <insert id="insertRawMtrWrhsPlan" parameterType="com.at.apcss.am.whrs.vo.RawMtrWrhsVO">
    	<![CDATA[
	    	INSERT /* com.at.apcss.am.whrs.mapper.RawMtrWrhsMapper.insertRawMtrWrhs */
	    		INTO TB_RAW_MTR_WRHS_PRFMNC
				(
					  APC_CD
					, WRHSNO
					, WGHNO
					, PLTNO
					, WRHS_YMD
					, PRDCR_CD
					, VHCLNO
					, WRHS_WGHT
					, BX_QNTT
					, RMRK
		    		, SYS_FRST_INPT_DT
		    		, SYS_FRST_INPT_USER_ID
		    		, SYS_FRST_INPT_PRGRM_ID
		    		, SYS_LAST_CHG_DT
		    		, SYS_LAST_CHG_USER_ID
		    		, SYS_LAST_CHG_PRGRM_ID
	    		)
	   		VALUES
	   			(
					  #{apcCd}
					, #{wrhsno}
					, #{wghno}
					, #{pltno}
					, #{wrhsYmd}
					, #{prdcrCd}
					, #{vhclno}
					, #{wrhsWght}
					, #{bxQntt}
					, #{rmrk}
		    		, SYSDATE
		    		, #{sysFrstInptUserId}
		    		, #{sysFrstInptPrgrmId}
		    		, SYSDATE
		    		, #{sysLastChgUserId}
		    		, #{sysLastChgPrgrmId}
	   			)
    	]]>
    </insert>

	<!-- ================================================================================	-->
	<!-- NAME : com.at.apcss.am.whrs.mapper.RawMtrWrhsPlanMapper.selectRawMtrWrhsPlanList	-->
	<!-- DESC : 계량입고계획 목록 조회.	                                       				-->
	<!-- ================================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
	<!-- ===========  	============  	=================================================	-->
	<!-- 2023.08.08  	 김 호        		Initial Creation                        		-->
	<!-- ================================================================================	-->
    <update id="updateRawMtrWrhsPlan" parameterType="com.at.apcss.am.whrs.vo.RawMtrWrhsVO">
		<![CDATA[
			UPDATE /* com.at.apcss.am.whrs.mapper.RawMtrWrhsMapper.updateRawMtrWrhs */
				TB_RAW_MTR_WRHS_PRFMNC
			   SET
			   	  SYS_LAST_CHG_DT 			= SYSDATE
	    		, SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
	    		, SYS_LAST_CHG_PRGRM_ID 	= #{sysLastChgPrgrmId}

	    		, PLTNO		= #{pltno}
				, WRHS_YMD	= #{wrhsYmd}
				, PRDCR_CD	= #{prdcrCd}
				, VHCLNO	= #{vhclno}
				, WRHS_WGHT	= #{wrhsWght}
				, BX_QNTT	= #{bxQntt}
				, RMRK		= #{rmrk}

			<if test='delYn != null and delYn != ""'>
				, DEL_YN			= #{delYn}
			</if>

			 WHERE APC_CD = #{apcCd}
			   AND WRHSNO = #{wghno}
		]]>
	</update>

	<!-- ================================================================================	-->
	<!-- NAME : com.at.apcss.am.whrs.mapper.RawMtrWrhsPlanMapper.selectRawMtrWrhsPlanList	-->
	<!-- DESC : 계량입고계획 목록 조회.	                                       				-->
	<!-- ================================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
	<!-- ===========  	============  	=================================================	-->
	<!-- 2023.08.08  	 김 호        		Initial Creation                        		-->
	<!-- ================================================================================	-->
	<delete id="deleteRawMtrWrhsPlan" parameterType="com.at.apcss.am.whrs.vo.RawMtrWrhsVO">
		<![CDATA[
			DELETE /* com.at.apcss.am.whrs.mapper.RawMtrWrhsMapper.deleteRawMtrWrhs */
			  FROM TB_RAW_MTR_WRHS_PRFMNC
			 WHERE APC_CD = #{apcCd}
			   AND WRHSNO = #{wghno}
		]]>
	</delete>

</mapper>