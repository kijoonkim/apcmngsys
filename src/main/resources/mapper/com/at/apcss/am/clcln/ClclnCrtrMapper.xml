<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!-- ==========================================================================	-->
<!-- NAME : ClclnCrtrMapper.xml                                   			-->
<!-- DESC : 정산기준 mapper                   				                 	-->
<!-- ==========================================================================	-->
<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
<!-- ===========  	============  	===========================================	-->
<!-- 2024.09.21  	신정철        	Initial Creation                            -->
<!-- ==========================================================================	-->

<mapper namespace="com.at.apcss.am.clcln.mapper.ClclnCrtrMapper">

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.selectClclnCrtr		-->
	<!-- DESC : 정산기준 단건 조회.	                         	             	 	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectClclnCrtr" parameterType="com.at.apcss.am.clcln.vo.ClclnCrtrVO" resultType="com.at.apcss.am.clcln.vo.ClclnCrtrVO">
    	<![CDATA[
    		SELECT /* com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.selectClclnCrtr */
				  CC.APC_CD				AS APC_CD
				, CC.CLCLN_CRTR_TYPE	AS CLCLN_CRTR_TYPE
				, CC.CRTR_CD			AS CRTR_CD
				, CC.CRTR_VL			AS CRTR_VL
				, CC.CRTR_INDCT_NM		AS CRTR_INDCT_NM
				, CC.INDCT_SEQ			AS INDCT_SEQ
				, CC.USE_YN				AS USE_YN
				, CC.CLCLN_DTL_TYPE		AS CLCLN_DTL_TYPE
				, CC.DEL_YN				AS DEL_YN
				
				, (
					SELECT MAX(X.DTL_SN) 
					  FROM TB_CLCLN_CRTR_DTL X 
					 WHERE X.APC_CD = CC.APC_CD
					   AND X.CLCLN_CRTR_TYPE = CC.CLCLN_CRTR_TYPE
					   AND X.CRTR_CD = CC.CRTR_CD
				)	AS MAX_DTL_SN
				
			  FROM TB_CLCLN_CRTR CC
			  
			 WHERE CC.APC_CD = #{apcCd}
			   AND CC.CLCLN_CRTR_TYPE = #{clclnCrtrType}
			   AND CC.CRTR_CD = #{crtrCd}
		]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.selectClclnCrtrList	-->
	<!-- DESC : 정산기준 목록 조회.	                         	             	 	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectClclnCrtrList" parameterType="com.at.apcss.am.clcln.vo.ClclnCrtrVO" resultType="com.at.apcss.am.clcln.vo.ClclnCrtrVO">
    	<![CDATA[
    		SELECT /* com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.selectClclnCrtrList */
    		
				  CC.APC_CD				AS APC_CD
				, CC.CLCLN_CRTR_TYPE	AS CLCLN_CRTR_TYPE
				, CT.CD_VL_NM			AS CLCLN_CRTR_TYPE_NM
				, CT.INDCT_SEQ			AS CRTR_TYPE_SEQ
				, CC.CRTR_CD			AS CRTR_CD
				, CC.CRTR_VL			AS CRTR_VL
				, CC.CRTR_INDCT_NM		AS CRTR_INDCT_NM
				, CC.INDCT_SEQ			AS INDCT_SEQ
				, CC.INDCT_SEQ			AS CRTR_SEQ
				, CC.USE_YN				AS USE_YN
				, CC.CLCLN_DTL_TYPE		AS CLCLN_DTL_TYPE
				, CC.CRTR_RMRK			AS CRTR_RMRK
				
			  FROM TB_CLCLN_CRTR CC
			  
			  JOIN TB_COM_CD_DTL CT
			    ON CT.CD_ID = 'CLCLN_CRTR_TYPE'
			   AND CT.APC_CD = '0000'
			   AND CT.CD_VL = CC.CLCLN_CRTR_TYPE
			   AND CT.DEL_YN = 'N'
			   
			 WHERE CC.DEL_YN = 'N'
		]]>
		
		<if test='apcCd != null and apcCd != ""'>
		       AND CC.APC_CD = #{apcCd}
		</if>

		<if test='clclnCrtrType != null and clclnCrtrType != ""'>
		       AND CC.CLCLN_CRTR_TYPE = #{clclnCrtrType}
		</if>

		<if test='crtrCd != null and crtrCd != ""'>
		       AND CC.CRTR_CD = #{crtrCd}
		</if>
		
		<if test='crtrIndctNm != null and crtrIndctNm != ""'>
			   AND CC.CRTR_INDCT_NM LIKE '%' || #{crtrIndctNm} || '%'
		</if>
		
		<if test='useYn != null and useYn != ""'>
		       AND CC.USE_YN = #{useYn}
		</if>
		
    	<![CDATA[
			 ORDER BY CRTR_TYPE_SEQ, CRTR_SEQ
		]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.selectClclnCrtrDtl		-->
	<!-- DESC : 정산기준 상세 단건 조회.                       	             	 	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectClclnCrtrDtl" parameterType="com.at.apcss.am.clcln.vo.ClclnCrtrVO" resultType="com.at.apcss.am.clcln.vo.ClclnCrtrVO">
    	<![CDATA[
    		SELECT /* com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.selectClclnCrtrDtl */
				  CD.APC_CD				AS APC_CD
				, CD.CLCLN_CRTR_TYPE	AS CLCLN_CRTR_TYPE
				, CD.CRTR_CD			AS CRTR_CD
				, CD.DTL_SN				AS DTL_SN
				, CD.DTL_CD				AS DTL_CD
				, CD.DTL_VL				AS DTL_VL
				, CD.DTL_INDCT_NM		AS DTL_INDCT_NM
				, CD.USE_YN				AS USE_YN
				, CD.USE_YN				AS CRTR_DTL_USE_YN
				, CD.DTL_CRTR_CD		AS DTL_CRTR_CD
				, CD.DEL_YN				AS DEL_YN
				
			  FROM TB_CLCLN_CRTR_DTL CD
			  
			 WHERE CD.APC_CD = #{apcCd}
			   AND CD.CLCLN_CRTR_TYPE = #{clclnCrtrType}
			   AND CD.CRTR_CD = #{crtrCd}
			   AND CD.DTL_SN = #{dtlSn}
		]]>
    </select>
    
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.selectClclnCrtrDtlList	-->
	<!-- DESC : 정산기준 상세 목록 조회.	                         	            -->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectClclnCrtrDtlList" parameterType="com.at.apcss.am.clcln.vo.ClclnCrtrVO" resultType="com.at.apcss.am.clcln.vo.ClclnCrtrVO">
    	<![CDATA[
    		SELECT /* com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.selectClclnCrtrDtlList */
    		
				  CC.APC_CD				AS APC_CD
				, CC.CLCLN_CRTR_TYPE	AS CLCLN_CRTR_TYPE
				, CT.CD_VL_NM			AS CLCLN_CRTR_TYPE_NM
				, CT.INDCT_SEQ			AS CRTR_TYPE_SEQ
				, CC.CRTR_CD			AS CRTR_CD
				, CC.CRTR_VL			AS CRTR_VL
				, CC.CRTR_INDCT_NM		AS CRTR_INDCT_NM
				, CC.INDCT_SEQ			AS CRTR_SEQ
				, CC.USE_YN				AS CRTR_USE_YN
				, CC.CLCLN_DTL_TYPE		AS CLCLN_DTL_TYPE

				, CD.DTL_SN				AS DTL_SN
				, CD.DTL_CD				AS DTL_CD
				, CD.DTL_VL				AS DTL_VL
				, CD.DTL_INDCT_NM		AS DTL_INDCT_NM
				, CD.USE_YN				AS CRTR_DTL_USE_YN
				, CD.DTL_CRTR_CD		AS DTL_CRTR_CD
				, CD.DTL_LNKG_CD		AS DTL_LNKG_CD
				, CD.INDCT_SEQ			AS INDCT_SEQ
				, CD.INDCT_SEQ			AS CRTR_DTL_SEQ				
				, CD.USE_YN				AS USE_YN
				
			  FROM TB_CLCLN_CRTR CC
			  
			  JOIN TB_COM_CD_DTL CT
			    ON CT.CD_ID = 'CLCLN_CRTR_TYPE'
			   AND CT.APC_CD = '0000'
			   AND CT.CD_VL = CC.CLCLN_CRTR_TYPE
			   AND CT.DEL_YN = 'N'
			   
			  LEFT JOIN TB_CLCLN_CRTR_DTL CD
			    ON CD.APC_CD = CC.APC_CD
			   AND CD.CLCLN_CRTR_TYPE = CC.CLCLN_CRTR_TYPE
			   AND CD.CRTR_CD = CC.CRTR_CD
			   AND CD.DEL_YN = 'N'
			   
			 WHERE CC.DEL_YN = 'N'
		]]>
		
		<if test='apcCd != null and apcCd != ""'>
		       AND CC.APC_CD = #{apcCd}
		</if>
		
		<if test='clclnCrtrType != null and clclnCrtrType != ""'>
		       AND CC.CLCLN_CRTR_TYPE = #{clclnCrtrType}
		</if>

		<if test='crtrCd != null and crtrCd != ""'>
		       AND CC.CRTR_CD = #{crtrCd}
		</if>

		<if test='crtrUseYn != null and crtrUseYn != ""'>
		       AND CC.USE_YN = #{crtrUseYn}
		</if>
		
		<if test='crtrDtlUseYn != null and crtrDtlUseYn != ""'>
		       AND CD.USE_YN = #{crtrDtlUseYn}
		</if>
		
    	<![CDATA[
			 ORDER BY CRTR_TYPE_SEQ, CRTR_SEQ, CRTR_DTL_SEQ, DTL_SN
		]]>
    </select>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.selectClclnCrtrDtlList	-->
	<!-- DESC : 정산기준 상세 목록 조회.	                         	            -->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectCrtrDtlList" parameterType="com.at.apcss.am.clcln.vo.ClclnCrtrVO" resultType="com.at.apcss.am.clcln.vo.ClclnCrtrVO">
    	<![CDATA[
    		SELECT /* com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.selectCrtrDtlList */
    		
				  CD.APC_CD				AS APC_CD
				, CD.CLCLN_CRTR_TYPE	AS CLCLN_CRTR_TYPE
				, CD.CRTR_CD			AS CRTR_CD

				, CD.DTL_SN				AS DTL_SN
				, CD.DTL_CD				AS DTL_CD
				, CD.DTL_VL				AS DTL_VL
				, CD.DTL_INDCT_NM		AS DTL_INDCT_NM
				, CD.USE_YN				AS CRTR_DTL_USE_YN
				, CD.DTL_CRTR_CD		AS DTL_CRTR_CD
				, CD.USE_YN				AS USE_YN
				
			  FROM TB_CLCLN_CRTR_DTL CD
			   
			 WHERE CD.DEL_YN = 'N'
		       AND CD.APC_CD = #{apcCd}
		       AND CD.CLCLN_CRTR_TYPE = #{clclnCrtrType}
		       AND CD.CRTR_CD = #{crtrCd}
		]]>
    </select>
    
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.insertClclnCrtr		-->
	<!-- DESC : 정산기준 등록.		                         	             	 	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <insert id="insertClclnCrtr" parameterType="com.at.apcss.am.clcln.vo.ClclnCrtrVO">
    	<![CDATA[
    		INSERT /* com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.insertClclnCrtr */
    		  INTO TB_CLCLN_CRTR (
				  APC_CD
				, CLCLN_CRTR_TYPE
				, CRTR_CD
				, CRTR_VL
				, CRTR_INDCT_NM
				, INDCT_SEQ
				, USE_YN
				, CLCLN_DTL_TYPE
				, CRTR_RMRK
				, DEL_YN
				, SYS_FRST_INPT_DT
				, SYS_FRST_INPT_USER_ID
				, SYS_FRST_INPT_PRGRM_ID
				, SYS_LAST_CHG_DT
				, SYS_LAST_CHG_USER_ID
				, SYS_LAST_CHG_PRGRM_ID
			) VALUES (
				  #{apcCd}
				, #{clclnCrtrType}
				, #{crtrCd}
				, #{crtrVl}
				, #{crtrIndctNm}
				, #{indctSeq}
				, #{useYn}
				, #{clclnDtlType}
				, #{crtrRmrk}
				, 'N'
    		    , SYSDATE
    		    , #{sysFrstInptUserId}
    		    , #{sysFrstInptPrgrmId}
    		    , SYSDATE
    		    , #{sysLastChgUserId}
    		    , #{sysLastChgPrgrmId}
			)
		]]>
    </insert>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.updateClclnCrtr		-->
	<!-- DESC : 정산기준 변경.	                         	             	 		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <update id="updateClclnCrtr" parameterType="com.at.apcss.am.clcln.vo.ClclnCrtrVO">
    	<![CDATA[
    		UPDATE /* com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.updateClclnCrtr */
    		  TB_CLCLN_CRTR
    		SET
				  SYS_LAST_CHG_DT 			= SYSDATE
	    		, SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
	    		, SYS_LAST_CHG_PRGRM_ID 	= #{sysLastChgPrgrmId}
	    		
				, CRTR_VL			= #{crtrVl}
				, CRTR_INDCT_NM		= #{crtrIndctNm}
				, INDCT_SEQ			= #{indctSeq}
				, USE_YN			= #{useYn}
				, CLCLN_DTL_TYPE	= #{clclnDtlType}
				, CRTR_RMRK			= #{crtrRmrk}
				
			 WHERE APC_CD = #{apcCd}
			   AND CLCLN_CRTR_TYPE = #{clclnCrtrType}
			   AND CRTR_CD = #{crtrCd}
		]]>
    </update>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.deleteClclnCrtr		-->
	<!-- DESC : 정산기준 삭제.	                         	             	 		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <delete id="deleteClclnCrtr" parameterType="com.at.apcss.am.clcln.vo.ClclnCrtrVO">
    	<![CDATA[
    		DELETE /* com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.deleteClclnCrtr */
    		  TB_CLCLN_CRTR
			 WHERE APC_CD = #{apcCd}
			   AND CLCLN_CRTR_TYPE = #{clclnCrtrType}
			   AND CRTR_CD = #{crtrCd}
		]]>
    </delete>
    
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.insertClclnCrtrDtl		-->
	<!-- DESC : 정산기준 상세 등록.		                         	             	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <insert id="insertClclnCrtrDtl" parameterType="com.at.apcss.am.clcln.vo.ClclnCrtrVO">
    	<![CDATA[
    		INSERT /* com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.insertClclnCrtrDtl */
    		  INTO TB_CLCLN_CRTR_DTL (
				  APC_CD
				, CLCLN_CRTR_TYPE
				, CRTR_CD
				, DTL_SN
				, DTL_CD
				, DTL_VL
				, DTL_INDCT_NM
				, INDCT_SEQ
				, USE_YN
				, DTL_CRTR_CD
				, DTL_LNKG_CD
				, DEL_YN
				, SYS_FRST_INPT_DT
				, SYS_FRST_INPT_USER_ID
				, SYS_FRST_INPT_PRGRM_ID
				, SYS_LAST_CHG_DT
				, SYS_LAST_CHG_USER_ID
				, SYS_LAST_CHG_PRGRM_ID
			) VALUES (
				  #{apcCd}
				, #{clclnCrtrType}
				, #{crtrCd}
				, #{dtlSn}
				, #{dtlCd}
				, #{dtlVl}
				, #{dtlIndctNm}
				, #{indctSeq}
				, #{useYn}
				, #{dtlCrtrCd}
				, #{dtlLnkgCd}
				, 'N'
    		    , SYSDATE
    		    , #{sysFrstInptUserId}
    		    , #{sysFrstInptPrgrmId}
    		    , SYSDATE
    		    , #{sysLastChgUserId}
    		    , #{sysLastChgPrgrmId}
			)
		]]>
    </insert>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.updateClclnCrtrDtl		-->
	<!-- DESC : 정산기준 상세 변경.                         	             	 	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <update id="updateClclnCrtrDtl" parameterType="com.at.apcss.am.clcln.vo.ClclnCrtrVO">
    	<![CDATA[
    		UPDATE /* com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.updateClclnCrtrDtl */
    		  TB_CLCLN_CRTR_DTL
    		SET
				  SYS_LAST_CHG_DT 			= SYSDATE
	    		, SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
	    		, SYS_LAST_CHG_PRGRM_ID 	= #{sysLastChgPrgrmId}
	    		
				, DTL_CD			= #{dtlCd}
				, DTL_VL			= #{dtlVl}
				, DTL_INDCT_NM		= #{dtlIndctNm}
				, DTL_CRTR_CD		= #{dtlCrtrCd}
				, DTL_LNKG_CD		= #{dtlLnkgCd}
				, INDCT_SEQ			= #{indctSeq}
				, USE_YN			= #{useYn}
				
			 WHERE APC_CD = #{apcCd}
			   AND CLCLN_CRTR_TYPE = #{clclnCrtrType}
			   AND CRTR_CD = #{crtrCd}
			   AND DTL_SN = #{dtlSn}
		]]>
    </update>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.deleteClclnCrtrDtl		-->
	<!-- DESC : 정산기준 상세 삭제.                       	             	 		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <delete id="deleteClclnCrtrDtl" parameterType="com.at.apcss.am.clcln.vo.ClclnCrtrVO">
    	<![CDATA[
    		DELETE /* com.at.apcss.am.clcln.mapper.ClclnCrtrMapper.deleteClclnCrtrDtl */
    		  TB_CLCLN_CRTR_DTL
			 WHERE CD.APC_CD = #{apcCd}
			   AND CD.CLCLN_CRTR_TYPE = #{clclnCrtrType}
			   AND CD.CRTR_CD = #{crtrCd}
			   AND CD.DTL_SN = #{dtlSn}
		]]>
    </delete>
    
</mapper>


