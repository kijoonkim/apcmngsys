<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!-- ==========================================================================	-->
<!-- NAME : RawMtrWrhsMapper.xml                                   				-->
<!-- DESC : 영농관리 mapper                                            			-->
<!-- ==========================================================================	-->
<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
<!-- ===========  	============  	===========================================	-->
<!-- 2024.06.26  	김  호        		Initial Creation                        -->
<!-- ==========================================================================	-->

<mapper namespace="com.at.apcss.am.wrhs.mapper.FrmerInfoMapper">


	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.selectGetCltvtnBscInfoNo	-->
	<!-- DESC : 영농관리 - 재배기본정보번호 발번.                    					-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
	<select id="selectGetCltvtnBscInfoNo" parameterType="com.at.apcss.am.wrhs.vo.CltvtnBscInfoVO" resultType="string">
		<![CDATA[
			SELECT FN_GET_ID_CLTVTN_BSC_INFO(#{apcCd} , #{prdcrCd}) AS CLTVTN_BSC_INFO_NO FROM DUAL
		]]>
	</select>

	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.selectGetCltvtnHstryNo		-->
	<!-- DESC : 영농관리 - 재배이력번호 발번.                    						-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
	<select id="selectGetCltvtnHstryNo" parameterType="com.at.apcss.am.wrhs.vo.CltvtnHstryVO" resultType="string">
		<![CDATA[
			SELECT FN_GET_ID_CLTVTN_HSTRY(#{apcCd} , #{prdcrCd}, #{prdcrLandInfoNo}) AS CLTVTN_HSTRY_NO FROM DUAL
		]]>
	</select>

	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.selectGetCltvtnFrmhsQltNo	-->
	<!-- DESC : 영농관리 - 재배농가품질번호 발번.                    					-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
	<select id="selectGetCltvtnFrmhsQltNo" parameterType="com.at.apcss.am.wrhs.vo.CltvtnFrmhsQltVO" resultType="string">
		<![CDATA[
			SELECT FN_GET_ID_CLTVTN_FRMHS_QLT(#{apcCd} , #{prdcrCd}) AS CLTVTN_FRMHS_QLT_NO FROM DUAL
		]]>
	</select>

	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.selectGetFrmhsExpctWrhsNo	-->
	<!-- DESC : 영농관리 - 농가예상입고번호 발번.                    					-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
	<select id="selectGetFrmhsExpctWrhsNo" parameterType="com.at.apcss.am.wrhs.vo.FrmhsExpctWrhsVO" resultType="string">
		<![CDATA[
			SELECT FN_GET_ID_FRMHS_EXPCT_WRHS(#{apcCd} , #{prdcrCd}) AS FRMHS_EXPCT_WRHS_NO FROM DUAL
		]]>
	</select>

	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.selectCltvtnBscInfoList		-->
	<!-- DESC : 영농관리 - 재배기본정도 목록 조회.                    					-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
    <select id="selectCltvtnBscInfoList" parameterType="com.at.apcss.am.wrhs.vo.CltvtnBscInfoVO" resultType="com.at.apcss.am.wrhs.vo.CltvtnBscInfoVO">
    	<![CDATA[
	    	SELECT /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.selectCltvtnBscInfoList */
			       CI.APC_CD                AS APC_CD
			     , CI.PRDCR_CD              AS PRDCR_CD
			     , CI.CLTVTN_BSC_INFO_NO    AS CLTVTN_BSC_INFO_NO
			     , CI.SD_CD_1               AS SD_CD_1
			     , CI.SD_CD_2               AS SD_CD_2
			     , CI.SD_CD_3               AS SD_CD_3
			     , CI.SD_CD_4               AS SD_CD_4
			     , CI.SD_CD_5               AS SD_CD_5
			     , CI.SD_QNTT_1             AS SD_QNTT_1
			     , CI.SD_QNTT_2             AS SD_QNTT_2
			     , CI.SD_QNTT_3             AS SD_QNTT_3
			     , CI.SD_QNTT_4             AS SD_QNTT_4
			     , CI.SD_QNTT_5             AS SD_QNTT_5
			     , CI.LWPT_FRTLZR           AS LWPT_FRTLZR
			     , CI.SDNG_YMD              AS SDNG_YMD
			     , CI.CLCLN_YMD             AS CLCLN_YMD
			     , CI.CMPT_YMD_CYCL_1       AS CMPT_YMD_CYCL_1
			     , CI.CMPT_YMD_CYCL_2       AS CMPT_YMD_CYCL_2
			     , CI.STRG_RSLT             AS STRG_RSLT
			     , CI.RMRK                  AS RMRK
			  FROM TB_CLTVTN_BSC_INFO CI
			 WHERE CI.APC_CD 	= #{apcCd}
			   AND CI.PRDCR_CD 	= #{prdcrCd}
		]]>
    </select>

    <!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.insertCltvtnBscInfo			-->
	<!-- DESC : 영농관리 - 재배기본정도 저장.                    						-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
    <insert id="insertCltvtnBscInfo" parameterType="com.at.apcss.am.wrhs.vo.CltvtnBscInfoVO">
    	<![CDATA[
    		INSERT /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.insertCltvtnBscInfo */
    		  INTO TB_CLTVTN_BSC_INFO
    		     (
    		       APC_CD
				 , PRDCR_CD
				 , CLTVTN_BSC_INFO_NO
				 , SD_CD_1
				 , SD_CD_2
				 , SD_CD_3
				 , SD_CD_4
				 , SD_CD_5
				 , SD_QNTT_1
				 , SD_QNTT_2
				 , SD_QNTT_3
				 , SD_QNTT_4
				 , SD_QNTT_5
				 , LWPT_FRTLZR
				 , SDNG_YMD
				 , CLCLN_YMD
				 , CMPT_YMD_CYCL_1
				 , CMPT_YMD_CYCL_2
				 , STRG_RSLT
				 , RMRK
				 , SYS_FRST_INPT_DT
				 , SYS_FRST_INPT_USER_ID
				 , SYS_FRST_INPT_PRGRM_ID
				 , SYS_LAST_CHG_DT
				 , SYS_LAST_CHG_USER_ID
				 , SYS_LAST_CHG_PRGRM_ID
				 )
			VALUES
				 (
				   #{apcCd}
				 , #{prdcrCd}
				 , #{cltvtnBscInfoNo}
				 , #{sdCd1}
				 , #{sdCd2}
				 , #{sdCd3}
				 , #{sdCd4}
				 , #{sdCd5}
				 , #{sdQntt1}
				 , #{sdQntt2}
				 , #{sdQntt3}
				 , #{sdQntt4}
				 , #{sdQntt5}
				 , #{lwptFrtlzr}
				 , #{sdngYmd}
				 , #{clclnYmd}
				 , #{cmptYmdCycl1}
				 , #{cmptYmdCycl2}
				 , #{strgRslt}
				 , #{rmrk}
				 , SYSDATE
				 , #{sysFrstInptUserId}
				 , #{sysFrstInptPrgrmId}
				 , SYSDATE
				 , #{sysLastChgUserId}
				 , #{sysLastChgPrgrmId}
				 )


    	]]>
    </insert>

    <!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.insertCltvtnBscInfo			-->
	<!-- DESC : 영농관리 - 재배기본정도 저장.                    						-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
    <update id="updateCltvtnBscInfo" parameterType="com.at.apcss.am.wrhs.vo.CltvtnBscInfoVO">
    	<![CDATA[
    		UPDATE /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.insertCltvtnBscInfo */
    		  	   TB_CLTVTN_BSC_INFO
    		   SET SD_CD_1					= #{sdCd1}
				 , SD_CD_2                  = #{sdCd2}
				 , SD_CD_3                  = #{sdCd3}
				 , SD_CD_4                  = #{sdCd4}
				 , SD_CD_5                  = #{sdCd5}
				 , SD_QNTT_1                = #{sdQntt1}
				 , SD_QNTT_2                = #{sdQntt2}
				 , SD_QNTT_3                = #{sdQntt3}
				 , SD_QNTT_4                = #{sdQntt4}
				 , SD_QNTT_5                = #{sdQntt5}
				 , LWPT_FRTLZR              = #{lwptFrtlzr}
				 , SDNG_YMD                 = #{sdngYmd}
				 , CLCLN_YMD                = #{clclnYmd}
				 , CMPT_YMD_CYCL_1          = #{cmptYmdCycl1}
				 , CMPT_YMD_CYCL_2          = #{cmptYmdCycl2}
				 , STRG_RSLT                = #{strgRslt}
				 , RMRK                     = #{rmrk}
				 , SYS_LAST_CHG_DT          = SYSDATE
				 , SYS_LAST_CHG_USER_ID     = #{sysLastChgUserId}
				 , SYS_LAST_CHG_PRGRM_ID    = #{sysLastChgPrgrmId}
			 WHERE APC_CD                   = #{apcCd}
			   AND PRDCR_CD                 = #{prdcrCd}
			   AND CLTVTN_BSC_INFO_NO       = #{cltvtnBscInfoNo}
    	]]>
    </update>


	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.selectCltvtnHstryList		-->
	<!-- DESC : 영농관리 - 재배이력 목록 조회.                    						-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
    <select id="selectCltvtnHstryList" parameterType="com.at.apcss.am.wrhs.vo.CltvtnHstryVO" resultType="com.at.apcss.am.wrhs.vo.CltvtnHstryVO">
    	<![CDATA[
			SELECT /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.selectCltvtnHstryList */
				   CH.APC_CD            AS APC_CD
			     , CH.PRDCR_CD          AS PRDCR_CD
			     , PI.PRDCR_NM			AS PRDCR_NM
			     , PI.FRMHS_CTPV		AS FRMHS_CTPV
			     , CH.PRDCR_LAND_INFO_NO AS PRDCR_LAND_INFO_NO
			     , CH.CLTVTN_HSTRY_NO   AS CLTVTN_HSTRY_NO
			     , CH.CFMTN_YMD 		AS CFMTN_YMD
			     , CH.CN                AS CN
			     , CH.RMRK              AS RMRK
			     , CH.DEL_YN            AS DEL_YN
			     , CH.BASE_FRTLZR_YMD	AS BASE_FRTLZR_YMD
			     , CH.SDNG_YMD			AS SDNG_YMD
			     , CH.PLNTNG_YMD		AS PLNTNG_YMD
			     , CH.CMPT_YMD_CYCL_1	AS CMPT_YMD_CYCL_1
			     , CH.CMPT_YMD_CYCL_2	AS CMPT_YMD_CYCL_2
			     , (SELECT MAX(ATCHFL_NO)
			     	  FROM TB_COM_ATCHFL CA
			     	 WHERE CA.PRNTS_TBL_NO = 'CQ' || CH.APC_CD || CH.PRDCR_CD || CH.PRDCR_LAND_INFO_NO || CH.CLTVTN_HSTRY_NO
			     	   AND CA.PRNTS_TBL_SE_CD = '01'
			       ) AS ATCHFL_NO
			     , (SELECT MAX(ATCHFL_ORGN_NM)
			          FROM TB_COM_ATCHFL CA
			         WHERE CA.PRNTS_TBL_NO = 'CQ' || CH.APC_CD || CH.PRDCR_CD || CH.PRDCR_LAND_INFO_NO || CH.CLTVTN_HSTRY_NO
			           AND CA.PRNTS_TBL_SE_CD = '01'
			       ) AS ATCHFL_ORGN_NM
			     , (SELECT USER_NM
                      FROM TB_COM_USER X
                     WHERE CH.SYS_FRST_INPT_USER_ID = X.USER_ID
                   ) AS PIC
			     , PLI.ITEM_CD				AS ITEM_CD
				 , PLI.FRLN_ADDR            AS FRLN_ADDR
				 , PLI.CRTR_AREA			AS CRTR_AREA
				 , PLI.PLNTNG_AREA 			AS PLNTNG_AREA
				 , PLI.YR 			AS YR
			  FROM TB_CLTVTN_HSTRY CH
			     , TB_PRDCR_INFO PI
			   	 , TB_PRDCR_LAND_INFO PLI
			 WHERE CH.APC_CD = PI.APC_CD
			   AND CH.PRDCR_CD = PI.PRDCR_CD
			   AND CH.APC_CD = PLI.APC_CD(+)
    		   AND CH.PRDCR_CD = PLI.PRDCR_CD(+)
    		   AND CH.PRDCR_LAND_INFO_NO = PLI.PRDCR_LAND_INFO_NO(+)
			   AND PLI.DEL_YN(+) = 'N'
			   AND PI.DEL_YN = 'N'
			   AND CH.DEL_YN = 'N'
		]]>
		<if test='apcCd != null and apcCd !=""'>
			   AND CH.APC_CD = #{apcCd}
		</if>
		<if test='prdcrCd != null and prdcrCd !=""'>
			   AND CH.PRDCR_CD = #{prdcrCd}
		</if>
		<if test='prdcrLandInfoNo != null and prdcrLandInfoNo !=""'>
			   AND CH.PRDCR_LAND_INFO_NO = #{prdcrLandInfoNo}
		</if>
		<if test='cfmtnYmd != null and cfmtnYmd !=""'>
			AND CH.CFMTN_YMD = #{cfmtnYmd}
		</if>
		<if test='cfmtnYmdFrom != null and cfmtnYmdFrom !=""'>
			AND CH.CFMTN_YMD <![CDATA[>=]]> #{cfmtnYmdFrom}
		</if>
		<if test='cfmtnYmdTo != null and cfmtnYmdTo !=""'>
			AND CH.CFMTN_YMD <![CDATA[<=]]> #{cfmtnYmdTo}
		</if>
		<if test='itemCd != null and itemCd !=""'>
			AND PLI.ITEM_CD(+) = #{itemCd}
		</if>
		<if test='yr != null and yr !=""'>
			AND PLI.YR = #{yr}
		</if>
		<![CDATA[
			 ORDER BY CH.CLTVTN_HSTRY_NO
		]]>
    </select>

	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.insertCltvtnHstry			-->
	<!-- DESC : 영농관리 - 재배이력 등록.                    							-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
	<insert id="insertCltvtnHstry" parameterType="com.at.apcss.am.wrhs.vo.CltvtnHstryVO">
		<![CDATA[
			INSERT /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.insertCltvtnHstry */
			  INTO TB_CLTVTN_HSTRY
			     (
				   APC_CD
				 , PRDCR_CD
				 , PRDCR_LAND_INFO_NO
				 , CLTVTN_HSTRY_NO
				 , CFMTN_YMD
                 , BASE_FRTLZR_YMD
                 , SDNG_YMD
                 , PLNTNG_YMD
                 , CMPT_YMD_CYCL_1
                 , CMPT_YMD_CYCL_2
				 , CN
				 , RMRK
				 , SYS_FRST_INPT_DT
				 , SYS_FRST_INPT_USER_ID
				 , SYS_FRST_INPT_PRGRM_ID
				 , SYS_LAST_CHG_DT
				 , SYS_LAST_CHG_USER_ID
				 , SYS_LAST_CHG_PRGRM_ID
			     )
			VALUES
				(
				   #{apcCd}
				 , #{prdcrCd}
				 , #{prdcrLandInfoNo}
				 , #{cltvtnHstryNo}
				 , #{cfmtnYmd}
                 , #{baseFrtlzrYmd}
                 , #{sdngYmd}
                 , #{plntngYmd}
                 , #{cmptYmdCycl1}
                 , #{cmptYmdCycl2}
				 , #{cn}
				 , #{rmrk}
				 , SYSDATE
				 , #{sysFrstInptUserId}
				 , #{sysFrstInptPrgrmId}
				 , SYSDATE
				 , #{sysLastChgUserId}
				 , #{sysLastChgPrgrmId}
			     )
		]]>
	</insert>
	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.updateCltvtnHstry			-->
	<!-- DESC : 영농관리 - 재배이력 수정.                    							-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
	<update id="updateCltvtnHstry" parameterType="com.at.apcss.am.wrhs.vo.CltvtnHstryVO">
		<![CDATA[
			UPDATE /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.updateCltvtnHstry */
				   TB_CLTVTN_HSTRY
			   SET CFMTN_YMD				= #{cfmtnYmd}
                 , BASE_FRTLZR_YMD          = #{baseFrtlzrYmd}
                 , SDNG_YMD                 = #{sdngYmd}
                 , PLNTNG_YMD               = #{plntngYmd}
                 , CMPT_YMD_CYCL_1          = #{cmptYmdCycl1}
                 , CMPT_YMD_CYCL_2          = #{cmptYmdCycl2}
			     , CN                       = #{cn}
				 , RMRK                     = #{rmrk}
				 , SYS_LAST_CHG_DT          = SYSDATE
				 , SYS_LAST_CHG_USER_ID     = #{sysLastChgUserId}
				 , SYS_LAST_CHG_PRGRM_ID    = #{sysLastChgPrgrmId}
			 WHERE APC_CD 					= #{apcCd}
			   AND PRDCR_CD                 = #{prdcrCd}
			   AND PRDCR_LAND_INFO_NO       = #{prdcrLandInfoNo}
			   AND CLTVTN_HSTRY_NO          = #{cltvtnHstryNo}
		]]>
	</update>

	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.deleteCltvtnHstry			-->
	<!-- DESC : 영농관리 - 재배이력 삭제.                    							-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
	<update id="deleteCltvtnHstry" parameterType="com.at.apcss.am.wrhs.vo.CltvtnHstryVO">
		<![CDATA[
			UPDATE /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.deleteCltvtnHstry */
				   TB_CLTVTN_HSTRY
			   SET DEL_YN                   = 'Y'
				 , SYS_LAST_CHG_DT          = SYSDATE
				 , SYS_LAST_CHG_USER_ID     = #{sysLastChgUserId}
				 , SYS_LAST_CHG_PRGRM_ID    = #{sysLastChgPrgrmId}
			 WHERE APC_CD 					= #{apcCd}
			   AND PRDCR_CD                 = #{prdcrCd}
			   AND PRDCR_LAND_INFO_NO       = #{prdcrLandInfoNo}
		]]>
		<if test='cltvtnHstryNo != null and cltvtnHstryNo != ""'>
			   AND CLTVTN_HSTRY_NO          = #{cltvtnHstryNo}
		</if>
	</update>

    <!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.selectCltvtnFrmhsQltList	-->
	<!-- DESC : 영농관리 - 재배농가품질 목록 조회.                    					-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
    <select id="selectCltvtnFrmhsQltList" parameterType="com.at.apcss.am.wrhs.vo.CltvtnFrmhsQltVO" resultType="com.at.apcss.am.wrhs.vo.CltvtnFrmhsQltVO">
    	<![CDATA[
    		/* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.selectCltvtnFrmhsQltList */
    		SELECT pt0.*
    		     , (SELECT FN_GET_COM_CD_VL_NM('PLNTNG_STTS_CD', pt0.PLNTNG_STTS_CD) FROM DUAL) 	AS PLNTNG_STTS_NM
				 , (SELECT FN_GET_COM_CD_VL_NM('SDNG_STTS_CD', pt0.SDNG_STTS_CD) FROM DUAL) 		AS SDNG_STTS_NM
				 , (SELECT FN_GET_COM_CD_VL_NM('MESH_SE_CD', pt0.MESH_SE_CD) FROM DUAL) 			AS MESH_SE_NM
		      FROM (SELECT
					       PI.APC_CD			AS APC_CD
					     , PI.PRDCR_CD          AS PRDCR_CD
					     , PI.PRDCR_NM          AS PRDCR_NM
					     , PI.FRMHS_CTPV        AS FRMHS_CTPV
					     , PI.FRMHS_ADDR        AS FRMHS_ADDR
					     , NVL(PI.FRMHS_TELNO, PI.TELNO)       AS FRMHS_TELNO
					     , CQ.STRG_RSLT			AS STRG_RSLT
					     , CQ.YR                AS YR
					     , CQ.CLTVTN_FRMHS_QLT_NO   AS CLTVTN_FRMHS_QLT_NO
		                 , CQ.ITEM_CD			AS ITEM_CD
					     , CQ.SD_QNTT_1         AS SD_QNTT_1
					     , CQ.SD_QNTT_2         AS SD_QNTT_2
					     , CQ.SD_QNTT_3         AS SD_QNTT_3
					     , CQ.SD_QNTT_4         AS SD_QNTT_4
					     , CQ.SD_QNTT_5         AS SD_QNTT_5
					     , (SELECT SUM(PLNTNG_AREA)
                              FROM TB_PRDCR_LAND_INFO X
                             WHERE X.APC_CD = CQ.APC_CD
                               AND X.YR = CQ.YR
                               AND X.ITEM_CD = CQ.ITEM_CD
                               AND X.PRDCR_CD = PI.PRDCR_CD
                               AND X.DEL_YN = 'N'
                           )                    AS PLNTNG_PRCL
                         , (SELECT SUM(CRTR_AREA)
                              FROM TB_PRDCR_LAND_INFO X
                             WHERE X.APC_CD = CQ.APC_CD
                               AND X.YR = CQ.YR
                               AND X.ITEM_CD = CQ.ITEM_CD
                               AND X.PRDCR_CD = PI.PRDCR_CD
                               AND X.DEL_YN = 'N'
                           )                    AS CRTR_PRCL
					     , CQ.SDNG_YMD          AS SDNG_YMD
					     , CQ.SDNG_STTS_CD      AS SDNG_STTS_CD
					     , CQ.PLNTNG_YMD        AS PLNTNG_YMD
					     , CQ.PLNTNG_STTS_CD    AS PLNTNG_STTS_CD
					     , CQ.CMPT_YMD_CYCL_1   AS CMPT_YMD_CYCL_1
					     , CQ.CMPT_YMD_CYCL_2   AS CMPT_YMD_CYCL_2
					     , CQ.EXPCT_QNTT 		AS EXPCT_QNTT
					     , CQ.QLT_EVL           AS QLT_EVL
					     , CQ.TY_EVL            AS TY_EVL
                         , (SELECT MAX(TY_EVL)
                             FROM TB_CLTVTN_FRMHS_QLT X
                            WHERE X.APC_CD = CQ.APC_CD
                              AND X.PRDCR_CD = CQ.PRDCR_CD
                              AND X.ITEM_CD = CQ.ITEM_CD
                              AND X.YR = (#{yr} - 1)
                           ) AS LAST_YR_EVL
					     , CQ.FLCTN_DFRNC       AS FLCTN_DFRNC
					     , CQ.EMPT_SORT         AS EMPT_SORT
					     , CQ.MESH_SE_CD        AS MESH_SE_CD
					     , CQ.STRM              AS STRM
					     , CQ.TMIDL_TERM        AS TMIDL_TERM
					     , CQ.LTRM              AS LTRM
					     , CQ.DFRNC             AS DFRNC
					     , CQ.SOIL              AS SOIL
					     , CQ.CMPT              AS CMPT
					     , CQ.ETC               AS ETC
					     , CQ.PEST_CD_1         AS PEST_CD_1
					     , CQ.PEST_CD_2         AS PEST_CD_2
					     , CQ.PEST_CD_3         AS PEST_CD_3
					     , CQ.PEST_YN_1         AS PEST_YN_1
					     , CQ.PEST_YN_2         AS PEST_YN_2
					     , CQ.PEST_YN_3         AS PEST_YN_3
					     , CQ.PIC               AS PIC
					     , CQ.GRDP_EXCPTN_MTTR  AS GRDP_EXCPTN_MTTR
					     , CQ.STRG_EXCPTN_MTTR  AS STRG_EXCPTN_MTTR
					     , CQ.DEL_YN 			AS DEL_YN
					     , CQ.STRG_RSLT         AS STRG_RSLT
					     , CQ.RMRK              AS RMRK
					     , CQ.PRCHS_QNTT        AS PRCHS_QNTT
					     , CQ.PRCHS_AMT         AS PRCHS_AMT
					  FROM TB_CLTVTN_FRMHS_QLT CQ
					     , TB_PRDCR_INFO PI
					 WHERE CQ.APC_CD = PI.APC_CD
					   AND CQ.PRDCR_CD = PI.PRDCR_CD
					   AND PI.DEL_YN = 'N'
					   AND CQ.DEL_YN = 'N'
					   AND PI.AGRC_YN = 'Y'
		]]>
			<if test='apcCd != null and apcCd != ""'>
    				   AND PI.APC_CD = #{apcCd}
    		</if>
    		<if test='prdcrCd != null and prdcrCd != ""'>
    				   AND PI.PRDCR_CD  = #{prdcrCd}
    		</if>
			<if test='itemCd != null and itemCd != ""'>
					   AND CQ.ITEM_CD  	= #{itemCd}
			</if>
    		<if test='yr != null and yr != ""'>
    				   AND CQ.YR  = #{yr}
    		</if>
		<![CDATA[
					 UNION ALL
					SELECT PI.APC_CD			AS APC_CD
					     , PI.PRDCR_CD          AS PRDCR_CD
					     , PI.PRDCR_NM          AS PRDCR_NM
					     , PI.FRMHS_CTPV        AS FRMHS_CTPV
					     , PI.FRMHS_ADDR        AS FRMHS_ADDR
					     , NVL(PI.FRMHS_TELNO, PI.TELNO)       AS FRMHS_TELNO
					     , ''   AS STRG_RSLT
					     , ''   AS YR
					     , ''   AS CLTVTN_FRMHS_QLT_NO
					     , ''	AS ITEM_CD
					     , ''   AS SD_QNTT_1
					     , ''   AS SD_QNTT_2
					     , ''   AS SD_QNTT_3
					     , ''   AS SD_QNTT_4
					     , ''   AS SD_QNTT_5
					     , (SELECT SUM(PLNTNG_AREA)
                              FROM TB_PRDCR_LAND_INFO X
                             WHERE X.APC_CD = CQ.APC_CD
                               AND X.YR = CQ.YR
                               AND X.ITEM_CD = CQ.ITEM_CD
                               AND X.PRDCR_CD = PI.PRDCR_CD
                               AND X.DEL_YN = 'N'
                           )                    AS PLNTNG_PRCL
                         , (SELECT SUM(CRTR_AREA)
                              FROM TB_PRDCR_LAND_INFO X
                             WHERE X.APC_CD = CQ.APC_CD
                               AND X.YR = CQ.YR
                               AND X.ITEM_CD = CQ.ITEM_CD
                               AND X.PRDCR_CD = PI.PRDCR_CD
                               AND X.DEL_YN = 'N'
                           )                    AS CRTR_PRCL
					     , ''   AS SDNG_YMD
					     , ''   AS SDNG_STTS_CD
					     , ''   AS PLNTNG_YMD
					     , ''   AS PLNTNG_STTS_CD
					     , ''   AS CMPT_YMD_CYCL_1
					     , ''   AS CMPT_YMD_CYCL_2
					     , ''   AS EXPCT_QNTT
					     , ''   AS QLT_EVL
					     , ''   AS TY_EVL
					     , ''   AS LAST_YR_EVL
					     , ''   AS FLCTN_DFRNC
					     , ''   AS EMPT_SORT
					     , ''   AS MESH_SE_CD
					     , ''   AS STRM
					     , ''   AS TMIDL_TERM
					     , ''   AS LTRM
					     , ''   AS DFRNC
					     , ''   AS SOIL
					     , ''   AS CMPT
					     , ''   AS ETC
					     , ''   AS PEST_CD_1
					     , ''   AS PEST_CD_2
					     , ''   AS PEST_CD_3
					     , ''   AS PEST_YN_1
					     , ''   AS PEST_YN_2
					     , ''   AS PEST_YN_3
					     , ''   AS PIC
					     , ''   AS GRDP_EXCPTN_MTTR
					     , ''   AS STRG_EXCPTN_MTTR
					     , '' 	AS DEL_YN
					     , ''	AS RMRK
					     , ''   AS STRG_RSLT
					     , ''   AS PRCHS_QNTT
					     , ''   AS PRCHS_AMT
					  FROM TB_CLTVTN_FRMHS_QLT CQ
					     , TB_PRDCR_INFO PI
					 WHERE CQ.APC_CD(+) = PI.APC_CD
					   AND CQ.PRDCR_CD(+) = PI.PRDCR_CD
					   AND PI.DEL_YN = 'N'
					   AND CQ.DEL_YN(+) = 'N'
					   AND PI.AGRC_YN = 'Y'
		]]>
			<if test='apcCd != null and apcCd != ""'>
    				   AND PI.APC_CD = #{apcCd}
    		</if>
    		<if test='prdcrCd != null and prdcrCd != ""'>
    				   AND PI.PRDCR_CD  = #{prdcrCd}
    		</if>
    		<if test='itemCd != null and itemCd != ""'>
    				   AND CQ.ITEM_CD(+)  = #{itemCd}
    		</if>
		<![CDATA[
					   AND NOT EXISTS (
					                    SELECT 1
					                      FROM TB_CLTVTN_FRMHS_QLT X
					                     WHERE X.PRDCR_CD = CQ.PRDCR_CD
					                       AND X.DEL_YN = 'N'
		]]>
			<if test='apcCd != null and apcCd != ""'>
    				   					  AND X.APC_CD = #{apcCd}
    		</if>
    		<if test='yr != null and yr != ""'>
    				   					  AND X.YR  = #{yr}
    		</if>
			<if test='itemCd != null and itemCd != ""'>
										  AND X.ITEM_CD  = #{itemCd}
			</if>
		<![CDATA[
					                  )

    	]]>

    	<![CDATA[
				) pt0
				ORDER BY pt0.PRDCR_CD
    	]]>
    </select>

    <!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.insertCltvtnFrmhsQlt		-->
	<!-- DESC : 영농관리 - 재배농가품질 등록.                    						-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
    <insert id="insertCltvtnFrmhsQlt" parameterType="com.at.apcss.am.wrhs.vo.CltvtnFrmhsQltVO">
    	<![CDATA[
    		INSERT /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.insertCltvtnFrmhsQlt */
    		  INTO TB_CLTVTN_FRMHS_QLT
				 ( APC_CD
				 , PRDCR_CD
				 , CLTVTN_FRMHS_QLT_NO
				 , ITEM_CD
				 , SD_QNTT_1
				 , SD_QNTT_2
				 , SD_QNTT_3
				 , SD_QNTT_4
				 , SD_QNTT_5
				 , SDNG_YMD
				 , SDNG_STTS_CD
				 , PLNTNG_YMD
				 , PLNTNG_STTS_CD
				 , CMPT_YMD_CYCL_1
				 , CMPT_YMD_CYCL_2
				 , EXPCT_QNTT
				 , QLT_EVL
				 , TY_EVL
				 , FLCTN_DFRNC
				 , EMPT_SORT
				 , MESH_SE_CD
				 , STRM
				 , TMIDL_TERM
				 , LTRM
				 , DFRNC
				 , SOIL
				 , CMPT
				 , ETC
				 , PEST_CD_1
				 , PEST_CD_2
				 , PEST_CD_3
				 , PEST_YN_1
				 , PEST_YN_2
				 , PEST_YN_3
				 , PIC
				 , GRDP_EXCPTN_MTTR
				 , STRG_EXCPTN_MTTR
				 , YR
				 , STRG_RSLT
				 , RMRK
				 , PRCHS_QNTT
				 , PRCHS_AMT
				 , SYS_FRST_INPT_DT
				 , SYS_FRST_INPT_USER_ID
				 , SYS_FRST_INPT_PRGRM_ID
				 , SYS_LAST_CHG_DT
				 , SYS_LAST_CHG_USER_ID
				 , SYS_LAST_CHG_PRGRM_ID
				 )
    		VALUES
    			 ( #{apcCd}
				 , #{prdcrCd}
				 , #{cltvtnFrmhsQltNo}
				 , #{itemCd}
				 , #{sdQntt1}
				 , #{sdQntt2}
				 , #{sdQntt3}
				 , #{sdQntt4}
				 , #{sdQntt5}
				 , #{sdngYmd}
				 , #{sdngSttsCd}
				 , #{plntngYmd}
				 , #{plntngSttsCd}
				 , #{cmptYmdCycl1}
				 , #{cmptYmdCycl2}
				 , #{expctQntt}
				 , #{qltEvl}
				 , #{tyEvl}
				 , #{flctnDfrnc}
				 , #{emptSort}
				 , #{meshSeCd}
				 , #{strm}
				 , #{tmidlTerm}
				 , #{ltrm}
				 , #{dfrnc}
				 , #{soil}
				 , #{cmpt}
				 , #{etc}
				 , #{pestCd1}
				 , #{pestCd2}
				 , #{pestCd3}
				 , #{pestYn1}
				 , #{pestYn2}
				 , #{pestYn3}
				 , #{pic}
				 , #{grdpExcptnMttr}
				 , #{strgExcptnMttr}
				 , TO_CHAR(SYSDATE, 'YYYY')
				 , #{strgRslt}
				 , #{rmrk}
				 , #{prchsQntt}
				 , #{prchsAmt}
				 , SYSDATE
				 , #{sysFrstInptUserId}
				 , #{sysFrstInptPrgrmId}
				 , SYSDATE
				 , #{sysLastChgUserId}
				 , #{sysLastChgPrgrmId}
				 )
    	]]>
    </insert>

    <!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.updateCltvtnFrmhsQlt		-->
	<!-- DESC : 영농관리 - 재배농가품질 수정.                    						-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
    <update id="updateCltvtnFrmhsQlt" parameterType="com.at.apcss.am.wrhs.vo.CltvtnFrmhsQltVO">
    	<![CDATA[
    		UPDATE /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.updateCltvtnFrmhsQlt */
    			   TB_CLTVTN_FRMHS_QLT
    		   SET
				   SD_QNTT_1                = #{sdQntt1}
				 , SD_QNTT_2                = #{sdQntt2}
				 , SD_QNTT_3                = #{sdQntt3}
				 , SD_QNTT_4                = #{sdQntt4}
				 , SD_QNTT_5                = #{sdQntt5}
				 , SDNG_YMD                 = #{sdngYmd}
				 , SDNG_STTS_CD             = #{sdngSttsCd}
				 , PLNTNG_YMD               = #{plntngYmd}
				 , PLNTNG_STTS_CD           = #{plntngSttsCd}
				 , CMPT_YMD_CYCL_1          = #{cmptYmdCycl1}
				 , CMPT_YMD_CYCL_2          = #{cmptYmdCycl2}
				 , EXPCT_QNTT				= #{expctQntt}
				 , QLT_EVL                  = #{qltEvl}
				 , TY_EVL              		= #{tyEvl}
				 , FLCTN_DFRNC              = #{flctnDfrnc}
				 , EMPT_SORT                = #{emptSort}
				 , MESH_SE_CD               = #{meshSeCd}
				 , STRM                     = #{strm}
				 , TMIDL_TERM               = #{tmidlTerm}
				 , LTRM                     = #{ltrm}
				 , DFRNC                    = #{dfrnc}
				 , SOIL                     = #{soil}
				 , CMPT                     = #{cmpt}
				 , ETC                      = #{etc}
				 , PEST_CD_1                = #{pestCd1}
				 , PEST_CD_2                = #{pestCd2}
				 , PEST_CD_3                = #{pestCd3}
				 , PEST_YN_1                = #{pestYn1}
				 , PEST_YN_2                = #{pestYn2}
				 , PEST_YN_3                = #{pestYn3}
				 , PIC                      = #{pic}
				 , GRDP_EXCPTN_MTTR         = #{grdpExcptnMttr}
				 , STRG_EXCPTN_MTTR         = #{strgExcptnMttr}
				 , STRG_RSLT				= #{strgRslt}
				 , RMRK                     = #{rmrk}
				 , PRCHS_QNTT               = #{prchsQntt}
				 , PRCHS_AMT                = #{prchsAmt}
				 , SYS_LAST_CHG_DT			= SYSDATE
				 , SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
				 , SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
			 WHERE APC_CD					= #{apcCd}
			   AND PRDCR_CD					= #{prdcrCd}
			   AND CLTVTN_FRMHS_QLT_NO 		= #{cltvtnFrmhsQltNo}
    	]]>
		<if test='itemCd != null and itemCd != ""'>
			   AND ITEM_CD = #{itemCd}
		</if>
    </update>

    <!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.deleteCltvtnFrmhsQlt		-->
	<!-- DESC : 영농관리 - 재배농가품질 삭제.                    						-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
    <update id="deleteCltvtnFrmhsQlt" parameterType="com.at.apcss.am.wrhs.vo.CltvtnFrmhsQltVO">
    	<![CDATA[
    		UPDATE /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.deleteCltvtnFrmhsQlt */
    			   TB_CLTVTN_FRMHS_QLT
    		   SET
				   DEL_YN 					= 'Y'
				 , SYS_LAST_CHG_DT			= SYSDATE
				 , SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
				 , SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
			 WHERE APC_CD					= #{apcCd}
			   AND PRDCR_CD					= #{prdcrCd}
			   AND CLTVTN_FRMHS_QLT_NO 		= #{cltvtnFrmhsQltNo}
    	]]>
		<if test='itemCd != null and itemCd != ""'>
			   AND ITEM_CD = #{itemCd}
		</if>
    </update>

    <!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.selectFrmhsExpctWrhsList	-->
	<!-- DESC : 영농관리 - 농가예상입고 목록 조회.                    					-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
	<select id="selectFrmhsExpctWrhsList" parameterType="com.at.apcss.am.wrhs.vo.FrmhsExpctWrhsVO" resultType="com.at.apcss.am.wrhs.vo.FrmhsExpctWrhsVO">
		<![CDATA[
			SELECT /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.selectFrmhsExpctWrhsList */
			       pt0.APC_CD                       AS APC_CD
			     , pt0.PRDCR_CD                     AS PRDCR_CD
			     , MAX(pt0.PRDCR_NM)				AS PRDCR_NM
			     , MAX(pt0.CRTR_YM)					AS CRTR_YM
			     , pt0.CRTR_YR						AS CRTR_YR
			     , pt0.CRTR_MM						AS CRTR_MM
			     , MAX(pt0.ITEM_CD)            		AS ITEM_CD
			     , MAX(pt0.FRMHS_ADDR)              AS FRMHS_ADDR
			     , MAX(pt0.FRMHS_CTPV)              AS FRMHS_CTPV
			     , MAX(pt0.FRMHS_TELNO)             AS FRMHS_TELNO
			     , MAX(CQ.EXPCT_QNTT)               AS EXPCT_QNTT
			     , MAX(pt0.PLNTNG_PRCL)             AS PLNTNG_PRCL
                 , MAX(pt0.CRTR_PRCL)               AS CRTR_PRCL
			     , MAX(CQ.PIC)                      AS PIC
			     , MAX(CQ.QLT_EVL)                  AS QLT_EVL
			     , SUM(QNTT) - MAX(CQ.EXPCT_QNTT)   AS EXPCT_VLM_VRSS
			     , pt0.FRMHS_EXPCT_WRHS_NO          AS FRMHS_EXPCT_WRHS_NO
			     , MAX(pt0.HDOFC_EXTRNL_SE_CD)      AS HDOFC_EXTRNL_SE_CD
			     , MAX(pt0.EXTRNL_WAREHOUSE_CD)     AS EXTRNL_WAREHOUSE_CD
			     , MAX(pt0.HRVST_YMD)               AS HRVST_YMD
			     , MAX(pt0.PRCHS_CMPTN_YN)          AS PRCHS_CMPTN_YN
			     , MAX(pt0.RMRK)                    AS RMRK
			     , MAX(pt0.DEL_YN)                  AS DEL_YN
			     , SUM(pt0.YMD_1)                   AS YMD_1_QNTT
			     , SUM(pt0.YMD_2)                   AS YMD_2_QNTT
			     , SUM(pt0.YMD_3)                   AS YMD_3_QNTT
			     , SUM(pt0.YMD_4)                   AS YMD_4_QNTT
			     , SUM(pt0.YMD_5)                   AS YMD_5_QNTT
			     , SUM(pt0.YMD_6)                   AS YMD_6_QNTT
			     , SUM(pt0.YMD_7)                   AS YMD_7_QNTT
			     , SUM(pt0.YMD_8)                   AS YMD_8_QNTT
			     , SUM(pt0.YMD_9)                   AS YMD_9_QNTT
			     , SUM(pt0.YMD_10)                  AS YMD_10_QNTT
			     , SUM(pt0.YMD_11)                  AS YMD_11_QNTT
			     , SUM(pt0.YMD_12)                  AS YMD_12_QNTT
			     , SUM(pt0.YMD_13)                  AS YMD_13_QNTT
			     , SUM(pt0.YMD_14)                  AS YMD_14_QNTT
			     , SUM(pt0.YMD_15)                  AS YMD_15_QNTT
			     , SUM(pt0.YMD_16)                  AS YMD_16_QNTT
			     , SUM(pt0.YMD_17)                  AS YMD_17_QNTT
			     , SUM(pt0.YMD_18)                  AS YMD_18_QNTT
			     , SUM(pt0.YMD_19)                  AS YMD_19_QNTT
			     , SUM(pt0.YMD_20)                  AS YMD_20_QNTT
			     , SUM(pt0.YMD_21)                  AS YMD_21_QNTT
			     , SUM(pt0.YMD_22)                  AS YMD_22_QNTT
			     , SUM(pt0.YMD_23)                  AS YMD_23_QNTT
			     , SUM(pt0.YMD_24)                  AS YMD_24_QNTT
			     , SUM(pt0.YMD_25)                  AS YMD_25_QNTT
			     , SUM(pt0.YMD_26)                  AS YMD_26_QNTT
			     , SUM(pt0.YMD_27)                  AS YMD_27_QNTT
			     , SUM(pt0.YMD_28)                  AS YMD_28_QNTT
			     , SUM(pt0.YMD_29)                  AS YMD_29_QNTT
			     , SUM(pt0.YMD_30)                  AS YMD_30_QNTT
			     , SUM(pt0.YMD_31)                  AS YMD_31_QNTT
			     , SUM(QNTT)                        AS TOT
			     , (SELECT MAX(X.YMD)
                      FROM TB_FRMHS_EXPCT_WRHS_DDLN X
                     WHERE X.APC_CD = pt0.APC_CD
                       AND X.ITEM_CD = pt0.ITEM_CD
                       AND X.YR = pt0.CRTR_YR
                   ) AS DDLN_YMD
                 , (SELECT MAX(X.USE_YN)
                      FROM TB_FRMHS_EXPCT_WRHS_DDLN X
                     WHERE X.APC_CD = pt0.APC_CD
                       AND X.ITEM_CD = pt0.ITEM_CD
                       AND X.YR = pt0.CRTR_YR
                   ) AS USE_YN
			  FROM (SELECT
					       PI.APC_CD                    AS APC_CD
					     , PI.PRDCR_CD                  AS PRDCR_CD
					     , PI.PRDCR_NM					AS PRDCR_NM
					     , PI.FRMHS_ADDR                AS FRMHS_ADDR
					     , NVL(PI.FRMHS_TELNO, PI.TELNO)	AS FRMHS_TELNO
					     , (SELECT SUM(PLNTNG_AREA)
                              FROM TB_PRDCR_LAND_INFO X
                             WHERE X.APC_CD = PI.APC_CD
					]]>
						<if test='itemCd != null and itemCd != ""'>
					   		   AND X.ITEM_CD = #{itemCd}
						</if>
					<![CDATA[
                               AND X.YR = #{yr}
                               AND X.PRDCR_CD = PI.PRDCR_CD
                               AND X.DEL_YN = 'N'
                           )                    AS PLNTNG_PRCL
					     , (SELECT SUM(CRTR_AREA)
                              FROM TB_PRDCR_LAND_INFO X
                             WHERE X.APC_CD = PI.APC_CD
                    ]]>
						<if test='itemCd != null and itemCd != ""'>
							   AND X.ITEM_CD = #{itemCd}
						</if>
					<![CDATA[
                               AND X.YR = #{yr}
                               AND X.PRDCR_CD = PI.PRDCR_CD
                               AND X.DEL_YN = 'N'
                           )                    AS CRTR_PRCL
					     , PI.FRMHS_CTPV                AS FRMHS_CTPV
			             , FW.ITEM_CD					AS ITEM_CD
					     , FW.FRMHS_EXPCT_WRHS_NO       AS FRMHS_EXPCT_WRHS_NO
					     , FW.HDOFC_EXTRNL_SE_CD        AS HDOFC_EXTRNL_SE_CD
					     , FW.EXTRNL_WAREHOUSE_CD       AS EXTRNL_WAREHOUSE_CD
					     , FW.HRVST_YMD                 AS HRVST_YMD
					     , FW.PRCHS_CMPTN_YN            AS PRCHS_CMPTN_YN
					     , FW.RMRK                      AS RMRK
					     , FWD.YMD                      AS YMD
					     , FW.DEL_YN                  	AS DEL_YN
					     , CASE WHEN FWD.YMD = '1' THEN FWD.QNTT END AS YMD_1
					     , CASE WHEN FWD.YMD = '2' THEN FWD.QNTT END AS YMD_2
					     , CASE WHEN FWD.YMD = '3' THEN FWD.QNTT END AS YMD_3
					     , CASE WHEN FWD.YMD = '4' THEN FWD.QNTT END AS YMD_4
					     , CASE WHEN FWD.YMD = '5' THEN FWD.QNTT END AS YMD_5
					     , CASE WHEN FWD.YMD = '6' THEN FWD.QNTT END AS YMD_6
					     , CASE WHEN FWD.YMD = '7' THEN FWD.QNTT END AS YMD_7
					     , CASE WHEN FWD.YMD = '8' THEN FWD.QNTT END AS YMD_8
					     , CASE WHEN FWD.YMD = '9' THEN FWD.QNTT END AS YMD_9
					     , CASE WHEN FWD.YMD = '10' THEN FWD.QNTT END AS YMD_10
					     , CASE WHEN FWD.YMD = '11' THEN FWD.QNTT END AS YMD_11
					     , CASE WHEN FWD.YMD = '12' THEN FWD.QNTT END AS YMD_12
					     , CASE WHEN FWD.YMD = '13' THEN FWD.QNTT END AS YMD_13
					     , CASE WHEN FWD.YMD = '14' THEN FWD.QNTT END AS YMD_14
					     , CASE WHEN FWD.YMD = '15' THEN FWD.QNTT END AS YMD_15
					     , CASE WHEN FWD.YMD = '16' THEN FWD.QNTT END AS YMD_16
					     , CASE WHEN FWD.YMD = '17' THEN FWD.QNTT END AS YMD_17
					     , CASE WHEN FWD.YMD = '18' THEN FWD.QNTT END AS YMD_18
					     , CASE WHEN FWD.YMD = '19' THEN FWD.QNTT END AS YMD_19
					     , CASE WHEN FWD.YMD = '20' THEN FWD.QNTT END AS YMD_20
					     , CASE WHEN FWD.YMD = '21' THEN FWD.QNTT END AS YMD_21
					     , CASE WHEN FWD.YMD = '22' THEN FWD.QNTT END AS YMD_22
					     , CASE WHEN FWD.YMD = '23' THEN FWD.QNTT END AS YMD_23
					     , CASE WHEN FWD.YMD = '24' THEN FWD.QNTT END AS YMD_24
					     , CASE WHEN FWD.YMD = '25' THEN FWD.QNTT END AS YMD_25
					     , CASE WHEN FWD.YMD = '26' THEN FWD.QNTT END AS YMD_26
					     , CASE WHEN FWD.YMD = '27' THEN FWD.QNTT END AS YMD_27
					     , CASE WHEN FWD.YMD = '28' THEN FWD.QNTT END AS YMD_28
					     , CASE WHEN FWD.YMD = '29' THEN FWD.QNTT END AS YMD_29
					     , CASE WHEN FWD.YMD = '30' THEN FWD.QNTT END AS YMD_30
					     , CASE WHEN FWD.YMD = '31' THEN FWD.QNTT END AS YMD_31
					     , FWD.CRTR_YR                  AS CRTR_YR
					     , FWD.CRTR_MM                  AS CRTR_MM
					     , FWD.CRTR_YR || FWD.CRTR_MM   AS CRTR_YM
					     , FWD.QNTT                     AS QNTT
					  FROM TB_PRDCR_INFO PI
					     , TB_FRMHS_EXPCT_WRHS FW
					     , TB_FRMHS_EXPCT_WRHS_DTL FWD
					 WHERE PI.APC_CD = FW.APC_CD
					   AND PI.PRDCR_CD = FW.PRDCR_CD
					   AND FW.APC_CD = FWD.APC_CD
					   AND FW.PRDCR_CD = FWD.PRDCR_CD
					   AND FW.FRMHS_EXPCT_WRHS_NO = FWD.FRMHS_EXPCT_WRHS_NO
					   AND PI.DEL_YN = 'N'
					   AND FW.DEL_YN = 'N'
					   AND FWD.DEL_YN = 'N'
					   AND PI.AGRC_YN = 'Y'
		]]>
		<if test='apcCd != null and apcCd != ""'>
					   AND PI.APC_CD = #{apcCd}
		</if>
		<if test='prdcrCd != null and prdcrCd != ""'>
					   AND PI.PRDCR_CD = #{prdcrCd}
		</if>
		<if test='itemCd != null and itemCd != ""'>
					   AND FW.ITEM_CD = #{itemCd}
		</if>
		<if test='yr != null and yr != ""'>
					   AND CRTR_YR = #{yr}
		</if>
		<![CDATA[
					 UNION ALL
					SELECT
					       PI.APC_CD                    AS APC_CD
					     , PI.PRDCR_CD                  AS PRDCR_CD
					     , PI.PRDCR_NM					AS PRDCR_NM
					     , PI.FRMHS_ADDR                AS FRMHS_ADDR
					     , NVL(PI.FRMHS_TELNO, PI.TELNO)	AS FRMHS_TELNO
					     , (SELECT SUM(PLNTNG_AREA)
                              FROM TB_PRDCR_LAND_INFO X
                             WHERE X.APC_CD = PI.APC_CD
                    ]]>
						<if test='itemCd != null and itemCd != ""'>
							   AND X.ITEM_CD = #{itemCd}
						</if>
					<![CDATA[
                               AND X.YR = #{yr}
                               AND X.PRDCR_CD = PI.PRDCR_CD
                               AND X.DEL_YN = 'N'
                           )                    AS PLNTNG_PRCL
					     , (SELECT SUM(CRTR_AREA)
                              FROM TB_PRDCR_LAND_INFO X
                             WHERE X.APC_CD = PI.APC_CD
                    ]]>
						<if test='itemCd != null and itemCd != ""'>
							   AND X.ITEM_CD = #{itemCd}
						</if>
					<![CDATA[
                               AND X.YR = #{yr}
                               AND X.PRDCR_CD = PI.PRDCR_CD
                               AND X.DEL_YN = 'N'
                           )                    AS CRTR_PRCL
					     , PI.FRMHS_CTPV                AS FRMHS_CTPV
					     , '' AS ITEM_CD
					     , '' AS FRMHS_EXPCT_WRHS_NO
					     , '' AS HDOFC_EXTRNL_SE_CD
					     , '' AS EXTRNL_WAREHOUSE_CD
					     , '' AS HRVST_YMD
					     , '' AS PRCHS_CMPTN_YN
					     , '' AS RMRK
					     , '' AS YMD
					     , '' AS DEL_YN
					     , 0  AS YMD_1
					     , 0  AS YMD_2
					     , 0  AS YMD_3
					     , 0  AS YMD_4
					     , 0  AS YMD_5
					     , 0  AS YMD_6
					     , 0  AS YMD_7
					     , 0  AS YMD_8
					     , 0  AS YMD_9
					     , 0  AS YMD_10
					     , 0  AS YMD_11
					     , 0  AS YMD_12
					     , 0  AS YMD_13
					     , 0  AS YMD_14
					     , 0  AS YMD_15
					     , 0  AS YMD_16
					     , 0  AS YMD_17
					     , 0  AS YMD_18
					     , 0  AS YMD_19
					     , 0  AS YMD_20
					     , 0  AS YMD_21
					     , 0  AS YMD_22
					     , 0  AS YMD_23
					     , 0  AS YMD_24
					     , 0  AS YMD_25
					     , 0  AS YMD_26
					     , 0  AS YMD_27
					     , 0  AS YMD_28
					     , 0  AS YMD_29
					     , 0  AS YMD_30
					     , 0  AS YMD_31
					     , '' AS CRTR_YR
					     , '' AS CRTR_MM
					     , '' AS CRTR_YM
					     , 0  AS QNTT
					  FROM TB_PRDCR_INFO PI
					     , TB_FRMHS_EXPCT_WRHS FW
					     , TB_FRMHS_EXPCT_WRHS_DTL FWD
					 WHERE PI.APC_CD = FW.APC_CD(+)
					   AND PI.PRDCR_CD = FW.PRDCR_CD(+)
					   AND FW.APC_CD = FWD.APC_CD(+)
					   AND FW.PRDCR_CD = FWD.PRDCR_CD(+)
					   AND FW.FRMHS_EXPCT_WRHS_NO = FWD.FRMHS_EXPCT_WRHS_NO(+)
					   AND PI.DEL_YN = 'N'
					   AND FW.DEL_YN(+) = 'N'
					   AND FWD.DEL_YN(+) = 'N'
					   AND PI.AGRC_YN = 'Y'
		]]>
		<if test='apcCd != null and apcCd != ""'>
					   AND PI.APC_CD = #{apcCd}
		</if>
		<if test='prdcrCd != null and prdcrCd != ""'>
					   AND PI.PRDCR_CD = #{prdcrCd}
		</if>
		<if test='itemCd != null and itemCd != ""'>
					   AND FW.ITEM_CD(+) = #{itemCd}
		</if>
		<![CDATA[
					   AND NOT EXISTS (
					                    SELECT 1
					                      FROM TB_FRMHS_EXPCT_WRHS X
					                         , TB_FRMHS_EXPCT_WRHS_DTL Y
					                     WHERE X.APC_CD = Y.APC_CD
					                       AND X.PRDCR_CD = Y.PRDCR_CD
					                       AND X.FRMHS_EXPCT_WRHS_NO = Y.FRMHS_EXPCT_WRHS_NO
					                       AND X.PRDCR_CD = FW.PRDCR_CD
					                       AND X.DEL_YN = 'N'
					                       AND Y.DEL_YN = 'N'
		]]>
		<if test='apcCd != null and apcCd != ""'>
					   					   AND X.APC_CD = #{apcCd}
		</if>
		<if test='itemCd != null and itemCd != ""'>
										   AND X.ITEM_CD = #{itemCd}
		</if>
		<if test='yr != null and yr != ""'>
					   					   AND Y.CRTR_YR = #{yr}
		</if>
		<![CDATA[
					                  )
			        ) pt0
			 		, TB_CLTVTN_FRMHS_QLT CQ
			 WHERE CQ.APC_CD(+) = pt0.APC_CD
			   AND CQ.PRDCR_CD(+) = pt0.PRDCR_CD
			   AND CQ.DEL_YN(+) = 'N'
		]]>
		<if test='itemCd != null and itemCd != ""'>
			   AND CQ.ITEM_CD(+) = #{itemCd}
		</if>
		<if test='yr != null and yr != ""'>
			   AND CQ.YR(+) = #{yr}
		</if>
		<![CDATA[
			 GROUP BY pt0.APC_CD, pt0.PRDCR_CD, pt0.FRMHS_EXPCT_WRHS_NO, pt0.CRTR_YR, pt0.CRTR_MM, pt0.ITEM_CD
			 ORDER BY pt0.PRDCR_CD
		]]>

	</select>

	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.insertFrmhsExpctWrhs		-->
	<!-- DESC : 영농관리 - 농가예상입고 등록.                    						-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
	<insert id="insertFrmhsExpctWrhs" parameterType="com.at.apcss.am.wrhs.vo.FrmhsExpctWrhsVO">
		<![CDATA[
			INSERT /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.insertFrmhsExpctWrhs */
			  INTO TB_FRMHS_EXPCT_WRHS
			     ( APC_CD
				 , PRDCR_CD
				 , ITEM_CD
				 , FRMHS_EXPCT_WRHS_NO
				 , HDOFC_EXTRNL_SE_CD
				 , EXTRNL_WAREHOUSE_CD
				 , HRVST_YMD
				 , PRCHS_CMPTN_YN
				 , RMRK
				 , SYS_FRST_INPT_DT
				 , SYS_FRST_INPT_USER_ID
				 , SYS_FRST_INPT_PRGRM_ID
				 , SYS_LAST_CHG_DT
				 , SYS_LAST_CHG_USER_ID
				 , SYS_LAST_CHG_PRGRM_ID
				 )
			VALUES
				 ( #{apcCd}
				 , #{prdcrCd}
				 , #{itemCd}
				 , #{frmhsExpctWrhsNo}
				 , #{hdofcExtrnlSeCd}
				 , #{extrnlWarehouseCd}
				 , #{hrvstYmd}
				 , #{prchsCmptnYn}
				 , #{rmrk}
				 , SYSDATE
				 , #{sysFrstInptUserId}
				 , #{sysFrstInptPrgrmId}
				 , SYSDATE
				 , #{sysLastChgUserId}
				 , #{sysLastChgPrgrmId}
				 )
		]]>
	</insert>

	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.updateFrmhsExpctWrhs		-->
	<!-- DESC : 영농관리 - 농가예상입고 수정.                    						-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
	<update id="updateFrmhsExpctWrhs" parameterType="com.at.apcss.am.wrhs.vo.FrmhsExpctWrhsVO">
		<![CDATA[
			UPDATE /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.updateFrmhsExpctWrhs */
				   TB_FRMHS_EXPCT_WRHS
		       SET
				   HDOFC_EXTRNL_SE_CD       = #{hdofcExtrnlSeCd}
				 , EXTRNL_WAREHOUSE_CD      = #{extrnlWarehouseCd}
				 , HRVST_YMD                = #{hrvstYmd}
				 , PRCHS_CMPTN_YN           = #{prchsCmptnYn}
				 , RMRK                     = #{rmrk}
				 , SYS_LAST_CHG_DT          = SYSDATE
				 , SYS_LAST_CHG_USER_ID     = #{sysLastChgUserId}
				 , SYS_LAST_CHG_PRGRM_ID    = #{sysLastChgPrgrmId}
			 WHERE APC_CD 					= #{apcCd}
			   AND PRDCR_CD 				= #{prdcrCd}
			   AND FRMHS_EXPCT_WRHS_NO 		= #{frmhsExpctWrhsNo}
		]]>
		<if test='itemCd != null and itemCd != ""'>
			   AND ITEM_CD = #{itemCd}
		</if>
	</update>
	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.deleteFrmhsExpctWrhs		-->
	<!-- DESC : 영농관리 - 농가예상입고 삭제.                    						-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
	<update id="deleteFrmhsExpctWrhs" parameterType="com.at.apcss.am.wrhs.vo.FrmhsExpctWrhsVO">
		<![CDATA[
			UPDATE /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.deleteFrmhsExpctWrhs */
				   TB_FRMHS_EXPCT_WRHS
		       SET
				   DEL_YN 					= 'Y'
				 , SYS_LAST_CHG_DT          = SYSDATE
				 , SYS_LAST_CHG_USER_ID     = #{sysLastChgUserId}
				 , SYS_LAST_CHG_PRGRM_ID    = #{sysLastChgPrgrmId}
			 WHERE APC_CD 					= #{apcCd}
			   AND PRDCR_CD 				= #{prdcrCd}
			   AND FRMHS_EXPCT_WRHS_NO 		= #{frmhsExpctWrhsNo}
		]]>
		<if test='itemCd != null and itemCd != ""'>
			   AND ITEM_CD = #{itemCd}
		</if>
	</update>

	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.insertFrmhsExpctWrhsDtl		-->
	<!-- DESC : 영농관리 - 농가예상입고상세 등록.                    					-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
	<insert id="insertFrmhsExpctWrhsDtl" parameterType="com.at.apcss.am.wrhs.vo.FrmhsExpctWrhsDtlVO">
		<![CDATA[
			INSERT /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.insertFrmhsExpctWrhsDtl */
			  INTO TB_FRMHS_EXPCT_WRHS_DTL
			     ( APC_CD
				 , PRDCR_CD
				 , FRMHS_EXPCT_WRHS_NO
				 , CRTR_YR
				 , CRTR_MM
				 , YMD
				 , QNTT
				 , SYS_FRST_INPT_DT
				 , SYS_FRST_INPT_USER_ID
				 , SYS_FRST_INPT_PRGRM_ID
				 , SYS_LAST_CHG_DT
				 , SYS_LAST_CHG_USER_ID
				 , SYS_LAST_CHG_PRGRM_ID
				 )
			VALUES
				 ( #{apcCd}
				 , #{prdcrCd}
				 , #{frmhsExpctWrhsNo}
				 , #{crtrYr}
				 , #{crtrMm}
				 , #{ymd}
				 , #{qntt}
				 , SYSDATE
				 , #{sysFrstInptUserId}
				 , #{sysFrstInptPrgrmId}
				 , SYSDATE
				 , #{sysLastChgUserId}
				 , #{sysLastChgPrgrmId}
				 )
		]]>
	</insert>

	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.updateFrmhsExpctWrhsDtl		-->
	<!-- DESC : 영농관리 - 농가예상입고상세 수정.                    					-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
	<update id="updateFrmhsExpctWrhsDtl" parameterType="com.at.apcss.am.wrhs.vo.FrmhsExpctWrhsDtlVO">
		<![CDATA[
			MERGE /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.updateFrmhsExpctWrhs */
			 INTO TB_FRMHS_EXPCT_WRHS_DTL A
			USING DUAL
			   ON (
			       	   A.APC_CD 					= #{apcCd}
			       AND A.PRDCR_CD 					= #{prdcrCd}
			       AND A.FRMHS_EXPCT_WRHS_NO 		= #{frmhsExpctWrhsNo}
			       AND A.CRTR_YR					= #{crtrYr}
			       AND A.YMD						= #{ymd}
			      )
			 WHEN MATCHED THEN
					UPDATE
				       SET
						   A.QNTT					= #{qntt}
						 , A.CRTR_MM				= #{crtrMm}
						 , A.SYS_LAST_CHG_DT        = SYSDATE
						 , A.SYS_LAST_CHG_USER_ID   = #{sysLastChgUserId}
						 , A.SYS_LAST_CHG_PRGRM_ID  = #{sysLastChgPrgrmId}
					 WHERE A.APC_CD 				= #{apcCd}
					   AND A.PRDCR_CD 				= #{prdcrCd}
					   AND A.FRMHS_EXPCT_WRHS_NO 	= #{frmhsExpctWrhsNo}
					   AND A.CRTR_YR				= #{crtrYr}
					   AND A.YMD					= #{ymd}
		     WHEN NOT MATCHED THEN
		     		INSERT
					     (
					       APC_CD
						 , PRDCR_CD
						 , FRMHS_EXPCT_WRHS_NO
						 , CRTR_YR
						 , CRTR_MM
						 , YMD
						 , QNTT
						 , SYS_FRST_INPT_DT
						 , SYS_FRST_INPT_USER_ID
						 , SYS_FRST_INPT_PRGRM_ID
						 , SYS_LAST_CHG_DT
						 , SYS_LAST_CHG_USER_ID
						 , SYS_LAST_CHG_PRGRM_ID
						 )
					VALUES
						 (
						   #{apcCd}
						 , #{prdcrCd}
						 , #{frmhsExpctWrhsNo}
						 , #{crtrYr}
						 , #{crtrMm}
						 , #{ymd}
						 , #{qntt}
						 , SYSDATE
						 , #{sysFrstInptUserId}
						 , #{sysFrstInptPrgrmId}
						 , SYSDATE
						 , #{sysLastChgUserId}
						 , #{sysLastChgPrgrmId}
						 )
		]]>
	</update>
	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.deleteFrmhsExpctWrhsDtl		-->
	<!-- DESC : 영농관리 - 농가예상입고상세 삭제.                    					-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.06.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
	<update id="deleteFrmhsExpctWrhsDtl" parameterType="com.at.apcss.am.wrhs.vo.FrmhsExpctWrhsVO">
		<![CDATA[
			UPDATE /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.deleteFrmhsExpctWrhsDtl */
				   TB_FRMHS_EXPCT_WRHS_DTL
		       SET
				   DEL_YN 					= 'Y'
				 , SYS_LAST_CHG_DT          = SYSDATE
				 , SYS_LAST_CHG_USER_ID     = #{sysLastChgUserId}
				 , SYS_LAST_CHG_PRGRM_ID    = #{sysLastChgPrgrmId}
			 WHERE APC_CD 					= #{apcCd}
			   AND PRDCR_CD 				= #{prdcrCd}
			   AND FRMHS_EXPCT_WRHS_NO 		= #{frmhsExpctWrhsNo}
		]]>
	</update>
	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.selectFrmhsExpctWrhsDdln	-->
	<!-- DESC : 영농관리 - 농가예상입고마감조회.                    					-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.11.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
	<select id="selectFrmhsExpctWrhsDdln" parameterType="com.at.apcss.am.wrhs.vo.FrmhsExpctWrhsDdlnVO" resultType="com.at.apcss.am.wrhs.vo.FrmhsExpctWrhsDdlnVO">
		<![CDATA[
			SELECT /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.selectFrmhsExpctWrhsDdln */
			       EWD.APC_CD 		AS APC_CD
			     , EWD.YR			AS YR
			     , EWD.YMD			AS YMD
			     , EWD.USE_YN		AS USE_YN
			     , EWD.DEL_YN		AS DEL_YN
			  FROM TB_FRMHS_EXPCT_WRHS_DDLN EWD
			 WHERE APC_CD 		= #{apcCd}
			   AND YR 			= #{yr}
			   AND ITEM_CD		= #{itemCd}
		]]>
	</select>
	<!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.insertFrmhsExpctWrhsDdln	-->
	<!-- DESC : 영농관리 - 농가예상입고마감 저장.                    					-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.11.26  	김  호        	Initial Creation                            	-->
	<!-- ==============================================================================	-->
	<update id="updateFrmhsExpctWrhsDdln" parameterType="com.at.apcss.am.wrhs.vo.FrmhsExpctWrhsDdlnVO">
		<![CDATA[
			MERGE /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.insertFrmhsExpctWrhsDdln */
			 INTO TB_FRMHS_EXPCT_WRHS_DDLN A
			USING DUAL
			   ON (
			       	   A.APC_CD 					= #{apcCd}
			       AND A.ITEM_CD					= #{itemCd}
			       AND A.YR 						= #{yr}
			      )
			 WHEN MATCHED THEN
					UPDATE
				       SET
						   A.YMD					= #{ymd}
						 , A.USE_YN					= #{useYn}
						 , A.SYS_LAST_CHG_DT        = SYSDATE
						 , A.SYS_LAST_CHG_USER_ID   = #{sysLastChgUserId}
						 , A.SYS_LAST_CHG_PRGRM_ID  = #{sysLastChgPrgrmId}
					 WHERE A.APC_CD 				= #{apcCd}
			    	   AND A.ITEM_CD				= #{itemCd}
					   AND A.YR 					= #{yr}
		     WHEN NOT MATCHED THEN
		     		INSERT
					     (
					       APC_CD
			    		 , ITEM_CD
					     , YR
					     , YMD
					     , USE_YN
					     , SYS_FRST_INPT_DT
						 , SYS_FRST_INPT_USER_ID
						 , SYS_FRST_INPT_PRGRM_ID
						 , SYS_LAST_CHG_DT
						 , SYS_LAST_CHG_USER_ID
						 , SYS_LAST_CHG_PRGRM_ID
						 )
					VALUES
						 (
						   #{apcCd}
			    		 , #{itemCd}
					     , #{yr}
					     , #{ymd}
					     , #{useYn}
					     , SYSDATE
						 , #{sysFrstInptUserId}
						 , #{sysFrstInptPrgrmId}
						 , SYSDATE
						 , #{sysLastChgUserId}
						 , #{sysLastChgPrgrmId}
						 )
		]]>
	</update>

    <!-- ==============================================================================	-->
    <!-- NAME : com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.selectStdgList	            -->
    <!-- DESC : 법정동 목록 조회.                    					                    -->
    <!-- ==============================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
    <!-- ===========  	============  	===============================================	-->
    <!-- 2025.06.20  	최 지 호        	Initial Creation                            	-->
    <!-- ==============================================================================	-->
    <select id="selectStdgList" parameterType="com.at.apcss.am.wrhs.vo.StdgVO" resultType="com.at.apcss.am.wrhs.vo.StdgVO">
        <if test='pagingYn != null and pagingYn.equals("Y")'>
            SELECT
                  ROWNUM AS ROW_SEQ
                , COUNT(*) OVER() AS TOTAL_RECORD_COUNT
                , pt0.*
            FROM (
        </if>

        <![CDATA[
                SELECT /* com.at.apcss.am.wrhs.mapper.FrmerInfoMapper.selectStdgList */
                      SC.STDG_CD
                    , SC.STDG
                    , SC.STDG_CTPV
                    , SC.STDG_SGG
                    , SC.STDG_EMD
                    , SC.STDG_LI
                    , SC.DEL_YN
                FROM TB_COM_STDG_CD SC
                WHERE 1=1
        ]]>

        <if test='delYn != null and delYn != ""'>
                AND SC.DEL_YN = #{delYn}
        </if>
        <if test='stdg != null and stdg !=""'>
                AND SC.STDG LIKE '%' || #{stdg} ||'%'
        </if>

        <![CDATA[
                ORDER BY SC.STDG_CD
        ]]>

        <if test='pagingYn != null and pagingYn.equals("Y")'>
            ) pt0
            OFFSET (#{currentPageNo} - 1) * #{recordCountPerPage} ROWS
            FETCH FIRST #{recordCountPerPage} ROWS ONLY
        </if>
    </select>
</mapper>