<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!-- ==========================================================================	-->
<!-- NAME : SpmtPrfmncMapper.xml                                   				-->
<!-- DESC : 출하실적조회 mapper                   				                -->
<!-- ==========================================================================	-->
<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
<!-- ===========  	============  	===========================================	-->
<!-- 2023.08.17  	하민우        	Initial Creation                            -->
<!-- ==========================================================================	-->

<mapper namespace="com.at.apcss.am.spmt.mapper.SpmtPrfmncMapper">

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.spmt.mapper.SpmtPrfmncMapper.selectSpmtPrfmncList	-->
	<!-- DESC : 출하실적조회 목록 조회.	                         	             	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.08.17  	하민우        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectSpmtPrfmncList" parameterType="com.at.apcss.am.spmt.vo.SpmtPrfmncVO" resultType="com.at.apcss.am.spmt.vo.SpmtPrfmncVO">
    	<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    		SELECT
    			  ROWNUM AS ROW_SEQ
    			, COUNT(*) OVER() AS TOTAL_RECORD_COUNT
    			, pt0.*
    			, (SELECT FN_GET_GDS_NM(pt0.GDS_CD, pt0.APC_CD) FROM DUAL)							AS GDS_NM
    			, (SELECT FN_GET_ITEM_NM(pt0.ITEM_CD, pt0.APC_CD) FROM DUAL) 						AS ITEM_NM
    			, (SELECT FN_GET_VRTY_NM(pt0.ITEM_CD, pt0.VRTY_CD, pt0.APC_CD) FROM DUAL)			AS VRTY_NM
    		 	, (SELECT FN_GET_SPCFCT_NM(pt0.ITEM_CD, pt0.SPCFCT_CD, pt0.APC_CD) FROM DUAL)		AS SPCFCT_NM
    		 	, (SELECT FN_GET_CNPT_NM(pt0.CNPT_CD, pt0.APC_CD) FROM DUAL)						AS CNPT_NM
    		 	, (SELECT FN_GET_TRSPRT_CO_NM(pt0.TRSPRT_CO_CD, pt0.APC_CD) FROM DUAL)				AS TRSPRT_CO_NM
    		 	, (SELECT FN_GET_GRD_NM_GDS(pt0.APC_CD, pt0.ITEM_CD, pt0.GDS_GRD) FROM DUAL) 		AS GDS_GRD_NM
    		 	, (SELECT FN_GET_SPMT_PCKG_UNIT_NM(pt0.SPMT_PCKG_UNIT_CD, pt0.APC_CD) FROM DUAL)   	AS SPMT_PCKG_UNIT_NM
    		 	, SUM(pt0.SPMT_QNTT) OVER()			AS TOT_SPMT_QNTT
	    		, SUM(pt0.SPMT_WGHT) OVER()			AS TOT_SPMT_WGHT
    		 FROM (
    	</if>
    	<if test='pagingYn == null or pagingYn.equals("N")'>
    		SELECT
    			  pt0.*
    			, (SELECT FN_GET_GDS_NM(pt0.GDS_CD, pt0.APC_CD) FROM DUAL)							AS GDS_NM
    			, (SELECT FN_GET_ITEM_NM(pt0.ITEM_CD, pt0.APC_CD) FROM DUAL) 						AS ITEM_NM
    			, (SELECT FN_GET_VRTY_NM(pt0.ITEM_CD, pt0.VRTY_CD, pt0.APC_CD) FROM DUAL)			AS VRTY_NM
    		 	, (SELECT FN_GET_SPCFCT_NM(pt0.ITEM_CD, pt0.SPCFCT_CD, pt0.APC_CD) FROM DUAL)		AS SPCFCT_NM
    		 	, (SELECT FN_GET_CNPT_NM(pt0.CNPT_CD, pt0.APC_CD) FROM DUAL)						AS CNPT_NM
    		 	, (SELECT FN_GET_TRSPRT_CO_NM(pt0.TRSPRT_CO_CD, pt0.APC_CD) FROM DUAL)				AS TRSPRT_CO_NM
    		 	, (SELECT FN_GET_GRD_NM_GDS(pt0.APC_CD, pt0.ITEM_CD, pt0.GDS_GRD) FROM DUAL) 		AS GDS_GRD_NM
    		 	, (SELECT FN_GET_SPMT_PCKG_UNIT_NM(pt0.SPMT_PCKG_UNIT_CD, pt0.APC_CD) FROM DUAL)   AS SPMT_PCKG_UNIT_NM
    		 	, SUM(pt0.SPMT_QNTT) OVER()			AS TOT_SPMT_QNTT
	    		, SUM(pt0.SPMT_WGHT) OVER()			AS TOT_SPMT_WGHT
    		 FROM (
    	</if>
    	<!-- End 페이징 -->
    	<![CDATA[
		    	SELECT /* com.at.apcss.am.spmt.mapper.SpmtPrfmncMapper.selectSpmtPrfmncList */
				       PD.SPMTNO						AS SPMTNO
				     , PD.PCKG_SN                       AS PCKG_SN
				     , PD.PCKGNO                        AS PCKGNO
				     , PC.APC_CD						AS APC_CD
				     , PC.SPMT_YMD						AS SPMT_YMD
				     , PD.BRND_NM						AS BRND_NM
				     , PD.GDS_CD						AS GDS_CD
				     , PD.ITEM_CD						AS ITEM_CD
				     , PD.VRTY_CD						AS VRTY_CD
				     , PD.SPCFCT_CD						AS SPCFCT_CD
				     , PC.CNPT_CD						AS CNPT_CD
				     , PC.DLDTN					        AS DLDTN
				     , PC.TRSPRT_CO_CD				    AS TRSPRT_CO_CD
				     , PC.VHCLNO					    AS VHCLNO
				     , PC.TRSPRT_CST				    AS TRSPRT_CST
				     , PD.GDS_GRD                       AS GDS_GRD
                     , PD.SPMT_PCKG_UNIT_CD             AS SPMT_PCKG_UNIT_CD
				     , CASE WHEN PC.RTN_GDS_YN = 'Y'
                            THEN PD.SPMT_QNTT
                            ELSE ''
                            END AS RTN_GDS_QNTT
                     , CASE WHEN PC.RTN_GDS_YN = 'Y'
                            THEN PD.SPMT_WGHT
                            ELSE ''
                            END AS RTN_GDS_WGHT
                     , CASE WHEN PC.RTN_GDS_YN = 'Y'
                            THEN ''
                            ELSE PD.SPMT_QNTT
                            END AS SPMT_QNTT
                     , CASE WHEN PC.RTN_GDS_YN = 'Y'
                            THEN ''
                            ELSE PD.SPMT_WGHT
                            END AS SPMT_WGHT
				     , PC.RMRK                          AS RMRK
				     , NVL(PC.RTN_GDS_YN, 'N')          AS RTN_GDS_YN
				     , DECODE(PC.RTN_GDS_YN, 'Y', '반품', '출하') AS RTN_GDS_NM
				     , PD.ORGN_SPMTNO                   AS ORGN_SPMTNO
				     , PD.ORGN_PCKGNO                   AS ORGN_PCKGNO
				     , PD.ORGN_PCKG_SN                  AS ORGN_PCKG_SN
				     , PD.SPMT_QNTT - NVL((SELECT SUM(SPMT_QNTT)
				          FROM TB_SPMT_PRFMNC_DTL X
				         WHERE PD.APC_CD = X.APC_CD
				           AND PD.SPMTNO = X.ORGN_SPMTNO
				           AND PD.PCKGNO = X.ORGN_PCKGNO
				           AND PD.PCKG_SN = X.ORGN_PCKG_SN
				           AND X.DEL_YN = 'N'
				       ), 0) AS RTN_PSBLEY_QNTT
				     , PD.SPMT_WGHT - NVL((SELECT SUM(SPMT_WGHT)
				          FROM TB_SPMT_PRFMNC_DTL X
				         WHERE PD.APC_CD = X.APC_CD
				           AND PD.SPMTNO = X.ORGN_SPMTNO
				           AND PD.PCKGNO = X.ORGN_PCKGNO
				           AND PD.PCKG_SN = X.ORGN_PCKG_SN
				           AND X.DEL_YN = 'N'
				       ), 0) AS RTN_PSBLEY_WGHT
				     , (SELECT DDLN_YN
				          FROM TB_DDLN_MNG X
				         WHERE X.APC_CD = PC.APC_CD
				           AND SUBSTR(PC.SPMT_YMD, 1,4) = X.CRTR_YR
				           AND SUBSTR(PC.SPMT_YMD, 5,2) = X.CRTR_MM
				       ) AS DDLN_YN
				     , CASE WHEN 0 < (SELECT COUNT(*) FROM TB_SLS_PRFMNC X WHERE X.APC_CD = PC.APC_CD AND X.SPMTNO = PD.SPMTNO AND X.CFMTN_YN = 'Y' AND X.DEL_YN = 'N')
                            THEN 'Y'
				            ELSE 'N'
                       END AS CFMTN_YN
				     , PWS.SN                   AS SN
                     , PWS.PLT_BX_CD            AS PLT_BX_CD
                     , PWS.QNTT                 AS BSS_INVNTR_QNTT
                     , CASE WHEN PWS.PLT_BX_CD IS NOT NULL THEN 'Y'
                            ELSE 'N'
                       END AS PLT_SPMT_YN

				  FROM TB_SPMT_PRFMNC_COM		PC
				     , TB_SPMT_PRFMNC_DTL		PD
                     , TB_PLT_WRHS_SPMT         PWS
				 WHERE PC.APC_CD = PD.APC_CD
				   AND PC.SPMTNO = PD.SPMTNO
                   AND PC.APC_CD = PWS.APC_CD(+)
                   AND PC.SPMTNO = PWS.PRCS_NO(+)
                   AND PC.SPMT_YMD = PWS.JOB_YMD(+)
                   AND PWS.DEL_YN(+) = 'N'
				   AND PC.DEL_YN = 'N'
				   AND PD.DEL_YN = 'N'

		]]>
			<if test='apcCd != null and apcCd != ""'>
				   AND PC.APC_CD = #{apcCd}
			</if>
			<if test='spmtYmdFrom != null and spmtYmdFrom != ""'>
			   	   AND PC.SPMT_YMD <![CDATA[>=]]> #{spmtYmdFrom}
			</if>
			<if test='spmtYmdTo != null and spmtYmdTo != ""'>
			   	   AND PC.SPMT_YMD <![CDATA[<=]]> #{spmtYmdTo}
			</if>
			<if test='cnptNm != null and cnptNm != ""'>
				   AND (SELECT FN_GET_CNPT_NM(PC.CNPT_CD, PC.APC_CD) FROM DUAL) LIKE '%' ||  #{cnptNm} || '%'
			</if>
			<if test='cnptCd != null and cnptCd != ""'>
				   AND PC.CNPT_CD = #{cnptCd}
			</if>
			<if test='trsprtCoCd != null and trsprtCoCd != ""'>
			       AND PC.TRSPRT_CO_CD = #{trsprtCoCd}
			</if>
			<if test='rtnGdsYn != null and rtnGdsYn != ""'>
			       AND NVL(PC.RTN_GDS_YN, 'N') = #{rtnGdsYn}
			</if>
			<if test='spmtPckgUnitNm != null and spmtPckgUnitNm != ""'>
			       AND (SELECT FN_GET_SPMT_PCKG_UNIT_NM(PD.SPMT_PCKG_UNIT_CD, PD.APC_CD) FROM DUAL) LIKE '%' || #{spmtPckgUnitNm} || '%'
			</if>
			<if test='itemCd != null and itemCd != ""'>
			       AND PD.ITEM_CD = #{itemCd}
			</if>
			<if test='vrtyCd != null and vrtyCd != ""'>
			       AND PD.VRTY_CD in (SELECT COL1  FROM TABLE(FN_SYS_SPLIT_STRING(#{vrtyCd})))
			</if>
			<if test='warehouseSeCd != null and warehouseSeCd != ""'>
			       -- AND GI.WAREHOUSE_SE_CD = #{warehouseSeCd}
			</if>
			<if test='dldtn != null and dldtn != ""'>
			       AND PC.DLDTN LIKE '%' ||  #{dldtn} || '%'
			</if>
			<if test='vhclno != null and vhclno != ""'>
			       AND PC.VHCLNO LIKE '%' ||  #{vhclno} || '%'
			</if>
		<![CDATA[
		 			ORDER BY PC.SPMTNO, PD.PCKGNO, PD.PCKG_SN
		]]>
		<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    		  ) pt0
			OFFSET (#{currentPageNo} - 1) * #{recordCountPerPage} ROWS
			FETCH FIRST #{recordCountPerPage} ROWS ONLY
    	</if>
    	<if test='pagingYn == null or pagingYn.equals("N")'>
    		  ) pt0
    	</if>
    	<!-- End 페이징 -->
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.spmt.mapper.SpmtPrfmncMapper.selectSpmtPrfmncList	-->
	<!-- DESC : 출하실적조회 목록 집계조회.	                         	             	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.01.16  	박승진        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectSpmtPrfmncTotalList" parameterType="com.at.apcss.am.spmt.vo.SpmtPrfmncVO" resultType="com.at.apcss.am.spmt.vo.SpmtPrfmncVO">
    	<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    		SELECT
    			  ROWNUM AS ROW_SEQ
    			, COUNT(*) OVER() AS TOTAL_RECORD_COUNT
    			, pt0.*
    			, (SELECT FN_GET_GDS_NM(pt0.GDS_CD, pt0.APC_CD) FROM DUAL)							AS GDS_NM
    			, (SELECT FN_GET_ITEM_NM(pt0.ITEM_CD, pt0.APC_CD) FROM DUAL) 						AS ITEM_NM
    			, (SELECT FN_GET_VRTY_NM(pt0.ITEM_CD, pt0.VRTY_CD, pt0.APC_CD) FROM DUAL)			AS VRTY_NM
    		 	, (SELECT FN_GET_SPCFCT_NM(pt0.ITEM_CD, pt0.SPCFCT_CD, pt0.APC_CD) FROM DUAL)		AS SPCFCT_NM
    		 	, (SELECT FN_GET_CNPT_NM(pt0.CNPT_CD, pt0.APC_CD) FROM DUAL)						AS CNPT_NM
    		 	, (SELECT FN_GET_TRSPRT_CO_NM(pt0.TRSPRT_CO_CD, pt0.APC_CD) FROM DUAL)				AS TRSPRT_CO_NM
    		 	, (SELECT FN_GET_GRD_NM_GDS(pt0.APC_CD, pt0.ITEM_CD, pt0.GDS_GRD) FROM DUAL) 		AS GDS_GRD_NM
    		 	, (SELECT FN_GET_SPMT_PCKG_UNIT_NM(pt0.SPMT_PCKG_UNIT_CD, pt0.APC_CD) FROM DUAL)   	AS SPMT_PCKG_UNIT_NM
    		 	, SUM(pt0.SPMT_QNTT) OVER()			AS TOT_SPMT_QNTT
	    		, SUM(pt0.SPMT_WGHT) OVER()			AS TOT_SPMT_WGHT
    		 FROM (
    	</if>
    	<if test='pagingYn == null or pagingYn.equals("N")'>
    		SELECT
    			  pt0.*
    			, (SELECT FN_GET_GDS_NM(pt0.GDS_CD, pt0.APC_CD) FROM DUAL)							AS GDS_NM
    			, (SELECT FN_GET_ITEM_NM(pt0.ITEM_CD, pt0.APC_CD) FROM DUAL) 						AS ITEM_NM
    			, (SELECT FN_GET_VRTY_NM(pt0.ITEM_CD, pt0.VRTY_CD, pt0.APC_CD) FROM DUAL)			AS VRTY_NM
    		 	, (SELECT FN_GET_SPCFCT_NM(pt0.ITEM_CD, pt0.SPCFCT_CD, pt0.APC_CD) FROM DUAL)		AS SPCFCT_NM
    		 	, (SELECT FN_GET_CNPT_NM(pt0.CNPT_CD, pt0.APC_CD) FROM DUAL)						AS CNPT_NM
    		 	, (SELECT FN_GET_TRSPRT_CO_NM(pt0.TRSPRT_CO_CD, pt0.APC_CD) FROM DUAL)				AS TRSPRT_CO_NM
    		 	, (SELECT FN_GET_GRD_NM_GDS(pt0.APC_CD, pt0.ITEM_CD, pt0.GDS_GRD) FROM DUAL) 		AS GDS_GRD_NM
    		 	, (SELECT FN_GET_SPMT_PCKG_UNIT_NM(pt0.SPMT_PCKG_UNIT_CD, pt0.APC_CD) FROM DUAL)   AS SPMT_PCKG_UNIT_NM
    		 	, SUM(pt0.SPMT_QNTT) OVER()			AS TOT_SPMT_QNTT
	    		, SUM(pt0.SPMT_WGHT) OVER()			AS TOT_SPMT_WGHT
    		 FROM (
    	</if>
    	<!-- End 페이징 -->
    	<![CDATA[
		    	SELECT /* com.at.apcss.am.spmt.mapper.SpmtPrfmncMapper.selectSpmtPrfmncTotalList */
				       PD.SPMTNO						AS SPMTNO
				     , PD.APC_CD						AS APC_CD
				     , PC.SPMT_YMD						AS SPMT_YMD
				     , PD.BRND_NM						AS BRND_NM
				     , MAX(PD.GDS_CD)						AS GDS_CD
				     , PD.ITEM_CD						AS ITEM_CD
				     , PD.VRTY_CD						AS VRTY_CD
				     , PD.SPCFCT_CD						AS SPCFCT_CD
				     , PC.CNPT_CD						AS CNPT_CD
				     , MAX(PC.DLDTN)					        AS DLDTN
				     , MAX(PC.TRSPRT_CO_CD)				    AS TRSPRT_CO_CD
				     , MAX(PC.VHCLNO)					    AS VHCLNO
				     , SUM(PC.TRSPRT_CST)				    AS TRSPRT_CST
				     , PD.GDS_GRD                       AS GDS_GRD
                     , PD.SPMT_PCKG_UNIT_CD             AS SPMT_PCKG_UNIT_CD
				     , CASE WHEN MAX(PC.RTN_GDS_YN) = 'Y'
                            THEN SUM(PD.SPMT_QNTT)
                            ELSE ''
                            END AS RTN_GDS_QNTT
                     , CASE WHEN MAX(PC.RTN_GDS_YN) = 'Y'
                            THEN SUM(PD.SPMT_WGHT)
                            ELSE ''
                            END AS RTN_GDS_WGHT
                     , CASE WHEN MAX(PC.RTN_GDS_YN) = 'Y'
                            THEN ''
                            ELSE SUM(PD.SPMT_QNTT)
                            END AS SPMT_QNTT
                     , CASE WHEN MAX(PC.RTN_GDS_YN) = 'Y'
                            THEN ''
                            ELSE SUM(PD.SPMT_WGHT)
                            END AS SPMT_WGHT
				     , MAX(PC.RMRK)                          AS RMRK
				     , NVL(MAX(PC.RTN_GDS_YN), 'N')          AS RTN_GDS_YN
				     , DECODE(MAX(PC.RTN_GDS_YN), 'Y', '반품', '출하') AS RTN_GDS_NM
				     , MAX(PD.ORGN_SPMTNO)                   AS ORGN_SPMTNO
				     , MAX(PD.ORGN_PCKGNO)                   AS ORGN_PCKGNO
				     , MAX(PD.ORGN_PCKG_SN)                  AS ORGN_PCKG_SN
				     , SUM(PD.SPMT_QNTT) - NVL((SELECT SUM(X.SPMT_QNTT)
				          FROM TB_SPMT_PRFMNC_DTL X
				         WHERE PD.APC_CD = X.APC_CD
				           AND PD.SPMTNO = X.ORGN_SPMTNO
				           AND X.DEL_YN = 'N'
				       ), 0) AS RTN_PSBLEY_QNTT
				     , SUM(PD.SPMT_WGHT) - NVL((SELECT SUM(X.SPMT_WGHT)
				          FROM TB_SPMT_PRFMNC_DTL X
				         WHERE PD.APC_CD = X.APC_CD
				           AND X.ORGN_SPMTNO = PD.SPMTNO
				           AND X.DEL_YN = 'N'
				           GROUP BY X.APC_CD,X.ORGN_SPMTNO,X.ORGN_PCKGNO
				       ), 0) AS RTN_PSBLEY_WGHT
				     , (SELECT DDLN_YN
				          FROM TB_DDLN_MNG X
				         WHERE X.APC_CD = PD.APC_CD
				           AND SUBSTR(PC.SPMT_YMD, 1,4) = X.CRTR_YR
				           AND SUBSTR(PC.SPMT_YMD, 5,2) = X.CRTR_MM
				       ) AS DDLN_YN
				     , CASE WHEN 0 < (SELECT COUNT(*) FROM TB_SLS_PRFMNC X WHERE X.APC_CD = PD.APC_CD AND X.SPMTNO = PD.SPMTNO AND X.CFMTN_YN = 'Y' AND X.DEL_YN = 'N')
                            THEN 'Y'
				            ELSE 'N'
                       END AS CFMTN_YN
				     , MAX(PWS.SN)                   AS SN
                     , MAX(PWS.PLT_BX_CD)            AS PLT_BX_CD
                     , SUM(PWS.QNTT)                 AS BSS_INVNTR_QNTT
                     , CASE WHEN MAX(PWS.PLT_BX_CD) IS NOT NULL THEN 'Y'
                            ELSE 'N'
                       END AS PLT_SPMT_YN

				  FROM TB_SPMT_PRFMNC_COM		PC
				     , TB_SPMT_PRFMNC_DTL		PD
                     , TB_PLT_WRHS_SPMT         PWS
				 WHERE PC.APC_CD = PD.APC_CD
				   AND PC.SPMTNO = PD.SPMTNO
                   AND PC.APC_CD = PWS.APC_CD(+)
                   AND PC.SPMTNO = PWS.PRCS_NO(+)
                   AND PC.SPMT_YMD = PWS.JOB_YMD(+)
                   AND PWS.DEL_YN(+) = 'N'
				   AND PC.DEL_YN = 'N'
				   AND PD.DEL_YN = 'N'

		]]>
			<if test='apcCd != null and apcCd != ""'>
				   AND PC.APC_CD = #{apcCd}
			</if>
			<if test='spmtYmdFrom != null and spmtYmdFrom != ""'>
			   	   AND PC.SPMT_YMD <![CDATA[>=]]> #{spmtYmdFrom}
			</if>
			<if test='spmtYmdTo != null and spmtYmdTo != ""'>
			   	   AND PC.SPMT_YMD <![CDATA[<=]]> #{spmtYmdTo}
			</if>
			<if test='cnptNm != null and cnptNm != ""'>
				   AND (SELECT FN_GET_CNPT_NM(PC.CNPT_CD, PC.APC_CD) FROM DUAL) LIKE '%' ||  #{cnptNm} || '%'
			</if>
			<if test='cnptCd != null and cnptCd != ""'>
				   AND PC.CNPT_CD = #{cnptCd}
			</if>
			<if test='trsprtCoCd != null and trsprtCoCd != ""'>
			       AND PC.TRSPRT_CO_CD = #{trsprtCoCd}
			</if>
			<if test='rtnGdsYn != null and rtnGdsYn != ""'>
			       AND NVL(PC.RTN_GDS_YN, 'N') = #{rtnGdsYn}
			</if>
			<if test='spmtPckgUnitNm != null and spmtPckgUnitNm != ""'>
			       AND (SELECT FN_GET_SPMT_PCKG_UNIT_NM(PD.SPMT_PCKG_UNIT_CD, PD.APC_CD) FROM DUAL) LIKE '%' || #{spmtPckgUnitNm} || '%'
			</if>
			<if test='itemCd != null and itemCd != ""'>
			       AND PD.ITEM_CD = #{itemCd}
			</if>
			<if test='vrtyCd != null and vrtyCd != ""'>
			       AND PD.VRTY_CD in (SELECT COL1  FROM TABLE(FN_SYS_SPLIT_STRING(#{vrtyCd})))
			</if>
			<if test='warehouseSeCd != null and warehouseSeCd != ""'>
			       -- AND GI.WAREHOUSE_SE_CD = #{warehouseSeCd}
			</if>
			<if test='dldtn != null and dldtn != ""'>
			       AND PC.DLDTN LIKE '%' ||  #{dldtn} || '%'
			</if>
			<if test='vhclno != null and vhclno != ""'>
			       AND PC.VHCLNO LIKE '%' ||  #{vhclno} || '%'
			</if>
		<![CDATA[
					GROUP BY PD.APC_CD,PD.SPMTNO,PC.SPMT_YMD, PD.BRND_NM, PC.CNPT_CD, PD.ITEM_CD,PD.VRTY_CD,PD.SPCFCT_CD,PD.GDS_GRD,PD.SPMT_PCKG_UNIT_CD
		 			ORDER BY PD.SPMTNO,PD.BRND_NM, PC.CNPT_CD, PD.ITEM_CD,PD.VRTY_CD,PD.SPCFCT_CD,PD.GDS_GRD,PD.SPMT_PCKG_UNIT_CD
		]]>
		<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    		  ) pt0
			OFFSET (#{currentPageNo} - 1) * #{recordCountPerPage} ROWS
			FETCH FIRST #{recordCountPerPage} ROWS ONLY
    	</if>
    	<if test='pagingYn == null or pagingYn.equals("N")'>
    		  ) pt0
    	</if>
    	<!-- End 페이징 -->
    </select>

    <!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.spmt.mapper.SpmtPrfmncMapper.selectSpmtPrfmncDtl	-->
	<!-- DESC : 출하실적 상세 목록 조회.	                         	            -->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.08.21  	김호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<select id="selectSpmtPrfmncDtl" parameterType="com.at.apcss.am.spmt.vo.SpmtPrfmncVO" resultType="com.at.apcss.am.spmt.vo.SpmtPrfmncVO">
		<![CDATA[
		SELECT  /* com.at.apcss.am.spmt.mapper.SpmtPrfmncMapper.selectSpmtPrfmncDtl */
		       PD.APC_CD            AS APC_CD
		     , PD.SPMTNO            AS SPMTNO
		     , PD.PCKGNO            AS PCKGNO
		     , PD.PCKG_SN           AS PCKG_SN
		     , PD.VRTY_CD           AS VRTY_CD
		     , PD.ITEM_CD           AS ITEM_CD
		     , PD.GDS_GRD           AS GDS_GRD
		     , PD.SPCFCT_CD         AS SPCFCT_CD
		     , PD.SPMT_QNTT         AS SPMT_QNTT
		     , PD.SPMT_WGHT         AS SPMT_WGHT
		     , PD.BRND_NM           AS BRND_NM
		     , PD.GDS_CD            AS GDS_CD
		     , PD.PRDCR_CD          AS PRDCR_CD
		     , PD.DEL_YN            AS DEL_YN
		     , PD.SPMT_CMNDNO       AS SPMT_CMNDNO
		     , PD.SPMT_PCKG_UNIT_CD AS SPMT_PCKG_UNIT_CD

		  FROM TB_SPMT_PRFMNC_DTL PD
		 WHERE PD.APC_CD = #{apcCd}
		   AND PD.SPMTNO = #{spmtno}
		]]>
	</select>

    <!-- ==============================================================================	-->
	<!-- NAME : com.at.apcss.am.spmt.mapper.SpmtPrfmncMapper.selectSpmtPrfmncDsctnList	-->
	<!-- DESC : 파프리카출하실적 조회	                                       					-->
	<!-- ==============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	===============================================	-->
	<!-- 2024.04.01  	김호      		Initial Creation                            	-->
	<!-- ==============================================================================	-->
    <select id="selectSpmtPrfmncDsctnList" parameterType="com.at.apcss.am.spmt.vo.SpmtDsctnTotVO" resultType="com.at.apcss.am.spmt.vo.SpmtDsctnTotVO">
    	<choose>
    		<when test='grdGubun != null and grdGubun !=""'>
    			<if test='grdGubun == "A"'>
    				<![CDATA[
    					SELECT  APC_CD				AS APC_CD
    						  , SPMTNO     			AS SPMTNO
						      , SPMT_YMD  			AS SPMT_YMD
						      , CNPT_CD  			AS CNPT_CD
						      , CNPT_NM  			AS CNPT_NM
						      , MAX(RMRK)			AS RMRK
						      , MAX(ITEM_CD)  		AS ITEM_CD
						      , SUM(R_2XL)  		AS red2Xl
						      , SUM(R_XL)   		AS redXl
						      , SUM(R_L)    		AS redL
						      , SUM(R_M)    		AS redM
						      , SUM(R_S)    		AS redS
						      , SUM(R_SS)   		AS redSs
						      , SUM(Y_2XL)  		AS ylw2Xl
						      , SUM(Y_XL)   		AS ylwXl
						      , SUM(Y_L)    		AS ylwL
						      , SUM(Y_M)    		AS ylwM
						      , SUM(Y_S)    		AS ylwS
						      , SUM(Y_SS)   		AS ylwSs
						      , SUM(O_2XL)  		AS org2Xl
						      , SUM(O_XL)   		AS orgXl
						      , SUM(O_L)    		AS orgL
						      , SUM(O_M)    		AS orgM
						      , SUM(O_S)    		AS orgS
						      , SUM(O_SS)   		AS orgSs
						      , SUM(SPMT_QNTT)		AS tot
						      , SUM(R_TOT)  		AS redTot
						      , SUM(Y_TOT)  		AS ylwTot
						      , SUM(O_TOT)  		AS orgTot
						   FROM (SELECT PC.APC_CD
						   			  , PC.SPMTNO
						   			  , PC.SPMT_YMD AS SPMT_YMD
						   			  , PC.CNPT_CD AS CNPT_CD
						   			  , (SELECT FN_GET_CNPT_NM(PC.CNPT_CD, PC.APC_CD) FROM DUAL) AS CNPT_NM
						   			  , PD.ITEM_CD AS ITEM_CD
						              , CASE WHEN PD.VRTY_CD = '0300' AND PD.GDS_GRD IN ('01') THEN PD.SPMT_QNTT END AS R_2XL
						              , CASE WHEN PD.VRTY_CD = '0300' AND PD.GDS_GRD IN ('02') THEN PD.SPMT_QNTT END AS R_XL
						              , CASE WHEN PD.VRTY_CD = '0300' AND PD.GDS_GRD IN ('03') THEN PD.SPMT_QNTT END AS R_L
						              , CASE WHEN PD.VRTY_CD = '0300' AND PD.GDS_GRD IN ('04') THEN PD.SPMT_QNTT END AS R_M
						              , CASE WHEN PD.VRTY_CD = '0300' AND PD.GDS_GRD IN ('05') THEN PD.SPMT_QNTT END AS R_S
						              , CASE WHEN PD.VRTY_CD = '0300' AND PD.GDS_GRD IN ('06') THEN PD.SPMT_QNTT END AS R_SS
						              , CASE WHEN PD.VRTY_CD = '0200' AND PD.GDS_GRD IN ('01') THEN PD.SPMT_QNTT END AS Y_2XL
						              , CASE WHEN PD.VRTY_CD = '0200' AND PD.GDS_GRD IN ('02') THEN PD.SPMT_QNTT END AS Y_XL
						              , CASE WHEN PD.VRTY_CD = '0200' AND PD.GDS_GRD IN ('03') THEN PD.SPMT_QNTT END AS Y_L
						              , CASE WHEN PD.VRTY_CD = '0200' AND PD.GDS_GRD IN ('04') THEN PD.SPMT_QNTT END AS Y_M
						              , CASE WHEN PD.VRTY_CD = '0200' AND PD.GDS_GRD IN ('05') THEN PD.SPMT_QNTT END AS Y_S
						              , CASE WHEN PD.VRTY_CD = '0200' AND PD.GDS_GRD IN ('06') THEN PD.SPMT_QNTT END AS Y_SS
						              , CASE WHEN PD.VRTY_CD = '0400' AND PD.GDS_GRD IN ('01') THEN PD.SPMT_QNTT END AS O_2XL
						              , CASE WHEN PD.VRTY_CD = '0400' AND PD.GDS_GRD IN ('02') THEN PD.SPMT_QNTT END AS O_XL
						              , CASE WHEN PD.VRTY_CD = '0400' AND PD.GDS_GRD IN ('03') THEN PD.SPMT_QNTT END AS O_L
						              , CASE WHEN PD.VRTY_CD = '0400' AND PD.GDS_GRD IN ('04') THEN PD.SPMT_QNTT END AS O_M
						              , CASE WHEN PD.VRTY_CD = '0400' AND PD.GDS_GRD IN ('05') THEN PD.SPMT_QNTT END AS O_S
						              , CASE WHEN PD.VRTY_CD = '0400' AND PD.GDS_GRD IN ('06') THEN PD.SPMT_QNTT END AS O_SS
						              , CASE WHEN PD.VRTY_CD = '0300' AND PD.GDS_GRD IN ('01','02','03','04','05','06') THEN PD.SPMT_QNTT END AS R_TOT
						              , CASE WHEN PD.VRTY_CD = '0200' AND PD.GDS_GRD IN ('01','02','03','04','05','06') THEN PD.SPMT_QNTT END AS Y_TOT
						              , CASE WHEN PD.VRTY_CD = '0400' AND PD.GDS_GRD IN ('01','02','03','04','05','06') THEN PD.SPMT_QNTT END AS O_TOT
						              , PD.SPMT_QNTT 	AS SPMT_QNTT
						              , PC.RMRK     	AS RMRK
						           FROM USRAM.TB_SPMT_PRFMNC_COM PC
						              , USRAM.TB_SPMT_PRFMNC_DTL PD
						          WHERE PD.GDS_GRD IN ('01','02','03','04','05','06')
						            AND PC.APC_CD = PD.APC_CD
						            AND PC.SPMTNO = PD.SPMTNO
						            AND PC.DEL_YN = 'N'
						            AND PD.DEL_YN = 'N'
    				]]>
   					<if test='apcCd != null and apcCd !=""'>
					            	AND PC.APC_CD = #{apcCd}
   					</if>
					<if test='spmtYmdFrom != null and spmtYmdFrom != ""'>
					   	   			AND PC.SPMT_YMD <![CDATA[>=]]> #{spmtYmdFrom}
					</if>
					<if test='spmtYmdTo != null and spmtYmdTo != ""'>
					   	   			AND PC.SPMT_YMD <![CDATA[<=]]> #{spmtYmdTo}
					</if>
					<if test='spmtYmd != null and spmtYmd != ""'>
					   	   			AND PC.SPMT_YMD <![CDATA[=]]> #{spmtYmd}
					</if>
					<if test='itemCd != null and itemCd != ""'>
									AND PD.ITEM_CD = #{itemCd}
					</if>
					<if test='cnptNm != null and cnptNm != ""'>
									AND (SELECT FN_GET_CNPT_NM(PC.CNPT_CD, PC.APC_CD) FROM DUAL) LIKE '%' ||  #{cnptNm} || '%'
					</if>
					<if test='cnptCd != null and cnptCd != ""'>
									AND PC.CNPT_CD = #{cnptCd}
					</if>
    				<![CDATA[
								)
					   GROUP BY APC_CD
					   		  , SPMTNO
						      , SPMT_YMD
						      , CNPT_CD
						      , CNPT_NM
					   ORDER BY SPMTNO DESC
    				]]>
    			</if>
    			<if test='grdGubun == "B"'>
    				<![CDATA[
    					SELECT  APC_CD				AS APC_CD
    						  , SPMTNO     			AS SPMTNO
						      , SPMT_YMD  			AS SPMT_YMD
						      , CNPT_CD  			AS CNPT_CD
						      , CNPT_NM  			AS CNPT_NM
						      , MAX(RMRK)			AS RMRK
						      , MAX(ITEM_CD)  		AS ITEM_CD
						      , SUM(R_2XL)  		AS red2Xl
						      , SUM(R_XL)   		AS redXl
						      , SUM(R_L)    		AS redL
						      , SUM(R_M)    		AS redM
						      , SUM(R_S)    		AS redS
						      , SUM(R_SS)   		AS redSs
						      , SUM(Y_2XL)  		AS ylw2Xl
						      , SUM(Y_XL)   		AS ylwXl
						      , SUM(Y_L)    		AS ylwL
						      , SUM(Y_M)    		AS ylwM
						      , SUM(Y_S)    		AS ylwS
						      , SUM(Y_SS)   		AS ylwSs
						      , SUM(O_2XL)  		AS org2Xl
						      , SUM(O_XL)   		AS orgXl
						      , SUM(O_L)    		AS orgL
						      , SUM(O_M)    		AS orgM
						      , SUM(O_S)    		AS orgS
						      , SUM(O_SS)   		AS orgSs
						      , SUM(SPMT_QNTT)		AS tot
						      , SUM(R_TOT)  		AS redTot
						      , SUM(Y_TOT)  		AS ylwTot
						      , SUM(O_TOT)  		AS orgTot
						   FROM (SELECT PC.APC_CD
						   			  , PC.SPMTNO
						   			  , PC.SPMT_YMD AS SPMT_YMD
						   			  , PC.CNPT_CD AS CNPT_CD
						   			  , (SELECT FN_GET_CNPT_NM(PC.CNPT_CD, PC.APC_CD) FROM DUAL) AS CNPT_NM
						   			  , PD.ITEM_CD AS ITEM_CD
						              , CASE WHEN PD.VRTY_CD = '0300' AND PD.GDS_GRD IN ('07') THEN PD.SPMT_QNTT END AS R_2XL
						              , CASE WHEN PD.VRTY_CD = '0300' AND PD.GDS_GRD IN ('08') THEN PD.SPMT_QNTT END AS R_XL
						              , CASE WHEN PD.VRTY_CD = '0300' AND PD.GDS_GRD IN ('09') THEN PD.SPMT_QNTT END AS R_L
						              , CASE WHEN PD.VRTY_CD = '0300' AND PD.GDS_GRD IN ('10') THEN PD.SPMT_QNTT END AS R_M
						              , CASE WHEN PD.VRTY_CD = '0300' AND PD.GDS_GRD IN ('11') THEN PD.SPMT_QNTT END AS R_S
						              , CASE WHEN PD.VRTY_CD = '0300' AND PD.GDS_GRD IN ('12') THEN PD.SPMT_QNTT END AS R_SS
						              , CASE WHEN PD.VRTY_CD = '0200' AND PD.GDS_GRD IN ('07') THEN PD.SPMT_QNTT END AS Y_2XL
						              , CASE WHEN PD.VRTY_CD = '0200' AND PD.GDS_GRD IN ('08') THEN PD.SPMT_QNTT END AS Y_XL
						              , CASE WHEN PD.VRTY_CD = '0200' AND PD.GDS_GRD IN ('09') THEN PD.SPMT_QNTT END AS Y_L
						              , CASE WHEN PD.VRTY_CD = '0200' AND PD.GDS_GRD IN ('10') THEN PD.SPMT_QNTT END AS Y_M
						              , CASE WHEN PD.VRTY_CD = '0200' AND PD.GDS_GRD IN ('11') THEN PD.SPMT_QNTT END AS Y_S
						              , CASE WHEN PD.VRTY_CD = '0200' AND PD.GDS_GRD IN ('12') THEN PD.SPMT_QNTT END AS Y_SS
						              , CASE WHEN PD.VRTY_CD = '0400' AND PD.GDS_GRD IN ('07') THEN PD.SPMT_QNTT END AS O_2XL
						              , CASE WHEN PD.VRTY_CD = '0400' AND PD.GDS_GRD IN ('08') THEN PD.SPMT_QNTT END AS O_XL
						              , CASE WHEN PD.VRTY_CD = '0400' AND PD.GDS_GRD IN ('09') THEN PD.SPMT_QNTT END AS O_L
						              , CASE WHEN PD.VRTY_CD = '0400' AND PD.GDS_GRD IN ('10') THEN PD.SPMT_QNTT END AS O_M
						              , CASE WHEN PD.VRTY_CD = '0400' AND PD.GDS_GRD IN ('11') THEN PD.SPMT_QNTT END AS O_S
						              , CASE WHEN PD.VRTY_CD = '0400' AND PD.GDS_GRD IN ('12') THEN PD.SPMT_QNTT END AS O_SS
						              , CASE WHEN PD.VRTY_CD = '0300' AND PD.GDS_GRD IN ('07','08','09','10','11','12') THEN PD.SPMT_QNTT END AS R_TOT
						              , CASE WHEN PD.VRTY_CD = '0200' AND PD.GDS_GRD IN ('07','08','09','10','11','12') THEN PD.SPMT_QNTT END AS Y_TOT
						              , CASE WHEN PD.VRTY_CD = '0400' AND PD.GDS_GRD IN ('07','08','09','10','11','12') THEN PD.SPMT_QNTT END AS O_TOT
						              , PD.SPMT_QNTT 	AS SPMT_QNTT
						              , PC.RMRK			AS RMRK
						           FROM USRAM.TB_SPMT_PRFMNC_COM PC
						              , USRAM.TB_SPMT_PRFMNC_DTL PD
						          WHERE PD.GDS_GRD IN ('07','08','09','10','11','12')
						            AND PC.APC_CD = PD.APC_CD
						            AND PC.SPMTNO = PD.SPMTNO
						            AND PC.DEL_YN = 'N'
						            AND PD.DEL_YN = 'N'
    				]]>
   					<if test='apcCd != null and apcCd !=""'>
					            	AND PC.APC_CD = #{apcCd}
   					</if>
					<if test='spmtYmdFrom != null and spmtYmdFrom != ""'>
					   	   			AND PC.SPMT_YMD <![CDATA[>=]]> #{spmtYmdFrom}
					</if>
					<if test='spmtYmdTo != null and spmtYmdTo != ""'>
					   	   			AND PC.SPMT_YMD <![CDATA[<=]]> #{spmtYmdTo}
					</if>
					<if test='spmtYmd != null and spmtYmd != ""'>
					   	   			AND PC.SPMT_YMD <![CDATA[=]]> #{spmtYmd}
					</if>
					<if test='itemCd != null and itemCd != ""'>
									AND PD.ITEM_CD = #{itemCd}
					</if>
					<if test='cnptNm != null and cnptNm != ""'>
									AND (SELECT FN_GET_CNPT_NM(PC.CNPT_CD, PC.APC_CD) FROM DUAL) LIKE '%' ||  #{cnptNm} || '%'
					</if>
					<if test='cnptCd != null and cnptCd != ""'>
									AND PC.CNPT_CD = #{cnptCd}
					</if>
    				<![CDATA[
								)
					   GROUP BY APC_CD
					          , SPMTNO
						      , SPMT_YMD
						      , CNPT_CD
						      , CNPT_NM
					   ORDER BY SPMTNO DESC
    				]]>
    			</if>
    			<if test='grdGubun == "C"'>
    				<![CDATA[
    					SELECT  APC_CD				AS APC_CD
    						  , SPMTNO     			AS SPMTNO
						      , SPMT_YMD  			AS SPMT_YMD
						      , CNPT_CD  			AS CNPT_CD
						      , CNPT_NM  			AS CNPT_NM
						      , MAX(RMRK)			AS RMRK
						      , MAX(ITEM_CD)  		AS ITEM_CD
						      , SUM(R_2XL)  		AS red2Xl
						      , SUM(R_XL)   		AS redXl
						      , SUM(R_L)    		AS redL
						      , SUM(R_M)    		AS redM
						      , SUM(R_S)    		AS redS
						      , SUM(R_SS)   		AS redSs
						      , SUM(Y_2XL)  		AS ylw2Xl
						      , SUM(Y_XL)   		AS ylwXl
						      , SUM(Y_L)    		AS ylwL
						      , SUM(Y_M)    		AS ylwM
						      , SUM(Y_S)    		AS ylwS
						      , SUM(Y_SS)   		AS ylwSs
						      , SUM(O_2XL)  		AS org2Xl
						      , SUM(O_XL)   		AS orgXl
						      , SUM(O_L)    		AS orgL
						      , SUM(O_M)    		AS orgM
						      , SUM(O_S)    		AS orgS
						      , SUM(O_SS)   		AS orgSs
						      , SUM(SPMT_QNTT)		AS tot
						      , SUM(R_TOT)  		AS redTot
						      , SUM(Y_TOT)  		AS ylwTot
						      , SUM(O_TOT)  		AS orgTot
						   FROM (SELECT PC.APC_CD
						   			  , PC.SPMTNO
						   			  , PC.SPMT_YMD AS SPMT_YMD
						   			  , PC.CNPT_CD AS CNPT_CD
						   			  , (SELECT FN_GET_CNPT_NM(PC.CNPT_CD, PC.APC_CD) FROM DUAL) AS CNPT_NM
						   			  , PD.ITEM_CD AS ITEM_CD
						              , CASE WHEN PD.VRTY_CD = '0300' AND PD.GDS_GRD IN ('13') THEN PD.SPMT_QNTT END AS R_2XL
						              , CASE WHEN PD.VRTY_CD = '0300' AND PD.GDS_GRD IN ('14') THEN PD.SPMT_QNTT END AS R_XL
						              , CASE WHEN PD.VRTY_CD = '0300' AND PD.GDS_GRD IN ('15') THEN PD.SPMT_QNTT END AS R_L
						              , 0 AS R_M
						              , 0 AS R_S
						              , 0 AS R_SS
						              , CASE WHEN PD.VRTY_CD = '0200' AND PD.GDS_GRD IN ('13') THEN PD.SPMT_QNTT END AS Y_2XL
						              , CASE WHEN PD.VRTY_CD = '0200' AND PD.GDS_GRD IN ('14') THEN PD.SPMT_QNTT END AS Y_XL
						              , CASE WHEN PD.VRTY_CD = '0200' AND PD.GDS_GRD IN ('15') THEN PD.SPMT_QNTT END AS Y_L
						              , 0 AS Y_M
						              , 0 AS Y_S
						              , 0 AS Y_SS
						              , CASE WHEN PD.VRTY_CD = '0400' AND PD.GDS_GRD IN ('13') THEN PD.SPMT_QNTT END AS O_2XL
						              , CASE WHEN PD.VRTY_CD = '0400' AND PD.GDS_GRD IN ('14') THEN PD.SPMT_QNTT END AS O_XL
						              , CASE WHEN PD.VRTY_CD = '0400' AND PD.GDS_GRD IN ('15') THEN PD.SPMT_QNTT END AS O_L
						              , 0 AS O_M
						              , 0 AS O_S
						              , 0 AS O_SS
						              , CASE WHEN PD.VRTY_CD = '0300' AND PD.GDS_GRD IN ('13','14','15') THEN PD.SPMT_QNTT END AS R_TOT
						              , CASE WHEN PD.VRTY_CD = '0200' AND PD.GDS_GRD IN ('13','14','15') THEN PD.SPMT_QNTT END AS Y_TOT
						              , CASE WHEN PD.VRTY_CD = '0400' AND PD.GDS_GRD IN ('13','14','15') THEN PD.SPMT_QNTT END AS O_TOT
						              , PD.SPMT_QNTT 	AS SPMT_QNTT
						              , PC.RMRK			AS RMRK
						           FROM USRAM.TB_SPMT_PRFMNC_COM PC
						              , USRAM.TB_SPMT_PRFMNC_DTL PD
						          WHERE PD.GDS_GRD IN ('13','14','15')
						            AND PC.APC_CD = PD.APC_CD
						            AND PC.SPMTNO = PD.SPMTNO
						            AND PC.DEL_YN = 'N'
						            AND PD.DEL_YN = 'N'
    				]]>
   					<if test='apcCd != null and apcCd !=""'>
					            	AND PC.APC_CD = #{apcCd}
   					</if>
					<if test='spmtYmdFrom != null and spmtYmdFrom != ""'>
					   	   			AND PC.SPMT_YMD <![CDATA[>=]]> #{spmtYmdFrom}
					</if>
					<if test='spmtYmdTo != null and spmtYmdTo != ""'>
					   	   			AND PC.SPMT_YMD <![CDATA[<=]]> #{spmtYmdTo}
					</if>
					<if test='spmtYmd != null and spmtYmd != ""'>
					   	   			AND PC.SPMT_YMD <![CDATA[=]]> #{spmtYmd}
					</if>
					<if test='itemCd != null and itemCd != ""'>
									AND PD.ITEM_CD = #{itemCd}
					</if>
					<if test='cnptNm != null and cnptNm != ""'>
									AND (SELECT FN_GET_CNPT_NM(PC.CNPT_CD, PC.APC_CD) FROM DUAL) LIKE '%' ||  #{cnptNm} || '%'
					</if>
					<if test='cnptCd != null and cnptCd != ""'>
									AND PC.CNPT_CD = #{cnptCd}
					</if>
    				<![CDATA[
								)
					   GROUP BY APC_CD
					          , SPMTNO
						      , SPMT_YMD
						      , CNPT_CD
						      , CNPT_NM
					   ORDER BY SPMTNO DESC
    				]]>
    			</if>
    		</when>
    	</choose>
    </select>

    <!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.spmt.mapper.SpmtPrfmncMapper.insertSpmtPrfmncCom	-->
	<!-- DESC : 출하실적 공통 등록.	                         	             	 	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.08.21  	김호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <insert id="insertSpmtPrfmncCom" parameterType="com.at.apcss.am.spmt.vo.SpmtPrfmncVO">
    	<![CDATA[
    	INSERT INTO TB_SPMT_PRFMNC_COM /* com.at.apcss.am.spmt.mapper.SpmtPrfmncMapper.insertSpmtPrfmncCom */
    		(
    			APC_CD
    		  , SPMTNO
    		  ,	SPMT_YMD
    		  , CNPT_CD
    		  ,	TRSPRT_CO_CD
    		  ,	RMRK
    		  ,	VHCLNO
    		  ,	DLDTN
    		  ,	TRSPRT_CST
    		  ,	SPMT_SE_CD
    		  ,	SPMT_PRSN_DCLRNO
    		  ,	PLOR_CD
    		  , RTN_GDS_YN
    		  , SYS_FRST_INPT_DT
    		  , SYS_FRST_INPT_USER_ID
    		  , SYS_FRST_INPT_PRGRM_ID
    		  , SYS_LAST_CHG_DT
    		  , SYS_LAST_CHG_USER_ID
    		  , SYS_LAST_CHG_PRGRM_ID
    		)
   		VALUES
   			(
   				#{apcCd}
    		  , #{spmtno}
    		  ,	#{spmtYmd}
    		  , #{cnptCd}
    		  ,	#{trsprtCoCd}
    		  ,	#{rmrk}
    		  ,	#{vhclno}
    		  ,	#{dldtn}
    		  ,	#{trsprtCst}
    		  ,	#{spmtSeCd}
    		  ,	#{spmtPrsnDclrno}
    		  ,	#{plorCd}
    		  , #{rtnGdsYn}
    		  , SYSDATE
    		  , #{sysFrstInptUserId}
    		  , #{sysFrstInptPrgrmId}
    		  , SYSDATE
    		  , #{sysLastChgUserId}
    		  , #{sysLastChgPrgrmId}
   			)
    	]]>
    </insert>

    <!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.spmt.mapper.SpmtPrfmncMapper.insertSpmtPrfmncDtl	-->
	<!-- DESC : 출하실적 상세 등록.	                         	             	 	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.08.21  	김호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <insert id="insertSpmtPrfmncDtl" parameterType="com.at.apcss.am.spmt.vo.SpmtPrfmncVO">
    	<![CDATA[
    	INSERT INTO TB_SPMT_PRFMNC_DTL /* com.at.apcss.am.spmt.mapper.SpmtPrfmncMapper.insertSpmtPrfmncDtl */
    		(
    		    APC_CD
    		  ,	SPMTNO
    		  ,	PCKGNO
    		  ,	PCKG_SN
    		  ,	ITEM_CD
    		  ,	VRTY_CD
    		  ,	GDS_GRD
    		  ,	SPCFCT_CD
    		  ,	SPMT_QNTT
    		  ,	SPMT_WGHT
    		  ,	BRND_NM
    		  ,	GDS_CD
    		  ,	PRDCR_CD
    		  ,	SPMT_CMNDNO
    		  ,	SPMT_PCKG_UNIT_CD
    		  , OUTORDRNO
    		  , ORGN_SPMTNO
    		  , ORGN_PCKGNO
    		  , ORGN_PCKG_SN
    		  , SYS_FRST_INPT_DT
    		  , SYS_FRST_INPT_USER_ID
    		  , SYS_FRST_INPT_PRGRM_ID
    		  , SYS_LAST_CHG_DT
    		  , SYS_LAST_CHG_USER_ID
    		  , SYS_LAST_CHG_PRGRM_ID
    		)
   		VALUES
   			(
   				#{apcCd}
    		  ,	#{spmtno}
    		  ,	#{pckgno}
    		  ,	#{pckgSn}
    		  ,	#{itemCd}
    		  ,	#{vrtyCd}
    		  ,	#{gdsGrd}
    		  ,	#{spcfctCd}
    		  ,	#{spmtQntt}
    		  ,	#{spmtWght}
    		  ,	#{brndNm}
    		  ,	#{gdsCd}
    		  ,	#{prdcrCd}
    		  ,	#{spmtCmndno}
    		  ,	#{spmtPckgUnitCd}
    		  , #{outordrno}
    		  , #{orgnSpmtno}
    		  , #{orgnPckgno}
    		  , #{orgnPckgSn}
    		  , SYSDATE
    		  , #{sysFrstInptUserId}
    		  , #{sysFrstInptPrgrmId}
    		  , SYSDATE
    		  , #{sysLastChgUserId}
    		  , #{sysLastChgPrgrmId}
   			)
    	]]>
    </insert>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.spmt.mapper.SpmtPrfmncMapper.deleteSpmtPrfmncCom	-->
	<!-- DESC : 출하실적 공통 삭제.	                         	             	 	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.08.21  	김호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<update id="deleteSpmtPrfmncCom" parameterType="com.at.apcss.am.spmt.vo.SpmtCmndVO">
		<![CDATA[
		UPDATE TB_SPMT_PRFMNC_COM
		   SET SYS_LAST_CHG_DT			= SYSDATE
	    	 , SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
	    	 , SYS_LAST_CHG_PRGRM_ID 	= #{sysLastChgPrgrmId}
		   	 , DEL_YN 					= 'Y'
		 WHERE APC_CD 	= #{apcCd}
		   AND SPMTNO	= #{spmtno}
		]]>
	</update>
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.spmt.mapper.SpmtPrfmncMapper.deleteSpmtPrfmncCom	-->
	<!-- DESC : 출하실적 상세 삭제.	                         	             	 	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.08.21  	김호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<update id="deleteSpmtPrfmncDtl" parameterType="com.at.apcss.am.spmt.vo.SpmtCmndVO">
		<![CDATA[
		UPDATE TB_SPMT_PRFMNC_DTL
		   SET SYS_LAST_CHG_DT			= SYSDATE
	    	 , SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
	    	 , SYS_LAST_CHG_PRGRM_ID 	= #{sysLastChgPrgrmId}
		   	 , DEL_YN 					= 'Y'
		 WHERE APC_CD 	= #{apcCd}
		   AND SPMTNO	= #{spmtno}
		   AND PCKGNO   = #{pckgno}
		]]>
	</update>
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.spmt.mapper.SpmtPrfmncMapper.selectSpmtPrfmnDtlcList-->
	<!-- DESC : 출하실적 등록 내역.	                         	             	 	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.08.21  	김호        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<select id="selectSpmtPrfmncDtlList" parameterType="com.at.apcss.am.spmt.vo.SpmtPrfmncVO" resultType="com.at.apcss.am.spmt.vo.SpmtPrfmncVO">
		<![CDATA[
		SELECT pt0.*  /* com.at.apcss.am.spmt.mapper.SpmtPrfmncMapper.selectSpmtPrfmnDtlcList */
		     , (SELECT FN_GET_ITEM_NM(pt0.ITEM_CD, pt0.APC_CD) FROM DUAL) 						AS ITEM_NM
		     , (SELECT FN_GET_VRTY_NM(pt0.ITEM_CD, pt0.VRTY_CD, pt0.APC_CD) FROM DUAL) 			AS VRTY_NM
		     , (SELECT FN_GET_SPCFCT_NM(pt0.ITEM_CD, pt0.SPCFCT_CD, pt0.APC_CD) FROM DUAL) 		AS SPCFCT_NM
		     , (SELECT FN_GET_GRD_NM_GDS(pt0.APC_CD, pt0.ITEM_CD, pt0.GDS_GRD) FROM DUAL) 		AS GDS_GRD_NM
		     , (SELECT FN_GET_SPMT_PCKG_UNIT_NM(pt0.SPMT_PCKG_UNIT_CD, pt0.APC_CD) FROM DUAL)   AS SPMT_PCKG_UNIT_NM
		     , (SELECT FN_GET_CNPT_NM(pt0.CNPT_CD, pt0.APC_CD) FROM DUAL) 						AS CNPT_NM
		     , (SELECT FN_GET_TRSPRT_CO_NM(pt0.TRSPRT_CO_CD, pt0.APC_CD) FROM DUAL) 			AS TRSPRT_CO_NM
		 FROM (SELECT PD.APC_CD                 AS APC_CD
		            , PD.SPMTNO                 AS SPMTNO
		            , PC.SPMT_YMD               AS SPMT_YMD
		            , PD.ITEM_CD                AS ITEM_CD
		            , PD.VRTY_CD                AS VRTY_CD
		            , PD.SPCFCT_CD              AS SPCFCT_CD
		            , PD.GDS_GRD                AS GDS_GRD
		            , PD.SPMT_PCKG_UNIT_CD      AS SPMT_PCKG_UNIT_CD
		            , MAX(PC.CNPT_CD)           AS CNPT_CD
		            , MAX(PC.TRSPRT_CO_CD)      AS TRSPRT_CO_CD
		            , MAX(PC.RMRK)              AS RMRK
		            , MAX(PC.DEL_YN)            AS DEL_YN
		            , MAX(PC.VHCLNO)            AS VHCLNO
		            , MAX(PC.DLDTN)             AS DLDTN
		            , MAX(PC.TRSPRT_CST)        AS TRSPRT_CST
		            , MAX(PC.SPMT_SE_CD)        AS SPMT_SE_CD
		            , MAX(PC.SPMT_PRSN_DCLRNO) AS SPMT_PRSN_DCLRNO
		            , MAX(PC.PLOR_CD)           AS PLOR_CD
		            , MAX(PD.PCKGNO)            AS PCKGNO
		            , MAX(PD.PCKG_SN)           AS PCKG_SN
		            , MAX(PD.BRND_NM)           AS BRND_NM
		            , MAX(PD.GDS_CD)            AS GDS_CD
		            , MAX(PD.PRDCR_CD)          AS PRDCR_CD
		            , MAX(PD.SPMT_CMNDNO)       AS SPMT_CMNDNO
		            , SUM(PD.SPMT_QNTT) AS SPMT_QNTT
		            , SUM(PD.SPMT_WGHT) AS SPMT_WGHT
		         FROM TB_SPMT_PRFMNC_COM PC
		            , TB_SPMT_PRFMNC_DTL PD
		        WHERE PC.APC_CD = PD.APC_CD
		          AND PC.SPMTNO = PD.SPMTNO
		          AND PC.DEL_YN = 'N'
		          AND PD.DEL_YN = 'N'
		]]>
		<if test='apcCd != null and apcCd != ""'>
		   	   AND PD.APC_CD = #{apcCd}
		</if>
		<if test='spmtYmd != null and spmtYmd != ""'>
		   	   AND PC.SPMT_YMD = #{spmtYmd}
		</if>
		<if test='vrtyCd != null and vrtyCd != ""'>
		   	   AND PD.VRTY_CD = #{vrtyCd}
		</if>
		<if test='cnptCd != null and cnptCd != ""'>
		   	   AND PC.CNPT_CD = #{cnptCd}
		</if>
		<![CDATA[
		 		 GROUP BY PD.APC_CD, PD.SPMTNO, PC.SPMT_YMD , PD.ITEM_CD, PD.VRTY_CD, PD.SPCFCT_CD, PD.GDS_GRD, PD.SPMT_PCKG_UNIT_CD
		 	) pt0
		]]>
	</select>

</mapper>


