<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!-- ==========================================================================	-->
<!-- NAME : SortPrfmncMapper.xml                                   				-->
<!-- DESC : 선별실적 mapper                                            			-->
<!-- ==========================================================================	-->
<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
<!-- ===========  	============  	===========================================	-->
<!-- 2023.07.28  	신정철        		Initial Creation                        -->
<!-- ==========================================================================	-->

<mapper namespace="com.at.apcss.am.sort.mapper.SortPrfmncMapper">

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.sort.mapper.SortPrfmncMapper.selectSortPrfmnc		-->
	<!-- DESC : 선별실적 단건 조회.	                                       				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                        -->
	<!-- ==========================================================================	-->
    <select id="selectSortPrfmnc" parameterType="com.at.apcss.am.sort.vo.SortPrfmncVO" resultType="com.at.apcss.am.sort.vo.SortPrfmncVO">
    	<![CDATA[
	    	SELECT /* com.at.apcss.am.sort.mapper.SortPrfmncMapper.selectSortPrfmnc */
				  WC.APC_CD		AS APC_CD
				, WC.WGHNO		AS WGHNO
				, WC.WGH_YMD	AS WGH_YMD
				, WC.VHCLNO		AS VHCLNO
				, WC.WHOL_WGHT	AS WHOL_WGHT
				, WC.EMPT_VHCL_WGHT	AS EMPT_VHCL_WGHT
				, WC.RDCD_RT	AS RDCD_RT
				, WC.RDCD_WGHT	AS RDCD_WGHT
				, WC.WRHS_WGHT	AS WRHS_WGHT
				, WC.RMRK		AS RMRK
				, WC.DEL_YN		AS DEL_YN
			  FROM TB_WGH_PRFMNC_COM WC
			 WHERE WC.APC_CD = #{apcCd}
			   AND WC.WGHNO = #{wghno}
		]]>
    </select>



	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.sort.mapper.SortPrfmncMapper.selectSortPrfmncList	-->
	<!-- DESC : 선별실적 목록 조회.	                                       				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                        -->
	<!-- ==========================================================================	-->
    <select id="selectSortPrfmncList" parameterType="com.at.apcss.am.sort.vo.SortPrfmncVO" resultType="com.at.apcss.am.sort.vo.SortPrfmncVO">
    	<![CDATA[
    		SELECT /* com.at.apcss.am.sort.mapper.SortPrfmncMapper.selectSortPrfmncList */
		]]>
    	<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    			  ROWNUM AS ROW_SEQ
    			, COUNT(*) OVER() AS TOTAL_RECORD_COUNT
    			,
    	</if>
    	<!-- End 페이징 -->
    	<![CDATA[
				  pt0.*
    			, (SELECT FN_GET_PRDCR_NM(pt0.RPRS_PRDCR_CD, pt0.APC_CD) FROM DUAL) AS RPRS_PRDCR_NM
                , (SELECT FN_GET_ITEM_NM(pt0.ITEM_CD, pt0.APC_CD) FROM DUAL) AS ITEM_NM
                , (SELECT FN_GET_VRTY_NM(pt0.ITEM_CD, pt0.VRTY_CD, pt0.APC_CD) FROM DUAL) AS VRTY_NM
                , (SELECT FN_GET_SPCFCT_NM(pt0.ITEM_CD, pt0.SPCFCT_CD, pt0.APC_CD) FROM DUAL) AS SPCFCT_NM
    			, (SELECT FN_GET_GRD_NM_SORT(pt0.APC_CD, pt0.ITEM_CD, pt0.GRD_CD) FROM DUAL) AS GRD_NM
    			, (SELECT FN_GET_COM_CD_VL_NM('SORT_FCLT_CD', pt0.FCLT_CD, pt0.APC_CD) FROM DUAL) AS FCLT_NM
                , (SELECT FN_GET_COM_CD_VL_NM('WAREHOUSE_SE_CD', pt0.WAREHOUSE_SE_CD, pt0.APC_CD) FROM DUAL) AS WAREHOUSE_SE_NM
				, (SELECT FN_GET_COM_CD_VL_NM('GDS_SE_CD', pt0.GDS_SE_CD) FROM DUAL) AS GDS_SE_NM
				, (SELECT FN_GET_COM_CD_VL_NM('WRHS_SE_CD', pt0.WRHS_SE_CD) FROM DUAL) AS WRHS_SE_NM
    		  FROM (
    		SELECT
				  SP.APC_CD			AS APC_CD
				, SP.SORTNO			AS SORTNO
				, SP.SORT_SN		AS SORT_SN
				, SP.GRD_CD			AS GRD_CD
				, SP.INPT_YMD		AS INPT_YMD
				, SP.FCLT_CD		AS FCLT_CD
				, SP.SORT_QNTT		AS SORT_QNTT
				, SP.SORT_WGHT		AS SORT_WGHT
				, SP.RMRK			AS RMRK
				, SI.RPRS_PRDCR_CD	AS RPRS_PRDCR_CD
				, SI.ITEM_CD		AS ITEM_CD
				, SI.VRTY_CD		AS VRTY_CD
				, SI.SPCFCT_CD		AS SPCFCT_CD
				, SI.GDS_SE_CD		AS GDS_SE_CD
				, SI.WRHS_SE_CD		AS WRHS_SE_CD
				, SI.WAREHOUSE_SE_CD	AS WAREHOUSE_SE_CD
				, (SELECT SUM(X.QNTT) FROM TB_SORT_INPT_PRFMNC X WHERE X.APC_CD = SP.APC_CD AND X.SORTNO = SP.SORTNO AND X.DEL_YN = 'N') AS INPT_QNTT
				, (SELECT SUM(X.WGHT) FROM TB_SORT_INPT_PRFMNC X WHERE X.APC_CD = SP.APC_CD AND X.SORTNO = SP.SORTNO AND X.DEL_YN = 'N') AS INPT_WGHT
				, (SELECT SUM(X.WGHT) FROM TB_SORT_INPT_PRFMNC X WHERE X.APC_CD = SP.APC_CD AND X.SORTNO = SP.SORTNO AND X.DEL_YN = 'N') - SI.SORT_WGHT AS LS

			  FROM
				  TB_SORT_PRFMNC SP
				, TB_SORT_INVNTR SI
			 WHERE SP.APC_CD = SI.APC_CD
			   AND SP.SORTNO = SI.SORTNO
			   AND SP.SORT_SN = SI.SORT_SN
			   AND SP.DEL_YN = 'N'
			   AND SI.DEL_YN = 'N'
			   AND SP.APC_CD = #{apcCd}
		]]>
		<if test='inptYmdFrom != null and inptYmdFrom != ""'>
				AND SP.INPT_YMD <![CDATA[>=]]> #{inptYmdFrom}
    	</if>
		<if test='inptYmdTo != null and inptYmdTo != ""'>
				AND SP.INPT_YMD <![CDATA[<=]]> #{inptYmdTo}
    	</if>
    	<if test='itemCd != null and itemCd != ""'>
				AND SI.ITEM_CD = #{itemCd}
    	</if>
    	<if test='warehouseSeCd != null and warehouseSeCd != ""'>
				AND SI.WAREHOUSE_SE_CD = #{warehouseSeCd}
    	</if>
    	<if test='spcfctCd != null and spcfctCd != ""'>
				AND SI.SPCFCT_CD = #{spcfctCd}
    	</if>
    	<if test='rprsPrdcrCd != null and rprsPrdcrCd != ""'>
				AND SI.RPRS_PRDCR_CD = #{rprsPrdcrCd}
    	</if>
    	<if test='vrtyCd != null and vrtyCd != ""'>
				AND SI.VRTY_CD in (SELECT COL1  FROM TABLE(FN_SYS_SPLIT_STRING(#{vrtyCd})))
    	</if>
    	<if test='fcltCd != null and fcltCd != ""'>
				AND SP.FCLT_CD = #{fcltCd}
    	</if>

		<![CDATA[
			 ORDER BY APC_CD, INPT_YMD, SORTNO, SORT_SN
    		  ) pt0
		]]>

		<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
			OFFSET (#{currentPageNo} - 1) * #{recordCountPerPage} ROWS
			FETCH FIRST #{recordCountPerPage} ROWS ONLY
    	</if>
    	<!-- End 페이징 -->
    </select>


    <!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.sort.mapper.SortPrfmncMapper.selectSortDsctnTot  	-->
	<!-- DESC : 파프리카선별내역집계 목록 조회.                                       				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.02.15  	박승진        		Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectSortDsctnTot" parameterType="com.at.apcss.am.sort.vo.SortDsctnTotVO" resultType="com.at.apcss.am.sort.vo.SortDsctnTotVO">
    	<![CDATA[
    		SELECT  INPT_YMD
		      , 'A품'       AS GRD
		      , PRDCR_NM
		      , SUM(R_2XL)  AS red2Xl
		      , SUM(R_XL)   AS redXl
		      , SUM(R_L)    AS redL
		      , SUM(R_M)    AS redM
		      , SUM(R_S)    AS redS
		      , SUM(R_SS)   AS redSs
		      , SUM(Y_2XL)  AS ylw2Xl
		      , SUM(Y_XL)   AS ylwXl
		      , SUM(Y_L)    AS ylwL
		      , SUM(Y_M)    AS ylwM
		      , SUM(Y_S)    AS ylwS
		      , SUM(Y_SS)   AS ylwSs
		      , SUM(O_2XL)  AS org2Xl
		      , SUM(O_XL)   AS orgXl
		      , SUM(O_L)    AS orgL
		      , SUM(O_M)    AS orgM
		      , SUM(O_S)    AS orgS
		      , SUM(O_SS)   AS orgSs
		      , SUM(SORT_QNTT) AS tot
		      , SUM(R_TOT) redTot
		      , SUM(Y_TOT) ylwTot
		      , SUM(O_TOT) orgTot

		FROM  ( SELECT  B.ITEM_CD
		              , A.INPT_YMD
		              , B.RPRS_PRDCR_CD
		              , FN_GET_PRDCR_NM (B.RPRS_PRDCR_CD, A.APC_CD) AS PRDCR_NM
		              , CASE WHEN B.VRTY_CD = '0300' AND A.GRD_CD IN ('01') THEN A.SORT_QNTT END AS R_2XL
		              , CASE WHEN B.VRTY_CD = '0300' AND A.GRD_CD IN ('02') THEN A.SORT_QNTT END AS R_XL
		              , CASE WHEN B.VRTY_CD = '0300' AND A.GRD_CD IN ('03') THEN A.SORT_QNTT END AS R_L
		              , CASE WHEN B.VRTY_CD = '0300' AND A.GRD_CD IN ('04') THEN A.SORT_QNTT END AS R_M
		              , CASE WHEN B.VRTY_CD = '0300' AND A.GRD_CD IN ('05') THEN A.SORT_QNTT END AS R_S
		              , CASE WHEN B.VRTY_CD = '0300' AND A.GRD_CD IN ('06') THEN A.SORT_QNTT END AS R_SS
		              , CASE WHEN B.VRTY_CD = '0200' AND A.GRD_CD IN ('01') THEN A.SORT_QNTT END AS Y_2XL
		              , CASE WHEN B.VRTY_CD = '0200' AND A.GRD_CD IN ('02') THEN A.SORT_QNTT END AS Y_XL
		              , CASE WHEN B.VRTY_CD = '0200' AND A.GRD_CD IN ('03') THEN A.SORT_QNTT END AS Y_L
		              , CASE WHEN B.VRTY_CD = '0200' AND A.GRD_CD IN ('04') THEN A.SORT_QNTT END AS Y_M
		              , CASE WHEN B.VRTY_CD = '0200' AND A.GRD_CD IN ('05') THEN A.SORT_QNTT END AS Y_S
		              , CASE WHEN B.VRTY_CD = '0200' AND A.GRD_CD IN ('06') THEN A.SORT_QNTT END AS Y_SS
		              , CASE WHEN B.VRTY_CD = '0400' AND A.GRD_CD IN ('01') THEN A.SORT_QNTT END AS O_2XL
		              , CASE WHEN B.VRTY_CD = '0400' AND A.GRD_CD IN ('02') THEN A.SORT_QNTT END AS O_XL
		              , CASE WHEN B.VRTY_CD = '0400' AND A.GRD_CD IN ('03') THEN A.SORT_QNTT END AS O_L
		              , CASE WHEN B.VRTY_CD = '0400' AND A.GRD_CD IN ('04') THEN A.SORT_QNTT END AS O_M
		              , CASE WHEN B.VRTY_CD = '0400' AND A.GRD_CD IN ('05') THEN A.SORT_QNTT END AS O_S
		              , CASE WHEN B.VRTY_CD = '0400' AND A.GRD_CD IN ('06') THEN A.SORT_QNTT END AS O_SS
		              , CASE WHEN B.VRTY_CD = '0300' AND A.GRD_CD IN ('01','02','03','04','05','06') THEN A.SORT_QNTT END AS R_TOT
		              , CASE WHEN B.VRTY_CD = '0200' AND A.GRD_CD IN ('01','02','03','04','05','06') THEN A.SORT_QNTT END AS Y_TOT
		              , CASE WHEN B.VRTY_CD = '0400' AND A.GRD_CD IN ('01','02','03','04','05','06') THEN A.SORT_QNTT END AS O_TOT
		              , A.SORT_QNTT AS SORT_QNTT
		        FROM    USRAM.TB_SORT_PRFMNC A
		              , USRAM.TB_SORT_INVNTR B
		        WHERE   A.APC_CD = B.APC_CD
		        AND     A.SORTNO = B.SORTNO
		        AND     A.SORT_SN = B.SORT_SN
		        AND     A.GRD_CD IN ('01','02','03','04','05','06')
     		    AND     A.DEL_YN = 'N'
		        AND     B.DEL_YN = 'N'

		        ]]>
		        <if test='apcCd != null and apcCd != ""'>
			   	   AND A.APC_CD = #{apcCd}
				</if>
				<if test='itemCd != null and itemCd != ""'>
			   	   AND B.ITEM_CD = #{itemCd}
				</if>
        		<if test='inptYmdFrom != null and inptYmdFrom != ""'>
				   AND A.INPT_YMD <![CDATA[>=]]> #{inptYmdFrom}
				</if>
				<if test='inptYmdTo != null and inptYmdTo != ""'>
					   AND A.INPT_YMD <![CDATA[<=]]> #{inptYmdTo}
				</if>
		        <![CDATA[

		       )

		GROUP BY INPT_YMD, PRDCR_NM

		UNION ALL

		SELECT  INPT_YMD
		      , 'B품'       AS GRD
		      , PRDCR_NM
		      , SUM(R_2XL)  AS red2Xl
		      , SUM(R_XL)   AS redXl
		      , SUM(R_L)    AS redL
		      , SUM(R_M)    AS redM
		      , SUM(R_S)    AS redS
		      , SUM(R_SS)   AS redSs
		      , SUM(Y_2XL)  AS ylw2Xl
		      , SUM(Y_XL)   AS ylwXl
		      , SUM(Y_L)    AS ylwL
		      , SUM(Y_M)    AS ylwM
		      , SUM(Y_S)    AS ylwS
		      , SUM(Y_SS)   AS ylwSs
		      , SUM(O_2XL)  AS org2Xl
		      , SUM(O_XL)   AS orgXl
		      , SUM(O_L)    AS orgL
		      , SUM(O_M)    AS orgM
		      , SUM(O_S)    AS orgS
		      , SUM(O_SS)   AS orgSs
		      , SUM(SORT_QNTT) AS tot
		      , SUM(R_TOT) redTot
		      , SUM(Y_TOT) ylwTot
		      , SUM(O_TOT) orgTot

		FROM  ( SELECT  B.ITEM_CD
		              , A.INPT_YMD
		              , B.RPRS_PRDCR_CD
		              , FN_GET_PRDCR_NM (B.RPRS_PRDCR_CD, A.APC_CD) AS PRDCR_NM
		              , CASE WHEN B.VRTY_CD = '0300' AND A.GRD_CD IN ('07') THEN A.SORT_QNTT END AS R_2XL
		              , CASE WHEN B.VRTY_CD = '0300' AND A.GRD_CD IN ('08') THEN A.SORT_QNTT END AS R_XL
		              , CASE WHEN B.VRTY_CD = '0300' AND A.GRD_CD IN ('09') THEN A.SORT_QNTT END AS R_L
		              , CASE WHEN B.VRTY_CD = '0300' AND A.GRD_CD IN ('10') THEN A.SORT_QNTT END AS R_M
		              , CASE WHEN B.VRTY_CD = '0300' AND A.GRD_CD IN ('11') THEN A.SORT_QNTT END AS R_S
		              , CASE WHEN B.VRTY_CD = '0300' AND A.GRD_CD IN ('12') THEN A.SORT_QNTT END AS R_SS
		              , CASE WHEN B.VRTY_CD = '0200' AND A.GRD_CD IN ('07') THEN A.SORT_QNTT END AS Y_2XL
		              , CASE WHEN B.VRTY_CD = '0200' AND A.GRD_CD IN ('08') THEN A.SORT_QNTT END AS Y_XL
		              , CASE WHEN B.VRTY_CD = '0200' AND A.GRD_CD IN ('09') THEN A.SORT_QNTT END AS Y_L
		              , CASE WHEN B.VRTY_CD = '0200' AND A.GRD_CD IN ('10') THEN A.SORT_QNTT END AS Y_M
		              , CASE WHEN B.VRTY_CD = '0200' AND A.GRD_CD IN ('11') THEN A.SORT_QNTT END AS Y_S
		              , CASE WHEN B.VRTY_CD = '0200' AND A.GRD_CD IN ('12') THEN A.SORT_QNTT END AS Y_SS
		              , CASE WHEN B.VRTY_CD = '0400' AND A.GRD_CD IN ('07') THEN A.SORT_QNTT END AS O_2XL
		              , CASE WHEN B.VRTY_CD = '0400' AND A.GRD_CD IN ('08') THEN A.SORT_QNTT END AS O_XL
		              , CASE WHEN B.VRTY_CD = '0400' AND A.GRD_CD IN ('09') THEN A.SORT_QNTT END AS O_L
		              , CASE WHEN B.VRTY_CD = '0400' AND A.GRD_CD IN ('10') THEN A.SORT_QNTT END AS O_M
		              , CASE WHEN B.VRTY_CD = '0400' AND A.GRD_CD IN ('11') THEN A.SORT_QNTT END AS O_S
		              , CASE WHEN B.VRTY_CD = '0400' AND A.GRD_CD IN ('12') THEN A.SORT_QNTT END AS O_SS
		              , CASE WHEN B.VRTY_CD = '0300' AND A.GRD_CD IN ('07','08','09','10','11','12') THEN A.SORT_QNTT END AS R_TOT
		              , CASE WHEN B.VRTY_CD = '0200' AND A.GRD_CD IN ('07','08','09','10','11','12') THEN A.SORT_QNTT END AS Y_TOT
		              , CASE WHEN B.VRTY_CD = '0400' AND A.GRD_CD IN ('07','08','09','10','11','12') THEN A.SORT_QNTT END AS O_TOT
		              , A.SORT_QNTT AS SORT_QNTT
		        FROM    USRAM.TB_SORT_PRFMNC A
		              , USRAM.TB_SORT_INVNTR B

		        WHERE   A.APC_CD = B.APC_CD
		        AND     A.SORTNO = B.SORTNO
		        AND     A.SORT_SN = B.SORT_SN
		        AND     A.GRD_CD IN ('07','08','09','10','11','12')
		        AND     A.DEL_YN = 'N'
		        AND     B.DEL_YN = 'N'
		        ]]>
		        <if test='apcCd != null and apcCd != ""'>
			   	   AND A.APC_CD = #{apcCd}
				</if>
				<if test='itemCd != null and itemCd != ""'>
			   	   AND B.ITEM_CD = #{itemCd}
				</if>
        		<if test='inptYmdFrom != null and inptYmdFrom != ""'>
				   AND A.INPT_YMD <![CDATA[>=]]> #{inptYmdFrom}
				</if>
				<if test='inptYmdTo != null and inptYmdTo != ""'>
				   AND A.INPT_YMD <![CDATA[<=]]> #{inptYmdTo}
				</if>
		        <![CDATA[


		       )

		GROUP BY INPT_YMD, PRDCR_NM

		UNION ALL

		SELECT  INPT_YMD
		      , 'C품'       AS GRD
		      , PRDCR_NM
		      , SUM(R_2XL)  AS red2Xl
		      , SUM(R_XL)   AS redXl
		      , SUM(R_L)    AS redL
		      , SUM(R_M)    AS redM
		      , SUM(R_S)    AS redS
		      , SUM(R_SS)   AS redSs
		      , SUM(Y_2XL)  AS ylw2Xl
		      , SUM(Y_XL)   AS ylwXl
		      , SUM(Y_L)    AS ylwL
		      , SUM(Y_M)    AS ylwM
		      , SUM(Y_S)    AS ylwS
		      , SUM(Y_SS)   AS ylwSs
		      , SUM(O_2XL)  AS org2Xl
		      , SUM(O_XL)   AS orgXl
		      , SUM(O_L)    AS orgL
		      , SUM(O_M)    AS orgM
		      , SUM(O_S)    AS orgS
		      , SUM(O_SS)   AS orgSs
		      , SUM(SORT_QNTT) AS tot
		      , SUM(R_TOT) redTot
		      , SUM(Y_TOT) ylwTot
		      , SUM(O_TOT) orgTot

		FROM  ( SELECT  B.ITEM_CD
		              , A.INPT_YMD
		              , B.RPRS_PRDCR_CD
		              , FN_GET_PRDCR_NM (B.RPRS_PRDCR_CD, A.APC_CD) AS PRDCR_NM
		              , 0 AS R_2XL
		              , 0 AS R_XL
		              , CASE WHEN B.VRTY_CD = '0300' AND A.GRD_CD IN ('13') THEN A.SORT_QNTT END AS R_L
		              , CASE WHEN B.VRTY_CD = '0300' AND A.GRD_CD IN ('14') THEN A.SORT_QNTT END AS R_M
		              , CASE WHEN B.VRTY_CD = '0300' AND A.GRD_CD IN ('15') THEN A.SORT_QNTT END AS R_S
		              , 0 AS R_SS
		              , 0 AS Y_2XL
		              , 0 AS Y_XL
		              , CASE WHEN B.VRTY_CD = '0200' AND A.GRD_CD IN ('13') THEN A.SORT_QNTT END AS Y_L
		              , CASE WHEN B.VRTY_CD = '0200' AND A.GRD_CD IN ('14') THEN A.SORT_QNTT END AS Y_M
		              , CASE WHEN B.VRTY_CD = '0200' AND A.GRD_CD IN ('15') THEN A.SORT_QNTT END AS Y_S
		              , 0 AS Y_SS
		              , 0 AS O_2XL
		              , 0 AS O_XL
		              , CASE WHEN B.VRTY_CD = '0400' AND A.GRD_CD IN ('13') THEN A.SORT_QNTT END AS O_L
		              , CASE WHEN B.VRTY_CD = '0400' AND A.GRD_CD IN ('14') THEN A.SORT_QNTT END AS O_M
		              , CASE WHEN B.VRTY_CD = '0400' AND A.GRD_CD IN ('15') THEN A.SORT_QNTT END AS O_S
		              , 0 AS O_SS
		              , CASE WHEN B.VRTY_CD = '0300' AND A.GRD_CD IN ('13','14','15') THEN A.SORT_QNTT END AS R_TOT
		              , CASE WHEN B.VRTY_CD = '0200' AND A.GRD_CD IN ('13','14','15') THEN A.SORT_QNTT END AS Y_TOT
		              , CASE WHEN B.VRTY_CD = '0400' AND A.GRD_CD IN ('13','14','15') THEN A.SORT_QNTT END AS O_TOT
		              , A.SORT_QNTT AS SORT_QNTT
		        FROM    USRAM.TB_SORT_PRFMNC A
		              , USRAM.TB_SORT_INVNTR B

		        WHERE   A.APC_CD = B.APC_CD
		        AND     A.SORTNO = B.SORTNO
		        AND     A.SORT_SN = B.SORT_SN
		        AND     A.GRD_CD IN ('13','14','15')
		        AND     A.DEL_YN = 'N'
		        AND     B.DEL_YN = 'N'






		]]>

		<if test='apcCd != null and apcCd != ""'>
			   AND A.APC_CD = #{apcCd}
		</if>
		<if test='itemCd != null and itemCd != ""'>
			   AND B.ITEM_CD = #{itemCd}
		</if>
		<if test='inptYmdFrom != null and inptYmdFrom != ""'>
			   AND A.INPT_YMD <![CDATA[>=]]> #{inptYmdFrom}
		</if>
		<if test='inptYmdTo != null and inptYmdTo != ""'>
			   AND A.INPT_YMD <![CDATA[<=]]> #{inptYmdTo}
		</if>


		<![CDATA[
			)
		GROUP BY INPT_YMD, PRDCR_NM
		]]>


    </select>




	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.sort.mapper.SortPrfmncMapper.selectSortDsctnTot  	-->
	<!-- DESC : 선별내역집계(공통) 목록 조회.                                       		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.03.05  	박승진        		Initial Creation                        -->
	<!-- ==========================================================================	-->
    <select id="selectComSortDsctnTot" parameterType="com.at.apcss.am.sort.vo.ComSortDsctnTotVO" resultType="com.at.apcss.am.sort.vo.ComSortDsctnTotVO">
    <![CDATA[
	    SELECT
			MAX(ITEM_NM) AS ITEM_NM
			, MAX(VRTY_NM) AS VRTY_NM
			, INPT_YMD
			, PRDCR_NM
			, MAX(GRD_NM) AS GRD_NM
			, SUM(SORT_QNTT1) AS SORT_QNTT1
			, SUM(SORT_QNTT2) AS SORT_QNTT2
			, SUM(SORT_QNTT3) AS SORT_QNTT3
			, SUM(SORT_QNTT4) AS SORT_QNTT4
			, SUM(SORT_QNTT5) AS SORT_QNTT5
			, SUM(SORT_WGHT1) AS SORT_WGHT1
			, SUM(SORT_WGHT2) AS SORT_WGHT2
			, SUM(SORT_WGHT3) AS SORT_WGHT3
			, SUM(SORT_WGHT4) AS SORT_WGHT4
			, SUM(SORT_WGHT5) AS SORT_WGHT5
			, SUM(SORT_QNTT) AS SORT_QNTT
			, SUM(SORT_WGHT) AS SORT_QNTT

		  FROM
		(

		  SELECT
			  A.GRD_CD
			  , (SELECT FN_GET_GRD_NM_SORT(A.APC_CD, B.ITEM_CD, A.GRD_CD) FROM DUAL) AS GRD_NM
			  , B.ITEM_CD
	          , A.INPT_YMD
	          , CASE WHEN C.RNK = 1 THEN A.SORT_QNTT ELSE 0 END AS SORT_QNTT1
	   		  , CASE WHEN C.RNK = 2 THEN A.SORT_QNTT ELSE 0 END AS SORT_QNTT2
			  , CASE WHEN C.RNK = 3 THEN A.SORT_QNTT ELSE 0 END AS SORT_QNTT3
			  , CASE WHEN C.RNK = 4 THEN A.SORT_QNTT ELSE 0 END AS SORT_QNTT4
			  , CASE WHEN C.RNK = 5 THEN A.SORT_QNTT ELSE 0 END AS SORT_QNTT5
			  , CASE WHEN RNK = 1 THEN A.SORT_WGHT ELSE 0 END AS SORT_WGHT1
			  , CASE WHEN RNK = 2 THEN A.SORT_WGHT ELSE 0 END AS SORT_WGHT2
			  , CASE WHEN RNK = 3 THEN A.SORT_WGHT ELSE 0 END AS SORT_WGHT3
			  , CASE WHEN RNK = 4 THEN A.SORT_WGHT ELSE 0 END AS SORT_WGHT4
			  , CASE WHEN RNK = 5 THEN A.SORT_WGHT ELSE 0 END AS SORT_WGHT5
			  , A.SORT_QNTT
	          , A.SORT_WGHT
	          , B.RPRS_PRDCR_CD AS RPRS_PRDCR_CD
	          , FN_GET_PRDCR_NM (B.RPRS_PRDCR_CD, A.APC_CD) AS PRDCR_NM
	          , B.VRTY_CD AS VRTY_CD
	          , (SELECT FN_GET_ITEM_NM(B.ITEM_CD, B.APC_CD) FROM DUAL) AS ITEM_NM
	          , (SELECT FN_GET_VRTY_NM(B.ITEM_CD, B.VRTY_CD, B.APC_CD) FROM DUAL) AS VRTY_NM


			FROM USRAM.TB_SORT_PRFMNC A
				, USRAM.TB_SORT_INVNTR B
				, (
					SELECT ITEM_CD
					    , VRTY_CD
					 	, GRD_CD
					    , RANK() OVER(PARTITION BY VRTY_CD ORDER BY GRD_CD) AS RNK
					  FROM (SELECT ITEM_CD,VRTY_CD,GRD_CD FROM TB_SORT_INVNTR
 							WHERE 1=1
				]]>
				<if test='apcCd != null and apcCd != ""'>
			   		AND APC_CD = #{apcCd}
			  	</if>
				<if test='itemCd != null and itemCd != ""'>
				   AND ITEM_CD = #{itemCd}
				</if>
				<if test='vrtyCd != null and vrtyCd != ""'>
				   AND VRTY_CD = #{vrtyCd}
				</if>
 				<![CDATA[
							GROUP BY ITEM_CD,VRTY_CD,GRD_CD)
							) C

			WHERE   A.APC_CD = B.APC_CD
	    	  AND     A.SORTNO = B.SORTNO
	    	  AND     A.SORT_SN = B.SORT_SN
	    	  AND     A.GRD_CD = C.GRD_CD
	    	  AND     A.DEL_YN = 'N'
	    	  AND     B.DEL_YN = 'N'
    	]]>
   	    <if test='apcCd != null and apcCd != ""'>
			   AND A.APC_CD = #{apcCd}
		</if>
		<if test='itemCd != null and itemCd != ""'>
			   AND B.ITEM_CD = #{itemCd}
	    </if>
    	<if test='vrtyCd != null and vrtyCd != ""'>
			   AND B.VRTY_CD = #{vrtyCd}
		</if>
		<if test='inptYmdFrom != null and inptYmdFrom != ""'>
			   AND A.INPT_YMD <![CDATA[>=]]> #{inptYmdFrom}
		</if>
		<if test='inptYmdTo != null and inptYmdTo != ""'>
			   AND A.INPT_YMD <![CDATA[<=]]> #{inptYmdTo}
		</if>
		<if test='rprsPrdcrCd != null and rprsPrdcrCd != ""'>
			   AND B.RPRS_PRDCR_CD = #{rprsPrdcrCd}
		</if>
	<![CDATA[

	    ) X
	GROUP BY INPT_YMD, PRDCR_NM
	]]>
	 </select>




	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.sort.mapper.SortPrfmncMapper.selectSortCnclList		-->
	<!-- DESC : 선별실적 목록 (취소대상) 조회.	                                       		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                        -->
	<!-- ==========================================================================	-->
    <select id="selectSortCnclList" parameterType="com.at.apcss.am.sort.vo.SortPrfmncVO" resultType="com.at.apcss.am.sort.vo.SortPrfmncVO">
    	<![CDATA[
    		SELECT /* com.at.apcss.am.sort.mapper.SortPrfmncMapper.selectSortCnclList */
				  SP.APC_CD			AS APC_CD
				, SP.SORTNO			AS SORTNO
				, SP.SORT_SN		AS SORT_SN
				, SP.GRD_CD			AS GRD_CD
				, SP.INPT_YMD		AS INPT_YMD
				, SP.FCLT_CD		AS FCLT_CD
				, SP.SORT_QNTT		AS SORT_QNTT
				, SP.SORT_WGHT		AS SORT_WGHT
				, SP.RMRK			AS RMRK
				, SI.RPRS_PRDCR_CD	AS RPRS_PRDCR_CD
				, SI.ITEM_CD		AS ITEM_CD
				, SI.VRTY_CD		AS VRTY_CD
				, SI.SPCFCT_CD		AS SPCFCT_CD
				, SI.GDS_SE_CD		AS GDS_SE_CD
				, SI.WRHS_SE_CD		AS WRHS_SE_CD
				, SI.WAREHOUSE_SE_CD	AS WAREHOUSE_SE_CD
				, SI.INVNTR_QNTT	AS INVNTR_QNTT
				, SI.INVNTR_WGHT	AS INVNTR_WGHT

			  FROM
				  TB_SORT_PRFMNC SP
				, TB_SORT_INVNTR SI
			 WHERE SP.APC_CD = SI.APC_CD
			   AND SP.SORTNO = SI.SORTNO
			   AND SP.SORT_SN = SI.SORT_SN
			   AND SP.DEL_YN = 'N'
			   AND SI.DEL_YN = 'N'
			   AND SP.APC_CD = #{apcCd}
			   AND SP.SORTNO = #{sortno}
			 ORDER BY APC_CD, INPT_YMD, SORTNO, SORT_SN
		]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.sort.mapper.SortPrfmncMapper.selectSortInptPrfmncList	-->
	<!-- DESC : 선별투입실적 목록 조회.	                                       			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                        -->
	<!-- ==========================================================================	-->
    <select id="selectSortInptPrfmncList" parameterType="com.at.apcss.am.sort.vo.SortPrfmncVO" resultType="com.at.apcss.am.sort.vo.SortPrfmncVO">
    	<![CDATA[
    		SELECT /* com.at.apcss.am.sort.mapper.SortPrfmncMapper.selectSortInptPrfmncList */
		]]>
    	<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    			  ROWNUM AS ROW_SEQ
    			, COUNT(*) OVER() AS TOTAL_RECORD_COUNT
    			,
    	</if>
    	<!-- End 페이징 -->
    	<![CDATA[
				  pt0.*
    			, (SELECT FN_GET_COM_CD_VL_NM('WAREHOUSE_SE_CD', pt0.WAREHOUSE_SE_CD, pt0.APC_CD) FROM DUAL) AS WAREHOUSE_SE_NM
    			, (SELECT FN_GET_PRDCR_NM(pt0.PRDCR_CD, pt0.APC_CD) FROM DUAL) AS PRDCR_NM
    		  FROM (
    		SELECT
				  SI.APC_CD			AS APC_CD
				, SI.WRHSNO			AS WRHSNO
				, SI.INPT_YMD		AS INPT_YMD
				, SI.SORTNO			AS SORTNO
				, SI.QNTT			AS QNTT
				, SI.WGHT			AS WGHT
				, RI.PLTNO			AS PLTNO
				, RI.WRHS_YMD		AS WRHS_YMD
				, RI.PRDCR_CD		AS PRDCR_CD
				, RI.ITEM_CD		AS ITEM_CD
				, RI.VRTY_CD		AS VRTY_CD
				, RI.GDS_SE_CD		AS GDS_SE_CD
				, RI.WRHS_SE_CD		AS WRHS_SE_CD
				, RI.TRSPRT_SE_CD	AS TRSPRT_SE_CD
				, RI.WAREHOUSE_SE_CD	AS WAREHOUSE_SE_CD

			  FROM
				  TB_SORT_INPT_PRFMNC SI
				, TB_RAW_MTR_INVNTR RI
			 WHERE SI.APC_CD = RI.APC_CD
			   AND SI.WRHSNO = RI.WRHSNO
			   AND SI.DEL_YN = 'N'
			   AND RI.DEL_YN = 'N'
			   AND SI.APC_CD = #{apcCd}
		]]>

    	<if test='sortno != null and sortno != ""'>
				AND SI.SORTNO = #{sortno}
    	</if>

		<![CDATA[
			 ORDER BY APC_CD, INPT_YMD, SORTNO, WRHSNO
    		  ) pt0
		]]>

		<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
			OFFSET (#{currentPageNo} - 1) * #{recordCountPerPage} ROWS
			FETCH FIRST #{recordCountPerPage} ROWS ONLY
    	</if>
    	<!-- End 페이징 -->
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.sort.mapper.SortPrfmncMapper.selectRawMtrInvntrList	-->
	<!-- DESC : 선별대상 원물재고 목록 조회.	                                       		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                        -->
	<!-- ==========================================================================	-->
    <select id="selectRawMtrInvntrList" parameterType="com.at.apcss.am.sort.vo.SortPrfmncVO" resultType="com.at.apcss.am.sort.vo.SortPrfmncVO">
    	<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    		SELECT
    			  ROWNUM AS ROW_SEQ
    			, COUNT(*) OVER() AS TOTAL_RECORD_COUNT
    			, pt0.*
    			, (SELECT FN_GET_PRDCR_NM(pt0.PRDCR_CD, pt0.APC_CD) FROM DUAL) AS PRDCR_NM
                , (SELECT FN_GET_ITEM_NM(pt0.ITEM_CD, pt0.APC_CD) FROM DUAL) AS ITEM_NM
                , (SELECT FN_GET_VRTY_NM(pt0.ITEM_CD, pt0.VRTY_CD, pt0.APC_CD) FROM DUAL) AS VRTY_NM
                , (SELECT FN_GET_COM_CD_VL_NM('WAREHOUSE_SE_CD', pt0.WAREHOUSE_SE_CD, pt0.APC_CD) FROM DUAL) AS WAREHOUSE_SE_NM
    		  FROM (
    	</if>
    	<if test='pagingYn == null or pagingYn.equals("N")'>
    		SELECT
    			  pt0.*
    			, (SELECT FN_GET_PRDCR_NM(pt0.PRDCR_CD, pt0.APC_CD) FROM DUAL) AS PRDCR_NM
                , (SELECT FN_GET_ITEM_NM(pt0.ITEM_CD, pt0.APC_CD) FROM DUAL) AS ITEM_NM
                , (SELECT FN_GET_VRTY_NM(pt0.ITEM_CD, pt0.VRTY_CD, pt0.APC_CD) FROM DUAL) AS VRTY_NM
                , (SELECT FN_GET_COM_CD_VL_NM('WAREHOUSE_SE_CD', pt0.WAREHOUSE_SE_CD, pt0.APC_CD) FROM DUAL) AS WAREHOUSE_SE_NM
    		  FROM (
    	</if>
    	<!-- End 페이징 -->
    	<![CDATA[
    		SELECT /* com.at.apcss.am.sort.mapper.SortPrfmncMapper.selectRawMtrInvntrList */
				  RI.APC_CD				AS APC_CD
				, RI.PLTNO				AS PLTNO
				, RI.WRHS_YMD			AS WRHS_YMD
				, RI.PRDCR_CD			AS PRDCR_CD
				, RI.WAREHOUSE_SE_CD	AS WAREHOUSE_SE_CD
				, RI.ITEM_CD			AS ITEM_CD
				, RI.VRTY_CD			AS VRTY_CD
				, SC.SORT_CMNDNO		AS SORT_CMNDNO
				, SUM(RI.INVNTR_QNTT)	AS INVNTR_QNTT
				, SUM(RI.INVNTR_WGHT) 	AS INVNTR_WGHT
				, SUM(RI.INPT_QNTT) 	AS INPT_QNTT
				, SUM(RI.INPT_WGHT) 	AS INPT_WGHT
				, SUM(SC.CMND_QNTT) 	AS CMND_QNTT
				, SUM(SC.CMND_WGHT) 	AS CMND_WGHT

			  FROM TB_RAW_MTR_INVNTR RI

			  LEFT JOIN TB_SORT_CMND SC
			    ON SC.APC_CD = RI.APC_CD
			   AND SC.WAREHOUSE_SE_CD = RI.WAREHOUSE_SE_CD
			   AND SC.PLTNO = RI.PLTNO
			   AND SC.PRDCR_CD = RI.PRDCR_CD
			   AND SC.ITEM_CD = RI.ITEM_CD
			   AND SC.VRTY_CD = RI.VRTY_CD
			   AND SC.DEL_YN = 'N'

			 WHERE RI.APC_CD = #{apcCd}
			   AND RI.DEL_YN = 'N'
		]]>

		<if test='prdcrCd != null and prdcrCd != ""'>
			   AND RI.PRDCR_CD = #{prdcrCd}
		</if>
		<if test='itemCd != null and itemCd != ""'>
			   AND RI.ITEM_CD = #{itemCd}
		</if>
		<if test='vrtyCd != null and vrtyCd != ""'>
			   AND RI.VRTY_CD = #{vrtyCd}
		</if>
		<if test='wrhsYmd != null and wrhsYmd != ""'>
			   AND RI.WRHS_YMD = #{wrhsYmd}
		</if>
		<if test='wrhsYmdFrom != null and wrhsYmdFrom != ""'>
			   AND RI.WRHS_YMD <![CDATA[>=]]> #{wrhsYmdFrom}
		</if>
		<if test='wrhsYmdTo != null and wrhsYmdTo != ""'>
			   AND RI.WRHS_YMD <![CDATA[<=]]> #{wrhsYmdTo}
		</if>
		<![CDATA[
		 	 GROUP BY
			 	  RI.APC_CD
				, RI.PLTNO
				, RI.WRHS_YMD
				, RI.PRDCR_CD
				, RI.WAREHOUSE_SE_CD
				, RI.ITEM_CD
				, RI.VRTY_CD
				, SC.SORT_CMNDNO
			 ORDER BY APC_CD, WRHS_YMD, PLTNO, SORT_CMNDNO
		]]>

		<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    		  ) pt0
			OFFSET (#{currentPageNo} - 1) * #{recordCountPerPage} ROWS
			FETCH FIRST #{recordCountPerPage} ROWS ONLY
    	</if>
    	<if test='pagingYn == null or pagingYn.equals("N")'>
    		  ) pt0
    	</if>
    	<!-- End 페이징 -->
    </select>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.sort.mapper.SortPrfmncMapper.insertSortPrfmnc		-->
	<!-- DESC : 선별실적 등록.	                                       					-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                        -->
	<!-- ==========================================================================	-->
    <insert id="insertSortPrfmnc" parameterType="com.at.apcss.am.sort.vo.SortPrfmncVO">
    	<![CDATA[
	    	INSERT /* com.at.apcss.am.sort.mapper.SortPrfmncMapper.insertSortPrfmnc */
	    		INTO TB_SORT_PRFMNC
				(
					  APC_CD
					, SORTNO
					, SORT_SN
					, GRD_CD
					, INPT_YMD
					, FCLT_CD
					, SORT_QNTT
					, SORT_WGHT
					, RMRK
					, SORT_CMNDNO
		    		, SYS_FRST_INPT_DT
		    		, SYS_FRST_INPT_USER_ID
		    		, SYS_FRST_INPT_PRGRM_ID
		    		, SYS_LAST_CHG_DT
		    		, SYS_LAST_CHG_USER_ID
		    		, SYS_LAST_CHG_PRGRM_ID
	    		)
	   		VALUES
	   			(
					  #{apcCd}
					, #{sortno}
					, #{sortSn}
					, #{grdCd}
					, #{inptYmd}
					, #{fcltCd}
					, #{sortQntt}
					, #{sortWght}
					, #{rmrk}
					, #{sortCmndno}
		    		, SYSDATE
		    		, #{sysFrstInptUserId}
		    		, #{sysFrstInptPrgrmId}
		    		, SYSDATE
		    		, #{sysLastChgUserId}
		    		, #{sysLastChgPrgrmId}
	   			)
    	]]>
    </insert>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.sort.mapper.SortPrfmncMapper.updateSortPrfmnc		-->
	<!-- DESC : 선별실적 변경.	                                       					-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                        -->
	<!-- ==========================================================================	-->
    <update id="updateSortPrfmnc" parameterType="com.at.apcss.am.sort.vo.SortPrfmncVO">
		<![CDATA[
			UPDATE /* com.at.apcss.am.sort.mapper.SortPrfmncMapper.updateSortPrfmnc */
				TB_SORT_PRFMNC
			   SET
			   	  SYS_LAST_CHG_DT 			= SYSDATE
	    		, SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
	    		, SYS_LAST_CHG_PRGRM_ID 	= #{sysLastChgPrgrmId}
				, GRD_CD 		= #{grdCd}
				, INPT_YMD 		= #{inptYmd}
				, FCLT_CD		= #{fcltCd}
				, SORT_QNTT 	= #{sortQntt}
				, SORT_WGHT 	= #{sortWght}
				, RMRK 			= #{rmrk}
				, SORT_CMNDNO 	= #{sortCmndno}
		]]>
			<if test='delYn != null and delYn != ""'>
				, DEL_YN			= #{delYn}
			</if>
		<![CDATA[
			 WHERE APC_CD = #{apcCd}
			   AND SORTNO = #{sortno}
			   AND SORT_SN = #{sortSn}
		]]>
	</update>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.sort.mapper.SortPrfmncMapper.deleteSortPrfmnc		-->
	<!-- DESC : 선별실적 삭제.	                                       					-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                        -->
	<!-- ==========================================================================	-->
    <delete id="deleteSortPrfmnc" parameterType="com.at.apcss.am.sort.vo.SortPrfmncVO">
		<![CDATA[
			DELETE /* com.at.apcss.am.sort.mapper.SortPrfmncMapper.deleteSortPrfmnc */
			  FROM TB_SORT_PRFMNC
			 WHERE APC_CD = #{apcCd}
			   AND SORTNO = #{sortno}
		]]>
	</delete>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.sort.mapper.SortPrfmncMapper.updateSortPrfmncForDelY-->
	<!-- DESC : 선별실적 삭제 : SET DEL_YN 'Y'											-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                        -->
	<!-- ==========================================================================	-->
    <update id="updateSortPrfmncForDelY" parameterType="com.at.apcss.am.sort.vo.SortPrfmncVO">
		<![CDATA[
			UPDATE /* com.at.apcss.am.sort.mapper.SortPrfmncMapper.updateSortPrfmncForDelY */
				TB_SORT_PRFMNC
			   SET
			   	  SYS_LAST_CHG_DT 			= SYSDATE
	    		, SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
	    		, SYS_LAST_CHG_PRGRM_ID 	= #{sysLastChgPrgrmId}
				, DEL_YN	= 'Y'
			 WHERE APC_CD = #{apcCd}
			   AND SORTNO = #{sortno}
			   AND SORT_SN = #{sortSn}
		]]>
	</update>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.sort.mapper.SortPrfmncMapper.updateInptSortno		-->
	<!-- DESC : 선별투입 선별번호 등록.	                                       			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                        -->
	<!-- ==========================================================================	-->
    <update id="updateInptSortno" parameterType="com.at.apcss.am.sort.vo.SortPrfmncVO">
		<![CDATA[
			UPDATE /* com.at.apcss.am.sort.mapper.SortPrfmncMapper.updateInptSortno */
				TB_SORT_INPT_PRFMNC
			   SET
			   	  SYS_LAST_CHG_DT 			= SYSDATE
	    		, SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
	    		, SYS_LAST_CHG_PRGRM_ID 	= #{sysLastChgPrgrmId}
				, SORTNO 		= #{sortno}

			 WHERE APC_CD = #{apcCd}
			   AND WRHSNO = #{wrhsno}
			   AND SORTNO IS NULL
		]]>
	</update>

</mapper>