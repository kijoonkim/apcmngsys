<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!-- ==========================================================================	-->
<!-- NAME : WghPrfmncMapper.xml                                   				-->
<!-- DESC : 계량실적 mapper                                            				-->
<!-- ==========================================================================	-->
<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
<!-- ===========  	============  	===========================================	-->
<!-- 2023.07.28  	신정철        		Initial Creation                            -->
<!-- ==========================================================================	-->

<mapper namespace="com.at.apcss.am.wgh.mapper.WghPrfmncMapper">


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghPrfmncList		-->
	<!-- DESC : 계량실적 공통 목록 조회.	                                       			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectWghPrfmncList" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO" resultType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
    	<![CDATA[
    		SELECT /* com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghPrfmncList */
		]]>
    	<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    			  ROWNUM AS ROW_SEQ
    			, COUNT(*) OVER() AS TOTAL_RECORD_COUNT
    			,
    	</if>
    	<!-- End 페이징 -->
    	<![CDATA[
				  pt0.*
				, pt0.WGHNO || '-' || pt0.WGH_SN	AS WGHNO_INDCT
                , (SELECT FN_GET_APC_NM(pt0.APC_CD) FROM DUAL) AS APC_NM
    			, (SELECT FN_GET_PRDCR_NM(pt0.PRDCR_CD, pt0.APC_CD) FROM DUAL) AS PRDCR_NM
    			, (SELECT X.PRDCR_IDENTNO FROM TB_PRDCR_INFO AS X WHERE X.APC_CD = pt0.APC_CD AND X.PRDCR_CD = pt0.PRDCR_CD AND X.DEL_YN = 'N') AS PRDCR_IDENTNO
                , (SELECT FN_GET_ITEM_NM(pt0.ITEM_CD, pt0.APC_CD) FROM DUAL) AS ITEM_NM
                , (SELECT FN_GET_VRTY_NM(pt0.ITEM_CD, pt0.VRTY_CD, pt0.APC_CD) FROM DUAL) AS VRTY_NM
    			, (SELECT FN_GET_GRD_NM_RAWMTR(pt0.APC_CD, pt0.ITEM_CD, pt0.GRD_CD) FROM DUAL) AS GRD_NM
                , (SELECT FN_GET_COM_CD_VL_NM('WAREHOUSE_SE_CD', pt0.WAREHOUSE_SE_CD, pt0.APC_CD) FROM DUAL) AS WAREHOUSE_SE_NM
				, (SELECT FN_GET_COM_CD_VL_NM('GDS_SE_CD', pt0.GDS_SE_CD) FROM DUAL) AS GDS_SE_NM
				, (SELECT FN_GET_COM_CD_VL_NM('WRHS_SE_CD', pt0.WRHS_SE_CD) FROM DUAL) AS WRHS_SE_NM
				, (SELECT FN_GET_COM_CD_VL_NM('TRSPRT_SE_CD', pt0.TRSPRT_SE_CD) FROM DUAL) AS TRSPRT_SE_NM
				, pt0.WHOL_WGHT - pt0.EMPT_VHCL_WGHT - pt0.RDCD_WGHT AS ACTL_WGHT
				, (SELECT FN_GET_STD_GRD_RAWMTR(pt0.APC_CD, pt0.WRHSNO) FROM DUAL) AS STD_GRD
                , (SELECT FN_GET_STD_GRD_RAWMTR(pt0.APC_CD, pt0.WRHSNO, 'CD') FROM DUAL) AS STD_GRD_CD
                , (SELECT X.DRVR_NM FROM TB_WRHS_VHCL_INFO X WHERE X.APC_CD = pt0.APC_CD AND X.VHCLNO = pt0.VHCLNO) AS DRVR_NM
    		  FROM (
			SELECT
				  WC.APC_CD		    AS APC_CD
				, WC.WGHNO		    AS WGHNO
				, WD.WGH_SN			AS WGH_SN
				, WD.WRHSNO		    AS WRHSNO
				, WC.WGH_YMD        AS WGH_YMD
				, WC.VHCLNO         AS VHCLNO
				, WC.PRDCR_CD	    AS PRDCR_CD
				, WC.WHOL_WGHT      AS WHOL_WGHT
				, WC.EMPT_VHCL_WGHT AS EMPT_VHCL_WGHT
				, WC.RDCD_RT        AS RDCD_RT
				, WC.RDCD_WGHT      AS RDCD_WGHT
				, WC.WRHS_WGHT      AS WRHS_WGHT
				, WC.RMRK           AS RMRK
                , WD.GRD_CD         AS GRD_CD
                , WD.PLT_KND		AS PLT_KND
				, WD.PLT_WGHT       AS PLT_WGHT
				, WD.BX_KND			AS BX_KND
                , WD.BX_QNTT        AS BX_QNTT
				, WD.BX_WGHT        AS BX_WGHT
				, WP.WRHS_WGHT		AS INVNTR_WGHT
				, INV.WAREHOUSE_SE_CD   AS WAREHOUSE_SE_CD
				, INV.ITEM_CD       AS ITEM_CD
				, INV.VRTY_CD       AS VRTY_CD
				, INV.GDS_SE_CD     AS GDS_SE_CD
				, INV.WRHS_SE_CD    AS WRHS_SE_CD
				, INV.TRSPRT_SE_CD  AS TRSPRT_SE_CD
				, INV.PRDCTN_YR		AS PRDCTN_YR
				, WC.FCLT_CD		AS FCLT_CD
				, WC.WRHS_SPMT_TYPE AS WRHS_SPMT_TYPE
			  FROM
			  	  TB_WGH_PRFMNC_COM WC
			  	, TB_WGH_PRFMNC_DTL WD
				, TB_RAW_MTR_WRHS_PRFMNC WP
				, TB_RAW_MTR_INVNTR INV
			 WHERE WC.APC_CD = WD.APC_CD
			   AND WC.WGHNO = WD.WGHNO
			   AND WC.APC_CD = WP.APC_CD
			   AND WC.WGHNO = WP.WGHNO
			   AND WD.WRHSNO = WP.WRHSNO
			   AND WP.APC_CD = INV.APC_CD
			   AND WP.WRHSNO = INV.WRHSNO
			   AND WC.DEL_YN = 'N'
			   AND WD.DEL_YN = 'N'
			   AND WP.DEL_YN = 'N'
			   AND INV.DEL_YN = 'N'
		]]>
		<if test='apcCd != null and apcCd != ""'>
			   AND WC.APC_CD = #{apcCd}
		</if>
		<if test='wghno != null and wghno != ""'>
			   AND WC.WGHNO = #{wghno}
		</if>
		<if test='wghYmd != null and wghYmd != ""'>
			   AND WC.WGH_YMD = #{wghYmd}
		</if>
		<if test='wghYmdFrom != null and wghYmdFrom != ""'>
			   AND WC.WGH_YMD <![CDATA[>=]]> #{wghYmdFrom}
		</if>
		<if test='wghYmdTo != null and wghYmdTo != ""'>
			   AND WC.WGH_YMD <![CDATA[<=]]> #{wghYmdTo}
		</if>
		<if test='prdcrCd != null and prdcrCd != ""'>
			   AND WC.PRDCR_CD = #{prdcrCd}
		</if>
		<if test='itemCd != null and itemCd != ""'>
			   AND INV.ITEM_CD = #{itemCd}
		</if>
		<if test='vrtyCd != null and vrtyCd != ""'>
			   AND INV.VRTY_CD = #{vrtyCd}
		</if>
		<if test='wrhsSeCd != null and wrhsSeCd != ""'>
			   AND INV.WRHS_SE_CD = #{wrhsSeCd}
		</if>
		<if test='gdsSeCd != null and gdsSeCd != ""'>
			   AND INV.GDS_SE_CD = #{gdsSeCd}
		</if>
		<if test='trsprtSeCd != null and trsprtSeCd != ""'>
			   AND INV.TRSPRT_SE_CD = #{trsprtSeCd}
		</if>
		<if test='vhclno != null and vhclno != ""'>
			   AND WC.VHCLNO = #{vhclno}
		</if>
		<![CDATA[
		 	 ORDER BY APC_CD, WGH_YMD, WGHNO, WGH_SN
    		  ) pt0
		]]>
		<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
			OFFSET (#{currentPageNo} - 1) * #{recordCountPerPage} ROWS
			FETCH FIRST #{recordCountPerPage} ROWS ONLY
    	</if>
    	<!-- End 페이징 -->
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghPrfmncCom		-->
	<!-- DESC : 계량실적 공통 단건 조회.	                                       			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectWghPrfmncCom" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO" resultType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
    	<![CDATA[
	    	SELECT /* com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghPrfmncCom */
				  WC.APC_CD		AS APC_CD
				, WC.WGHNO		AS WGHNO
				, WC.WGH_YMD	AS WGH_YMD
				, WC.VHCLNO		AS VHCLNO
				, WC.WHOL_WGHT	AS WHOL_WGHT
				, WC.EMPT_VHCL_WGHT	AS EMPT_VHCL_WGHT
				, WC.RDCD_RT	AS RDCD_RT
				, WC.RDCD_WGHT	AS RDCD_WGHT
				, WC.WRHS_WGHT	AS WRHS_WGHT
				, WC.RMRK		AS RMRK
				, WC.DEL_YN		AS DEL_YN
			  FROM TB_WGH_PRFMNC_COM WC

			 WHERE WC.APC_CD = #{apcCd}
			   AND WC.WGHNO = #{wghno}
		]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghPrfmncComList		-->
	<!-- DESC : 계량실적 공통 목록 조회.	                                       			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectWghPrfmncComList" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO" resultType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
    	<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    		SELECT
    			  ROWNUM AS ROW_SEQ
    			, COUNT(*) OVER() AS TOTAL_RECORD_COUNT
    			, pt0.*
    		  FROM (
    	</if>
    	<!-- End 페이징 -->
    	<![CDATA[
	    	SELECT /* com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghPrfmncComList */
				  WC.APC_CD		AS APC_CD
				, WC.WGHNO		AS WGHNO
				, WC.WGH_YMD	AS WGH_YMD
				, WC.VHCLNO		AS VHCLNO
				, WC.WHOL_WGHT	AS WHOL_WGHT
				, WC.EMPT_VHCL_WGHT	AS EMPT_VHCL_WGHT
				, WC.RDCD_RT	AS RDCD_RT
				, WC.RDCD_WGHT	AS RDCD_WGHT
				, WC.WRHS_WGHT	AS WRHS_WGHT
				, WC.RMRK		AS RMRK
				, WC.DEL_YN		AS DEL_YN
				, (SELECT X.APC_NM FROM TB_APC_INFO X WHERE X.APC_CD = WC.APC_CD) AS APC_NM
			  FROM TB_WGH_PRFMNC_COM WC
			 WHERE 1=1
		]]>

		<if test='apcCd != null and apcCd != ""'>
			   AND WC.APC_CD = #{apcCd}
		</if>
		<if test='wghno != null and wghno != ""'>
			   AND WC.WGHNO = #{wghno}
		</if>
		<if test='delYn != null and delYn != ""'>
			   AND WC.DEL_YN = #{delYn}
		</if>
		<if test='wghYmd != null and wghYmd != ""'>
			   AND WC.WGH_YMD = #{wghYmd}
		</if>
		<if test='wghYmdFrom != null and wghYmdFrom != ""'>
			   AND WC.WGH_YMD <![CDATA[>=]]> #{wghYmdFrom}
		</if>
		<if test='wghYmdTo != null and wghYmdTo != ""'>
			   AND WC.WGH_YMD <![CDATA[<=]]> #{wghYmdTo}
		</if>
		<![CDATA[
			 ORDER BY APC_CD, WGH_YMD, WGHNO
		]]>

		<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    		  ) pt0
			OFFSET (#{currentPageNo} - 1) * #{recordCountPerPage} ROWS
			FETCH FIRST #{recordCountPerPage} ROWS ONLY
    	</if>
    	<!-- End 페이징 -->
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.insertWghPrfmncCom		-->
	<!-- DESC : 계량실적 공통 등록.		                                       			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                            -->
	<!-- ==========================================================================	-->
    <insert id="insertWghPrfmncCom" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
    	<![CDATA[
	    	INSERT /* com.at.apcss.am.wgh.mapper.WghPrfmncMapper.insertWghPrfmncCom */
	    		INTO TB_WGH_PRFMNC_COM
				(
					  APC_CD
					, WGHNO
					, WGH_YMD
					, VHCLNO
					, PRDCR_CD
					, WHOL_WGHT
					, EMPT_VHCL_WGHT
					, RDCD_RT
					, RDCD_WGHT
					, WRHS_WGHT
					, RMRK
					, FCLT_CD
					, WRHS_SPMT_TYPE
					, SHPGOT_QNTT
                    , SHPGOT_WGHT
                    , SHPGOT_PLT_QNTT
                    , OINST_SPMT_NM
                    , TRSPRT_CST
                    , OPRTR_NM
		    		, SYS_FRST_INPT_DT
		    		, SYS_FRST_INPT_USER_ID
		    		, SYS_FRST_INPT_PRGRM_ID
		    		, SYS_LAST_CHG_DT
		    		, SYS_LAST_CHG_USER_ID
		    		, SYS_LAST_CHG_PRGRM_ID
	    		)
	   		VALUES
	   			(
					  #{apcCd}
					, #{wghno}
					, #{wghYmd}
					, #{vhclno}
					, #{prdcrCd}
					, #{wholWght}
					, #{emptVhclWght}
					, #{rdcdRt}
					, #{rdcdWght}
					, #{wrhsWght}
					, #{rmrk}
					, #{fcltCd}
					, #{wrhsSpmtType}
					, #{shpgotQntt}
                    , #{shpgotWght}
                    , #{shpgotPltQntt}
                    , #{oinstSpmtNm}
                    , #{trsprtCst}
                    , #{oprtrNm}
		    		, SYSDATE
		    		, #{sysFrstInptUserId}
		    		, #{sysFrstInptPrgrmId}
		    		, SYSDATE
		    		, #{sysLastChgUserId}
		    		, #{sysLastChgPrgrmId}
	   			)
    	]]>
    </insert>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.updateWghPrfmncCom		-->
	<!-- DESC : 계량실적 공통 변경.		                                       			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                            -->
	<!-- ==========================================================================	-->
    <update id="updateWghPrfmncCom" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		<![CDATA[
			UPDATE /* com.at.apcss.am.cmns.mapper.CmnsSpcfctMapper.updateWghPrfmncCom */
				TB_WGH_PRFMNC_COM
			   SET
			   	  SYS_LAST_CHG_DT 			= SYSDATE
	    		, SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
	    		, SYS_LAST_CHG_PRGRM_ID 	= #{sysLastChgPrgrmId}

				, WGH_YMD					= #{wghYmd}
				, VHCLNO					= #{vhclno}
				, PRDCR_CD					= #{prdcrCd}
				, WHOL_WGHT					= #{wholWght}
				, EMPT_VHCL_WGHT			= #{emptVhclWght}
				, RDCD_RT					= #{rdcdRt}
				, RDCD_WGHT					= #{rdcdWght}
				, WRHS_WGHT					= #{wrhsWght}
				, RMRK						= #{rmrk}
				, FCLT_CD					= #{fcltCd}
				, WRHS_SPMT_TYPE			= #{wrhsSpmtType}
				, SHPGOT_QNTT				= #{shpgotQntt}
                , SHPGOT_WGHT       		= #{shpgotWght}
                , SHPGOT_PLT_QNTT   		= #{shpgotPltQntt}
                , OINST_SPMT_NM     		= #{oinstSpmtNm}
                , TRSPRT_CST        		= #{trsprtCst}
                , OPRTR_NM          		= #{oprtrNm}
		]]>
			<if test='delYn != null and delYn != ""'>
				, DEL_YN					= #{delYn}
			</if>
		<![CDATA[
			 WHERE APC_CD 					= #{apcCd}
			   AND WGHNO 					= #{wghno}
		]]>
	</update>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.deleteWghPrfmncCom			-->
	<!-- DESC : 계량실적 공통 삭제.		                                       			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                            -->
	<!-- ==========================================================================	-->
	<delete id="deleteWghPrfmncCom" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		<![CDATA[
			DELETE /* com.at.apcss.am.wgh.mapper.WghPrfmncMapper.deleteWghPrfmncCom */
			  FROM TB_WGH_PRFMNC_COM
			 WHERE APC_CD = #{apcCd}
			   AND WGHNO = #{wghno}
		]]>
	</delete>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghPrfmncDtl		-->
	<!-- DESC : 계량실적 상세 단건 조회.	                                       			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectWghPrfmncDtl" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncDtlVO" resultType="com.at.apcss.am.wgh.vo.WghPrfmncDtlVO">
    	<![CDATA[
	    	SELECT /* com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghPrfmncDtl */
				  WD.APC_CD		AS APC_CD
				, WD.WGHNO		AS WGHNO
				, WD.WGH_SN		AS WGH_SN
				, WD.PLT_BX_SE_CD	AS PLT_BX_SE_CD
				, WD.PLT_BX_KND	AS PLT_BX_KND
				, WD.GRD_CD		AS GRD_CD
				, WD.UNIT_WGHT	AS UNIT_WGHT
				, WD.QNTT		AS QNTT
				, WD.WGHT		AS WGHT
				, WD.DEL_YN		AS DEL_YN
			  FROM TB_WGH_PRFMNC_DTL WD
			 WHERE WC.APC_CD = #{apcCd}
			   AND WC.WGHNO = #{wghno}
			   AND WD.WGH_SN = #{wghSn}
		]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghPrfmncDtlList	-->
	<!-- DESC : 계량실적 상세 목록 조회.	                                       			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectWghPrfmncDtlList" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncDtlVO" resultType="com.at.apcss.am.wgh.vo.WghPrfmncDtlVO">
    	<![CDATA[
    		SELECT /* com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghPrfmncDtlList */
		]]>
    	<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>
    			  ROWNUM AS ROW_SEQ
    			, COUNT(*) OVER() AS TOTAL_RECORD_COUNT
				,
    	</if>
    	<!-- End 페이징 -->
    	<![CDATA[
				  pt0.*
    			, (SELECT FN_GET_GRD_NM_RAWMTR(pt0.APC_CD, pt0.ITEM_CD, pt0.GRD_CD) FROM DUAL) AS GRD_NM
                , (SELECT FN_GET_STD_GRD_RAWMTR(pt0.APC_CD, pt0.WRHSNO) FROM DUAL) AS STD_GRD
                , (SELECT FN_GET_STD_GRD_RAWMTR(pt0.APC_CD, pt0.WRHSNO, 'CD') FROM DUAL) AS STD_GRD_CD
                , (SELECT FN_GET_PB_CNVRS_UWGHT(pt0.APC_CD, 'P', pt0.PLT_KND) FROM DUAL) AS PLT_UNIT_WGHT
                , (SELECT FN_GET_PB_CNVRS_UWGHT(pt0.APC_CD, 'B', pt0.BX_KND) FROM DUAL) AS BX_UNIT_WGHT

    		  FROM (
	    	SELECT
				  WD.APC_CD		AS APC_CD
				, WD.WGHNO		AS WGHNO
				, WD.WGH_SN		AS WGH_SN
				, WD.GRD_CD		AS GRD_CD
				, WD.PLT_KND	AS PLT_KND
				, WD.PLT_QNTT	AS PLT_QNTT
				, WD.PLT_WGHT	AS PLT_WGHT
				, WD.BX_KND		AS BX_KND
				, WD.BX_QNTT	AS BX_QNTT
				, WD.BX_WGHT	AS BX_WGHT
				, WD.WRHSNO		AS WRHSNO

				, INV.ITEM_CD       AS ITEM_CD
				, INV.VRTY_CD       AS VRTY_CD
				, INV.GDS_SE_CD     AS GDS_SE_CD
				, INV.WRHS_SE_CD    AS WRHS_SE_CD
				, INV.TRSPRT_SE_CD  AS TRSPRT_SE_CD

			  FROM TB_WGH_PRFMNC_DTL WD

			  JOIN TB_RAW_MTR_INVNTR INV
			    ON INV.APC_CD = WD.APC_CD
			   AND INV.WRHSNO = WD.WRHSNO
			   AND INV.DEL_YN = 'N'

			 WHERE WD.DEL_YN = 'N'
		]]>
		<if test='delYn != null and delYn != ""'>
			   AND WD.DEL_YN = #{delYn}
		</if>
		<if test='apcCd != null and apcCd != ""'>
			   AND WD.APC_CD = #{apcCd}
		</if>
		<if test='wghno != null and wghno != ""'>
			   AND WD.WGHNO = #{wghno}
		</if>
		<if test='wghSn != null and wghSn != ""'>
			   AND WD.WGH_SN = #{wghSn}
		</if>
		<if test='wrhsno != null and wrhsno != ""'>
			   AND WD.WRHSNO = #{wrhsno}
		</if>

		<![CDATA[
			 ORDER BY APC_CD, WGHNO, WGH_SN
    		  ) pt0
		]]>
		<!-- Start 페이징 -->
    	<if test='pagingYn != null and pagingYn.equals("Y")'>

			OFFSET (#{currentPageNo} - 1) * #{recordCountPerPage} ROWS
			FETCH FIRST #{recordCountPerPage} ROWS ONLY
    	</if>
    	<!-- End 페이징 -->
    </select>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.insertWghPrfmncDtl		-->
	<!-- DESC : 계량실적 상세 등록.		                                       			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                            -->
	<!-- ==========================================================================	-->
    <insert id="insertWghPrfmncDtl" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncDtlVO">
    	<![CDATA[
	    	INSERT /* com.at.apcss.am.wgh.mapper.WghPrfmncMapper.insertWghPrfmncDtl */
	    		INTO TB_WGH_PRFMNC_DTL
				(
					  APC_CD
					, WGHNO
					, WGH_SN
					, GRD_CD
					, PLTNO
					, PLT_KND
					, PLT_QNTT
					, PLT_WGHT
					, BX_KND
					, BX_QNTT
					, BX_WGHT
					, WRHSNO
					, SPMTNO
					, ITEM_CD
					, VRTY_CD
					, SPCFCT_CD
					, SPMT_PCKG_UNIT_CD
					, GDS_CD
					, CNPT_CD
		    		, SYS_FRST_INPT_DT
		    		, SYS_FRST_INPT_USER_ID
		    		, SYS_FRST_INPT_PRGRM_ID
		    		, SYS_LAST_CHG_DT
		    		, SYS_LAST_CHG_USER_ID
		    		, SYS_LAST_CHG_PRGRM_ID
	    		)
	   		VALUES
	   			(
					  #{apcCd}
					, #{wghno}
					, #{wghSn}
					, #{grdCd}
					, #{pltno}
					, #{pltKnd}
					, #{pltQntt}
					, #{pltWght}
					, #{bxKnd}
					, #{bxQntt}
					, #{bxWght}
					, #{wrhsno}
					, #{spmtno}
					, #{itemCd}
					, #{vrtyCd}
					, #{spcfctCd}
					, #{spmtPckgUnitCd}
					, #{gdsCd}
					, #{cnptCd}
		    		, SYSDATE
		    		, #{sysFrstInptUserId}
		    		, #{sysFrstInptPrgrmId}
		    		, SYSDATE
		    		, #{sysLastChgUserId}
		    		, #{sysLastChgPrgrmId}
	   			)
    	]]>
    </insert>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.updateWghPrfmncDtl		-->
	<!-- DESC : 계량실적 상세 변경.		                                       			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                            -->
	<!-- ==========================================================================	-->
    <update id="updateWghPrfmncDtl" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncDtlVO">
		<![CDATA[
			UPDATE /* com.at.apcss.am.cmns.mapper.CmnsSpcfctMapper.updateWghPrfmncDtl */
				TB_WGH_PRFMNC_DTL
			   SET
			   	  SYS_LAST_CHG_DT 			= SYSDATE
	    		, SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
	    		, SYS_LAST_CHG_PRGRM_ID 	= #{sysLastChgPrgrmId}
				, GRD_CD 					= #{grdCd}
				, PLTNO						= #{pltno}
				, PLT_KND					= #{pltKnd}
				, PLT_QNTT					= #{pltQntt}
				, PLT_WGHT					= #{pltWght}
				, BX_KND					= #{bxKnd}
				, BX_QNTT					= #{bxQntt}
				, BX_WGHT					= #{bxWght}
				, SPMTNO					= #{spmtno}
				, ITEM_CD					= #{itemCd}
				, VRTY_CD					= #{vrtyCd}
				, SPCFCT_CD					= #{spcfctCd}
				, SPMT_PCKG_UNIT_CD			= #{spmtPckgUnitCd}
				, GDS_CD					= #{gdsCd}
				, CNPT_CD					= #{cnptCd}
		]]>
			<if test='delYn != null and delYn != ""'>
				, DEL_YN					= #{delYn}
			</if>
		<![CDATA[

			 WHERE APC_CD 					= #{apcCd}
			   AND WGHNO 					= #{wghno}
			   AND WGH_SN 					= #{wghSn}
		]]>
	</update>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.deleteWghPrfmncDtl		-->
	<!-- DESC : 계량실적 상세 삭제.		                                       			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.07.28  	신정철        		Initial Creation                            -->
	<!-- ==========================================================================	-->
	<delete id="deleteWghPrfmncDtl" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncDtlVO">
		<![CDATA[
			DELETE /* com.at.apcss.am.wgh.mapper.WghPrfmncMapper.deleteWghPrfmncDtl */
			  FROM TB_WGH_PRFMNC_DTL
			 WHERE APC_CD = #{apcCd}
			   AND WGHNO = #{wghno}
			   AND WGH_SN = #{wghSn}
		]]>
	</delete>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.updateWghPrfmncComForDelY-->
	<!-- DESC : 계량실적 공통 변경 : 삭제 delyn 'Y'.                                		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.10.28  	신정철        		Initial Creation                            -->
	<!-- ==========================================================================	-->
    <update id="updateWghPrfmncComForDelY" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		<![CDATA[
			UPDATE /* com.at.apcss.am.cmns.mapper.CmnsSpcfctMapper.updateWghPrfmncComForDelY */
				TB_WGH_PRFMNC_COM
			   SET
			   	  SYS_LAST_CHG_DT 			= SYSDATE
	    		, SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
	    		, SYS_LAST_CHG_PRGRM_ID 	= #{sysLastChgPrgrmId}
				, DEL_YN = 'Y'
			 WHERE APC_CD = #{apcCd}
			   AND WGHNO = #{wghno}
		]]>
	</update>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.updateWghPrfmncDtlForDelY-->
	<!-- DESC : 계량실적 상세 변경 : 삭제 delYn 'Y'.		                             	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.10.28  	신정철        		Initial Creation                            -->
	<!-- ==========================================================================	-->
    <update id="updateWghPrfmncDtlForDelY" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncDtlVO">
		<![CDATA[
			UPDATE /* com.at.apcss.am.cmns.mapper.CmnsSpcfctMapper.updateWghPrfmncDtlForDelY */
				TB_WGH_PRFMNC_DTL
			   SET
			   	  SYS_LAST_CHG_DT 			= SYSDATE
	    		, SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
	    		, SYS_LAST_CHG_PRGRM_ID 	= #{sysLastChgPrgrmId}
				, DEL_YN = 'Y'
			 WHERE APC_CD = #{apcCd}
			   AND WGHNO = #{wghno}
			   AND WGH_SN = #{wghSn}
		]]>
	</update>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghInfoMngList		-->
	<!-- DESC : 계량관리정보 목록 조회.		                             			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.10.22  	김호        		Initial Creation                        -->
	<!-- ==========================================================================	-->
	<select id="selectWghInfoWrhsMngList" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO" resultType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		<![CDATA[
			SELECT /* com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghInfoMngList */
			       pt0.*
			     , (SELECT FN_GET_PRDCR_NM(pt0.PRDCR_CD, pt0.APC_CD) FROM DUAL) 								AS PRDCR_NM
			     , (SELECT FN_GET_ITEM_NM(pt0.ITEM_CD, pt0.APC_CD) FROM DUAL) 									AS ITEM_NM
			     , (SELECT FN_GET_VRTY_NM(pt0.ITEM_CD, pt0.VRTY_CD, pt0.APC_CD) FROM DUAL) 						AS VRTY_NM
			     , (SELECT FN_GET_GRD_NM_RAWMTR(pt0.APC_CD, pt0.ITEM_CD, pt0.GRD_CD) FROM DUAL) 				AS GRD_NM
			     , (SELECT FN_GET_COM_CD_VL_NM('WAREHOUSE_SE_CD', pt0.WAREHOUSE_SE_CD, pt0.APC_CD) FROM DUAL) 	AS WAREHOUSE_SE_NM
			     , pt0.WHOL_WGHT - pt0.EMPT_VHCL_WGHT AS ACTL_WGHT
			     , ROUND((pt0.WHOL_WGHT - pt0.EMPT_VHCL_WGHT) * ((100 - NVL(RDCD_RT, 0)) / 100), 0) AS ACPTN_WGHT
			  FROM (SELECT
			               WC.APC_CD		    AS APC_CD
			             , WC.WGHNO		        AS WGHNO
			             , WD.WGH_SN			AS WGH_SN
			             , WD.WRHSNO		    AS WRHSNO
			             , WC.WGH_YMD           AS WGH_YMD
			             , WC.VHCLNO            AS VHCLNO
			             , WC.PRDCR_CD	        AS PRDCR_CD
			             , WC.WHOL_WGHT         AS WHOL_WGHT
			             , WC.EMPT_VHCL_WGHT    AS EMPT_VHCL_WGHT
			             , WC.RDCD_RT           AS RDCD_RT
			             , WC.RDCD_WGHT         AS RDCD_WGHT
			             , WC.WRHS_WGHT         AS WRHS_WGHT
			             , WC.RMRK              AS RMRK
			             , WC.WRHS_SPMT_TYPE	AS WRHS_SPMT_TYPE
			             , WP.PLTNO				AS PLTNO
			             , WD.GRD_CD            AS GRD_CD
			             , WD.PLT_KND		    AS PLT_KND
			             , WD.PLT_WGHT          AS PLT_WGHT
			             , WD.BX_KND			AS BX_KND
			             , WD.BX_QNTT           AS BX_QNTT
			             , WD.BX_WGHT           AS BX_WGHT
			             , INV.INVNTR_WGHT      AS INVNTR_WGHT
                         , INV.INVNTR_QNTT      AS INVNTR_QNTT
			             , INV.WAREHOUSE_SE_CD  AS WAREHOUSE_SE_CD
			             , INV.ITEM_CD          AS ITEM_CD
			             , INV.VRTY_CD          AS VRTY_CD
			             , INV.PRDCTN_YR		AS PRDCTN_YR
			             , INV.STRG_LOCTN_CD    AS STRG_LOCTN_CD
			             , SUBSTR(INV.STRG_LOCTN_CD, 1, 1)  AS STRG_LOCTN_ROW
			             , SUBSTR(INV.STRG_LOCTN_CD, 2, 2)  AS STRG_LOCTN_COL
			             , SUBSTR(INV.STRG_LOCTN_CD, 4, 2)  AS STRG_LOCTN_LVL
			          FROM TB_WGH_PRFMNC_COM WC
			             , TB_WGH_PRFMNC_DTL WD
			             , TB_RAW_MTR_WRHS_PRFMNC WP
			             , TB_RAW_MTR_INVNTR INV
			         WHERE WC.APC_CD = WD.APC_CD
			           AND WC.WGHNO = WD.WGHNO
			           AND WC.APC_CD = WP.APC_CD
			           AND WC.WGHNO = WP.WGHNO
			           AND WD.WRHSNO = WP.WRHSNO
			           AND WP.APC_CD = INV.APC_CD
			           AND WP.WRHSNO = INV.WRHSNO
			           AND WC.DEL_YN = 'N'
			           AND WD.DEL_YN = 'N'
			           AND WP.DEL_YN = 'N'
			           AND INV.DEL_YN = 'N'
		]]>
		<if test='apcCd != null and apcCd !=""'>
			           AND WC.APC_CD = #{apcCd}
		</if>
		<if test='itemCd != null and itemCd !=""'>
			           AND INV.ITEM_CD = #{itemCd}
		</if>
		<if test='prdcrCd != null and prdcrCd !=""'>
			           AND WC.PRDCR_CD = #{prdcrCd}
		</if>
		<if test='wrhsSpmtType != null and wrhsSpmtType !=""'>
			           AND NVL(WC.WRHS_SPMT_TYPE, 'RT') = #{wrhsSpmtType}
		</if>
		<if test='wghYmdFrom != null and wghYmdFrom !=""'>
			           AND WC.WGH_YMD <![CDATA[>=]]> #{wghYmdFrom}
		</if>
		<if test='wghYmdTo != null and wghYmdTo !=""'>
			           AND WC.WGH_YMD <![CDATA[<=]]> #{wghYmdTo}
		</if>
		<![CDATA[
			       ) pt0
		]]>
	</select>
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghInfoMngList		-->
	<!-- DESC : 계량관리정보 입고 목록 조회.		                             	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.10.22  	김호        		Initial Creation                        -->
	<!-- ==========================================================================	-->
	<select id="selectWghInfoSpmtMngList" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO" resultType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		<![CDATA[
			SELECT /* com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghInfoMngList */
			       pt0.*
			     , (SELECT FN_GET_PRDCR_NM(pt0.CNPT_CD, pt0.APC_CD) FROM DUAL) 									AS CNPT_NM
			     , (SELECT FN_GET_PRDCR_NM(pt0.PRDCR_CD, pt0.APC_CD) FROM DUAL) 								AS PRDCR_NM
			     , (SELECT FN_GET_ITEM_NM(pt0.ITEM_CD, pt0.APC_CD) FROM DUAL) 									AS ITEM_NM
			     , (SELECT FN_GET_VRTY_NM(pt0.ITEM_CD, pt0.VRTY_CD, pt0.APC_CD) FROM DUAL) 						AS VRTY_NM
			     , (SELECT FN_GET_GRD_NM_RAWMTR(pt0.APC_CD, pt0.ITEM_CD, pt0.GRD_CD) FROM DUAL) 				AS GRD_NM
			     , (SELECT FN_GET_COM_CD_VL_NM('WAREHOUSE_SE_CD', pt0.WAREHOUSE_SE_CD, pt0.APC_CD) FROM DUAL) 	AS WAREHOUSE_SE_NM
			     , pt0.WHOL_WGHT - pt0.EMPT_VHCL_WGHT AS ACTL_WGHT
			     , ROUND((pt0.WHOL_WGHT - pt0.EMPT_VHCL_WGHT) * ((100 - NVL(RDCD_RT, 0)) / 100), 0) AS ACPTN_WGHT
			  FROM (SELECT
			               WC.APC_CD		    AS APC_CD
			             , WC.WGHNO		        AS WGHNO
			             , WD.WGH_SN			AS WGH_SN
			             , WD.WRHSNO		    AS WRHSNO
			             , WC.WGH_YMD           AS WGH_YMD
			             , WC.VHCLNO            AS VHCLNO
			             , WC.PRDCR_CD	        AS PRDCR_CD
			             , WC.WRHS_SPMT_TYPE	AS WRHS_SPMT_TYPE
			             , NVL(PC.CNPT_CD, WC.PRDCR_CD)			AS CNPT_CD
			             , WC.WHOL_WGHT         AS WHOL_WGHT
			             , WC.EMPT_VHCL_WGHT    AS EMPT_VHCL_WGHT
			             , WC.RDCD_RT           AS RDCD_RT
			             , WC.RDCD_WGHT         AS RDCD_WGHT
			             , WC.WRHS_WGHT         AS WRHS_WGHT
			             , WC.RMRK              AS RMRK
			             , WD.GRD_CD            AS GRD_CD
			             , WD.PLT_KND		    AS PLT_KND
			             , WD.PLT_WGHT          AS PLT_WGHT
			             , WD.BX_KND			AS BX_KND
			             , WD.BX_QNTT           AS BX_QNTT
			             , WD.BX_WGHT           AS BX_WGHT
			             , GI.WAREHOUSE_SE_CD   AS WAREHOUSE_SE_CD
			             , NVL(GI.ITEM_CD,WD.ITEM_CD)           AS ITEM_CD
			             , NVL(GI.VRTY_CD,WD.VRTY_CD)           AS VRTY_CD
			             , GI.STRG_LOCTN_CD     AS STRG_LOCTN_CD
			             , SUBSTR(GI.STRG_LOCTN_CD, 1, 1)  AS STRG_LOCTN_ROW
			             , SUBSTR(GI.STRG_LOCTN_CD, 2, 2)  AS STRG_LOCTN_COL
			             , SUBSTR(GI.STRG_LOCTN_CD, 4, 2)  AS STRG_LOCTN_LVL
			          FROM TB_WGH_PRFMNC_COM WC
			             , TB_WGH_PRFMNC_DTL WD
			             , TB_SPMT_PRFMNC_COM PC
                         , TB_SPMT_PRFMNC_DTL PD
			             , TB_GDS_INVNTR GI
			         WHERE WC.APC_CD = WD.APC_CD(+)
                       AND WC.WGHNO = WD.WGHNO(+)
                       AND WD.APC_CD = PC.APC_CD(+)
                       AND WD.SPMTNO = PC.SPMTNO(+)
                       AND WD.APC_CD = PD.APC_CD(+)
                       AND WD.SPMTNO = PD.SPMTNO(+)
                       AND WD.WGH_SN = PD.SPMT_SN(+)
                       AND PD.APC_CD = GI.APC_CD(+)
                       AND PD.PCKGNO = GI.PCKGNO(+)
                       AND PD.PCKG_SN = GI.PCKG_SN(+)
			           AND WC.DEL_YN = 'N'
			           AND WD.DEL_YN(+) = 'N'
			           AND PC.DEL_YN(+) = 'N'
                       AND PD.DEL_YN(+) = 'N'
			           AND GI.DEL_YN(+) = 'N'
		]]>
		<if test='apcCd != null and apcCd !=""'>
			           AND WC.APC_CD = #{apcCd}
		</if>
		<if test='itemCd != null and itemCd !=""'>
			           AND GI.ITEM_CD = #{itemCd}
		</if>
		<if test='prdcrCd != null and prdcrCd !=""'>
			           AND WC.PRDCR_CD = #{prdcrCd}
		</if>
		<if test='wrhsSpmtType != null and wrhsSpmtType !=""'>
			           AND NVL(WC.WRHS_SPMT_TYPE, 'RT') = #{wrhsSpmtType}
		</if>
		<if test='wghYmdFrom != null and wghYmdFrom !=""'>
			           AND WC.WGH_YMD <![CDATA[>=]]> #{wghYmdFrom}
		</if>
		<if test='wghYmdTo != null and wghYmdTo !=""'>
			           AND WC.WGH_YMD <![CDATA[<=]]> #{wghYmdTo}
		</if>
		<![CDATA[
			       ) pt0
		]]>
	</select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.updateStrgLoctnCd		-->
	<!-- DESC : 계량관리정보 변경.		                             				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.10.22  	김호        		Initial Creation                        -->
	<!-- ==========================================================================	-->
	<update id="updateStrgLoctnCd" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		<![CDATA[
			UPDATE TB_RAW_MTR_INVNTR
			   SET STRG_LOCTN_CD 			= #{strgLoctnCd}
			     , WAREHOUSE_SE_CD 			= #{warehouseSeCd}
			     , WRHS_WGHT 				= #{wrhsWght}
			     , SYS_LAST_CHG_DT 			= SYSDATE
	    		 , SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
	    		 , SYS_LAST_CHG_PRGRM_ID 	= #{sysLastChgPrgrmId}
			 WHERE APC_CD 					= #{apcCd}
			   AND WRHSNO  					= #{wrhsno}
		]]>
	</update>
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.updateStrgLoctnCd		-->
	<!-- DESC : 계량감량율 변경.		                             				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.10.22  	김호        		Initial Creation                        -->
	<!-- ==========================================================================	-->
	<update id="updateRdcdRt" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		<![CDATA[
			UPDATE TB_WGH_PRFMNC_COM
			   SET RDCD_RT  				= #{rdcdRt}
			     , RDCD_WGHT				= #{rdcdWght}
			     , WRHS_WGHT				= #{wrhsWght}
			     , SYS_LAST_CHG_DT 			= SYSDATE
	    		 , SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
	    		 , SYS_LAST_CHG_PRGRM_ID 	= #{sysLastChgPrgrmId}
			 WHERE APC_CD 					= #{apcCd}
			   AND WGHNO   					= #{wghno}
		]]>
	</update>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghRcptWrhsList	-->
	<!-- DESC : 계량접수등록 입고 목록 조회.		                             	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.10.30  	김호        		Initial Creation                        -->
	<!-- ==========================================================================	-->
	<select id="selectWghRcptWrhsList" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO" resultType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		<![CDATA[
			 SELECT Y.APC_CD                AS APC_CD
			      , Y.WGHNO                 AS WGHNO
			      , Y.WGH_YMD               AS WGH_YMD
			      , Y.VHCLNO                AS VHCLNO
			      , Y.PRDCR_CD	            AS PRDCR_CD
			      , (SELECT FN_GET_PRDCR_NM(Y.PRDCR_CD, Y.APC_CD) FROM DUAL) AS PRDCR_NM
			      , MAX(Y.RMRK)				AS RMRK
			      , Y.ITEM_CD               AS ITEM_CD
			      , (SELECT FN_GET_ITEM_NM(Y.ITEM_CD, Y.APC_CD) FROM DUAL) AS ITEM_NM
			      , LISTAGG(Y.VRTY_CD, ',') WITHIN GROUP(ORDER BY Y.VRTY_CD) AS VRTY_CD
                  , LISTAGG(FN_GET_VRTY_NM(Y.ITEM_CD, Y.VRTY_CD, Y.APC_CD), ',') WITHIN GROUP(ORDER BY Y.VRTY_CD) AS VRTY_NM
			      , Y.FCLT_CD		        AS FCLT_CD
			      , (SELECT FN_GET_COM_CD_VL_NM('WGH_FCLT_CD', Y.FCLT_CD, Y.APC_CD) FROM DUAL) AS FCLT_NM
			      , Y.WRHS_SPMT_TYPE        AS WRHS_SPMT_TYPE
			      , (SELECT FN_GET_COM_CD_VL_NM('WRHS_SPMT_TYPE', Y.WRHS_SPMT_TYPE) FROM DUAL) AS WRHS_SPMT_TYPE_NM
			      , MAX(Y.SHPGOT_QNTT)      AS SHPGOT_QNTT
                  , MAX(Y.SHPGOT_WGHT)      AS SHPGOT_WGHT
                  , MAX(Y.SHPGOT_PLT_QNTT)  AS SHPGOT_PLT_QNTT
                  , MAX(Y.OINST_SPMT_NM)    AS OINST_SPMT_NM
                  , MAX(Y.TRSPRT_CST)       AS TRSPRT_CST
                  , MAX(Y.OPRTR_NM)         AS OPRTR_NM
			      , MAX(Y.WHOL_WGHT)        AS WHOL_WGHT
			      , MAX(Y.EMPT_VHCL_WGHT)   AS EMPT_VHCL_WGHT
			      , MAX(Y.WHOL_WGHT) - NVL(MAX(Y.EMPT_VHCL_WGHT), 0) AS ACTL_WGHT
			      , MAX(Y.PLT_QNTT)         AS PLT_QNTT
			      , SUM(Y.BX_QNTT)          AS BX_QNTT
			      , MAX(Y.DRVR_NM)          AS DRVR_NM
                  , MAX(Y.BANK_CD)          AS BANK_CD
                  , FN_UTL_DECRYPT_ARIA(MAX(Y.ACTNO))            AS ACTNO
                  , MAX(Y.TELNO)            AS TELNO
			      , MAX(GRD_CD_1)           AS GRD_CD_1
			      , SUM(GRD_QNTT_1)         AS GRD_QNTT_1
			      , MAX(GRD_WRHSNO_1)       AS GRD_WRHSNO_1
			      , MAX(GRD_WGH_SN_1)       AS GRD_WGH_SN_1
			      , MAX(GRD_CD_2)           AS GRD_CD_2
			      , SUM(GRD_QNTT_2)         AS GRD_QNTT_2
			      , MAX(GRD_WRHSNO_2)       AS GRD_WRHSNO_2
			      , MAX(GRD_WGH_SN_2)       AS GRD_WGH_SN_2
			      , MAX(GRD_CD_3)           AS GRD_CD_3
			      , SUM(GRD_QNTT_3)         AS GRD_QNTT_3
			      , MAX(GRD_WRHSNO_3)       AS GRD_WRHSNO_3
			      , MAX(GRD_WGH_SN_3)       AS GRD_WGH_SN_3
			      , MAX(GRD_CD_4)           AS GRD_CD_4
			      , SUM(GRD_QNTT_4)         AS GRD_QNTT_4
			      , MAX(GRD_WRHSNO_4)       AS GRD_WRHSNO_4
			      , MAX(GRD_WGH_SN_4)       AS GRD_WGH_SN_4
			   FROM (
			        SELECT X.APC_CD             AS APC_CD
			             , X.WGHNO              AS WGHNO
			             , X.WGH_YMD            AS WGH_YMD
			             , X.VHCLNO             AS VHCLNO
			             , X.PRDCR_CD	        AS PRDCR_CD
			             , X.WHOL_WGHT          AS WHOL_WGHT
			             , X.EMPT_VHCL_WGHT     AS EMPT_VHCL_WGHT
			             , X.ITEM_CD            AS ITEM_CD
			             , X.VRTY_CD            AS VRTY_CD
			             , x.FCLT_CD		    AS FCLT_CD
			             , x.WRHS_SPMT_TYPE     AS WRHS_SPMT_TYPE
			             , X.GRD_CD             AS GRD_CD
			             , X.PLT_QNTT           AS PLT_QNTT
			             , X.BX_QNTT            AS BX_QNTT
			             , X.SHPGOT_QNTT        AS SHPGOT_QNTT
                         , x.SHPGOT_WGHT        AS SHPGOT_WGHT
                         , X.SHPGOT_PLT_QNTT    AS SHPGOT_PLT_QNTT
                         , X.OINST_SPMT_NM      AS OINST_SPMT_NM
                         , X.TRSPRT_CST         AS TRSPRT_CST
                         , x.OPRTR_NM           AS OPRTR_NM
                         , x.RMRK				AS RMRK
                         , X.DRVR_NM            AS DRVR_NM
                         , X.BANK_CD            AS BANK_CD
                         , X.ACTNO              AS ACTNO
                         , X.TELNO              AS TELNO
			             , CASE WHEN X.GRD_RANK = 1 THEN X.GRD_CD END AS GRD_CD_1
			             , CASE WHEN X.GRD_RANK = 1 THEN X.BX_QNTT END AS GRD_QNTT_1
			             , CASE WHEN X.GRD_RANK = 1 THEN X.WRHSNO END AS GRD_WRHSNO_1
			             , CASE WHEN X.GRD_RANK = 1 THEN X.WGH_SN END AS GRD_WGH_SN_1
			             , CASE WHEN X.GRD_RANK = 2 THEN X.GRD_CD END AS GRD_CD_2
			             , CASE WHEN X.GRD_RANK = 2 THEN X.BX_QNTT END AS GRD_QNTT_2
			             , CASE WHEN X.GRD_RANK = 2 THEN X.WRHSNO END AS GRD_WRHSNO_2
			             , CASE WHEN X.GRD_RANK = 2 THEN X.WGH_SN END AS GRD_WGH_SN_2
			             , CASE WHEN X.GRD_RANK = 3 THEN X.GRD_CD END AS GRD_CD_3
			             , CASE WHEN X.GRD_RANK = 3 THEN X.BX_QNTT END AS GRD_QNTT_3
			             , CASE WHEN X.GRD_RANK = 3 THEN X.WRHSNO END AS GRD_WRHSNO_3
			             , CASE WHEN X.GRD_RANK = 3 THEN X.WGH_SN END AS GRD_WGH_SN_3
			             , CASE WHEN X.GRD_RANK = 4 THEN X.GRD_CD END AS GRD_CD_4
			             , CASE WHEN X.GRD_RANK = 4 THEN X.BX_QNTT END AS GRD_QNTT_4
			             , CASE WHEN X.GRD_RANK = 4 THEN X.WRHSNO END AS GRD_WRHSNO_4
			             , CASE WHEN X.GRD_RANK = 4 THEN X.WGH_SN END AS GRD_WGH_SN_4

			          FROM (
			                SELECT WC.APC_CD
			                     , WC.WGHNO
			                     , WC.WGH_YMD
			                     , WC.VHCLNO
			                     , WD.WGH_SN
			                     , WD.WRHSNO
			                     , WC.PRDCR_CD
			                     , WC.WHOL_WGHT
			                     , WC.EMPT_VHCL_WGHT
			                     , WC.FCLT_CD
			                     , WC.WRHS_SPMT_TYPE
			                     , WD.GRD_CD
			                     , WD.PLT_QNTT
			                     , WD.BX_QNTT
			                     , INV.ITEM_CD
			                     , INV.VRTY_CD
			                     , SG.GRD_RANK
			                     , WP.PLTNO
                                 , WC.SHPGOT_QNTT
                                 , WC.SHPGOT_WGHT
                                 , WC.SHPGOT_PLT_QNTT
                                 , WC.OINST_SPMT_NM
                                 , WC.TRSPRT_CST
                                 , WC.OPRTR_NM
			     				 , WC.RMRK
                                 , VI.DRVR_NM
                                 , VI.BANK_CD
                                 , VI.ACTNO
                                 , VI.TELNO
			                  FROM TB_WGH_PRFMNC_COM WC
			                     , TB_WGH_PRFMNC_DTL WD
			                     , TB_RAW_MTR_WRHS_PRFMNC WP
			                     , TB_RAW_MTR_INVNTR INV
			                     , TB_WRHS_VHCL_INFO VI
			                     , (SELECT RANK() OVER (ORDER BY GRD_CD ASC)       GRD_RANK
			                             , GRD_CD
			                             , APC_CD
			                          FROM TB_APC_STD_GRD_DTL
			                         WHERE APC_CD = #{apcCd}
			                           AND GRD_SE_CD = '01'
			                           AND ITEM_CD = #{itemCd}
			                        ) SG
			                 WHERE WC.APC_CD = WD.APC_CD
			                   AND WC.WGHNO = WD.WGHNO
			                   AND WC.APC_CD = WP.APC_CD
			                   AND WC.WGHNO = WP.WGHNO
			                   AND WD.WRHSNO = WP.WRHSNO
			                   AND WP.APC_CD = INV.APC_CD
			                   AND WP.WRHSNO = INV.WRHSNO
			                   AND WD.APC_CD = SG.APC_CD
			                   AND WD.GRD_CD = SG.GRD_CD
			                   AND WC.APC_CD = VI.APC_CD(+)
                               AND WC.VHCLNO = VI.VHCLNO(+)
			                   AND WC.DEL_YN = 'N'
			                   AND WD.DEL_YN = 'N'
			                   AND WP.DEL_YN = 'N'
			                   AND INV.DEL_YN = 'N'
			                   AND VI.DEL_YN(+) = 'N'
			                   AND WC.APC_CD = #{apcCd}
		]]>
		<if test='itemCd != null and itemCd !=""'>
							   AND INV.ITEM_CD = #{itemCd}
		</if>
		<if test='vrtyCd != null and vrtyCd !=""'>
							   AND INV.VRTY_CD = #{vrtyCd}
		</if>
		<if test='wghYmd != null and wghYmd !=""'>
							   AND WC.WGH_YMD = #{wghYmd}
		</if>
		<if test='prdcrCd != null and prdcrCd !=""'>
							   AND WC.PRDCR_CD = #{prdcrCd}
		</if>
		<if test='fcltCd != null and fcltCd !=""'>
							   AND WC.FCLT_CD = #{fcltCd}
		</if>
		<if test='wrhsSpmtType != null and wrhsSpmtType !=""'>
							   AND WC.WRHS_SPMT_TYPE = #{wrhsSpmtType}
		</if>
		<![CDATA[
			                ) X
			  ) Y
			 GROUP BY Y.APC_CD, Y.WGHNO, Y.WGH_YMD, Y.VHCLNO, Y.PRDCR_CD, Y.ITEM_CD, Y.FCLT_CD, Y.WRHS_SPMT_TYPE
			 ORDER BY Y.WGHNO DESC
		]]>
	</select>
	<!-- =============================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghRcptWrhsDtlList		-->
	<!-- DESC : 계량접수등록 입고 상세 목록 조회.		                            	-->
	<!-- =============================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      				-->
	<!-- ===========  	============  	==============================================	-->
	<!-- 2025.01.02  	김호        		Initial Creation                        	-->
	<!-- =============================================================================	-->
	<select id="selectWghRcptWrhsDtlList" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO" resultType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		<![CDATA[
			 SELECT Y.APC_CD                AS APC_CD
			      , Y.WGHNO                 AS WGHNO
			      , Y.WGH_YMD               AS WGH_YMD
			      , Y.VHCLNO                AS VHCLNO
			      , Y.PRDCR_CD	            AS PRDCR_CD
			      , (SELECT FN_GET_PRDCR_NM(Y.PRDCR_CD, Y.APC_CD) FROM DUAL) AS PRDCR_NM
			      , Y.ITEM_CD               AS ITEM_CD
			      , (SELECT FN_GET_ITEM_NM(Y.ITEM_CD, Y.APC_CD) FROM DUAL) AS ITEM_NM
			      , Y.VRTY_CD			 	AS VRTY_CD
			      , Y.FCLT_CD		        AS FCLT_CD
			      , (SELECT FN_GET_COM_CD_VL_NM('WGH_FCLT_CD', Y.FCLT_CD, Y.APC_CD) FROM DUAL) AS FCLT_NM
			      , Y.WRHS_SPMT_TYPE        AS WRHS_SPMT_TYPE
			      , (SELECT FN_GET_COM_CD_VL_NM('WRHS_SPMT_TYPE', Y.WRHS_SPMT_TYPE) FROM DUAL) AS WRHS_SPMT_TYPE_NM
			      , MAX(Y.SHPGOT_QNTT)      AS SHPGOT_QNTT
                  , MAX(Y.SHPGOT_WGHT)      AS SHPGOT_WGHT
                  , MAX(Y.SHPGOT_PLT_QNTT)  AS SHPGOT_PLT_QNTT
                  , MAX(Y.OINST_SPMT_NM)    AS OINST_SPMT_NM
                  , MAX(Y.TRSPRT_CST)       AS TRSPRT_CST
                  , MAX(Y.OPRTR_NM)         AS OPRTR_NM
			      , MAX(Y.WHOL_WGHT)        AS WHOL_WGHT
			      , MAX(Y.EMPT_VHCL_WGHT)   AS EMPT_VHCL_WGHT
			      , MAX(Y.WHOL_WGHT) - NVL(MAX(Y.EMPT_VHCL_WGHT), 0) AS ACTL_WGHT
			      , MAX(Y.PLT_QNTT)         AS PLT_QNTT
			      , SUM(Y.BX_QNTT)          AS BX_QNTT
			      , MAX(Y.DRVR_NM)          AS DRVR_NM
                  , MAX(Y.BANK_CD)          AS BANK_CD
                  , FN_UTL_DECRYPT_ARIA(MAX(Y.ACTNO))            AS ACTNO
                  , MAX(Y.TELNO)            AS TELNO
			      , MAX(GRD_CD_1)           AS GRD_CD_1
			      , SUM(GRD_QNTT_1)         AS GRD_QNTT_1
			      , MAX(GRD_WRHSNO_1)       AS GRD_WRHSNO_1
			      , MAX(GRD_WGH_SN_1)       AS GRD_WGH_SN_1
			      , MAX(GRD_CD_2)           AS GRD_CD_2
			      , SUM(GRD_QNTT_2)         AS GRD_QNTT_2
			      , MAX(GRD_WRHSNO_2)       AS GRD_WRHSNO_2
			      , MAX(GRD_WGH_SN_2)       AS GRD_WGH_SN_2
			      , MAX(GRD_CD_3)           AS GRD_CD_3
			      , SUM(GRD_QNTT_3)         AS GRD_QNTT_3
			      , MAX(GRD_WRHSNO_3)       AS GRD_WRHSNO_3
			      , MAX(GRD_WGH_SN_3)       AS GRD_WGH_SN_3
			      , MAX(GRD_CD_4)           AS GRD_CD_4
			      , SUM(GRD_QNTT_4)         AS GRD_QNTT_4
			      , MAX(GRD_WRHSNO_4)       AS GRD_WRHSNO_4
			      , MAX(GRD_WGH_SN_4)       AS GRD_WGH_SN_4
			   FROM (
			        SELECT X.APC_CD             AS APC_CD
			             , X.WGHNO              AS WGHNO
			             , X.WGH_YMD            AS WGH_YMD
			             , X.VHCLNO             AS VHCLNO
			             , X.PRDCR_CD	        AS PRDCR_CD
			             , X.WHOL_WGHT          AS WHOL_WGHT
			             , X.EMPT_VHCL_WGHT     AS EMPT_VHCL_WGHT
			             , X.ITEM_CD            AS ITEM_CD
			             , X.VRTY_CD            AS VRTY_CD
			             , x.FCLT_CD		    AS FCLT_CD
			             , x.WRHS_SPMT_TYPE     AS WRHS_SPMT_TYPE
			             , X.GRD_CD             AS GRD_CD
			             , X.PLT_QNTT           AS PLT_QNTT
			             , X.BX_QNTT            AS BX_QNTT
			             , X.SHPGOT_QNTT        AS SHPGOT_QNTT
                         , x.SHPGOT_WGHT        AS SHPGOT_WGHT
                         , X.SHPGOT_PLT_QNTT    AS SHPGOT_PLT_QNTT
                         , X.OINST_SPMT_NM      AS OINST_SPMT_NM
                         , X.TRSPRT_CST         AS TRSPRT_CST
                         , x.OPRTR_NM           AS OPRTR_NM
                         , X.DRVR_NM            AS DRVR_NM
                         , X.BANK_CD            AS BANK_CD
                         , X.ACTNO              AS ACTNO
                         , X.TELNO              AS TELNO
			             , CASE WHEN X.GRD_RANK = 1 THEN X.GRD_CD END AS GRD_CD_1
			             , CASE WHEN X.GRD_RANK = 1 THEN X.BX_QNTT END AS GRD_QNTT_1
			             , CASE WHEN X.GRD_RANK = 1 THEN X.WRHSNO END AS GRD_WRHSNO_1
			             , CASE WHEN X.GRD_RANK = 1 THEN X.WGH_SN END AS GRD_WGH_SN_1
			             , CASE WHEN X.GRD_RANK = 2 THEN X.GRD_CD END AS GRD_CD_2
			             , CASE WHEN X.GRD_RANK = 2 THEN X.BX_QNTT END AS GRD_QNTT_2
			             , CASE WHEN X.GRD_RANK = 2 THEN X.WRHSNO END AS GRD_WRHSNO_2
			             , CASE WHEN X.GRD_RANK = 2 THEN X.WGH_SN END AS GRD_WGH_SN_2
			             , CASE WHEN X.GRD_RANK = 3 THEN X.GRD_CD END AS GRD_CD_3
			             , CASE WHEN X.GRD_RANK = 3 THEN X.BX_QNTT END AS GRD_QNTT_3
			             , CASE WHEN X.GRD_RANK = 3 THEN X.WRHSNO END AS GRD_WRHSNO_3
			             , CASE WHEN X.GRD_RANK = 3 THEN X.WGH_SN END AS GRD_WGH_SN_3
			             , CASE WHEN X.GRD_RANK = 4 THEN X.GRD_CD END AS GRD_CD_4
			             , CASE WHEN X.GRD_RANK = 4 THEN X.BX_QNTT END AS GRD_QNTT_4
			             , CASE WHEN X.GRD_RANK = 4 THEN X.WRHSNO END AS GRD_WRHSNO_4
			             , CASE WHEN X.GRD_RANK = 4 THEN X.WGH_SN END AS GRD_WGH_SN_4

			          FROM (
			                SELECT WC.APC_CD
			                     , WC.WGHNO
			                     , WC.WGH_YMD
			                     , WC.VHCLNO
			                     , WD.WGH_SN
			                     , WD.WRHSNO
			                     , WC.PRDCR_CD
			                     , WC.WHOL_WGHT
			                     , WC.EMPT_VHCL_WGHT
			                     , WC.FCLT_CD
			                     , WC.WRHS_SPMT_TYPE
			                     , WD.GRD_CD
			                     , WD.PLT_QNTT
			                     , WD.BX_QNTT
			                     , INV.ITEM_CD
			                     , INV.VRTY_CD
			                     , SG.GRD_RANK
			                     , WP.PLTNO
                                 , WC.SHPGOT_QNTT
                                 , WC.SHPGOT_WGHT
                                 , WC.SHPGOT_PLT_QNTT
                                 , WC.OINST_SPMT_NM
                                 , WC.TRSPRT_CST
                                 , WC.OPRTR_NM
                                 , VI.DRVR_NM
                                 , VI.BANK_CD
                                 , VI.ACTNO
                                 , VI.TELNO
			                  FROM TB_WGH_PRFMNC_COM WC
			                     , TB_WGH_PRFMNC_DTL WD
			                     , TB_RAW_MTR_WRHS_PRFMNC WP
			                     , TB_RAW_MTR_INVNTR INV
			                     , TB_WRHS_VHCL_INFO VI
			                     , (SELECT RANK() OVER (ORDER BY GRD_CD ASC)       GRD_RANK
			                             , GRD_CD
			                             , APC_CD
			                          FROM TB_APC_STD_GRD_DTL
			                         WHERE APC_CD = #{apcCd}
			                           AND GRD_SE_CD = '01'
			                           AND ITEM_CD = #{itemCd}
			                        ) SG
			                 WHERE WC.APC_CD = WD.APC_CD
			                   AND WC.WGHNO = WD.WGHNO
			                   AND WC.APC_CD = WP.APC_CD
			                   AND WC.WGHNO = WP.WGHNO
			                   AND WD.WRHSNO = WP.WRHSNO
			                   AND WP.APC_CD = INV.APC_CD
			                   AND WP.WRHSNO = INV.WRHSNO
			                   AND WD.APC_CD = SG.APC_CD
			                   AND WD.GRD_CD = SG.GRD_CD
			                   AND WC.APC_CD = VI.APC_CD(+)
                               AND WC.VHCLNO = VI.VHCLNO(+)
			                   AND WC.DEL_YN = 'N'
			                   AND WD.DEL_YN = 'N'
			                   AND WP.DEL_YN = 'N'
			                   AND INV.DEL_YN = 'N'
			                   AND VI.DEL_YN(+) = 'N'
			                   AND WC.APC_CD = #{apcCd}
		]]>
		<if test='wghno != null and wghno !=""'>
							   AND WC.WGHNO = #{wghno}
		</if>
		<if test='wrhsSpmtType != null and wrhsSpmtType !=""'>
							   AND WC.WRHS_SPMT_TYPE = #{wrhsSpmtType}
		</if>
		<![CDATA[
			                ) X
			  ) Y
			 GROUP BY Y.APC_CD, Y.WGHNO, Y.WGH_YMD, Y.VHCLNO, Y.PRDCR_CD, Y.ITEM_CD, Y.VRTY_CD, Y.FCLT_CD, Y.WRHS_SPMT_TYPE
			 ORDER BY Y.WGHNO DESC
		]]>
	</select>
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghRcptSpmtList	-->
	<!-- DESC : 계량접수등록 출고 목록 조회.		                             	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.10.30  	김호        		Initial Creation                        -->
	<!-- ==========================================================================	-->
	<select id="selectWghRcptSpmtList" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO" resultType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		<![CDATA[
			 SELECT Y.APC_CD                AS APC_CD
			      , Y.WGHNO                 AS WGHNO
			      , Y.WGH_YMD               AS WGH_YMD
			      , Y.VHCLNO                AS VHCLNO
			      , (SELECT FN_GET_PRDCR_NM(Y.PRDCR_CD, Y.APC_CD) FROM DUAL) AS PRDCR_NM
			      , Y.ITEM_CD               AS ITEM_CD
			      , (SELECT FN_GET_ITEM_NM(Y.ITEM_CD, Y.APC_CD) FROM DUAL) AS ITEM_NM
			      , LISTAGG(Y.VRTY_CD, ',') WITHIN GROUP(ORDER BY Y.VRTY_CD) AS VRTY_CD
                  , LISTAGG(FN_GET_VRTY_NM(Y.ITEM_CD, Y.VRTY_CD, Y.APC_CD), ',') WITHIN GROUP(ORDER BY Y.VRTY_CD) AS VRTY_NM
			      , Y.FCLT_CD		        AS FCLT_CD
			      , (SELECT FN_GET_COM_CD_VL_NM('WGH_FCLT_CD', Y.FCLT_CD, Y.APC_CD) FROM DUAL) AS FCLT_NM
			      , Y.WRHS_SPMT_TYPE        AS WRHS_SPMT_TYPE
			      , (SELECT FN_GET_COM_CD_VL_NM('WRHS_SPMT_TYPE', Y.WRHS_SPMT_TYPE) FROM DUAL) AS WRHS_SPMT_TYPE_NM
			      , MAX(Y.WRHSNO)           AS WRHSNO
			      , MAX(Y.SHPGOT_QNTT)      AS SHPGOT_QNTT
                  , MAX(Y.SHPGOT_WGHT)      AS SHPGOT_WGHT
                  , MAX(Y.SHPGOT_PLT_QNTT)  AS SHPGOT_PLT_QNTT
                  , MAX(Y.OINST_SPMT_NM)    AS OINST_SPMT_NM
                  , MAX(Y.TRSPRT_CST)       AS TRSPRT_CST
                  , MAX(Y.OPRTR_NM)         AS OPRTR_NM
			      , MAX(Y.WHOL_WGHT)        AS WHOL_WGHT
			      , MAX(Y.EMPT_VHCL_WGHT)   AS EMPT_VHCL_WGHT
			      , MAX(Y.WHOL_WGHT) - NVL(MAX(Y.EMPT_VHCL_WGHT), 0) AS ACTL_WGHT
			      , MAX(Y.PLT_QNTT)         AS PLT_QNTT
			      , SUM(Y.BX_QNTT)          AS BX_QNTT
			      , MAX(Y.DRVR_NM)          AS DRVR_NM
                  , MAX(Y.BANK_CD)          AS BANK_CD
                  , FN_UTL_DECRYPT_ARIA(MAX(Y.ACTNO))            AS ACTNO
                  , MAX(Y.TELNO)            AS TELNO
                  , MAX(Y.RMRK)				AS RMRK
			      , MAX(GRD_CD_1)           AS GRD_CD_1
			      , SUM(GRD_QNTT_1)         AS GRD_QNTT_1
			      , MAX(GRD_WRHSNO_1)       AS GRD_WRHSNO_1
			      , MAX(GRD_WGH_SN_1)       AS GRD_WGH_SN_1
			      , MAX(GRD_CD_2)           AS GRD_CD_2
			      , SUM(GRD_QNTT_2)         AS GRD_QNTT_2
			      , MAX(GRD_WRHSNO_2)       AS GRD_WRHSNO_2
			      , MAX(GRD_WGH_SN_2)       AS GRD_WGH_SN_2
			      , MAX(GRD_CD_3)           AS GRD_CD_3
			      , SUM(GRD_QNTT_3)         AS GRD_QNTT_3
			      , MAX(GRD_WRHSNO_3)       AS GRD_WRHSNO_3
			      , MAX(GRD_WGH_SN_3)       AS GRD_WGH_SN_3
			      , MAX(GRD_CD_4)           AS GRD_CD_4
			      , SUM(GRD_QNTT_4)         AS GRD_QNTT_4
			      , MAX(GRD_WRHSNO_4)       AS GRD_WRHSNO_4
			      , MAX(GRD_WGH_SN_4)       AS GRD_WGH_SN_4
			   FROM (
			        SELECT X.APC_CD             AS APC_CD
			             , X.WGHNO              AS WGHNO
			             , X.WGH_YMD            AS WGH_YMD
			             , X.VHCLNO             AS VHCLNO
			             , X.PRDCR_CD	        AS PRDCR_CD
			             , X.WHOL_WGHT          AS WHOL_WGHT
			             , X.EMPT_VHCL_WGHT     AS EMPT_VHCL_WGHT
			             , X.ITEM_CD            AS ITEM_CD
			             , X.VRTY_CD            AS VRTY_CD
			             , x.FCLT_CD		    AS FCLT_CD
			             , x.WRHS_SPMT_TYPE     AS WRHS_SPMT_TYPE
			             , X.GRD_CD             AS GRD_CD
			             , X.PLT_QNTT           AS PLT_QNTT
			             , X.BX_QNTT            AS BX_QNTT
			             , X.SHPGOT_QNTT        AS SHPGOT_QNTT
                         , x.SHPGOT_WGHT        AS SHPGOT_WGHT
                         , X.SHPGOT_PLT_QNTT    AS SHPGOT_PLT_QNTT
                         , X.OINST_SPMT_NM      AS OINST_SPMT_NM
                         , X.TRSPRT_CST         AS TRSPRT_CST
                         , x.OPRTR_NM           AS OPRTR_NM
                         , X.DRVR_NM            AS DRVR_NM
                         , X.BANK_CD            AS BANK_CD
                         , X.ACTNO              AS ACTNO
                         , X.TELNO              AS TELNO
                         , X.WRHSNO				AS WRHSNO
                         , X.RMRK				AS RMRK
			             , CASE WHEN X.GRD_RANK = 1 THEN X.GRD_CD END AS GRD_CD_1
			             , CASE WHEN X.GRD_RANK = 1 THEN X.BX_QNTT END AS GRD_QNTT_1
			             , CASE WHEN X.GRD_RANK = 1 THEN X.WRHSNO END AS GRD_WRHSNO_1
			             , CASE WHEN X.GRD_RANK = 1 THEN X.WGH_SN END AS GRD_WGH_SN_1
			             , CASE WHEN X.GRD_RANK = 2 THEN X.GRD_CD END AS GRD_CD_2
			             , CASE WHEN X.GRD_RANK = 2 THEN X.BX_QNTT END AS GRD_QNTT_2
			             , CASE WHEN X.GRD_RANK = 2 THEN X.WRHSNO END AS GRD_WRHSNO_2
			             , CASE WHEN X.GRD_RANK = 2 THEN X.WGH_SN END AS GRD_WGH_SN_2
			             , CASE WHEN X.GRD_RANK = 3 THEN X.GRD_CD END AS GRD_CD_3
			             , CASE WHEN X.GRD_RANK = 3 THEN X.BX_QNTT END AS GRD_QNTT_3
			             , CASE WHEN X.GRD_RANK = 3 THEN X.WRHSNO END AS GRD_WRHSNO_3
			             , CASE WHEN X.GRD_RANK = 3 THEN X.WGH_SN END AS GRD_WGH_SN_3
			             , CASE WHEN X.GRD_RANK = 4 THEN X.GRD_CD END AS GRD_CD_4
			             , CASE WHEN X.GRD_RANK = 4 THEN X.BX_QNTT END AS GRD_QNTT_4
			             , CASE WHEN X.GRD_RANK = 4 THEN X.WRHSNO END AS GRD_WRHSNO_4
			             , CASE WHEN X.GRD_RANK = 4 THEN X.WGH_SN END AS GRD_WGH_SN_4

			          FROM (
			                SELECT WC.APC_CD
			                     , WC.WGHNO
			                     , WC.WGH_YMD
			                     , WC.VHCLNO
			                     , WD.WGH_SN
			                     , WD.SPMTNO        AS WRHSNO
			                     , WC.PRDCR_CD
			                     , WC.WHOL_WGHT
			                     , WC.EMPT_VHCL_WGHT
			                     , WC.FCLT_CD
			                     , WC.WRHS_SPMT_TYPE
			     				 , WC.RMRK
			                     , WD.GRD_CD
			                     , WD.PLT_QNTT
			                     , WD.BX_QNTT
			                     , GI.ITEM_CD
			                     , GI.VRTY_CD
			                     , SG.GRD_RANK
			                     , WC.SHPGOT_QNTT
			                     , WC.SHPGOT_WGHT
			                     , WC.SHPGOT_PLT_QNTT
			                     , WC.OINST_SPMT_NM
			                     , WC.TRSPRT_CST
			                     , WC.OPRTR_NM
			                     , VI.DRVR_NM
			                     , VI.BANK_CD
			                     , VI.ACTNO
			                     , VI.TELNO
			                  FROM TB_WGH_PRFMNC_COM WC
			                     , TB_WGH_PRFMNC_DTL WD
			                     , TB_SPMT_PRFMNC_COM PC
			                     , TB_SPMT_PRFMNC_DTL PD
			                     , TB_GDS_INVNTR GI
			                     , TB_WRHS_VHCL_INFO VI
			                     , (SELECT RANK() OVER (ORDER BY GRD_CD ASC)       GRD_RANK
			                             , GRD_CD
			                             , APC_CD
			                          FROM TB_APC_STD_GRD_DTL
			                         WHERE APC_CD = #{apcCd}
			                           AND GRD_SE_CD = '03'
			                           AND ITEM_CD = #{itemCd}
			                        ) SG
			                 WHERE WC.APC_CD = WD.APC_CD
			                   AND WC.WGHNO = WD.WGHNO
			                   AND WD.APC_CD = PC.APC_CD
			                   AND WD.SPMTNO = PC.SPMTNO
			                   AND PC.APC_CD = PD.APC_CD
			                   AND PC.SPMTNO = PD.SPMTNO
			                   AND WD.WGH_SN = PD.SPMT_SN
			                   AND PD.APC_CD = GI.APC_CD
			                   AND PD.PCKGNO = GI.PCKGNO
			                   AND PD.PCKG_SN = GI.PCKG_SN
			                   AND WD.APC_CD = SG.APC_CD
			                   AND WD.GRD_CD = SG.GRD_CD
			                   AND WC.APC_CD = VI.APC_CD(+)
			                   AND WC.VHCLNO = VI.VHCLNO(+)
			                   AND WC.DEL_YN = 'N'
			                   AND WD.DEL_YN = 'N'
			                   AND PC.DEL_YN = 'N'
			                   AND PD.DEL_YN = 'N'
			                   AND GI.DEL_YN = 'N'
			                   AND VI.DEL_YN(+) = 'N'
			                   AND WC.APC_CD = #{apcCd}
		]]>
		<if test='itemCd != null and itemCd !=""'>
							   AND GI.ITEM_CD = #{itemCd}
		</if>
		<if test='vrtyCd != null and vrtyCd !=""'>
							   AND GI.VRTY_CD = #{vrtyCd}
		</if>
		<if test='wghYmd != null and wghYmd !=""'>
							   AND WC.WGH_YMD = #{wghYmd}
		</if>
		<if test='prdcrCd != null and prdcrCd !=""'>
							   AND WC.PRDCR_CD = #{prdcrCd}
		</if>
		<if test='fcltCd != null and fcltCd !=""'>
							   AND WC.FCLT_CD = #{fcltCd}
		</if>
		<if test='wrhsSpmtType != null and wrhsSpmtType !=""'>
							   AND WC.WRHS_SPMT_TYPE = #{wrhsSpmtType}
		</if>
		<![CDATA[
			                ) X
			  ) Y
			 GROUP BY Y.APC_CD, Y.WGHNO, Y.WGH_YMD, Y.VHCLNO, Y.PRDCR_CD, Y.ITEM_CD, Y.FCLT_CD, Y.WRHS_SPMT_TYPE
			 ORDER BY Y.WGHNO DESC
		]]>
	</select>
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghRcptSpmtDtlList	-->
	<!-- DESC : 계량접수등록 출고 상세 목록 조회.		                             -->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.10.30  	김호        		Initial Creation                        -->
	<!-- ==========================================================================	-->
	<select id="selectWghRcptSpmtDtlList" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO" resultType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		<![CDATA[
			 SELECT Y.APC_CD                AS APC_CD
			      , Y.WGHNO                 AS WGHNO
			      , Y.WGH_YMD               AS WGH_YMD
			      , Y.VHCLNO                AS VHCLNO
			      , (SELECT FN_GET_PRDCR_NM(Y.PRDCR_CD, Y.APC_CD) FROM DUAL) AS PRDCR_NM
			      , Y.ITEM_CD               AS ITEM_CD
			      , (SELECT FN_GET_ITEM_NM(Y.ITEM_CD, Y.APC_CD) FROM DUAL) AS ITEM_NM
			      , Y.VRTY_CD				AS VRTY_CD
			      , Y.FCLT_CD		        AS FCLT_CD
			      , (SELECT FN_GET_COM_CD_VL_NM('WGH_FCLT_CD', Y.FCLT_CD, Y.APC_CD) FROM DUAL) AS FCLT_NM
			      , Y.WRHS_SPMT_TYPE        AS WRHS_SPMT_TYPE
			      , (SELECT FN_GET_COM_CD_VL_NM('WRHS_SPMT_TYPE', Y.WRHS_SPMT_TYPE) FROM DUAL) AS WRHS_SPMT_TYPE_NM
			      , MAX(Y.WRHSNO)           AS WRHSNO
			      , MAX(Y.SHPGOT_QNTT)      AS SHPGOT_QNTT
                  , MAX(Y.SHPGOT_WGHT)      AS SHPGOT_WGHT
                  , MAX(Y.SHPGOT_PLT_QNTT)  AS SHPGOT_PLT_QNTT
                  , MAX(Y.OINST_SPMT_NM)    AS OINST_SPMT_NM
                  , MAX(Y.TRSPRT_CST)       AS TRSPRT_CST
                  , MAX(Y.OPRTR_NM)         AS OPRTR_NM
			      , MAX(Y.WHOL_WGHT)        AS WHOL_WGHT
			      , MAX(Y.EMPT_VHCL_WGHT)   AS EMPT_VHCL_WGHT
			      , MAX(Y.WHOL_WGHT) - NVL(MAX(Y.EMPT_VHCL_WGHT), 0) AS ACTL_WGHT
			      , MAX(Y.PLT_QNTT)         AS PLT_QNTT
			      , SUM(Y.BX_QNTT)          AS BX_QNTT
			      , MAX(Y.DRVR_NM)          AS DRVR_NM
                  , MAX(Y.BANK_CD)          AS BANK_CD
                  , FN_UTL_DECRYPT_ARIA(MAX(Y.ACTNO))            AS ACTNO
                  , MAX(Y.TELNO)            AS TELNO
			      , MAX(GRD_CD_1)           AS GRD_CD_1
			      , SUM(GRD_QNTT_1)         AS GRD_QNTT_1
			      , MAX(GRD_WRHSNO_1)       AS GRD_WRHSNO_1
			      , MAX(GRD_WGH_SN_1)       AS GRD_WGH_SN_1
			      , MAX(GRD_CD_2)           AS GRD_CD_2
			      , SUM(GRD_QNTT_2)         AS GRD_QNTT_2
			      , MAX(GRD_WRHSNO_2)       AS GRD_WRHSNO_2
			      , MAX(GRD_WGH_SN_2)       AS GRD_WGH_SN_2
			      , MAX(GRD_CD_3)           AS GRD_CD_3
			      , SUM(GRD_QNTT_3)         AS GRD_QNTT_3
			      , MAX(GRD_WRHSNO_3)       AS GRD_WRHSNO_3
			      , MAX(GRD_WGH_SN_3)       AS GRD_WGH_SN_3
			      , MAX(GRD_CD_4)           AS GRD_CD_4
			      , SUM(GRD_QNTT_4)         AS GRD_QNTT_4
			      , MAX(GRD_WRHSNO_4)       AS GRD_WRHSNO_4
			      , MAX(GRD_WGH_SN_4)       AS GRD_WGH_SN_4
			   FROM (
			        SELECT X.APC_CD             AS APC_CD
			             , X.WGHNO              AS WGHNO
			             , X.WGH_YMD            AS WGH_YMD
			             , X.VHCLNO             AS VHCLNO
			             , X.PRDCR_CD	        AS PRDCR_CD
			             , X.WHOL_WGHT          AS WHOL_WGHT
			             , X.EMPT_VHCL_WGHT     AS EMPT_VHCL_WGHT
			             , X.ITEM_CD            AS ITEM_CD
			             , X.VRTY_CD            AS VRTY_CD
			             , x.FCLT_CD		    AS FCLT_CD
			             , x.WRHS_SPMT_TYPE     AS WRHS_SPMT_TYPE
			             , X.GRD_CD             AS GRD_CD
			             , X.PLT_QNTT           AS PLT_QNTT
			             , X.BX_QNTT            AS BX_QNTT
			             , X.SHPGOT_QNTT        AS SHPGOT_QNTT
                         , x.SHPGOT_WGHT        AS SHPGOT_WGHT
                         , X.SHPGOT_PLT_QNTT    AS SHPGOT_PLT_QNTT
                         , X.OINST_SPMT_NM      AS OINST_SPMT_NM
                         , X.TRSPRT_CST         AS TRSPRT_CST
                         , x.OPRTR_NM           AS OPRTR_NM
                         , X.DRVR_NM            AS DRVR_NM
                         , X.BANK_CD            AS BANK_CD
                         , X.ACTNO              AS ACTNO
                         , X.TELNO              AS TELNO
                         , X.WRHSNO				AS WRHSNO
			             , CASE WHEN X.GRD_RANK = 1 THEN X.GRD_CD END AS GRD_CD_1
			             , CASE WHEN X.GRD_RANK = 1 THEN X.BX_QNTT END AS GRD_QNTT_1
			             , CASE WHEN X.GRD_RANK = 1 THEN X.WRHSNO END AS GRD_WRHSNO_1
			             , CASE WHEN X.GRD_RANK = 1 THEN X.WGH_SN END AS GRD_WGH_SN_1
			             , CASE WHEN X.GRD_RANK = 2 THEN X.GRD_CD END AS GRD_CD_2
			             , CASE WHEN X.GRD_RANK = 2 THEN X.BX_QNTT END AS GRD_QNTT_2
			             , CASE WHEN X.GRD_RANK = 2 THEN X.WRHSNO END AS GRD_WRHSNO_2
			             , CASE WHEN X.GRD_RANK = 2 THEN X.WGH_SN END AS GRD_WGH_SN_2
			             , CASE WHEN X.GRD_RANK = 3 THEN X.GRD_CD END AS GRD_CD_3
			             , CASE WHEN X.GRD_RANK = 3 THEN X.BX_QNTT END AS GRD_QNTT_3
			             , CASE WHEN X.GRD_RANK = 3 THEN X.WRHSNO END AS GRD_WRHSNO_3
			             , CASE WHEN X.GRD_RANK = 3 THEN X.WGH_SN END AS GRD_WGH_SN_3
			             , CASE WHEN X.GRD_RANK = 4 THEN X.GRD_CD END AS GRD_CD_4
			             , CASE WHEN X.GRD_RANK = 4 THEN X.BX_QNTT END AS GRD_QNTT_4
			             , CASE WHEN X.GRD_RANK = 4 THEN X.WRHSNO END AS GRD_WRHSNO_4
			             , CASE WHEN X.GRD_RANK = 4 THEN X.WGH_SN END AS GRD_WGH_SN_4

			          FROM (
			                SELECT WC.APC_CD
			                     , WC.WGHNO
			                     , WC.WGH_YMD
			                     , WC.VHCLNO
			                     , WD.WGH_SN
			                     , WD.SPMTNO        AS WRHSNO
			                     , WC.PRDCR_CD
			                     , WC.WHOL_WGHT
			                     , WC.EMPT_VHCL_WGHT
			                     , WC.FCLT_CD
			                     , WC.WRHS_SPMT_TYPE
			                     , WD.GRD_CD
			                     , WD.PLT_QNTT
			                     , WD.BX_QNTT
			                     , GI.ITEM_CD
			                     , GI.VRTY_CD
			                     , SG.GRD_RANK
			                     , WC.SHPGOT_QNTT
			                     , WC.SHPGOT_WGHT
			                     , WC.SHPGOT_PLT_QNTT
			                     , WC.OINST_SPMT_NM
			                     , WC.TRSPRT_CST
			                     , WC.OPRTR_NM
			                     , VI.DRVR_NM
			                     , VI.BANK_CD
			                     , VI.ACTNO
			                     , VI.TELNO
			                  FROM TB_WGH_PRFMNC_COM WC
			                     , TB_WGH_PRFMNC_DTL WD
			                     , TB_SPMT_PRFMNC_COM PC
			                     , TB_SPMT_PRFMNC_DTL PD
			                     , TB_GDS_INVNTR GI
			                     , TB_WRHS_VHCL_INFO VI
			                     , (SELECT RANK() OVER (ORDER BY GRD_CD ASC)       GRD_RANK
			                             , GRD_CD
			                             , APC_CD
			                          FROM TB_APC_STD_GRD_DTL
			                         WHERE APC_CD = #{apcCd}
			                           AND GRD_SE_CD = '03'
			                           AND ITEM_CD = #{itemCd}
			                        ) SG
			                 WHERE WC.APC_CD = WD.APC_CD
			                   AND WC.WGHNO = WD.WGHNO
			                   AND WD.APC_CD = PC.APC_CD
			                   AND WD.SPMTNO = PC.SPMTNO
			                   AND PC.APC_CD = PD.APC_CD
			                   AND PC.SPMTNO = PD.SPMTNO
			                   AND WD.WGH_SN = PD.SPMT_SN
			                   AND PD.APC_CD = GI.APC_CD
			                   AND PD.PCKGNO = GI.PCKGNO
			                   AND PD.PCKG_SN = GI.PCKG_SN
			                   AND WD.APC_CD = SG.APC_CD
			                   AND WD.GRD_CD = SG.GRD_CD
			                   AND WC.APC_CD = VI.APC_CD(+)
			                   AND WC.VHCLNO = VI.VHCLNO(+)
			                   AND WC.DEL_YN = 'N'
			                   AND WD.DEL_YN = 'N'
			                   AND PC.DEL_YN = 'N'
			                   AND PD.DEL_YN = 'N'
			                   AND GI.DEL_YN = 'N'
			                   AND VI.DEL_YN(+) = 'N'
			                   AND WC.APC_CD = #{apcCd}
		]]>
		<if test='itemCd != null and itemCd !=""'>
							   AND GI.ITEM_CD = #{itemCd}
		</if>
		<if test='vrtyCd != null and vrtyCd !=""'>
							   AND GI.VRTY_CD = #{vrtyCd}
		</if>
		<if test='wghYmd != null and wghYmd !=""'>
							   AND WC.WGH_YMD = #{wghYmd}
		</if>
		<if test='prdcrCd != null and prdcrCd !=""'>
							   AND WC.PRDCR_CD = #{prdcrCd}
		</if>
		<if test='fcltCd != null and fcltCd !=""'>
							   AND WC.FCLT_CD = #{fcltCd}
		</if>
		<if test='wrhsSpmtType != null and wrhsSpmtType !=""'>
							   AND WC.WRHS_SPMT_TYPE = #{wrhsSpmtType}
		</if>
		<![CDATA[
			                ) X
			  ) Y
			 GROUP BY Y.APC_CD, Y.WGHNO, Y.WGH_YMD, Y.VHCLNO, Y.PRDCR_CD, Y.ITEM_CD, Y.VRTY_CD, Y.FCLT_CD, Y.WRHS_SPMT_TYPE
			 ORDER BY Y.WGHNO DESC
		]]>
	</select>
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghRcptList		-->
	<!-- DESC : 계량접수등록 목록 조회.		                             			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.10.30  	김호        		Initial Creation                        -->
	<!-- ==========================================================================	-->
	<select id="selectMultiWghPrfmncList" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO" resultType="hashmap">
		SELECT
			 pt0.*
			 ,(SELECT FN_GET_ITEM_NM(pt0.ITEM_CD, pt0.APC_CD) FROM DUAL) AS ITEM_NM
			 ,(SELECT FN_GET_VRTY_NM(pt0.ITEM_CD, pt0.VRTY_CD, pt0.APC_CD) FROM DUAL) AS VRTY_NM
			 ,(SELECT FN_GET_PRDCR_NM(pt0.PRDCR_CD, pt0.APC_CD) FROM DUAL) AS PRDCR_NM
		FROM(SELECT
				   MAX(WPD.APC_CD) AS APC_CD
				  ,MAX(WPD.WRHSNO) AS WRHSNO
				  ,WPD.WGHNO AS WGHNO
				  ,MAX(RMWP.WRHS_YMD) AS WRHS_YMD
				  ,MAX(RMI.ITEM_CD) AS ITEM_CD
				  ,MAX(RMI.VRTY_CD) AS VRTY_CD
				  ,MAX(RMI.PRDCR_CD) AS PRDCR_CD
				  ,MAX(PI.PLOR_CD) AS PLOR_CD
		          ,MAX(PI.PRDCR_IDENTNO) AS PRDCR_IDENTNO
				  ,MAX(WPC.VHCLNO) AS VHCLNO
				  ,MAX(WPC.WHOL_WGHT) AS WHOL_WGHT
				  ,MAX(WPC.EMPT_VHCL_WGHT) AS EMPT_VHCL_WGHT
				  ,MAX(WPC.WRHS_WGHT) AS WRHS_WGHT
				  ,LISTAGG(WPD.BX_QNTT, ',') WITHIN GROUP (ORDER BY WPD.GRD_CD) AS BX_QNTT
				  ,LISTAGG(WPD.GRD_CD, ',') WITHIN GROUP (ORDER BY WPD.GRD_CD) AS GRD_CD
				  ,MAX(WPD.PLT_QNTT) AS PLT_QNTT
				  ,MAX(WPC.RMRK) AS RMRK
				  ,MAX((SELECT FN_GET_COM_CD_VL_NM('STD_PLOR_CD', PI.PLOR_CD) FROM DUAL)) AS PLOR_NM
			 FROM
				 usram.TB_WGH_PRFMNC_COM AS WPC
					 JOIN usram.TB_WGH_PRFMNC_DTL AS WPD
						  ON WPC.APC_CD  = WPD.APC_CD
							  AND WPC.WGHNO = WPD.WGHNO
							  AND WPC.APC_CD = #{apcCd}
					<if test='wghYmd != null and wghYmd !=""'>
							  AND WPC.WGH_YMD = #{wghYmd}
					</if>
					<if test=' wghYmdFrom != null and wghYmdFrom !="" and wghYmdTo != null and wghYmdTo !="" '>
							  AND WPC.WGH_YMD BETWEEN #{wghYmdFrom} AND #{wghYmdTo}
					</if>
							  AND WPC.DEL_YN = 'N'
							  AND WPD.DEL_YN = 'N'
					 JOIN usram.TB_RAW_MTR_WRHS_PRFMNC AS RMWP
						  ON WPD.APC_CD = RMWP.APC_CD
							  AND WPD.WRHSNO = RMWP.WRHSNO
							  AND RMWP.DEL_YN = 'N'
					 JOIN usram.TB_RAW_MTR_INVNTR AS RMI
						  ON RMWP.APC_CD = RMI.APC_CD
							  AND RMWP.WRHSNO = RMI.WRHSNO
							  AND RMI.DEL_YN = 'N'
					<if test='itemCd != null and itemCd !=""'>
							  AND RMI.ITEM_CD = #{itemCd}
					</if>
					<if test='prdcrCd != null and prdcrCd !=""'>
							  AND RMI.PRDCR_CD = #{prdcrCd}
					</if>
					 JOIN usram.TB_PRDCR_INFO AS PI
						  ON RMI.APC_CD = PI.APC_CD
							  AND RMI.PRDCR_CD = PI.PRDCR_CD
							  AND PI.DEL_YN = 'N'
			GROUP BY WPD.WGHNO
			) AS pt0
		WHERE 1=1
		<if test='plorNm != null and plorNm != ""'>
			AND pt0.PLOR_NM LIKE '%' || #{plorNm} || '%'
		</if>
		<if test='vhclno != null and vhclno != ""'>
			AND pt0.VHCLNO LIKE '%' || #{vhclno} || '%'
		</if>

	</select>
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghFclt			-->
	<!-- DESC : 계량대 목록 조회.		 		                            			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.12.04  	손민성        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<select id="selectWghFclt" parameterType="com.at.apcss.am.wgh.vo.WghFcltVO" resultType="com.at.apcss.am.wgh.vo.WghFcltVO">
		  <![CDATA[
		SELECT /* com.at.apcss.am.cmns.mapper.WghInfoMapper.selectWghFclt */
			  APC_CD AS APC_CD
			 ,FCLT_TYPE AS FCLT_TYPE
			 ,FCLT_CD AS FCLT_CD
			 ,FCLT_NM AS FCLT_NM
			 ,FCLT_EXPLN AS FCLT_EXPLN
			 ,OPRTNG_HR AS OPRTNG_HR
			 ,N_OPRTNG_HR AS N_OPRTNG_HR
			 ,HR_UNIT AS HR_UNIT
			 ,FCLT_CPCT AS FCLT_CPCT
			 ,CPCT_UNIT AS CPCT_UNIT
			 ,WGHT_MIN AS WGHT_MIN
			 ,WGHT_MAX AS WGHT_MAX
			 ,WGHT_UNIT AS WGHT_UNIT
			 ,PRCS_NMTM AS PRCS_NMTM
			 ,BGNG_YMD AS BGNG_YMD
			 ,END_YMD AS END_YMD
			 ,FCLT_RMRK AS FCLT_RMRK
			 ,SYS_LAST_CHG_DT AS SYS_LAST_CHG_DT
		FROM TB_OPRTNG_APC_FCLT
		WHERE APC_CD = #{apcCd}
			AND FCLT_TYPE = 'WGH_FCLT_CD'
		  	AND DEL_YN = 'N'
		]]>
		<if test=' fcltCd != null and fcltCd !=""'>
			AND FCLT_CD = #{fcltCd}
		</if>
	</select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.insertWghVhcl		-->
	<!-- DESC : 원물입차등록.		                             				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.10.22  	박승진        		Initial Creation                        -->
	<!-- ==========================================================================	-->
	<insert id="insertWghVhcl" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		<![CDATA[
			INSERT INTO TB_WGH_HSTRY
			   (APC_CD
				, FCLT_CD
				, PRCS_CMPTN_DT
				, PRCS_CMPTN_YN
				, PRCS_TASK_CD
				, VHCLNO
				, WGHNO
				, WGH_DT
				, WGH_RMRK
				, WGH_SEQ
				, WGH_SE_CD
				, WGH_WGHT
				, DEL_YN
				, SYS_FRST_INPT_DT
				, SYS_FRST_INPT_PRGRM_ID
				, SYS_FRST_INPT_USER_ID
				, SYS_LAST_CHG_DT
				, SYS_LAST_CHG_PRGRM_ID
				, SYS_LAST_CHG_USER_ID
			    )VALUES(
			    #{apcCd}
				, #{fcltCd}
				, #{prcsCmptnDt}
				, 'N'
				, #{prcsTaskCd}
				, #{vhclno}
				, #{wghno}
				, TO_DATE(#{wghDt},'YYYYMMDDHH24MISS')
				, #{wghRmrk}
				, #{wghSeq}
				, #{wghSeCd}
				, #{wghWght}
				, 'N'
				, SYSDATE
				, #{sysFrstInptPrgrmId}
				, #{sysFrstInptUserId}
				, SYSDATE
				, #{sysLastChgPrgrmId}
				, #{sysLastChgUserId}
			    )

		]]>
	</insert>
    <insert id="insertUpdateInspList" parameterType="list">
		MERGE INTO TB_WGH_INSP_PRFMNC WIP
			USING (
				<foreach collection="list" item="item" index="index" separator="UNION">
					SELECT
						#{item.apcCd} AS APC_CD,
						#{item.wghno} AS WGHNO,
						#{item.itemCd} AS ITEM_CD,
						#{item.vrtyCd} AS VRTY_CD,
						#{item.grdCd} AS GRD_CD,
						#{item.grdVl} AS GRD_VL,
						#{item.sysLastChgUserId} AS SYS_LAST_CHG_USER_ID,
						#{item.sysLastChgPrgrmId} AS SYS_LAST_CHG_PRGRM_ID,
						#{item.sysFrstInptUserId} AS SYS_FRST_INPT_USER_ID,
						#{item.sysFrstInptPrgrmId} AS SYS_FRST_INPT_PRGRM_ID
					FROM DUAL
				</foreach>
				) source
			ON (
					WIP.APC_CD = source.APC_CD
				AND WIP.WGHNO = source.WGHNO
				AND WIP.ITEM_CD = source.ITEM_CD
				AND WIP.VRTY_CD = source.VRTY_CD
				AND WIP.GRD_CD = source.GRD_CD
				)
		WHEN MATCHED THEN
			UPDATE SET
				GRD_VL = source.GRD_VL,
				SYS_LAST_CHG_DT = SYSDATE,
				SYS_LAST_CHG_USER_ID = source.SYS_LAST_CHG_USER_ID,
				SYS_LAST_CHG_PRGRM_ID = source.SYS_LAST_CHG_PRGRM_ID
		WHEN NOT MATCHED THEN
			INSERT (
				APC_CD,
				WGHNO,
				ITEM_CD,
				VRTY_CD,
				GRD_CD,
				GRD_VL,
				SYS_FRST_INPT_DT,
				SYS_FRST_INPT_USER_ID,
				SYS_FRST_INPT_PRGRM_ID,
				SYS_LAST_CHG_DT,
				SYS_LAST_CHG_USER_ID,
				SYS_LAST_CHG_PRGRM_ID
				   )
			VALUES (
				source.APC_CD,
				source.WGHNO,
				source.ITEM_CD,
				source.VRTY_CD,
				source.GRD_CD,
				source.GRD_VL,
				SYSDATE,
				source.SYS_FRST_INPT_USER_ID,
				source.SYS_FRST_INPT_PRGRM_ID,
				SYSDATE,
				source.SYS_LAST_CHG_USER_ID,
				source.SYS_LAST_CHG_PRGRM_ID
				   )
	</insert>
	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.mergeWghHstry			-->
	<!-- DESC : 계량이력 생성.				                             				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2025.02.20  	손민성        		Initial Creation                        -->
	<!-- ==========================================================================	-->
	<insert id="mergeWghHstry" parameterType="list">
		MERGE INTO TB_WGH_HSTRY WH
			USING (
				 <foreach collection="list" item="item" index="index" separator="UNION">
					  SELECT
					  #{item.apcCd} AS APC_CD,
					  #{item.wghno} AS WGHNO,
					  #{item.wghSeq} AS WGH_SEQ,
					  #{item.vhclno} AS VHCLNO,
					  #{item.wghSeCd} AS WGH_SE_CD,
					  #{item.wghWght} AS WGH_WGHT,
					  #{item.wghDt} AS WGH_DT,
					  #{item.prcsTaskCd} AS PRCS_TASK_CD,
					  #{item.prcsCmptnDt} AS PRCS_CMPTN_DT,
					  #{item.prcsCmptnYn} AS PRCS_CMPTN_YN,
					  #{item.wghRmrk} AS WGH_RMRK,
					  #{item.fcltCd} AS FCLT_CD,
					  #{item.sysLastChgUserId} AS SYS_LAST_CHG_USER_ID,
					  #{item.sysLastChgPrgrmId} AS SYS_LAST_CHG_PRGRM_ID,
					  #{item.sysFrstInptUserId} AS SYS_FRST_INPT_USER_ID,
					  #{item.sysFrstInptPrgrmId} AS SYS_FRST_INPT_PRGRM_ID
					  FROM DUAL
				 </foreach>
				 ) src
			ON (
					WH.APC_CD = src.APC_CD
				AND WH.WGHNO = src.WGHNO
				AND WH.WGH_SEQ = src.WGH_SEQ
				AND WH.VHCLNO = src.VHCLNO
				AND WH.WGH_SE_CD = src.WGH_SE_CD
				AND DEL_YN = 'N'
			   )
		WHEN MATCHED THEN
			UPDATE SET
				WGH_WGHT = src.WGH_WGHT,
			    WGH_DT = TO_DATE(src.WGH_DT, 'YYYYMMDDHH24MI'),
				SYS_LAST_CHG_DT = SYSDATE,
				SYS_LAST_CHG_USER_ID = src.SYS_LAST_CHG_USER_ID,
				SYS_LAST_CHG_PRGRM_ID = src.SYS_LAST_CHG_PRGRM_ID
		WHEN NOT MATCHED THEN
			INSERT (
					  APC_CD,
					  WGHNO,
					  WGH_SEQ,
					  VHCLNO,
					  WGH_SE_CD,
					  WGH_WGHT,
					  WGH_DT,
					  PRCS_TASK_CD,
					  PRCS_CMPTN_DT,
					  PRCS_CMPTN_YN,
					  WGH_RMRK,
					  FCLT_CD,
					  DEL_YN,
					  SYS_FRST_INPT_DT,
					  SYS_FRST_INPT_USER_ID,
					  SYS_FRST_INPT_PRGRM_ID,
					  SYS_LAST_CHG_DT,
					  SYS_LAST_CHG_USER_ID,
					  SYS_LAST_CHG_PRGRM_ID
				   )
			VALUES (
					  src.APC_CD,
					  src.WGHNO,
					  src.WGH_SEQ,
					  src.VHCLNO,
					  src.WGH_SE_CD,
					  src.WGH_WGHT,
					  TO_DATE(src.WGH_DT, 'YYYYMMDDHH24MI'),
					  src.PRCS_TASK_CD,
					  src.PRCS_CMPTN_DT,
			          'N',
					  src.WGH_RMRK,
					  src.FCLT_CD,
					  'N',
					  SYSDATE,
					  src.SYS_FRST_INPT_USER_ID,
					  src.SYS_FRST_INPT_PRGRM_ID,
					  SYSDATE,
					  src.SYS_LAST_CHG_USER_ID,
					  src.SYS_LAST_CHG_PRGRM_ID
					)
	</insert>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.updateWghVhcl		-->
	<!-- DESC : 원물입차수정.		                             				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.10.22  	박승진        		Initial Creation                        -->
	<!-- ==========================================================================	-->
	<update id="updateWghVhcl" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		<![CDATA[
			UPDATE TB_WGH_HSTRY SET
			FCLT_CD = #{fcltCd}
			, VHCLNO = #{vhclno}
			, WGH_DT = TO_DATE(#{wghDt},'YYYYMMDDHH24MISS')
			, WGH_RMRK = #{wghRmrk}
			, WGH_WGHT = #{wghWght}
		  WHERE WGHNO = #{wghno}
		  	AND APC_CD = #{apcCd}
		  	AND WGH_SE_CD = #{wghSeCd}

		]]>
	</update>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.deleteWghVhcl		-->
	<!-- DESC : 원물입차삭제.		                             				-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.10.22  	박승진        		Initial Creation                        -->
	<!-- ==========================================================================	-->
	<delete id="deleteWghVhcl" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		<![CDATA[
		  DELETE FROM TB_WGH_HSTRY
		  WHERE WGHNO = #{wghno}
		  	AND APC_CD = #{apcCd}
		  ]]>
	  	<if test='wghSeCd != null and wghSeCd !=""'>
			  AND WGH_SE_CD = #{wghSeCd}
		</if>

	</delete>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghVhclList			-->
	<!-- DESC : 원물입차조회.		 		                            			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.12.04  	박승진        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<select id="selectWghVhclList" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO" resultType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		  <![CDATA[
		SELECT *
		 FROM
		(SELECT /* com.at.apcss.am.cmns.mapper.WghInfoMapper.selectWghVhclList */
					MAX(APC_CD) AS APC_CD,
				    WGHNO,
				    VHCLNO,
				    MAX(CASE WHEN WGH_SE_CD = '01' OR WGH_SE_CD = '11' THEN TO_CHAR(WGH_DT,'YYYYMMDDHH24MISS') END) AS ENTR_TM,
				    MAX(CASE WHEN WGH_SE_CD = '02' OR WGH_SE_CD = '12' THEN TO_CHAR(WGH_DT,'YYYYMMDDHH24MISS') END) AS OUT_TM,
				    MAX(CASE WHEN WGH_SE_CD = '01' OR WGH_SE_CD = '11' THEN WGH_WGHT END) AS ENTR_WGHT,
				    MAX(CASE WHEN WGH_SE_CD = '02' OR WGH_SE_CD = '12' THEN WGH_WGHT END) AS OUT_WGHT,
				    MAX(WGH_RMRK) AS WGH_RMRK,
				    MAX(FCLT_CD) AS FCLT_CD
				    , MAX(PRCS_TASK_CD) AS PRCS_TASK_CD
				    , MAX(PRCS_CMPTN_DT) AS PRCS_CMPTN_DT
				    , MAX(PRCS_CMPTN_YN) AS PRCS_CMPTN_YN
				FROM
				    TB_WGH_HSTRY
				WHERE 1=1
				  AND APC_CD = #{apcCd}
				  AND DEL_YN = 'N'
				  ]]>
				  <if test='wghSeCd == "01"'>
					  AND WGH_SE_CD IN ('01','02')
				  </if>
				  <if test='wghSeCd == "02"'>
					  AND WGH_SE_CD IN ('11','12')
				  </if>
				  <if test=' vhclno != null and vhclno !=""'>
					  AND VHCLNO LIKE '%' || #{vhclno} || '%'
				  </if>

				  <if test=' fcltCd != null and fcltCd !=""'>
					  AND FCLT_CD = #{fcltCd}
				   </if>


				GROUP BY
				    WGHNO, VHCLNO) X,

					(SELECT
						  WC.APC_CD		    AS APC_CD
						, WC.WGHNO		    AS WGHNO
						, WD.WGH_SN			AS WGH_SN
						, WD.WRHSNO		    AS WRHSNO
						, WC.WGH_YMD        AS WGH_YMD
						, WC.VHCLNO         AS VHCLNO
						, WC.PRDCR_CD	    AS PRDCR_CD
						, (SELECT FN_GET_PRDCR_NM(WC.PRDCR_CD,WC.APC_CD) FROM DUAL)	    AS PRDCR_NM
						, WC.WHOL_WGHT      AS WHOL_WGHT
						, WC.EMPT_VHCL_WGHT AS EMPT_VHCL_WGHT
						, WC.RDCD_RT        AS RDCD_RT
						, WC.RDCD_WGHT      AS RDCD_WGHT
						, WC.WRHS_WGHT      AS WRHS_WGHT
						, WC.RMRK           AS RMRK
		                , WD.GRD_CD         AS GRD_CD
		                , WD.PLT_KND		AS PLT_KND
						, WD.PLT_WGHT       AS PLT_WGHT
						, WD.BX_KND			AS BX_KND
		                , WD.BX_QNTT        AS BX_QNTT
						, WD.BX_WGHT        AS BX_WGHT
						, WP.WRHS_WGHT		AS INVNTR_WGHT
						, INV.WAREHOUSE_SE_CD   AS WAREHOUSE_SE_CD
						, INV.ITEM_CD       AS ITEM_CD
						, INV.VRTY_CD       AS VRTY_CD
						, (SELECT FN_GET_ITEM_NM(INV.ITEM_CD,WC.APC_CD) FROM DUAL)	    AS ITEM_NM
						, (SELECT FN_GET_VRTY_NM(INV.ITEM_CD,INV.VRTY_CD ,WC.APC_CD) FROM DUAL)	    AS VRTY_NM
						, INV.GDS_SE_CD     AS GDS_SE_CD
						, INV.WRHS_SE_CD    AS WRHS_SE_CD
						, INV.TRSPRT_SE_CD  AS TRSPRT_SE_CD
						, (SELECT FN_GET_GRD_NM_RAWMTR(WC.APC_CD, INV.ITEM_CD, WD.GRD_CD) FROM DUAL) AS GRD_NM
		                , (SELECT FN_GET_COM_CD_VL_NM('WAREHOUSE_SE_CD', INV.WAREHOUSE_SE_CD, WC.APC_CD) FROM DUAL) AS WAREHOUSE_SE_NM
						, (SELECT FN_GET_COM_CD_VL_NM('GDS_SE_CD', INV.GDS_SE_CD) FROM DUAL) AS GDS_SE_NM
						, (SELECT FN_GET_COM_CD_VL_NM('WRHS_SE_CD', INV.WRHS_SE_CD) FROM DUAL) AS WRHS_SE_NM
						, (SELECT FN_GET_COM_CD_VL_NM('TRSPRT_SE_CD', INV.TRSPRT_SE_CD) FROM DUAL) AS TRSPRT_SE_NM
						, INV.PRDCTN_YR		AS PRDCTN_YR
						, WC.FCLT_CD		AS FCLT_CD
						, WC.WRHS_SPMT_TYPE AS WRHS_SPMT_TYPE
					  FROM
					  	  TB_WGH_PRFMNC_COM WC
					  	, TB_WGH_PRFMNC_DTL WD
						, TB_RAW_MTR_WRHS_PRFMNC WP
						, TB_RAW_MTR_INVNTR INV
					 WHERE WC.APC_CD = WD.APC_CD
					   AND WC.WGHNO = WD.WGHNO
					   AND WC.APC_CD = WP.APC_CD
					   AND WC.WGHNO = WP.WGHNO
					   AND WD.WRHSNO = WP.WRHSNO
					   AND WP.APC_CD = INV.APC_CD
					   AND WP.WRHSNO = INV.WRHSNO
					   AND WC.DEL_YN = 'N'
					   AND WD.DEL_YN = 'N'
					   AND WP.DEL_YN = 'N'
					   AND INV.DEL_YN = 'N'
					   ) Y
		WHERE 1=1
			AND X.APC_CD = Y.APC_CD(+)
			AND X.WGHNO = Y.WGHNO(+)
			<if test=' wghYmd != null and wghYmd !=""'>
  				AND X.ENTR_TM LIKE #{wghYmd} || '%'
			</if>



	</select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghVhcl			-->
	<!-- DESC : 원물입차 단건조회.		 		                            			-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.12.04  	박승진        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<select id="selectWghVhcl" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO" resultType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		  <![CDATA[
		SELECT /* com.at.apcss.am.cmns.mapper.WghInfoMapper.selectWghVhcl */
			 *
		FROM TB_WGH_HSTRY
		WHERE APC_CD = #{apcCd}
		  	AND DEL_YN = 'N'
				AND WGH_SE_CD = #{wghSeCd}
		  	AND WGHNO = #{wghno}
		]]>

	</select>

	<select id="selectWghInspPrfmncList" resultType="com.at.apcss.am.wgh.vo.WghInspPrfmncVO">
		SELECT  /* com.at.apcss.am.cmns.mapper.WghInfoMapper.selectWghInspPrfmncList */
			 APC_CD AS APC_CD
			,WGHNO AS WGHNO
			,ITEM_CD AS ITEM_CD
			,VRTY_CD AS VRTY_CD
			,GRD_CD AS GRD_CD
			,GRD_VL AS GRD_VL
		FROM TB_WGH_INSP_PRFMNC
		WHERE
			APC_CD = #{apcCd}
		AND WGHNO = #{wghno}
		AND ITEM_CD = #{itemCd}
	</select>

	<delete id="deleteWghInspPrfmncList" parameterType="java.util.List">
		DELETE FROM TB_WGH_INSP_PRFMNC
		WHERE
		<foreach collection="list" item="vo" open="(" separator="OR" close=")">
			(APC_CD = #{vo.apcCd}
			AND WGHNO = #{vo.wghno}
			AND ITEM_CD = #{vo.itemCd}
			AND VRTY_CD = #{vo.vrtyCd}
			AND GRD_CD = #{vo.grdCd})
		</foreach>
	</delete>

	<select id="selectWghHstryList" parameterType="com.at.apcss.am.wgh.vo.WghHstryVO" resultType="com.at.apcss.am.wgh.vo.WghHstryVO">
		SELECT
			 APC_CD AS APC_CD
			,WGHNO AS WGHNO
			,WGH_SEQ AS WGH_SEQ
			,VHCLNO AS VHCLNO
			,WGH_SE_CD AS WGH_SE_CD
			,WGH_WGHT AS WGH_WGHT
			,WGH_DT AS WGH_DT
			,PRCS_TASK_CD AS PRCS_TASK_CD
			,PRCS_CMPTN_DT AS PRCS_CMPTN_DT
			,PRCS_CMPTN_YN AS PRCS_CMPTN_YN
			,WGH_RMRK AS WGH_RMRK
			,DEL_YN AS DEL_YN
			,FCLT_CD AS FCLT_CD
		FROM
			TB_WGH_HSTRY
		WHERE
			APC_CD = #{apcCd}
		AND	WGHNO = #{wghno}
		ORDER BY WGH_SE_CD
	</select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghPrfmncListForSpmtReg	-->
	<!-- DESC : 출하실적등록(계량) - 계량목록 조회		                             	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2025.02.25  	유민지        		Initial Creation                        -->
	<!-- ==========================================================================	-->
	<select id="selectWghPrfmncListForSpmtReg" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO" resultType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		<![CDATA[
			SELECT  /* com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghPrfmncListForSpmtReg */
			    pt0.*
				,(pt0.WHOL_WGHT - pt0.EMPT_VHCL_WGHT) AS ACTL_WGHT
				,(SELECT FN_GET_PRDCR_NM(pt0.PRDCR_CD, pt0.APC_CD) FROM DUAL) AS PRDCR_NM
				,ROUND((pt0.WHOL_WGHT - pt0.EMPT_VHCL_WGHT) * ((100 - NVL(RDCD_RT, 0)) / 100), 0) AS ACPTN_WGHT
				,(SELECT FN_GET_CNPT_NM(pt0.CNPT_CD, pt0.APC_CD) FROM DUAL)   AS CNPT_NM
     			,(SELECT X.DRVR_NM FROM TB_WRHS_VHCL_INFO X WHERE X.APC_CD = pt0.APC_CD AND X.VHCLNO = pt0.VHCLNO) AS DRVR_NM
			FROM
			    (SELECT
					 WPC.APC_CD					AS APC_CD
					,WPC.WGHNO					AS WGHNO
					,MAX(WPC.WGH_YMD)			AS WGH_YMD
					,MAX(WPC.VHCLNO)			AS VHCLNO
					,MAX(WPC.RMRK)				AS RMRK
			     	,MAX(WPC.WHOL_WGHT)			AS WHOL_WGHT
			     	,MAX(WPC.EMPT_VHCL_WGHT)	AS EMPT_VHCL_WGHT
			     	,MAX(WPC.PRDCR_CD) 			AS PRDCR_CD
			     	,MAX(WPC.RDCD_RT)			AS RDCD_RT
			     	,SUM(WPD.BX_QNTT)           AS BX_QNTT
	           		,SUM(WPD.BX_WGHT)           AS BX_WGHT
	           		,SUM(WPD.PLT_QNTT)			AS PLT_QNTT

			     	,MAX(WPD.CNPT_CD)		    AS CNPT_CD
				  	,MAX(WPD.ITEM_CD)		    AS ITEM_CD
				  	,MAX(WPD.VRTY_CD)		    AS VRTY_CD

				 FROM
					 TB_WGH_PRFMNC_COM WPC
					 JOIN TB_WGH_PRFMNC_DTL WPD
				     ON WPD.APC_CD = WPC.APC_CD
					 AND WPD.WGHNO = WPC.WGHNO
				 WHERE
				     	WPD.DEL_YN = 'N'
					AND WPC.DEL_YN = 'N'
				   	AND WPD.SPMTNO IS NULL
				   	AND WPC.APC_CD = #{apcCd}
				   	AND WPC.WGH_YMD = #{wghYmd}
				   	AND WPC.WRHS_SPMT_TYPE = 'DT'

		]]>
				<if test='vhclno != null and vhclno !=""'>
					AND WPC.VHCLNO LIKE '%' || #{vhclno} || '%'
				</if>
				<if test='wghno != null and wghno !=""'>
					AND WPD.WGHNO LIKE '%' || #{wghno} || '%'
				</if>
		<![CDATA[

				 GROUP BY WPC.APC_CD, WPC.WGHNO

			    ) pt0
		]]>
	</select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghInfoForSpmtReg	-->
	<!-- DESC : 출하실적등록(계량) - 계량정보 조회		                             	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2025.02.25  	유민지        		Initial Creation                        -->
	<!-- ==========================================================================	-->

	<select id="selectWghInfoForSpmtReg" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO" resultType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		<![CDATA[
		SELECT
			WPC.APC_CD 				AS APC_CD
			 ,WPC.WGH_YMD 			AS WGH_YMD
			 ,WPC.WGHNO				AS WGHNO
			 ,WPC.VHCLNO 			AS VHCLNO
			 ,WPC.RMRK 				AS RMRK
			 ,WPC.WHOL_WGHT 		AS WHOL_WGHT
			 ,WPC.EMPT_VHCL_WGHT 	AS EMPT_VHCL_WGHT
			 ,WPC.RDCD_RT 			AS RDCD_RT
			 ,WPC.WRHS_WGHT 		AS WRHS_WGHT
			 ,WPC.WRHS_SPMT_TYPE 	AS WRHS_SPMT_TYPE
			 ,WPC.SHPGOT_QNTT 		AS SHPGOT_QNTT
			 ,WPC.SHPGOT_WGHT 		AS SHPGOT_WGHT
			 ,WPC.SHPGOT_PLT_QNTT 	AS SHPGOT_PLT_QNTT
			 ,WPC.TRSPRT_CST 		AS TRSPRT_CST
			 ,WPD.PLT_QNTT 			AS PLT_QNTT
			 ,WVI.DRVR_NM 			AS DRVR_NM
		FROM
			TB_WGH_PRFMNC_COM WPC
			LEFT JOIN TB_WGH_PRFMNC_DTL WPD
			ON WPC.APC_CD = WPD.APC_CD
			AND WPC.WGHNO = WPD.WGHNO
			AND WPC.DEL_YN = WPD.DEL_YN
			AND WPC.APC_CD = #{apcCd}

			LEFT JOIN TB_WRHS_VHCL_INFO WVI
			ON WPC.APC_CD = WVI.APC_CD
			AND WPC.VHCLNO = WVI.VHCLNO
		WHERE
			WPC.DEL_YN = 'N'
		    AND WPD.DEL_YN = 'N'
		]]>
		  <if test='wghno != null and wghno !=""'>
			AND WPC.WGHNO = #{wghno}
		  </if>
		  <if test='wghYmd != null and wghYmd !=""'>
			AND WPC.WGH_YMD = #{wghYmd}
		  </if>
	</select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectInvntrListForSpmtReg	-->
	<!-- DESC : 출하실적등록(계량) - 재고조회		                             	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2025.02.27  	유민지        		Initial Creation                        -->
	<!-- ==========================================================================	-->
	<select id="selectInvntrListForSpmtReg" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO" resultType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		SELECT *
		FROM (
		<![CDATA[
				SELECT  /* com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectInvntrDtlListForSpmtReg */
							pt0.*
							 ,(SELECT FN_GET_GDS_NM(pt0.GDS_CD,pt0.APC_CD) FROM DUAL) 							AS GDS_NM
							 ,(SELECT FN_GET_ITEM_NM(pt0.ITEM_CD, pt0.APC_CD) FROM DUAL) 						AS ITEM_NM
							 ,(SELECT FN_GET_VRTY_NM(pt0.ITEM_CD, pt0.VRTY_CD, pt0.APC_CD) FROM DUAL) 			AS VRTY_NM
							 ,(SELECT FN_GET_GRD_NM_GDS(pt0.APC_CD, pt0.ITEM_CD, pt0.GDS_GRD) FROM DUAL) 		AS GRD_NM
							 ,(SELECT FN_GET_SPCFCT_NM(pt0.ITEM_CD, pt0.SPCFCT_CD, pt0.APC_CD) FROM DUAL) 		AS SPCFCT_NM
							 ,(SELECT FN_GET_SPMT_PCKG_UNIT_NM(pt0.SPMT_PCKG_UNIT_CD, pt0.APC_CD) FROM DUAL) 	AS SPMT_PCKG_UNIT_NM
							 ,(SELECT FN_GET_PRDCR_NM(pt0.RPRS_PRDCR_CD, pt0.APC_CD) FROM DUAL) 				AS PRDCR_NM
							 ,(SELECT FN_GET_COM_CD_VL_NM('WAREHOUSE_SE_CD', pt0.WAREHOUSE_SE_CD, pt0.APC_CD) FROM DUAL) AS WAREHOUSE_SE_NM
				FROM
					(
						SELECT
								 MAX(GI.APC_CD)					AS APC_CD
								,MAX(GI.PCKG_YMD)				AS PCKG_YMD
								,GI.RPRS_PRDCR_CD				AS RPRS_PRDCR_CD
								,GI.ITEM_CD						AS ITEM_CD
								,GI.VRTY_CD						AS VRTY_CD
								,GI.SPCFCT_CD					AS SPCFCT_CD
								,GI.GDS_GRD						AS GDS_GRD
								,MAX(GI.GDS_CD)		    		AS GDS_CD
								,MAX(GI.GDS_SE_CD)      		AS GDS_SE_CD
								,GI.SPMT_PCKG_UNIT_CD  			AS SPMT_PCKG_UNIT_CD
								,GI.WAREHOUSE_SE_CD				AS WAREHOUSE_SE_CD
								,SUM(GI.INVNTR_QNTT)			AS INVNTR_QNTT
								,SUM(GI.INVNTR_WGHT)			AS INVNTR_WGHT
						     	,SUM(GI.PCKG_QNTT)				AS PCKG_QNTT
			    				,SUM(GI.PCKG_WGHT)				AS PCKG_WGHT
								,MAX(SI.GRD_CD) 				AS SORT_GRD_CD

						FROM TB_GDS_INVNTR GI
							,TB_SORT_INVNTR SI
						WHERE GI.DEL_YN = 'N'
						AND GI.APC_CD = SI.APC_CD
						AND GI.PCKG_SORTNO = SI.SORTNO
						AND GI.PCKG_SORT_SN = SI.SORT_SN
						AND  GI.APC_CD = #{apcCd}
						AND (GI.INVNTR_QNTT > 0 OR GI.INVNTR_WGHT >0)
	  ]]>
					<if test='warehouseSeCd != null and warehouseSeCd !=""'>
						AND GI.WAREHOUSE_SE_CD = #{warehouseSeCd}
					</if>
					<if test='itemCd != null and itemCd !=""'>
						AND GI.ITEM_CD = #{itemCd}
					</if>
					<if test='vrtyCd != null and vrtyCd !=""'>
						AND GI.VRTY_CD = #{vrtyCd}
					</if>
		<![CDATA[
			 GROUP BY GI.RPRS_PRDCR_CD,GI.ITEM_CD,GI.VRTY_CD,GI.SPCFCT_CD,GI.GDS_GRD,GI.SPMT_PCKG_UNIT_CD,GI.WAREHOUSE_SE_CD

			) pt0
		]]>

		) result
		WHERE result.GDS_NM LIKE '%' || #{gdsNm} || '%'
	</select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectInvntrDtlListForSpmtReg	-->
	<!-- DESC : 출하실적등록(계량) - 재고상세조회		                             	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2025.02.27  	유민지        		Initial Creation                        -->
	<!-- ==========================================================================	-->
	<select id="selectInvntrDtlListForSpmtReg" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO" resultType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		SELECT *
		FROM (
				<![CDATA[
				SELECT  /* com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectInvntrDtlListForSpmtReg */
							pt0.*
							 ,(SELECT FN_GET_GDS_NM(pt0.GDS_CD,pt0.APC_CD) FROM DUAL) 							AS GDS_NM
							 ,(SELECT FN_GET_ITEM_NM(pt0.ITEM_CD, pt0.APC_CD) FROM DUAL) 						AS ITEM_NM
							 ,(SELECT FN_GET_VRTY_NM(pt0.ITEM_CD, pt0.VRTY_CD, pt0.APC_CD) FROM DUAL) 			AS VRTY_NM
							 ,(SELECT FN_GET_GRD_NM_GDS(pt0.APC_CD, pt0.ITEM_CD, pt0.GDS_GRD) FROM DUAL) 		AS GRD_NM
							 ,(SELECT FN_GET_SPCFCT_NM(pt0.ITEM_CD, pt0.SPCFCT_CD, pt0.APC_CD) FROM DUAL) 		AS SPCFCT_NM
							 ,(SELECT FN_GET_SPMT_PCKG_UNIT_NM(pt0.SPMT_PCKG_UNIT_CD, pt0.APC_CD) FROM DUAL) 	AS SPMT_PCKG_UNIT_NM
							 ,(SELECT FN_GET_PRDCR_NM(pt0.RPRS_PRDCR_CD, pt0.APC_CD) FROM DUAL) 				AS PRDCR_NM
							 ,(SELECT FN_GET_COM_CD_VL_NM('WAREHOUSE_SE_CD', pt0.WAREHOUSE_SE_CD, pt0.APC_CD) FROM DUAL) AS WAREHOUSE_SE_NM
						FROM
							(
								SELECT
									GI.APC_CD			AS APC_CD
									,GI.PCKGNO			AS PCKGNO
									,GI.PCKG_YMD		AS PCKG_YMD
									,GI.PCKG_SN			AS PCKG_SN
									,GI.FCLT_CD			AS FCLT_CD
									,GI.RPRS_PRDCR_CD	AS RPRS_PRDCR_CD
									,GI.ITEM_CD			AS ITEM_CD
									,GI.VRTY_CD			AS VRTY_CD
									,GI.SPCFCT_CD		AS SPCFCT_CD
									,GI.GDS_GRD			AS GDS_GRD
									,GI.INVNTR_QNTT		AS INVNTR_QNTT
									,GI.INVNTR_WGHT		AS INVNTR_WGHT
								    ,GI.PCKG_QNTT		AS PCKG_QNTT
								    ,GI.PCKG_WGHT		AS PCKG_WGHT
									,GI.GDS_CD			AS GDS_CD
									,GI.WAREHOUSE_SE_CD AS WAREHOUSE_SE_CD
									,GI.SPMT_PCKG_UNIT_CD AS SPMT_PCKG_UNIT_CD
								FROM TB_GDS_INVNTR GI
								WHERE GI.APC_CD = #{apcCd}
								  AND GI.DEL_YN = 'N'
								  AND (GI.INVNTR_QNTT > 0 OR GI.INVNTR_WGHT >0)
						  ]]>
				<if test='warehouseSeCd != null and warehouseSeCd !=""'>
					AND GI.WAREHOUSE_SE_CD = #{warehouseSeCd}
				</if>
				<if test='itemCd != null and itemCd !=""'>
					AND GI.ITEM_CD = #{itemCd}
				</if>
				<if test='vrtyCd != null and vrtyCd !=""'>
					AND GI.VRTY_CD = #{vrtyCd}
				</if>
				<![CDATA[
					) pt0
				]]>
		) result
		WHERE result.GDS_NM LIKE '%' || #{gdsNm} || '%'


	</select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.updateWghPrfmncDtlSpmtno	-->
	<!-- DESC : 출하실적등록(계량) - 출하등록시 출하번호 update		                             	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2025.03.06  	유민지        		Initial Creation                        -->
	<!-- ==========================================================================	-->
	<update id="updateWghPrfmncDtlSpmtno" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncDtlVO" >
		<![CDATA[
			UPDATE /* com.at.apcss.am.wgh.mapper.WghPrfmncMapper.updateWghPrfmncDtlSpmtno */
				TB_WGH_PRFMNC_DTL
			SET
			 SYS_LAST_CHG_DT 		= SYSDATE
			,SYS_LAST_CHG_USER_ID	= #{sysLastChgUserId}
			,SYS_LAST_CHG_PRGRM_ID 	= #{sysLastChgPrgrmId}
			,SPMTNO = #{spmtno}
			 WHERE APC_CD = #{apcCd}
			   AND WGHNO = #{wghno}
		]]>
	</update>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.deleteWghPrfmncDtlSpmtno	-->
	<!-- DESC : 출하실적등록(계량) - 출하취소		                             	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2025.03.06  	유민지        		Initial Creation                        -->
	<!-- ==========================================================================	-->
	<update id="deleteWghPrfmncDtlSpmtno" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncDtlVO" >
		<![CDATA[
			UPDATE /* com.at.apcss.am.wgh.mapper.WghPrfmncMapper.deleteWghPrfmncDtlSpmtno */
				TB_WGH_PRFMNC_DTL
			SET
				SYS_LAST_CHG_DT 		= SYSDATE
			  ,SYS_LAST_CHG_USER_ID	    = #{sysLastChgUserId}
			  ,SYS_LAST_CHG_PRGRM_ID 	= #{sysLastChgPrgrmId}
			  ,SPMTNO = NULL
			WHERE
			    APC_CD = #{apcCd}
			AND SPMTNO = #{spmtno}
			AND WGHNO = #{wghno}
		]]>
	</update>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghInfoMngSpmtList		-->
	<!-- DESC : 계량관리정보 출고 목록 조회.		                             	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2025.03.18  	유민지        		Initial Creation                        -->
	<!-- ==========================================================================	-->
	<select id="selectWghInfoMngSpmtList" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncVO" resultType="com.at.apcss.am.wgh.vo.WghPrfmncVO">
		<![CDATA[
			SELECT /* com.at.apcss.am.wgh.mapper.WghPrfmncMapper.selectWghInfoMngSpmtList */
			       pt0.*
			     , (SELECT FN_GET_CNPT_NM(pt0.CNPT_CD, pt0.APC_CD) FROM DUAL) 									AS CNPT_NM
			     , (SELECT FN_GET_PRDCR_NM(pt0.PRDCR_CD, pt0.APC_CD) FROM DUAL) 								AS PRDCR_NM
			     , (SELECT FN_GET_ITEM_NM(pt0.ITEM_CD, pt0.APC_CD) FROM DUAL) 									AS ITEM_NM
			     , (SELECT FN_GET_VRTY_NM(pt0.ITEM_CD, pt0.VRTY_CD, pt0.APC_CD) FROM DUAL) 						AS VRTY_NM
			     , (SELECT FN_GET_GRD_NM_RAWMTR(pt0.APC_CD, pt0.ITEM_CD, pt0.GRD_CD) FROM DUAL) 				AS GRD_NM
			     , (SELECT FN_GET_COM_CD_VL_NM('WAREHOUSE_SE_CD', pt0.WAREHOUSE_SE_CD, pt0.APC_CD) FROM DUAL) 	AS WAREHOUSE_SE_NM
			     , pt0.WHOL_WGHT - pt0.EMPT_VHCL_WGHT AS ACTL_WGHT
			     , ROUND((pt0.WHOL_WGHT - pt0.EMPT_VHCL_WGHT) * ((100 - NVL(RDCD_RT, 0)) / 100), 0) AS ACPTN_WGHT
			  FROM (SELECT
			              WC.APC_CD		      AS APC_CD
					   , WC.WGHNO		      AS WGHNO
					   , WD.WGH_SN			  AS WGH_SN
					   , WD.WRHSNO		      AS WRHSNO
					   , WC.WGH_YMD           AS WGH_YMD
					   , WC.VHCLNO            AS VHCLNO
					   , WC.PRDCR_CD	      AS PRDCR_CD
					   , WC.WRHS_SPMT_TYPE	  AS WRHS_SPMT_TYPE
					   , WC.WHOL_WGHT         AS WHOL_WGHT
					   , WC.EMPT_VHCL_WGHT    AS EMPT_VHCL_WGHT
					   , WC.RDCD_RT           AS RDCD_RT
					   , WC.RDCD_WGHT         AS RDCD_WGHT
					   , WC.WRHS_WGHT         AS WRHS_WGHT
					   , WC.RMRK              AS RMRK
					   , WD.GRD_CD            AS GRD_CD
					   , WD.PLT_KND		      AS PLT_KND
					   , WD.PLT_WGHT          AS PLT_WGHT
					   , WD.BX_KND			  AS BX_KND
					   , WD.BX_QNTT           AS BX_QNTT
					   , WD.BX_WGHT           AS BX_WGHT
					   , GI.WAREHOUSE_SE_CD   AS WAREHOUSE_SE_CD
					   , WD.ITEM_CD           AS ITEM_CD
					   , WD.VRTY_CD           AS VRTY_CD
					   , WD.CNPT_CD			  AS CNPT_CD
					   , GI.STRG_LOCTN_CD     AS STRG_LOCTN_CD
					   , SUBSTR(GI.STRG_LOCTN_CD, 1, 1)  AS STRG_LOCTN_ROW
					   , SUBSTR(GI.STRG_LOCTN_CD, 2, 2)  AS STRG_LOCTN_COL
					   , SUBSTR(GI.STRG_LOCTN_CD, 4, 2)  AS STRG_LOCTN_LVL
			          FROM TB_WGH_PRFMNC_COM WC
			             , TB_WGH_PRFMNC_DTL WD
			             , TB_SPMT_PRFMNC_COM PC
                         , TB_SPMT_PRFMNC_DTL PD
			             , TB_GDS_INVNTR GI
			         WHERE WC.APC_CD = WD.APC_CD(+)
                       AND WC.WGHNO = WD.WGHNO(+)
                       AND WD.APC_CD = PC.APC_CD(+)
                       AND WD.SPMTNO = PC.SPMTNO(+)
                       AND WD.APC_CD = PD.APC_CD(+)
                       AND WD.SPMTNO = PD.SPMTNO(+)
                       AND WD.WGH_SN = PD.SPMT_SN(+)
                       AND PD.APC_CD = GI.APC_CD(+)
                       AND PD.PCKGNO = GI.PCKGNO(+)
                       AND PD.PCKG_SN = GI.PCKG_SN(+)
			           AND WC.DEL_YN = 'N'
			           AND WD.DEL_YN(+) = 'N'
			           AND PC.DEL_YN(+) = 'N'
                       AND PD.DEL_YN(+) = 'N'
			           AND GI.DEL_YN(+) = 'N'
		]]>
		<if test='apcCd != null and apcCd !=""'>
			AND WC.APC_CD = #{apcCd}
		</if>
		<if test='itemCd != null and itemCd !=""'>
			AND WD.ITEM_CD = #{itemCd}
		</if>
		<if test='vrtyCd != null and vrtyCd !=""'>
			AND WD.VRTY_CD = #{vrtyCd}
		</if>
		<if test='prdcrCd != null and prdcrCd !=""'>
			AND WC.PRDCR_CD = #{prdcrCd}
		</if>
		<if test='wrhsSpmtType != null and wrhsSpmtType !=""'>
			AND NVL(WC.WRHS_SPMT_TYPE, 'DT') = #{wrhsSpmtType}
		</if>
		<if test='cnptCd != null and cnptCd !=""'>
			AND WD.CNPT_CD = #{cnptCd}
		</if>
		<if test='wghYmdFrom != null and wghYmdFrom !=""'>
			AND WC.WGH_YMD <![CDATA[>=]]> #{wghYmdFrom}
		</if>
		<if test='wghYmdTo != null and wghYmdTo !=""'>
			AND WC.WGH_YMD <![CDATA[<=]]> #{wghYmdTo}
		</if>
		<![CDATA[
			       ) pt0
		]]>
	</select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.insertSpmtWghPrfmncDtl	-->
	<!-- DESC : 계량정보관리 - 출고 계량실적 상세 등록		                            -->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2025.03.19  	유민지        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<insert id="insertSpmtWghPrfmncDtl" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncDtlVO">
    	<![CDATA[
		INSERT /* com.at.apcss.am.wgh.mapper.WghPrfmncMapper.insertSpmtWghPrfmncDtl */
			INTO TB_WGH_PRFMNC_DTL
			(
					APC_CD
					, WGHNO
					, WGH_SN
					, GRD_CD
					, PLTNO
					, PLT_KND
					, PLT_QNTT
					, PLT_WGHT
					, BX_KND
					, BX_QNTT
					, BX_WGHT
					, WRHSNO
					, SPMTNO
					, ITEM_CD
					, VRTY_CD
					, CNPT_CD
					, SYS_FRST_INPT_DT
					, SYS_FRST_INPT_USER_ID
					, SYS_FRST_INPT_PRGRM_ID
					, SYS_LAST_CHG_DT
					, SYS_LAST_CHG_USER_ID
					, SYS_LAST_CHG_PRGRM_ID
			)
		VALUES
			(
					#{apcCd}
					, #{wghno}
					, #{wghSn}
					, #{grdCd}
					, #{pltno}
					, #{pltKnd}
					, #{pltQntt}
					, #{pltWght}
					, #{bxKnd}
					, #{bxQntt}
					, #{bxWght}
					, #{wrhsno}
					, #{spmtno}
					, #{itemCd}
					, #{vrtyCd}
					, #{cnptCd}
					, SYSDATE
					, #{sysFrstInptUserId}
					, #{sysFrstInptPrgrmId}
					, SYSDATE
					, #{sysLastChgUserId}
					, #{sysLastChgPrgrmId}
			)
		]]>
    </insert>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.wgh.mapper.WghPrfmncMapper.updateSpmtWghPrfmncDtl	-->
	<!-- DESC : 계량정보관리 - 출고 계량실적 상세 수정		                            -->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2025.03.19  	유민지	       	Initial Creation                        -->
	<!-- ==========================================================================	-->
	<update id="updateSpmtWghPrfmncDtl" parameterType="com.at.apcss.am.wgh.vo.WghPrfmncDtlVO">
		<![CDATA[
			UPDATE /* com.at.apcss.am.cmns.mapper.CmnsSpcfctMapper.updateSpmtWghPrfmncDtl */
				TB_WGH_PRFMNC_DTL
			SET
			     GRD_CD 					= #{grdCd}
				, PLTNO						= #{pltno}
				, PLT_KND					= #{pltKnd}
				, PLT_QNTT					= #{pltQntt}
				, PLT_WGHT					= #{pltWght}
				, BX_KND					= #{bxKnd}
				, BX_QNTT					= #{bxQntt}
				, BX_WGHT					= #{bxWght}
			  	, WRHSNO					= #{wrhsno}
				, SPMTNO					= #{spmtno}
				, ITEM_CD					= #{itemCd}
				, VRTY_CD					= #{vrtyCd}
				, CNPT_CD					= #{cnptCd}
				, SYS_LAST_CHG_DT 			= SYSDATE
				, SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
				, SYS_LAST_CHG_PRGRM_ID 	= #{sysLastChgPrgrmId}
		]]>
		<if test='delYn != null and delYn != ""'>
			, DEL_YN					= #{delYn}
		</if>
		<![CDATA[

			 WHERE APC_CD 					= #{apcCd}
			   AND WGHNO 					= #{wghno}
			   AND WGH_SN 					= #{wghSn}
		]]>
	</update>
</mapper>