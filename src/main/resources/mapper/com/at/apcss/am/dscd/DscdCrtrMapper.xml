<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!-- ==========================================================================	-->
<!-- NAME : DscdCrtrMapper.xml                                   			-->
<!-- DESC : 폐기기준 mapper                   				                 	-->
<!-- ==========================================================================	-->
<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
<!-- ===========  	============  	===========================================	-->
<!-- 2024.09.21  	신정철        	Initial Creation                            -->
<!-- ==========================================================================	-->

<mapper namespace="com.at.apcss.am.dscd.mapper.DscdCrtrMapper">

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.dscd.mapper.DscdCrtrMapper.selectDscdCrtr		-->
	<!-- DESC : 폐기기준 단건 조회.	                         	             	 	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<select id="selectDscdCrtr" parameterType="com.at.apcss.am.dscd.vo.DscdCrtrVO" resultType="com.at.apcss.am.dscd.vo.DscdCrtrVO">
    	<![CDATA[
		SELECT /* com.at.apcss.am.dscd.mapper.DscdCrtrMapper.selectDscdCrtr */
			CC.APC_CD				AS APC_CD
			 , CC.DSCD_CRTR_TYPE		AS DSCD_CRTR_TYPE
			 , CC.CRTR_CD			AS CRTR_CD
			 , CC.CRTR_VL			AS CRTR_VL
			 , CC.CRTR_INDCT_NM		AS CRTR_INDCT_NM
			 , CC.INDCT_SEQ			AS INDCT_SEQ
			 , CC.USE_YN				AS USE_YN
			 , CC.DEL_YN				AS DEL_YN

			 , (
			SELECT MAX(X.DTL_SN)
			FROM TB_INVNTR_DSCD_CRTR_DTL X
			WHERE X.APC_CD = CC.APC_CD
			  AND X.DSCD_CRTR_TYPE = CC.DSCD_CRTR_TYPE
			  AND X.CRTR_CD = CC.CRTR_CD
		)	AS MAX_DTL_SN

		FROM TB_INVNTR_DSCD_CRTR CC

		WHERE CC.APC_CD = #{apcCd}
		  AND CC.DSCD_CRTR_TYPE = #{dscdCrtrType}
		  AND CC.CRTR_CD = #{crtrCd}
		]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.dscd.mapper.DscdCrtrMapper.selectDscdCrtrList	-->
	<!-- DESC : 폐기기준 목록 조회.	                         	             	 	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<select id="selectDscdCrtrList" parameterType="com.at.apcss.am.dscd.vo.DscdCrtrVO" resultType="com.at.apcss.am.dscd.vo.DscdCrtrVO">
		<![CDATA[
    		SELECT /* com.at.apcss.am.dscd.mapper.DscdCrtrMapper.selectDscdCrtrList */

				  CC.APC_CD				AS APC_CD
				, CC.DSCD_CRTR_TYPE		AS DSCD_CRTR_TYPE
				, CT.CD_VL_NM			AS DSCD_CRTR_TYPE_NM
				, CT.INDCT_SEQ			AS CRTR_TYPE_SEQ
				, CC.CRTR_CD			AS CRTR_CD
				, CC.CRTR_VL			AS CRTR_VL
				, CC.CRTR_INDCT_NM		AS CRTR_INDCT_NM
				, CC.INDCT_SEQ			AS INDCT_SEQ
				, CC.INDCT_SEQ			AS CRTR_SEQ
				, CC.USE_YN				AS USE_YN
				, CC.CRTR_RMRK			AS CRTR_RMRK

			  FROM TB_INVNTR_DSCD_CRTR CC

			  JOIN TB_COM_CD_DTL CT
			    ON CT.CD_ID = 'DSCD_CRTR_TYPE'
			   AND CT.APC_CD = '0000'
			   AND CT.CD_VL = CC.DSCD_CRTR_TYPE
			   AND CT.DEL_YN = 'N'

			 WHERE CC.DEL_YN = 'N'
		]]>

		<if test='apcCd != null and apcCd != ""'>
			AND CC.APC_CD = #{apcCd}
		</if>

		<if test='dscdCrtrType != null and dscdCrtrType != ""'>
			AND CC.DSCD_CRTR_TYPE = #{dscdCrtrType}
		</if>

		<if test='crtrCd != null and crtrCd != ""'>
			AND CC.CRTR_CD = #{crtrCd}
		</if>

		<if test='crtrIndctNm != null and crtrIndctNm != ""'>
			AND CC.CRTR_INDCT_NM LIKE '%' || #{crtrIndctNm} || '%'
		</if>

		<if test='useYn != null and useYn != ""'>
			AND CC.USE_YN = #{useYn}
		</if>

		<![CDATA[
			 ORDER BY CRTR_TYPE_SEQ, CRTR_SEQ
		]]>
	</select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.dscd.mapper.DscdCrtrMapper.selectDscdCrtrDtl		-->
	<!-- DESC : 폐기기준 상세 단건 조회.                       	             	 	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<select id="selectDscdCrtrDtl" parameterType="com.at.apcss.am.dscd.vo.DscdCrtrVO" resultType="com.at.apcss.am.dscd.vo.DscdCrtrVO">
    	<![CDATA[
		SELECT /* com.at.apcss.am.dscd.mapper.DscdCrtrMapper.selectDscdCrtrDtl */
			CD.APC_CD				AS APC_CD
			 , CD.DSCD_CRTR_TYPE		AS DSCD_CRTR_TYPE
			 , CD.CRTR_CD			AS CRTR_CD
			 , CD.DTL_SN				AS DTL_SN
			 , CD.DTL_CD				AS DTL_CD
			 , CD.DTL_VL				AS DTL_VL
			 , CD.DTL_INDCT_NM		AS DTL_INDCT_NM
			 , CD.USE_YN				AS USE_YN
			 , CD.USE_YN				AS CRTR_DTL_USE_YN
			 , CD.DEL_YN				AS DEL_YN

		FROM TB_INVNTR_DSCD_CRTR_DTL CD

		WHERE CD.APC_CD = #{apcCd}
		  AND CD.DSCD_CRTR_TYPE = #{dscdCrtrType}
		  AND CD.CRTR_CD = #{crtrCd}
		  AND CD.DTL_SN = #{dtlSn}
		]]>
    </select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.dscd.mapper.DscdCrtrMapper.selectCrtrDtlListInUse	-->
	<!-- DESC : 폐기기준 상세 품목 목록 조회.	                         	            -->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<select id="selectCrtrDtlListInUse" parameterType="com.at.apcss.am.dscd.vo.DscdCrtrVO" resultType="com.at.apcss.am.dscd.vo.DscdCrtrVO">
		<![CDATA[
			SELECT /* com.at.apcss.am.dscd.mapper.DscdCrtrMapper.selectCrtrDtlListInUse */
				ROW_NUMBER() OVER(
						PARTITION BY A.APC_CD, A.DSCD_CRTR_TYPE, A.CRTR_CD
						ORDER BY A.CRTR_DTL_SEQ, A.DTL_SN ASC
					)	AS SEQ
				, A.*
			  FROM (

	    		SELECT
					  CC.APC_CD				AS APC_CD
					, CC.DSCD_CRTR_TYPE		AS DSCD_CRTR_TYPE
					, CT.CD_VL_NM			AS DSCD_CRTR_TYPE_NM
					, CT.INDCT_SEQ			AS CRTR_TYPE_SEQ
					, CC.CRTR_CD			AS CRTR_CD
					, CC.CRTR_VL			AS CRTR_VL
					, CC.CRTR_INDCT_NM		AS CRTR_INDCT_NM
					, CC.INDCT_SEQ			AS CRTR_SEQ

					, CD.DTL_SN				AS DTL_SN
					, CD.DTL_CD				AS DTL_CD
					, CD.DTL_VL				AS DTL_VL
					, CD.DTL_INDCT_NM		AS DTL_INDCT_NM
					, CD.INDCT_SEQ			AS CRTR_DTL_SEQ

				  FROM TB_INVNTR_DSCD_CRTR CC

				  JOIN TB_COM_CD_DTL CT
				    ON CT.CD_ID = 'DSCD_CRTR_TYPE'
				   AND CT.APC_CD = '0000'
				   AND CT.CD_VL = CC.DSCD_CRTR_TYPE
				   AND CT.DEL_YN = 'N'

				  LEFT JOIN TB_INVNTR_DSCD_CRTR_DTL CD
				    ON CD.APC_CD = CC.APC_CD
				   AND CD.DSCD_CRTR_TYPE = CC.DSCD_CRTR_TYPE
				   AND CD.CRTR_CD = CC.CRTR_CD
				   AND CD.DEL_YN = 'N'
				   AND CD.USE_YN = 'Y'

				 WHERE CC.DEL_YN = 'N'
				   AND CC.USE_YN = 'Y'
		]]>
		<if test='apcCd != null and apcCd != ""'>
			AND CC.APC_CD = #{apcCd}
		</if>

		<if test='dscdCrtrType != null and dscdCrtrType != ""'>
			AND CC.DSCD_CRTR_TYPE = #{dscdCrtrType}
		</if>

		<if test='crtrCd != null and crtrCd != ""'>
			AND CC.CRTR_CD = #{crtrCd}
		</if>

		<if test='dtlSn != null and dtlSn != 0'>
			AND CD.DTL_SN = #{dtlSn}
		</if>
		<![CDATA[
			 ORDER BY CRTR_TYPE_SEQ, CRTR_SEQ, CRTR_DTL_SEQ, DTL_SN
			) A
		]]>

	</select>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.dscd.mapper.DscdCrtrMapper.selectDscdCrtrDtlList	-->
	<!-- DESC : 폐기기준 상세 목록 조회.	                         	            -->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<select id="selectCrtrDtlList" parameterType="com.at.apcss.am.dscd.vo.DscdCrtrVO" resultType="com.at.apcss.am.dscd.vo.DscdCrtrVO">
    	<![CDATA[
		SELECT /* com.at.apcss.am.dscd.mapper.DscdCrtrMapper.selectCrtrDtlList */

			CD.APC_CD				AS APC_CD
			 , CD.DSCD_CRTR_TYPE		AS DSCD_CRTR_TYPE
			 , CD.CRTR_CD			AS CRTR_CD

			 , CD.DTL_SN				AS DTL_SN
			 , CD.DTL_CD				AS DTL_CD
			 , CD.DTL_VL				AS DTL_VL
			 , CD.DTL_INDCT_NM		AS DTL_INDCT_NM
			 , CD.USE_YN				AS CRTR_DTL_USE_YN
			 , CD.USE_YN				AS USE_YN

		FROM TB_INVNTR_DSCD_CRTR_DTL CD

		WHERE CD.DEL_YN = 'N'
		  AND CD.APC_CD = #{apcCd}
		  AND CD.DSCD_CRTR_TYPE = #{dscdCrtrType}
		  AND CD.CRTR_CD = #{crtrCd}
		]]>
    </select>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.dscd.mapper.DscdCrtrMapper.insertDscdCrtr		-->
	<!-- DESC : 폐기기준 등록.		                         	             	 	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<insert id="insertDscdCrtr" parameterType="com.at.apcss.am.dscd.vo.DscdCrtrVO">
    	<![CDATA[
		INSERT /* com.at.apcss.am.dscd.mapper.DscdCrtrMapper.insertDscdCrtr */
		INTO TB_INVNTR_DSCD_CRTR (
							APC_CD
						  , DSCD_CRTR_TYPE
						  , CRTR_CD
						  , CRTR_VL
						  , CRTR_INDCT_NM
						  , INDCT_SEQ
						  , USE_YN
						  , CRTR_RMRK
						  , DEL_YN
						  , SYS_FRST_INPT_DT
						  , SYS_FRST_INPT_USER_ID
						  , SYS_FRST_INPT_PRGRM_ID
						  , SYS_LAST_CHG_DT
						  , SYS_LAST_CHG_USER_ID
						  , SYS_LAST_CHG_PRGRM_ID
		) VALUES (
					 #{apcCd}
				 , #{dscdCrtrType}
				 , #{crtrCd}
				 , #{crtrVl}
				 , #{crtrIndctNm}
				 , #{indctSeq}
				 , #{useYn}
				 , #{crtrRmrk}
				 , 'N'
				 , SYSDATE
				 , #{sysFrstInptUserId}
				 , #{sysFrstInptPrgrmId}
				 , SYSDATE
				 , #{sysLastChgUserId}
				 , #{sysLastChgPrgrmId}
				 )
		]]>
    </insert>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.dscd.mapper.DscdCrtrMapper.updateDscdCrtr		-->
	<!-- DESC : 폐기기준 변경.	                         	             	 		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<update id="updateDscdCrtr" parameterType="com.at.apcss.am.dscd.vo.DscdCrtrVO">
    	<![CDATA[
		UPDATE /* com.at.apcss.am.dscd.mapper.DscdCrtrMapper.updateDscdCrtr */
			TB_INVNTR_DSCD_CRTR
		SET
			SYS_LAST_CHG_DT 			= SYSDATE
		  , SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
		  , SYS_LAST_CHG_PRGRM_ID 	= #{sysLastChgPrgrmId}

		  , CRTR_VL			= #{crtrVl}
		  , CRTR_INDCT_NM		= #{crtrIndctNm}
		  , INDCT_SEQ			= #{indctSeq}
		  , USE_YN			= #{useYn}
		  , CRTR_RMRK			= #{crtrRmrk}

		WHERE APC_CD = #{apcCd}
		  AND DSCD_CRTR_TYPE = #{dscdCrtrType}
		  AND CRTR_CD = #{crtrCd}
		]]>
    </update>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.dscd.mapper.DscdCrtrMapper.deleteDscdCrtr		-->
	<!-- DESC : 폐기기준 삭제.	                         	             	 		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<delete id="deleteDscdCrtr" parameterType="com.at.apcss.am.dscd.vo.DscdCrtrVO">
    	<![CDATA[
		DELETE /* com.at.apcss.am.dscd.mapper.DscdCrtrMapper.deleteDscdCrtr */
		TB_INVNTR_DSCD_CRTR
			 WHERE APC_CD = #{apcCd}
		AND DSCD_CRTR_TYPE = #{dscdCrtrType}
		AND CRTR_CD = #{crtrCd}
		]]>
    </delete>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.dscd.mapper.DscdCrtrMapper.updateDscdCrtrDtl		-->
	<!-- DESC : 폐기기준 상세 변경.                         	             	 	-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<update id="updateDscdCrtrDtl" parameterType="com.at.apcss.am.dscd.vo.DscdCrtrVO">
    	<![CDATA[
		UPDATE /* com.at.apcss.am.dscd.mapper.DscdCrtrMapper.updateDscdCrtrDtl */
			TB_INVNTR_DSCD_CRTR_DTL
		SET
			SYS_LAST_CHG_DT 			= SYSDATE
		  , SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
		  , SYS_LAST_CHG_PRGRM_ID 	= #{sysLastChgPrgrmId}

		  , DTL_CD			= #{dtlCd}
		  , DTL_VL			= #{dtlVl}
		  , DTL_INDCT_NM		= #{dtlIndctNm}
		  , INDCT_SEQ			= #{indctSeq}
		  , USE_YN			= #{useYn}

		WHERE APC_CD = #{apcCd}
		  AND DSCD_CRTR_TYPE = #{dscdCrtrType}
		  AND CRTR_CD = #{crtrCd}
		  AND DTL_SN = #{dtlSn}
		]]>
    </update>


    <!-- ==========================================================================	-->
    <!-- NAME : com.at.apcss.am.dscd.mapper.DscdCrtrMapper.selectDscdCrtrDtlList	-->
    <!-- DESC : 폐기 기준 관리 - 폐기기준 상세정보 조회.	                         	    -->
    <!-- ==========================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
    <!-- ===========  	============  	===========================================	-->
    <!-- 2024.09.21  	신정철        	Initial Creation                            -->
    <!-- ==========================================================================	-->
    <select id="selectDscdCrtrDtlList" parameterType="com.at.apcss.am.dscd.vo.DscdCrtrVO" resultType="com.at.apcss.am.dscd.vo.DscdCrtrVO">
        <![CDATA[
            SELECT
                  CD.DTL_SN         AS DTL_SN
                , CD.DTL_CD         AS DTL_CD
                , CC.CRTR_INDCT_NM	AS CRTR_INDCT_NM
                , CD.DTL_VL         AS DTL_VL
                , CD.DTL_RMRK       AS DTL_RMRK

                , CC.APC_CD         AS APC_CD
                , CC.DSCD_CRTR_TYPE AS DSCD_CRTR_TYPE
                , CT.CD_VL_NM       AS DSCD_CRTR_TYPE_NM
                , CT.INDCT_SEQ      AS CRTR_TYPE_SEQ
                , CC.CRTR_CD        AS CRTR_CD
                , CC.CRTR_VL        AS CRTR_VL
                , CC.INDCT_SEQ      AS CRTR_SEQ
                , CC.USE_YN         AS CRTR_USE_YN
                , CD.DTL_INDCT_NM   AS DTL_INDCT_NM
                , CD.USE_YN         AS CRTR_DTL_USE_YN
                , CD.INDCT_SEQ      AS INDCT_SEQ
                , CD.INDCT_SEQ      AS CRTR_DTL_SEQ
                , CD.USE_YN         AS USE_YN
            FROM TB_INVNTR_DSCD_CRTR CC
            JOIN TB_COM_CD_DTL CT
            ON CT.CD_ID = 'DSCD_CRTR_TYPE'
            AND CT.APC_CD = '0000'
            AND CT.CD_VL = CC.DSCD_CRTR_TYPE
            AND CT.DEL_YN = 'N'
            JOIN TB_INVNTR_DSCD_CRTR_DTL CD
            ON CD.APC_CD = CC.APC_CD
            AND CD.DSCD_CRTR_TYPE = CC.DSCD_CRTR_TYPE
            AND CD.CRTR_CD = CC.CRTR_CD
            AND CD.DEL_YN = 'N'
            WHERE CC.DEL_YN = 'N'
		]]>
        <if test='apcCd != null and apcCd != ""'>
            AND CC.APC_CD = #{apcCd}
        </if>
        <if test='dscdCrtrType != null and dscdCrtrType != ""'>
            AND CC.DSCD_CRTR_TYPE = #{dscdCrtrType}
        </if>
        <if test='crtrCd != null and crtrCd != ""'>
            AND CC.CRTR_CD = #{crtrCd}
        </if>
        <if test='crtrUseYn != null and crtrUseYn != ""'>
            AND CC.USE_YN = #{crtrUseYn}
        </if>
        <if test='crtrDtlUseYn != null and crtrDtlUseYn != ""'>
            AND CD.USE_YN = #{crtrDtlUseYn}
        </if>
        <![CDATA[
			 ORDER BY CRTR_TYPE_SEQ, CRTR_SEQ, CRTR_DTL_SEQ, DTL_SN
		]]>
    </select>

    <!-- ==========================================================================	-->
    <!-- NAME : com.at.apcss.am.dscd.mapper.DscdCrtrMapper.insertDscdCrtrDtl		-->
    <!-- DESC : 폐기 기준 관리 - 폐기기준 상세정보 추가.		                         	-->
    <!-- ==========================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
    <!-- ===========  	============  	===========================================	-->
    <!-- 2024.09.21  	신정철        	Initial Creation                            -->
    <!-- ==========================================================================	-->
    <insert id="insertDscdCrtrDtl" parameterType="list">
        INSERT
        INTO TB_INVNTR_DSCD_CRTR_DTL (
              APC_CD
            , DSCD_CRTR_TYPE
            , CRTR_CD
            , DTL_SN
            , DTL_CD
            , DTL_VL
            , DTL_INDCT_NM
            , DTL_RMRK
            , INDCT_SEQ
            , USE_YN
            , DEL_YN
            , SYS_FRST_INPT_DT
            , SYS_FRST_INPT_USER_ID
            , SYS_FRST_INPT_PRGRM_ID
            , SYS_LAST_CHG_DT
            , SYS_LAST_CHG_USER_ID
            , SYS_LAST_CHG_PRGRM_ID
        )
        VALUES
        <foreach collection="list" item="item" separator=",">
            (
                  #{item.apcCd}
                , #{item.dscdCrtrType}
                , #{item.crtrCd}
                , #{item.dtlSn}
                , #{item.dtlCd}
                , #{item.dtlVl}
                , #{item.dtlIndctNm}
                , #{item.dtlRmrk}
                , #{item.indctSeq}
                , #{item.useYn}
                , #{item.delYn}
                , SYSDATE
                , #{item.sysFrstInptUserId}
                , #{item.sysFrstInptPrgrmId}
                , SYSDATE
                , #{item.sysLastChgUserId}
                , #{item.sysLastChgPrgrmId}
            )
        </foreach>
    </insert>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.am.dscd.mapper.DscdCrtrMapper.deleteDscdCrtrDtl		-->
	<!-- DESC : 폐기 기준 관리 - 폐기기준 상세정보 삭제.                       	        -->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.09.21  	신정철        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <delete id="deleteDscdCrtrDtl" parameterType="com.at.apcss.am.dscd.vo.DscdCrtrVO">
        DELETE
        FROM TB_INVNTR_DSCD_CRTR_DTL
        WHERE APC_CD = #{apcCd}
        AND DSCD_CRTR_TYPE = #{dscdCrtrType}
        AND CRTR_CD = #{crtrCd}
        AND DTL_SN = #{dtlSn}
    </delete>

    <!-- ==========================================================================	-->
    <!-- NAME : com.at.apcss.am.spmt.mapper.DscdCrtrMapper.selectDscdRegList        -->
    <!-- DESC : 폐기 등록 - 폐기 등록 목록 조회.    	                         	    -->
    <!-- ==========================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
    <!-- ===========  	============  	===========================================	-->
    <!-- 2025.01.16  	최지호        	Initial Creation                            -->
    <!-- ==========================================================================	-->
    <select id="selectDscdRegList" parameterType="com.at.apcss.am.dscd.vo.DscdCrtrVO" resultType="com.at.apcss.am.dscd.vo.DscdCrtrVO">
        SELECT
              IP.APC_CD AS APC_CD
            , (SELECT FN_GET_APC_NM(IP.APC_CD) FROM DUAL) AS APC_NM
            , IP.DSCD_YMD AS DSCD_YMD
            , IP.DSCD_SN AS DSCD_SN
            , IP.DSCD_RSN AS DSCD_RSN
            , IP.DTL_SN AS DTL_SN
            , IP.INVNTR_SE_CD AS INVNTR_SE_CD
            , IP.INVNTR_NO AS INVNTR_NO
            , IP.INVNTR_SN AS INVNTR_SN
            , IP.PRDCR_CD AS PRDCR_CD
            , (SELECT FN_GET_PRDCR_NM(IP.PRDCR_CD, IP.APC_CD) FROM DUAL) AS PRDCR_NM
            , IP.ITEM_CD AS ITEM_CD
            , (SELECT FN_GET_ITEM_NM(IP.ITEM_CD, IP.APC_CD) FROM DUAL) AS ITEM_NM
            , IP.VRTY_CD AS VRTY_CD
            , (SELECT FN_GET_VRTY_NM(IP.ITEM_CD, IP.VRTY_CD, IP.APC_CD) FROM DUAL) AS VRTY_NM
            , IP.GRD_CD AS GRD_CD
            , IP.SPCFCT_CD AS SPCFCT_CD
            , IP.SPMT_PCKG_UNIT_CD AS SPMT_PCKG_UNIT_CD
            , IP.GDS_SE_CD AS GDS_SE_CD
            , IP.WRHS_SE_CD AS WRHS_SE_CD
            , IP.WAREHOUSE_SE_CD AS WAREHOUSE_SE_CD
            , IP.DSCD_QNTT AS DSCD_QNTT
            , IP.DSCD_WGHT AS DSCD_WGHT
            , IP.DEL_YN AS DEL_YN
            , IP.SYS_FRST_INPT_DT AS SYS_FRST_INPT_DT
            , IP.SYS_FRST_INPT_USER_ID AS SYS_FRST_INPT_USER_ID
            , IP.SYS_FRST_INPT_PRGRM_ID AS SYS_FRST_INPT_PRGRM_ID
            , IP.SYS_LAST_CHG_DT AS SYS_LAST_CHG_DT
            , IP.SYS_LAST_CHG_USER_ID AS SYS_LAST_CHG_USER_ID
            , IP.SYS_LAST_CHG_PRGRM_ID AS SYS_LAST_CHG_PRGRM_ID
        FROM TB_INVNTR_DSCD_PRFMNC IP
        WHERE APC_CD = #{apcCd}
        <if test='pckgno != null and pckgno !=""'>
            AND INVNTR_NO = #{pckgno}
        </if>
        <if test='itemCd != null and itemCd !=""'>
            AND ITEM_CD = #{itemCd}
        </if>
        <if test='prdcrCd != null and prdcrCd !=""'>
            AND PRDCR_CD = #{prdcrCd}
        </if>
        <if test='vrtyCd != null and vrtyCd !=""'>
            AND VRTY_CD = #{vrtyCd}
        </if>
        <if test='warehouseSeCd != null and warehouseSeCd !=""'>
            AND WAREHOUSE_SE_CD = #{warehouseSeCd}
        </if>
    </select>

    <!-- ==========================================================================	-->
    <!-- NAME : com.at.apcss.am.spmt.mapper.DscdCrtrMapper.insertDscdRegList        -->
    <!-- DESC : 폐기 등록 - 폐기 등록 목록 추가.    	                         	    -->
    <!-- ==========================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
    <!-- ===========  	============  	===========================================	-->
    <!-- 2025.01.16  	최지호        	Initial Creation                            -->
    <!-- ==========================================================================	-->
    <insert id="insertDscdRegList" parameterType="list">
        INSERT
        INTO TB_INVNTR_DSCD_PRFMNC (
              APC_CD
            , DSCD_YMD
            , DSCD_SN
            , DTL_SN
            , DSCD_RSN
            , INVNTR_SE_CD
            , INVNTR_NO
            , INVNTR_SN
            , PRDCR_CD
            , ITEM_CD
            , VRTY_CD
            , GRD_CD
            , SPCFCT_CD
            , SPMT_PCKG_UNIT_CD
            , GDS_SE_CD
            , WRHS_SE_CD
            , WAREHOUSE_SE_CD
            , DSCD_QNTT
            , DSCD_WGHT
            , DEL_YN
            , SYS_FRST_INPT_DT
            , SYS_FRST_INPT_USER_ID
            , SYS_FRST_INPT_PRGRM_ID
            , SYS_LAST_CHG_DT
            , SYS_LAST_CHG_USER_ID
            , SYS_LAST_CHG_PRGRM_ID
        )
        VALUES
        <foreach collection="list" item="item" separator=",">
        (
              #{item.apcCd}
            , #{item.dscdYmd}
            , #{item.dscdSn}
            , #{item.dtlSn}
            , #{item.dscdRsn}
            , #{item.invntrSeCd}
            , #{item.invntrNo}
            , #{item.invntrSn}
            , #{item.prdcrCd}
            , #{item.itemCd}
            , #{item.vrtyCd}
            , #{item.grdCd}
            , #{item.spcfctCd}
            , #{item.spmtPckgUnitCd}
            , #{item.gdsSeCd}
            , #{item.wrhsSeCd}
            , #{item.warehouseSeCd}
            , #{item.dscdQntt}
            , #{item.dscdWght}
            , #{item.delYn}
            , SYSDATE
            , #{item.sysFrstInptUserId}
            , #{item.sysFrstInptPrgrmId}
            , SYSDATE
            , #{item.sysLastChgUserId}
            , #{item.sysLastChgPrgrmId}
        )
        </foreach>
    </insert>

    <!-- ==========================================================================	-->
    <!-- NAME : com.at.apcss.am.spmt.mapper.DscdCrtrMapper.deleteDscdRegList        -->
    <!-- DESC : 폐기 등록 - 폐기 등록 목록 삭제.    	                         	    -->
    <!-- ==========================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
    <!-- ===========  	============  	===========================================	-->
    <!-- 2025.01.16  	최지호        	Initial Creation                            -->
    <!-- ==========================================================================	-->
    <delete id="deleteDscdRegList" parameterType="com.at.apcss.am.dscd.vo.DscdCrtrVO">
        DELETE
        FROM TB_INVNTR_DSCD_PRFMNC
        WHERE APC_CD = #{apcCd}
        AND DSCD_YMD = #{dscdYmd}
        AND DSCD_SN = #{dscdSn}
        AND DTL_SN = #{dtlSn}
        AND INVNTR_SN = #{invntrSn}
    </delete>

    <!-- ==========================================================================	-->
    <!-- NAME : com.at.apcss.am.dscd.mapper.DscdCrtrMapper.selectDscdPrfmncList		-->
    <!-- DESC : 폐기 (실적 조회, 상세 관리) - 폐기 실적 목록 조회.                       	-->
    <!-- ==========================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
    <!-- ===========  	============  	===========================================	-->
    <!-- 2025.01.14  	최지호        	Initial Creation                            -->
    <!-- ==========================================================================	-->
    <select id="selectDscdPrfmncList" parameterType="com.at.apcss.am.dscd.vo.DscdCrtrVO" resultType="com.at.apcss.am.dscd.vo.DscdCrtrVO">
        <![CDATA[
            SELECT
                  (SELECT FN_GET_ITEM_NM(IP.ITEM_CD, IP.APC_CD) FROM DUAL) AS ITEM_NM
                , (SELECT FN_GET_VRTY_NM(IP.ITEM_CD, IP.VRTY_CD, IP.APC_CD) FROM DUAL) AS VRTY_NM
				, (SELECT FN_GET_PRDCR_NM(IP.PRDCR_CD, IP.APC_CD) FROM DUAL ) AS PRDCR_NM
                , IP.DSCD_SN AS DSCD_SN
                , IP.DSCD_QNTT AS DSCD_QNTT
                , IP.DSCD_WGHT AS DSCD_WGHT
                , CD.DTL_INDCT_NM AS DTL_INDCT_NM
                , IP.DSCD_RSN AS DSCD_RSN

                , IP.APC_CD AS APC_CD
                , IP.ITEM_CD AS ITEM_CD
                , IP.VRTY_CD AS VRTY_CD
                , IP.PRDCR_CD AS PRDCR_CD
                , CC.CRTR_INDCT_NM AS CRTR_INDCT_NM
                , CC.CRTR_CD AS CRTR_CD
              FROM TB_INVNTR_DSCD_PRFMNC IP
              JOIN TB_INVNTR_DSCD_CRTR_DTL CD
                ON IP.APC_CD = CD.APC_CD
              JOIN TB_INVNTR_DSCD_CRTR CC
                ON CC.APC_CD = CD.APC_CD
               AND CC.CRTR_CD = CD.CRTR_CD
        ]]>
        <if test='apcCd != null and apcCd != ""'>
             WHERE IP.APC_CD = #{apcCd}
        </if>
        <if test='dscdYmd != null and dscdYmd != ""'>
               AND IP.DSCD_YMD = #{dscdYmd}
        </if>
        <if test='dscdYmdFrom != null and dscdYmdFrom != ""'>
               AND IP.DSCD_YMD <![CDATA[>=]]> #{dscdYmdFrom}
        </if>
        <if test='dscdYmdTo != null and dscdYmdTo != ""'>
               AND IP.DSCD_YMD <![CDATA[<=]]> #{dscdYmdTo}
        </if>
        <if test='prdcrCd != null and prdcrCd != ""'>
               AND IP.PRDCR_CD = #{prdcrCd}
        </if>
        <if test='itemCd != null and itemCd != ""'>
               AND IP.ITEM_CD = #{itemCd}
        </if>
        <if test='vrtyCd != null and vrtyCd != ""'>
               AND IP.VRTY_CD = #{vrtyCd}
        </if>
    </select>

    <!-- ==========================================================================	-->
    <!-- NAME : com.at.apcss.am.dscd.mapper.DscdCrtrMapper.deleteDscdPrfmncList		-->
    <!-- DESC : 폐기 상세 관리 - 폐기 실적 목록 삭제.                       	            -->
    <!-- ==========================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
    <!-- ===========  	============  	===========================================	-->
    <!-- 2025.01.14  	최지호        	Initial Creation                            -->
    <!-- ==========================================================================	-->
    <delete id="deleteDscdPrfmncList" parameterType="com.at.apcss.am.dscd.vo.DscdCrtrVO">
        <![CDATA[
        DELETE
          FROM TB_INVNTR_DSCD_PRFMNC
         WHERE APC_CD       = #{apcCd}
           AND ITEM_CD      = #{itemCd}
           AND VRTY_CD      = #{vrtyCd}
           AND PRDCR_CD     = #{prdcrCd}
           AND DSCD_SN      = #{dscdSn}
           AND DSCD_QNTT    = #{dscdQntt}
           AND DSCD_WGHT    = #{dscdWght}
           AND DTL_CD       = #{dtlCd}
           AND DSCD_RSN     = #{dscdRsn}
        ]]>
    </delete>
</mapper>