<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<!-- ==========================================================================	-->
<!-- NAME : WghPrfmncMapper.xml                                   				-->
<!-- DESC : 계량대 정보 mapper                                            				-->
<!-- ==========================================================================	-->
<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
<!-- ===========  	============  	===========================================	-->
<!-- 2024.07.22  	손민성      		Initial Creation                            -->
<!-- ==========================================================================	-->
<mapper namespace="com.at.apcss.am.wgh.mapper.WghInfoMapper">
    <!-- ==========================================================================	-->
    <!-- NAME : com.at.apcss.am.cmns.mapper.CmnsFcltMapper.selectWghInfoList		-->
    <!-- DESC : 계량대 상세속성 목록 조회.	                                       			    -->
    <!-- ==========================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
    <!-- ===========  	============  	===========================================	-->
    <!-- 2024.07.22  	손민성        	Initial Creation                            -->
    <!-- ==========================================================================	-->
    <select id="selectWghInfoList" parameterType="com.at.apcss.am.cmns.vo.CmnsFcltAtrbVO" resultType="com.at.apcss.am.cmns.vo.CmnsFcltAtrbVO">
        <![CDATA[
            SELECT /* com.at.apcss.am.cmns.mapper.WghInfoMapper.selectWghInfoList */
                 OAF.APC_CD AS APC_CD
	            ,OAF.FCLT_TYPE AS FCLT_TYPE
	            ,OAF.FCLT_CD AS FCLT_CD
	            ,OAF.FCLT_ATRB_TYPE AS FCLT_ATRB_TYPE
	            ,OAF.ATRB_CD AS ATRB_CD
	            ,OAF.ATRB_VL AS ATRB_VL
	            ,OAF.ATRB_INDCT_NM AS ATRB_INDCT_NM
	            ,OAF.DEL_YN AS DEL_YN
	            ,OAF.SYS_FRST_INPT_DT AS SYS_FRST_INPT_DT
	            ,OAF.SYS_FRST_INPT_USER_ID AS SYS_FRST_INPT_USER_ID
	            ,OAF.SYS_FRST_INPT_PRGRM_ID AS SYS_FRST_INPT_PRGRM_ID
	            ,OAF.SYS_LAST_CHG_DT AS SYS_LAST_CHG_DT
	            ,OAF.SYS_LAST_CHG_USER_ID AS SYS_LAST_CHG_USER_ID
	            ,OAF.SYS_LAST_CHG_PRGRM_ID AS SYS_LAST_CHG_PRGRM_ID
            FROM TB_OPRTNG_APC_FCLT_ATRB AS OAF
            WHERE APC_CD = #{apcCd}
        ]]>
    </select>

    <!-- ==========================================================================	-->
    <!-- NAME : com.at.apcss.am.cmns.mapper.CmnsFcltMapper.selectWghDtlInfoList		-->
    <!-- DESC : 계량대 목록 조회.	                                       			    -->
    <!-- ==========================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
    <!-- ===========  	============  	===========================================	-->
    <!-- 2024.07.29  	손민성        	Initial Creation                            -->
    <!-- ==========================================================================	-->
    <select id="selectWghDtlInfoList" parameterType="com.at.apcss.am.cmns.vo.CmnsFcltAtrbVO" resultType="com.at.apcss.am.cmns.vo.CmnsFcltDtlVO">
        <![CDATA[
        SELECT /* com.at.apcss.am.cmns.mapper.WghInfoMapper.selectWghDtlInfoList */
              OAFD.APC_CD AS APC_CD
             ,OAFD.FCLT_TYPE AS FCLT_TYPE
             ,OAFD.FCLT_CD AS FCLT_CD
             ,OAFD.FCLT_DTL_TYPE AS FCLT_DTL_TYPE
             ,OAFD.DTL_CD AS DTL_CD
             ,OAFD.DTL_VL AS DTL_VL
             ,OAFD.DTL_INDCT_NM AS DTL_INDCT_NM
             ,OAFD.FCLT_EXPLN AS FCLT_EXPLN
             ,OAFD.DEL_YN AS DEL_YN
             ,OAFD.SYS_FRST_INPT_DT AS SYS_FRST_INPT_DT
             ,OAFD.SYS_FRST_INPT_USER_ID AS SYS_FRST_INPT_USER_ID
             ,OAFD.SYS_FRST_INPT_PRGRM_ID AS SYS_FRST_INPT_PRGRM_ID
             ,OAFD.SYS_LAST_CHG_DT AS SYS_LAST_CHG_DT
             ,OAFD.SYS_LAST_CHG_USER_ID AS SYS_LAST_CHG_USER_ID
             ,OAFD.SYS_LAST_CHG_PRGRM_ID AS SYS_LAST_CHG_PRGRM_ID
        FROM TB_OPRTNG_APC_FCLT_DTL AS OAFD
        WHERE APC_CD = #{apcCd}
        ]]>
    </select>

    <!-- ==========================================================================	-->
    <!-- NAME : com.at.apcss.am.cmns.mapper.CmnsFcltMapper.insertWghFcltDtl		    -->
    <!-- DESC : 계량대 공통목록 생성.                                     			    -->
    <!-- ==========================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
    <!-- ===========  	============  	===========================================	-->
    <!-- 2024.07.29  	손민성        	Initial Creation                            -->
    <!-- ==========================================================================	-->
    <insert id="insertWghFcltDtl" parameterType="com.at.apcss.am.cmns.vo.CmnsFcltDtlVO">
            <![CDATA[
        INSERT /* com.at.apcss.am.cmns.mapper.CmnsFcltMapper.insertWghFcltDtl */
        INTO TB_OPRTNG_APC_FCLT_DTL
        (
              APC_CD
            , FCLT_TYPE
            , FCLT_CD
            , FCLT_DTL_TYPE
            , DTL_CD
            , DTL_VL
            , DTL_INDCT_NM
            , FCLT_EXPLN
            , SYS_FRST_INPT_DT
            , SYS_FRST_INPT_USER_ID
            , SYS_FRST_INPT_PRGRM_ID
            , SYS_LAST_CHG_DT
            , SYS_LAST_CHG_USER_ID
            , SYS_LAST_CHG_PRGRM_ID
        )
        VALUES
        (
              #{apcCd}
            , 'WGH_FCLT'
            , #{fcltCd}
            , 'WGH_FCLT'
            , #{dtlCd}
            , #{dtlVl}
            , #{dtlIndctNm}
            , #{fcltExpln}
            , SYSDATE
            , #{sysFrstInptUserId}
            , #{sysFrstInptPrgrmId}
            , SYSDATE
            , #{sysLastChgUserId}
            , #{sysLastChgPrgrmId}
        )
        ]]>
    </insert>
    <!-- ==========================================================================	-->
    <!-- NAME : com.at.apcss.am.cmns.mapper.CmnsFcltMapper.insertWghFclt		    -->
    <!-- DESC : 계량대 목록 생성.                                     			        -->
    <!-- ==========================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
    <!-- ===========  	============  	===========================================	-->
    <!-- 2024.07.29  	손민성        	Initial Creation                            -->
    <!-- ==========================================================================	-->
    <insert id="insertWghFclt" parameterType="com.at.apcss.am.cmns.vo.CmnsFcltVO">
            <![CDATA[
        INSERT /* com.at.apcss.am.cmns.mapper.CmnsFcltMapper.insertWghFclt */
        INTO TB_OPRTNG_APC_FCLT
        (
             APC_CD
            ,FCLT_TYPE
            ,FCLT_CD
            ,FCLT_NM
            ,FCLT_EXPLN
            ,OPRTNG_HR
            ,N_OPRTNG_HR
            ,HR_UNIT
            ,FCLT_CPCT
            ,CPCT_UNIT
            ,WGHT_MIN
            ,WGHT_MAX
            ,WGHT_UNIT
            ,PRCS_NMTM
            ,BGNG_YMD
            ,END_YMD
            ,FCLT_RMRK
            ,SYS_FRST_INPT_DT
            ,SYS_FRST_INPT_USER_ID
            ,SYS_FRST_INPT_PRGRM_ID
            ,SYS_LAST_CHG_DT
            ,SYS_LAST_CHG_USER_ID
            ,SYS_LAST_CHG_PRGRM_ID
        )
        VALUES
            (
             #{apcCd}
            , 'WGH_FCLT'
            , #{fcltCd}
            , 'WGH_FCLT'
            ,#{fcltExpln}
            ,#{oprtngHr}
            ,#{nOprtngHr}
            ,#{hrUnit}
            ,#{fcltCpct}
            ,#{cpctUnit}
            ,#{wghtMin}
            ,#{wghtMax}
            ,#{wghtUnit}
            ,#{prcsNmtm}
            ,#{bgngYmd}
            ,#{endYmd}
            ,#{fcltRmrk}
            ,SYSDATE
            ,#{sysFrstInptUserId}
            ,#{sysFrstInptPrgrmId}
            ,SYSDATE
            ,#{sysLastChgUserId}
            ,#{sysLastChgPrgrmId}
            )
        ]]>
    </insert>

    <!-- ==========================================================================	-->
    <!-- NAME : com.at.apcss.am.cmns.mapper.CmnsFcltMapper.insertWghFcltAtrb	    -->
    <!-- DESC : 계량대 상세속성 목록 생성.                             			        -->
    <!-- ==========================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
    <!-- ===========  	============  	===========================================	-->
    <!-- 2024.07.29  	손민성        	Initial Creation                            -->
    <!-- ==========================================================================	-->

    <insert id="insertWghFcltAtrb" parameterType="java.util.List">
            INSERT /* com.at.apcss.am.cmns.mapper.CmnsFcltMapper.insertWghFcltAtrb */
            INTO TB_OPRTNG_APC_FCLT_ATRB
            (
             APC_CD
            ,FCLT_TYPE
            ,FCLT_CD
            ,FCLT_ATRB_TYPE
            ,SN
            ,ATRB_CD
            ,ATRB_VL
            ,ATRB_INDCT_NM
            ,SYS_FRST_INPT_DT
            ,SYS_FRST_INPT_USER_ID
            ,SYS_FRST_INPT_PRGRM_ID
            ,SYS_LAST_CHG_DT
            ,SYS_LAST_CHG_USER_ID
            ,SYS_LAST_CHG_PRGRM_ID
            )
            VALUES
        <foreach collection="list" item="item" separator=",">
            (
             #{item.apcCd}
            ,'WGH_FCLT'
            ,#{item.fcltCd}
            ,'WGH_FCLT'
            ,#{item.sn}
            ,#{item.atrbCd}
            ,#{item.atrbVl}
            ,#{item.atrbIndctNm}
            ,SYSDATE
            ,#{item.sysFrstInptUserId}
            ,#{item.sysFrstInptPrgrmId}
            ,SYSDATE
            ,#{item.sysLastChgUserId}
            ,#{item.sysLastChgPrgrmId}
            )
        </foreach>
    </insert>

    <!-- ==========================================================================	-->
    <!-- NAME : com.at.apcss.am.cmns.mapper.CmnsFcltMapper.selectWghFcltInfo	    -->
    <!-- DESC : 계량대 메인 grid 속성정보 조회                                          -->
    <!-- ==========================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
    <!-- ===========  	============  	===========================================	-->
    <!-- 2024.07.29  	손민성        	Initial Creation                            -->
    <!-- ==========================================================================	-->
    <select id="selectWghFcltInfo" parameterType="com.at.apcss.am.cmns.vo.CmnsFcltDtlVO" resultType="com.at.apcss.am.cmns.vo.CmnsFcltVO">
        <![CDATA[
         SELECT /* com.at.apcss.am.cmns.mapper.CmnsFcltMapper.selectWghFcltInfo */
             APC_CD AS APC_CD
            ,FCLT_TYPE AS FCLT_TYPE
            ,FCLT_CD  AS FCLT_CD
            ,FCLT_NM AS FCLT_NM
            ,FCLT_EXPLN AS FCLT_EXPLN
            ,OPRTNG_HR AS OPRTNG_HR
            ,N_OPRTNG_HR AS N_OPRTNG_HR
            ,HR_UNIT AS HR_UNIT
            ,FCLT_CPCT AS FCLT_CPCT
            ,CPCT_UNIT AS CPCT_UNIT
            ,WGHT_MIN AS WGHT_MIN
            ,WGHT_MAX AS WGHT_MAX
            ,WGHT_UNIT AS WGHT_UNIT
            ,PRCS_NMTM AS PRCS_NMTM
            ,BGNG_YMD AS BGNG_YMD
            ,END_YMD AS END_YMD
            ,FCLT_RMRK AS FCLT_RMRK
            ,DEL_YN AS DEL_YN
            ,SYS_FRST_INPT_DT AS SYS_FRST_INPT_DT
            ,SYS_FRST_INPT_USER_ID AS SYS_FRST_INPT_USER_ID
            ,SYS_FRST_INPT_PRGRM_ID AS SYS_FRST_INPT_PRGRM_ID
            ,SYS_LAST_CHG_DT AS SYS_LAST_CHG_DT
            ,SYS_LAST_CHG_USER_ID AS SYS_LAST_CHG_USER_ID
            ,SYS_LAST_CHG_PRGRM_ID AS SYS_LAST_CHG_PRGRM_ID
         FROM
             TB_OPRTNG_APC_FCLT
         WHERE
             APC_CD = #{apcCd}
        ]]>
        <if test=' fcltCd != null and fcltCd !=""'>
        AND  FCLT_CD = #{fcltCd}
        </if>
    </select>
    <!-- ==========================================================================	-->
    <!-- NAME : com.at.apcss.am.cmns.mapper.CmnsFcltMapper.selectWghFcltAtrbInfoList-->
    <!-- DESC : 계량대 하단 grid 상세속성정보 조회                                       -->
    <!-- ==========================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
    <!-- ===========  	============  	===========================================	-->
    <!-- 2024.07.29  	손민성        	Initial Creation                            -->
    <!-- ==========================================================================	-->
    <select id="selectWghFcltAtrbInfoList" parameterType="com.at.apcss.am.cmns.vo.CmnsFcltDtlVO" resultType="com.at.apcss.am.cmns.vo.CmnsFcltAtrbVO">
        <![CDATA[
        SELECT /* com.at.apcss.am.cmns.mapper.CmnsFcltMapper.selectWghFcltAtrbInfoList */
             APC_CD
            ,FCLT_TYPE
            ,FCLT_CD
            ,FCLT_ATRB_TYPE
            ,SN
            ,ATRB_CD
            ,ATRB_VL
            ,ATRB_INDCT_NM
            ,DEL_YN
            ,SYS_FRST_INPT_DT
            ,SYS_FRST_INPT_USER_ID
            ,SYS_FRST_INPT_PRGRM_ID
            ,SYS_LAST_CHG_DT
            ,SYS_LAST_CHG_USER_ID
            ,SYS_LAST_CHG_PRGRM_ID
        FROM
            TB_OPRTNG_APC_FCLT_ATRB
        WHERE
            APC_CD = #{apcCd}
        AND FCLT_CD = #{fcltCd}
        ORDER BY SN
        ]]>
    </select>

    <!-- ==========================================================================	-->
    <!-- NAME : com.at.apcss.am.cmns.mapper.CmnsFcltMapper.deleteWghInfo            -->
    <!-- DESC : 계량대 목록 일괄 삭제                                                  -->
    <!-- ==========================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
    <!-- ===========  	============  	===========================================	-->
    <!-- 2024.07.31  	손민성        	Initial Creation                            -->
    <!-- ==========================================================================	-->
    <delete id="deleteWghInfo" parameterType="com.at.apcss.am.cmns.vo.CmnsFcltDtlVO">
        DELETE /* com.at.apcss.am.cmns.mapper.CmnsFcltMapper.deleteWghInfo */
        FROM TB_OPRTNG_APC_FCLT
        WHERE APC_CD = #{apcCd}
          AND FCLT_CD = #{fcltCd}
    </delete>
    <delete id="deleteWghAtrbInfo" parameterType="com.at.apcss.am.cmns.vo.CmnsFcltDtlVO">
        DELETE /* com.at.apcss.am.cmns.mapper.CmnsFcltMapper.deleteWghAtrbInfo */
        FROM TB_OPRTNG_APC_FCLT_ATRB
        WHERE APC_CD = #{apcCd}
          AND FCLT_CD = #{fcltCd}
    </delete>
    <delete id="deleteWghDtlInfo" parameterType="com.at.apcss.am.cmns.vo.CmnsFcltDtlVO">
        DELETE /* com.at.apcss.am.cmns.mapper.CmnsFcltMapper.deleteWghDtlInfo */
        FROM TB_OPRTNG_APC_FCLT_DTL
        WHERE APC_CD = #{apcCd}
          AND FCLT_CD = #{fcltCd};
    </delete>

    <!-- ==========================================================================	-->
    <!-- NAME : com.at.apcss.am.cmns.mapper.CmnsFcltMapper.deleteWghInfo            -->
    <!-- DESC : 계량대 목록 일괄 수정                                                  -->
    <!-- ==========================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
    <!-- ===========  	============  	===========================================	-->
    <!-- 2024.07.31  	손민성        	Initial Creation                            -->
    <!-- ==========================================================================	-->
    <update id="updateWghFcltDtl" parameterType="com.at.apcss.am.cmns.vo.CmnsFcltDtlVO">
        <![CDATA[
            UPDATE /* com.at.apcss.am.cmns.mapper.CmnsFcltMapper.deleteWghInfo */
                TB_OPRTNG_APC_FCLT_DTL SET
                   APC_CD = #{apcCd}
                 , FCLT_TYPE = 'WGH_FCLT'
                 , FCLT_CD = #{fcltCd}
                 , FCLT_DTL_TYPE = 'WGH_FCLT'
                 , DTL_CD = #{dtlCd}
                 , DTL_VL = #{dtlVl}
                 , DTL_INDCT_NM = #{dtlIndctNm}
                 , FCLT_EXPLN = #{fcltExpln}
                 , SYS_LAST_CHG_DT = SYSDATE
                 , SYS_LAST_CHG_USER_ID = #{sysLastChgUserId}
                 , SYS_LAST_CHG_PRGRM_ID = #{sysLastChgPrgrmId}
            WHERE APC_CD = #{apcCd}
              AND FCLT_CD = #{fcltCd}
        ]]>
    </update>
    <update id="updateWghFclt" parameterType="com.at.apcss.am.cmns.vo.CmnsFcltVO">
        <![CDATA[
        UPDATE /* com.at.apcss.am.cmns.mapper.CmnsFcltMapper.updateWghFclt */
            TB_OPRTNG_APC_FCLT SET
                FCLT_TYPE = 'WGH_FCLT'
               ,FCLT_NM = #{fcltNm}
               ,FCLT_EXPLN = #{fcltExpln}
               ,OPRTNG_HR = #{oprtngHr}
               ,N_OPRTNG_HR = #{nOprtngHr}
               ,HR_UNIT = #{hrUnit}
               ,FCLT_CPCT = #{fcltCpct}
               ,CPCT_UNIT = #{cpctUnit}
               ,WGHT_MIN = #{wghtMin}
               ,WGHT_MAX = #{wghtMax}
               ,WGHT_UNIT = #{wghtUnit}
               ,PRCS_NMTM = #{prcsNmtm}
               ,BGNG_YMD = #{bgngYmd}
               ,END_YMD = #{endYmd}
               ,FCLT_RMRK = #{fcltRmrk}
               ,SYS_LAST_CHG_DT = SYSDATE
               ,SYS_LAST_CHG_USER_ID = #{sysLastChgUserId}
               ,SYS_LAST_CHG_PRGRM_ID = #{sysLastChgPrgrmId}
        WHERE APC_CD = #{apcCd}
          AND FCLT_CD = #{fcltCd}
        ]]>
    </update>
    <update id="updateWghFcltAtrb" parameterType="com.at.apcss.am.cmns.vo.CmnsFcltAtrbVO">
            MERGE INTO TB_OPRTNG_APC_FCLT_ATRB AS OAFA
            USING (
            SELECT
            #{apcCd} AS APC_CD,
            'WGH_FCLT' AS FCLT_TYPE,
            #{fcltCd} AS FCLT_CD,
            'WGH_FCLT' AS FCLT_ATRB_TYPE,
            #{sn} AS SN,
            #{atrbCd} AS ATRB_CD,
            #{atrbVl} AS ATRB_VL,
            #{atrbIndctNm} AS ATRB_INDCT_NM,
            #{sysFrstInptUserId} AS SYS_FRST_INPT_USER_ID,
            #{sysFrstInptPrgrmId} AS SYS_FRST_INPT_PRGRM_ID,
            #{sysLastChgUserId} AS SYS_LAST_CHG_USER_ID,
            #{sysLastChgPrgrmId} AS SYS_LAST_CHG_PRGRM_ID
            FROM dual
            ) pt0
            ON (OAFA.APC_CD = pt0.APC_CD AND OAFA.FCLT_CD = pt0.FCLT_CD AND OAFA.SN = pt0.SN)
            WHEN MATCHED THEN
            UPDATE SET
            OAFA.ATRB_CD = pt0.ATRB_CD,
            OAFA.ATRB_VL = pt0.ATRB_VL,
            OAFA.ATRB_INDCT_NM = pt0.ATRB_INDCT_NM,
            OAFA.SYS_LAST_CHG_DT = SYSDATE,
            OAFA.SYS_LAST_CHG_USER_ID = pt0.SYS_LAST_CHG_USER_ID,
            OAFA.SYS_LAST_CHG_PRGRM_ID = pt0.SYS_LAST_CHG_PRGRM_ID
            WHEN NOT MATCHED THEN
            INSERT (
             APC_CD
            ,FCLT_TYPE
            ,FCLT_CD
            ,FCLT_ATRB_TYPE
            ,SN
            ,ATRB_CD
            ,ATRB_VL
            ,ATRB_INDCT_NM
            ,SYS_FRST_INPT_DT
            ,SYS_FRST_INPT_USER_ID
            ,SYS_FRST_INPT_PRGRM_ID
            ,SYS_LAST_CHG_DT
            ,SYS_LAST_CHG_USER_ID
            ,SYS_LAST_CHG_PRGRM_ID
            ) VALUES (
             pt0.APC_CD
            ,pt0.FCLT_TYPE
            ,pt0.FCLT_CD
            ,pt0.FCLT_ATRB_TYPE
            ,pt0.SN
            ,pt0.ATRB_CD
            ,pt0.ATRB_VL
            ,pt0.ATRB_INDCT_NM
            ,SYSDATE
            ,pt0.SYS_FRST_INPT_USER_ID
            ,pt0.SYS_FRST_INPT_PRGRM_ID
            ,SYSDATE
            ,pt0.SYS_LAST_CHG_USER_ID
            ,pt0.SYS_LAST_CHG_PRGRM_ID
            )
    </update>

</mapper>
