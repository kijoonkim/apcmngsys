<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!-- ==========================================================================	-->
<!-- NAME : RawMtrWrhsIgiMapper.xml                                   			-->
<!-- DESC : 검수등록 mapper                                            			-->
<!-- ==========================================================================	-->
<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
<!-- ===========  	============  	===========================================	-->
<!-- 2025.07.10  	김 호        		Initial Creation                        -->
<!-- ==========================================================================	-->

<mapper namespace="com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper">


	<!-- ================================================================================	-->
	<!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.selectRawMtrWrhsIgiList		-->
	<!-- DESC : 검수 목록 조회.	                                       						-->
	<!-- ================================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
	<!-- ===========  	============  	=================================================	-->
	<!-- 2025.07.10  	 김 호        		Initial Creation                        		-->
	<!-- ================================================================================	-->
    <select id="selectRawMtrWrhsIgiList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.RawMtrWrhsIgiVO" resultType="com.apcmngsys.apcss.am.wrhs.vo.RawMtrWrhsIgiVO">
    	<![CDATA[
			SELECT /* com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.selectRawMtrWrhsIgiList */
				   X.APC_CD                 AS APC_CD
				 , X.IGI_YMD                AS IGI_YMD
				 , X.IGI_SEQ                AS IGI_SEQ
				 , X.PRDCR_CD               AS PRDCR_CD
				 , MAX(PI.PRDCR_NM)         AS PRDCR_NM
				 , MAX(PI.FRMHS_NM)         AS FRMHS_NM
				 , MAX(FN_GET_COM_CD_VL_NM('IGI_JGMT_CD', X.IGI_JGMT_CD, X.APC_CD)) AS IGI_JGMT_NM
			     , MAX(X.IGI_JGMT_CD)		AS IGI_JGMT_CD
				 , MAX(X.SMPL_YN)           AS SMPL_YN
				 , MAX(X.RW_ARTCL_CD)       AS RW_ARTCL_CD
                 , MAX(FN_GET_COM_CD_VL_NM('RW_ARTCL_CD', X.RW_ARTCL_CD, X.APC_CD)) AS RW_ARTCL_NM
				 , MAX(X.RW_RT)             AS RW_RT
				 , MAX(X.WRHS_UNIT_CD)      AS WRHS_UNIT_CD
				 , MAX(X.SNDBK_QNTT)        AS SNDBK_QNTT
				 , MAX(X.IGI_RMRK)          AS IGI_RMRK
				 , MAX(X.QNTT_RMRK)         AS QNTT_RMRK
				 , MAX(X.RT_RMRK)           AS RT_RMRK
				 , MAX(CQ.QLT_EVL_CD)       AS QLT_EVL_CD
				 , MAX((SELECT FN_GET_COM_CD_VL_NM('QLT_EVL_CD', CQ.QLT_EVL_CD, X.APC_CD) FROM DUAL)) AS QLT_EVL_NM
				 , SUM(X.IGI_GRD_QNTT)      AS IGI_GRD_QNTT_TOT
				 , SUM(X.IGI_GRD_QNTT_1)    AS IGI_GRD_QNTT_1
				 , SUM(X.IGI_GRD_QNTT_2)    AS IGI_GRD_QNTT_2
				 , SUM(X.IGI_GRD_QNTT_3)    AS IGI_GRD_QNTT_3
				 , SUM(X.IGI_GRD_QNTT_4)    AS IGI_GRD_QNTT_4
				 , SUM(X.IGI_GRD_QNTT_5)    AS IGI_GRD_QNTT_5
				 , SUM(X.IGI_GRD_RT_1)      AS IGI_GRD_RT_1
				 , SUM(X.IGI_GRD_RT_2)      AS IGI_GRD_RT_2
				 , SUM(X.IGI_GRD_RT_3)      AS IGI_GRD_RT_3
				 , SUM(X.IGI_GRD_RT_4)      AS IGI_GRD_RT_4
				 , SUM(X.IGI_GRD_RT_5)      AS IGI_GRD_RT_5
			FROM (SELECT
					     WI.APC_CD
					   , WI.IGI_YMD
					   , WI.IGI_SEQ
					   , WI.PRDCR_CD
					   , WI.IGI_JGMT_CD
					   , WI.SMPL_YN
					   , WI.RW_ARTCL_CD
					   , WI.RW_RT
					   , WI.WRHS_UNIT_CD
					   , WI.SNDBK_QNTT
					   , WI.IGI_RMRK
					   , WI.QNTT_RMRK
					   , WI.RT_RMRK
					   , WID.IGI_GRD_QNTT
					   , CASE WHEN WID.IGI_GRD_CD = '0001' THEN WID.IGI_GRD_QNTT END IGI_GRD_QNTT_1
					   , CASE WHEN WID.IGI_GRD_CD = '0002' THEN WID.IGI_GRD_QNTT END IGI_GRD_QNTT_2
					   , CASE WHEN WID.IGI_GRD_CD = '0003' THEN WID.IGI_GRD_QNTT END IGI_GRD_QNTT_3
					   , CASE WHEN WID.IGI_GRD_CD = '0004' THEN WID.IGI_GRD_QNTT END IGI_GRD_QNTT_4
					   , CASE WHEN WID.IGI_GRD_CD = '0005' THEN WID.IGI_GRD_QNTT END IGI_GRD_QNTT_5
					   , CASE WHEN WID.IGI_GRD_CD = '0001' THEN WID.IGI_GRD_RT END IGI_GRD_RT_1
					   , CASE WHEN WID.IGI_GRD_CD = '0002' THEN WID.IGI_GRD_RT END IGI_GRD_RT_2
					   , CASE WHEN WID.IGI_GRD_CD = '0003' THEN WID.IGI_GRD_RT END IGI_GRD_RT_3
					   , CASE WHEN WID.IGI_GRD_CD = '0004' THEN WID.IGI_GRD_RT END IGI_GRD_RT_4
					   , CASE WHEN WID.IGI_GRD_CD = '0005' THEN WID.IGI_GRD_RT END IGI_GRD_RT_5
				  FROM TB_RAW_MTR_WRHS_IGI WI
					 , TB_RAW_MTR_WRHS_IGI_DTL WID
				  WHERE WI.APC_CD = WID.APC_CD
					AND WI.IGI_YMD = WID.IGI_YMD
					AND WI.IGI_SEQ = WID.IGI_SEQ
				    AND WI.DEL_YN = 'N'
					AND WI.APC_CD = #{apcCd}
		]]>
			<if test='igiYmdFrom != null and igiYmdFrom != ""'>
					AND WI.IGI_YMD <![CDATA[>=]]> #{igiYmdFrom}
			</if>
			<if test='igiYmdTo != null and igiYmdTo != ""'>
					AND WI.IGI_YMD <![CDATA[<=]]> #{igiYmdTo}
			</if>
			<if test='prdcrCd != null and prdcrCd != ""'>
					AND WI.PRDCR_CD = #{prdcrCd}
			</if>
			<if test='prchsSttnYn != null and prchsSttnYn != ""'>
					AND WI.PRDCR_CD = (SELECT PRDCR_CD
											  FROM TB_RAW_MTR_WRHS_IGI
										WHERE DEL_YN = 'N'
										  AND APC_CD = #{apcCd}
										ORDER BY SYS_LAST_CHG_DT DESC
										LIMIT 1
										)
			</if>
			<if test='igiYr != null and igiYr != ""'>
					AND SUBSTR(WI.IGI_YMD, 1, 4) = #{igiYr}
			</if>
		<![CDATA[
			) X
			   , TB_PRDCR_INFO PI
               , TB_CLTVTN_FRMHS_QLT CQ
			WHERE X.APC_CD = PI.APC_CD
			  AND X.PRDCR_CD = PI.PRDCR_CD
              AND X.APC_CD = CQ.APC_CD(+)
              AND X.PRDCR_CD = CQ.PRDCR_CD(+)
              AND CQ.DEL_YN(+) = 'N'
		]]>
		<if test='igiYr != null and igiYr != ""'>
			  AND CQ.YR(+) = #{igiYr}
		</if>
		<if test='igiYmdFrom != null and igiYmdFrom != ""'>
			  AND CQ.YR(+) = SUBSTR(#{igiYmdFrom}, 1, 4)
		</if>
		<![CDATA[
			GROUP BY X.APC_CD, X.IGI_YMD, X.IGI_SEQ, X.PRDCR_CD
			ORDER BY X.APC_CD, X.IGI_YMD, X.IGI_SEQ, X.PRDCR_CD
		]]>
    </select>

	<!-- ================================================================================	-->
	<!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.selectGetIgiSeq				-->
	<!-- DESC : 검수이력번호 발번.	                                       						-->
	<!-- ================================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
	<!-- ===========  	============  	=================================================	-->
	<!-- 2025.07.10  	 김 호        		Initial Creation                        		-->
	<!-- ================================================================================	-->
	<select id="selectGetIgiSeq" parameterType="com.apcmngsys.apcss.am.wrhs.vo.RawMtrWrhsIgiVO" resultType="String">
		SELECT NVL(MAX(IGI_SEQ), 0) +1 AS IGI_SEQ
		  FROM TB_RAW_MTR_WRHS_IGI
		 WHERE APC_CD = #{apcCd}
		   AND IGI_YMD = #{igiYmd}
	</select>
	<!-- ================================================================================	-->
	<!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.insertRawMtrWrhsIgi			-->
	<!-- DESC : 검수 등록.	                                       						-->
	<!-- ================================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
	<!-- ===========  	============  	=================================================	-->
	<!-- 2025.07.10  	 김 호        		Initial Creation                        		-->
	<!-- ================================================================================	-->
	<insert id="insertRawMtrWrhsIgi" parameterType="com.apcmngsys.apcss.am.wrhs.vo.RawMtrWrhsIgiVO">
		<![CDATA[
			INSERT /* com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.insertRawMtrWrhsIgi */
			  INTO TB_RAW_MTR_WRHS_IGI
			   		(
					  APC_CD
					, IGI_YMD
					, IGI_SEQ
					, PRDCR_CD
					, IGI_JGMT_CD
					, SMPL_YN
					, RW_ARTCL_CD
					, RW_RT
					, WRHS_UNIT_CD
					, SNDBK_QNTT
					, IGI_RMRK
					, QNTT_RMRK
					, RT_RMRK
					, DEL_YN
					, SYS_FRST_INPT_DT
					, SYS_FRST_INPT_USER_ID
					, SYS_FRST_INPT_PRGRM_ID
					, SYS_LAST_CHG_DT
					, SYS_LAST_CHG_USER_ID
					, SYS_LAST_CHG_PRGRM_ID
			  		)
			 VALUES
				   (
					  #{apcCd}
					, #{igiYmd}
					, #{igiSeq}
					, #{prdcrCd}
					, #{igiJgmtCd}
					, #{smplYn}
					, #{rwArtclCd}
					, #{rwRt}
					, #{wrhsUnitCd}
					, #{sndbkQntt}
					, #{igiRmrk}
					, #{qnttRmrk}
					, #{rtRmrk}
					, 'N'
					, SYSDATE
					, #{sysFrstInptUserId}
					, #{sysFrstInptPrgrmId}
					, SYSDATE
					, #{sysLastChgUserId}
					, #{sysLastChgPrgrmId}
				   )
		]]>
	</insert>

	<!-- ================================================================================	-->
	<!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.updateRawMtrWrhsIgi			-->
	<!-- DESC : 검수 수정.	                                       						-->
	<!-- ================================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
	<!-- ===========  	============  	=================================================	-->
	<!-- 2025.07.10  	 김 호        		Initial Creation                        		-->
	<!-- ================================================================================	-->
	<update id="updateRawMtrWrhsIgi" parameterType="com.apcmngsys.apcss.am.wrhs.vo.RawMtrWrhsIgiVO">
		<![CDATA[
			UPDATE /* com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.updateRawMtrWrhsIgi */
			       TB_RAW_MTR_WRHS_IGI
			   SET PRDCR_CD					= #{prdcrCd}
				 , IGI_JGMT_CD				= #{igiJgmtCd}
				 , SMPL_YN					= #{smplYn}
				 , RW_ARTCL_CD				= #{rwArtclCd}
				 , RW_RT					= #{rwRt}
				 , WRHS_UNIT_CD				= #{wrhsUnitCd}
				 , SNDBK_QNTT				= #{sndbkQntt}
				 , IGI_RMRK					= #{igiRmrk}
				 , QNTT_RMRK				= #{qnttRmrk}
				 , RT_RMRK					= #{rtRmrk}
				 , SYS_LAST_CHG_DT			= SYSDATE
				 , SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
				 , SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
			 WHERE APC_CD 					= #{apcCd}
			   AND IGI_YMD					= #{igiYmd}
			   AND IGI_SEQ					= #{igiSeq}
		]]>
	</update>

	<!-- ================================================================================	-->
	<!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.insertRawMtrWrhsIgiDtl		-->
	<!-- DESC : 검수 상세 등록.	                                       						-->
	<!-- ================================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
	<!-- ===========  	============  	=================================================	-->
	<!-- 2025.07.10  	 김 호        		Initial Creation                        		-->
	<!-- ================================================================================	-->
	<insert id="insertRawMtrWrhsIgiDtl" parameterType="com.apcmngsys.apcss.am.wrhs.vo.RawMtrWrhsIgiDtlVO">
		<![CDATA[
			INSERT /* com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.insertRawMtrWrhsIgiDtl */
		      INTO TB_RAW_MTR_WRHS_IGI_DTL
				(
				   APC_CD
				 , IGI_YMD
				 , IGI_SEQ
				 , IGI_GRD_CD
				 , IGI_GRD_QNTT
				 , IGI_GRD_RT
			 	 , DEL_YN
				 , SYS_FRST_INPT_DT
				 , SYS_FRST_INPT_USER_ID
				 , SYS_FRST_INPT_PRGRM_ID
				 , SYS_LAST_CHG_DT
				 , SYS_LAST_CHG_USER_ID
				 , SYS_LAST_CHG_PRGRM_ID
				)
			VALUES
				(
				   #{apcCd}
			     , #{igiYmd}
				 , #{igiSeq}
				 , #{igiGrdCd}
				 , #{igiGrdQntt}
				 , #{igiGrdRt}
				 , #{delYn}
				 , SYSDATE
				 , #{sysFrstInptUserId}
				 , #{sysFrstInptPrgrmId}
				 , SYSDATE
				 , #{sysLastChgUserId}
				 , #{sysLastChgPrgrmId}
				)
		]]>
	</insert>

	<!-- ================================================================================	-->
	<!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.updateRawMtrWrhsIgiDtl		-->
	<!-- DESC : 검수 상세 수정.	                                       						-->
	<!-- ================================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
	<!-- ===========  	============  	=================================================	-->
	<!-- 2025.07.10  	 김 호        		Initial Creation                        		-->
	<!-- ================================================================================	-->
	<update id="updateRawMtrWrhsIgiDtl" parameterType="com.apcmngsys.apcss.am.wrhs.vo.RawMtrWrhsIgiDtlVO">
		<![CDATA[
		MERGE /* com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.updateRawMtrWrhsIgiDtl */
		 INTO TB_RAW_MTR_WRHS_IGI_DTL A
		USING DUAL
		  ON (
					A.APC_CD 				= #{apcCd}
				AND A.IGI_YMD 				= #{igiYmd}
				AND A.IGI_SEQ 				= #{igiSeq}
				AND A.IGI_GRD_CD			= #{igiGrdCd}
			 )
		WHEN MATCHED THEN
			UPDATE
			   SET
				   A.IGI_GRD_QNTT			= #{igiGrdQntt}
				 , A.IGI_GRD_RT				= #{igiGrdRt}
		    	 , A.DEL_YN					= #{delYn}
				 , A.SYS_LAST_CHG_DT		= SYSDATE
			     , A.SYS_LAST_CHG_USER_ID	= #{sysLastChgUserId}
			     , A.SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
			WHERE A.APC_CD 					= #{apcCd}
			  AND A.IGI_YMD					= #{igiYmd}
			  AND A.IGI_SEQ					= #{igiSeq}
			  AND A.IGI_GRD_CD				= #{igiGrdCd}
		WHEN NOT MATCHED THEN
		INSERT
			(
				  APC_CD
				, IGI_YMD
				, IGI_SEQ
				, IGI_GRD_CD
				, IGI_GRD_QNTT
				, IGI_GRD_RT
				, DEL_YN
				, SYS_FRST_INPT_DT
				, SYS_FRST_INPT_USER_ID
				, SYS_FRST_INPT_PRGRM_ID
				, SYS_LAST_CHG_DT
				, SYS_LAST_CHG_USER_ID
				, SYS_LAST_CHG_PRGRM_ID
			)
		VALUES
			(
			      #{apcCd}
				, #{igiYmd}
				, #{igiSeq}
				, #{igiGrdCd}
				, #{igiGrdQntt}
				, #{igiGrdRt}
				, #{delYn}
				, SYSDATE
				, #{sysFrstInptUserId}
				, #{sysFrstInptPrgrmId}
				, SYSDATE
				, #{sysLastChgUserId}
				, #{sysLastChgPrgrmId}
			)
		]]>
	</update>

	<!-- ================================================================================	-->
	<!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.deleteRawMtrWrhsIgi			-->
	<!-- DESC : 검수 삭제.	                                       							-->
	<!-- ================================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
	<!-- ===========  	============  	=================================================	-->
	<!-- 2025.07.15  	 김 호        		Initial Creation                        		-->
	<!-- ================================================================================	-->
	<update id="deleteRawMtrWrhsIgi" parameterType="com.apcmngsys.apcss.am.wrhs.vo.RawMtrWrhsIgiVO">
		<![CDATA[
		UPDATE /* com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.updateRawMtrWrhsIgiDtl */
			   TB_RAW_MTR_WRHS_IGI
		   SET DEL_YN 					= 'Y'
			 , SYS_LAST_CHG_DT			= SYSDATE
			 , SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
			 , SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
		WHERE APC_CD 					= #{apcCd}
		  AND IGI_YMD					= #{igiYmd}
		  AND IGI_SEQ					= #{igiSeq}
		]]>
	</update>

	<!-- ================================================================================	-->
	<!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.deleteRawMtrWrhsIgiDtl		-->
	<!-- DESC : 검수 상세 삭제.	                                       						-->
	<!-- ================================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
	<!-- ===========  	============  	=================================================	-->
	<!-- 2025.07.15  	 김 호        		Initial Creation                        		-->
	<!-- ================================================================================	-->
	<update id="deleteRawMtrWrhsIgiDtl" parameterType="com.apcmngsys.apcss.am.wrhs.vo.RawMtrWrhsIgiDtlVO">
		<![CDATA[
		UPDATE /* com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.deleteRawMtrWrhsIgiDtl */
			   TB_RAW_MTR_WRHS_IGI_DTL
		   SET DEL_YN 					= 'Y'
		  	 , SYS_LAST_CHG_DT			= SYSDATE
		  	 , SYS_LAST_CHG_USER_ID		= #{sysLastChgUserId}
		  	 , SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
		WHERE APC_CD 					= #{apcCd}
		  AND IGI_YMD					= #{igiYmd}
		  AND IGI_SEQ					= #{igiSeq}
		]]>
	</update>

	<!-- ================================================================================	-->
	<!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.selectRawMtrWrhsIgiTot		-->
	<!-- DESC : 검수 목록 조회.	                                       						-->
	<!-- ================================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
	<!-- ===========  	============  	=================================================	-->
	<!-- 2025.07.10  	 김 호        		Initial Creation                        		-->
	<!-- ================================================================================	-->
	<select id="selectRawMtrWrhsIgiTot" parameterType="com.apcmngsys.apcss.am.wrhs.vo.RawMtrWrhsIgiVO" resultType="com.apcmngsys.apcss.am.wrhs.vo.RawMtrWrhsIgiVO">
		<![CDATA[
			SELECT APC_CD
			     , IGI_JGMT_CD
				 , NVL(FN_GET_COM_CD_VL_NM('IGI_JGMT_CD', IGI_JGMT_CD, APC_CD), '누락') AS IGI_JGMT_NM
				 , ROUND(SUM(IGI_GRD_QNTT_1) * MAX(WRHS_TON) / 1000) AS STRG_LOCTN_QNTT_1
				 , ROUND(SUM(IGI_GRD_QNTT_2) * MAX(WRHS_TON) / 1000) AS STRG_LOCTN_QNTT_2
				 , ROUND(SUM(IGI_GRD_QNTT_3) * MAX(WRHS_TON) / 1000) AS STRG_LOCTN_QNTT_3
				 , ROUND(SUM(IGI_GRD_QNTT_4) * MAX(WRHS_TON) / 1000) AS STRG_LOCTN_QNTT_4
				 , ROUND(SUM(IGI_GRD_QNTT_5) * MAX(WRHS_TON) / 1000) AS STRG_LOCTN_QNTT_5
				 , ROUND((SUM(IGI_GRD_QNTT_1) + SUM(IGI_GRD_QNTT_2) + SUM(IGI_GRD_QNTT_3) + SUM(IGI_GRD_QNTT_4) + SUM(IGI_GRD_QNTT_5)) * MAX(WRHS_TON) / 1000) AS STRG_LOCTN_QNTT_TOT
			  FROM
				   (SELECT
						   X.APC_CD                 AS APC_CD
						 , X.IGI_YMD                AS IGI_YMD
						 , X.IGI_SEQ                AS IGI_SEQ
						 , MAX(X.IGI_JGMT_CD)       AS IGI_JGMT_CD
						 , SUM(X.IGI_GRD_QNTT_1)    AS IGI_GRD_QNTT_1
						 , SUM(X.IGI_GRD_QNTT_2)    AS IGI_GRD_QNTT_2
						 , SUM(X.IGI_GRD_QNTT_3)    AS IGI_GRD_QNTT_3
						 , SUM(X.IGI_GRD_QNTT_4)    AS IGI_GRD_QNTT_4
						 , SUM(X.IGI_GRD_QNTT_5)    AS IGI_GRD_QNTT_5
						 , (SELECT ROUND(SUM(WP.WRHS_WGHT) / SUM(WP.BX_QNTT), 1) AS WRHS_TON
							  FROM TB_RAW_MTR_WRHS_PRFMNC WP
								 , TB_RAW_MTR_INVNTR RI
							 WHERE WP.APC_CD = RI.APC_CD
							   AND WP.WRHSNO = RI.WRHSNO
							   AND RI.PRCS_TYPE IS NULL
							   AND SUBSTR(WP.WRHS_YMD, 1, 4) = SUBSTR(#{igiYmd}, 1, 4)
							   AND WP.DEL_YN = 'N'
							   AND RI.DEL_YN = 'N'
							   AND WP.APC_CD = #{apcCd}
						   ) AS WRHS_TON
					  FROM (SELECT
								   WI.APC_CD
								 , WI.IGI_YMD
								 , WI.IGI_SEQ
								 , WI.PRDCR_CD
								 , WI.IGI_JGMT_CD
								 , WI.STRG_LOCTN_CD
								 , CASE WHEN WID.IGI_GRD_CD = '0001' THEN WID.IGI_GRD_QNTT END IGI_GRD_QNTT_1
								 , CASE WHEN WID.IGI_GRD_CD = '0002' THEN WID.IGI_GRD_QNTT END IGI_GRD_QNTT_2
								 , CASE WHEN WID.IGI_GRD_CD = '0003' THEN WID.IGI_GRD_QNTT END IGI_GRD_QNTT_3
								 , CASE WHEN WID.IGI_GRD_CD = '0004' THEN WID.IGI_GRD_QNTT END IGI_GRD_QNTT_4
								 , CASE WHEN WID.IGI_GRD_CD = '0005' THEN WID.IGI_GRD_QNTT END IGI_GRD_QNTT_5
							  FROM TB_RAW_MTR_WRHS_IGI WI
								 , TB_RAW_MTR_WRHS_IGI_DTL WID
							 WHERE WI.APC_CD = WID.APC_CD
							   AND WI.IGI_YMD = WID.IGI_YMD
							   AND WI.IGI_SEQ = WID.IGI_SEQ
							   AND WI.DEL_YN = 'N'
							   AND WID. DEL_YN = 'N'
							   AND WI.APC_CD = #{apcCd}
						   ) X
						  , TB_PRDCR_INFO PI
					  WHERE X.APC_CD = PI.APC_CD
						AND X.PRDCR_CD = PI.PRDCR_CD
						AND PI.DEL_YN = 'N'
					  GROUP BY X.APC_CD, X.IGI_YMD, X.IGI_SEQ, X.PRDCR_CD
					  ORDER BY X.APC_CD, X.IGI_YMD, X.IGI_SEQ, X.PRDCR_CD
				 ) Y
			 GROUP BY Y.APC_CD, Y.IGI_JGMT_CD
		]]>
	</select>
	<!-- ================================================================================	-->
	<!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.selectPrschsPrdcrInfo		-->
	<!-- DESC : 생산자 검수 정보 조회.	                                       						-->
	<!-- ================================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
	<!-- ===========  	============  	=================================================	-->
	<!-- 2025.07.10  	 김 호        		Initial Creation                        		-->
	<!-- ================================================================================	-->
	<select id="selectPrschsPrdcrInfo" parameterType="com.apcmngsys.apcss.am.wrhs.vo.RawMtrWrhsIgiVO" resultType="com.apcmngsys.apcss.am.wrhs.vo.RawMtrWrhsIgiVO">
		<![CDATA[
		SELECT /* com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.selectPrschsPrdcrInfo */
		       PI.PRDCR_CD
			 , PI.PRDCR_NM
			 , CQ.QLT_EVL_CD
			 , (SELECT FN_GET_COM_CD_VL_NM('QLT_EVL_CD', CQ.QLT_EVL_CD, PI.APC_CD) FROM DUAL) AS QLT_EVL_NM
			 , NVL(PI.FRMHS_TELNO, TELNO) TELNO
			 , PI.FRMHS_CTPV
			 , CQ.PLNTNG_PRCL
			 , CQ.EXPCT_QNTT
			 , CASE WHEN CQ.SD_QNTT_1 > 0
					THEN (
						  SELECT SEED_NM || ' : ' || CQ.SD_QNTT_1
							FROM (SELECT RANK() OVER (ORDER BY SEED_CD ASC) AS SEED_RANK
									   , SEED_CD
									   , SEED_NM
									FROM TB_APC_SEED_CRTR
								   WHERE DEL_YN = 'N'
									 AND APC_CD = #{apcCd}
									 AND ITEM_CD = #{itemCd}
								 )
						   WHERE SEED_RANK = 1
						 )
			   END SD_1
			 , CASE WHEN SD_QNTT_2 > 0
					THEN (
						  SELECT SEED_NM || ' : ' || CQ.SD_QNTT_2
							FROM (SELECT RANK() OVER (ORDER BY SEED_CD ASC) AS SEED_RANK
									   , SEED_CD
									   , SEED_NM
									FROM TB_APC_SEED_CRTR
								   WHERE DEL_YN = 'N'
									 AND APC_CD = #{apcCd}
									 AND ITEM_CD = #{itemCd}
								 )
						   WHERE SEED_RANK = 2
						 )
			   END SD_2
			 , CASE WHEN SD_QNTT_3 > 0
					THEN (
						  SELECT SEED_NM || ' : ' || CQ.SD_QNTT_3
							FROM (SELECT RANK() OVER (ORDER BY SEED_CD ASC) AS SEED_RANK
									   , SEED_CD
									   , SEED_NM
									FROM TB_APC_SEED_CRTR
								   WHERE DEL_YN = 'N'
									 AND APC_CD = #{apcCd}
									 AND ITEM_CD = #{itemCd}
								 )
						   WHERE SEED_RANK = 3
						 )
			   END SD_3
			 , CASE WHEN SD_QNTT_4 > 0
					THEN (
						  SELECT SEED_NM || ' : ' || CQ.SD_QNTT_4
							FROM (SELECT RANK() OVER (ORDER BY SEED_CD ASC) AS SEED_RANK
									   , SEED_CD
									   , SEED_NM
									FROM TB_APC_SEED_CRTR
								   WHERE DEL_YN = 'N'
									 AND APC_CD = #{apcCd}
									 AND ITEM_CD = #{itemCd}
								 )
						   WHERE SEED_RANK = 4
						 )
			   END SD_4
			 , CASE WHEN SD_QNTT_5 > 0
					THEN (
						  SELECT SEED_NM || ' : ' || CQ.SD_QNTT_5
							FROM (SELECT RANK() OVER (ORDER BY SEED_CD ASC) AS SEED_RANK
									   , SEED_CD
									   , SEED_NM
									FROM TB_APC_SEED_CRTR
								   WHERE DEL_YN = 'N'
							         AND APC_CD = #{apcCd}
									 AND ITEM_CD = #{itemCd}
								 )
						   WHERE SEED_RANK = 5
						 )
			   END SD_5
		  FROM TB_PRDCR_INFO PI
			 , TB_CLTVTN_FRMHS_QLT CQ
		 WHERE PI.APC_CD = CQ.APC_CD(+)
		   AND PI.PRDCR_CD = CQ.PRDCR_CD(+)
		   AND PI.DEL_YN = 'N'
		   AND CQ.YR(+) = #{igiYr}
		   AND CQ.DEL_YN(+) = 'N'
		   AND PI.APC_CD = #{apcCd}
		   AND PI.PRDCR_CD = (SELECT MAX(PRDCR_CD)
								FROM TB_RAW_MTR_WRHS_IGI
							   WHERE DEL_YN = 'N'
							     AND APC_CD = #{apcCd}
							   GROUP BY SYS_LAST_CHG_DT
							   ORDER BY SYS_LAST_CHG_DT DESC
							   LIMIT 1
							 )

		]]>
	</select>

	<!-- ================================================================================	-->
	<!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.selectRawMtrWghPrmncTotList	-->
	<!-- DESC : 수매계량합계 정보 조회.	                                       					-->
	<!-- ================================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
	<!-- ===========  	============  	=================================================	-->
	<!-- 2025.08.07  	 김 호        		Initial Creation                        		-->
	<!-- ================================================================================	-->
	<select id="selectRawMtrWghPrmncTotList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.RawMtrWrhsIgiVO" resultType="com.apcmngsys.apcss.am.wrhs.vo.RawMtrWrhsIgiVO">
		<![CDATA[
			SELECT X.APC_CD                 AS APC_CD
				 , X.VRTY_CD                AS VRTY_CD
				 , FN_GET_VRTY_NM(X.ITEM_CD, X.VRTY_CD, X.APC_CD) AS VRTY_NM
				 , ROUND((SUM(GRD_WGHT_1) / 1000))          AS GRD_WGHT_1
				 , ROUND((SUM(GRD_WGHT_2) / 1000))          AS GRD_WGHT_2
				 , ROUND((SUM(GRD_WGHT_3) / 1000))          AS GRD_WGHT_3
				 , ROUND((SUM(GRD_WGHT_4) / 1000))          AS GRD_WGHT_4
				 , ROUND(((SUM(GRD_WGHT_1) + SUM(GRD_WGHT_2) + SUM(GRD_WGHT_3) + SUM(GRD_WGHT_4)) / 1000))      AS GRD_WGHT_TOT
				 , 0 AS EXPCT_QNTT_TOT
				 , (SELECT SUM(RSG.GRD_QNTT) AS GRD_QNTT_TOT
					  FROM TB_RAW_MTR_WRHS_PRFMNC WP
						 , TB_RAW_MTR_STD_GRD RSG
					 WHERE WP.APC_CD = RSG.APC_CD
					   AND WP.WRHSNO = RSG.WRHSNO
					   AND WP.DEL_YN = 'N'
					   AND RSG.DEL_YN = 'N'
					   AND WP.WRHS_YMD = #{igiYmd}
					 GROUP BY WP.APC_CD
					) AS TODAY_GRD_QNTT_TOT
				  , (SELECT SUM(RSG.GRD_QNTT) AS GRD_QNTT_TOT
					  FROM TB_RAW_MTR_WRHS_PRFMNC WP
						 , TB_RAW_MTR_STD_GRD RSG
					 WHERE WP.APC_CD = RSG.APC_CD
					   AND WP.WRHSNO = RSG.WRHSNO
					   AND WP.WRHS_YMD = TO_CHAR(TO_DATE(#{igiYmd}, 'YYYYMMDD') - 1, 'YYYYMMDD')
					   AND WP.DEL_YN = 'N'
					   AND RSG.DEL_YN = 'N'
					 GROUP BY WP.APC_CD
					) AS YESTERDAY_GRD_QNTT_TOT
			  FROM (
					SELECT WP.APC_CD            AS APC_CD
						 , WP.WRHSNO            AS WRHSNO
						 , RSG.GRD_WGHT         AS GRD_WGHT
						 , RSG.GRD_KND          AS GRD_KND
						 , SG.GRD_KND_NM        AS GRD_KND_NM
						 , SG.GRD_RANK          AS GRD_RANK
						 , RI.ITEM_CD           AS ITEM_CD
						 , RI.VRTY_CD           AS VRTY_CD
						 , CASE WHEN GRD_RANK = 1 THEN SG.GRD_KND END AS GRD_1
						 , CASE WHEN GRD_RANK = 2 THEN SG.GRD_KND END AS GRD_2
						 , CASE WHEN GRD_RANK = 3 THEN SG.GRD_KND END AS GRD_3
						 , CASE WHEN GRD_RANK = 4 THEN SG.GRD_KND END AS GRD_4
						 , CASE WHEN GRD_RANK = 1 THEN RSG.GRD_WGHT END AS GRD_WGHT_1
						 , CASE WHEN GRD_RANK = 2 THEN RSG.GRD_WGHT END AS GRD_WGHT_2
						 , CASE WHEN GRD_RANK = 3 THEN RSG.GRD_WGHT END AS GRD_WGHT_3
						 , CASE WHEN GRD_RANK = 4 THEN RSG.GRD_WGHT END AS GRD_WGHT_4
					  FROM TB_RAW_MTR_WRHS_PRFMNC WP
						 , TB_RAW_MTR_INVNTR RI
						 , TB_RAW_MTR_STD_GRD RSG
						 , ( SELECT GRD_KND
								  , GRD_KND_NM
								  , RANK() OVER (ORDER BY GRD_KND ASC) AS GRD_RANK
								  , ITEM_CD
							  FROM TB_APC_STD_GRD
							 WHERE GRD_SE_CD = '01'
							   AND DEL_YN = 'N'
							   AND APC_CD = #{apcCd}
							   AND ITEM_CD = #{itemCd}
						   ) SG
					 WHERE WP.APC_CD = RI.APC_CD
					   AND WP.WRHSNO = RI.WRHSNO
					   AND WP.APC_CD = RSG.APC_CD(+)
					   AND WP.WRHSNO = RSG.WRHSNO(+)
					   AND RSG.GRD_KND = SG.GRD_KND(+)
					   AND WP.DEL_YN = 'N'
					   AND RI.DEL_YN = 'N'
					   AND RSG.DEL_YN(+) = 'N'
					   AND RI.APC_CD = '0733'
					   AND SUBSTR(WP.WRHS_YMD, 0, 4) = #{igiYr}
					) X
			 GROUP BY X.APC_CD, X.ITEM_CD, X.VRTY_CD
			 UNION ALL
			SELECT #{apcCd}         AS APC_CD
				 , '9999'           AS VRVY_CD
				 , '외부창고'         AS VRTY_NM
				 , 0                AS GRD_WGHT_1
				 , 0                AS GRD_WGHT_2
				 , 0                AS GRD_WGHT_3
				 , 0                AS GRD_WGHT_4
				 , 0                AS GRD_WGHT_TOT
				 , (SELECT SUM(EXPCT_QNTT) FROM TB_CLTVTN_FRMHS_QLT WHERE APC_CD = #{apcCd} AND YR = #{igiYr} GROUP BY APC_CD) AS EXPCT_QNTT_TOT
				 , 0                AS TODDAY_GRD_QNTT_TOT
				 , 0                AS YESTERDAY_GRD_QNTT_TOT
			  FROM DUAL

		]]>
	</select>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.sdlngCrtrInfos			    -->
    <!-- DESC : 육묘기준 목록 공통 조회.	                                       				-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.22  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <select id="sdlngCrtrInfos" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO" resultType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
        <![CDATA[
            SELECT
                  SC.APC_CD AS APC_CD
                , SC.SDLNG_CD AS SDLNG_CD
                , SC.SDLNG_NM AS SDLNG_NM
                , SC.ITEM_CD AS ITEM_CD
                , SC.VRTY_CD AS VRTY_CD
                , SC.INDCT_SEQ AS INDCT_SEQ
                , SC.SDLNG_DAY_CNT AS SDLNG_DAY_CNT
                , SC.USE_YN AS USE_YN
                , SC.DEL_YN AS DEL_YN
                , (NVL(HS.TOTAL_PCKG_QNTT, 0)) AS TOTAL_QNTT
                , (NVL(HS.TOTAL_PCKG_WGHT, 0)) AS TOTAL_WGHT
                , (NVL(HS.TOTAL_PCKG_QNTT, 0) - NVL(SP.TOTAL_SPMT_QNTT, 0)) AS TOTAL_PCKG_QNTT
                , (NVL(HS.TOTAL_PCKG_WGHT, 0) - NVL(SP.TOTAL_SPMT_WGHT, 0)) AS TOTAL_PCKG_WGHT
            FROM TB_SDLNG_CRTR SC
            LEFT JOIN (
                SELECT
                      SI.APC_CD AS APC_CD
                    , SI.SDNLG_CD AS SDLNG_CD
                    , SUM(SH.PCKG_QNTT) AS TOTAL_PCKG_QNTT
                    , SUM(SH.PCKG_QNTT * SH.PCKG_WGHT) AS TOTAL_PCKG_WGHT
                FROM TB_SDNLG_INVNTR SI
                LEFT JOIN TB_SDNLG_PLNTNG SP ON SI.SDNLG_NO = SP.SDNLG_NO
                AND SI.APC_CD = SP.APC_CD
                LEFT JOIN TB_SDNLG_HRVST SH ON SP.PLNTNG_NO = SH.PLNTNG_NO
                AND SI.APC_CD = SH.APC_CD
                AND SH.DEL_YN = 'N'
                WHERE SI.DEL_YN = 'N'
                GROUP BY
                      SI.APC_CD
                    , SI.SDNLG_CD
            ) HS ON SC.APC_CD = HS.APC_CD
            AND SC.SDLNG_CD = HS.SDLNG_CD
            LEFT JOIN (
                SELECT
                      PD.APC_CD AS APC_CD
                    , PD.ITEM_CD AS ITEM_CD
                    , PD.VRTY_CD AS VRTY_CD
                    , SUM(PD.SPMT_QNTT) AS TOTAL_SPMT_QNTT
                    , SUM(PD.SPMT_WGHT) AS TOTAL_SPMT_WGHT
                FROM TB_SPMT_PRFMNC_DTL PD
                WHERE PD.DEL_YN = 'N'
                GROUP BY
                      PD.APC_CD
                    , PD.ITEM_CD
                    , PD.VRTY_CD
            ) SP ON SC.APC_CD = SP.APC_CD
            AND SC.ITEM_CD = SP.ITEM_CD
            AND SC.VRTY_CD = SP.VRTY_CD
            WHERE SC.DEL_YN = 'N'
            AND SC.USE_YN = 'Y'
            AND SC.APC_CD = #{apcCd}
            ORDER BY SC.INDCT_SEQ
        ]]>
    </select>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.sdlngFcltZoneInfos          -->
    <!-- DESC : 육묘시설 구역 목록 공통 조회.	                                       			-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.22  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <select id="sdlngFcltZoneInfos" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO" resultType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
        <![CDATA[
            SELECT
                  FZ.FCLT_ID AS FCLT_ID
                , MAX(SF.FCLT_NM) AS FCLT_NM
                , FZ.FCLT_ZONE_SE_CD AS FCLT_ZONE_SE_CD
                , FN_GET_SDLNG_FCLT_CRTR_NM(FZ.APC_CD, SF.FCLT_TYPE, 'ZNSC', FZ.FCLT_ZONE_SE_CD) AS SE_NM
                , FC.CRTR_NV AS CRTR_NV
            FROM TB_SDLNG_FCLT_ZONE FZ
            JOIN TB_SDLNG_FCLT SF ON SF.APC_CD = FZ.APC_CD
            AND SF.FCLT_ID = FZ.FCLT_ID
            AND SF.FCLT_TYPE = #{fcltType}
            AND SF.APC_CD = #{apcCd}
            AND SF.DEL_YN = 'N'
            JOIN TB_SDLNG_FCLT_CRTR FC ON FC.APC_CD = FZ.APC_CD
            AND FC.FCLT_TYPE = FZ.FCLT_ID
            AND FC.FCLT_CRTR_CD = FZ.FCLT_ZONE_SE_CD
            AND FC.INDCT_NM NOT IN ('*')
            AND FC.DEL_YN = 'N'
            GROUP BY
                  FZ.APC_CD
                , FZ.FCLT_ID
                , SF.FCLT_TYPE
                , FZ.FCLT_ZONE_SE_CD
                , FC.CRTR_NV
            ORDER BY FZ.FCLT_ZONE_SE_CD
        ]]>
    </select>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.updateSdlngFcltCrtrList		-->
    <!-- DESC : 육묘시설기준 목록 수정.	                                       					-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.22  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <update id="updateSdlngFcltCrtrList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
		<![CDATA[
            UPDATE TB_SDLNG_FCLT_CRTR
            SET
                  CRTR_NV = #{crtrNv}
                , SYS_LAST_CHG_DT = SYSDATE
                , SYS_LAST_CHG_USER_ID = #{sysLastChgUserId}
                , SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
            WHERE APC_CD = #{apcCd}
            AND FCLT_TYPE = #{fcltType}
            AND FCLT_CRTR_TYPE = #{fcltCrtrType}
            AND FCLT_CRTR_CD = #{fcltCrtrCd}
        ]]>
	</update>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.sdlngFcltRowInfos           -->
    <!-- DESC : 육묘시설 열 목록 공통 조회.	                                       			    -->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.22  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <select id="sdlngFcltRowInfos" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO" resultType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
        <![CDATA[
            SELECT
                  FZ.FCLT_ID AS FCLT_ID
                , SF.FCLT_NM AS FCLT_NM
                , FZ.FCLT_ZONE_SE_CD AS FCLT_ZONE_SE_CD
                , USRAM.FN_GET_SDLNG_FCLT_CRTR_NM(FZ.APC_CD, SF.FCLT_TYPE, 'ZNSC', FZ.FCLT_ZONE_SE_CD) AS SE_NM
                , FZ.FCLT_ZONE_ID AS FCLT_ZONE_ID
                , FN_GET_SDLNG_ZONE_NM(FZ.APC_CD, FZ.FCLT_ZONE_ID) AS ZONE_NM
            FROM TB_SDLNG_FCLT_ZONE FZ
            JOIN TB_SDLNG_FCLT SF ON SF.APC_CD = FZ.APC_CD
            AND SF.FCLT_ID = FZ.FCLT_ID
            AND SF.FCLT_TYPE = #{fcltType}
            AND SF.APC_CD = #{apcCd}
        ]]>
        <if test='fcltZoneSeCd != null and fcltZoneSeCd != ""'>
            AND FZ.FCLT_ZONE_SE_CD = #{fcltZoneSeCd}
        </if>
        <![CDATA[
            AND SF.DEL_YN = 'N'
        ]]>
    </select>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.selectSdlngCrtrList			-->
    <!-- DESC : 육묘기준 목록 조회.	                                       					-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.22  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <select id="selectSdlngCrtrList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO" resultType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
        <![CDATA[
            SELECT
                  SC.APC_CD AS APC_CD
                , SC.SDLNG_CD AS SDLNG_CD
                , SC.SDLNG_NM AS SDLNG_NM
                , SC.ITEM_CD AS ITEM_CD
                , SC.VRTY_CD AS VRTY_CD
                , SC.INDCT_SEQ AS INDCT_SEQ
                , SC.SDLNG_DAY_CNT AS SDLNG_DAY_CNT
                , SC.USE_YN AS USE_YN
                , SC.DEL_YN AS DEL_YN
            FROM TB_SDLNG_CRTR SC
            WHERE SC.DEL_YN = 'N'
            AND SC.APC_CD = #{apcCd}
            ORDER BY SC.INDCT_SEQ
        ]]>
    </select>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.insertSdlngCrtrList			-->
    <!-- DESC : 육묘기준 목록 등록.	                                       					-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.22  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <insert id="insertSdlngCrtrList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
		<![CDATA[
            INSERT INTO TB_SDLNG_CRTR (
                  APC_CD
                , SDLNG_CD
                , SDLNG_NM
                , ITEM_CD
                , VRTY_CD
                , INDCT_SEQ
                , SDLNG_DAY_CNT
                , USE_YN
                , DEL_YN
                , SYS_FRST_INPT_DT
                , SYS_FRST_INPT_USER_ID
                , SYS_FRST_INPT_PRGRM_ID
                , SYS_LAST_CHG_DT
                , SYS_LAST_CHG_USER_ID
                , SYS_LAST_CHG_PRGRM_ID
            ) VALUES (
                   #{apcCd}
                 , #{sdlngCd}
                 , #{sdlngNm}
                 , #{itemCd}
                 , #{vrtyCd}
                 , #{indctSeq}
                 , #{sdlngDayCnt}
                 , #{useYn}
                 , 'N'
                 , SYSDATE
                 , #{sysFrstInptUserId}
                 , #{sysFrstInptPrgrmId}
                 , SYSDATE
                 , #{sysLastChgUserId}
                 , #{sysLastChgPrgrmId}
            )
        ]]>
	</insert>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.updateSdlngCrtrList			-->
    <!-- DESC : 육묘기준 목록 수정.	                                       					-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.22  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <update id="updateSdlngCrtrList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
		<![CDATA[
            UPDATE TB_SDLNG_CRTR
            SET
                  SDLNG_NM = #{sdlngNm}
                , ITEM_CD = #{itemCd}
                , VRTY_CD = #{vrtyCd}
                , INDCT_SEQ = #{indctSeq}
                , SDLNG_DAY_CNT = #{sdlngDayCnt}
                , USE_YN = #{useYn}
                , SYS_LAST_CHG_DT = SYSDATE
                , SYS_LAST_CHG_USER_ID = #{sysLastChgUserId}
                , SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
            WHERE APC_CD = #{apcCd}
            AND SDLNG_CD = #{sdlngCd}
        ]]>
	</update>

    <!-- ==================================================================================	-->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.deleteSdlngCrtrList	        -->
    <!-- DESC : 육묘기준 목록 삭제.                                             		        -->
    <!-- ==================================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      			        -->
    <!-- ===========  	============  	===================================================	-->
    <!-- 2025.09.16  	최지호        	Initial Creation                                    -->
    <!-- ==================================================================================	-->
    <update id="deleteSdlngCrtrList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
    	<![CDATA[
            UPDATE TB_SDLNG_CRTR
            SET DEL_YN = 'Y'
            WHERE APC_CD = #{apcCd}
            AND SDLNG_CD = #{sdlngCd}
        ]]>
    </update>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.selectSdlngList			    -->
    <!-- DESC : 육묘장 목록 조회.	                                       					    -->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.15  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <select id="selectSdlngList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO" resultType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
        <![CDATA[
            SELECT
                  SI.APC_CD AS APC_CD
                , SI.SDNLG_NO AS SDLNG_NO
                , SI.SDNLG_CD AS SDLNG_CD
                , SI.SDNG_YMD AS SDNG_YMD
                , SP.PLNTNG_YMD AS PLNTNG_YMD
                , SH.WGH_YMD AS HRVST_YMD
                , SI.PLNTNG_EXPCT_YMD AS PLNTNG_EXPCT_YMD
                , SI.BX_QNTT AS BX_QNTT
                , SI.UNIT_QNTT AS UNIT_QNTT
                , SI.SDNG_QNTT AS SDNG_QNTT
                , SI.INVNTR_QNTT AS INVNTR_QNTT
                , SI.PLNTNG_QNTT AS PLNTNG_QNTT
                , SI.FCLT_ZONE_ID AS FCLT_ZONE_ID
                , SI.RMRK AS RMRK
                , SP.DEL_YN AS DEL_YN
            FROM TB_SDNLG_INVNTR SI
            LEFT JOIN TB_SDNLG_PLNTNG SP ON SI.SDNLG_NO = SP.SDNLG_NO
            AND SI.APC_CD = SP.APC_CD
            LEFT JOIN TB_SDNLG_HRVST SH ON SP.PLNTNG_NO = SH.PLNTNG_NO
            AND SI.APC_CD = SH.APC_CD
            WHERE SI.DEL_YN = 'N'
            AND SI.APC_CD = #{apcCd}
        ]]>
        <if test='sdngYmdFrom != null and sdngYmdFrom != ""'>
            AND SI.SDNG_YMD <![CDATA[>=]]> #{sdngYmdFrom}
        </if>
        <if test='sdngYmdTo != null and sdngYmdTo != ""'>
            AND SI.SDNG_YMD <![CDATA[<=]]> #{sdngYmdTo}
        </if>
        <if test='plntngExpctYmdFrom != null and plntngExpctYmdFrom != ""'>
            AND SI.PLNTNG_EXPCT_YMD <![CDATA[>=]]> #{plntngExpctYmdFrom}
        </if>
        <if test='plntngExpctYmdTo != null and plntngExpctYmdTo != ""'>
            AND SI.PLNTNG_EXPCT_YMD <![CDATA[<=]]> #{plntngExpctYmdTo}
        </if>
        <if test='sdlngCd != null and sdlngCd != ""'>
            AND SI.SDNLG_CD = #{sdlngCd}
        </if>
        <if test='sdlngZone != null and sdlngZone != ""'>
            AND SUBSTR(SI.FCLT_ZONE_ID, 3, 2) = #{sdlngZone}
        </if>
        <if test='fcltZoneId != null and fcltZoneId != ""'>
            AND SI.FCLT_ZONE_ID = #{fcltZoneId}
        </if>
        <![CDATA[
            ORDER BY SI.SDNLG_NO
        ]]>
    </select>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.insertSdlngList			    -->
    <!-- DESC : 육묘장 목록 등록.	                                       						-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.15  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <insert id="insertSdlngList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
		<![CDATA[
            INSERT INTO TB_SDNLG_INVNTR (
                  APC_CD
                , SDNLG_NO
                , SDNLG_CD
                , SDNG_YMD
                , PLNTNG_EXPCT_YMD
                , BX_QNTT
                , UNIT_QNTT
                , SDNG_QNTT
                , INVNTR_QNTT
                , PLNTNG_QNTT
                , FCLT_ZONE_ID
                , RMRK
                , DEL_YN
                , SYS_FRST_INPT_DT
                , SYS_FRST_INPT_USER_ID
                , SYS_FRST_INPT_PRGRM_ID
                , SYS_LAST_CHG_DT
                , SYS_LAST_CHG_USER_ID
                , SYS_LAST_CHG_PRGRM_ID
            ) VALUES (
                  #{apcCd}
                , #{sdlngNo}
                , #{sdlngCd}
                , #{sdngYmd}
                , #{plntngExpctYmd}
                , #{bxQntt}
                , #{unitQntt}
                , #{sdngQntt}
                , #{invntrQntt}
                , #{plntngQntt}
                , #{fcltZoneId}
                , #{rmrk}
                , 'N'
                , SYSDATE
                , #{sysFrstInptUserId}
                , #{sysFrstInptPrgrmId}
                , SYSDATE
                , #{sysLastChgUserId}
                , #{sysLastChgPrgrmId}
            )
        ]]>
	</insert>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.updateSdlngList			    -->
    <!-- DESC : 육묘장 목록 수정.	                                       						-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.15  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <update id="updateSdlngList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
		<![CDATA[
            UPDATE TB_SDNLG_INVNTR
            SET
                  SDNLG_CD = #{sdlngCd}
                , SDNG_YMD = #{sdngYmd}
                , PLNTNG_EXPCT_YMD = #{plntngExpctYmd}
                , BX_QNTT = #{bxQntt}
                , UNIT_QNTT = #{unitQntt}
                , SDNG_QNTT = #{sdngQntt}
                , INVNTR_QNTT = #{invntrQntt}
                , PLNTNG_QNTT = #{plntngQntt}
                , FCLT_ZONE_ID = #{fcltZoneId}
                , RMRK = #{rmrk}
                , SYS_LAST_CHG_DT = SYSDATE
                , SYS_LAST_CHG_USER_ID = #{sysLastChgUserId}
                , SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
            WHERE APC_CD = #{apcCd}
            AND SDNLG_NO = #{sdlngNo}
        ]]>
	</update>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.deleteSdlngList			    -->
    <!-- DESC : 육묘장 목록 삭제.	                                       						-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.15  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <update id="deleteSdlngList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
		<![CDATA[
            UPDATE TB_SDNLG_INVNTR
            SET
                  DEL_YN = 'Y'
                , SYS_LAST_CHG_DT = SYSDATE
                , SYS_LAST_CHG_USER_ID = #{sysLastChgUserId}
                , SYS_LAST_CHG_PRGRM_ID = #{sysLastChgPrgrmId}
            WHERE APC_CD = #{apcCd}
            AND SDNG_YMD = #{sdngYmd}
            AND SDNLG_NO = #{sdlngNo}
        ]]>
	</update>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.selectCltvtn			    -->
    <!-- DESC : 재배장 목록 단건 조회.	                                       					    -->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.16  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <select id="selectCltvtn" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO" resultType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
        <![CDATA[
            SELECT
                  SP.APC_CD AS APC_CD
                , SP.PLNTNG_NO AS PLNTNG_NO
                , SP.SDNLG_NO AS SDLNG_NO
                , SP.PLNTNG_YMD AS PLNTNG_YMD
                , SP.FCLT_ZONE_ID AS FCLT_ZONE_ID
                , SP.PLNTNG_QNTT AS PLNTNG_QNTT
                , SP.HRVST_YMD AS HRVST_YMD
                , SP.RMRK AS RMRK
                , SP.DEL_YN AS DEL_YN
            FROM TB_SDNLG_PLNTNG SP
            WHERE SP.APC_CD = #{apcCd}
            AND SP.DEL_YN = 'N'
        ]]>
        <if test='sdlngNo != null and sdlngNo != ""'>
            AND SP.SDNLG_NO = #{sdlngNo}
        </if>
    </select>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.selectCltvtnList			-->
    <!-- DESC : 재배장 목록 조회.	                                       					    -->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.16  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <select id="selectCltvtnList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO" resultType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
        <![CDATA[
            SELECT
                  SI.APC_CD AS APC_CD
                , SI.SDNLG_NO AS SDLNG_NO
                , SP.PLNTNG_NO AS PLNTNG_NO
                , SI.SDNLG_CD AS SDLNG_CD
                , SI.SDNG_YMD AS SDNG_YMD
                , SI.PLNTNG_EXPCT_YMD AS PLNTNG_EXPCT_YMD
                , SI.BX_QNTT AS BX_QNTT
                , SI.UNIT_QNTT AS UNIT_QNTT
                , SI.PLNTNG_QNTT AS SDLNG_PLNTNG_QNTT
                , SI.INVNTR_QNTT AS SDLNG_INVNTR_QNTT
                , SI.FCLT_ZONE_ID AS SDLNG_FCLT_ZONE_ID
                , SP.DEL_YN AS DEL_YN
                , SP.PLNTNG_YMD AS PLNTNG_YMD
                , SP.PLNTNG_QNTT AS CLTVTN_PLNTNG_QNTT
                , SP.FCLT_ZONE_ID AS CLTVTN_FCLT_ZONE_ID
                , SI.RMRK AS SDLNG_RMRK
                , SP.RMRK AS CLTVTN_RMRK
                , SH.WGH_YMD AS HRVST_YMD
            FROM TB_SDNLG_INVNTR SI
            LEFT JOIN TB_SDNLG_PLNTNG SP ON SI.SDNLG_NO = SP.SDNLG_NO
            AND SI.APC_CD = SP.APC_CD
            LEFT JOIN TB_SDNLG_HRVST SH ON SP.PLNTNG_NO = SH.PLNTNG_NO
            AND SI.APC_CD = SH.APC_CD
            WHERE SI.DEL_YN = 'N'
            AND SI.APC_CD = #{apcCd}
        ]]>
        <if test='sdngYmdFrom != null and sdngYmdFrom != ""'>
            AND SI.SDNG_YMD <![CDATA[>=]]> #{sdngYmdFrom}
        </if>
        <if test='sdngYmdTo != null and sdngYmdTo != ""'>
            AND SI.SDNG_YMD <![CDATA[<=]]> #{sdngYmdTo}
        </if>
        <if test='plntngYmdFrom != null and plntngYmdFrom != "" and plntngYmdTo != null and plntngYmdTo != ""'>
            AND ((SP.PLNTNG_YMD <![CDATA[>=]]> #{plntngYmdFrom} AND SP.PLNTNG_YMD <![CDATA[<=]]> #{plntngYmdTo}) OR SP.PLNTNG_YMD IS NULL)
        </if>
        <if test='sdlngCd != null and sdlngCd != ""'>
            AND SI.SDNLG_CD = #{sdlngCd}
        </if>
        <if test='sdlngZone != null and sdlngZone != ""'>
            AND SUBSTR(SI.FCLT_ZONE_ID, 3, 2) = #{sdlngZone}
        </if>
        <if test='sdlngFcltZoneId != null and sdlngFcltZoneId != ""'>
            AND SI.FCLT_ZONE_ID = #{sdlngFcltZoneId}
        </if>
        <if test='cltvtnZone != null and cltvtnZone != ""'>
            AND SUBSTR(SP.FCLT_ZONE_ID, 3, 2) = #{cltvtnZone}
        </if>
        <if test='cltvtnFcltZoneId != null and cltvtnFcltZoneId != ""'>
            AND SP.FCLT_ZONE_ID = #{cltvtnFcltZoneId}
        </if>
        <if test='sdlngNo != null and sdlngNo != ""'>
            AND SI.SDNLG_NO = #{sdlngNo}
        </if>
        <![CDATA[
            ORDER BY
                  SI.SDNLG_NO
                , SP.PLNTNG_NO
        ]]>
    </select>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.insertCltvtnList			-->
    <!-- DESC : 재배장 목록 등록.	                                       						-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.15  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <insert id="insertCltvtnList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
		<![CDATA[
            INSERT INTO TB_SDNLG_PLNTNG (
                  APC_CD
                , PLNTNG_NO
                , SDNLG_NO
                , PLNTNG_YMD
                , FCLT_ZONE_ID
                , PLNTNG_QNTT
                , HRVST_YMD
                , RMRK
                , DEL_YN
                , SYS_FRST_INPT_DT
                , SYS_FRST_INPT_USER_ID
                , SYS_FRST_INPT_PRGRM_ID
                , SYS_LAST_CHG_DT
                , SYS_LAST_CHG_USER_ID
                , SYS_LAST_CHG_PRGRM_ID
            ) VALUES (
                  #{apcCd}
                , #{plntngNo}
                , #{sdlngNo}
                , #{plntngYmd}
                , #{fcltZoneId}
                , #{plntngQntt}
                , #{hrvstYmd}
                , #{rmrk}
                , 'N'
                , SYSDATE
                , #{sysFrstInptUserId}
                , #{sysFrstInptPrgrmId}
                , SYSDATE
                , #{sysLastChgUserId}
                , #{sysLastChgPrgrmId}
            )
        ]]>
	</insert>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.updateCltvtnList			-->
    <!-- DESC : 재배장 목록 수정.	                                       						-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.15  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <update id="updateCltvtnList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
		<![CDATA[
            UPDATE TB_SDNLG_PLNTNG
            SET
                  PLNTNG_YMD = #{plntngYmd}
                , PLNTNG_QNTT = #{plntngQntt}
                , FCLT_ZONE_ID = #{fcltZoneId}
                , RMRK = #{rmrk}
                , SYS_LAST_CHG_DT = SYSDATE
                , SYS_LAST_CHG_USER_ID = #{sysLastChgUserId}
                , SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
            WHERE APC_CD = #{apcCd}
            AND PLNTNG_NO = #{plntngNo}
            AND SDNLG_NO = #{sdlngNo}
        ]]>
	</update>

    <!-- ==================================================================================	-->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.deleteCltvtnList	        -->
    <!-- DESC : 재배장 목록 삭제.                                             			        -->
    <!-- ==================================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      			        -->
    <!-- ===========  	============  	===================================================	-->
    <!-- 2025.09.16  	최지호        	Initial Creation                                    -->
    <!-- ==================================================================================	-->
    <update id="deleteCltvtnList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
    	<![CDATA[
            UPDATE TB_SDNLG_PLNTNG
            SET DEL_YN = 'Y'
            WHERE APC_CD = #{apcCd}
            AND PLNTNG_NO = #{plntngNo}
            AND SDNLG_NO = #{sdlngNo}
        ]]>
    </update>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.selectWgh			        -->
    <!-- DESC : 계량 목록 단건 조회.	                                       					-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.16  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <select id="selectWgh" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO" resultType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
        <![CDATA[
            SELECT
                  SH.APC_CD AS APC_CD
                , SH.PLNTNG_NO AS PLNTNG_NO
                , SH.WGH_YMD AS WGH_YMD
                , SH.WGH_SEQ AS WGH_SEQ
                , SH.WGH_WGHT AS WGH_WGHT
                , SH.ACTL_WGHT AS ACTL_WGHT
                , SH.SPMT_PCKG_UNIT_CD AS SPMT_PCKG_UNIT_CD
                , SH.PCKG_QNTT AS PCKG_QNTT
                , SH.PCKG_WGHT AS PCKG_WGHT
                , SH.RMRK AS RMRK
                , SH.DEL_YN AS DEL_YN
            FROM TB_SDNLG_HRVST SH
            WHERE SH.APC_CD = #{apcCd}
            AND SH.DEL_YN = 'N'
        ]]>
        <if test='plntngNo != null and plntngNo != ""'>
            AND SH.PLNTNG_NO = #{plntngNo}
        </if>
    </select>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.selectWghList			    -->
    <!-- DESC : 계량 목록 조회.	                                       					    -->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.16  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <select id="selectWghList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO" resultType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
        <![CDATA[
            SELECT
                  SP.APC_CD AS APC_CD
                , SP.PLNTNG_NO AS CLTVTN_PLNTNG_NO
                , SH.PLNTNG_NO AS WGH_PLNTNG_NO
                , SH.WGH_SEQ AS WGH_SEQ
                , SI.SDNLG_CD AS SDLNG_CD
                , SP.FCLT_ZONE_ID AS CLTVTN_FCLT_ZONE_ID
                , SP.PLNTNG_QNTT AS CLTVTN_PLNTNG_QNTT
                , SH.DEL_YN AS DEL_YN
                , SH.WGH_YMD AS WGH_YMD
                , SH.WGH_WGHT AS WGH_WGHT
                , SH.ACTL_WGHT AS ACTL_WGHT
                , SH.SPMT_PCKG_UNIT_CD AS SPMT_PCKG_UNIT_CD
                , SH.PCKG_QNTT AS PCKG_QNTT
                , SH.PCKG_WGHT AS PCKG_WGHT
                , SI.SDNG_YMD AS SDNG_YMD
                , SP.PLNTNG_YMD AS PLNTNG_YMD
            FROM TB_SDNLG_INVNTR SI
            LEFT JOIN TB_SDNLG_PLNTNG SP ON SI.SDNLG_NO = SP.SDNLG_NO
			AND SI.APC_CD = SP.APC_CD
            LEFT JOIN TB_SDNLG_HRVST SH ON SP.PLNTNG_NO = SH.PLNTNG_NO
            AND SI.APC_CD = SH.APC_CD
            WHERE SI.DEL_YN = 'N'
            AND SP.DEL_YN = 'N'
            AND SP.APC_CD = #{apcCd}
        ]]>
        <if test='sdngYmdFrom != null and sdngYmdFrom != ""'>
            AND SI.SDNG_YMD <![CDATA[>=]]> #{sdngYmdFrom}
        </if>
        <if test='sdngYmdTo != null and sdngYmdTo != ""'>
            AND SI.SDNG_YMD <![CDATA[<=]]> #{sdngYmdTo}
        </if>
        <if test='wghYmdFrom != null and wghYmdFrom != "" and wghYmdTo != null and wghYmdTo != ""'>
            AND ((SH.WGH_YMD <![CDATA[>=]]> #{wghYmdFrom} AND SH.WGH_YMD <![CDATA[<=]]> #{wghYmdTo}) OR SH.WGH_YMD IS NULL)
        </if>
        <if test='sdlngCd != null and sdlngCd != ""'>
            AND SI.SDNLG_CD = #{sdlngCd}
        </if>
        <if test='cltvtnZone != null and cltvtnZone != ""'>
            AND SUBSTR(SP.FCLT_ZONE_ID, 3, 2) = #{cltvtnZone}
        </if>
        <if test='cltvtnFcltZoneId != null and cltvtnFcltZoneId != ""'>
            AND SP.FCLT_ZONE_ID = #{cltvtnFcltZoneId}
        </if>
        <![CDATA[
            ORDER BY
                  SI.SDNLG_NO
                , SP.PLNTNG_NO
        ]]>
    </select>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.countWghList			    -->
    <!-- DESC : 계량 목록 개수 조회.	                                       					-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.16  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <select id="countWghList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO" resultType="int">
        <![CDATA[
            SELECT COUNT(*)
            FROM TB_SDNLG_HRVST SH
            WHERE SH.APC_CD = #{apcCd}
        ]]>
        <if test='plntngNo != null and plntngNo != ""'>
            AND SH.PLNTNG_NO = #{plntngNo}
        </if>
    </select>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.insertWghList			    -->
    <!-- DESC : 계량 목록 등록.	                                       						-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.10.28  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <insert id="insertWghList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
		<![CDATA[
            INSERT INTO TB_SDNLG_HRVST (
                  APC_CD
                , PLNTNG_NO
                , WGH_YMD
                , WGH_SEQ
                , WGH_WGHT
                , ACTL_WGHT
                , SPMT_PCKG_UNIT_CD
                , PCKG_QNTT
                , PCKG_WGHT
                , RMRK
                , DEL_YN
                , SYS_FRST_INPT_DT
                , SYS_FRST_INPT_USER_ID
                , SYS_FRST_INPT_PRGRM_ID
                , SYS_LAST_CHG_DT
                , SYS_LAST_CHG_USER_ID
                , SYS_LAST_CHG_PRGRM_ID
            ) VALUES (
                  #{apcCd}
                , #{plntngNo}
                , #{wghYmd}
                , #{wghSeq}
                , #{wghWght}
                , #{actlWght}
                , #{spmtPckgUnitCd}
                , #{pckgQntt}
                , #{pckgWght}
                , ''
                , 'N'
                , SYSDATE
                , #{sysFrstInptUserId}
                , #{sysFrstInptPrgrmId}
                , SYSDATE
                , #{sysLastChgUserId}
                , #{sysLastChgPrgrmId}
            )
        ]]>
	</insert>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.updateWghList			    -->
    <!-- DESC : 계량 목록 수정.	                                       						-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.10.28  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <update id="updateWghList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
		<![CDATA[
            UPDATE TB_SDNLG_HRVST
            SET
                  WGH_YMD = #{wghYmd}
                , WGH_WGHT = #{wghWght}
                , ACTL_WGHT = #{actlWght}
                , SPMT_PCKG_UNIT_CD = #{spmtPckgUnitCd}
                , PCKG_QNTT = #{pckgQntt}
                , PCKG_WGHT = #{pckgWght}
                , SYS_LAST_CHG_DT = SYSDATE
                , SYS_LAST_CHG_USER_ID = #{sysLastChgUserId}
                , SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
            WHERE APC_CD = #{apcCd}
            AND PLNTNG_NO = #{plntngNo}
            AND WGH_SEQ = #{wghSeq}
        ]]>
	</update>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.saveHrvstYmd			    -->
    <!-- DESC : 수확일자 저장.	                                       						-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.15  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <update id="saveHrvstYmd" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
		<![CDATA[
            UPDATE TB_SDNLG_PLNTNG
            SET
                  HRVST_YMD = #{wghYmd}
                , SYS_LAST_CHG_DT = SYSDATE
                , SYS_LAST_CHG_USER_ID = #{sysLastChgUserId}
                , SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
            WHERE APC_CD = #{apcCd}
            AND PLNTNG_NO = #{plntngNo}
        ]]>
	</update>

    <!-- ==================================================================================	-->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.deleteWghList	            -->
    <!-- DESC : 계량 목록 삭제.                                             			        -->
    <!-- ==================================================================================	-->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      			        -->
    <!-- ===========  	============  	===================================================	-->
    <!-- 2025.10.28  	최지호        	Initial Creation                                    -->
    <!-- ==================================================================================	-->
    <update id="deleteWghList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
    	<![CDATA[
            UPDATE TB_SDNLG_HRVST
            SET DEL_YN = 'Y'
            WHERE APC_CD = #{apcCd}
            AND PLNTNG_NO = #{plntngNo}
        ]]>
    </update>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.selectSpmtList			    -->
    <!-- DESC : 출고 목록 조회.	                                       					    -->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.16  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <select id="selectSpmtList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO" resultType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
        <![CDATA[
            SELECT
                  PD.APC_CD AS APC_CD
                , PD.SPMTNO AS SPMTNO
                , PC.SPMT_YMD AS SPMT_YMD
                , PD.ITEM_CD AS ITEM_CD
                , PD.VRTY_CD AS VRTY_CD
                , PD.SPCFCT_CD AS SPCFCT_CD
                , PD.GDS_GRD AS GDS_GRD
                , PD.SPMT_PCKG_UNIT_CD AS SPMT_PCKG_UNIT_CD
                , MAX(PC.CNPT_CD) AS CNPT_CD
                , MAX(PC.RMRK) AS RMRK
                , MAX(PC.DEL_YN) AS DEL_YN
                , MAX(PD.PCKGNO) AS PCKGNO
                , SUM(PD.SPMT_QNTT) AS SPMT_QNTT
                , SUM(PD.SPMT_WGHT) AS SPMT_WGHT
            FROM
                  TB_SPMT_PRFMNC_COM PC
                , TB_SPMT_PRFMNC_DTL PD
            WHERE PC.APC_CD = PD.APC_CD
            AND PC.SPMTNO = PD.SPMTNO
            AND PC.DEL_YN = 'N'
            AND PD.DEL_YN = 'N'
            AND PC.APC_CD = #{apcCd}
        ]]>
        <if test='spmtYmdFrom != null and spmtYmdFrom != ""'>
            AND PC.SPMT_YMD <![CDATA[>=]]> #{spmtYmdFrom}
        </if>
        <if test='spmtYmdTo != null and spmtYmdTo != ""'>
            AND PC.SPMT_YMD <![CDATA[<=]]> #{spmtYmdTo}
        </if>
        <if test='vrtyCd != null and vrtyCd != ""'>
            AND PD.VRTY_CD = #{vrtyCd}
        </if>
        <if test='cnptCd != null and cnptCd != ""'>
            AND PC.CNPT_CD = #{cnptCd}
        </if>
        <![CDATA[
            GROUP BY
                  PD.APC_CD
                , PD.SPMTNO
                , PC.SPMT_YMD
                , PD.ITEM_CD
                , PD.VRTY_CD
                , PD.SPCFCT_CD
                , PD.GDS_GRD
                , PD.SPMT_PCKG_UNIT_CD
            ORDER BY PD.SPMTNO
        ]]>
    </select>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.insertSpmtPrfmncComList		-->
    <!-- DESC : 출고 공통 목록 등록.	                                       					-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.10.28  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <insert id="insertSpmtPrfmncComList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
		<![CDATA[
            INSERT INTO TB_SPMT_PRFMNC_COM (
                  APC_CD
                , SPMTNO
                , SPMT_YMD
                , CNPT_CD
                , RMRK
                , DEL_YN
                , SYS_FRST_INPT_DT
                , SYS_FRST_INPT_USER_ID
                , SYS_FRST_INPT_PRGRM_ID
                , SYS_LAST_CHG_DT
                , SYS_LAST_CHG_USER_ID
                , SYS_LAST_CHG_PRGRM_ID
            ) VALUES (
                  #{apcCd}
                , #{spmtno}
                , #{spmtYmd}
                , #{cnptCd}
                , #{rmrk}
                , 'N'
                , SYSDATE
                , #{sysFrstInptUserId}
                , #{sysFrstInptPrgrmId}
                , SYSDATE
                , #{sysLastChgUserId}
                , #{sysLastChgPrgrmId}
            )
        ]]>
	</insert>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.insertSpmtPrfmncDtlList		-->
    <!-- DESC : 출고 상세 목록 등록.	                                       					-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.10.28  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <insert id="insertSpmtPrfmncDtlList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
		<![CDATA[
            INSERT INTO TB_SPMT_PRFMNC_DTL (
                  APC_CD
                , SPMTNO
                , SPMT_SN
                , PCKGNO
                , PCKG_SN
                , VRTY_CD
                , ITEM_CD
                , SPMT_QNTT
                , SPMT_WGHT
                , SPMT_PCKG_UNIT_CD
                , RMRK
                , DEL_YN
                , SYS_FRST_INPT_DT
                , SYS_FRST_INPT_USER_ID
                , SYS_FRST_INPT_PRGRM_ID
                , SYS_LAST_CHG_DT
                , SYS_LAST_CHG_USER_ID
                , SYS_LAST_CHG_PRGRM_ID
            ) VALUES (
                  #{apcCd}
                , #{spmtno}
                , '1'
                , #{pckgno}
                , '1'
                , #{vrtyCd}
                , #{itemCd}
                , #{spmtQntt}
                , #{spmtWght}
                , #{spmtPckgUnitCd}
                , #{rmrk}
                , 'N'
                , SYSDATE
                , #{sysFrstInptUserId}
                , #{sysFrstInptPrgrmId}
                , SYSDATE
                , #{sysLastChgUserId}
                , #{sysLastChgPrgrmId}
            )
        ]]>
	</insert>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.updateSpmtPrfmncComList		-->
    <!-- DESC : 출고 공통 목록 수정.	                                       					-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.10.28  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <update id="updateSpmtPrfmncComList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
		<![CDATA[
            UPDATE TB_SPMT_PRFMNC_COM
            SET
                  SPMT_YMD = #{spmtYmd}
                , CNPT_CD = #{cnptCd}
                , RMRK = #{rmrk}
                , SYS_LAST_CHG_DT = SYSDATE
                , SYS_LAST_CHG_USER_ID = #{sysLastChgUserId}
                , SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
            WHERE APC_CD = #{apcCd}
            AND SPMTNO = #{spmtno}
        ]]>
	</update>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.updateSpmtPrfmncDtlList		-->
    <!-- DESC : 출고 상세 목록 수정.	                                       					-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.10.28  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <update id="updateSpmtPrfmncDtlList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
		<![CDATA[
            UPDATE TB_SPMT_PRFMNC_DTL
            SET
                  ITEM_CD = #{itemCd}
                , VRTY_CD = #{vrtyCd}
                , SPMT_QNTT = #{spmtQntt}
                , SPMT_WGHT = #{spmtWght}
                , SPMT_PCKG_UNIT_CD = #{spmtPckgUnitCd}
                , RMRK = #{rmrk}
                , SYS_LAST_CHG_DT = SYSDATE
                , SYS_LAST_CHG_USER_ID = #{sysLastChgUserId}
                , SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
            WHERE APC_CD = #{apcCd}
            AND SPMTNO = #{spmtno}
            AND PCKGNO = #{pckgno}
        ]]>
	</update>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.deleteSpmtPrfmncComList		-->
    <!-- DESC : 출고 공통 목록 삭제.	                                       					-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.15  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <update id="deleteSpmtPrfmncComList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
		<![CDATA[
            UPDATE TB_SPMT_PRFMNC_COM
            SET
                  DEL_YN = 'Y'
                , SYS_LAST_CHG_DT = SYSDATE
                , SYS_LAST_CHG_USER_ID = #{sysLastChgUserId}
                , SYS_LAST_CHG_PRGRM_ID = #{sysLastChgPrgrmId}
            WHERE APC_CD = #{apcCd}
            AND SPMTNO = #{spmtno}
        ]]>
	</update>

    <!-- ================================================================================== -->
    <!-- NAME : com.apcmngsys.apcss.am.wrhs.mapper.RawMtrWrhsIgiMapper.deleteSpmtPrfmncDtlList		-->
    <!-- DESC : 출고 상세 목록 삭제.	                                       					-->
    <!-- ================================================================================== -->
    <!-- DATE   		AUTHOR        	DESCRIPTION                      					-->
    <!-- ===========  	============  	=================================================== -->
    <!-- 2025.09.15  	최지호        	Initial Creation                        		    -->
    <!-- ================================================================================== -->
    <update id="deleteSpmtPrfmncDtlList" parameterType="com.apcmngsys.apcss.am.wrhs.vo.SdlngVO">
		<![CDATA[
            UPDATE TB_SPMT_PRFMNC_DTL
            SET
                  DEL_YN = 'Y'
                , SYS_LAST_CHG_DT = SYSDATE
                , SYS_LAST_CHG_USER_ID = #{sysLastChgUserId}
                , SYS_LAST_CHG_PRGRM_ID = #{sysLastChgPrgrmId}
            WHERE APC_CD = #{apcCd}
            AND PCKGNO = #{pckgno}
            AND SPMTNO = #{spmtno}
        ]]>
	</update>
</mapper>