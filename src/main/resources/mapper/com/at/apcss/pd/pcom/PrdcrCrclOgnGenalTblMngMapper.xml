<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!-- ==========================================================================	-->
<!-- NAME : BbsMapper.xml                                    				-->
<!-- DESC : 게시판 정보 mapper                                             			-->
<!-- ==========================================================================	-->
<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
<!-- ===========  	============  	===========================================	-->
<!-- 2023.06.29  	jcshin        	Initial Creation                            -->
<!-- ==========================================================================	-->

<mapper namespace="com.at.apcss.pd.pcom.mapper.PrdcrCrclOgnGenalTblMngMapper">

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.bbs.mapper.BbsMngMapper.selectBbs				-->
	<!-- DESC : 게시판 테이블 단건조회.                                             		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.06.29  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<select id="selectPrdcrCrclOgnGenalTblMng" parameterType="com.at.apcss.pd.pcom.vo.PrdcrCrclOgnGenalTblMngVO" resultType="com.at.apcss.pd.pcom.vo.PrdcrCrclOgnGenalTblMngVO">
		SELECT /* com.at.apcss.pd.pcom.mapper.PrdcrCrclOgnGenalTblMngMapper.selectPrdcrCrclOgnGenalTblMng */
			'a' as BRNO
		FROM DUAL
		WHERE 1=1
	</select>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.bbs.mapper.BbsMngMapper.selectBbsList			-->
	<!-- DESC : 게시판 테이블 목록 조회.                                             		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.06.29  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<select id="selectPrdcrCrclOgnGenalTblMngList" parameterType="com.at.apcss.pd.pcom.vo.ItemUoStbltYnVO" resultType="com.at.apcss.pd.pcom.vo.ItemUoStbltYnVO">
		SELECT	/* com.at.apcss.pd.isom.mapper.InvShipOgnSpeczItmPurSalMngMapper.selectItemStbltYn */
			TOTAL.ITEM_CD
			,TOTAL.ITEM_NM
			,TOTAL.STTG_UPBR_ITEM_SE
			,TOTAL.STTG_UPBR_ITEM_NM
			,TOTAL.CTGRY_CD
			,TOTAL.CTGRY_NM
			,TOTAL.BRNO
			,TOTAL.YR
			,TOTAL.APRV
			,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'APRV_UPBR_SE_CD' AND CD_VL = TOTAL.APRV) AS APRV_NM
			,TOTAL.CORP_NM
			,TOTAL.SLS_CNSGN_SLS_AMT
			,TOTAL.SLS_CNSGN_SLS_AMT_TOT
			,TOTAL.SLS_CNSGN_SLS_AMT_RT

			/*예외*/
			,TOTAL.CHK_ITEM_A /*CTGRY_CD 2*/
			,TOTAL.CHK_ITEM_B /*CTGRY_CD 3*/

			/* 총취급액 최저 금액 */
			,TOTAL.CHK_AMT_TOT_A_A
			,TOTAL.CHK_AMT_TOT_A_B
			,TOTAL.CHK_AMT_TOT_A_C

			,TOTAL.CHK_AMT_TOT_B_A
			,TOTAL.CHK_AMT_TOT_B_B
			,TOTAL.CHK_AMT_TOT_B_C

			,TOTAL.CHK_AMT_TOT_C_A
			,TOTAL.CHK_AMT_TOT_C_B
			,TOTAL.CHK_AMT_TOT_C_C

			/* 총취급액 전속 취급률 기준 금액 */
			,TOTAL.CHK_A_A
			,TOTAL.CHK_A_B
			,TOTAL.CHK_A_C

			,TOTAL.CHK_B_A
			,TOTAL.CHK_B_B
			,TOTAL.CHK_B_C

			/*전속취급률 */
			,TOTAL.CHK_RT_A_A
			,TOTAL.CHK_RT_A_B
			,TOTAL.CHK_RT_A_C

			,TOTAL.CHK_RT_B_A
			,TOTAL.CHK_RT_B_B
			,TOTAL.CHK_RT_B_C

			,TOTAL.CHK_RT_C

			/*APRV 1승인형 2육성형 */
			/*STTG_UPBR_ITEM_SE 1전문품목 2육성품목 */
			/*CTGRY_CD 1과실 2시설 3노지*/
			, (CASE WHEN TOTAL.APRV = '1' AND TOTAL.STTG_UPBR_ITEM_SE = '1' AND TOTAL.CTGRY_CD ='1'
						THEN (CASE WHEN TOTAL.CHK_A_A = 'A' AND TOTAL.CHK_AMT_TOT_A_A = 'Y' AND TOTAL.CHK_RT_A_A = 'Y' THEN 'Y'
									WHEN TOTAL.CHK_A_A = 'B' AND TOTAL.CHK_AMT_TOT_A_A = 'Y' AND TOTAL.CHK_RT_A_B = 'Y' THEN 'Y'
									WHEN TOTAL.CHK_A_A = 'C' AND TOTAL.CHK_AMT_TOT_A_A = 'Y' AND TOTAL.CHK_RT_A_C = 'Y' THEN 'Y'
									ELSE 'N' END)
					WHEN TOTAL.APRV = '1' AND TOTAL.STTG_UPBR_ITEM_SE = '1' AND ( TOTAL.CTGRY_CD ='2' OR TOTAL.CHK_ITEM_A = 'Y')
						THEN (CASE WHEN TOTAL.CHK_A_B = 'A' AND TOTAL.CHK_AMT_TOT_A_B = 'Y' AND TOTAL.CHK_RT_A_A = 'Y' THEN 'Y'
									WHEN TOTAL.CHK_A_B = 'B' AND TOTAL.CHK_AMT_TOT_A_B = 'Y' AND TOTAL.CHK_RT_A_B = 'Y' THEN 'Y'
									WHEN TOTAL.CHK_A_B = 'C' AND TOTAL.CHK_AMT_TOT_A_B = 'Y' AND TOTAL.CHK_RT_A_C = 'Y' THEN 'Y'
									ELSE 'N' END)
					WHEN TOTAL.APRV = '1' AND TOTAL.STTG_UPBR_ITEM_SE = '1' AND ( TOTAL.CTGRY_CD ='3' OR TOTAL.CHK_ITEM_B = 'Y')
						THEN (CASE WHEN TOTAL.CHK_A_C = 'A' AND TOTAL.CHK_AMT_TOT_A_C = 'Y' AND TOTAL.CHK_RT_A_A = 'Y' THEN 'Y'
									WHEN TOTAL.CHK_A_C = 'B' AND TOTAL.CHK_AMT_TOT_A_C = 'Y' AND TOTAL.CHK_RT_A_B = 'Y' THEN 'Y'
									WHEN TOTAL.CHK_A_C = 'C' AND TOTAL.CHK_AMT_TOT_A_C = 'Y' AND TOTAL.CHK_RT_A_C = 'Y' THEN 'Y'
									ELSE 'N' END)

					WHEN TOTAL.APRV = '1' AND TOTAL.STTG_UPBR_ITEM_SE = '2' AND TOTAL.CTGRY_CD ='1'
						THEN (CASE WHEN TOTAL.CHK_B_A = 'A' AND TOTAL.CHK_AMT_TOT_B_A = 'Y' AND TOTAL.CHK_RT_B_A = 'Y' THEN 'Y'
									WHEN TOTAL.CHK_B_A = 'B' AND TOTAL.CHK_AMT_TOT_B_A = 'Y' AND TOTAL.CHK_RT_B_B = 'Y' THEN 'Y'
									WHEN TOTAL.CHK_B_A = 'C' AND TOTAL.CHK_AMT_TOT_B_A = 'Y' AND TOTAL.CHK_RT_B_C = 'Y' THEN 'Y'
									ELSE 'N' END)
					WHEN TOTAL.APRV = '1' AND TOTAL.STTG_UPBR_ITEM_SE = '2' AND ( TOTAL.CTGRY_CD ='2' OR TOTAL.CHK_ITEM_A = 'Y')
						THEN (CASE WHEN TOTAL.CHK_B_B = 'A' AND TOTAL.CHK_AMT_TOT_B_B = 'Y' AND TOTAL.CHK_RT_B_A = 'Y' THEN 'Y'
									WHEN TOTAL.CHK_B_B = 'B' AND TOTAL.CHK_AMT_TOT_B_B = 'Y' AND TOTAL.CHK_RT_B_B = 'Y' THEN 'Y'
									WHEN TOTAL.CHK_B_B = 'C' AND TOTAL.CHK_AMT_TOT_B_B = 'Y' AND TOTAL.CHK_RT_B_C = 'Y' THEN 'Y'
									ELSE 'N' END)
					WHEN TOTAL.APRV = '1' AND TOTAL.STTG_UPBR_ITEM_SE = '2' AND ( TOTAL.CTGRY_CD ='3' OR TOTAL.CHK_ITEM_B = 'Y')
						THEN (CASE WHEN TOTAL.CHK_B_C = 'A' AND TOTAL.CHK_AMT_TOT_B_C = 'Y' AND TOTAL.CHK_RT_B_A = 'Y' THEN 'Y'
									WHEN TOTAL.CHK_B_C = 'B' AND TOTAL.CHK_AMT_TOT_B_C = 'Y' AND TOTAL.CHK_RT_B_B = 'Y' THEN 'Y'
									WHEN TOTAL.CHK_B_C = 'C' AND TOTAL.CHK_AMT_TOT_B_C = 'Y' AND TOTAL.CHK_RT_B_C = 'Y' THEN 'Y'
									ELSE 'N' END)

					WHEN  TOTAL.APRV = '2' AND TOTAL.CTGRY_CD ='1'
						THEN (CASE WHEN  TOTAL.CHK_AMT_TOT_C_A = 'Y' AND TOTAL.CHK_RT_C = 'Y'
									THEN 'Y'
									ELSE 'N' END)
					WHEN  TOTAL.APRV = '2' AND TOTAL.CTGRY_CD ='2'
						THEN (CASE WHEN  TOTAL.CHK_AMT_TOT_C_B = 'Y' AND TOTAL.CHK_RT_C = 'Y'
									THEN 'Y'
									ELSE 'N' END)
					WHEN  TOTAL.APRV = '2' AND TOTAL.CTGRY_CD ='3'
						THEN (CASE WHEN  TOTAL.CHK_AMT_TOT_C_C = 'Y' AND TOTAL.CHK_RT_C = 'Y'
									THEN 'Y'
									ELSE 'N' END)
					ELSE 'N' END
			) AS STBLT_YN
			,TOTAL.ORG_STBLT_YN
		FROM
				(SELECT
					TOT.ITEM_CD
					,TOT.ITEM_NM
					,TOT.STTG_UPBR_ITEM_SE
					,TOT.STTG_UPBR_ITEM_NM
					,TOT.CTGRY_CD
					,TOT.CTGRY_NM
					,TOT.BRNO
					,TOT.YR
					,TOT.APRV
					,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'APRV_UPBR_SE_CD' AND CD_VL = TOT.APRV) AS APRV_NM
					,TOT.CORP_NM

					,TOT.SLS_CNSGN_SLS_AMT
					,TOT.SLS_CNSGN_SLS_AMT_TOT
					,TOT.SLS_CNSGN_SLS_AMT_RT

					/*60억 참다래 0611 자두 0608 블루베리 0659 블랙베리 0664 구즈베리 0676 구스베리 0678*/
					/* 40억 오이 0901 호박 0902 가지 0903*/
					,(CASE WHEN ITEM_CD = '0611' THEN 'Y'
								WHEN ITEM_CD = '0608' THEN 'Y'
								WHEN ITEM_CD = '0659' THEN 'Y'
								WHEN ITEM_CD = '0664' THEN 'Y'
								WHEN ITEM_CD = '0676' THEN 'Y'
								WHEN ITEM_CD = '0678' THEN 'Y'
								ELSE 'N' END) AS CHK_ITEM_A

					,(CASE WHEN ITEM_CD = '0901' THEN 'Y'
								WHEN ITEM_CD = '0902' THEN 'Y'
								WHEN ITEM_CD = '0903' THEN 'Y'
								ELSE 'N' END) AS CHK_ITEM_B

					/* 총취급액 최저 금액 */
					/*승인형 전문품목*/
					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 10000000 THEN 'Y' ELSE 'N' END) AS CHK_AMT_TOT_A_A
					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 7000000 THEN 'Y' ELSE 'N' END) AS CHK_AMT_TOT_A_B
					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 5000000 THEN 'Y' ELSE 'N' END) AS CHK_AMT_TOT_A_C
					/*승인형 육성품목*/
					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 5000000 THEN 'Y' ELSE 'N' END) AS CHK_AMT_TOT_B_A
					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 3500000 THEN 'Y' ELSE 'N' END) AS CHK_AMT_TOT_B_B
					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 2500000 THEN 'Y' ELSE 'N' END) AS CHK_AMT_TOT_B_C
					/* 육성형 */
					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT >= 4000000 THEN 'Y' ELSE 'N' END) AS CHK_AMT_TOT_C_A
					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT >= 3000000 THEN 'Y' ELSE 'N' END) AS CHK_AMT_TOT_C_B
					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT >= 2000000 THEN 'Y' ELSE 'N' END) AS CHK_AMT_TOT_C_C

					/* 총취급액 전속 취급률 기준 금액 */
					<![CDATA[
					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 30000000 THEN 'A'
								WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 15000000 AND TOT.SLS_CNSGN_SLS_AMT_TOT < 30000000 THEN 'B'
								WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 10000000 AND TOT.SLS_CNSGN_SLS_AMT_TOT < 15000000 THEN 'C'
								ELSE 'N' END
					) AS CHK_A_A
					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 15000000 THEN 'A'
								WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 10000000 AND TOT.SLS_CNSGN_SLS_AMT_TOT < 15000000 THEN 'B'
								WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 7000000 AND TOT.SLS_CNSGN_SLS_AMT_TOT < 10000000 THEN 'C'
								ELSE 'N' END
					) AS CHK_A_B
					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 10000000 THEN 'A'
								WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 7000000 AND TOT.SLS_CNSGN_SLS_AMT_TOT < 10000000 THEN 'B'
								WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 5000000 AND TOT.SLS_CNSGN_SLS_AMT_TOT < 7000000 THEN 'C'
								ELSE 'N' END
					) AS CHK_A_C

					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 15000000 THEN 'A'
								WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 7500000 AND TOT.SLS_CNSGN_SLS_AMT_TOT < 15000000 THEN 'B'
								WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 5000000 AND TOT.SLS_CNSGN_SLS_AMT_TOT < 7500000 THEN 'C'
								ELSE 'N' END
					) AS CHK_B_A
					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 7500000 THEN 'A'
								WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 5000000 AND TOT.SLS_CNSGN_SLS_AMT_TOT < 7500000 THEN 'B'
								WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 3500000 AND TOT.SLS_CNSGN_SLS_AMT_TOT < 5000000 THEN 'C'
								ELSE 'N' END
					) AS CHK_B_B
					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 5000000 THEN 'A'
								WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 3500000 AND TOT.SLS_CNSGN_SLS_AMT_TOT < 5000000 THEN 'B'
								WHEN TOT.SLS_CNSGN_SLS_AMT_TOT >= 2500000 AND TOT.SLS_CNSGN_SLS_AMT_TOT < 3500000 THEN 'C'
								ELSE 'N' END
					) AS CHK_B_C
					]]>
					/*전속취급률 */
					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT_RT >= 50 THEN 'Y' ELSE 'N' END) AS CHK_RT_A_A
					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT_RT >= 60 THEN 'Y' ELSE 'N' END) AS CHK_RT_A_B
					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT_RT >= 70 THEN 'Y' ELSE 'N' END) AS CHK_RT_A_C

					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT_RT >= 25 THEN 'Y' ELSE 'N' END) AS CHK_RT_B_A
					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT_RT >= 30 THEN 'Y' ELSE 'N' END) AS CHK_RT_B_B
					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT_RT >= 35 THEN 'Y' ELSE 'N' END) AS CHK_RT_B_C

					,(CASE WHEN TOT.SLS_CNSGN_SLS_AMT_RT >= 30 THEN 'Y' ELSE 'N' END) AS CHK_RT_C
					,TOT.STBLT_YN AS ORG_STBLT_YN
				FROM
					(SELECT
							ITEM.ITEM_CD
							, ITEM.ITEM_NM
							, ITEM.STTG_UPBR_ITEM_SE
							, ITEM.STTG_UPBR_ITEM_NM
							, ITEM.CTGRY_CD
							, ITEM.CTGRY_NM
							, ITEM.BRNO
							, ITEM.YR
							, (SELECT APRV FROM TB_EV_APO WHERE BRNO = ITEM.BRNO) AS APRV
							, (SELECT CORP_NM FROM TB_EV_APO WHERE BRNO = ITEM.BRNO) AS CORP_NM

							, TOTA.SLS_CNSGN_SLS_AMT 			AS SLS_CNSGN_SLS_AMT

							, TOTB.SLS_CNSGN_SLS_AMT 			AS SLS_CNSGN_SLS_AMT_TOT

							, ROUND(NVL( TOTA.SLS_CNSGN_SLS_AMT  / NULLIF( TOTB.SLS_CNSGN_SLS_AMT  , 0 ) , 0 ) * 100 , 2 ) AS SLS_CNSGN_SLS_AMT_RT
							, (SELECT STBLT_YN
								FROM TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT
								WHERE 1=1
								  AND APO_SE = '1'
								  AND TYPE_SE_NO ='8'
								  AND BRNO = ITEM.BRNO
								  AND YR = ITEM.YR
								  AND ITEM_CD = ITEM.ITEM_CD
							) AS STBLT_YN
						FROM
							(SELECT
									ITEM_CD
									, YR
									, STTG_UPBR_ITEM_SE
									, CTGRY_CD
									, TO_CHAR(BRNO) AS BRNO
									,(SELECT ITEM_NM FROM TB_ITEM_CRTR WHERE ITEM_CD = AYGC.ITEM_CD) AS ITEM_NM
									,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'CTGRY_CD' AND CD_VL = AYGC.CTGRY_CD) AS CTGRY_NM
									,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'STTG_UPBR_ITEM_SE' AND CD_VL = AYGC.STTG_UPBR_ITEM_SE) AS STTG_UPBR_ITEM_NM
								FROM TB_EV_APO_YR_GPC_CD AYGC
								WHERE 1=1

								<if test='brno != null and brno != ""'>
								  AND BRNO = #{brno}
								</if>
								<if test='yr != null and yr != ""'>
								  AND YR = #{yr}
								</if>

							) ITEM ,
							(SELECT
									BRNO
									, ITEM_CD
									, SUM( NVL( SLS_CNSGN_SLS_AMT , 0 ) ) AS SLS_CNSGN_SLS_AMT
								FROM TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT
								WHERE 1=1
								AND APO_SE = '1'
								AND TYPE_SE_NO IN ('2','6')
								AND (
										(PRDCR_OGNZ_SN IN (SELECT PRDCR_OGNZ_SN
															FROM TB_EV_FRMHS_APO
															WHERE 1=1
															  AND STBLT_YN = 'Y'
															  AND APO_SE = '1'
															<if test='brno != null and brno != ""'>
															  AND BRNO = #{brno}
															</if>
															<if test='yr != null and yr != ""'>
															  AND YR = #{yr}
															</if>
															)
										)OR
										(PRDCR_OGNZ_SN = '0')
									)
								<if test='brno != null and brno != ""'>
								  AND BRNO = #{brno}
								</if>
								<if test='yr != null and yr != ""'>
								  AND YR = #{yr}
								</if>

								GROUP BY  BRNO , ITEM_CD
							) TOTA ,
							(SELECT
									BRNO
									, ITEM_CD
									, SUM( NVL( SLS_CNSGN_SLS_AMT , 0 ) ) AS SLS_CNSGN_SLS_AMT
								FROM TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT
								WHERE 1=1
								AND APO_SE = '1'
								AND TYPE_SE_NO IN ('2','3','6','7')
								AND (
										(PRDCR_OGNZ_SN IN (SELECT PRDCR_OGNZ_SN
															FROM TB_EV_FRMHS_APO
															WHERE 1=1
															  AND STBLT_YN = 'Y'
															  AND APO_SE = '1'
															<if test='brno != null and brno != ""'>
															  AND BRNO = #{brno}
															</if>
															<if test='yr != null and yr != ""'>
															  AND YR = #{yr}
															</if>
															)
										)OR
										(PRDCR_OGNZ_SN = '0')
									)
								<if test='brno != null and brno != ""'>
								  AND BRNO = #{brno}
								</if>
								<if test='yr != null and yr != ""'>
								  AND YR = #{yr}
								</if>

								GROUP BY  BRNO , ITEM_CD
							) TOTB
						WHERE 1=1
						AND ITEM.ITEM_CD = TOTA.ITEM_CD(+)
						AND ITEM.ITEM_CD = TOTB.ITEM_CD(+)
				)TOT
		)TOTAL
	</select>

	<select id="selectPrdcrCrclOgnGenalTblMngUoList" parameterType="com.at.apcss.pd.pcom.vo.PrdcrCrclOgnGenalTblMngVO" resultType="com.at.apcss.pd.pcom.vo.PrdcrCrclOgnGenalTblMngVO">
		<!-- Start 페이징 -->
		<if test='pagingYn != null and pagingYn.equals("Y")'>
			SELECT
				  ROWNUM AS ROW_SEQ
				, COUNT(*) OVER() AS TOTAL_RECORD_COUNT
				, pt0.*
			  FROM (
		</if>

		SELECT /* com.at.apcss.pd.pcom.mapper.PrdcrCrclOgnGenalTblMngMapper.selectPrdcrCrclOgnGenalTblMngUoList */
			TEA.APO_CD
			,TEA.APO_SE
			,TEA.BRNO
			,TEA.CRNO
			,TEA.CTPV
			,TEA.SGG
			,TEA.CORP_NM
			,TEA.CORP_SE_CD
			,TEAM.YR
		FROM TB_EV_APO TEA
			,TB_EV_APLY_MNG TEAM
		WHERE 1=1
		  AND TEA.BRNO = TEAM.BRNO(+)
		  AND TEA.APO_SE = '1'
		  <if test='brno != null and brno != ""'>
		  AND TEA.BRNO = #{brno}
		  </if>
		  <if test='yr != null and yr != ""'>
		  AND TEAM.YR = #{yr}
		  </if>
		  <if test='cmptnInst != null and cmptnInst != ""'>
		  AND TEA.CMPTN_INST = #{cmptnInst}
		  </if>
		  <if test='ctpv != null and ctpv != ""'>
		  AND TEA.CTPV = #{ctpv}
		  </if>

		  <if test='corpSeCd != null and corpSeCd != ""'>
		  AND TEA.CORP_SE_CD = #{corpSeCd}
		  </if>
		  <if test='corpDtlSeCd != null and corpDtlSeCd != ""'>
		  AND TEA.CORP_DTL_SE_CD = #{corpDtlSeCd}
		  </if>
		  <if test='corpNm != null and corpNm != ""'>
		  AND CM.CORP_NM LIKE '%' || #{corpNm} || '%'
		  </if>

		 <!-- 페이징 -->
		<if test='pagingYn != null and pagingYn.equals("Y")'>
			  ) pt0
			OFFSET (#{currentPageNo} - 1) * #{recordCountPerPage} ROWS
			FETCH FIRST #{recordCountPerPage} ROWS ONLY
		</if>
	</select>

	<update id="updateStbltYn" parameterType="com.at.apcss.pd.pcom.vo.PrdcrCrclOgnGenalTblMngVO">
			UPDATE /* com.at.apcss.pd.pcom.mapper.PrdcrCrclOgnGenalTblMngMapper.updateStbltYn */
				TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT
			   SET
				  STBLT_YN				= #{stbltYn}
				, SYS_LAST_CHG_DT		= SYSDATE
				, SYS_LAST_CHG_USER_ID	= #{sysLastChgUserId}
				, SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}

			 WHERE 1=1
			   AND APO_SE 			= '1'
			   AND UO_BRNO 			= '0'
			   AND YR				= #{yr}
			   AND BRNO				= #{brno}
			   AND ITEM_CD 			= #{itemCd}
	</update>

	<!-- 실적 법인체마감 -->
	<update id="updatePrfmncCorpDdlnYn" parameterType="com.at.apcss.pd.pcom.vo.PrdcrCrclOgnGenalTblMngVO">
	    	UPDATE /* com.at.apcss.pd.aom.mapper.PrdcrCrclOgnGenalTblMngMapper.updatePrfmncCorpDdlnYn */
	    		TB_EV_APLY_MNG
			   SET
			 	  PRFMNC_CORP_DDLN_YN	= #{prfmncCorpDdlnYn}
			 WHERE 1=1
				<if test='brno != null and brno != ""'>
				AND BRNO 	= #{brno}
				</if>
				AND YR		= #{yr}
	</update>

	<select id="selectUoStbltYnList" parameterType="com.at.apcss.pd.pcom.vo.ItemUoStbltYnVO" resultType="com.at.apcss.pd.pcom.vo.ItemUoStbltYnVO">
		SELECT
			YR
			,BRNO
		FROM
			TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT
		WHERE 1=1
		  AND APO_SE = '1'
		  AND TYPE_SE_NO ='8'
		  AND YR = TO_CHAR(SYSDATE, 'YYYY')
		GROUP BY
			YR, BRNO
	</select>
</mapper>