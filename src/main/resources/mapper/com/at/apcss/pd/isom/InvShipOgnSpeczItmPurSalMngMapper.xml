<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!-- ==========================================================================	-->
<!-- NAME : BbsMapper.xml                                    				-->
<!-- DESC : 게시판 정보 mapper                                             			-->
<!-- ==========================================================================	-->
<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
<!-- ===========  	============  	===========================================	-->
<!-- 2023.06.29  	jcshin        	Initial Creation                            -->
<!-- ==========================================================================	-->

<mapper namespace="com.at.apcss.pd.isom.mapper.InvShipOgnSpeczItmPurSalMngMapper">

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.bbs.mapper.BbsMngMapper.selectBbs				-->
	<!-- DESC : 게시판 테이블 단건조회.                                             		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.06.29  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
	<select id="selectInvShipOgnSpeczItmPurSalMng" parameterType="com.at.apcss.pd.isom.vo.InvShipOgnSpeczItmPurSalMngVO" resultType="com.at.apcss.pd.isom.vo.InvShipOgnSpeczItmPurSalMngVO">
SELECT * FROM (    /* com.at.apcss.pd.isom.mapper.InvShipOgnSpeczItmPurSalMngMapper.selectInvShipOgnSpeczItmPurSalMng */
--=='5' AS TYPE_SE_NO===출자출하조직 생산자조직======================================

SELECT
	'5' AS TYPE_SE_NO
	,'(생산자조직)전속출하' AS SE_NM
	, UOFA.PRDCR_OGNZ_NM AS PRCHS_NM
	, '0'  AS ISO_BRNO
	, NVL ( UOFA.PRDCR_OGNZ_SN , 0 ) AS PRDCR_OGNZ_SN
	, '0' AS PRDCR_OGNZ_CD
	, '0' AS CLTVTN_LAND_SN
	, ITEM.ITEM_CD AS ITEM_CD
	, ITEM.ITEM_NM || '(' || ITEM.STTG_UPBR_ITEM_NM || ')'  AS ITEM_NM
	, UOFA.TRMT_TYPE
	, (SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'TRMT_TYPE' AND CD_VL = UOFA.TRMT_TYPE) AS TRMT_TYPE_NM
	, UOFA.STTG_UPBR_ITEM_SE
	--, (SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'STTG_UPBR_ITEM_SE' AND CD_VL = UOFA.STTG_UPBR_ITEM_SE) AS STTG_UPBR_ITEM_NM
	, ITEM.YR AS YR
	, UOFA.SPMT_PRC_TOT AS SLS_CNSGN_PRCHS_AMT
	, TOT.SLS_CNSGN_SLS_AMT
	, TOT.UO_SPMT_AMT
	, TOT.UO_OTHER_SPMT_AMT
	, TOT.RMRK
	, TOT.STBLT_YN
FROM
	(SELECT
			FA.PRDCR_OGNZ_SN
			,FA.PRDCR_OGNZ_NM
			,FA.BRNO
			,FA.ITEM_CD
			,FA.UO_BRNO
			,FA.STTG_UPBR_ITEM_SE
			,FA.TRMT_TYPE
			,(SELECT SUM(SPMT_PRC) FROM  TB_EV_FRMHS_PRDCTN_EC_SPMT_STTN WHERE PRDCR_OGNZ_SN = FA.PRDCR_OGNZ_SN  AND  ITEM_CD = FA.ITEM_CD
			) AS SPMT_PRC_TOT
		FROM TB_EV_FRMHS_APO FA
		WHERE FA.BRNO = #{brno}
		  AND FA.UO_BRNO = #{uoBrno}
		  AND YR = #{yr}
		  AND FA.STBLT_YN = 'Y'
		  AND NVL(FA.EXCL_YN,'N') != 'Y'
	)  UOFA ,
	(SELECT
			ITEM_CD
			, YR
			, BRNO
			,(SELECT ITEM_NM FROM TB_ITEM_CRTR WHERE ITEM_CD = AYGC.ITEM_CD) AS ITEM_NM
			,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'STTG_UPBR_ITEM_SE' AND CD_VL = AYGC.STTG_UPBR_ITEM_SE) AS STTG_UPBR_ITEM_NM
		FROM TB_EV_APO_YR_GPC_CD AYGC
		WHERE BRNO = #{uoBrno}
		  AND YR = #{yr}
	) ITEM ,
	(SELECT *
		FROM TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT
		WHERE 1=1
		  AND BRNO = #{brno}
		  AND YR = #{yr}
		  AND UO_BRNO = #{uoBrno}
		  AND APO_SE = '2'
		  AND TYPE_SE_NO = '5'
		  AND PRDCR_OGNZ_SN IN (SELECT PRDCR_OGNZ_SN
			  		  							FROM TB_EV_FRMHS_APO
			  		  							WHERE 1=1
			  		  							  AND APO_SE= '2'
			  		  							  AND STBLT_YN = 'Y'
			  		  							  AND NVL(EXCL_YN,'N') != 'Y'
												  AND BRNO = #{brno}
												  AND UO_BRNO = #{uoBrno}
												  AND YR = #{yr}
					  						)
	) TOT
WHERE 1=1
 AND UOFA.BRNO = TOT.BRNO(+)
 AND ITEM.ITEM_CD = UOFA.ITEM_CD(+)
 AND ITEM.BRNO = UOFA.UO_BRNO(+)

 --=='6' AS TYPE_SE_NO===통합조직 직속 생산자조직 소계======================================
UNION ALL

SELECT
	'6' AS TYPE_SE_NO
	,'(생산자조직)전속출하' AS SE_NM
	, '소계' AS PRCHS_NM
	, '0'  AS ISO_BRNO
	, 0 AS PRDCR_OGNZ_SN
	, '0' AS PRDCR_OGNZ_CD
	,'0' AS CLTVTN_LAND_SN
	, ITEM.ITEM_CD AS ITEM_CD
	, ITEM.ITEM_NM || '(' || ITEM.STTG_UPBR_ITEM_NM || ')'  AS ITEM_NM
	, '' AS TRMT_TYPE
	, '소계' AS TRMT_TYPE_NM
	, '' AS STTG_UPBR_ITEM_SE
	--, '소계' AS STTG_UPBR_ITEM_NM
	, ITEM.YR AS YR
	, 0 AS SLS_CNSGN_PRCHS_AMT
	, TOT.SLS_CNSGN_SLS_AMT
	, TOT.UO_SPMT_AMT
	, TOT.UO_OTHER_SPMT_AMT
	, TOT.RMRK
	, TOT.STBLT_YN
FROM
	(SELECT
			ITEM_CD
			, YR
			,(SELECT ITEM_NM FROM TB_ITEM_CRTR WHERE ITEM_CD = AYGC.ITEM_CD) AS ITEM_NM
			,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'STTG_UPBR_ITEM_SE' AND CD_VL = AYGC.STTG_UPBR_ITEM_SE) AS STTG_UPBR_ITEM_NM
		FROM TB_EV_APO_YR_GPC_CD AYGC
		WHERE BRNO = #{uoBrno}
		  AND YR = #{yr}
	) ITEM ,
	(SELECT *
		FROM TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT
		WHERE 1=1
		  AND BRNO = #{brno}
		  AND YR = #{yr}
		  AND UO_BRNO = #{uoBrno}
		  AND APO_SE = '2'
		  AND TYPE_SE_NO = '6'
	) TOT
WHERE 1=1
	AND ITEM.ITEM_CD = TOT.ITEM_CD(+)

--=='7' AS TYPE_SE_NO===기타매입======================================
UNION ALL

SELECT
	'7' AS TYPE_SE_NO
	,'생산자조직 외' AS SE_NM
	, '농가 , 법인 등' AS PRCHS_NM
	, '0'  AS ISO_BRNO
	, 0 AS PRDCR_OGNZ_SN
	, '0' AS PRDCR_OGNZ_CD
	, '0' AS CLTVTN_LAND_SN
	, ITEM.ITEM_CD AS ITEM_CD
	, ITEM.ITEM_NM || '(' || ITEM.STTG_UPBR_ITEM_NM || ')'  AS ITEM_NM
	, '' AS TRMT_TYPE
	, '' AS TRMT_TYPE_NM
	, '' AS STTG_UPBR_ITEM_SE
	--, '' AS STTG_UPBR_ITEM_NM
	, ITEM.YR AS YR
	, TOT.SLS_CNSGN_PRCHS_AMT
	, TOT.SLS_CNSGN_SLS_AMT
	, TOT.UO_SPMT_AMT
	, TOT.UO_OTHER_SPMT_AMT
	, TOT.RMRK
	, TOT.STBLT_YN
FROM
	(SELECT
			ITEM_CD
			, YR
			,(SELECT ITEM_NM FROM TB_ITEM_CRTR WHERE ITEM_CD = AYGC.ITEM_CD) AS ITEM_NM
			,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'STTG_UPBR_ITEM_SE' AND CD_VL = AYGC.STTG_UPBR_ITEM_SE) AS STTG_UPBR_ITEM_NM
		FROM TB_EV_APO_YR_GPC_CD AYGC
		WHERE BRNO = #{uoBrno}
		  AND YR = #{yr}
	) ITEM ,
	(SELECT *
		FROM TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT
		WHERE 1=1
		  AND BRNO = #{brno}
		  AND YR = #{yr}
		  AND UO_BRNO = #{uoBrno}
		  AND APO_SE = '2'
		  AND TYPE_SE_NO = '7'
	) TOT
WHERE 1=1
	AND ITEM.ITEM_CD = TOT.ITEM_CD(+)

--=='8' AS TYPE_SE_NO===합계======================================
UNION ALL

SELECT
	'8' AS TYPE_SE_NO
	,'합계' AS SE_NM
	, '' AS PRCHS_NM
	, '0'  AS ISO_BRNO
	, 0 AS PRDCR_OGNZ_SN
	, '0' AS PRDCR_OGNZ_CD
	, '0' AS CLTVTN_LAND_SN
	, ITEM.ITEM_CD AS ITEM_CD
	, ITEM.ITEM_NM || '(' || ITEM.STTG_UPBR_ITEM_NM || ')'  AS ITEM_NM
	, '' AS TRMT_TYPE
	, '합계' AS TRMT_TYPE_NM
	, '' AS STTG_UPBR_ITEM_SE
	--, '합계' AS STTG_UPBR_ITEM_NM
	, ITEM.YR AS YR
	, 0 AS SLS_CNSGN_PRCHS_AMT
	, 0 AS SLS_CNSGN_SLS_AMT
	, 0 AS UO_SPMT_AMT
	, 0 AS UO_OTHER_SPMT_AMT
	, TOT.RMRK
	, TOT.STBLT_YN
FROM
	(SELECT
			ITEM_CD
			, YR
			,(SELECT ITEM_NM FROM TB_ITEM_CRTR WHERE ITEM_CD = AYGC.ITEM_CD) AS ITEM_NM
			,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'STTG_UPBR_ITEM_SE' AND CD_VL = AYGC.STTG_UPBR_ITEM_SE) AS STTG_UPBR_ITEM_NM
		FROM TB_EV_APO_YR_GPC_CD AYGC
		WHERE BRNO = #{uoBrno}
		  AND YR = #{yr}
	) ITEM ,
	(SELECT *
		FROM TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT
		WHERE 1=1
		  AND BRNO = #{brno}
		  AND YR = #{yr}
		  AND UO_BRNO = #{uoBrno}
		  AND APO_SE = '2'
		  AND TYPE_SE_NO = '8'
	) TOT
WHERE 1=1
	AND ITEM.ITEM_CD = TOT.ITEM_CD(+)
)
ORDER BY ITEM_CD , TYPE_SE_NO , SE_NM , STTG_UPBR_ITEM_SE , PRCHS_NM
    </select>


	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.fm.bbs.mapper.BbsMngMapper.selectBbsList			-->
	<!-- DESC : 게시판 테이블 목록 조회.                                             		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2023.06.29  	jcshin        	Initial Creation                            -->
	<!-- ==========================================================================	-->
    <select id="selectInvShipOgnSpeczItmPurSalMngList" parameterType="com.at.apcss.pd.isom.vo.InvShipOgnSpeczItmPurSalMngVO" resultType="com.at.apcss.pd.isom.vo.InvShipOgnSpeczItmPurSalMngVO">
SELECT * FROM (    /* com.at.apcss.pd.isom.mapper.InvShipOgnSpeczItmPurSalMngMapper.selectInvShipOgnSpeczItmPurSalMngList */
--=='5' AS TYPE_SE_NO===출자출하조직 생산자조직======================================

SELECT
	'5' AS TYPE_SE_NO
	,'(생산자조직)전속출하' AS SE_NM
	, UOFA.PRDCR_OGNZ_NM AS PRCHS_NM
	, '0'  AS ISO_BRNO
	, NVL ( UOFA.PRDCR_OGNZ_SN , 0 ) AS PRDCR_OGNZ_SN
	, '0' AS PRDCR_OGNZ_CD
	, '0' AS CLTVTN_LAND_SN
	, UOFA.ITEM_CD AS ITEM_CD
	, UOFA.ITEM_NM || '(' || UOFA.STTG_UPBR_ITEM_NM || ')'  AS ITEM_NM
	, UOFA.TRMT_TYPE
	, (SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'TRMT_TYPE' AND CD_VL = UOFA.TRMT_TYPE) AS TRMT_TYPE_NM
	, UOFA.STTG_UPBR_ITEM_SE
	--, (SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'STTG_UPBR_ITEM_SE' AND CD_VL = UOFA.STTG_UPBR_ITEM_SE) AS STTG_UPBR_ITEM_NM
	, UOFA.YR AS YR
	, UOFA.SPMT_PRC_TOT AS SLS_CNSGN_PRCHS_AMT
	, UOFA.EC_SPMT_VLM_TOT AS SLS_CNSGN_PRCHS_VLM
	, TOT.SLS_CNSGN_SLS_AMT
	, TOT.SLS_CNSGN_SLS_VLM
	, TOT.UO_SPMT_AMT
	, TOT.UO_SPMT_VLM
	, TOT.UO_OTHER_SPMT_AMT
	, TOT.UO_OTHER_SPMT_VLM
	, TOT.RMRK
	, UOFA.BRNO AS UO_BRNO
	, TOT.STBLT_YN
FROM
	(SELECT
			FA.PRDCR_OGNZ_SN
			,FA.PRDCR_OGNZ_NM
			,FA.BRNO
			,FA.ITEM_CD
			,(SELECT ITEM_NM FROM TB_ITEM_CRTR WHERE ITEM_CD = FA.ITEM_CD) AS ITEM_NM
			,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'STTG_UPBR_ITEM_SE' AND CD_VL = FA.STTG_UPBR_ITEM_SE)  AS  STTG_UPBR_ITEM_NM
			,FA.UO_BRNO
			,FA.STTG_UPBR_ITEM_SE
			,FA.TRMT_TYPE
			,FA.YR
			,(SELECT SUM(EC_SPMT_VLM) FROM  TB_EV_FRMHS_PRDCTN_EC_SPMT_STTN WHERE PRDCR_OGNZ_SN = FA.PRDCR_OGNZ_SN AND ITEM_CD = FA.ITEM_CD
			) AS EC_SPMT_VLM_TOT
			,(SELECT SUM(SPMT_PRC) FROM  TB_EV_FRMHS_PRDCTN_EC_SPMT_STTN WHERE PRDCR_OGNZ_SN = FA.PRDCR_OGNZ_SN AND ITEM_CD = FA.ITEM_CD
			) AS SPMT_PRC_TOT
		FROM TB_EV_FRMHS_APO FA
		WHERE FA.BRNO = #{brno}
		  AND ITEM_CD IN  (SELECT ITEM_CD FROM TB_EV_APO_YR_GPC_CD WHERE YR = #{yr} AND BRNO = #{uoBrno})
		  AND FA.UO_BRNO = #{uoBrno}
		  AND YR = #{yr}
		  AND FA.STBLT_YN = 'Y'
		  AND NVL(FA.EXCL_YN,'N') != 'Y'
	)  UOFA ,
	(SELECT *
		FROM TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT
		WHERE 1=1
		  AND BRNO = #{brno}
		  AND YR = #{yr}
		  AND UO_BRNO = #{uoBrno}
		  AND TYPE_SE_NO = '5'
		  AND APO_SE ='2'
		  AND PRDCR_OGNZ_SN IN (SELECT PRDCR_OGNZ_SN
			  		  							FROM TB_EV_FRMHS_APO
			  		  							WHERE 1=1
			  		  							  AND APO_SE= '2'
			  		  							  AND STBLT_YN = 'Y'
												  AND BRNO = #{brno}
												  AND UO_BRNO = #{uoBrno}
												  AND YR = #{yr}
					  						)
	) TOT
WHERE 1=1
 AND UOFA.BRNO = TOT.BRNO(+)
 AND UOFA.ITEM_CD = TOT.ITEM_CD(+)
 AND UOFA.PRDCR_OGNZ_SN = TOT.PRDCR_OGNZ_SN(+)

 --=='6' AS TYPE_SE_NO===통합조직 직속 생산자조직 소계======================================
UNION ALL

SELECT
	'6' AS TYPE_SE_NO
	,'(생산자조직)전속출하' AS SE_NM
	, '소계' AS PRCHS_NM
	, '0'  AS ISO_BRNO
	, 0 AS PRDCR_OGNZ_SN
	, '0' AS PRDCR_OGNZ_CD
	,'0' AS CLTVTN_LAND_SN
	, ITEM.ITEM_CD AS ITEM_CD
	, ITEM.ITEM_NM || '(' || ITEM.STTG_UPBR_ITEM_NM || ')'  AS ITEM_NM
	, '' AS TRMT_TYPE
	, '소계' AS TRMT_TYPE_NM
	, '' AS STTG_UPBR_ITEM_SE
	--, '소계' AS STTG_UPBR_ITEM_NM
	, ITEM.YR AS YR
	, 0 AS SLS_CNSGN_PRCHS_AMT
	, 0 AS SLS_CNSGN_PRCHS_VLM
	, TOT.SLS_CNSGN_SLS_AMT
	, TOT.SLS_CNSGN_SLS_VLM
	, TOT.UO_SPMT_AMT
	, TOT.UO_SPMT_VLM
	, TOT.UO_OTHER_SPMT_AMT
	, TOT.UO_OTHER_SPMT_VLM
	, TOT.RMRK
	, TO_CHAR (ITEM.BRNO) AS UO_BRNO
	, TOT.STBLT_YN
FROM
	(SELECT
			ITEM_CD
			, YR
			, BRNO
			,(SELECT ITEM_NM FROM TB_ITEM_CRTR WHERE ITEM_CD = AYGC.ITEM_CD) AS ITEM_NM
			,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'STTG_UPBR_ITEM_SE' AND CD_VL = AYGC.STTG_UPBR_ITEM_SE) AS STTG_UPBR_ITEM_NM
		FROM TB_EV_APO_YR_GPC_CD AYGC
		WHERE BRNO = #{uoBrno}
		  AND YR = #{yr}
	) ITEM ,
	(SELECT *
		FROM TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT
		WHERE 1=1
		  AND BRNO = #{brno}
		  AND UO_BRNO = #{uoBrno}
		  AND YR = #{yr}
		  AND APO_SE = '2'
		  AND TYPE_SE_NO = '6'
	) TOT
WHERE 1=1
	AND ITEM.ITEM_CD = TOT.ITEM_CD(+)

--=='7' AS TYPE_SE_NO===기타매입======================================
UNION ALL

SELECT
	'7' AS TYPE_SE_NO
	,'생산자조직 외' AS SE_NM
	, '농가 , 법인 등' AS PRCHS_NM
	, '0'  AS ISO_BRNO
	, 0 AS PRDCR_OGNZ_SN
	, '0' AS PRDCR_OGNZ_CD
	, '0' AS CLTVTN_LAND_SN
	, ITEM.ITEM_CD AS ITEM_CD
	, ITEM.ITEM_NM || '(' || ITEM.STTG_UPBR_ITEM_NM || ')'  AS ITEM_NM
	, '' AS TRMT_TYPE
	, '' AS TRMT_TYPE_NM
	, '' AS STTG_UPBR_ITEM_SE
	--, '' AS STTG_UPBR_ITEM_NM
	, ITEM.YR AS YR
	, TOT.SLS_CNSGN_PRCHS_AMT
	, TOT.SLS_CNSGN_PRCHS_VLM
	, TOT.SLS_CNSGN_SLS_AMT
	, TOT.SLS_CNSGN_SLS_VLM
	, TOT.UO_SPMT_AMT
	, TOT.UO_SPMT_VLM
	, TOT.UO_OTHER_SPMT_AMT
	, TOT.UO_OTHER_SPMT_VLM
	, TOT.RMRK
	, TO_CHAR (ITEM.BRNO) AS UO_BRNO
	, TOT.STBLT_YN
FROM
	(SELECT
			ITEM_CD
			, YR
			, BRNO
			,(SELECT ITEM_NM FROM TB_ITEM_CRTR WHERE ITEM_CD = AYGC.ITEM_CD) AS ITEM_NM
			,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'STTG_UPBR_ITEM_SE' AND CD_VL = AYGC.STTG_UPBR_ITEM_SE) AS STTG_UPBR_ITEM_NM
		FROM TB_EV_APO_YR_GPC_CD AYGC
		WHERE BRNO = #{uoBrno}
		  AND YR = #{yr}
	) ITEM ,
	(SELECT *
		FROM TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT
		WHERE 1=1
		  AND BRNO = #{brno}
		  AND YR = #{yr}
		  AND UO_BRNO = #{uoBrno}
		  AND APO_SE = '2'
		  AND TYPE_SE_NO = '7'
	) TOT
WHERE 1=1
	AND ITEM.ITEM_CD = TOT.ITEM_CD(+)

--=='8' AS TYPE_SE_NO===합계======================================
UNION ALL

SELECT
	'8' AS TYPE_SE_NO
	,'합계' AS SE_NM
	, '' AS PRCHS_NM
	, '0'  AS ISO_BRNO
	, 0 AS PRDCR_OGNZ_SN
	, '0' AS PRDCR_OGNZ_CD
	, '0' AS CLTVTN_LAND_SN
	, ITEM.ITEM_CD AS ITEM_CD
	, ITEM.ITEM_NM || '(' || ITEM.STTG_UPBR_ITEM_NM || ')'  AS ITEM_NM
	, '' AS TRMT_TYPE
	, '합계' AS TRMT_TYPE_NM
	, '' AS STTG_UPBR_ITEM_SE
	--, '합계' AS STTG_UPBR_ITEM_NM
	, ITEM.YR AS YR
	, 0 AS SLS_CNSGN_PRCHS_AMT
	, 0 AS SLS_CNSGN_PRCHS_VLM
	, 0 AS SLS_CNSGN_SLS_AMT
	, 0 AS SLS_CNSGN_SLS_VLM
	, 0 AS UO_SPMT_AMT
	, 0 AS UO_SPMT_VLM
	, 0 AS UO_OTHER_SPMT_AMT
	, 0 AS UO_OTHER_SPMT_VLM
	, TOT.RMRK
	, TO_CHAR (ITEM.BRNO) AS UO_BRNO
	, TOT.STBLT_YN
FROM
	(SELECT
			ITEM_CD
			, YR
			, BRNO
			,(SELECT ITEM_NM FROM TB_ITEM_CRTR WHERE ITEM_CD = AYGC.ITEM_CD) AS ITEM_NM
			,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'STTG_UPBR_ITEM_SE' AND CD_VL = AYGC.STTG_UPBR_ITEM_SE) AS STTG_UPBR_ITEM_NM
		FROM TB_EV_APO_YR_GPC_CD AYGC
		WHERE BRNO = #{uoBrno}
		  AND YR = #{yr}
	) ITEM ,
	(SELECT *
		FROM TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT
		WHERE 1=1
		  AND BRNO = #{brno}
		  AND YR = #{yr}
		  AND UO_BRNO = #{uoBrno}
		  AND APO_SE = '2'
		  AND TYPE_SE_NO = '8'
	) TOT
WHERE 1=1
	AND ITEM.ITEM_CD = TOT.ITEM_CD(+)
)
ORDER BY ITEM_CD , TYPE_SE_NO , SE_NM , STTG_UPBR_ITEM_SE , PRCHS_NM
	</select>


	<insert id="insertInvShipOgnSpeczItmPurSalMng" parameterType="com.at.apcss.pd.isom.vo.InvShipOgnSpeczItmPurSalMngVO">
		<![CDATA[
		MERGE INTO TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT CLT  /* com.at.apcss.pd.isom.mapper.InvShipOgnSpeczItmPurSalMngMapper.insertInvShipOgnSpeczItmPurSalMng */
		USING DUAL
			ON (
					CLT.APO_CD   		= #{apoCd}
				AND CLT.APO_SE	 		= #{apoSe}
				AND CLT.BRNO 			= #{brno}
				AND CLT.YR	 			= #{yr}
				AND CLT.CTGRY_CD	 	= #{ctgryCd}
				AND CLT.ITEM_CD 		= #{itemCd}
				AND CLT.PRDCR_OGNZ_SN 	= #{prdcrOgnzSn}
				AND CLT.CLTVTN_LAND_SN 	= #{cltvtnLandSn}
				AND CLT.TYPE_SE_NO		= #{typeSeNo}
				AND CLT.UO_BRNO 		= #{uoBrno}
				)
		WHEN MATCHED THEN
				 UPDATE
					SET
						SLS_CNSGN_PRCHS_AMT		= #{slsCnsgnPrchsAmt}
						, UO_SPMT_AMT			= #{uoSpmtAmt}
						, UO_OTHER_SPMT_AMT		= #{uoOtherSpmtAmt}

						, SLS_CNSGN_PRCHS_VLM	= #{slsCnsgnPrchsVlm}
						, UO_SPMT_VLM			= #{uoSpmtVlm}
						, UO_OTHER_SPMT_VLM		= #{uoOtherSpmtVlm}

						, TRMT_TYPE				= #{trmtType}

						, RMRK					= #{rmrk}

						, SYS_LAST_CHG_DT		= SYSDATE
						, SYS_LAST_CHG_USER_ID	= #{sysLastChgUserId}
						, SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
				]]>
				<![CDATA[
		WHEN NOT MATCHED THEN
			 INSERT
					(
						APO_CD
					  , APO_SE
					  , BRNO
					  , CRNO
					  , YR
					  , CTGRY_CD
					  , ITEM_CD
					  , ISO_BRNO
					  , PRDCR_OGNZ_SN
					  , PRDCR_OGNZ_CD
					  , CLTVTN_LAND_SN
					  , TYPE_SE_NO
					  , UO_BRNO
					  , TRMT_TYPE

					  , SLS_CNSGN_PRCHS_AMT
					  , UO_SPMT_AMT
					  , UO_OTHER_SPMT_AMT

					  , SLS_CNSGN_PRCHS_VLM
					  , UO_SPMT_VLM
					  , UO_OTHER_SPMT_VLM

					  , RMRK

					  , SYS_FRST_INPT_DT
					  , SYS_FRST_INPT_USER_ID
					  , SYS_FRST_INPT_PRGRM_ID
					  , SYS_LAST_CHG_DT
					  , SYS_LAST_CHG_USER_ID
					  , SYS_LAST_CHG_PRGRM_ID
					)
				VALUES
					(
					    (SELECT APO_CD FROM TB_EV_APO WHERE BRNO = #{brno})
					  , #{apoSe}
					  , #{brno}
					  , (SELECT CRNO FROM TB_EV_APO WHERE BRNO = #{brno})
					  , #{yr}
					  , #{ctgryCd}
					  , #{itemCd}
					  , #{isoBrno}
					  , #{prdcrOgnzSn}
					  , #{prdcrOgnzCd}
					  , #{cltvtnLandSn}
					  , #{typeSeNo}
					  , #{uoBrno}
					  , #{trmtType}

					  , #{slsCnsgnPrchsAmt}
					  , #{uoSpmtAmt}
					  , #{uoOtherSpmtAmt}

					  , #{slsCnsgnPrchsVlm}
					  , #{uoSpmtVlm}
					  , #{uoOtherSpmtVlm}

					  , #{rmrk}

					  , SYSDATE
					  , #{sysFrstInptUserId}
					  , #{sysFrstInptPrgrmId}
					  , SYSDATE
					  , #{sysLastChgUserId}
					  , #{sysLastChgPrgrmId}
					)
		]]>
	</insert>

	<select id="selectItemStbltYnList" parameterType="com.at.apcss.pd.isom.vo.ItemStbltYnVO" resultType="com.at.apcss.pd.isom.vo.ItemStbltYnVO">
		SELECT	/* com.at.apcss.pd.isom.mapper.InvShipOgnSpeczItmPurSalMngMapper.selectItemStbltYnList */
			TOTAL.ITEM_CD
			,TOTAL.ITEM_NM
			,TOTAL.STTG_UPBR_ITEM_SE
			,TOTAL.STTG_UPBR_ITEM_NM
			,TOTAL.CTGRY_CD
			,TOTAL.CTGRY_NM
			,TOTAL.BRNO
			,TOTAL.UO_BRNO
			,TOTAL.YR
			,TOTAL.APRV
			,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'APRV_UPBR_SE_CD' AND CD_VL = TOTAL.APRV) AS APRV_NM
			,TOTAL.CORP_NM
			,TOTAL.UO_SPMT_AMT
			,TOTAL.UO_SPMT_AMT_OTHER
			,TOTAL.UO_OTHER_SPMT_AMT
			,TOTAL.UO_OTHER_SPMT_AMT_OTHER
			,TOTAL.UO_SPMT_AMT_TOT
			,TOTAL.UO_SPMT_AMT_RT
			,TOTAL.UO_SPMT_AMT_TOT_RT

			,TOTAL.CHK_A_A
			,TOTAL.CHK_A_B
			,TOTAL.CHK_A_C

			,TOTAL.CHK_B_A
			,TOTAL.CHK_B_B
			,TOTAL.CHK_B_C
			, (CASE WHEN TOTAL.APRV = '1' AND STTG_UPBR_ITEM_SE = '1' THEN
																(CASE WHEN  TOTAL.CHK_A_A = 'Y' AND TOTAL.CHK_A_B = 'Y' AND TOTAL.CHK_A_C = 'Y'
																			THEN 'Y'
																			ELSE 'N' END)
					WHEN TOTAL.APRV = '1' AND STTG_UPBR_ITEM_SE = '2' AND UO_SPMT_AMT > 0 THEN 'Y'
					WHEN  TOTAL.APRV = '2' THEN
																(CASE WHEN  TOTAL.CHK_B_A = 'Y' AND TOTAL.CHK_B_C = 'Y'
																			THEN 'Y'
																			ELSE 'N' END)
					ELSE 'N' END
			) AS STBLT_YN

		FROM
				(SELECT
					TOT.ITEM_CD
					,TOT.ITEM_NM
					,TOT.STTG_UPBR_ITEM_SE
					,TOT.STTG_UPBR_ITEM_NM
					,TOT.CTGRY_CD
					,TOT.CTGRY_NM
					,TOT.BRNO
					,TOT.UO_BRNO
					,TOT.YR
					,TOT.APRV
					,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'APRV_UPBR_SE_CD' AND CD_VL = TOT.APRV) AS APRV_NM
					,TOT.CORP_NM
					,TOT.UO_SPMT_AMT
					,TOT.UO_SPMT_AMT_OTHER
					,TOT.UO_OTHER_SPMT_AMT
					,TOT.UO_OTHER_SPMT_AMT_OTHER
					,TOT.UO_SPMT_AMT_TOT
					,TOT.UO_SPMT_AMT_RT
					,TOT.UO_SPMT_AMT_TOT_RT
					/* 20240603 승인형 작년 기준인것을 올해 기준으로 변경 60 -> 50 , 60 -> 40 */
					,(CASE WHEN TOT.UO_SPMT_AMT >= 500000 THEN 'Y' ELSE 'N' END) AS CHK_A_A
					,(CASE WHEN TOT.UO_SPMT_AMT_RT >= 50 THEN 'Y' ELSE 'N' END) AS CHK_A_B
					,(CASE WHEN TOT.UO_SPMT_AMT_TOT_RT >= 40 THEN 'Y' ELSE 'N' END) AS CHK_A_C

					,(CASE WHEN TOT.UO_SPMT_AMT >= 300000 THEN 'Y' ELSE 'N' END) AS CHK_B_A
					,(CASE WHEN TOT.UO_SPMT_AMT_RT >= 100 THEN 'Y' ELSE 'N' END) AS CHK_B_B
					,(CASE WHEN TOT.UO_SPMT_AMT_TOT_RT >=  20 THEN 'Y' ELSE 'N' END) AS CHK_B_C
				FROM
					(SELECT
							ITEM.ITEM_CD
							, ITEM.ITEM_NM
							, ITEM.STTG_UPBR_ITEM_SE
							, ITEM.STTG_UPBR_ITEM_NM
							, ITEM.CTGRY_CD
							, ITEM.CTGRY_NM
							, ITEM.BRNO
							, ITEM.UO_BRNO
							, ITEM.YR
							, (SELECT APRV FROM TB_EV_APO WHERE BRNO = ITEM.UO_BRNO) AS APRV
							, (SELECT CORP_NM FROM TB_EV_APO WHERE BRNO = ITEM.BRNO) AS CORP_NM

							, TOTA.UO_SPMT_AMT 	AS UO_SPMT_AMT
							, TOTB.UO_SPMT_AMT 	AS UO_SPMT_AMT_OTHER

							, TOTA.UO_OTHER_SPMT_AMT 	AS UO_OTHER_SPMT_AMT
							, TOTB.UO_OTHER_SPMT_AMT 	AS UO_OTHER_SPMT_AMT_OTHER

							, (NVL(TOTA.UO_SPMT_AMT,0) + NVL(TOTA.UO_OTHER_SPMT_AMT,0) + NVL(TOTB.UO_SPMT_AMT,0) + NVL(TOTB.UO_OTHER_SPMT_AMT,0)) AS UO_SPMT_AMT_TOT

							, ROUND(NVL( NVL(TOTA.UO_SPMT_AMT,0) / NULLIF( NVL(TOTA.UO_SPMT_AMT,0) + NVL(TOTA.UO_OTHER_SPMT_AMT,0) , 0 ) , 0 ) * 100 , 2 ) AS UO_SPMT_AMT_RT
							, ROUND(
									NVL( (NVL(TOTA.UO_SPMT_AMT,0) + NVL(TOTB.UO_SPMT_AMT,0))
											/
											NULLIF(
													(NVL(TOTA.UO_SPMT_AMT,0)
															+ NVL(TOTA.UO_OTHER_SPMT_AMT,0)
															+ NVL(TOTB.UO_SPMT_AMT,0)
															+ NVL(TOTB.UO_OTHER_SPMT_AMT,0))
													, 0 )
										, 0 ) * 100
									, 2
							) AS UO_SPMT_AMT_TOT_RT
						FROM
							(SELECT
									ITEM_CD
									, YR
									, STTG_UPBR_ITEM_SE
									, CTGRY_CD
									, UO_BRNO
									, BRNO
									,(SELECT ITEM_NM FROM TB_ITEM_CRTR WHERE ITEM_CD = AYGC.ITEM_CD) AS ITEM_NM
									,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'CTGRY_CD' AND CD_VL = AYGC.CTGRY_CD) AS CTGRY_NM
									,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'STTG_UPBR_ITEM_SE' AND CD_VL = AYGC.STTG_UPBR_ITEM_SE) AS STTG_UPBR_ITEM_NM
								FROM TB_EV_APO_YR_GPC_CD AYGC
								WHERE 1=1
								  AND APO_SE = '2'
								<if test='brno != null and brno != ""'>
								  AND BRNO = #{brno}
								</if>
								<if test='uoBrno != null and uoBrno != ""'>
								  AND UO_BRNO = #{uoBrno}
								</if>
								<if test='yr != null and yr != ""'>
								  AND YR = #{yr}
								</if>
							) ITEM ,
							(SELECT
									BRNO
									, ITEM_CD
									, SUM( NVL( UO_SPMT_AMT , 0 ) ) AS UO_SPMT_AMT
									, SUM( NVL( UO_OTHER_SPMT_AMT , 0 ) ) AS UO_OTHER_SPMT_AMT
								FROM TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT PSTA
								WHERE 1=1
								  AND APO_SE = '2'
								  AND TYPE_SE_NO IN ('5')
								  AND OGNZ_STBLT_YN = 'Y'
								  AND CTGRY_CD IS NULL
								  AND CLTVTN_LAND_SN IS NULL
								  AND PRDCR_OGNZ_SN IN (SELECT PRDCR_OGNZ_SN
														FROM TB_EV_FRMHS_APO
														WHERE 1=1
														  AND STBLT_YN = 'Y'
														  AND NVL(EXCL_YN,'N') != 'Y'
														  AND APO_SE = '2'
														  AND YR = PSTA.YR
														  AND BRNO = PSTA.BRNO
														  AND UO_BRNO = PSTA.UO_BRNO
													)
								  AND ITEM_CD IN (SELECT ITEM_CD
													FROM TB_EV_APO_YR_GPC_CD
													WHERE 1=1
													  AND APO_SE = '2'
													  AND YR = PSTA.YR
													  AND BRNO = PSTA.BRNO
													  AND UO_BRNO = PSTA.UO_BRNO
													)
								<if test='uoBrno != null and uoBrno != ""'>
								  AND UO_BRNO = #{uoBrno}
								</if>
								<if test='brno != null and brno != ""'>
								  AND BRNO = #{brno}
								</if>
								<if test='yr != null and yr != ""'>
								  AND YR = #{yr}
								</if>
									GROUP BY  BRNO , ITEM_CD
							) TOTA ,
							(SELECT
									BRNO
									, ITEM_CD
									, SUM( NVL( UO_SPMT_AMT , 0 ) ) AS UO_SPMT_AMT
									, SUM( NVL( UO_OTHER_SPMT_AMT , 0 ) ) AS UO_OTHER_SPMT_AMT
								FROM TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT PSTB
								WHERE 1=1
								  AND APO_SE = '2'
								  AND TYPE_SE_NO IN ('5','7')
								  AND CTGRY_CD IS NULL
								  AND CLTVTN_LAND_SN IS NULL
								  AND OGNZ_STBLT_YN = DECODE(PSTB.TYPE_SE_NO, '5' , 'N' , '7' ,'0' ,'')
								  AND (
										PRDCR_OGNZ_SN IN (SELECT PRDCR_OGNZ_SN
															FROM TB_EV_FRMHS_APO
															WHERE 1=1
															  AND STBLT_YN = 'N'
															  AND NVL(EXCL_YN,'N') != 'Y'
															  AND APO_SE = '2'
															  AND YR = PSTB.YR
															  AND BRNO = PSTB.BRNO
															  AND UO_BRNO = PSTB.UO_BRNO
													)
										OR
										PRDCR_OGNZ_SN = '0'
										)
								  AND ITEM_CD IN (SELECT ITEM_CD
													FROM TB_EV_APO_YR_GPC_CD
													WHERE 1=1
													  AND APO_SE = '2'
													  AND YR = PSTB.YR
													  AND BRNO = PSTB.BRNO
													  AND UO_BRNO = PSTB.UO_BRNO
													)
								<if test='uoBrno != null and uoBrno != ""'>
								  AND UO_BRNO = #{uoBrno}
								</if>
								<if test='brno != null and brno != ""'>
								  AND BRNO = #{brno}
								</if>
								<if test='yr != null and yr != ""'>
								  AND YR = #{yr}
								</if>
								GROUP BY  BRNO , ITEM_CD
							) TOTB
						WHERE 1=1
						AND ITEM.ITEM_CD = TOTA.ITEM_CD(+)
						AND ITEM.ITEM_CD = TOTB.ITEM_CD(+)
				)TOT
		)TOTAL
	</select>

	<!-- 적합여부 업데이트 -->
	<update id="updateItemStbltYn" parameterType="com.at.apcss.pd.isom.vo.ItemStbltYnVO">
			UPDATE /* com.at.apcss.pd.isom.mapper.InvShipOgnSpeczItmPurSalMngMapper.updateItemStbltYn */
				TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT
			SET
				STBLT_YN	= #{stbltYn}
			WHERE 1=1
			  AND APO_SE 	= '2'
			  AND UO_BRNO 	= #{uoBrno}
			  AND BRNO 		= #{brno}
			  AND YR 		= #{yr}
			  AND ITEM_CD 	= #{itemCd}
	</update>
	<!-- 적합여부 초기화 -->
	<update id="updateItemStbltYnInit" parameterType="com.at.apcss.pd.isom.vo.ItemStbltYnVO">
			UPDATE /* com.at.apcss.pd.isom.mapper.InvShipOgnSpeczItmPurSalMngMapper.updateItemStbltYnInit */
				TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT
			SET
				  STBLT_YN	= ''
			WHERE 1=1
			  AND APO_SE 	= '2'
			  AND UO_BRNO 	= #{uoBrno}
			  AND BRNO 		= #{brno}
			  AND YR 		= #{yr}
	</update>

	<!-- 전문품목 매입매출 출자출하조직 로우데이터 -->
	<select id="selectRawDataList" parameterType="com.at.apcss.pd.isom.vo.InvShipOgnSpeczItmPurSalMngVO" resultType="com.at.apcss.pd.isom.vo.InvShipOgnSpeczItmPurSalMngVO">
		SELECT
			YR
			, BRNO
			, (SELECT CORP_NM FROM TB_EV_APO WHERE BRNO = A.BRNO) AS CORP_NM
			, UO_BRNO
			, (SELECT CORP_NM FROM TB_EV_APO WHERE BRNO = A.UO_BRNO) AS UO_CORP_NM
			, DECODE( (SELECT APRV
						FROM TB_EV_APO
						WHERE BRNO = (SELECT UO_BRNO
										FROM TB_EV_APLY_MNG
										WHERE  YR = A.YR
										  AND BRNO = A.BRNO
									)
						)
						, '1' , '승인형'
						, '2' , '육성형'
						, ''
			) AS APRV
			, TYPE_SE_NO
			, DECODE(A.TYPE_SE_NO
						, '5' , '생산자조직'
						, '6' , '생산자조직 소계'
						, '7' , '생산자조직 외'
						, '8' , '합계'
						, ''
			) AS TYPE_SE_NO_NM
			, (SELECT ITEM_NM FROM TB_ITEM_CRTR WHERE ITEM_CD = A.ITEM_CD) AS ITEM_NM
			, (SELECT CD_VL_NM
				FROM TB_COM_CD_DTL
				WHERE CD_ID = 'CTGRY_CD'
				  AND CD_VL = (SELECT CTGRY_CD
								FROM TB_EV_APO_YR_GPC_CD
								WHERE BRNO = A.UO_BRNO
									AND ITEM_CD = A.ITEM_CD
									AND YR = A.YR
								)
			) AS CTGRY_NM
			, (SELECT CD_VL_NM
				FROM TB_COM_CD_DTL
				WHERE CD_ID = 'STTG_UPBR_ITEM_SE'
				  AND CD_VL = (SELECT STTG_UPBR_ITEM_SE
								FROM TB_EV_APO_YR_GPC_CD
								WHERE BRNO = A.UO_BRNO
									AND ITEM_CD = A.ITEM_CD
									AND YR = A.YR
								)
			) AS STTG_UPBR_ITEM_NM
			, (SELECT CD_VL_NM
				FROM TB_COM_CD_DTL
				WHERE CD_ID = 'TRMT_TYPE'
				  AND CD_VL = (SELECT TRMT_TYPE
								FROM TB_EV_FRMHS_APO
								WHERE PRDCR_OGNZ_SN = A.PRDCR_OGNZ_SN
								  AND YR = A.YR
								  AND NVL(EXCL_YN,'N') != 'Y'
								)) AS TRMT_TYPE_NM
			, PRDCR_OGNZ_SN
			, (SELECT PRDCR_OGNZ_NM FROM TB_EV_FRMHS_APO WHERE PRDCR_OGNZ_SN = A.PRDCR_OGNZ_SN AND NVL(EXCL_YN,'N') != 'Y') AS PRDCR_OGNZ_NM
			, SLS_CNSGN_PRCHS_AMT
			, UO_SPMT_AMT
			, UO_OTHER_SPMT_AMT
			, RMRK
			, STBLT_YN
			,(SELECT NVL(ERR.MNGR_STBLT_YN , ERR.STBLT_YN)
				FROM TB_EV_REG_RSLT ERR
				WHERE 1=1
				  AND BRNO = A.BRNO
				  AND UO_BRNO = A.UO_BRNO
				  AND YR = A.YR
				  AND APO_SE = '2'
			) AS LAST_STBLT_YN
		FROM TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT A
		WHERE APO_SE = '2'
			AND YR = #{yr}
			AND BRNO NOT IN (SELECT BRNO
								FROM TB_COM_USER
								WHERE USER_ID IN ('at21','at22','at23','at24','at25','at26','at27','at61')
							)
			AND UO_BRNO NOT IN (SELECT BRNO
									FROM TB_COM_USER
									WHERE USER_ID IN ('at11','at12','at13','at14','at15','at16','at17','at51')
								)
			AND ITEM_CD = DECODE(A.TYPE_SE_NO
									,'5', (SELECT ITEM_CD
											FROM TB_EV_FRMHS_APO
											WHERE 1=1
											  AND YR = A.YR
											  AND STBLT_YN = 'Y'
											  AND NVL(EXCL_YN,'N') != 'Y'
											  AND BRNO = A.BRNO
											  AND PRDCR_OGNZ_SN = A.PRDCR_OGNZ_SN
											  AND ITEM_CD = (SELECT ITEM_CD
																FROM TB_EV_APO_YR_GPC_CD
																WHERE 1=1
																  AND YR= A.YR
																  AND BRNO = A.UO_BRNO
																  AND ITEM_CD = A.ITEM_CD
															)
											)
									, (SELECT ITEM_CD
										FROM TB_EV_APO_YR_GPC_CD
										WHERE 1=1
										  AND YR = A.YR
										  AND BRNO = A.UO_BRNO
										  AND ITEM_CD = A.ITEM_CD
										)
								)
		ORDER BY A.BRNO ,A.UO_BRNO , A.ITEM_CD , A.TYPE_SE_NO
	</select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.pd.isom.mapper.InvShipOgnSpeczItmPurSalMngMapper.selectInvShipOgnSpeczItmPurSalMngListNew	-->
	<!-- DESC : 출자출하조직 전문품목 매입매출 조회                                             		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.12.09  	ljw        		Initial Creation                            -->
	<!-- ==========================================================================	-->
	<select id="selectInvShipOgnSpeczItmPurSalMngListNew" parameterType="com.at.apcss.pd.isom.vo.InvShipOgnSpeczItmPurSalMngVO" resultType="com.at.apcss.pd.isom.vo.InvShipOgnSpeczItmPurSalMngVO">
SELECT * FROM (    /* com.at.apcss.pd.isom.mapper.InvShipOgnSpeczItmPurSalMngMapper.selectInvShipOgnSpeczItmPurSalMngListNew */
/*=='5' AS TYPE_SE_NO===출자출하조직 적합 생산자조직======================================*/

SELECT
	'5' AS TYPE_SE_NO
	, ITEM.ITEM_NM || '(' || ITEM.STTG_UPBR_ITEM_NM || ')'  AS ITEM_NM
	,'(생산자조직)전속출하' AS SE_NM
	, ITEM.PRDCR_OGNZ_NM AS PRCHS_NM
	, (SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'TRMT_TYPE' AND CD_VL = ITEM.TRMT_TYPE) AS TRMT_TYPE_NM

	, ITEM.YR
	, ITEM.BRNO
	, '0' AS ISO_BRNO
	, ITEM.ITEM_CD
	, NVL ( ITEM.PRDCR_OGNZ_SN , 0 ) AS PRDCR_OGNZ_SN
	, ITEM.TRMT_TYPE
	, ITEM.STTG_UPBR_ITEM_SE
	, 'Y' AS OGNZ_STBLT_YN
	, ITEM.UO_BRNO
	, TOT.STBLT_YN

	, ITEM.SPMT_PRC_TOT AS SLS_CNSGN_PRCHS_AMT
	, ITEM.EC_SPMT_VLM_TOT AS SLS_CNSGN_PRCHS_VLM
	, TOT.SLS_CNSGN_SLS_AMT
	, TOT.SLS_CNSGN_SLS_VLM
	, TOT.UO_SPMT_AMT
	, TOT.UO_SPMT_VLM
	, TOT.UO_OTHER_SPMT_AMT
	, TOT.UO_OTHER_SPMT_VLM
	, TOT.RMRK

FROM
	(SELECT
			FA.PRDCR_OGNZ_SN
			,FA.PRDCR_OGNZ_NM
			,FA.BRNO
			,FA.ITEM_CD
			,(SELECT ITEM_NM FROM TB_ITEM_CRTR WHERE ITEM_CD = FA.ITEM_CD) AS ITEM_NM
			,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'STTG_UPBR_ITEM_SE' AND CD_VL = FA.STTG_UPBR_ITEM_SE)  AS  STTG_UPBR_ITEM_NM
			,FA.UO_BRNO
			,FA.STTG_UPBR_ITEM_SE
			,FA.TRMT_TYPE
			,FA.YR
			,(SELECT SUM(EC_SPMT_VLM) FROM  TB_EV_FRMHS_PRDCTN_EC_SPMT_STTN WHERE PRDCR_OGNZ_SN = FA.PRDCR_OGNZ_SN AND ITEM_CD = FA.ITEM_CD
			) AS EC_SPMT_VLM_TOT
			,(SELECT SUM(SPMT_PRC) FROM  TB_EV_FRMHS_PRDCTN_EC_SPMT_STTN WHERE PRDCR_OGNZ_SN = FA.PRDCR_OGNZ_SN AND ITEM_CD = FA.ITEM_CD
			) AS SPMT_PRC_TOT
		FROM TB_EV_FRMHS_APO FA
		WHERE 1=1
		  AND FA.YR = #{yr}
		  AND FA.BRNO = #{brno}
		  AND FA.UO_BRNO = #{uoBrno}
		  AND FA.STBLT_YN = 'Y'
		  AND NVL(FA.EXCL_YN,'N') != 'Y'
		  AND ITEM_CD IN (SELECT ITEM_CD
							FROM TB_EV_APO_YR_GPC_CD
							WHERE 1=1
							  AND YR = FA.YR
							  AND BRNO = FA.BRNO
							  AND UO_BRNO = FA.UO_BRNO
							  AND APO_SE = '2'
							  AND STTG_UPBR_ITEM_SE != '3'
							)
	) ITEM ,
	(SELECT *
		FROM TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT PST
		WHERE 1=1
		  AND YR = #{yr}
		  AND BRNO = #{brno}
		  AND UO_BRNO = #{uoBrno}
		  AND APO_SE ='2'
		  AND TYPE_SE_NO = '5'
		  AND OGNZ_STBLT_YN = 'Y'
		  AND ITEM_CD IN  (SELECT ITEM_CD
							FROM TB_EV_APO_YR_GPC_CD
							WHERE 1=1
							  AND YR = PST.YR
							  AND BRNO = PST.BRNO
							  AND UO_BRNO = PST.UO_BRNO
							  AND APO_SE = '2'
							  AND STTG_UPBR_ITEM_SE != '3'
							)
		  AND PRDCR_OGNZ_SN IN (SELECT PRDCR_OGNZ_SN
									FROM TB_EV_FRMHS_APO
									WHERE 1=1
									  AND APO_SE= '2'
									  AND STBLT_YN = 'Y'
									  AND YR = PST.YR
									  AND BRNO = PST.BRNO
									  AND UO_BRNO = PST.UO_BRNO
									  AND ITEM_CD = PST.ITEM_CD
									)
	) TOT
WHERE 1=1
  AND ITEM.BRNO = TOT.BRNO(+)
  AND ITEM.ITEM_CD = TOT.ITEM_CD(+)
  AND ITEM.PRDCR_OGNZ_SN = TOT.PRDCR_OGNZ_SN(+)

/*=='5' AS TYPE_SE_NO===출자출하조직 요건미달 생산자조직======================================*/
UNION ALL

SELECT
	'5' AS TYPE_SE_NO
	, ITEM.ITEM_NM || '(' || ITEM.STTG_UPBR_ITEM_NM || ')'  AS ITEM_NM
	,'(요건미달)전속출하' AS SE_NM
	, ITEM.PRDCR_OGNZ_NM AS PRCHS_NM
	, (SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'TRMT_TYPE' AND CD_VL = ITEM.TRMT_TYPE) AS TRMT_TYPE_NM

	, ITEM.YR
	, ITEM.BRNO
	, '0' AS ISO_BRNO
	, ITEM.ITEM_CD
	, NVL ( ITEM.PRDCR_OGNZ_SN , 0 ) AS PRDCR_OGNZ_SN
	, ITEM.TRMT_TYPE
	, ITEM.STTG_UPBR_ITEM_SE
	, 'N' AS OGNZ_STBLT_YN
	, ITEM.UO_BRNO
	, TOT.STBLT_YN

	, ITEM.SPMT_PRC_TOT AS SLS_CNSGN_PRCHS_AMT
	, ITEM.EC_SPMT_VLM_TOT AS SLS_CNSGN_PRCHS_VLM
	, TOT.SLS_CNSGN_SLS_AMT
	, TOT.SLS_CNSGN_SLS_VLM
	, TOT.UO_SPMT_AMT
	, TOT.UO_SPMT_VLM
	, TOT.UO_OTHER_SPMT_AMT
	, TOT.UO_OTHER_SPMT_VLM
	, TOT.RMRK
FROM
	(SELECT
			FA.PRDCR_OGNZ_SN
			,FA.PRDCR_OGNZ_NM
			,FA.BRNO
			,FA.ITEM_CD
			,(SELECT ITEM_NM FROM TB_ITEM_CRTR WHERE ITEM_CD = FA.ITEM_CD) AS ITEM_NM
			,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'STTG_UPBR_ITEM_SE' AND CD_VL = FA.STTG_UPBR_ITEM_SE)  AS  STTG_UPBR_ITEM_NM
			,FA.UO_BRNO
			,FA.STTG_UPBR_ITEM_SE
			,FA.TRMT_TYPE
			,FA.YR
			,(SELECT SUM(EC_SPMT_VLM) FROM  TB_EV_FRMHS_PRDCTN_EC_SPMT_STTN WHERE PRDCR_OGNZ_SN = FA.PRDCR_OGNZ_SN AND ITEM_CD = FA.ITEM_CD
			) AS EC_SPMT_VLM_TOT
			,(SELECT SUM(SPMT_PRC) FROM  TB_EV_FRMHS_PRDCTN_EC_SPMT_STTN WHERE PRDCR_OGNZ_SN = FA.PRDCR_OGNZ_SN AND ITEM_CD = FA.ITEM_CD
			) AS SPMT_PRC_TOT
		FROM TB_EV_FRMHS_APO FA
		WHERE 1=1
		  AND YR = #{yr}
		  AND FA.BRNO = #{brno}
		  AND FA.UO_BRNO = #{uoBrno}
		  AND FA.STBLT_YN != 'Y'
		  AND NVL(FA.EXCL_YN,'N') != 'Y'
		  AND ITEM_CD IN  (SELECT ITEM_CD
							FROM TB_EV_APO_YR_GPC_CD
							WHERE 1=1
							  AND YR = FA.YR
							  AND BRNO = FA.BRNO
							  AND UO_BRNO = FA.UO_BRNO
							  AND APO_SE = '2'
							  AND STTG_UPBR_ITEM_SE != '3'
							)
	) ITEM ,
	(SELECT *
		FROM TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT PST
		WHERE 1=1
		  AND YR = #{yr}
		  AND BRNO = #{brno}
		  AND UO_BRNO = #{uoBrno}
		  AND APO_SE ='2'
		  AND TYPE_SE_NO = '5'
		  AND ITEM_CD IN  (SELECT ITEM_CD
							FROM TB_EV_APO_YR_GPC_CD
							WHERE 1=1
							  AND YR = PST.YR
							  AND BRNO = PST.BRNO
							  AND UO_BRNO = PST.UO_BRNO
							  AND APO_SE = '2'
							  AND STTG_UPBR_ITEM_SE != '3'
							)
		  AND PRDCR_OGNZ_SN IN (SELECT PRDCR_OGNZ_SN
									FROM TB_EV_FRMHS_APO
									WHERE 1=1
									  AND APO_SE= '2'
									  AND STBLT_YN != 'Y'
									  AND YR = PST.YR
									  AND BRNO = PST.BRNO
									  AND UO_BRNO = PST.UO_BRNO
									  AND ITEM_CD = PST.ITEM_CD
									)
	) TOT
WHERE 1=1
 AND ITEM.BRNO = TOT.BRNO(+)
 AND ITEM.ITEM_CD = TOT.ITEM_CD(+)
 AND ITEM.PRDCR_OGNZ_SN = TOT.PRDCR_OGNZ_SN(+)

/*=='6' AS TYPE_SE_NO===통합조직 직속 생산자조직 소계 리스트 ======================================*/
/* 20241216 출자출하조직의 취급유형은 1품목 1생산자조직씩만 가능하다 하여 취급유형별 소계 제외처리 */
UNION ALL

SELECT
	'6' AS TYPE_SE_NO
	, ITEM.ITEM_NM || '(' || ITEM.STTG_UPBR_ITEM_NM || ')'  AS ITEM_NM
	, ITEM.SE_NM AS SE_NM
	, '전속출하 소계' AS PRCHS_NM
	, '전속출하 소계' AS TRMT_TYPE_NM

	/*
	, ITEM.TRMT_TYPE_NM AS PRCHS_NM
	, ITEM.TRMT_TYPE_NM AS TRMT_TYPE_NM
	, ITEM.TRMT_TYPE AS TRMT_TYPE
	*/

	, ITEM.YR
	, ITEM.BRNO
	, '0' AS ISO_BRNO
	, ITEM.ITEM_CD
	, 0 AS PRDCR_OGNZ_SN
	, '0' AS TRMT_TYPE
	, TO_CHAR(ITEM.STTG_UPBR_ITEM_SE) AS STTG_UPBR_ITEM_SE
	, ITEM.OGNZ_STBLT_YN AS OGNZ_STBLT_YN
	, ITEM.UO_BRNO
	, TOT.STBLT_YN

	, 0 AS SLS_CNSGN_PRCHS_AMT
	, 0 AS SLS_CNSGN_PRCHS_VLM
	, TOT.SLS_CNSGN_SLS_AMT
	, TOT.SLS_CNSGN_SLS_VLM
	, TOT.UO_SPMT_AMT
	, TOT.UO_SPMT_VLM
	, TOT.UO_OTHER_SPMT_AMT
	, TOT.UO_OTHER_SPMT_VLM
	, TOT.RMRK
FROM
	(SELECT * FROM
		/* 출자출하조직의 경우 취급유형은 종류별로 1조직만 가능해서 소계 제외 처리 */
		/*
		(SELECT * FROM
			(SELECT
					CD_VL_NM || ' 소계'  AS TRMT_TYPE_NM
					,CD_VL AS TRMT_TYPE
				FROM TB_COM_CD_DTL
				WHERE CD_ID = 'TRMT_TYPE'
				UNION ALL
				SELECT
					'전속출하 소계'  AS TRMT_TYPE_NM
					,'0' AS TRMT_TYPE
				FROM DUAL)
			,(SELECT
					'(생산자조직)전속출하' AS SE_NM
					,'Y' AS OGNZ_STBLT_YN
				FROM DUAL
				UNION ALL
				SELECT
					'(요건미달)전속출하' AS SE_NM
					,'N' AS OGNZ_STBLT_YN
				FROM DUAL)
		)
		*/
		(SELECT
				'(생산자조직)전속출하' AS SE_NM
				,'Y' AS OGNZ_STBLT_YN
			FROM DUAL
			UNION ALL
			SELECT
				'(요건미달)전속출하' AS SE_NM
				,'N' AS OGNZ_STBLT_YN
			FROM DUAL
		)
		,(SELECT
				YR
				, BRNO
				, UO_BRNO
				, ITEM_CD
				,(SELECT ITEM_NM FROM TB_ITEM_CRTR WHERE ITEM_CD = AYGC.ITEM_CD) AS ITEM_NM
				, STTG_UPBR_ITEM_SE
				,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'STTG_UPBR_ITEM_SE' AND CD_VL = AYGC.STTG_UPBR_ITEM_SE) AS STTG_UPBR_ITEM_NM
			FROM TB_EV_APO_YR_GPC_CD AYGC
			WHERE 1=1
			  AND YR = #{yr}
			  AND BRNO = #{brno}
			  AND UO_BRNO = #{uoBrno}
			  AND APO_SE = '2'
			  AND STTG_UPBR_ITEM_SE != '3'
		)
	) ITEM ,
	(SELECT *
		FROM TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT
		WHERE 1=1
		  AND YR = #{yr}
		  AND BRNO = #{brno}
		  AND UO_BRNO = #{uoBrno}
		  AND APO_SE = '2'
		  AND TYPE_SE_NO = '6'
		  AND TRMT_TYPE = '0'
	) TOT
WHERE 1=1
  AND ITEM.ITEM_CD = TOT.ITEM_CD(+)
  AND ITEM.OGNZ_STBLT_YN = TOT.OGNZ_STBLT_YN(+)
/*
  AND ITEM.TRMT_TYPE = TOT.TRMT_TYPE(+)
  AND(
		ITEM.TRMT_TYPE = '0'
		OR
		EXISTS (SELECT 1
					FROM TB_EV_FRMHS_APO
					WHERE 1=1
						  AND APO_SE = '2'
						  AND YR = ITEM.YR
						  AND BRNO = ITEM.BRNO
						  AND UO_BRNO = ITEM.UO_BRNO
						  AND STBLT_YN = ITEM.OGNZ_STBLT_YN
						  AND TRMT_TYPE = ITEM.TRMT_TYPE
						  AND ITEM_CD = ITEM.ITEM_CD
						)
		)
*/
/*=='7' AS TYPE_SE_NO===기타매입======================================*/
UNION ALL

SELECT
	'7' AS TYPE_SE_NO
	, ITEM.ITEM_NM || '(' || ITEM.STTG_UPBR_ITEM_NM || ')'  AS ITEM_NM
	,'생산자조직 외' AS SE_NM
	, '농가 , 법인 등' AS PRCHS_NM
	, '' AS TRMT_TYPE_NM

	, ITEM.YR
	, ITEM.BRNO
	, '0' AS ISO_BRNO
	, ITEM.ITEM_CD
	, 0 AS PRDCR_OGNZ_SN
	, '0' AS TRMT_TYPE
	, ITEM.STTG_UPBR_ITEM_SE
	, '0' AS OGNZ_STBLT_YN
	, ITEM.UO_BRNO
	, TOT.STBLT_YN

	, TOT.SLS_CNSGN_PRCHS_AMT
	, TOT.SLS_CNSGN_PRCHS_VLM
	, TOT.SLS_CNSGN_SLS_AMT
	, TOT.SLS_CNSGN_SLS_VLM
	, TOT.UO_SPMT_AMT
	, TOT.UO_SPMT_VLM
	, TOT.UO_OTHER_SPMT_AMT
	, TOT.UO_OTHER_SPMT_VLM
	, TOT.RMRK
FROM
	(SELECT
			ITEM_CD
			, YR
			, BRNO
			, UO_BRNO
			, STTG_UPBR_ITEM_SE
			,(SELECT ITEM_NM FROM TB_ITEM_CRTR WHERE ITEM_CD = AYGC.ITEM_CD) AS ITEM_NM
			,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'STTG_UPBR_ITEM_SE' AND CD_VL = AYGC.STTG_UPBR_ITEM_SE) AS STTG_UPBR_ITEM_NM
		FROM TB_EV_APO_YR_GPC_CD AYGC
		WHERE 1=1
		  AND YR = #{yr}
		  AND BRNO = #{brno}
		  AND UO_BRNO = #{uoBrno}
		  AND APO_SE = '2'
		  AND STTG_UPBR_ITEM_SE != '3'
	) ITEM ,
	(SELECT *
		FROM TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT
		WHERE 1=1
		  AND YR = #{yr}
		  AND BRNO = #{brno}
		  AND UO_BRNO = #{uoBrno}
		  AND APO_SE = '2'
		  AND TYPE_SE_NO = '7'
	) TOT
WHERE 1=1
	AND ITEM.ITEM_CD = TOT.ITEM_CD(+)

/*=='8' AS TYPE_SE_NO===합계======================================*/
UNION ALL

SELECT
	'8' AS TYPE_SE_NO
	, ITEM.ITEM_NM || '(' || ITEM.STTG_UPBR_ITEM_NM || ')'  AS ITEM_NM
	,'합계' AS SE_NM
	, '' AS PRCHS_NM
	, '합계' AS TRMT_TYPE_NM

	, ITEM.YR
	, ITEM.BRNO
	, '0' AS ISO_BRNO
	, ITEM.ITEM_CD
	, 0 AS PRDCR_OGNZ_SN
	, '0' AS TRMT_TYPE
	, ITEM.STTG_UPBR_ITEM_SE
	, '0' AS OGNZ_STBLT_YN
	, ITEM.UO_BRNO
	, TOT.STBLT_YN

	, 0 AS SLS_CNSGN_PRCHS_AMT
	, 0 AS SLS_CNSGN_PRCHS_VLM
	, 0 AS SLS_CNSGN_SLS_AMT
	, 0 AS SLS_CNSGN_SLS_VLM
	, 0 AS UO_SPMT_AMT
	, 0 AS UO_SPMT_VLM
	, 0 AS UO_OTHER_SPMT_AMT
	, 0 AS UO_OTHER_SPMT_VLM
	, TOT.RMRK
FROM
	(SELECT
			ITEM_CD
			, YR
			, BRNO
			, UO_BRNO
			, STTG_UPBR_ITEM_SE
			,(SELECT ITEM_NM FROM TB_ITEM_CRTR WHERE ITEM_CD = AYGC.ITEM_CD) AS ITEM_NM
			,(SELECT CD_VL_NM FROM TB_COM_CD_DTL WHERE CD_ID = 'STTG_UPBR_ITEM_SE' AND CD_VL = AYGC.STTG_UPBR_ITEM_SE) AS STTG_UPBR_ITEM_NM
		FROM TB_EV_APO_YR_GPC_CD AYGC
		WHERE 1=1
		  AND YR = #{yr}
		  AND BRNO = #{brno}
		  AND UO_BRNO = #{uoBrno}
		  AND APO_SE = '2'
		  AND STTG_UPBR_ITEM_SE != '3'
	) ITEM ,
	(SELECT *
		FROM TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT
		WHERE 1=1
		  AND YR = #{yr}
		  AND BRNO = #{brno}
		  AND UO_BRNO = #{uoBrno}
		  AND APO_SE = '2'
		  AND TYPE_SE_NO = '8'
	) TOT
WHERE 1=1
	AND ITEM.ITEM_CD = TOT.ITEM_CD(+)
)
ORDER BY
	STTG_UPBR_ITEM_SE
	, ITEM_CD
	, OGNZ_STBLT_YN DESC
	, CASE	WHEN TRMT_TYPE = 1 THEN 1
			WHEN TRMT_TYPE = 2 THEN 2
			WHEN TRMT_TYPE = 3 THEN 3
			ELSE 4 END
	, TRMT_TYPE
	, TYPE_SE_NO
	</select>

	<!-- ==========================================================================	-->
	<!-- NAME : com.at.apcss.pd.isom.mapper.InvShipOgnSpeczItmPurSalMngMapper.insertInvShipOgnSpeczItmPurSalMngNew	-->
	<!-- DESC : 출자출하조직 전문품목 매입매출 등록                                             		-->
	<!-- ==========================================================================	-->
	<!-- DATE   		AUTHOR        	DESCRIPTION                      			-->
	<!-- ===========  	============  	===========================================	-->
	<!-- 2024.12.12  	ljw        		Initial Creation                            -->
	<!-- ==========================================================================	-->
	<insert id="insertInvShipOgnSpeczItmPurSalMngNew" parameterType="com.at.apcss.pd.isom.vo.InvShipOgnSpeczItmPurSalMngVO">
		<![CDATA[
		MERGE INTO TB_EV_UO_ISO_PRCHS_PRCHS_SLS_TOT CLT  /* com.at.apcss.pd.isom.mapper.InvShipOgnSpeczItmPurSalMngMapper.insertInvShipOgnSpeczItmPurSalMngNew */
		USING DUAL
			ON (
					CLT.YR	 			= #{yr}
				AND CLT.APO_SE	 		= #{apoSe}
				AND CLT.BRNO 			= #{brno}
				AND CLT.ITEM_CD 		= #{itemCd}
				AND CLT.ISO_BRNO 		= #{isoBrno}
				AND CLT.PRDCR_OGNZ_SN 	= #{prdcrOgnzSn}
				AND CLT.TYPE_SE_NO		= #{typeSeNo}
				AND CLT.OGNZ_STBLT_YN	= #{ognzStbltYn}
				AND CLT.UO_BRNO 		= #{uoBrno}
				AND CLT.TRMT_TYPE		= #{trmtType}
				)
		WHEN MATCHED THEN
				 UPDATE
					SET
						SLS_CNSGN_PRCHS_AMT		= #{slsCnsgnPrchsAmt}
						, UO_SPMT_AMT			= #{uoSpmtAmt}
						, UO_OTHER_SPMT_AMT		= #{uoOtherSpmtAmt}

						, SLS_CNSGN_PRCHS_VLM	= #{slsCnsgnPrchsVlm}
						, UO_SPMT_VLM			= #{uoSpmtVlm}
						, UO_OTHER_SPMT_VLM		= #{uoOtherSpmtVlm}

						, RMRK					= #{rmrk}

						, SYS_LAST_CHG_DT		= SYSDATE
						, SYS_LAST_CHG_USER_ID	= #{sysLastChgUserId}
						, SYS_LAST_CHG_PRGRM_ID	= #{sysLastChgPrgrmId}
				]]>
				<![CDATA[
		WHEN NOT MATCHED THEN
			 INSERT
					(
						YR
					  , APO_CD
					  , APO_SE
					  , BRNO
					  , CRNO
					  , ITEM_CD
					  , ISO_BRNO
					  , PRDCR_OGNZ_SN
					  , TRMT_TYPE
					  , TYPE_SE_NO
					  , OGNZ_STBLT_YN
					  , UO_BRNO

					  , SLS_CNSGN_PRCHS_AMT
					  , UO_SPMT_AMT
					  , UO_OTHER_SPMT_AMT

					  , SLS_CNSGN_PRCHS_VLM
					  , UO_SPMT_VLM
					  , UO_OTHER_SPMT_VLM

					  , RMRK

					  , SYS_FRST_INPT_DT
					  , SYS_FRST_INPT_USER_ID
					  , SYS_FRST_INPT_PRGRM_ID
					  , SYS_LAST_CHG_DT
					  , SYS_LAST_CHG_USER_ID
					  , SYS_LAST_CHG_PRGRM_ID
					)
				VALUES
					(
					    #{yr}
					  , (SELECT APO_CD FROM TB_EV_APO WHERE BRNO = #{brno})
					  , '2'
					  , #{brno}
					  , (SELECT CRNO FROM TB_EV_APO WHERE BRNO = #{brno})
					  , #{itemCd}
					  , '0'
					  , #{prdcrOgnzSn}
					  , #{trmtType}
					  , #{typeSeNo}
					  , #{ognzStbltYn}
					  , #{uoBrno}

					  , #{slsCnsgnPrchsAmt}
					  , #{uoSpmtAmt}
					  , #{uoOtherSpmtAmt}

					  , #{slsCnsgnPrchsVlm}
					  , #{uoSpmtVlm}
					  , #{uoOtherSpmtVlm}

					  , #{rmrk}

					  , SYSDATE
					  , #{sysFrstInptUserId}
					  , #{sysFrstInptPrgrmId}
					  , SYSDATE
					  , #{sysLastChgUserId}
					  , #{sysLastChgPrgrmId}
					)
		]]>
	</insert>
</mapper>